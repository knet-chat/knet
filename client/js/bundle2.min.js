function Config(){this.ipServerAuth="217.127.199.47",this.portServerAuth="443",this.ipServerSockets="217.127.199.47",this.portServerSockets="443",this.MAX_HEIGHT_IMG=500,this.MAX_HEIGHT_IMG_PROFILE=320,this.MAX_LENGTH_TRUNCATED_SMS=20,this.MAX_SEND_OFFLINE_SMS=120,this.MAX_SMS_RETRIEVAL=36,this.MAX_WIDTH_IMG=500,this.MAX_WIDTH_IMG_PROFILE=220,this.MIN_WIDTH_IMG_PROFILE=170,this.MIN_HEIGHT_IMG_PROFILE=170,this.SW_VERSION="0.5.4",this.TIME_FADE_ACK=6e3,this.TIME_FADE_WRITING=2500,this.TIME_FADE_ONLINE_NOTICE=4500,this.TIME_SILENT_SCROLL=330,this.TIME_LOAD_EMOJI=3e3,this.TIME_LOAD_SPINNER=200,this.TIME_UNIX_2015=1420070401e3,this.TIME_UNIX_MONTH=2628e6,this.TIME_WAIT_DB=500,this.TIME_WAIT_HTTP_POST=7e3,this.TIME_WAIT_MAILBOX_POLLING=330,this.TIME_WAIT_WAKEUP=2e3,this.TIME_WAIT_PICKUP=6e4,this.pushOptions={android:{senderID:"442395718407",clearNotifications:!0,forceShow:!0,icon:"icon"},ios:{alert:"true",badge:"true",sound:"true"},windows:{}}}function hex2b64(a){var b,c,d="";for(b=0;b+3<=a.length;b+=3)c=parseInt(a.substring(b,b+3),16),d+=b64map.charAt(c>>6)+b64map.charAt(63&c);if(b+1==a.length?(c=parseInt(a.substring(b,b+1),16),d+=b64map.charAt(c<<2)):b+2==a.length&&(c=parseInt(a.substring(b,b+2),16),d+=b64map.charAt(c>>2)+b64map.charAt((3&c)<<4)),b64pad)for(;(3&d.length)>0;)d+=b64pad;return d}function b64tohex(a){var b,c,d,e="",f=0;for(b=0;b<a.length&&a.charAt(b)!=b64pad;++b)d=b64map.indexOf(a.charAt(b)),d<0||(0==f?(e+=int2char(d>>2),c=3&d,f=1):1==f?(e+=int2char(c<<2|d>>4),c=15&d,f=2):2==f?(e+=int2char(c),e+=int2char(d>>2),c=3&d,f=3):(e+=int2char(c<<2|d>>4),e+=int2char(15&d),f=0));return 1==f&&(e+=int2char(c<<2)),e}function b64toBA(a){var b,c=b64tohex(a),d=new Array;for(b=0;2*b<c.length;++b)d[b]=parseInt(c.substring(2*b,2*b+2),16);return d}function BigInteger(a,b,c){null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function nbi(){return new BigInteger(null)}function am1(a,b,c,d,e,f){for(;--f>=0;){var g=b*this[a++]+c[d]+e;e=Math.floor(g/67108864),c[d++]=67108863&g}return e}function am2(a,b,c,d,e,f){for(var g=32767&b,h=b>>15;--f>=0;){var i=32767&this[a],j=this[a++]>>15,k=h*i+j*g;i=g*i+((32767&k)<<15)+c[d]+(1073741823&e),e=(i>>>30)+(k>>>15)+h*j+(e>>>30),c[d++]=1073741823&i}return e}function am3(a,b,c,d,e,f){for(var g=16383&b,h=b>>14;--f>=0;){var i=16383&this[a],j=this[a++]>>14,k=h*i+j*g;i=g*i+((16383&k)<<14)+c[d]+e,e=(i>>28)+(k>>14)+h*j,c[d++]=268435455&i}return e}function int2char(a){return BI_RM.charAt(a)}function intAt(a,b){var c=BI_RC[a.charCodeAt(b)];return null==c?-1:c}function bnpCopyTo(a){for(var b=this.t-1;b>=0;--b)a[b]=this[b];a.t=this.t,a.s=this.s}function bnpFromInt(a){this.t=1,this.s=a<0?-1:0,a>0?this[0]=a:a<-1?this[0]=a+this.DV:this.t=0}function nbv(a){var b=nbi();return b.fromInt(a),b}function bnpFromString(a,b){var c;if(16==b)c=4;else if(8==b)c=3;else if(256==b)c=8;else if(2==b)c=1;else if(32==b)c=5;else{if(4!=b)return void this.fromRadix(a,b);c=2}this.t=0,this.s=0;for(var d=a.length,e=!1,f=0;--d>=0;){var g=8==c?255&a[d]:intAt(a,d);g<0?"-"==a.charAt(d)&&(e=!0):(e=!1,0==f?this[this.t++]=g:f+c>this.DB?(this[this.t-1]|=(g&(1<<this.DB-f)-1)<<f,this[this.t++]=g>>this.DB-f):this[this.t-1]|=g<<f,f+=c,f>=this.DB&&(f-=this.DB))}8==c&&0!=(128&a[0])&&(this.s=-1,f>0&&(this[this.t-1]|=(1<<this.DB-f)-1<<f)),this.clamp(),e&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var a=this.s&this.DM;this.t>0&&this[this.t-1]==a;)--this.t}function bnToString(a){if(this.s<0)return"-"+this.negate().toString(a);var b;if(16==a)b=4;else if(8==a)b=3;else if(2==a)b=1;else if(32==a)b=5;else{if(4!=a)return this.toRadix(a);b=2}var c,d=(1<<b)-1,e=!1,f="",g=this.t,h=this.DB-g*this.DB%b;if(g-- >0)for(h<this.DB&&(c=this[g]>>h)>0&&(e=!0,f=int2char(c));g>=0;)h<b?(c=(this[g]&(1<<h)-1)<<b-h,c|=this[--g]>>(h+=this.DB-b)):(c=this[g]>>(h-=b)&d,h<=0&&(h+=this.DB,--g)),c>0&&(e=!0),e&&(f+=int2char(c));return e?f:"0"}function bnNegate(){var a=nbi();return BigInteger.ZERO.subTo(this,a),a}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t;if(b=c-a.t,0!=b)return this.s<0?-b:b;for(;--c>=0;)if(0!=(b=this[c]-a[c]))return b;return 0}function nbits(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=(b=a>>1)&&(a=b,c+=1),c}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(a,b){var c;for(c=this.t-1;c>=0;--c)b[c+a]=this[c];for(c=a-1;c>=0;--c)b[c]=0;b.t=this.t+a,b.s=this.s}function bnpDRShiftTo(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0),b.s=this.s}function bnpLShiftTo(a,b){var c,d=a%this.DB,e=this.DB-d,f=(1<<e)-1,g=Math.floor(a/this.DB),h=this.s<<d&this.DM;for(c=this.t-1;c>=0;--c)b[c+g+1]=this[c]>>e|h,h=(this[c]&f)<<d;for(c=g-1;c>=0;--c)b[c]=0;b[g]=h,b.t=this.t+g+1,b.s=this.s,b.clamp()}function bnpRShiftTo(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)return void(b.t=0);var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b[0]=this[c]>>d;for(var g=c+1;g<this.t;++g)b[g-c-1]|=(this[g]&f)<<e,b[g-c]=this[g]>>d;d>0&&(b[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()}function bnpSubTo(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);c<e;)d+=this[c]-a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=d<0?-1:0,d<-1?b[c++]=this.DV+d:d>0&&(b[c++]=d),b.t=c,b.clamp()}function bnpMultiplyTo(a,b){var c=this.abs(),d=a.abs(),e=c.t;for(b.t=e+d.t;--e>=0;)b[e]=0;for(e=0;e<d.t;++e)b[e+c.t]=c.am(0,d[e],b,e,0,c.t);b.s=0,b.clamp(),this.s!=a.s&&BigInteger.ZERO.subTo(b,b)}function bnpSquareTo(a){for(var b=this.abs(),c=a.t=2*b.t;--c>=0;)a[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b[c],a,2*c,0,1);(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1)}a.t>0&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1)),a.s=0,a.clamp()}function bnpDivRemTo(a,b,c){var d=a.abs();if(!(d.t<=0)){var e=this.abs();if(e.t<d.t)return null!=b&&b.fromInt(0),void(null!=c&&this.copyTo(c));null==c&&(c=nbi());var f=nbi(),g=this.s,h=a.s,i=this.DB-nbits(d[d.t-1]);i>0?(d.lShiftTo(i,f),e.lShiftTo(i,c)):(d.copyTo(f),e.copyTo(c));var j=f.t,k=f[j-1];if(0!=k){var l=k*(1<<this.F1)+(j>1?f[j-2]>>this.F2:0),m=this.FV/l,n=(1<<this.F1)/l,o=1<<this.F2,p=c.t,q=p-j,r=null==b?nbi():b;for(f.dlShiftTo(q,r),c.compareTo(r)>=0&&(c[c.t++]=1,c.subTo(r,c)),BigInteger.ONE.dlShiftTo(j,r),r.subTo(f,f);f.t<j;)f[f.t++]=0;for(;--q>=0;){var s=c[--p]==k?this.DM:Math.floor(c[p]*m+(c[p-1]+o)*n);if((c[p]+=f.am(0,s,c,q,0,j))<s)for(f.dlShiftTo(q,r),c.subTo(r,c);c[p]<--s;)c.subTo(r,c)}null!=b&&(c.drShiftTo(j,b),g!=h&&BigInteger.ZERO.subTo(b,b)),c.t=j,c.clamp(),i>0&&c.rShiftTo(i,c),g<0&&BigInteger.ZERO.subTo(c,c)}}}function bnMod(a){var b=nbi();return this.abs().divRemTo(a,null,b),this.s<0&&b.compareTo(BigInteger.ZERO)>0&&a.subTo(b,b),b}function Classic(a){this.m=a}function cConvert(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a}function cRevert(a){return a}function cReduce(a){a.divRemTo(this.m,null,a)}function cMulTo(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function cSqrTo(a,b){a.squareTo(b),this.reduce(b)}function bnpInvDigit(){if(this.t<1)return 0;var a=this[0];if(0==(1&a))return 0;var b=3&a;return b=b*(2-(15&a)*b)&15,b=b*(2-(255&a)*b)&255,b=b*(2-((65535&a)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV,b>0?this.DV-b:-b}function Montgomery(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function montConvert(a){var b=nbi();return a.abs().dlShiftTo(this.m.t,b),b.divRemTo(this.m,null,b),a.s<0&&b.compareTo(BigInteger.ZERO)>0&&this.m.subTo(b,b),b}function montRevert(a){var b=nbi();return a.copyTo(b),this.reduce(b),b}function montReduce(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=32767&a[b],d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM;for(c=b+this.m.t,a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)}function montSqrTo(a,b){a.squareTo(b),this.reduce(b)}function montMulTo(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function bnpIsEven(){return 0==(this.t>0?1&this[0]:this.s)}function bnpExp(a,b){if(a>4294967295||a<1)return BigInteger.ONE;var c=nbi(),d=nbi(),e=b.convert(this),f=nbits(a)-1;for(e.copyTo(c);--f>=0;)if(b.sqrTo(c,d),(a&1<<f)>0)b.mulTo(d,e,c);else{var g=c;c=d,d=g}return b.revert(c)}function bnModPowInt(a,b){var c;return c=a<256||b.isEven()?new Classic(b):new Montgomery(b),this.exp(a,c)}function bnClone(){var a=nbi();return this.copyTo(a),a}function bnIntValue(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnByteValue(){return 0==this.t?this.s:this[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this[0]<<16>>16}function bnpChunkSize(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function bnSigNum(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function bnpToRadix(a){if(null==a&&(a=10),0==this.signum()||a<2||a>36)return"0";var b=this.chunkSize(a),c=Math.pow(a,b),d=nbv(c),e=nbi(),f=nbi(),g="";for(this.divRemTo(d,e,f);e.signum()>0;)g=(c+f.intValue()).toString(a).substr(1)+g,e.divRemTo(d,e,f);return f.intValue().toString(a)+g}function bnpFromRadix(a,b){this.fromInt(0),null==b&&(b=10);for(var c=this.chunkSize(b),d=Math.pow(b,c),e=!1,f=0,g=0,h=0;h<a.length;++h){var i=intAt(a,h);i<0?"-"==a.charAt(h)&&0==this.signum()&&(e=!0):(g=b*g+i,++f>=c&&(this.dMultiply(d),this.dAddOffset(g,0),f=0,g=0))}f>0&&(this.dMultiply(Math.pow(b,f)),this.dAddOffset(g,0)),e&&BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(a,b,c){if("number"==typeof b)if(a<2)this.fromInt(1);else for(this.fromNumber(a,c),this.testBit(a-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(a-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(BigInteger.ONE.shiftLeft(a-1),this);else{var d=new Array,e=7&a;d.length=(a>>3)+1,b.nextBytes(d),e>0?d[0]&=(1<<e)-1:d[0]=0,this.fromString(d,256)}}function bnToByteArray(){var a=this.t,b=new Array;b[0]=this.s;var c,d=this.DB-a*this.DB%8,e=0;if(a-- >0)for(d<this.DB&&(c=this[a]>>d)!=(this.s&this.DM)>>d&&(b[e++]=c|this.s<<this.DB-d);a>=0;)d<8?(c=(this[a]&(1<<d)-1)<<8-d,c|=this[--a]>>(d+=this.DB-8)):(c=this[a]>>(d-=8)&255,d<=0&&(d+=this.DB,--a)),0!=(128&c)&&(c|=-256),0==e&&(128&this.s)!=(128&c)&&++e,(e>0||c!=this.s)&&(b[e++]=c);return b}function bnEquals(a){return 0==this.compareTo(a)}function bnMin(a){return this.compareTo(a)<0?this:a}function bnMax(a){return this.compareTo(a)>0?this:a}function bnpBitwiseTo(a,b,c){var d,e,f=Math.min(a.t,this.t);for(d=0;d<f;++d)c[d]=b(this[d],a[d]);if(a.t<this.t){for(e=a.s&this.DM,d=f;d<this.t;++d)c[d]=b(this[d],e);c.t=this.t}else{for(e=this.s&this.DM,d=f;d<a.t;++d)c[d]=b(e,a[d]);c.t=a.t}c.s=b(this.s,a.s),c.clamp()}function op_and(a,b){return a&b}function bnAnd(a){var b=nbi();return this.bitwiseTo(a,op_and,b),b}function op_or(a,b){return a|b}function bnOr(a){var b=nbi();return this.bitwiseTo(a,op_or,b),b}function op_xor(a,b){return a^b}function bnXor(a){var b=nbi();return this.bitwiseTo(a,op_xor,b),b}function op_andnot(a,b){return a&~b}function bnAndNot(a){var b=nbi();return this.bitwiseTo(a,op_andnot,b),b}function bnNot(){for(var a=nbi(),b=0;b<this.t;++b)a[b]=this.DM&~this[b];return a.t=this.t,a.s=~this.s,a}function bnShiftLeft(a){var b=nbi();return a<0?this.rShiftTo(-a,b):this.lShiftTo(a,b),b}function bnShiftRight(a){var b=nbi();return a<0?this.lShiftTo(-a,b):this.rShiftTo(a,b),b}function lbit(a){if(0==a)return-1;var b=0;return 0==(65535&a)&&(a>>=16,b+=16),0==(255&a)&&(a>>=8,b+=8),0==(15&a)&&(a>>=4,b+=4),0==(3&a)&&(a>>=2,b+=2),0==(1&a)&&++b,b}function bnGetLowestSetBit(){for(var a=0;a<this.t;++a)if(0!=this[a])return a*this.DB+lbit(this[a]);return this.s<0?this.t*this.DB:-1}function cbit(a){for(var b=0;0!=a;)a&=a-1,++b;return b}function bnBitCount(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c)a+=cbit(this[c]^b);return a}function bnTestBit(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this[b]&1<<a%this.DB)}function bnpChangeBit(a,b){var c=BigInteger.ONE.shiftLeft(a);return this.bitwiseTo(c,b,c),c}function bnSetBit(a){return this.changeBit(a,op_or)}function bnClearBit(a){return this.changeBit(a,op_andnot)}function bnFlipBit(a){return this.changeBit(a,op_xor)}function bnpAddTo(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);c<e;)d+=this[c]+a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a[c],b[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=d<0?-1:0,d>0?b[c++]=d:d<-1&&(b[c++]=this.DV+d),b.t=c,b.clamp()}function bnAdd(a){var b=nbi();return this.addTo(a,b),b}function bnSubtract(a){var b=nbi();return this.subTo(a,b),b}function bnMultiply(a){var b=nbi();return this.multiplyTo(a,b),b}function bnSquare(){var a=nbi();return this.squareTo(a),a}function bnDivide(a){var b=nbi();return this.divRemTo(a,b,null),b}function bnRemainder(a){var b=nbi();return this.divRemTo(a,null,b),b}function bnDivideAndRemainder(a){var b=nbi(),c=nbi();return this.divRemTo(a,b,c),new Array(b,c)}function bnpDMultiply(a){this[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(a,b){if(0!=a){for(;this.t<=b;)this[this.t++]=0;for(this[b]+=a;this[b]>=this.DV;)this[b]-=this.DV,++b>=this.t&&(this[this.t++]=0),++this[b]}}function NullExp(){}function nNop(a){return a}function nMulTo(a,b,c){a.multiplyTo(b,c)}function nSqrTo(a,b){a.squareTo(b)}function bnPow(a){return this.exp(a,new NullExp)}function bnpMultiplyLowerTo(a,b,c){var d=Math.min(this.t+a.t,b);for(c.s=0,c.t=d;d>0;)c[--d]=0;var e;for(e=c.t-this.t;d<e;++d)c[d+this.t]=this.am(0,a[d],c,d,0,this.t);for(e=Math.min(a.t,b);d<e;++d)this.am(0,a[d],c,d,0,b-d);c.clamp()}function bnpMultiplyUpperTo(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;--d>=0;)c[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c[this.t+d-b]=this.am(b-d,a[d],c,0,0,this.t+d-b);c.clamp(),c.drShiftTo(1,c)}function Barrett(a){this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*a.t,this.r2),this.mu=this.r2.divide(a),this.m=a}function barrettConvert(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(a.compareTo(this.m)<0)return a;var b=nbi();return a.copyTo(b),this.reduce(b),b}function barrettRevert(a){return a}function barrettReduce(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);a.compareTo(this.r2)<0;)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)}function barrettSqrTo(a,b){a.squareTo(b),this.reduce(b)}function barrettMulTo(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function bnModPow(a,b){var c,d,e=a.bitLength(),f=nbv(1);if(e<=0)return f;c=e<18?1:e<48?3:e<144?4:e<768?5:6,d=e<8?new Classic(b):b.isEven()?new Barrett(b):new Montgomery(b);var g=new Array,h=3,i=c-1,j=(1<<c)-1;if(g[1]=d.convert(this),c>1){var k=nbi();for(d.sqrTo(g[1],k);h<=j;)g[h]=nbi(),d.mulTo(k,g[h-2],g[h]),h+=2}var l,m,n=a.t-1,o=!0,p=nbi();for(e=nbits(a[n])-1;n>=0;){for(e>=i?l=a[n]>>e-i&j:(l=(a[n]&(1<<e+1)-1)<<i-e,n>0&&(l|=a[n-1]>>this.DB+e-i)),h=c;0==(1&l);)l>>=1,--h;if((e-=h)<0&&(e+=this.DB,--n),o)g[l].copyTo(f),o=!1;else{for(;h>1;)d.sqrTo(f,p),d.sqrTo(p,f),h-=2;h>0?d.sqrTo(f,p):(m=f,f=p,p=m),d.mulTo(p,g[l],f)}for(;n>=0&&0==(a[n]&1<<e);)d.sqrTo(f,p),m=f,f=p,p=m,--e<0&&(e=this.DB-1,--n)}return d.revert(f)}function bnGCD(a){var b=this.s<0?this.negate():this.clone(),c=a.s<0?a.negate():a.clone();if(b.compareTo(c)<0){var d=b;b=c,c=d}var e=b.getLowestSetBit(),f=c.getLowestSetBit();if(f<0)return b;for(e<f&&(f=e),f>0&&(b.rShiftTo(f,b),c.rShiftTo(f,c));b.signum()>0;)(e=b.getLowestSetBit())>0&&b.rShiftTo(e,b),(e=c.getLowestSetBit())>0&&c.rShiftTo(e,c),b.compareTo(c)>=0?(b.subTo(c,b),b.rShiftTo(1,b)):(c.subTo(b,c),c.rShiftTo(1,c));return f>0&&c.lShiftTo(f,c),c}function bnpModInt(a){if(a<=0)return 0;var b=this.DV%a,c=this.s<0?a-1:0;if(this.t>0)if(0==b)c=this[0]%a;else for(var d=this.t-1;d>=0;--d)c=(b*c+this[d])%a;return c}function bnModInverse(a){var b=a.isEven();if(this.isEven()&&b||0==a.signum())return BigInteger.ZERO;for(var c=a.clone(),d=this.clone(),e=nbv(1),f=nbv(0),g=nbv(0),h=nbv(1);0!=c.signum();){for(;c.isEven();)c.rShiftTo(1,c),b?(e.isEven()&&f.isEven()||(e.addTo(this,e),f.subTo(a,f)),e.rShiftTo(1,e)):f.isEven()||f.subTo(a,f),f.rShiftTo(1,f);for(;d.isEven();)d.rShiftTo(1,d),b?(g.isEven()&&h.isEven()||(g.addTo(this,g),h.subTo(a,h)),g.rShiftTo(1,g)):h.isEven()||h.subTo(a,h),h.rShiftTo(1,h);c.compareTo(d)>=0?(c.subTo(d,c),b&&e.subTo(g,e),f.subTo(h,f)):(d.subTo(c,d),b&&g.subTo(e,g),h.subTo(f,h))}return 0!=d.compareTo(BigInteger.ONE)?BigInteger.ZERO:h.compareTo(a)>=0?h.subtract(a):h.signum()<0?(h.addTo(a,h),h.signum()<0?h.add(a):h):h}function bnIsProbablePrime(a){var b,c=this.abs();if(1==c.t&&c[0]<=lowprimes[lowprimes.length-1]){for(b=0;b<lowprimes.length;++b)if(c[0]==lowprimes[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<lowprimes.length;){for(var d=lowprimes[b],e=b+1;e<lowprimes.length&&d<lplim;)d*=lowprimes[e++];for(d=c.modInt(d);b<e;)if(d%lowprimes[b++]==0)return!1}return c.millerRabin(a)}function bnpMillerRabin(a){var b=this.subtract(BigInteger.ONE),c=b.getLowestSetBit();if(c<=0)return!1;var d=b.shiftRight(c);a=a+1>>1,a>lowprimes.length&&(a=lowprimes.length);for(var e=nbi(),f=0;f<a;++f){e.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var g=e.modPow(d,this);if(0!=g.compareTo(BigInteger.ONE)&&0!=g.compareTo(b)){for(var h=1;h++<c&&0!=g.compareTo(b);)if(g=g.modPowInt(2,this),0==g.compareTo(BigInteger.ONE))return!1;if(0!=g.compareTo(b))return!1}}return!0}function Arcfour(){this.i=0,this.j=0,this.S=new Array}function ARC4init(a){var b,c,d;for(b=0;b<256;++b)this.S[b]=b;for(c=0,b=0;b<256;++b)c=c+this.S[b]+a[b%a.length]&255,d=this.S[b],this.S[b]=this.S[c],this.S[c]=d;this.i=0,this.j=0}function ARC4next(){var a;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,a=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=a,this.S[a+this.S[this.i]&255]}function prng_newstate(){return new Arcfour}function rng_seed_int(a){rng_pool[rng_pptr++]^=255&a,rng_pool[rng_pptr++]^=a>>8&255,rng_pool[rng_pptr++]^=a>>16&255,rng_pool[rng_pptr++]^=a>>24&255,rng_pptr>=rng_psize&&(rng_pptr-=rng_psize)}function rng_seed_time(){rng_seed_int((new Date).getTime())}function rng_get_byte(){if(null==rng_state){for(rng_seed_time(),rng_state=prng_newstate(),rng_state.init(rng_pool),rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr)rng_pool[rng_pptr]=0;rng_pptr=0}return rng_state.next()}function rng_get_bytes(a){var b;for(b=0;b<a.length;++b)a[b]=rng_get_byte()}function SecureRandom(){}function parseBigInt(a,b){return new BigInteger(a,b)}function linebrk(a,b){for(var c="",d=0;d+b<a.length;)c+=a.substring(d,d+b)+"\n",d+=b;return c+a.substring(d,a.length)}function byte2Hex(a){return a<16?"0"+a.toString(16):a.toString(16)}function pkcs1pad2(a,b){if(b<a.length+11)return alert("Message too long for RSA"),null;for(var c=new Array,d=a.length-1;d>=0&&b>0;){var e=a.charCodeAt(d--);e<128?c[--b]=e:e>127&&e<2048?(c[--b]=63&e|128,c[--b]=e>>6|192):(c[--b]=63&e|128,c[--b]=e>>6&63|128,c[--b]=e>>12|224)}c[--b]=0;for(var f=new SecureRandom,g=new Array;b>2;){for(g[0]=0;0==g[0];)f.nextBytes(g);c[--b]=g[0]}return c[--b]=2,c[--b]=0,new BigInteger(c)}function oaep_mgf1_arr(a,b,c){for(var d="",e=0;d.length<b;)d+=c(String.fromCharCode.apply(String,a.concat([(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))),e+=1;return d}function oaep_pad(a,b,c){if(a.length+2*SHA1_SIZE+2>b)throw"Message too long for RSA";var d,e="";for(d=0;d<b-a.length-2*SHA1_SIZE-2;d+=1)e+="\0";var f=rstr_sha1("")+e+""+a,g=new Array(SHA1_SIZE);(new SecureRandom).nextBytes(g);var h=oaep_mgf1_arr(g,f.length,c||rstr_sha1),i=[];for(d=0;d<f.length;d+=1)i[d]=f.charCodeAt(d)^h.charCodeAt(d);var j=oaep_mgf1_arr(i,g.length,rstr_sha1),k=[0];for(d=0;d<g.length;d+=1)k[d+1]=g[d]^j.charCodeAt(d);return new BigInteger(k.concat(i))}function RSAKey(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function RSASetPublic(a,b){"string"!=typeof a?(this.n=a,this.e=b):null!=a&&null!=b&&a.length>0&&b.length>0?(this.n=parseBigInt(a,16),this.e=parseInt(b,16)):alert("Invalid RSA public key")}function RSADoPublic(a){return a.modPowInt(this.e,this.n)}function RSAEncrypt(a){var b=pkcs1pad2(a,this.n.bitLength()+7>>3);if(null==b)return null;var c=this.doPublic(b);if(null==c)return null;var d=c.toString(16);return 0==(1&d.length)?d:"0"+d}function RSAEncryptOAEP(a,b){var c=oaep_pad(a,this.n.bitLength()+7>>3,b);if(null==c)return null;var d=this.doPublic(c);if(null==d)return null;var e=d.toString(16);return 0==(1&e.length)?e:"0"+e}function pkcs1unpad2(a,b){for(var c=a.toByteArray(),d=0;d<c.length&&0==c[d];)++d;if(c.length-d!=b-1||2!=c[d])return null;for(++d;0!=c[d];)if(++d>=c.length)return null;for(var e="";++d<c.length;){var f=255&c[d];f<128?e+=String.fromCharCode(f):f>191&&f<224?(e+=String.fromCharCode((31&f)<<6|63&c[d+1]),++d):(e+=String.fromCharCode((15&f)<<12|(63&c[d+1])<<6|63&c[d+2]),d+=2)}return e}function oaep_mgf1_str(a,b,c){for(var d="",e=0;d.length<b;)d+=c(a+String.fromCharCode.apply(String,[(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e])),e+=1;return d}function oaep_unpad(a,b,c){a=a.toByteArray();var d;for(d=0;d<a.length;d+=1)a[d]&=255;for(;a.length<b;)a.unshift(0);if(a=String.fromCharCode.apply(String,a),a.length<2*SHA1_SIZE+2)throw"Cipher too short";var d,e=a.substr(1,SHA1_SIZE),f=a.substr(SHA1_SIZE+1),g=oaep_mgf1_str(f,SHA1_SIZE,c||rstr_sha1),h=[];for(d=0;d<e.length;d+=1)h[d]=e.charCodeAt(d)^g.charCodeAt(d);var i=oaep_mgf1_str(String.fromCharCode.apply(String,h),a.length-SHA1_SIZE,rstr_sha1),j=[];for(d=0;d<f.length;d+=1)j[d]=f.charCodeAt(d)^i.charCodeAt(d);if(j=String.fromCharCode.apply(String,j),j.substr(0,SHA1_SIZE)!==rstr_sha1(""))throw"Hash mismatch";j=j.substr(SHA1_SIZE);var k=j.indexOf(""),l=k!=-1?j.substr(0,k).lastIndexOf("\0"):-1;if(l+1!=k)throw"Malformed data";return j.substr(k+1)}function RSASetPrivate(a,b,c){"string"!=typeof a?(this.n=a,this.e=b,this.d=c):null!=a&&null!=b&&a.length>0&&b.length>0?(this.n=parseBigInt(a,16),this.e=parseInt(b,16),this.d=parseBigInt(c,16)):alert("Invalid RSA private key")}function RSASetPrivateEx(a,b,c,d,e,f,g,h){if(null==a)throw"RSASetPrivateEx N == null";if(null==b)throw"RSASetPrivateEx E == null";if(0==a.length)throw"RSASetPrivateEx N.length == 0";if(0==b.length)throw"RSASetPrivateEx E.length == 0";null!=a&&null!=b&&a.length>0&&b.length>0?(this.n=parseBigInt(a,16),this.e=parseInt(b,16),this.d=parseBigInt(c,16),this.p=parseBigInt(d,16),this.q=parseBigInt(e,16),this.dmp1=parseBigInt(f,16),this.dmq1=parseBigInt(g,16),this.coeff=parseBigInt(h,16)):alert("Invalid RSA private key in RSASetPrivateEx")}function RSAGenerate(a,b){var c=new SecureRandom,d=a>>1;this.e=parseInt(b,16);for(var e=new BigInteger(b,16);;){for(;this.p=new BigInteger(a-d,1,c),0!=this.p.subtract(BigInteger.ONE).gcd(e).compareTo(BigInteger.ONE)||!this.p.isProbablePrime(10););for(;this.q=new BigInteger(d,1,c),0!=this.q.subtract(BigInteger.ONE).gcd(e).compareTo(BigInteger.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var f=this.p;this.p=this.q,this.q=f}var g=this.p.subtract(BigInteger.ONE),h=this.q.subtract(BigInteger.ONE),i=g.multiply(h);if(0==i.gcd(e).compareTo(BigInteger.ONE)){this.n=this.p.multiply(this.q),this.d=e.modInverse(i),this.dmp1=this.d.mod(g),this.dmq1=this.d.mod(h),this.coeff=this.q.modInverse(this.p);break}}}function RSADoPrivate(a){if(null==this.p||null==this.q)return a.modPow(this.d,this.n);for(var b=a.mod(this.p).modPow(this.dmp1,this.p),c=a.mod(this.q).modPow(this.dmq1,this.q);b.compareTo(c)<0;)b=b.add(this.p);return b.subtract(c).multiply(this.coeff).mod(this.p).multiply(this.q).add(c)}function RSADecrypt(a){var b=parseBigInt(a,16),c=this.doPrivate(b);return null==c?null:pkcs1unpad2(c,this.n.bitLength()+7>>3)}function RSADecryptOAEP(a,b){var c=parseBigInt(a,16),d=this.doPrivate(c);return null==d?null:oaep_unpad(d,this.n.bitLength()+7>>3,b)}function ECFieldElementFp(a,b){this.x=b,this.q=a}function feFpEquals(a){return a==this||this.q.equals(a.q)&&this.x.equals(a.x)}function feFpToBigInteger(){return this.x}function feFpNegate(){return new ECFieldElementFp(this.q,this.x.negate().mod(this.q))}function feFpAdd(a){return new ECFieldElementFp(this.q,this.x.add(a.toBigInteger()).mod(this.q))}function feFpSubtract(a){return new ECFieldElementFp(this.q,this.x.subtract(a.toBigInteger()).mod(this.q))}function feFpMultiply(a){return new ECFieldElementFp(this.q,this.x.multiply(a.toBigInteger()).mod(this.q))}function feFpSquare(){return new ECFieldElementFp(this.q,this.x.square().mod(this.q))}function feFpDivide(a){return new ECFieldElementFp(this.q,this.x.multiply(a.toBigInteger().modInverse(this.q)).mod(this.q))}function ECPointFp(a,b,c,d){this.curve=a,this.x=b,this.y=c,null==d?this.z=BigInteger.ONE:this.z=d,this.zinv=null}function pointFpGetX(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function pointFpGetY(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function pointFpEquals(a){if(a==this)return!0;if(this.isInfinity())return a.isInfinity();if(a.isInfinity())return this.isInfinity();var b,c;return b=a.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(a.z)).mod(this.curve.q),!!b.equals(BigInteger.ZERO)&&(c=a.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(a.z)).mod(this.curve.q),c.equals(BigInteger.ZERO))}function pointFpIsInfinity(){return null==this.x&&null==this.y||this.z.equals(BigInteger.ZERO)&&!this.y.toBigInteger().equals(BigInteger.ZERO)}function pointFpNegate(){return new ECPointFp(this.curve,this.x,this.y.negate(),this.z)}function pointFpAdd(a){if(this.isInfinity())return a;if(a.isInfinity())return this;var b=a.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(a.z)).mod(this.curve.q),c=a.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(a.z)).mod(this.curve.q);if(BigInteger.ZERO.equals(c))return BigInteger.ZERO.equals(b)?this.twice():this.curve.getInfinity();var d=new BigInteger("3"),e=this.x.toBigInteger(),f=this.y.toBigInteger(),g=(a.x.toBigInteger(),a.y.toBigInteger(),c.square()),h=g.multiply(c),i=e.multiply(g),j=b.square().multiply(this.z),k=j.subtract(i.shiftLeft(1)).multiply(a.z).subtract(h).multiply(c).mod(this.curve.q),l=i.multiply(d).multiply(b).subtract(f.multiply(h)).subtract(j.multiply(b)).multiply(a.z).add(b.multiply(h)).mod(this.curve.q),m=h.multiply(this.z).multiply(a.z).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(k),this.curve.fromBigInteger(l),m)}function pointFpTwice(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var a=new BigInteger("3"),b=this.x.toBigInteger(),c=this.y.toBigInteger(),d=c.multiply(this.z),e=d.multiply(c).mod(this.curve.q),f=this.curve.a.toBigInteger(),g=b.square().multiply(a);BigInteger.ZERO.equals(f)||(g=g.add(this.z.square().multiply(f))),g=g.mod(this.curve.q);var h=g.square().subtract(b.shiftLeft(3).multiply(e)).shiftLeft(1).multiply(d).mod(this.curve.q),i=g.multiply(a).multiply(b).subtract(e.shiftLeft(1)).shiftLeft(2).multiply(e).subtract(g.square().multiply(g)).mod(this.curve.q),j=d.square().multiply(d).shiftLeft(3).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(h),this.curve.fromBigInteger(i),j)}function pointFpMultiply(a){if(this.isInfinity())return this;if(0==a.signum())return this.curve.getInfinity();var b,c=a,d=c.multiply(new BigInteger("3")),e=this.negate(),f=this;for(b=d.bitLength()-2;b>0;--b){f=f.twice();var g=d.testBit(b),h=c.testBit(b);g!=h&&(f=f.add(g?this:e))}return f}function pointFpMultiplyTwo(a,b,c){var d;d=a.bitLength()>c.bitLength()?a.bitLength()-1:c.bitLength()-1;for(var e=this.curve.getInfinity(),f=this.add(b);d>=0;)e=e.twice(),a.testBit(d)?e=c.testBit(d)?e.add(f):e.add(this):c.testBit(d)&&(e=e.add(b)),--d;return e}function ECCurveFp(a,b,c){this.q=a,this.a=this.fromBigInteger(b),this.b=this.fromBigInteger(c),this.infinity=new ECPointFp(this,null,null)}function curveFpGetQ(){return this.q}function curveFpGetA(){return this.a}function curveFpGetB(){return this.b}function curveFpEquals(a){return a==this||this.q.equals(a.q)&&this.a.equals(a.a)&&this.b.equals(a.b)}function curveFpGetInfinity(){return this.infinity}function curveFpFromBigInteger(a){return new ECFieldElementFp(this.q,a)}function curveFpDecodePointHex(a){switch(parseInt(a.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var b=(a.length-2)/2,c=a.substr(2,b),d=a.substr(b+2,b);return new ECPointFp(this,this.fromBigInteger(new BigInteger(c,16)),this.fromBigInteger(new BigInteger(d,16)));default:return null}}function Base64x(){}function stoBA(a){for(var b=new Array,c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b}function BAtos(a){for(var b="",c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return b}function BAtohex(a){for(var b="",c=0;c<a.length;c++){var d=a[c].toString(16);1==d.length&&(d="0"+d),b+=d}return b}function stohex(a){return BAtohex(stoBA(a))}function stob64(a){return hex2b64(stohex(a))}function stob64u(a){return b64tob64u(hex2b64(stohex(a)))}function b64utos(a){return BAtos(b64toBA(b64utob64(a)))}function b64tob64u(a){return a=a.replace(/\=/g,""),a=a.replace(/\+/g,"-"),a=a.replace(/\//g,"_")}function b64utob64(a){return a.length%4==2?a+="==":a.length%4==3&&(a+="="),a=a.replace(/-/g,"+"),a=a.replace(/_/g,"/")}function hextob64u(a){return b64tob64u(hex2b64(a))}function b64utohex(a){return b64tohex(b64utob64(a))}function utf8tob64(a){return hex2b64(uricmptohex(encodeURIComponentAll(a)))}function b64toutf8(a){return decodeURIComponent(hextouricmp(b64tohex(a)))}function utf8tohex(a){return uricmptohex(encodeURIComponentAll(a))}function hextoutf8(a){return decodeURIComponent(hextouricmp(a))}function hextorstr(a){for(var b="",c=0;c<a.length-1;c+=2)b+=String.fromCharCode(parseInt(a.substr(c,2),16));return b}function rstrtohex(a){for(var b="",c=0;c<a.length;c++)b+=("0"+a.charCodeAt(c).toString(16)).slice(-2);return b}function uricmptohex(a){return a.replace(/%/g,"")}function hextouricmp(a){return a.replace(/(..)/g,"%$1")}function encodeURIComponentAll(a){for(var b=encodeURIComponent(a),c="",d=0;d<b.length;d++)"%"==b[d]?(c+=b.substr(d,3),d+=2):c=c+"%"+stohex(b[d]);return c}function newline_toUnix(a){return a=a.replace(/\r\n/gm,"\n")}function newline_toDos(a){return a=a.replace(/\r\n/gm,"\n"),a=a.replace(/\n/gm,"\r\n")}function _rsapem_pemToBase64(a){var b=a;return b=b.replace("-----BEGIN RSA PRIVATE KEY-----",""),b=b.replace("-----END RSA PRIVATE KEY-----",""),b=b.replace(/[ \n]+/g,"")}function _rsapem_getPosArrayOfChildrenFromHex(a){var b=new Array,c=ASN1HEX.getStartPosOfV_AtObj(a,0),d=ASN1HEX.getPosOfNextSibling_AtObj(a,c),e=ASN1HEX.getPosOfNextSibling_AtObj(a,d),f=ASN1HEX.getPosOfNextSibling_AtObj(a,e),g=ASN1HEX.getPosOfNextSibling_AtObj(a,f),h=ASN1HEX.getPosOfNextSibling_AtObj(a,g),i=ASN1HEX.getPosOfNextSibling_AtObj(a,h),j=ASN1HEX.getPosOfNextSibling_AtObj(a,i),k=ASN1HEX.getPosOfNextSibling_AtObj(a,j);return b.push(c,d,e,f,g,h,i,j,k),b}function _rsapem_getHexValueArrayOfChildrenFromHex(a){var b=_rsapem_getPosArrayOfChildrenFromHex(a),c=ASN1HEX.getHexOfV_AtObj(a,b[0]),d=ASN1HEX.getHexOfV_AtObj(a,b[1]),e=ASN1HEX.getHexOfV_AtObj(a,b[2]),f=ASN1HEX.getHexOfV_AtObj(a,b[3]),g=ASN1HEX.getHexOfV_AtObj(a,b[4]),h=ASN1HEX.getHexOfV_AtObj(a,b[5]),i=ASN1HEX.getHexOfV_AtObj(a,b[6]),j=ASN1HEX.getHexOfV_AtObj(a,b[7]),k=ASN1HEX.getHexOfV_AtObj(a,b[8]),l=new Array;
return l.push(c,d,e,f,g,h,i,j,k),l}function _rsapem_readPrivateKeyFromASN1HexString(a){var b=_rsapem_getHexValueArrayOfChildrenFromHex(a);this.setPrivateEx(b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8])}function _rsapem_readPrivateKeyFromPEMString(a){var b=_rsapem_pemToBase64(a),c=b64tohex(b),d=_rsapem_getHexValueArrayOfChildrenFromHex(c);this.setPrivateEx(d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8])}function _rsasign_getHexPaddedDigestInfoForString(a,b,c){var d=function(a){return KJUR.crypto.Util.hashString(a,c)},e=d(a);return KJUR.crypto.Util.getPaddedDigestInfoHex(e,c,b)}function _zeroPaddingOfSignature(a,b){for(var c="",d=b/4-a.length,e=0;e<d;e++)c+="0";return c+a}function _rsasign_signString(a,b){var c=function(a){return KJUR.crypto.Util.hashString(a,b)},d=c(a);return this.signWithMessageHash(d,b)}function _rsasign_signWithMessageHash(a,b){var c=KJUR.crypto.Util.getPaddedDigestInfoHex(a,b,this.n.bitLength()),d=parseBigInt(c,16),e=this.doPrivate(d),f=e.toString(16);return _zeroPaddingOfSignature(f,this.n.bitLength())}function _rsasign_signStringWithSHA1(a){return _rsasign_signString.call(this,a,"sha1")}function _rsasign_signStringWithSHA256(a){return _rsasign_signString.call(this,a,"sha256")}function pss_mgf1_str(a,b,c){for(var d="",e=0;d.length<b;)d+=hextorstr(c(rstrtohex(a+String.fromCharCode.apply(String,[(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e])))),e+=1;return d}function _rsasign_signStringPSS(a,b,c){var d=function(a){return KJUR.crypto.Util.hashHex(a,b)},e=d(rstrtohex(a));return void 0===c&&(c=-1),this.signWithMessageHashPSS(e,b,c)}function _rsasign_signWithMessageHashPSS(a,b,c){var d,e=hextorstr(a),f=e.length,g=this.n.bitLength()-1,h=Math.ceil(g/8),i=function(a){return KJUR.crypto.Util.hashHex(a,b)};if(c===-1||void 0===c)c=f;else if(c===-2)c=h-f-2;else if(c<-2)throw"invalid salt length";if(h<f+c+2)throw"data too long";var j="";c>0&&(j=new Array(c),(new SecureRandom).nextBytes(j),j=String.fromCharCode.apply(String,j));var k=hextorstr(i(rstrtohex("\0\0\0\0\0\0\0\0"+e+j))),l=[];for(d=0;d<h-c-f-2;d+=1)l[d]=0;var m=String.fromCharCode.apply(String,l)+""+j,n=pss_mgf1_str(k,m.length,i),o=[];for(d=0;d<m.length;d+=1)o[d]=m.charCodeAt(d)^n.charCodeAt(d);var p=65280>>8*h-g&255;for(o[0]&=~p,d=0;d<f;d++)o.push(k.charCodeAt(d));return o.push(188),_zeroPaddingOfSignature(this.doPrivate(new BigInteger(o)).toString(16),this.n.bitLength())}function _rsasign_getDecryptSignatureBI(a,b,c){var d=new RSAKey;d.setPublic(b,c);var e=d.doPublic(a);return e}function _rsasign_getHexDigestInfoFromSig(a,b,c){var d=_rsasign_getDecryptSignatureBI(a,b,c),e=d.toString(16).replace(/^1f+00/,"");return e}function _rsasign_getAlgNameAndHashFromHexDisgestInfo(a){for(var b in KJUR.crypto.Util.DIGESTINFOHEAD){var c=KJUR.crypto.Util.DIGESTINFOHEAD[b],d=c.length;if(a.substring(0,d)==c){var e=[b,a.substring(d)];return e}}return[]}function _rsasign_verifySignatureWithArgs(a,b,c,d){var e=_rsasign_getHexDigestInfoFromSig(b,c,d),f=_rsasign_getAlgNameAndHashFromHexDisgestInfo(e);if(0==f.length)return!1;var g=f[0],h=f[1],i=function(a){return KJUR.crypto.Util.hashString(a,g)},j=i(a);return h==j}function _rsasign_verifyHexSignatureForMessage(a,b){var c=parseBigInt(a,16),d=_rsasign_verifySignatureWithArgs(b,c,this.n.toString(16),this.e.toString(16));return d}function _rsasign_verifyString(a,b){b=b.replace(_RE_HEXDECONLY,""),b=b.replace(/[ \n]+/g,"");var c=parseBigInt(b,16);if(c.bitLength()>this.n.bitLength())return 0;var d=this.doPublic(c),e=d.toString(16).replace(/^1f+00/,""),f=_rsasign_getAlgNameAndHashFromHexDisgestInfo(e);if(0==f.length)return!1;var g=f[0],h=f[1],i=function(a){return KJUR.crypto.Util.hashString(a,g)},j=i(a);return h==j}function _rsasign_verifyWithMessageHash(a,b){b=b.replace(_RE_HEXDECONLY,""),b=b.replace(/[ \n]+/g,"");var c=parseBigInt(b,16);if(c.bitLength()>this.n.bitLength())return 0;var d=this.doPublic(c),e=d.toString(16).replace(/^1f+00/,""),f=_rsasign_getAlgNameAndHashFromHexDisgestInfo(e);if(0==f.length)return!1;var g=(f[0],f[1]);return g==a}function _rsasign_verifyStringPSS(a,b,c,d){var e=function(a){return KJUR.crypto.Util.hashHex(a,c)},f=e(rstrtohex(a));return void 0===d&&(d=-1),this.verifyWithMessageHashPSS(f,b,c,d)}function _rsasign_verifyWithMessageHashPSS(a,b,c,d){var e=new BigInteger(b,16);if(e.bitLength()>this.n.bitLength())return!1;var f,g=function(a){return KJUR.crypto.Util.hashHex(a,c)},h=hextorstr(a),i=h.length,j=this.n.bitLength()-1,k=Math.ceil(j/8);if(d===-1||void 0===d)d=i;else if(d===-2)d=k-i-2;else if(d<-2)throw"invalid salt length";if(k<i+d+2)throw"data too long";var l=this.doPublic(e).toByteArray();for(f=0;f<l.length;f+=1)l[f]&=255;for(;l.length<k;)l.unshift(0);if(188!==l[k-1])throw"encoded message does not end in 0xbc";l=String.fromCharCode.apply(String,l);var m=l.substr(0,k-i-1),n=l.substr(m.length,i),o=65280>>8*k-j&255;if(0!==(m.charCodeAt(0)&o))throw"bits beyond keysize not zero";var p=pss_mgf1_str(n,m.length,g),q=[];for(f=0;f<m.length;f+=1)q[f]=m.charCodeAt(f)^p.charCodeAt(f);q[0]&=~o;var r=k-i-d-2;for(f=0;f<r;f+=1)if(0!==q[f])throw"leftmost octets not zero";if(1!==q[r])throw"0x01 marker not found";return n===hextorstr(g(rstrtohex("\0\0\0\0\0\0\0\0"+h+String.fromCharCode.apply(String,q.slice(-d)))))}function X509(){this.subjectPublicKeyRSA=null,this.subjectPublicKeyRSA_hN=null,this.subjectPublicKeyRSA_hE=null,this.hex=null,this.getSerialNumberHex=function(){return ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,1])},this.getIssuerHex=function(){return ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,3])},this.getIssuerString=function(){return X509.hex2dn(ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,3]))},this.getSubjectHex=function(){return ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,5])},this.getSubjectString=function(){return X509.hex2dn(ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,5]))},this.getNotBefore=function(){var a=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,4,0]);return a=a.replace(/(..)/g,"%$1"),a=decodeURIComponent(a)},this.getNotAfter=function(){var a=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,4,1]);return a=a.replace(/(..)/g,"%$1"),a=decodeURIComponent(a)},this.readCertPEM=function(a){var b=X509.pemToHex(a),c=X509.getPublicKeyHexArrayFromCertHex(b),d=new RSAKey;d.setPublic(c[0],c[1]),this.subjectPublicKeyRSA=d,this.subjectPublicKeyRSA_hN=c[0],this.subjectPublicKeyRSA_hE=c[1],this.hex=b},this.readCertPEMWithoutRSAInit=function(a){var b=X509.pemToHex(a),c=X509.getPublicKeyHexArrayFromCertHex(b);this.subjectPublicKeyRSA.setPublic(c[0],c[1]),this.subjectPublicKeyRSA_hN=c[0],this.subjectPublicKeyRSA_hE=c[1],this.hex=b}}function trace(a){if("\n"===a[a.length-1]&&(a=a.substring(0,a.length-1)),window.performance){var b=(window.performance.now()/1e3).toFixed(3);webrtcUtils.log(b+": "+a)}else webrtcUtils.log(a)}function requestUserMedia(a){return new Promise(function(b,c){getUserMedia(a,b,c)})}var twemoji=function(){"use strict";function a(a){return document.createTextNode(a)}function b(a){return a.replace(s,h)}function c(a,b){return"".concat(b.base,b.size,"/",a,b.ext)}function d(a,b){for(var c,e,f=a.childNodes,g=f.length;g--;)c=f[g],e=c.nodeType,3===e?b.push(c):1!==e||t.test(c.nodeName)||d(c,b);return b}function e(a,b){return o("️"===b?a.slice(0,-1):3===a.length&&"️"===a.charAt(1)?a.charAt(0)+a.charAt(2):a)}function f(b,c){for(var f,g,h,i,j,k,l,m,n,o,q,s,t,u,v=d(b,[]),w=v.length;w--;){for(h=!1,i=document.createDocumentFragment(),j=v[w],k=j.nodeValue,m=0;l=r.exec(k);){if(n=l.index,n!==m&&i.appendChild(a(k.slice(m,n))),q=l[0],s=l[1],t=l[2],m=n+q.length,"︎"!==t&&(u=c.callback(e(s,t),c,t))){o=new Image,o.onerror=p.onerror,o.setAttribute("draggable","false"),f=c.attributes(s,t);for(g in f)f.hasOwnProperty(g)&&0!==g.indexOf("on")&&!o.hasAttribute(g)&&o.setAttribute(g,f[g]);o.className=c.className,o.alt=q,o.src=u,h=!0,i.appendChild(o)}o||i.appendChild(a(q)),o=null}h&&(m<k.length&&i.appendChild(a(k.slice(m))),j.parentNode.replaceChild(i,j))}return b}function g(a,c){return m(a,function(a,d,f){var g,h,i,j=a;if("︎"!==f&&(i=c.callback(e(d,f),c,f))){j="<img ".concat('class="',c.className,'" ','draggable="false" ','alt="',a,'"',' src="',i,'"'),g=c.attributes(d,f);for(h in g)g.hasOwnProperty(h)&&0!==h.indexOf("on")&&j.indexOf(" "+h+"=")===-1&&(j=j.concat(" ",h,'="',b(g[h]),'"'));j=j.concat(">")}return j})}function h(a){return q[a]}function i(){return null}function j(a){return"number"==typeof a?a+"x"+a:a}function k(a){var b="string"==typeof a?parseInt(a,16):a;return b<65536?u(b):(b-=65536,u(55296+(b>>10),56320+(1023&b)))}function l(a,b){return b&&"function"!=typeof b||(b={callback:b}),("string"==typeof a?g:f)(a,{callback:b.callback||c,attributes:"function"==typeof b.attributes?b.attributes:i,base:"string"==typeof b.base?b.base:p.base,ext:b.ext||p.ext,size:b.folder||j(b.size||p.size),className:b.className||p.className})}function m(a,b){return String(a).replace(r,b)}function n(a){r.lastIndex=0;var b=r.test(a);return r.lastIndex=0,b}function o(a,b){for(var c=[],d=0,e=0,f=0;f<a.length;)d=a.charCodeAt(f++),e?(c.push((65536+(e-55296<<10)+(d-56320)).toString(16)),e=0):55296<=d&&d<=56319?e=d:c.push(d.toString(16));return c.join(b||"-")}var p={base:("https:"===location.protocol?"https:":"http:")+"//twemoji.maxcdn.com/",ext:".png",size:"36x36",className:"emoji",convert:{fromCodePoint:k,toCodePoint:o},onerror:function(){this.parentNode&&this.parentNode.replaceChild(a(this.alt),this)},parse:l,replace:m,test:n},q={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},r=/((?:\ud83c\udde8\ud83c\uddf3|\ud83c\uddfa\ud83c\uddf8|\ud83c\uddf7\ud83c\uddfa|\ud83c\uddf0\ud83c\uddf7|\ud83c\uddef\ud83c\uddf5|\ud83c\uddee\ud83c\uddf9|\ud83c\uddec\ud83c\udde7|\ud83c\uddeb\ud83c\uddf7|\ud83c\uddea\ud83c\uddf8|\ud83c\udde9\ud83c\uddea|\u0039\ufe0f?\u20e3|\u0038\ufe0f?\u20e3|\u0037\ufe0f?\u20e3|\u0036\ufe0f?\u20e3|\u0035\ufe0f?\u20e3|\u0034\ufe0f?\u20e3|\u0033\ufe0f?\u20e3|\u0032\ufe0f?\u20e3|\u0031\ufe0f?\u20e3|\u0030\ufe0f?\u20e3|\u0023\ufe0f?\u20e3|\ud83d\udeb3|\ud83d\udeb1|\ud83d\udeb0|\ud83d\udeaf|\ud83d\udeae|\ud83d\udea6|\ud83d\udea3|\ud83d\udea1|\ud83d\udea0|\ud83d\ude9f|\ud83d\ude9e|\ud83d\ude9d|\ud83d\ude9c|\ud83d\ude9b|\ud83d\ude98|\ud83d\ude96|\ud83d\ude94|\ud83d\ude90|\ud83d\ude8e|\ud83d\ude8d|\ud83d\ude8b|\ud83d\ude8a|\ud83d\ude88|\ud83d\ude86|\ud83d\ude82|\ud83d\ude81|\ud83d\ude36|\ud83d\ude34|\ud83d\ude2f|\ud83d\ude2e|\ud83d\ude2c|\ud83d\ude27|\ud83d\ude26|\ud83d\ude1f|\ud83d\ude1b|\ud83d\ude19|\ud83d\ude17|\ud83d\ude15|\ud83d\ude11|\ud83d\ude10|\ud83d\ude0e|\ud83d\ude08|\ud83d\ude07|\ud83d\ude00|\ud83d\udd67|\ud83d\udd66|\ud83d\udd65|\ud83d\udd64|\ud83d\udd63|\ud83d\udd62|\ud83d\udd61|\ud83d\udd60|\ud83d\udd5f|\ud83d\udd5e|\ud83d\udd5d|\ud83d\udd5c|\ud83d\udd2d|\ud83d\udd2c|\ud83d\udd15|\ud83d\udd09|\ud83d\udd08|\ud83d\udd07|\ud83d\udd06|\ud83d\udd05|\ud83d\udd04|\ud83d\udd02|\ud83d\udd01|\ud83d\udd00|\ud83d\udcf5|\ud83d\udcef|\ud83d\udced|\ud83d\udcec|\ud83d\udcb7|\ud83d\udcb6|\ud83d\udcad|\ud83d\udc6d|\ud83d\udc6c|\ud83d\udc65|\ud83d\udc2a|\ud83d\udc16|\ud83d\udc15|\ud83d\udc13|\ud83d\udc10|\ud83d\udc0f|\ud83d\udc0b|\ud83d\udc0a|\ud83d\udc09|\ud83d\udc08|\ud83d\udc07|\ud83d\udc06|\ud83d\udc05|\ud83d\udc04|\ud83d\udc03|\ud83d\udc02|\ud83d\udc01|\ud83d\udc00|\ud83c\udfe4|\ud83c\udfc9|\ud83c\udfc7|\ud83c\udf7c|\ud83c\udf50|\ud83c\udf4b|\ud83c\udf33|\ud83c\udf32|\ud83c\udf1e|\ud83c\udf1d|\ud83c\udf1c|\ud83c\udf1a|\ud83c\udf18|\ud83c\udccf|\ud83c\udd70|\ud83c\udd71|\ud83c\udd7e|\ud83c\udd8e|\ud83c\udd91|\ud83c\udd92|\ud83c\udd93|\ud83c\udd94|\ud83c\udd95|\ud83c\udd96|\ud83c\udd97|\ud83c\udd98|\ud83c\udd99|\ud83c\udd9a|\ud83d\udc77|\ud83d\udec5|\ud83d\udec4|\ud83d\udec3|\ud83d\udec2|\ud83d\udec1|\ud83d\udebf|\ud83d\udeb8|\ud83d\udeb7|\ud83d\udeb5|\ud83c\ude01|\ud83c\ude02|\ud83c\ude32|\ud83c\ude33|\ud83c\ude34|\ud83c\ude35|\ud83c\ude36|\ud83c\ude37|\ud83c\ude38|\ud83c\ude39|\ud83c\ude3a|\ud83c\ude50|\ud83c\ude51|\ud83c\udf00|\ud83c\udf01|\ud83c\udf02|\ud83c\udf03|\ud83c\udf04|\ud83c\udf05|\ud83c\udf06|\ud83c\udf07|\ud83c\udf08|\ud83c\udf09|\ud83c\udf0a|\ud83c\udf0b|\ud83c\udf0c|\ud83c\udf0f|\ud83c\udf11|\ud83c\udf13|\ud83c\udf14|\ud83c\udf15|\ud83c\udf19|\ud83c\udf1b|\ud83c\udf1f|\ud83c\udf20|\ud83c\udf30|\ud83c\udf31|\ud83c\udf34|\ud83c\udf35|\ud83c\udf37|\ud83c\udf38|\ud83c\udf39|\ud83c\udf3a|\ud83c\udf3b|\ud83c\udf3c|\ud83c\udf3d|\ud83c\udf3e|\ud83c\udf3f|\ud83c\udf40|\ud83c\udf41|\ud83c\udf42|\ud83c\udf43|\ud83c\udf44|\ud83c\udf45|\ud83c\udf46|\ud83c\udf47|\ud83c\udf48|\ud83c\udf49|\ud83c\udf4a|\ud83c\udf4c|\ud83c\udf4d|\ud83c\udf4e|\ud83c\udf4f|\ud83c\udf51|\ud83c\udf52|\ud83c\udf53|\ud83c\udf54|\ud83c\udf55|\ud83c\udf56|\ud83c\udf57|\ud83c\udf58|\ud83c\udf59|\ud83c\udf5a|\ud83c\udf5b|\ud83c\udf5c|\ud83c\udf5d|\ud83c\udf5e|\ud83c\udf5f|\ud83c\udf60|\ud83c\udf61|\ud83c\udf62|\ud83c\udf63|\ud83c\udf64|\ud83c\udf65|\ud83c\udf66|\ud83c\udf67|\ud83c\udf68|\ud83c\udf69|\ud83c\udf6a|\ud83c\udf6b|\ud83c\udf6c|\ud83c\udf6d|\ud83c\udf6e|\ud83c\udf6f|\ud83c\udf70|\ud83c\udf71|\ud83c\udf72|\ud83c\udf73|\ud83c\udf74|\ud83c\udf75|\ud83c\udf76|\ud83c\udf77|\ud83c\udf78|\ud83c\udf79|\ud83c\udf7a|\ud83c\udf7b|\ud83c\udf80|\ud83c\udf81|\ud83c\udf82|\ud83c\udf83|\ud83c\udf84|\ud83c\udf85|\ud83c\udf86|\ud83c\udf87|\ud83c\udf88|\ud83c\udf89|\ud83c\udf8a|\ud83c\udf8b|\ud83c\udf8c|\ud83c\udf8d|\ud83c\udf8e|\ud83c\udf8f|\ud83c\udf90|\ud83c\udf91|\ud83c\udf92|\ud83c\udf93|\ud83c\udfa0|\ud83c\udfa1|\ud83c\udfa2|\ud83c\udfa3|\ud83c\udfa4|\ud83c\udfa5|\ud83c\udfa6|\ud83c\udfa7|\ud83c\udfa8|\ud83c\udfa9|\ud83c\udfaa|\ud83c\udfab|\ud83c\udfac|\ud83c\udfad|\ud83c\udfae|\ud83c\udfaf|\ud83c\udfb0|\ud83c\udfb1|\ud83c\udfb2|\ud83c\udfb3|\ud83c\udfb4|\ud83c\udfb5|\ud83c\udfb6|\ud83c\udfb7|\ud83c\udfb8|\ud83c\udfb9|\ud83c\udfba|\ud83c\udfbb|\ud83c\udfbc|\ud83c\udfbd|\ud83c\udfbe|\ud83c\udfbf|\ud83c\udfc0|\ud83c\udfc1|\ud83c\udfc2|\ud83c\udfc3|\ud83c\udfc4|\ud83c\udfc6|\ud83c\udfc8|\ud83c\udfca|\ud83c\udfe0|\ud83c\udfe1|\ud83c\udfe2|\ud83c\udfe3|\ud83c\udfe5|\ud83c\udfe6|\ud83c\udfe7|\ud83c\udfe8|\ud83c\udfe9|\ud83c\udfea|\ud83c\udfeb|\ud83c\udfec|\ud83c\udfed|\ud83c\udfee|\ud83c\udfef|\ud83c\udff0|\ud83d\udc0c|\ud83d\udc0d|\ud83d\udc0e|\ud83d\udc11|\ud83d\udc12|\ud83d\udc14|\ud83d\udc17|\ud83d\udc18|\ud83d\udc19|\ud83d\udc1a|\ud83d\udc1b|\ud83d\udc1c|\ud83d\udc1d|\ud83d\udc1e|\ud83d\udc1f|\ud83d\udc20|\ud83d\udc21|\ud83d\udc22|\ud83d\udc23|\ud83d\udc24|\ud83d\udc25|\ud83d\udc26|\ud83d\udc27|\ud83d\udc28|\ud83d\udc29|\ud83d\udc2b|\ud83d\udc2c|\ud83d\udc2d|\ud83d\udc2e|\ud83d\udc2f|\ud83d\udc30|\ud83d\udc31|\ud83d\udc32|\ud83d\udc33|\ud83d\udc34|\ud83d\udc35|\ud83d\udc36|\ud83d\udc37|\ud83d\udc38|\ud83d\udc39|\ud83d\udc3a|\ud83d\udc3b|\ud83d\udc3c|\ud83d\udc3d|\ud83d\udc3e|\ud83d\udc40|\ud83d\udc42|\ud83d\udc43|\ud83d\udc44|\ud83d\udc45|\ud83d\udc46|\ud83d\udc47|\ud83d\udc48|\ud83d\udc49|\ud83d\udc4a|\ud83d\udc4b|\ud83d\udc4c|\ud83d\udc4d|\ud83d\udc4e|\ud83d\udc4f|\ud83d\udc50|\ud83d\udc51|\ud83d\udc52|\ud83d\udc53|\ud83d\udc54|\ud83d\udc55|\ud83d\udc56|\ud83d\udc57|\ud83d\udc58|\ud83d\udc59|\ud83d\udc5a|\ud83d\udc5b|\ud83d\udc5c|\ud83d\udc5d|\ud83d\udc5e|\ud83d\udc5f|\ud83d\udc60|\ud83d\udc61|\ud83d\udc62|\ud83d\udc63|\ud83d\udc64|\ud83d\udc66|\ud83d\udc67|\ud83d\udc68|\ud83d\udc69|\ud83d\udc6a|\ud83d\udc6b|\ud83d\udc6e|\ud83d\udc6f|\ud83d\udc70|\ud83d\udc71|\ud83d\udc72|\ud83d\udc73|\ud83d\udc74|\ud83d\udc75|\ud83d\udc76|\ud83d\udeb4|\ud83d\udc78|\ud83d\udc79|\ud83d\udc7a|\ud83d\udc7b|\ud83d\udc7c|\ud83d\udc7d|\ud83d\udc7e|\ud83d\udc7f|\ud83d\udc80|\ud83d\udc81|\ud83d\udc82|\ud83d\udc83|\ud83d\udc84|\ud83d\udc85|\ud83d\udc86|\ud83d\udc87|\ud83d\udc88|\ud83d\udc89|\ud83d\udc8a|\ud83d\udc8b|\ud83d\udc8c|\ud83d\udc8d|\ud83d\udc8e|\ud83d\udc8f|\ud83d\udc90|\ud83d\udc91|\ud83d\udc92|\ud83d\udc93|\ud83d\udc94|\ud83d\udc95|\ud83d\udc96|\ud83d\udc97|\ud83d\udc98|\ud83d\udc99|\ud83d\udc9a|\ud83d\udc9b|\ud83d\udc9c|\ud83d\udc9d|\ud83d\udc9e|\ud83d\udc9f|\ud83d\udca0|\ud83d\udca1|\ud83d\udca2|\ud83d\udca3|\ud83d\udca4|\ud83d\udca5|\ud83d\udca6|\ud83d\udca7|\ud83d\udca8|\ud83d\udca9|\ud83d\udcaa|\ud83d\udcab|\ud83d\udcac|\ud83d\udcae|\ud83d\udcaf|\ud83d\udcb0|\ud83d\udcb1|\ud83d\udcb2|\ud83d\udcb3|\ud83d\udcb4|\ud83d\udcb5|\ud83d\udcb8|\ud83d\udcb9|\ud83d\udcba|\ud83d\udcbb|\ud83d\udcbc|\ud83d\udcbd|\ud83d\udcbe|\ud83d\udcbf|\ud83d\udcc0|\ud83d\udcc1|\ud83d\udcc2|\ud83d\udcc3|\ud83d\udcc4|\ud83d\udcc5|\ud83d\udcc6|\ud83d\udcc7|\ud83d\udcc8|\ud83d\udcc9|\ud83d\udcca|\ud83d\udccb|\ud83d\udccc|\ud83d\udccd|\ud83d\udcce|\ud83d\udccf|\ud83d\udcd0|\ud83d\udcd1|\ud83d\udcd2|\ud83d\udcd3|\ud83d\udcd4|\ud83d\udcd5|\ud83d\udcd6|\ud83d\udcd7|\ud83d\udcd8|\ud83d\udcd9|\ud83d\udcda|\ud83d\udcdb|\ud83d\udcdc|\ud83d\udcdd|\ud83d\udcde|\ud83d\udcdf|\ud83d\udce0|\ud83d\udce1|\ud83d\udce2|\ud83d\udce3|\ud83d\udce4|\ud83d\udce5|\ud83d\udce6|\ud83d\udce7|\ud83d\udce8|\ud83d\udce9|\ud83d\udcea|\ud83d\udceb|\ud83d\udcee|\ud83d\udcf0|\ud83d\udcf1|\ud83d\udcf2|\ud83d\udcf3|\ud83d\udcf4|\ud83d\udcf6|\ud83d\udcf7|\ud83d\udcf9|\ud83d\udcfa|\ud83d\udcfb|\ud83d\udcfc|\ud83d\udd03|\ud83d\udd0a|\ud83d\udd0b|\ud83d\udd0c|\ud83d\udd0d|\ud83d\udd0e|\ud83d\udd0f|\ud83d\udd10|\ud83d\udd11|\ud83d\udd12|\ud83d\udd13|\ud83d\udd14|\ud83d\udd16|\ud83d\udd17|\ud83d\udd18|\ud83d\udd19|\ud83d\udd1a|\ud83d\udd1b|\ud83d\udd1c|\ud83d\udd1d|\ud83d\udd1e|\ud83d\udd1f|\ud83d\udd20|\ud83d\udd21|\ud83d\udd22|\ud83d\udd23|\ud83d\udd24|\ud83d\udd25|\ud83d\udd26|\ud83d\udd27|\ud83d\udd28|\ud83d\udd29|\ud83d\udd2a|\ud83d\udd2b|\ud83d\udd2e|\ud83d\udd2f|\ud83d\udd30|\ud83d\udd31|\ud83d\udd32|\ud83d\udd33|\ud83d\udd34|\ud83d\udd35|\ud83d\udd36|\ud83d\udd37|\ud83d\udd38|\ud83d\udd39|\ud83d\udd3a|\ud83d\udd3b|\ud83d\udd3c|\ud83d\udd3d|\ud83d\udd50|\ud83d\udd51|\ud83d\udd52|\ud83d\udd53|\ud83d\udd54|\ud83d\udd55|\ud83d\udd56|\ud83d\udd57|\ud83d\udd58|\ud83d\udd59|\ud83d\udd5a|\ud83d\udd5b|\ud83d\uddfb|\ud83d\uddfc|\ud83d\uddfd|\ud83d\uddfe|\ud83d\uddff|\ud83d\ude01|\ud83d\ude02|\ud83d\ude03|\ud83d\ude04|\ud83d\ude05|\ud83d\ude06|\ud83d\ude09|\ud83d\ude0a|\ud83d\ude0b|\ud83d\ude0c|\ud83d\ude0d|\ud83d\ude0f|\ud83d\ude12|\ud83d\ude13|\ud83d\ude14|\ud83d\ude16|\ud83d\ude18|\ud83d\ude1a|\ud83d\ude1c|\ud83d\ude1d|\ud83d\ude1e|\ud83d\ude20|\ud83d\ude21|\ud83d\ude22|\ud83d\ude23|\ud83d\ude24|\ud83d\ude25|\ud83d\ude28|\ud83d\ude29|\ud83d\ude2a|\ud83d\ude2b|\ud83d\ude2d|\ud83d\ude30|\ud83d\ude31|\ud83d\ude32|\ud83d\ude33|\ud83d\ude35|\ud83d\ude37|\ud83d\ude38|\ud83d\ude39|\ud83d\ude3a|\ud83d\ude3b|\ud83d\ude3c|\ud83d\ude3d|\ud83d\ude3e|\ud83d\ude3f|\ud83d\ude40|\ud83d\ude45|\ud83d\ude46|\ud83d\ude47|\ud83d\ude48|\ud83d\ude49|\ud83d\ude4a|\ud83d\ude4b|\ud83d\ude4c|\ud83d\ude4d|\ud83d\ude4e|\ud83d\ude4f|\ud83d\ude80|\ud83d\ude83|\ud83d\ude84|\ud83d\ude85|\ud83d\ude87|\ud83d\ude89|\ud83d\ude8c|\ud83d\ude8f|\ud83d\ude91|\ud83d\ude92|\ud83d\ude93|\ud83d\ude95|\ud83d\ude97|\ud83d\ude99|\ud83d\ude9a|\ud83d\udea2|\ud83d\udea4|\ud83d\udea5|\ud83d\udea7|\ud83d\udea8|\ud83d\udea9|\ud83d\udeaa|\ud83d\udeab|\ud83d\udeac|\ud83d\udead|\ud83d\udeb2|\ud83d\udeb6|\ud83d\udeb9|\ud83d\udeba|\ud83d\udebb|\ud83d\udebc|\ud83d\udebd|\ud83d\udebe|\ud83d\udec0|\ud83c\udde6|\ud83c\udde7|\ud83c\udde8|\ud83c\udde9|\ud83c\uddea|\ud83c\uddeb|\ud83c\uddec|\ud83c\udded|\ud83c\uddee|\ud83c\uddef|\ud83c\uddf0|\ud83c\uddf1|\ud83c\uddf2|\ud83c\uddf3|\ud83c\uddf4|\ud83c\uddf5|\ud83c\uddf6|\ud83c\uddf7|\ud83c\uddf8|\ud83c\uddf9|\ud83c\uddfa|\ud83c\uddfb|\ud83c\uddfc|\ud83c\uddfd|\ud83c\uddfe|\ud83c\uddff|\ud83c\udf0d|\ud83c\udf0e|\ud83c\udf10|\ud83c\udf12|\ud83c\udf16|\ud83c\udf17|\ue50a|\u3030|\u27b0|\u2797|\u2796|\u2795|\u2755|\u2754|\u2753|\u274e|\u274c|\u2728|\u270b|\u270a|\u2705|\u26ce|\u23f3|\u23f0|\u23ec|\u23eb|\u23ea|\u23e9|\u2122|\u27bf|\u00a9|\u00ae)|(?:(?:\ud83c\udc04|\ud83c\udd7f|\ud83c\ude1a|\ud83c\ude2f|\u3299|\u303d|\u2b55|\u2b50|\u2b1c|\u2b1b|\u2b07|\u2b06|\u2b05|\u2935|\u2934|\u27a1|\u2764|\u2757|\u2747|\u2744|\u2734|\u2733|\u2716|\u2714|\u2712|\u270f|\u270c|\u2709|\u2708|\u2702|\u26fd|\u26fa|\u26f5|\u26f3|\u26f2|\u26ea|\u26d4|\u26c5|\u26c4|\u26be|\u26bd|\u26ab|\u26aa|\u26a1|\u26a0|\u2693|\u267f|\u267b|\u3297|\u2666|\u2665|\u2663|\u2660|\u2653|\u2652|\u2651|\u2650|\u264f|\u264e|\u264d|\u264c|\u264b|\u264a|\u2649|\u2648|\u263a|\u261d|\u2615|\u2614|\u2611|\u260e|\u2601|\u2600|\u25fe|\u25fd|\u25fc|\u25fb|\u25c0|\u25b6|\u25ab|\u25aa|\u24c2|\u231b|\u231a|\u21aa|\u21a9|\u2199|\u2198|\u2197|\u2196|\u2195|\u2194|\u2139|\u2049|\u203c|\u2668)([\uFE0E\uFE0F]?)))/g,s=/[&<>'"]/g,t=/IFRAME|NOFRAMES|NOSCRIPT|SCRIPT|SELECT|STYLE|TEXTAREA/,u=String.fromCharCode;return p}();if(function(a,b){"function"==typeof define&&define.amd?define(a):"undefined"!=typeof module&&"object"==typeof exports?module.exports=a():b.log4javascript=a()}(function(){function isUndefined(a){return"undefined"==typeof a}function EventSupport(){}function Log4JavaScript(){}function toStr(a){return a&&a.toString?a.toString():String(a)}function getExceptionMessage(a){return a.message?a.message:a.description?a.description:toStr(a)}function getUrlFileName(a){var b=Math.max(a.lastIndexOf("/"),a.lastIndexOf("\\"));return a.substr(b+1)}function getExceptionStringRep(a){if(a){var b="Exception: "+getExceptionMessage(a);try{a.lineNumber&&(b+=" on line number "+a.lineNumber),a.fileName&&(b+=" in file "+getUrlFileName(a.fileName))}catch(a){logLog.warn("Unable to obtain file and line information for error")}return showStackTraces&&a.stack&&(b+=newLine+"Stack trace:"+newLine+a.stack),b}return null}function bool(a){return Boolean(a)}function trim(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")}function splitIntoLines(a){var b=a.replace(/\r\n/g,"\n").replace(/\r/g,"\n");return b.split("\n")}function array_remove(a,b){for(var c=-1,d=0,e=a.length;d<e;d++)if(a[d]===b){c=d;break}return c>=0&&(a.splice(c,1),!0)}function array_contains(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]==b)return!0;return!1}function extractBooleanFromParam(a,b){return isUndefined(a)?b:bool(a)}function extractStringFromParam(a,b){return isUndefined(a)?b:String(a)}function extractIntFromParam(a,b){if(isUndefined(a))return b;try{var c=parseInt(a,10);return isNaN(c)?b:c}catch(c){return logLog.warn("Invalid int param "+a,c),b}}function extractFunctionFromParam(a,b){return"function"==typeof a?a:b}function isError(a){return a instanceof Error}function handleError(a,b){logLog.error(a,b),log4javascript.dispatchEvent("error",{message:a,exception:b})}function Timer(a,b){this.name=a,this.level=isUndefined(b)?Level.INFO:b,this.start=new Date}function Logger(a){this.name=a,this.parent=null,this.children=[];var b=[],c=null,d=this.name===rootLoggerName,e=this.name===nullLoggerName,f=null,g=!1;this.addChild=function(a){this.children.push(a),a.parent=this,a.invalidateAppenderCache()};var h=!0;this.getAdditivity=function(){return h},this.setAdditivity=function(a){var b=h!=a;h=a,b&&this.invalidateAppenderCache()},this.addAppender=function(a){e?handleError("Logger.addAppender: you may not add an appender to the null logger"):a instanceof log4javascript.Appender?array_contains(b,a)||(b.push(a),a.setAddedToLogger(this),this.invalidateAppenderCache()):handleError("Logger.addAppender: appender supplied ('"+toStr(a)+"') is not a subclass of Appender")},this.removeAppender=function(a){array_remove(b,a),a.setRemovedFromLogger(this),this.invalidateAppenderCache()},this.removeAllAppenders=function(){var a=b.length;if(a>0){for(var c=0;c<a;c++)b[c].setRemovedFromLogger(this);b.length=0,this.invalidateAppenderCache()}},this.getEffectiveAppenders=function(){if(null===f||g){var a=d||!this.getAdditivity()?[]:this.parent.getEffectiveAppenders();f=a.concat(b),g=!1}return f},this.invalidateAppenderCache=function(){g=!0;for(var a=0,b=this.children.length;a<b;a++)this.children[a].invalidateAppenderCache()},this.log=function(a,b){if(enabled&&a.isGreaterOrEqual(this.getEffectiveLevel())){var c,d=b.length-1,e=b[d];b.length>1&&isError(e)&&(c=e,d--);for(var f=[],g=0;g<=d;g++)f[g]=b[g];var h=new LoggingEvent(this,new Date,a,f,c);this.callAppenders(h)}},this.callAppenders=function(a){for(var b=this.getEffectiveAppenders(),c=0,d=b.length;c<d;c++)b[c].doAppend(a)},this.setLevel=function(a){d&&null===a?handleError("Logger.setLevel: you cannot set the level of the root logger to null"):a instanceof Level?c=a:handleError("Logger.setLevel: level supplied to logger "+this.name+" is not an instance of log4javascript.Level")},this.getLevel=function(){return c},this.getEffectiveLevel=function(){for(var a=this;null!==a;a=a.parent){var b=a.getLevel();if(null!==b)return b}},this.group=function(a,b){if(enabled)for(var c=this.getEffectiveAppenders(),d=0,e=c.length;d<e;d++)c[d].group(a,b)},this.groupEnd=function(){if(enabled)for(var a=this.getEffectiveAppenders(),b=0,c=a.length;b<c;b++)a[b].groupEnd()};var i={};this.time=function(a,b){enabled&&(isUndefined(a)?handleError("Logger.time: a name for the timer must be supplied"):!b||b instanceof Level?i[a]=new Timer(a,b):handleError("Logger.time: level supplied to timer "+a+" is not an instance of log4javascript.Level"))},this.timeEnd=function(a){if(enabled)if(isUndefined(a))handleError("Logger.timeEnd: a name for the timer must be supplied");else if(i[a]){var b=i[a],c=b.getElapsedTime();this.log(b.level,["Timer "+toStr(a)+" completed in "+c+"ms"]),delete i[a]}else logLog.warn("Logger.timeEnd: no timer found with name "+a)},this.assert=function(a){if(enabled&&!a){for(var b=[],c=1,d=arguments.length;c<d;c++)b.push(arguments[c]);b=b.length>0?b:["Assertion Failure"],b.push(newLine),b.push(a),this.log(Level.ERROR,b)}},this.toString=function(){return"Logger["+this.name+"]"}}function SimpleLayout(){this.customFields=[]}function NullLayout(){this.customFields=[]}function XmlLayout(a){this.combineMessages=extractBooleanFromParam(a,!0),this.customFields=[]}function escapeNewLines(a){return a.replace(/\r\n|\r|\n/g,"\\r\\n")}function JsonLayout(a,b){this.readable=extractBooleanFromParam(a,!1),this.combineMessages=extractBooleanFromParam(b,!0),this.batchHeader=this.readable?"["+newLine:"[",this.batchFooter=this.readable?"]"+newLine:"]",this.batchSeparator=this.readable?","+newLine:",",this.setKeys(),this.colon=this.readable?": ":":",this.tab=this.readable?"\t":"",this.lineBreak=this.readable?newLine:"",this.customFields=[]}function HttpPostDataLayout(){this.setKeys(),this.customFields=[],this.returnsPostData=!0}function formatObjectExpansion(a,b,c){function d(a,b,c){function f(a){for(var b=splitIntoLines(a),d=1,e=b.length;d<e;d++)b[d]=c+b[d];return b.join(newLine)}var g,h,i,j,k,l,m;if(c||(c=""),null===a)return"null";if("undefined"==typeof a)return"undefined";if("string"==typeof a)return f(a);if("object"==typeof a&&array_contains(e,a)){try{l=toStr(a)}catch(a){l="Error formatting property. Details: "+getExceptionStringRep(a)}return l+" [already expanded]"}if(a instanceof Array&&b>0){for(e.push(a),l="["+newLine,i=b-1,j=c+"  ",k=[],g=0,h=a.length;g<h;g++)try{m=d(a[g],i,j),k.push(j+m)}catch(a){k.push(j+"Error formatting array member. Details: "+getExceptionStringRep(a))}return l+=k.join(","+newLine)+newLine+c+"]"}if("[object Date]"==Object.prototype.toString.call(a))return a.toString();if("object"==typeof a&&b>0){e.push(a),l="{"+newLine,i=b-1,j=c+"  ",k=[];for(g in a)try{m=d(a[g],i,j),k.push(j+g+": "+m)}catch(a){k.push(j+g+": Error formatting property. Details: "+getExceptionStringRep(a))}return l+=k.join(","+newLine)+newLine+c+"}"}return f(toStr(a))}var e=[];return d(a,b,c)}function PatternLayout(a){a?this.pattern=a:this.pattern=PatternLayout.DEFAULT_CONVERSION_PATTERN,this.customFields=[]}function AlertAppender(){}function BrowserConsoleAppender(){}function isHttpRequestSuccessful(a){return isUndefined(a.status)||0===a.status||a.status>=200&&a.status<300||1223==a.status}function AjaxAppender(a,b){function c(a){return!A||(handleError("AjaxAppender: configuration option '"+a+"' may not be set after the appender has been initialized"),!1)}function d(){if(l&&enabled){z=!0;var a;if(n)x.length>0?(a=x.shift(),i(f(a),d)):(z=!1,m&&g());else{for(;a=x.shift();)i(f(a));z=!1,m&&g()}}}function e(){var a=!1;if(l&&enabled){for(var b,c=k.getLayout().allowBatching()?o:1,e=[];b=w.shift();)e.push(b),w.length>=c&&(x.push(e),e=[]);e.length>0&&x.push(e),a=x.length>0,n=!1,m=!1,d()}return a}function f(a){for(var b,c=[],d="";b=a.shift();)c.push(k.getLayout().formatWithException(b));return d=1==a.length?c.join(""):k.getLayout().batchHeader+c.join(k.getLayout().batchSeparator)+k.getLayout().batchFooter,u==k.defaults.contentType&&(d=k.getLayout().returnsPostData?d:urlEncode(s)+"="+urlEncode(d),d.length>0&&(d+="&"),d+="layout="+urlEncode(k.getLayout().toString())),d}function g(){window.setTimeout(d,p)}function h(){var a="AjaxAppender: could not create XMLHttpRequest object. AjaxAppender disabled";handleError(a),l=!1,r&&r(a)}function i(c,d){try{var e=getXmlHttp(h);if(l){e.onreadystatechange=function(){if(4==e.readyState){if(isHttpRequestSuccessful(e))q&&q(e),d&&d(e);else{var b="AjaxAppender.append: XMLHttpRequest request to URL "+a+" returned status code "+e.status;handleError(b),r&&r(b)}e.onreadystatechange=emptyFunction,e=null}},e.open("POST",a,!0),b&&withCredentialsSupported&&(e.withCredentials=!0);try{for(var f,g=0;f=y[g++];)e.setRequestHeader(f.name,f.value);e.setRequestHeader("Content-Type",u)}catch(a){var i="AjaxAppender.append: your browser's XMLHttpRequest implementation does not support setRequestHeader, therefore cannot post data. AjaxAppender disabled";return handleError(i),l=!1,void(r&&r(i))}e.send(c)}}catch(b){var j="AjaxAppender.append: error sending log message to "+a;handleError(j,b),l=!1,r&&r(j+". Details: "+getExceptionStringRep(b))}}function j(){if(A=!0,t){var a=window.onbeforeunload;window.onbeforeunload=function(){a&&a(),e()}}m&&g()}var k=this,l=!0;a||(handleError("AjaxAppender: URL must be specified in constructor"),l=!1);var m=this.defaults.timed,n=this.defaults.waitForResponse,o=this.defaults.batchSize,p=this.defaults.timerInterval,q=this.defaults.requestSuccessCallback,r=this.defaults.failCallback,s=this.defaults.postVarName,t=this.defaults.sendAllOnUnload,u=this.defaults.contentType,v=null,w=[],x=[],y=[],z=!1,A=!1;this.getSessionId=function(){return v},this.setSessionId=function(a){v=extractStringFromParam(a,null),this.layout.setCustomField("sessionid",v)},this.setLayout=function(a){c("layout")&&(this.layout=a,null!==v&&this.setSessionId(v))},this.isTimed=function(){return m},this.setTimed=function(a){c("timed")&&(m=bool(a))},this.getTimerInterval=function(){return p},this.setTimerInterval=function(a){c("timerInterval")&&(p=extractIntFromParam(a,p))},this.isWaitForResponse=function(){return n},this.setWaitForResponse=function(a){c("waitForResponse")&&(n=bool(a))},this.getBatchSize=function(){return o},this.setBatchSize=function(a){c("batchSize")&&(o=extractIntFromParam(a,o))},this.isSendAllOnUnload=function(){return t},this.setSendAllOnUnload=function(a){c("sendAllOnUnload")&&(t=extractBooleanFromParam(a,t))},this.setRequestSuccessCallback=function(a){q=extractFunctionFromParam(a,q)},this.setFailCallback=function(a){r=extractFunctionFromParam(a,r)},this.getPostVarName=function(){return s},this.setPostVarName=function(a){c("postVarName")&&(s=extractStringFromParam(a,s))},this.getHeaders=function(){return y},this.addHeader=function(a,b){"content-type"==a.toLowerCase()?u=b:y.push({name:a,value:b})},this.sendAll=d,this.sendAllRemaining=e,this.append=function(a){if(l){A||j(),w.push(a);var b=this.getLayout().allowBatching()?o:1;if(w.length>=b){for(var c,e=[];c=w.shift();)e.push(c);x.push(e),m||n&&(!n||z)||d()}}}}function setCookie(a,b,c,d){var e;if(d=d?"; path="+d:"",c){var f=new Date;f.setTime(f.getTime()+24*c*60*60*1e3),e="; expires="+f.toGMTString()}else e="";document.cookie=escape(a)+"="+escape(b)+e+d}function getCookie(a){for(var b=escape(a)+"=",c=document.cookie.split(";"),d=0,e=c.length;d<e;d++){for(var f=c[d];" "===f.charAt(0);)f=f.substring(1,f.length);if(0===f.indexOf(b))return unescape(f.substring(b.length,f.length))}return null}function getBaseUrl(){for(var a=document.getElementsByTagName("script"),b=0,c=a.length;b<c;++b)if(a[b].src.indexOf("log4javascript")!=-1){var d=a[b].src.lastIndexOf("/");return d==-1?"":a[b].src.substr(0,d+1);
}return null}function isLoaded(a){try{return bool(a.loaded)}catch(a){return!1}}function padWithSpaces(a,b){if(a.length<b){for(var c=[],d=Math.max(0,b-a.length),e=0;e<d;e++)c[e]=" ";a+=c.join("")}return a}function createDefaultLogger(){var a=log4javascript.getLogger(defaultLoggerName),b=new log4javascript.PopUpAppender;return a.addAppender(b),a}Array.prototype.push||(Array.prototype.push=function(){for(var a=0,b=arguments.length;a<b;a++)this[this.length]=arguments[a];return this.length}),Array.prototype.shift||(Array.prototype.shift=function(){if(this.length>0){for(var a=this[0],b=0,c=this.length-1;b<c;b++)this[b]=this[b+1];return this.length=this.length-1,a}}),Array.prototype.splice||(Array.prototype.splice=function(a,b){var c=this.slice(a+b),d=this.slice(a,a+b);this.length=a;for(var e=[],f=0,g=arguments.length;f<g;f++)e[f]=arguments[f];var h=e.length>2?c=e.slice(2).concat(c):c;for(f=0,g=h.length;f<g;f++)this.push(h[f]);return d}),EventSupport.prototype={eventTypes:[],eventListeners:{},setEventTypes:function(a){if(a instanceof Array){this.eventTypes=a,this.eventListeners={};for(var b=0,c=this.eventTypes.length;b<c;b++)this.eventListeners[this.eventTypes[b]]=[]}else handleError("log4javascript.EventSupport ["+this+"]: setEventTypes: eventTypes parameter must be an Array")},addEventListener:function(a,b){"function"==typeof b?(array_contains(this.eventTypes,a)||handleError("log4javascript.EventSupport ["+this+"]: addEventListener: no event called '"+a+"'"),this.eventListeners[a].push(b)):handleError("log4javascript.EventSupport ["+this+"]: addEventListener: listener must be a function")},removeEventListener:function(a,b){"function"==typeof b?(array_contains(this.eventTypes,a)||handleError("log4javascript.EventSupport ["+this+"]: removeEventListener: no event called '"+a+"'"),array_remove(this.eventListeners[a],b)):handleError("log4javascript.EventSupport ["+this+"]: removeEventListener: listener must be a function")},dispatchEvent:function(a,b){if(array_contains(this.eventTypes,a))for(var c=this.eventListeners[a],d=0,e=c.length;d<e;d++)c[d](this,a,b);else handleError("log4javascript.EventSupport ["+this+"]: dispatchEvent: no event called '"+a+"'")}};var applicationStartDate=new Date,uniqueId="log4javascript_"+applicationStartDate.getTime()+"_"+Math.floor(1e8*Math.random()),emptyFunction=function(){},newLine="\r\n",pageLoaded=!1;Log4JavaScript.prototype=new EventSupport;var log4javascript=new Log4JavaScript;log4javascript.version="1.4.13",log4javascript.edition="log4javascript";var urlEncode="undefined"!=typeof window.encodeURIComponent?function(a){return encodeURIComponent(a)}:function(a){return escape(a).replace(/\+/g,"%2B").replace(/"/g,"%22").replace(/'/g,"%27").replace(/\//g,"%2F").replace(/=/g,"%3D")};Function.prototype.apply||(Function.prototype.apply=function(obj,args){var methodName="__apply__";"undefined"!=typeof obj[methodName]&&(methodName+=String(Math.random()).substr(2)),obj[methodName]=this;for(var argsStrings=[],i=0,len=args.length;i<len;i++)argsStrings[i]="args["+i+"]";var script="obj."+methodName+"("+argsStrings.join(",")+")",returnValue=eval(script);return delete obj[methodName],returnValue}),Function.prototype.call||(Function.prototype.call=function(a){for(var b=[],c=1,d=arguments.length;c<d;c++)b[c-1]=arguments[c];return this.apply(a,b)});var logLog={quietMode:!1,debugMessages:[],setQuietMode:function(a){this.quietMode=bool(a)},numberOfErrors:0,alertAllErrors:!1,setAlertAllErrors:function(a){this.alertAllErrors=a},debug:function(a){this.debugMessages.push(a)},displayDebug:function(){alert(this.debugMessages.join(newLine))},warn:function(a,b){},error:function(a,b){if((1==++this.numberOfErrors||this.alertAllErrors)&&!this.quietMode){var c="log4javascript error: "+a;b&&(c+=newLine+newLine+"Original error: "+getExceptionStringRep(b)),alert(c)}}};log4javascript.logLog=logLog,log4javascript.setEventTypes(["load","error"]),log4javascript.handleError=handleError;var enabled=!("undefined"!=typeof log4javascript_disabled&&log4javascript_disabled);log4javascript.setEnabled=function(a){enabled=bool(a)},log4javascript.isEnabled=function(){return enabled};var useTimeStampsInMilliseconds=!0;log4javascript.setTimeStampsInMilliseconds=function(a){useTimeStampsInMilliseconds=bool(a)},log4javascript.isTimeStampsInMilliseconds=function(){return useTimeStampsInMilliseconds},log4javascript.evalInScope=function(expr){return eval(expr)};var showStackTraces=!1;log4javascript.setShowStackTraces=function(a){showStackTraces=bool(a)};var Level=function(a,b){this.level=a,this.name=b};Level.prototype={toString:function(){return this.name},equals:function(a){return this.level==a.level},isGreaterOrEqual:function(a){return this.level>=a.level}},Level.ALL=new Level(Number.MIN_VALUE,"ALL"),Level.TRACE=new Level(1e4,"TRACE"),Level.DEBUG=new Level(2e4,"DEBUG"),Level.INFO=new Level(3e4,"INFO"),Level.WARN=new Level(4e4,"WARN"),Level.ERROR=new Level(5e4,"ERROR"),Level.FATAL=new Level(6e4,"FATAL"),Level.OFF=new Level(Number.MAX_VALUE,"OFF"),log4javascript.Level=Level,Timer.prototype.getElapsedTime=function(){return(new Date).getTime()-this.start.getTime()};var anonymousLoggerName="[anonymous]",defaultLoggerName="[default]",nullLoggerName="[null]",rootLoggerName="root";Logger.prototype={trace:function(){this.log(Level.TRACE,arguments)},debug:function(){this.log(Level.DEBUG,arguments)},info:function(){this.log(Level.INFO,arguments)},warn:function(){this.log(Level.WARN,arguments)},error:function(){this.log(Level.ERROR,arguments)},fatal:function(){this.log(Level.FATAL,arguments)},isEnabledFor:function(a){return a.isGreaterOrEqual(this.getEffectiveLevel())},isTraceEnabled:function(){return this.isEnabledFor(Level.TRACE)},isDebugEnabled:function(){return this.isEnabledFor(Level.DEBUG)},isInfoEnabled:function(){return this.isEnabledFor(Level.INFO)},isWarnEnabled:function(){return this.isEnabledFor(Level.WARN)},isErrorEnabled:function(){return this.isEnabledFor(Level.ERROR)},isFatalEnabled:function(){return this.isEnabledFor(Level.FATAL)}},Logger.prototype.trace.isEntryPoint=!0,Logger.prototype.debug.isEntryPoint=!0,Logger.prototype.info.isEntryPoint=!0,Logger.prototype.warn.isEntryPoint=!0,Logger.prototype.error.isEntryPoint=!0,Logger.prototype.fatal.isEntryPoint=!0;var loggers={},loggerNames=[],ROOT_LOGGER_DEFAULT_LEVEL=Level.DEBUG,rootLogger=new Logger(rootLoggerName);rootLogger.setLevel(ROOT_LOGGER_DEFAULT_LEVEL),log4javascript.getRootLogger=function(){return rootLogger},log4javascript.getLogger=function(a){if("string"!=typeof a&&(a=anonymousLoggerName,logLog.warn("log4javascript.getLogger: non-string logger name "+toStr(a)+" supplied, returning anonymous logger")),a==rootLoggerName&&handleError("log4javascript.getLogger: root logger may not be obtained by name"),!loggers[a]){var b=new Logger(a);loggers[a]=b,loggerNames.push(a);var c,d=a.lastIndexOf(".");if(d>-1){var e=a.substring(0,d);c=log4javascript.getLogger(e)}else c=rootLogger;c.addChild(b)}return loggers[a]};var defaultLogger=null;log4javascript.getDefaultLogger=function(){return defaultLogger||(defaultLogger=createDefaultLogger()),defaultLogger};var nullLogger=null;log4javascript.getNullLogger=function(){return nullLogger||(nullLogger=new Logger(nullLoggerName),nullLogger.setLevel(Level.OFF)),nullLogger},log4javascript.resetConfiguration=function(){rootLogger.setLevel(ROOT_LOGGER_DEFAULT_LEVEL),loggers={}};var LoggingEvent=function(a,b,c,d,e){this.logger=a,this.timeStamp=b,this.timeStampInMilliseconds=b.getTime(),this.timeStampInSeconds=Math.floor(this.timeStampInMilliseconds/1e3),this.milliseconds=this.timeStamp.getMilliseconds(),this.level=c,this.messages=d,this.exception=e};LoggingEvent.prototype={getThrowableStrRep:function(){return this.exception?getExceptionStringRep(this.exception):""},getCombinedMessages:function(){return 1==this.messages.length?this.messages[0]:this.messages.join(newLine)},toString:function(){return"LoggingEvent["+this.level+"]"}},log4javascript.LoggingEvent=LoggingEvent;var Layout=function(){};Layout.prototype={defaults:{loggerKey:"logger",timeStampKey:"timestamp",millisecondsKey:"milliseconds",levelKey:"level",messageKey:"message",exceptionKey:"exception",urlKey:"url"},loggerKey:"logger",timeStampKey:"timestamp",millisecondsKey:"milliseconds",levelKey:"level",messageKey:"message",exceptionKey:"exception",urlKey:"url",batchHeader:"",batchFooter:"",batchSeparator:"",returnsPostData:!1,overrideTimeStampsSetting:!1,useTimeStampsInMilliseconds:null,format:function(){handleError("Layout.format: layout supplied has no format() method")},ignoresThrowable:function(){handleError("Layout.ignoresThrowable: layout supplied has no ignoresThrowable() method")},getContentType:function(){return"text/plain"},allowBatching:function(){return!0},setTimeStampsInMilliseconds:function(a){this.overrideTimeStampsSetting=!0,this.useTimeStampsInMilliseconds=bool(a)},isTimeStampsInMilliseconds:function(){return this.overrideTimeStampsSetting?this.useTimeStampsInMilliseconds:useTimeStampsInMilliseconds},getTimeStampValue:function(a){return this.isTimeStampsInMilliseconds()?a.timeStampInMilliseconds:a.timeStampInSeconds},getDataValues:function(a,b){var c=[[this.loggerKey,a.logger.name],[this.timeStampKey,this.getTimeStampValue(a)],[this.levelKey,a.level.name],[this.urlKey,window.location.href],[this.messageKey,b?a.getCombinedMessages():a.messages]];if(this.isTimeStampsInMilliseconds()||c.push([this.millisecondsKey,a.milliseconds]),a.exception&&c.push([this.exceptionKey,getExceptionStringRep(a.exception)]),this.hasCustomFields())for(var d=0,e=this.customFields.length;d<e;d++){var f=this.customFields[d].value;"function"==typeof f&&(f=f(this,a)),c.push([this.customFields[d].name,f])}return c},setKeys:function(a,b,c,d,e,f,g){this.loggerKey=extractStringFromParam(a,this.defaults.loggerKey),this.timeStampKey=extractStringFromParam(b,this.defaults.timeStampKey),this.levelKey=extractStringFromParam(c,this.defaults.levelKey),this.messageKey=extractStringFromParam(d,this.defaults.messageKey),this.exceptionKey=extractStringFromParam(e,this.defaults.exceptionKey),this.urlKey=extractStringFromParam(f,this.defaults.urlKey),this.millisecondsKey=extractStringFromParam(g,this.defaults.millisecondsKey)},setCustomField:function(a,b){for(var c=!1,d=0,e=this.customFields.length;d<e;d++)this.customFields[d].name===a&&(this.customFields[d].value=b,c=!0);c||this.customFields.push({name:a,value:b})},hasCustomFields:function(){return this.customFields.length>0},formatWithException:function(a){var b=this.format(a);return a.exception&&this.ignoresThrowable()&&(b+=a.getThrowableStrRep()),b},toString:function(){handleError("Layout.toString: all layouts must override this method")}},log4javascript.Layout=Layout;var Appender=function(){};Appender.prototype=new EventSupport,Appender.prototype.layout=new PatternLayout,Appender.prototype.threshold=Level.ALL,Appender.prototype.loggers=[],Appender.prototype.doAppend=function(a){enabled&&a.level.level>=this.threshold.level&&this.append(a)},Appender.prototype.append=function(a){},Appender.prototype.setLayout=function(a){a instanceof Layout?this.layout=a:handleError("Appender.setLayout: layout supplied to "+this.toString()+" is not a subclass of Layout")},Appender.prototype.getLayout=function(){return this.layout},Appender.prototype.setThreshold=function(a){a instanceof Level?this.threshold=a:handleError("Appender.setThreshold: threshold supplied to "+this.toString()+" is not a subclass of Level")},Appender.prototype.getThreshold=function(){return this.threshold},Appender.prototype.setAddedToLogger=function(a){this.loggers.push(a)},Appender.prototype.setRemovedFromLogger=function(a){array_remove(this.loggers,a)},Appender.prototype.group=emptyFunction,Appender.prototype.groupEnd=emptyFunction,Appender.prototype.toString=function(){handleError("Appender.toString: all appenders must override this method")},log4javascript.Appender=Appender,SimpleLayout.prototype=new Layout,SimpleLayout.prototype.format=function(a){return a.level.name+" - "+a.getCombinedMessages()},SimpleLayout.prototype.ignoresThrowable=function(){return!0},SimpleLayout.prototype.toString=function(){return"SimpleLayout"},log4javascript.SimpleLayout=SimpleLayout,NullLayout.prototype=new Layout,NullLayout.prototype.format=function(a){return a.messages},NullLayout.prototype.ignoresThrowable=function(){return!0},NullLayout.prototype.formatWithException=function(a){var b=a.messages,c=a.exception;return c?b.concat([c]):b},NullLayout.prototype.toString=function(){return"NullLayout"},log4javascript.NullLayout=NullLayout,XmlLayout.prototype=new Layout,XmlLayout.prototype.isCombinedMessages=function(){return this.combineMessages},XmlLayout.prototype.getContentType=function(){return"text/xml"},XmlLayout.prototype.escapeCdata=function(a){return a.replace(/\]\]>/,"]]>]]&gt;<![CDATA[")},XmlLayout.prototype.format=function(a){function b(a){return a="string"==typeof a?a:toStr(a),"<log4javascript:message><![CDATA["+e.escapeCdata(a)+"]]></log4javascript:message>"}var c,d,e=this,f='<log4javascript:event logger="'+a.logger.name+'" timestamp="'+this.getTimeStampValue(a)+'"';if(this.isTimeStampsInMilliseconds()||(f+=' milliseconds="'+a.milliseconds+'"'),f+=' level="'+a.level.name+'">'+newLine,this.combineMessages)f+=b(a.getCombinedMessages());else{for(f+="<log4javascript:messages>"+newLine,c=0,d=a.messages.length;c<d;c++)f+=b(a.messages[c])+newLine;f+="</log4javascript:messages>"+newLine}if(this.hasCustomFields())for(c=0,d=this.customFields.length;c<d;c++)f+='<log4javascript:customfield name="'+this.customFields[c].name+'"><![CDATA['+this.customFields[c].value.toString()+"]]></log4javascript:customfield>"+newLine;return a.exception&&(f+="<log4javascript:exception><![CDATA["+getExceptionStringRep(a.exception)+"]]></log4javascript:exception>"+newLine),f+="</log4javascript:event>"+newLine+newLine},XmlLayout.prototype.ignoresThrowable=function(){return!1},XmlLayout.prototype.toString=function(){return"XmlLayout"},log4javascript.XmlLayout=XmlLayout,JsonLayout.prototype=new Layout,JsonLayout.prototype.isReadable=function(){return this.readable},JsonLayout.prototype.isCombinedMessages=function(){return this.combineMessages},JsonLayout.prototype.format=function(a){function b(a,c,d){var f,g=typeof a;if(a instanceof Date)f=String(a.getTime());else if(d&&a instanceof Array){f="["+e.lineBreak;for(var h=0,i=a.length;h<i;h++){var j=c+e.tab;f+=j+b(a[h],j,!1),h<a.length-1&&(f+=","),f+=e.lineBreak}f+=c+"]"}else f="number"!==g&&"boolean"!==g?'"'+escapeNewLines(toStr(a).replace(/\"/g,'\\"'))+'"':a;return f}var c,d,e=this,f=this.getDataValues(a,this.combineMessages),g="{"+this.lineBreak;for(c=0,d=f.length-1;c<=d;c++)g+=this.tab+'"'+f[c][0]+'"'+this.colon+b(f[c][1],this.tab,!0),c<d&&(g+=","),g+=this.lineBreak;return g+="}"+this.lineBreak},JsonLayout.prototype.ignoresThrowable=function(){return!1},JsonLayout.prototype.toString=function(){return"JsonLayout"},JsonLayout.prototype.getContentType=function(){return"application/json"},log4javascript.JsonLayout=JsonLayout,HttpPostDataLayout.prototype=new Layout,HttpPostDataLayout.prototype.allowBatching=function(){return!1},HttpPostDataLayout.prototype.format=function(a){for(var b=this.getDataValues(a),c=[],d=0,e=b.length;d<e;d++){var f=b[d][1]instanceof Date?String(b[d][1].getTime()):b[d][1];c.push(urlEncode(b[d][0])+"="+urlEncode(f))}return c.join("&")},HttpPostDataLayout.prototype.ignoresThrowable=function(a){return!1},HttpPostDataLayout.prototype.toString=function(){return"HttpPostDataLayout"},log4javascript.HttpPostDataLayout=HttpPostDataLayout;var SimpleDateFormat;!function(){var a=/('[^']*')|(G+|y+|M+|w+|W+|D+|d+|F+|E+|a+|H+|k+|K+|h+|m+|s+|S+|Z+)|([a-zA-Z]+)|([^a-zA-Z']+)/,b=["January","February","March","April","May","June","July","August","September","October","November","December"],c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],d=0,e=1,f=2,g=3,h=4,i=5,j={G:d,y:g,M:h,w:f,W:f,D:f,d:f,F:f,E:e,a:d,H:f,k:f,K:f,h:f,m:f,s:f,S:f,Z:i},k=864e5,l=7*k,m=1,n=function(a,b,c){var d=new Date(a,b,c,0,0,0);return d.setMilliseconds(0),d};Date.prototype.getDifference=function(a){return this.getTime()-a.getTime()},Date.prototype.isBefore=function(a){return this.getTime()<a.getTime()},Date.prototype.getUTCTime=function(){return Date.UTC(this.getFullYear(),this.getMonth(),this.getDate(),this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds())},Date.prototype.getTimeSince=function(a){return this.getUTCTime()-a.getUTCTime()},Date.prototype.getPreviousSunday=function(){var a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),12,0,0),b=new Date(a.getTime()-this.getDay()*k);return n(b.getFullYear(),b.getMonth(),b.getDate())},Date.prototype.getWeekInYear=function(a){isUndefined(this.minimalDaysInFirstWeek)&&(a=m);var b=this.getPreviousSunday(),c=n(this.getFullYear(),0,1),d=b.isBefore(c)?0:1+Math.floor(b.getTimeSince(c)/l),e=7-c.getDay(),f=d;return e<a&&f--,f},Date.prototype.getWeekInMonth=function(a){isUndefined(this.minimalDaysInFirstWeek)&&(a=m);var b=this.getPreviousSunday(),c=n(this.getFullYear(),this.getMonth(),1),d=b.isBefore(c)?0:1+Math.floor(b.getTimeSince(c)/l),e=7-c.getDay(),f=d;return e>=a&&f++,f},Date.prototype.getDayInYear=function(){var a=n(this.getFullYear(),0,1);return 1+Math.floor(this.getTimeSince(a)/k)},SimpleDateFormat=function(a){this.formatString=a},SimpleDateFormat.prototype.setMinimalDaysInFirstWeek=function(a){this.minimalDaysInFirstWeek=a},SimpleDateFormat.prototype.getMinimalDaysInFirstWeek=function(){return isUndefined(this.minimalDaysInFirstWeek)?m:this.minimalDaysInFirstWeek};var o=function(a,b){for(;a.length<b;)a="0"+a;return a},p=function(a,b,c){return b>=4?a:a.substr(0,Math.max(c,b))},q=function(a,b){var c=""+a;return o(c,b)};SimpleDateFormat.prototype.format=function(k){for(var l,m="",n=this.formatString;l=a.exec(n);){var r=l[1],s=l[2],t=l[3],u=l[4];if(r)m+="''"==r?"'":r.substring(1,r.length-1);else if(t);else if(u)m+=u;else if(s){var v=s.charAt(0),w=s.length,x="";switch(v){case"G":x="AD";break;case"y":x=k.getFullYear();break;case"M":x=k.getMonth();break;case"w":x=k.getWeekInYear(this.getMinimalDaysInFirstWeek());break;case"W":x=k.getWeekInMonth(this.getMinimalDaysInFirstWeek());break;case"D":x=k.getDayInYear();break;case"d":x=k.getDate();break;case"F":x=1+Math.floor((k.getDate()-1)/7);break;case"E":x=c[k.getDay()];break;case"a":x=k.getHours()>=12?"PM":"AM";break;case"H":x=k.getHours();break;case"k":x=k.getHours()||24;break;case"K":x=k.getHours()%12;break;case"h":x=k.getHours()%12||12;break;case"m":x=k.getMinutes();break;case"s":x=k.getSeconds();break;case"S":x=k.getMilliseconds();break;case"Z":x=k.getTimezoneOffset()}switch(j[v]){case d:m+=p(x,w,2);break;case e:m+=p(x,w,3);break;case f:m+=q(x,w);break;case g:if(w<=3){var y=""+x;m+=y.substr(2,2)}else m+=q(x,w);break;case h:m+=w>=3?p(b[x],w,w):q(x+1,w);break;case i:var z=x>0,A=z?"-":"+",B=Math.abs(x),C=""+Math.floor(B/60);C=o(C,2);var D=""+B%60;D=o(D,2),m+=A+C+D}}n=n.substr(l.index+l[0].length)}return m}}(),log4javascript.SimpleDateFormat=SimpleDateFormat,PatternLayout.TTCC_CONVERSION_PATTERN="%r %p %c - %m%n",PatternLayout.DEFAULT_CONVERSION_PATTERN="%m%n",PatternLayout.ISO8601_DATEFORMAT="yyyy-MM-dd HH:mm:ss,SSS",PatternLayout.DATETIME_DATEFORMAT="dd MMM yyyy HH:mm:ss,SSS",PatternLayout.ABSOLUTETIME_DATEFORMAT="HH:mm:ss,SSS",PatternLayout.prototype=new Layout,PatternLayout.prototype.format=function(a){for(var b,c=/%(-?[0-9]+)?(\.?[0-9]+)?([acdfmMnpr%])(\{([^\}]+)\})?|([^%]+)/,d="",e=this.pattern;b=c.exec(e);){var f=b[0],g=b[1],h=b[2],i=b[3],j=b[5],k=b[6];if(k)d+=""+k;else{var l="";switch(i){case"a":case"m":var m=0;j&&(m=parseInt(j,10),isNaN(m)&&(handleError("PatternLayout.format: invalid specifier '"+j+"' for conversion character '"+i+"' - should be a number"),m=0));for(var n="a"===i?a.messages[0]:a.messages,o=0,p=n.length;o<p;o++)o>0&&" "!==l.charAt(l.length-1)&&(l+=" "),l+=0===m?n[o]:formatObjectExpansion(n[o],m);break;case"c":var q=a.logger.name;if(j){var r=parseInt(j,10),s=a.logger.name.split(".");l=r>=s.length?q:s.slice(s.length-r).join(".")}else l=q;break;case"d":var t=PatternLayout.ISO8601_DATEFORMAT;j&&(t=j,"ISO8601"==t?t=PatternLayout.ISO8601_DATEFORMAT:"ABSOLUTE"==t?t=PatternLayout.ABSOLUTETIME_DATEFORMAT:"DATE"==t&&(t=PatternLayout.DATETIME_DATEFORMAT)),l=new SimpleDateFormat(t).format(a.timeStamp);break;case"f":if(this.hasCustomFields()){var u=0;j&&(u=parseInt(j,10),isNaN(u)?handleError("PatternLayout.format: invalid specifier '"+j+"' for conversion character 'f' - should be a number"):0===u?handleError("PatternLayout.format: invalid specifier '"+j+"' for conversion character 'f' - must be greater than zero"):u>this.customFields.length?handleError("PatternLayout.format: invalid specifier '"+j+"' for conversion character 'f' - there aren't that many custom fields"):u-=1);var v=this.customFields[u].value;"function"==typeof v&&(v=v(this,a)),l=v}break;case"n":l=newLine;break;case"p":l=a.level.name;break;case"r":l=""+a.timeStamp.getDifference(applicationStartDate);break;case"%":l="%";break;default:l=f}var w;if(h){w=parseInt(h.substr(1),10);var x=l.length;w<x&&(l=l.substring(x-w,x))}if(g)if("-"==g.charAt(0))for(w=parseInt(g.substr(1),10);l.length<w;)l+=" ";else for(w=parseInt(g,10);l.length<w;)l=" "+l;d+=l}e=e.substr(b.index+b[0].length)}return d},PatternLayout.prototype.ignoresThrowable=function(){return!0},PatternLayout.prototype.toString=function(){return"PatternLayout"},log4javascript.PatternLayout=PatternLayout,AlertAppender.prototype=new Appender,AlertAppender.prototype.layout=new SimpleLayout,AlertAppender.prototype.append=function(a){alert(this.getLayout().formatWithException(a))},AlertAppender.prototype.toString=function(){return"AlertAppender"},log4javascript.AlertAppender=AlertAppender,BrowserConsoleAppender.prototype=new log4javascript.Appender,BrowserConsoleAppender.prototype.layout=new NullLayout,BrowserConsoleAppender.prototype.threshold=Level.DEBUG,BrowserConsoleAppender.prototype.append=function(a){var b=this,c=function(c){var d=b.getLayout().formatWithException(a);return"string"==typeof d?c?d:[d]:c?d.join(" "):d},d=window.console;if(d&&d.log){var e;e=d.debug&&Level.DEBUG.isGreaterOrEqual(a.level)?"debug":d.info&&Level.INFO.equals(a.level)?"info":d.warn&&Level.WARN.equals(a.level)?"warn":d.error&&a.level.isGreaterOrEqual(Level.ERROR)?"error":"log","function"==typeof d[e].apply?d[e].apply(d,c(!1)):d[e](c(!0))}else"undefined"!=typeof opera&&opera.postError&&opera.postError(c(!0))},BrowserConsoleAppender.prototype.group=function(a){window.console&&window.console.group&&window.console.group(a)},BrowserConsoleAppender.prototype.groupEnd=function(){window.console&&window.console.groupEnd&&window.console.groupEnd()},BrowserConsoleAppender.prototype.toString=function(){return"BrowserConsoleAppender"},log4javascript.BrowserConsoleAppender=BrowserConsoleAppender;var xhrFactory=function(){return new XMLHttpRequest},xmlHttpFactories=[xhrFactory,function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],withCredentialsSupported=!1,getXmlHttp=function(a){for(var b,c=null,d=0,e=xmlHttpFactories.length;d<e;d++){b=xmlHttpFactories[d];try{return c=b(),withCredentialsSupported=b==xhrFactory&&"withCredentials"in c,getXmlHttp=b,c}catch(a){}}a?a():handleError("getXmlHttp: unable to obtain XMLHttpRequest object")};AjaxAppender.prototype=new Appender,AjaxAppender.prototype.defaults={waitForResponse:!1,timed:!1,timerInterval:1e3,batchSize:1,sendAllOnUnload:!1,requestSuccessCallback:null,failCallback:null,postVarName:"data",contentType:"application/x-www-form-urlencoded"},AjaxAppender.prototype.layout=new HttpPostDataLayout,AjaxAppender.prototype.toString=function(){return"AjaxAppender"},log4javascript.AjaxAppender=AjaxAppender;var ConsoleAppender;if(function(){function a(a,b,c,d,e){this.create(!1,null,a,b,c,d,e,this.defaults.focusPopUp)}function b(a,b,c,d,e,f){this.create(!0,a,b,c,d,e,f,!1)}var c=function(){return['<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">','<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">',"<head>","<title>log4javascript</title>",'<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />',"<!-- Make IE8 behave like IE7, having gone to all the trouble of making IE work -->",'<meta http-equiv="X-UA-Compatible" content="IE=7" />','<script type="text/javascript">var isIe = false, isIePre7 = false;</script>','<!--[if IE]><script type="text/javascript">isIe = true</script><![endif]-->','<!--[if lt IE 7]><script type="text/javascript">isIePre7 = true</script><![endif]-->','<script type="text/javascript">',"//<![CDATA[","var loggingEnabled=true;var logQueuedEventsTimer=null;var logEntries=[];var logEntriesAndSeparators=[];var logItems=[];var renderDelay=100;var unrenderedLogItemsExist=false;var rootGroup,currentGroup=null;var loaded=false;var currentLogItem=null;var logMainContainer;function copyProperties(obj,props){for(var i in props){obj[i]=props[i];}}","function LogItem(){}","LogItem.prototype={mainContainer:null,wrappedContainer:null,unwrappedContainer:null,group:null,appendToLog:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].appendToLog();}","this.group.update();},doRemove:function(doUpdate,removeFromGroup){if(this.rendered){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].remove();}","this.unwrappedElementContainer=null;this.wrappedElementContainer=null;this.mainElementContainer=null;}","if(this.group&&removeFromGroup){this.group.removeChild(this,doUpdate);}","if(this===currentLogItem){currentLogItem=null;}},remove:function(doUpdate,removeFromGroup){this.doRemove(doUpdate,removeFromGroup);},render:function(){},accept:function(visitor){visitor.visit(this);},getUnwrappedDomContainer:function(){return this.group.unwrappedElementContainer.contentDiv;},getWrappedDomContainer:function(){return this.group.wrappedElementContainer.contentDiv;},getMainDomContainer:function(){return this.group.mainElementContainer.contentDiv;}};LogItem.serializedItemKeys={LOG_ENTRY:0,GROUP_START:1,GROUP_END:2};function LogItemContainerElement(){}",'LogItemContainerElement.prototype={appendToLog:function(){var insertBeforeFirst=(newestAtTop&&this.containerDomNode.hasChildNodes());if(insertBeforeFirst){this.containerDomNode.insertBefore(this.mainDiv,this.containerDomNode.firstChild);}else{this.containerDomNode.appendChild(this.mainDiv);}}};function SeparatorElementContainer(containerDomNode){this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="separator";this.mainDiv.innerHTML="&nbsp;";}',"SeparatorElementContainer.prototype=new LogItemContainerElement();SeparatorElementContainer.prototype.remove=function(){this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;};function Separator(){this.rendered=false;}","Separator.prototype=new LogItem();copyProperties(Separator.prototype,{render:function(){var containerDomNode=this.group.contentDiv;if(isIe){this.unwrappedElementContainer=new SeparatorElementContainer(this.getUnwrappedDomContainer());this.wrappedElementContainer=new SeparatorElementContainer(this.getWrappedDomContainer());this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{this.mainElementContainer=new SeparatorElementContainer(this.getMainDomContainer());this.elementContainers=[this.mainElementContainer];}",'this.content=this.formattedMessage;this.rendered=true;}});function GroupElementContainer(group,containerDomNode,isRoot,isWrapped){this.group=group;this.containerDomNode=containerDomNode;this.isRoot=isRoot;this.isWrapped=isWrapped;this.expandable=false;if(this.isRoot){if(isIe){this.contentDiv=logMainContainer.appendChild(document.createElement("div"));this.contentDiv.id=this.isWrapped?"log_wrapped":"log_unwrapped";}else{this.contentDiv=logMainContainer;}}else{var groupElementContainer=this;this.mainDiv=document.createElement("div");this.mainDiv.className="group";this.headingDiv=this.mainDiv.appendChild(document.createElement("div"));this.headingDiv.className="groupheading";this.expander=this.headingDiv.appendChild(document.createElement("span"));this.expander.className="expander unselectable greyedout";this.expander.unselectable=true;var expanderText=this.group.expanded?"-":"+";this.expanderTextNode=this.expander.appendChild(document.createTextNode(expanderText));this.headingDiv.appendChild(document.createTextNode(" "+this.group.name));this.contentDiv=this.mainDiv.appendChild(document.createElement("div"));var contentCssClass=this.group.expanded?"expanded":"collapsed";this.contentDiv.className="groupcontent "+contentCssClass;this.expander.onclick=function(){if(groupElementContainer.group.expandable){groupElementContainer.group.toggleExpanded();}};}}','GroupElementContainer.prototype=new LogItemContainerElement();copyProperties(GroupElementContainer.prototype,{toggleExpanded:function(){if(!this.isRoot){var oldCssClass,newCssClass,expanderText;if(this.group.expanded){newCssClass="expanded";oldCssClass="collapsed";expanderText="-";}else{newCssClass="collapsed";oldCssClass="expanded";expanderText="+";}',"replaceClass(this.contentDiv,newCssClass,oldCssClass);this.expanderTextNode.nodeValue=expanderText;}},remove:function(){if(!this.isRoot){this.headingDiv=null;this.expander.onclick=null;this.expander=null;this.expanderTextNode=null;this.contentDiv=null;this.containerDomNode=null;this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;}},reverseChildren:function(){var node=null;var childDomNodes=[];while((node=this.contentDiv.firstChild)){this.contentDiv.removeChild(node);childDomNodes.push(node);}",'while((node=childDomNodes.pop())){this.contentDiv.appendChild(node);}},update:function(){if(!this.isRoot){if(this.group.expandable){removeClass(this.expander,"greyedout");}else{addClass(this.expander,"greyedout");}}},clear:function(){if(this.isRoot){this.contentDiv.innerHTML="";}}});function Group(name,isRoot,initiallyExpanded){this.name=name;this.group=null;this.isRoot=isRoot;this.initiallyExpanded=initiallyExpanded;this.elementContainers=[];this.children=[];this.expanded=initiallyExpanded;this.rendered=false;this.expandable=false;}',"Group.prototype=new LogItem();copyProperties(Group.prototype,{addChild:function(logItem){this.children.push(logItem);logItem.group=this;},render:function(){if(isIe){var unwrappedDomContainer,wrappedDomContainer;if(this.isRoot){unwrappedDomContainer=logMainContainer;wrappedDomContainer=logMainContainer;}else{unwrappedDomContainer=this.getUnwrappedDomContainer();wrappedDomContainer=this.getWrappedDomContainer();}","this.unwrappedElementContainer=new GroupElementContainer(this,unwrappedDomContainer,this.isRoot,false);this.wrappedElementContainer=new GroupElementContainer(this,wrappedDomContainer,this.isRoot,true);this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{var mainDomContainer=this.isRoot?logMainContainer:this.getMainDomContainer();this.mainElementContainer=new GroupElementContainer(this,mainDomContainer,this.isRoot,false);this.elementContainers=[this.mainElementContainer];}","this.rendered=true;},toggleExpanded:function(){this.expanded=!this.expanded;for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].toggleExpanded();}},expand:function(){if(!this.expanded){this.toggleExpanded();}},accept:function(visitor){visitor.visitGroup(this);},reverseChildren:function(){if(this.rendered){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].reverseChildren();}}},update:function(){var previouslyExpandable=this.expandable;this.expandable=(this.children.length!==0);if(this.expandable!==previouslyExpandable){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].update();}}},flatten:function(){var visitor=new GroupFlattener();this.accept(visitor);return visitor.logEntriesAndSeparators;},removeChild:function(child,doUpdate){array_remove(this.children,child);child.group=null;if(doUpdate){this.update();}},remove:function(doUpdate,removeFromGroup){for(var i=0,len=this.children.length;i<len;i++){this.children[i].remove(false,false);}","this.children=[];this.update();if(this===currentGroup){currentGroup=this.group;}","this.doRemove(doUpdate,removeFromGroup);},serialize:function(items){items.push([LogItem.serializedItemKeys.GROUP_START,this.name]);for(var i=0,len=this.children.length;i<len;i++){this.children[i].serialize(items);}","if(this!==currentGroup){items.push([LogItem.serializedItemKeys.GROUP_END]);}},clear:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].clear();}}});function LogEntryElementContainer(){}",'LogEntryElementContainer.prototype=new LogItemContainerElement();copyProperties(LogEntryElementContainer.prototype,{remove:function(){this.doRemove();},doRemove:function(){this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;this.contentElement=null;this.containerDomNode=null;},setContent:function(content,wrappedContent){if(content===this.formattedMessage){this.contentElement.innerHTML="";this.contentElement.appendChild(document.createTextNode(this.formattedMessage));}else{this.contentElement.innerHTML=content;}},setSearchMatch:function(isMatch){var oldCssClass=isMatch?"searchnonmatch":"searchmatch";var newCssClass=isMatch?"searchmatch":"searchnonmatch";replaceClass(this.mainDiv,newCssClass,oldCssClass);},clearSearch:function(){removeClass(this.mainDiv,"searchmatch");removeClass(this.mainDiv,"searchnonmatch");}});function LogEntryWrappedElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.appendChild(document.createTextNode(this.logEntry.formattedMessage));this.mainDiv.className="logentry wrapped "+this.logEntry.level;this.contentElement=this.mainDiv;}','LogEntryWrappedElementContainer.prototype=new LogEntryElementContainer();LogEntryWrappedElementContainer.prototype.setContent=function(content,wrappedContent){if(content===this.formattedMessage){this.contentElement.innerHTML="";this.contentElement.appendChild(document.createTextNode(this.formattedMessage));}else{this.contentElement.innerHTML=wrappedContent;}};function LogEntryUnwrappedElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="logentry unwrapped "+this.logEntry.level;this.pre=this.mainDiv.appendChild(document.createElement("pre"));this.pre.appendChild(document.createTextNode(this.logEntry.formattedMessage));this.pre.className="unwrapped";this.contentElement=this.pre;}','LogEntryUnwrappedElementContainer.prototype=new LogEntryElementContainer();LogEntryUnwrappedElementContainer.prototype.remove=function(){this.doRemove();this.pre=null;};function LogEntryMainElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="logentry nonielogentry "+this.logEntry.level;this.contentElement=this.mainDiv.appendChild(document.createElement("span"));this.contentElement.appendChild(document.createTextNode(this.logEntry.formattedMessage));}',"LogEntryMainElementContainer.prototype=new LogEntryElementContainer();function LogEntry(level,formattedMessage){this.level=level;this.formattedMessage=formattedMessage;this.rendered=false;}",'LogEntry.prototype=new LogItem();copyProperties(LogEntry.prototype,{render:function(){var logEntry=this;var containerDomNode=this.group.contentDiv;if(isIe){this.formattedMessage=this.formattedMessage.replace(/\\r\\n/g,"\\r");this.unwrappedElementContainer=new LogEntryUnwrappedElementContainer(this,this.getUnwrappedDomContainer());this.wrappedElementContainer=new LogEntryWrappedElementContainer(this,this.getWrappedDomContainer());this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{this.mainElementContainer=new LogEntryMainElementContainer(this,this.getMainDomContainer());this.elementContainers=[this.mainElementContainer];}','this.content=this.formattedMessage;this.rendered=true;},setContent:function(content,wrappedContent){if(content!=this.content){if(isIe&&(content!==this.formattedMessage)){content=content.replace(/\\r\\n/g,"\\r");}',"for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].setContent(content,wrappedContent);}",'this.content=content;}},getSearchMatches:function(){var matches=[];var i,len;if(isIe){var unwrappedEls=getElementsByClass(this.unwrappedElementContainer.mainDiv,"searchterm","span");var wrappedEls=getElementsByClass(this.wrappedElementContainer.mainDiv,"searchterm","span");for(i=0,len=unwrappedEls.length;i<len;i++){matches[i]=new Match(this.level,null,unwrappedEls[i],wrappedEls[i]);}}else{var els=getElementsByClass(this.mainElementContainer.mainDiv,"searchterm","span");for(i=0,len=els.length;i<len;i++){matches[i]=new Match(this.level,els[i]);}}',"return matches;},setSearchMatch:function(isMatch){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].setSearchMatch(isMatch);}},clearSearch:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].clearSearch();}},accept:function(visitor){visitor.visitLogEntry(this);},serialize:function(items){items.push([LogItem.serializedItemKeys.LOG_ENTRY,this.level,this.formattedMessage]);}});function LogItemVisitor(){}","LogItemVisitor.prototype={visit:function(logItem){},visitParent:function(logItem){if(logItem.group){logItem.group.accept(this);}},visitChildren:function(logItem){for(var i=0,len=logItem.children.length;i<len;i++){logItem.children[i].accept(this);}},visitLogEntry:function(logEntry){this.visit(logEntry);},visitSeparator:function(separator){this.visit(separator);},visitGroup:function(group){this.visit(group);}};function GroupFlattener(){this.logEntriesAndSeparators=[];}",'GroupFlattener.prototype=new LogItemVisitor();GroupFlattener.prototype.visitGroup=function(group){this.visitChildren(group);};GroupFlattener.prototype.visitLogEntry=function(logEntry){this.logEntriesAndSeparators.push(logEntry);};GroupFlattener.prototype.visitSeparator=function(separator){this.logEntriesAndSeparators.push(separator);};window.onload=function(){if(location.search){var queryBits=unescape(location.search).substr(1).split("&"),nameValueBits;for(var i=0,len=queryBits.length;i<len;i++){nameValueBits=queryBits[i].split("=");if(nameValueBits[0]=="log4javascript_domain"){document.domain=nameValueBits[1];break;}}}','logMainContainer=$("log");if(isIePre7){addClass(logMainContainer,"oldIe");}','rootGroup=new Group("root",true);rootGroup.render();currentGroup=rootGroup;setCommandInputWidth();setLogContainerHeight();toggleLoggingEnabled();toggleSearchEnabled();toggleSearchFilter();toggleSearchHighlight();applyFilters();checkAllLevels();toggleWrap();toggleNewestAtTop();toggleScrollToLatest();renderQueuedLogItems();loaded=true;$("command").value="";$("command").autocomplete="off";$("command").onkeydown=function(evt){evt=getEvent(evt);if(evt.keyCode==10||evt.keyCode==13){evalCommandLine();stopPropagation(evt);}else if(evt.keyCode==27){this.value="";this.focus();}else if(evt.keyCode==38&&commandHistory.length>0){currentCommandIndex=Math.max(0,currentCommandIndex-1);this.value=commandHistory[currentCommandIndex];moveCaretToEnd(this);}else if(evt.keyCode==40&&commandHistory.length>0){currentCommandIndex=Math.min(commandHistory.length-1,currentCommandIndex+1);this.value=commandHistory[currentCommandIndex];moveCaretToEnd(this);}};$("command").onkeypress=function(evt){evt=getEvent(evt);if(evt.keyCode==38&&commandHistory.length>0&&evt.preventDefault){evt.preventDefault();}};$("command").onkeyup=function(evt){evt=getEvent(evt);if(evt.keyCode==27&&evt.preventDefault){evt.preventDefault();this.focus();}};document.onkeydown=function keyEventHandler(evt){evt=getEvent(evt);switch(evt.keyCode){case 69:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){evalLastCommand();cancelKeyEvent(evt);return false;}',"break;case 75:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){focusSearch();cancelKeyEvent(evt);return false;}","break;case 40:case 76:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){focusCommandLine();cancelKeyEvent(evt);return false;}","break;}};setTimeout(setLogContainerHeight,20);setShowCommandLine(showCommandLine);doSearch();};window.onunload=function(){if(mainWindowExists()){appender.unload();}",'appender=null;};function toggleLoggingEnabled(){setLoggingEnabled($("enableLogging").checked);}',"function setLoggingEnabled(enable){loggingEnabled=enable;}","var appender=null;function setAppender(appenderParam){appender=appenderParam;}",'function setShowCloseButton(showCloseButton){$("closeButton").style.display=showCloseButton?"inline":"none";}','function setShowHideButton(showHideButton){$("hideButton").style.display=showHideButton?"inline":"none";}',"var newestAtTop=false;function LogItemContentReverser(){}","LogItemContentReverser.prototype=new LogItemVisitor();LogItemContentReverser.prototype.visitGroup=function(group){group.reverseChildren();this.visitChildren(group);};function setNewestAtTop(isNewestAtTop){var oldNewestAtTop=newestAtTop;var i,iLen,j,jLen;newestAtTop=Boolean(isNewestAtTop);if(oldNewestAtTop!=newestAtTop){var visitor=new LogItemContentReverser();rootGroup.accept(visitor);if(currentSearch){var currentMatch=currentSearch.matches[currentMatchIndex];var matchIndex=0;var matches=[];var actOnLogEntry=function(logEntry){var logEntryMatches=logEntry.getSearchMatches();for(j=0,jLen=logEntryMatches.length;j<jLen;j++){matches[matchIndex]=logEntryMatches[j];if(currentMatch&&logEntryMatches[j].equals(currentMatch)){currentMatchIndex=matchIndex;}","matchIndex++;}};if(newestAtTop){for(i=logEntries.length-1;i>=0;i--){actOnLogEntry(logEntries[i]);}}else{for(i=0,iLen=logEntries.length;i<iLen;i++){actOnLogEntry(logEntries[i]);}}","currentSearch.matches=matches;if(currentMatch){currentMatch.setCurrent();}}else if(scrollToLatest){doScrollToLatest();}}",'$("newestAtTop").checked=isNewestAtTop;}','function toggleNewestAtTop(){var isNewestAtTop=$("newestAtTop").checked;setNewestAtTop(isNewestAtTop);}',"var scrollToLatest=true;function setScrollToLatest(isScrollToLatest){scrollToLatest=isScrollToLatest;if(scrollToLatest){doScrollToLatest();}",'$("scrollToLatest").checked=isScrollToLatest;}','function toggleScrollToLatest(){var isScrollToLatest=$("scrollToLatest").checked;setScrollToLatest(isScrollToLatest);}','function doScrollToLatest(){var l=logMainContainer;if(typeof l.scrollTop!="undefined"){if(newestAtTop){l.scrollTop=0;}else{var latestLogEntry=l.lastChild;if(latestLogEntry){l.scrollTop=l.scrollHeight;}}}}',"var closeIfOpenerCloses=true;function setCloseIfOpenerCloses(isCloseIfOpenerCloses){closeIfOpenerCloses=isCloseIfOpenerCloses;}","var maxMessages=null;function setMaxMessages(max){maxMessages=max;pruneLogEntries();}",'var showCommandLine=false;function setShowCommandLine(isShowCommandLine){showCommandLine=isShowCommandLine;if(loaded){$("commandLine").style.display=showCommandLine?"block":"none";setCommandInputWidth();setLogContainerHeight();}}','function focusCommandLine(){if(loaded){$("command").focus();}}','function focusSearch(){if(loaded){$("searchBox").focus();}}',"function getLogItems(){var items=[];for(var i=0,len=logItems.length;i<len;i++){logItems[i].serialize(items);}","return items;}","function setLogItems(items){var loggingReallyEnabled=loggingEnabled;loggingEnabled=true;for(var i=0,len=items.length;i<len;i++){switch(items[i][0]){case LogItem.serializedItemKeys.LOG_ENTRY:log(items[i][1],items[i][2]);break;case LogItem.serializedItemKeys.GROUP_START:group(items[i][1]);break;case LogItem.serializedItemKeys.GROUP_END:groupEnd();break;}}","loggingEnabled=loggingReallyEnabled;}","function log(logLevel,formattedMessage){if(loggingEnabled){var logEntry=new LogEntry(logLevel,formattedMessage);logEntries.push(logEntry);logEntriesAndSeparators.push(logEntry);logItems.push(logEntry);currentGroup.addChild(logEntry);if(loaded){if(logQueuedEventsTimer!==null){clearTimeout(logQueuedEventsTimer);}","logQueuedEventsTimer=setTimeout(renderQueuedLogItems,renderDelay);unrenderedLogItemsExist=true;}}}","function renderQueuedLogItems(){logQueuedEventsTimer=null;var pruned=pruneLogEntries();var initiallyHasMatches=currentSearch?currentSearch.hasMatches():false;for(var i=0,len=logItems.length;i<len;i++){if(!logItems[i].rendered){logItems[i].render();logItems[i].appendToLog();if(currentSearch&&(logItems[i]instanceof LogEntry)){currentSearch.applyTo(logItems[i]);}}}","if(currentSearch){if(pruned){if(currentSearch.hasVisibleMatches()){if(currentMatchIndex===null){setCurrentMatchIndex(0);}","displayMatches();}else{displayNoMatches();}}else if(!initiallyHasMatches&&currentSearch.hasVisibleMatches()){setCurrentMatchIndex(0);displayMatches();}}","if(scrollToLatest){doScrollToLatest();}","unrenderedLogItemsExist=false;}","function pruneLogEntries(){if((maxMessages!==null)&&(logEntriesAndSeparators.length>maxMessages)){var numberToDelete=logEntriesAndSeparators.length-maxMessages;var prunedLogEntries=logEntriesAndSeparators.slice(0,numberToDelete);if(currentSearch){currentSearch.removeMatches(prunedLogEntries);}","var group;for(var i=0;i<numberToDelete;i++){group=logEntriesAndSeparators[i].group;array_remove(logItems,logEntriesAndSeparators[i]);array_remove(logEntries,logEntriesAndSeparators[i]);logEntriesAndSeparators[i].remove(true,true);if(group.children.length===0&&group!==currentGroup&&group!==rootGroup){array_remove(logItems,group);group.remove(true,true);}}","logEntriesAndSeparators=array_removeFromStart(logEntriesAndSeparators,numberToDelete);return true;}","return false;}",'function group(name,startExpanded){if(loggingEnabled){initiallyExpanded=(typeof startExpanded==="undefined")?true:Boolean(startExpanded);var newGroup=new Group(name,false,initiallyExpanded);currentGroup.addChild(newGroup);currentGroup=newGroup;logItems.push(newGroup);if(loaded){if(logQueuedEventsTimer!==null){clearTimeout(logQueuedEventsTimer);}',"logQueuedEventsTimer=setTimeout(renderQueuedLogItems,renderDelay);unrenderedLogItemsExist=true;}}}","function groupEnd(){currentGroup=(currentGroup===rootGroup)?rootGroup:currentGroup.group;}","function mainPageReloaded(){currentGroup=rootGroup;var separator=new Separator();logEntriesAndSeparators.push(separator);logItems.push(separator);currentGroup.addChild(separator);}","function closeWindow(){if(appender&&mainWindowExists()){appender.close(true);}else{window.close();}}","function hide(){if(appender&&mainWindowExists()){appender.hide();}}",'var mainWindow=window;var windowId="log4javascriptConsoleWindow_"+new Date().getTime()+"_"+(""+Math.random()).substr(2);function setMainWindow(win){mainWindow=win;mainWindow[windowId]=window;if(opener&&closeIfOpenerCloses){pollOpener();}}',"function pollOpener(){if(closeIfOpenerCloses){if(mainWindowExists()){setTimeout(pollOpener,500);}else{closeWindow();}}}","function mainWindowExists(){try{return(mainWindow&&!mainWindow.closed&&mainWindow[windowId]==window);}catch(ex){}","return false;}",'var logLevels=["TRACE","DEBUG","INFO","WARN","ERROR","FATAL"];function getCheckBox(logLevel){return $("switch_"+logLevel);}','function getIeWrappedLogContainer(){return $("log_wrapped");}','function getIeUnwrappedLogContainer(){return $("log_unwrapped");}',"function applyFilters(){for(var i=0;i<logLevels.length;i++){if(getCheckBox(logLevels[i]).checked){addClass(logMainContainer,logLevels[i]);}else{removeClass(logMainContainer,logLevels[i]);}}","updateSearchFromFilters();}",'function toggleAllLevels(){var turnOn=$("switch_ALL").checked;for(var i=0;i<logLevels.length;i++){getCheckBox(logLevels[i]).checked=turnOn;if(turnOn){addClass(logMainContainer,logLevels[i]);}else{removeClass(logMainContainer,logLevels[i]);}}}','function checkAllLevels(){for(var i=0;i<logLevels.length;i++){if(!getCheckBox(logLevels[i]).checked){getCheckBox("ALL").checked=false;return;}}','getCheckBox("ALL").checked=true;}',"function clearLog(){rootGroup.clear();currentGroup=rootGroup;logEntries=[];logItems=[];logEntriesAndSeparators=[];doSearch();}",'function toggleWrap(){var enable=$("wrap").checked;if(enable){addClass(logMainContainer,"wrap");}else{removeClass(logMainContainer,"wrap");}',"refreshCurrentMatch();}","var searchTimer=null;function scheduleSearch(){try{clearTimeout(searchTimer);}catch(ex){}","searchTimer=setTimeout(doSearch,500);}","function Search(searchTerm,isRegex,searchRegex,isCaseSensitive){this.searchTerm=searchTerm;this.isRegex=isRegex;this.searchRegex=searchRegex;this.isCaseSensitive=isCaseSensitive;this.matches=[];}","Search.prototype={hasMatches:function(){return this.matches.length>0;},hasVisibleMatches:function(){if(this.hasMatches()){for(var i=0;i<this.matches.length;i++){if(this.matches[i].isVisible()){return true;}}}","return false;},match:function(logEntry){var entryText=String(logEntry.formattedMessage);var matchesSearch=false;if(this.isRegex){matchesSearch=this.searchRegex.test(entryText);}else if(this.isCaseSensitive){matchesSearch=(entryText.indexOf(this.searchTerm)>-1);}else{matchesSearch=(entryText.toLowerCase().indexOf(this.searchTerm.toLowerCase())>-1);}","return matchesSearch;},getNextVisibleMatchIndex:function(){for(var i=currentMatchIndex+1;i<this.matches.length;i++){if(this.matches[i].isVisible()){return i;}}","for(i=0;i<=currentMatchIndex;i++){if(this.matches[i].isVisible()){return i;}}","return-1;},getPreviousVisibleMatchIndex:function(){for(var i=currentMatchIndex-1;i>=0;i--){if(this.matches[i].isVisible()){return i;}}","for(var i=this.matches.length-1;i>=currentMatchIndex;i--){if(this.matches[i].isVisible()){return i;}}",'return-1;},applyTo:function(logEntry){var doesMatch=this.match(logEntry);if(doesMatch){logEntry.group.expand();logEntry.setSearchMatch(true);var logEntryContent;var wrappedLogEntryContent;var searchTermReplacementStartTag="<span class=\\"searchterm\\">";var searchTermReplacementEndTag="<"+"/span>";var preTagName=isIe?"pre":"span";var preStartTag="<"+preTagName+" class=\\"pre\\">";var preEndTag="<"+"/"+preTagName+">";var startIndex=0;var searchIndex,matchedText,textBeforeMatch;if(this.isRegex){var flags=this.isCaseSensitive?"g":"gi";var capturingRegex=new RegExp("("+this.searchRegex.source+")",flags);var rnd=(""+Math.random()).substr(2);var startToken="%%s"+rnd+"%%";var endToken="%%e"+rnd+"%%";logEntryContent=logEntry.formattedMessage.replace(capturingRegex,startToken+"$1"+endToken);logEntryContent=escapeHtml(logEntryContent);var result;var searchString=logEntryContent;logEntryContent="";wrappedLogEntryContent="";while((searchIndex=searchString.indexOf(startToken,startIndex))>-1){var endTokenIndex=searchString.indexOf(endToken,searchIndex);matchedText=searchString.substring(searchIndex+startToken.length,endTokenIndex);textBeforeMatch=searchString.substring(startIndex,searchIndex);logEntryContent+=preStartTag+textBeforeMatch+preEndTag;logEntryContent+=searchTermReplacementStartTag+preStartTag+matchedText+',"preEndTag+searchTermReplacementEndTag;if(isIe){wrappedLogEntryContent+=textBeforeMatch+searchTermReplacementStartTag+","matchedText+searchTermReplacementEndTag;}","startIndex=endTokenIndex+endToken.length;}",'logEntryContent+=preStartTag+searchString.substr(startIndex)+preEndTag;if(isIe){wrappedLogEntryContent+=searchString.substr(startIndex);}}else{logEntryContent="";wrappedLogEntryContent="";var searchTermReplacementLength=searchTermReplacementStartTag.length+',"this.searchTerm.length+searchTermReplacementEndTag.length;var searchTermLength=this.searchTerm.length;var searchTermLowerCase=this.searchTerm.toLowerCase();var logTextLowerCase=logEntry.formattedMessage.toLowerCase();while((searchIndex=logTextLowerCase.indexOf(searchTermLowerCase,startIndex))>-1){matchedText=escapeHtml(logEntry.formattedMessage.substr(searchIndex,this.searchTerm.length));textBeforeMatch=escapeHtml(logEntry.formattedMessage.substring(startIndex,searchIndex));var searchTermReplacement=searchTermReplacementStartTag+","preStartTag+matchedText+preEndTag+searchTermReplacementEndTag;logEntryContent+=preStartTag+textBeforeMatch+preEndTag+searchTermReplacement;if(isIe){wrappedLogEntryContent+=textBeforeMatch+searchTermReplacementStartTag+","matchedText+searchTermReplacementEndTag;}","startIndex=searchIndex+searchTermLength;}","var textAfterLastMatch=escapeHtml(logEntry.formattedMessage.substr(startIndex));logEntryContent+=preStartTag+textAfterLastMatch+preEndTag;if(isIe){wrappedLogEntryContent+=textAfterLastMatch;}}","logEntry.setContent(logEntryContent,wrappedLogEntryContent);var logEntryMatches=logEntry.getSearchMatches();this.matches=this.matches.concat(logEntryMatches);}else{logEntry.setSearchMatch(false);logEntry.setContent(logEntry.formattedMessage,logEntry.formattedMessage);}","return doesMatch;},removeMatches:function(logEntries){var matchesToRemoveCount=0;var currentMatchRemoved=false;var matchesToRemove=[];var i,iLen,j,jLen;for(i=0,iLen=this.matches.length;i<iLen;i++){for(j=0,jLen=logEntries.length;j<jLen;j++){if(this.matches[i].belongsTo(logEntries[j])){matchesToRemove.push(this.matches[i]);if(i===currentMatchIndex){currentMatchRemoved=true;}}}}","var newMatch=currentMatchRemoved?null:this.matches[currentMatchIndex];if(currentMatchRemoved){for(i=currentMatchIndex,iLen=this.matches.length;i<iLen;i++){if(this.matches[i].isVisible()&&!array_contains(matchesToRemove,this.matches[i])){newMatch=this.matches[i];break;}}}","for(i=0,iLen=matchesToRemove.length;i<iLen;i++){array_remove(this.matches,matchesToRemove[i]);matchesToRemove[i].remove();}","if(this.hasVisibleMatches()){if(newMatch===null){setCurrentMatchIndex(0);}else{var newMatchIndex=0;for(i=0,iLen=this.matches.length;i<iLen;i++){if(newMatch===this.matches[i]){newMatchIndex=i;break;}}","setCurrentMatchIndex(newMatchIndex);}}else{currentMatchIndex=null;displayNoMatches();}}};function getPageOffsetTop(el,container){var currentEl=el;var y=0;while(currentEl&&currentEl!=container){y+=currentEl.offsetTop;currentEl=currentEl.offsetParent;}","return y;}",'function scrollIntoView(el){var logContainer=logMainContainer;if(!$("wrap").checked){var logContainerLeft=logContainer.scrollLeft;var logContainerRight=logContainerLeft+logContainer.offsetWidth;var elLeft=el.offsetLeft;var elRight=elLeft+el.offsetWidth;if(elLeft<logContainerLeft||elRight>logContainerRight){logContainer.scrollLeft=elLeft-(logContainer.offsetWidth-el.offsetWidth)/2;}}',"var logContainerTop=logContainer.scrollTop;var logContainerBottom=logContainerTop+logContainer.offsetHeight;var elTop=getPageOffsetTop(el)-getToolBarsHeight();var elBottom=elTop+el.offsetHeight;if(elTop<logContainerTop||elBottom>logContainerBottom){logContainer.scrollTop=elTop-(logContainer.offsetHeight-el.offsetHeight)/2;}}","function Match(logEntryLevel,spanInMainDiv,spanInUnwrappedPre,spanInWrappedDiv){this.logEntryLevel=logEntryLevel;this.spanInMainDiv=spanInMainDiv;if(isIe){this.spanInUnwrappedPre=spanInUnwrappedPre;this.spanInWrappedDiv=spanInWrappedDiv;}","this.mainSpan=isIe?spanInUnwrappedPre:spanInMainDiv;}",'Match.prototype={equals:function(match){return this.mainSpan===match.mainSpan;},setCurrent:function(){if(isIe){addClass(this.spanInUnwrappedPre,"currentmatch");addClass(this.spanInWrappedDiv,"currentmatch");var elementToScroll=$("wrap").checked?this.spanInWrappedDiv:this.spanInUnwrappedPre;scrollIntoView(elementToScroll);}else{addClass(this.spanInMainDiv,"currentmatch");scrollIntoView(this.spanInMainDiv);}},belongsTo:function(logEntry){if(isIe){return isDescendant(this.spanInUnwrappedPre,logEntry.unwrappedPre);}else{return isDescendant(this.spanInMainDiv,logEntry.mainDiv);}},setNotCurrent:function(){if(isIe){removeClass(this.spanInUnwrappedPre,"currentmatch");removeClass(this.spanInWrappedDiv,"currentmatch");}else{removeClass(this.spanInMainDiv,"currentmatch");}},isOrphan:function(){return isOrphan(this.mainSpan);},isVisible:function(){return getCheckBox(this.logEntryLevel).checked;},remove:function(){if(isIe){this.spanInUnwrappedPre=null;this.spanInWrappedDiv=null;}else{this.spanInMainDiv=null;}}};var currentSearch=null;var currentMatchIndex=null;function doSearch(){var searchBox=$("searchBox");var searchTerm=searchBox.value;var isRegex=$("searchRegex").checked;var isCaseSensitive=$("searchCaseSensitive").checked;var i;if(searchTerm===""){$("searchReset").disabled=true;$("searchNav").style.display="none";removeClass(document.body,"searching");removeClass(searchBox,"hasmatches");removeClass(searchBox,"nomatches");for(i=0;i<logEntries.length;i++){logEntries[i].clearSearch();logEntries[i].setContent(logEntries[i].formattedMessage,logEntries[i].formattedMessage);}','currentSearch=null;setLogContainerHeight();}else{$("searchReset").disabled=false;$("searchNav").style.display="block";var searchRegex;var regexValid;if(isRegex){try{searchRegex=isCaseSensitive?new RegExp(searchTerm,"g"):new RegExp(searchTerm,"gi");regexValid=true;replaceClass(searchBox,"validregex","invalidregex");searchBox.title="Valid regex";}catch(ex){regexValid=false;replaceClass(searchBox,"invalidregex","validregex");searchBox.title="Invalid regex: "+(ex.message?ex.message:(ex.description?ex.description:"unknown error"));return;}}else{searchBox.title="";removeClass(searchBox,"validregex");removeClass(searchBox,"invalidregex");}','addClass(document.body,"searching");currentSearch=new Search(searchTerm,isRegex,searchRegex,isCaseSensitive);for(i=0;i<logEntries.length;i++){currentSearch.applyTo(logEntries[i]);}',"setLogContainerHeight();if(currentSearch.hasVisibleMatches()){setCurrentMatchIndex(0);displayMatches();}else{displayNoMatches();}}}","function updateSearchFromFilters(){if(currentSearch){if(currentSearch.hasMatches()){if(currentMatchIndex===null){currentMatchIndex=0;}","var currentMatch=currentSearch.matches[currentMatchIndex];if(currentMatch.isVisible()){displayMatches();setCurrentMatchIndex(currentMatchIndex);}else{currentMatch.setNotCurrent();var nextVisibleMatchIndex=currentSearch.getNextVisibleMatchIndex();if(nextVisibleMatchIndex>-1){setCurrentMatchIndex(nextVisibleMatchIndex);displayMatches();}else{displayNoMatches();}}}else{displayNoMatches();}}}","function refreshCurrentMatch(){if(currentSearch&&currentSearch.hasVisibleMatches()){setCurrentMatchIndex(currentMatchIndex);}}",'function displayMatches(){replaceClass($("searchBox"),"hasmatches","nomatches");$("searchBox").title=""+currentSearch.matches.length+" matches found";$("searchNav").style.display="block";setLogContainerHeight();}','function displayNoMatches(){replaceClass($("searchBox"),"nomatches","hasmatches");$("searchBox").title="No matches found";$("searchNav").style.display="none";setLogContainerHeight();}','function toggleSearchEnabled(enable){enable=(typeof enable=="undefined")?!$("searchDisable").checked:enable;$("searchBox").disabled=!enable;$("searchReset").disabled=!enable;$("searchRegex").disabled=!enable;$("searchNext").disabled=!enable;$("searchPrevious").disabled=!enable;$("searchCaseSensitive").disabled=!enable;$("searchNav").style.display=(enable&&($("searchBox").value!=="")&&currentSearch&&currentSearch.hasVisibleMatches())?"block":"none";if(enable){removeClass($("search"),"greyedout");addClass(document.body,"searching");if($("searchHighlight").checked){addClass(logMainContainer,"searchhighlight");}else{removeClass(logMainContainer,"searchhighlight");}','if($("searchFilter").checked){addClass(logMainContainer,"searchfilter");}else{removeClass(logMainContainer,"searchfilter");}','$("searchDisable").checked=!enable;}else{addClass($("search"),"greyedout");removeClass(document.body,"searching");removeClass(logMainContainer,"searchhighlight");removeClass(logMainContainer,"searchfilter");}',"setLogContainerHeight();}",'function toggleSearchFilter(){var enable=$("searchFilter").checked;if(enable){addClass(logMainContainer,"searchfilter");}else{removeClass(logMainContainer,"searchfilter");}',"refreshCurrentMatch();}",'function toggleSearchHighlight(){var enable=$("searchHighlight").checked;if(enable){addClass(logMainContainer,"searchhighlight");}else{removeClass(logMainContainer,"searchhighlight");}}','function clearSearch(){$("searchBox").value="";doSearch();}','function searchNext(){if(currentSearch!==null&&currentMatchIndex!==null){currentSearch.matches[currentMatchIndex].setNotCurrent();var nextMatchIndex=currentSearch.getNextVisibleMatchIndex();if(nextMatchIndex>currentMatchIndex||confirm("Reached the end of the page. Start from the top?")){setCurrentMatchIndex(nextMatchIndex);}}}','function searchPrevious(){if(currentSearch!==null&&currentMatchIndex!==null){currentSearch.matches[currentMatchIndex].setNotCurrent();var previousMatchIndex=currentSearch.getPreviousVisibleMatchIndex();if(previousMatchIndex<currentMatchIndex||confirm("Reached the start of the page. Continue from the bottom?")){setCurrentMatchIndex(previousMatchIndex);}}}',"function setCurrentMatchIndex(index){currentMatchIndex=index;currentSearch.matches[currentMatchIndex].setCurrent();}",'function addClass(el,cssClass){if(!hasClass(el,cssClass)){if(el.className){el.className+=" "+cssClass;}else{el.className=cssClass;}}}','function hasClass(el,cssClass){if(el.className){var classNames=el.className.split(" ");return array_contains(classNames,cssClass);}',"return false;}",'function removeClass(el,cssClass){if(hasClass(el,cssClass)){var existingClasses=el.className.split(" ");var newClasses=[];for(var i=0,len=existingClasses.length;i<len;i++){if(existingClasses[i]!=cssClass){newClasses[newClasses.length]=existingClasses[i];}}','el.className=newClasses.join(" ");}}',"function replaceClass(el,newCssClass,oldCssClass){removeClass(el,oldCssClass);addClass(el,newCssClass);}","function getElementsByClass(el,cssClass,tagName){var elements=el.getElementsByTagName(tagName);var matches=[];for(var i=0,len=elements.length;i<len;i++){if(hasClass(elements[i],cssClass)){matches.push(elements[i]);}}","return matches;}","function $(id){return document.getElementById(id);}","function isDescendant(node,ancestorNode){while(node!=null){if(node===ancestorNode){return true;}","node=node.parentNode;}","return false;}","function isOrphan(node){var currentNode=node;while(currentNode){if(currentNode==document.body){return false;}","currentNode=currentNode.parentNode;}","return true;}",'function escapeHtml(str){return str.replace(/&/g,"&amp;").replace(/[<]/g,"&lt;").replace(/>/g,"&gt;");}',"function getWindowWidth(){if(window.innerWidth){return window.innerWidth;}else if(document.documentElement&&document.documentElement.clientWidth){return document.documentElement.clientWidth;}else if(document.body){return document.body.clientWidth;}","return 0;}","function getWindowHeight(){if(window.innerHeight){return window.innerHeight;}else if(document.documentElement&&document.documentElement.clientHeight){return document.documentElement.clientHeight;}else if(document.body){return document.body.clientHeight;}","return 0;}",'function getToolBarsHeight(){return $("switches").offsetHeight;}','function getChromeHeight(){var height=getToolBarsHeight();if(showCommandLine){height+=$("commandLine").offsetHeight;}',"return height;}",'function setLogContainerHeight(){if(logMainContainer){var windowHeight=getWindowHeight();$("body").style.height=getWindowHeight()+"px";logMainContainer.style.height=""+','Math.max(0,windowHeight-getChromeHeight())+"px";}}','function setCommandInputWidth(){if(showCommandLine){$("command").style.width=""+Math.max(0,$("commandLineContainer").offsetWidth-','($("evaluateButton").offsetWidth+13))+"px";}}',"window.onresize=function(){setCommandInputWidth();setLogContainerHeight();};if(!Array.prototype.push){Array.prototype.push=function(){for(var i=0,len=arguments.length;i<len;i++){this[this.length]=arguments[i];}","return this.length;};}","if(!Array.prototype.pop){Array.prototype.pop=function(){if(this.length>0){var val=this[this.length-1];this.length=this.length-1;return val;}};}","if(!Array.prototype.shift){Array.prototype.shift=function(){if(this.length>0){var firstItem=this[0];for(var i=0,len=this.length-1;i<len;i++){this[i]=this[i+1];}","this.length=this.length-1;return firstItem;}};}","if(!Array.prototype.splice){Array.prototype.splice=function(startIndex,deleteCount){var itemsAfterDeleted=this.slice(startIndex+deleteCount);var itemsDeleted=this.slice(startIndex,startIndex+deleteCount);this.length=startIndex;var argumentsArray=[];for(var i=0,len=arguments.length;i<len;i++){argumentsArray[i]=arguments[i];}","var itemsToAppend=(argumentsArray.length>2)?itemsAfterDeleted=argumentsArray.slice(2).concat(itemsAfterDeleted):itemsAfterDeleted;for(i=0,len=itemsToAppend.length;i<len;i++){this.push(itemsToAppend[i]);}","return itemsDeleted;};}","function array_remove(arr,val){var index=-1;for(var i=0,len=arr.length;i<len;i++){if(arr[i]===val){index=i;break;}}","if(index>=0){arr.splice(index,1);return index;}else{return false;}}","function array_removeFromStart(array,numberToRemove){if(Array.prototype.splice){array.splice(0,numberToRemove);}else{for(var i=numberToRemove,len=array.length;i<len;i++){array[i-numberToRemove]=array[i];}","array.length=array.length-numberToRemove;}","return array;}","function array_contains(arr,val){for(var i=0,len=arr.length;i<len;i++){if(arr[i]==val){return true;}}","return false;}","function getErrorMessage(ex){if(ex.message){return ex.message;}else if(ex.description){return ex.description;}",'return""+ex;}',"function moveCaretToEnd(input){if(input.setSelectionRange){input.focus();var length=input.value.length;input.setSelectionRange(length,length);}else if(input.createTextRange){var range=input.createTextRange();range.collapse(false);range.select();}","input.focus();}",'function stopPropagation(evt){if(evt.stopPropagation){evt.stopPropagation();}else if(typeof evt.cancelBubble!="undefined"){evt.cancelBubble=true;}}',"function getEvent(evt){return evt?evt:event;}","function getTarget(evt){return evt.target?evt.target:evt.srcElement;}",'function getRelatedTarget(evt){if(evt.relatedTarget){return evt.relatedTarget;}else if(evt.srcElement){switch(evt.type){case"mouseover":return evt.fromElement;case"mouseout":return evt.toElement;default:return evt.srcElement;}}}',"function cancelKeyEvent(evt){evt.returnValue=false;stopPropagation(evt);}",'function evalCommandLine(){var expr=$("command").value;evalCommand(expr);$("command").value="";}',"function evalLastCommand(){if(lastCommand!=null){evalCommand(lastCommand);}}",'var lastCommand=null;var commandHistory=[];var currentCommandIndex=0;function evalCommand(expr){if(appender){appender.evalCommandAndAppend(expr);}else{var prefix=">>> "+expr+"\\r\\n";try{log("INFO",prefix+eval(expr));}catch(ex){log("ERROR",prefix+"Error: "+getErrorMessage(ex));}}',"if(expr!=commandHistory[commandHistory.length-1]){commandHistory.push(expr);if(appender){appender.storeCommandHistory(commandHistory);}}","currentCommandIndex=(expr==commandHistory[currentCommandIndex])?currentCommandIndex+1:commandHistory.length;lastCommand=expr;}","//]]>","</script>",'<style type="text/css">',"body{background-color:white;color:black;padding:0;margin:0;font-family:tahoma,verdana,arial,helvetica,sans-serif;overflow:hidden}div#switchesContainer input{margin-bottom:0}div.toolbar{border-top:solid #ffffff 1px;border-bottom:solid #aca899 1px;background-color:#f1efe7;padding:3px 5px;font-size:68.75%}div.toolbar,div#search input{font-family:tahoma,verdana,arial,helvetica,sans-serif}div.toolbar input.button{padding:0 5px;font-size:100%}div.toolbar input.hidden{display:none}div#switches input#clearButton{margin-left:20px}div#levels label{font-weight:bold}div#levels label,div#options label{margin-right:5px}div#levels label#wrapLabel{font-weight:normal}div#search label{margin-right:10px}div#search label.searchboxlabel{margin-right:0}div#search input{font-size:100%}div#search input.validregex{color:green}div#search input.invalidregex{color:red}div#search input.nomatches{color:white;background-color:#ff6666}div#search input.nomatches{color:white;background-color:#ff6666}div#searchNav{display:none}div#commandLine{display:none}div#commandLine input#command{font-size:100%;font-family:Courier New,Courier}div#commandLine input#evaluateButton{}*.greyedout{color:gray !important;border-color:gray !important}*.greyedout *.alwaysenabled{color:black}*.unselectable{-khtml-user-select:none;-moz-user-select:none;user-select:none}div#log{font-family:Courier New,Courier;font-size:75%;width:100%;overflow:auto;clear:both;position:relative}div.group{border-color:#cccccc;border-style:solid;border-width:1px 0 1px 1px;overflow:visible}div.oldIe div.group,div.oldIe div.group *,div.oldIe *.logentry{height:1%}div.group div.groupheading span.expander{border:solid black 1px;font-family:Courier New,Courier;font-size:0.833em;background-color:#eeeeee;position:relative;top:-1px;color:black;padding:0 2px;cursor:pointer;cursor:hand;height:1%}div.group div.groupcontent{margin-left:10px;padding-bottom:2px;overflow:visible}div.group div.expanded{display:block}div.group div.collapsed{display:none}*.logentry{overflow:visible;display:none;white-space:pre}span.pre{white-space:pre}pre.unwrapped{display:inline !important}pre.unwrapped pre.pre,div.wrapped pre.pre{display:inline}div.wrapped pre.pre{white-space:normal}div.wrapped{display:none}body.searching *.logentry span.currentmatch{color:white !important;background-color:green !important}body.searching div.searchhighlight *.logentry span.searchterm{color:black;background-color:yellow}div.wrap *.logentry{white-space:normal !important;border-width:0 0 1px 0;border-color:#dddddd;border-style:dotted}div.wrap #log_wrapped,#log_unwrapped{display:block}div.wrap #log_unwrapped,#log_wrapped{display:none}div.wrap *.logentry span.pre{overflow:visible;white-space:normal}div.wrap *.logentry pre.unwrapped{display:none}div.wrap *.logentry span.wrapped{display:inline}div.searchfilter *.searchnonmatch{display:none !important}div#log *.TRACE,label#label_TRACE{color:#666666}div#log *.DEBUG,label#label_DEBUG{color:green}div#log *.INFO,label#label_INFO{color:#000099}div#log *.WARN,label#label_WARN{color:#999900}div#log *.ERROR,label#label_ERROR{color:red}div#log *.FATAL,label#label_FATAL{color:#660066}div.TRACE#log *.TRACE,div.DEBUG#log *.DEBUG,div.INFO#log *.INFO,div.WARN#log *.WARN,div.ERROR#log *.ERROR,div.FATAL#log *.FATAL{display:block}div#log div.separator{background-color:#cccccc;margin:5px 0;line-height:1px}","</style>","</head>",'<body id="body">','<div id="switchesContainer">','<div id="switches">','<div id="levels" class="toolbar">',"Filters:",'<input type="checkbox" id="switch_TRACE" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide trace messages" /><label for="switch_TRACE" id="label_TRACE">trace</label>','<input type="checkbox" id="switch_DEBUG" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide debug messages" /><label for="switch_DEBUG" id="label_DEBUG">debug</label>','<input type="checkbox" id="switch_INFO" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide info messages" /><label for="switch_INFO" id="label_INFO">info</label>','<input type="checkbox" id="switch_WARN" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide warn messages" /><label for="switch_WARN" id="label_WARN">warn</label>','<input type="checkbox" id="switch_ERROR" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide error messages" /><label for="switch_ERROR" id="label_ERROR">error</label>','<input type="checkbox" id="switch_FATAL" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide fatal messages" /><label for="switch_FATAL" id="label_FATAL">fatal</label>','<input type="checkbox" id="switch_ALL" onclick="toggleAllLevels(); applyFilters()" checked="checked" title="Show/hide all messages" /><label for="switch_ALL" id="label_ALL">all</label>',"</div>",'<div id="search" class="toolbar">','<label for="searchBox" class="searchboxlabel">Search:</label> <input type="text" id="searchBox" onclick="toggleSearchEnabled(true)" onkeyup="scheduleSearch()" size="20" />','<input type="button" id="searchReset" disabled="disabled" value="Reset" onclick="clearSearch()" class="button" title="Reset the search" />','<input type="checkbox" id="searchRegex" onclick="doSearch()" title="If checked, search is treated as a regular expression" /><label for="searchRegex">Regex</label>','<input type="checkbox" id="searchCaseSensitive" onclick="doSearch()" title="If checked, search is case sensitive" /><label for="searchCaseSensitive">Match case</label>','<input type="checkbox" id="searchDisable" onclick="toggleSearchEnabled()" title="Enable/disable search" /><label for="searchDisable" class="alwaysenabled">Disable</label>','<div id="searchNav">','<input type="button" id="searchNext" disabled="disabled" value="Next" onclick="searchNext()" class="button" title="Go to the next matching log entry" />','<input type="button" id="searchPrevious" disabled="disabled" value="Previous" onclick="searchPrevious()" class="button" title="Go to the previous matching log entry" />','<input type="checkbox" id="searchFilter" onclick="toggleSearchFilter()" title="If checked, non-matching log entries are filtered out" /><label for="searchFilter">Filter</label>','<input type="checkbox" id="searchHighlight" onclick="toggleSearchHighlight()" title="Highlight matched search terms" /><label for="searchHighlight" class="alwaysenabled">Highlight all</label>',"</div>","</div>",'<div id="options" class="toolbar">',"Options:",'<input type="checkbox" id="enableLogging" onclick="toggleLoggingEnabled()" checked="checked" title="Enable/disable logging" /><label for="enableLogging" id="enableLoggingLabel">Log</label>','<input type="checkbox" id="wrap" onclick="toggleWrap()" title="Enable / disable word wrap" /><label for="wrap" id="wrapLabel">Wrap</label>','<input type="checkbox" id="newestAtTop" onclick="toggleNewestAtTop()" title="If checked, causes newest messages to appear at the top" /><label for="newestAtTop" id="newestAtTopLabel">Newest at the top</label>','<input type="checkbox" id="scrollToLatest" onclick="toggleScrollToLatest()" checked="checked" title="If checked, window automatically scrolls to a new message when it is added" /><label for="scrollToLatest" id="scrollToLatestLabel">Scroll to latest</label>','<input type="button" id="clearButton" value="Clear" onclick="clearLog()" class="button" title="Clear all log messages"  />','<input type="button" id="hideButton" value="Hide" onclick="hide()" class="hidden button" title="Hide the console" />','<input type="button" id="closeButton" value="Close" onclick="closeWindow()" class="hidden button" title="Close the window" />',"</div>","</div>","</div>",'<div id="log" class="TRACE DEBUG INFO WARN ERROR FATAL"></div>','<div id="commandLine" class="toolbar">','<div id="commandLineContainer">','<input type="text" id="command" title="Enter a JavaScript command here and hit return or press \'Evaluate\'" />','<input type="button" id="evaluateButton" value="Evaluate" class="button" title="Evaluate the command" onclick="evalCommandLine()" />',"</div>","</div>","</body>","</html>",""];
},d=[];ConsoleAppender=function(){};var e=1;ConsoleAppender.prototype=new Appender,ConsoleAppender.prototype.create=function(a,b,f,g,h,i,j,k){function l(a,b){this.loggingEvent=a,this.levelName=a.level.name,this.formattedMessage=b}function m(a,b){this.name=a,this.initiallyExpanded=b}function n(){}var o=this,p=!1,q=!1,r=!1,s=!1,t=[],u=!0,v=e++;g=extractBooleanFromParam(g,this.defaults.initiallyMinimized),f=extractBooleanFromParam(f,this.defaults.lazyInit),h=extractBooleanFromParam(h,this.defaults.useDocumentWrite);var w=this.defaults.newestMessageAtTop,x=this.defaults.scrollToLatestMessage;i=i?i:this.defaults.width,j=j?j:this.defaults.height;var y=this.defaults.maxMessages,z=this.defaults.showCommandLine,A=this.defaults.commandLineObjectExpansionDepth,B=this.defaults.showHideButton,C=this.defaults.showCloseButton;this.setLayout(this.defaults.layout);var D,E,F,G,H,I=a?"InPageAppender":"PopUpAppender",J=function(a){return!q||(handleError(I+": configuration option '"+a+"' may not be set after the appender has been initialized"),!1)},K=function(){return r&&u&&!s};this.isNewestMessageAtTop=function(){return w},this.setNewestMessageAtTop=function(a){w=bool(a),K()&&G().setNewestAtTop(w)},this.isScrollToLatestMessage=function(){return x},this.setScrollToLatestMessage=function(a){x=bool(a),K()&&G().setScrollToLatest(x)},this.getWidth=function(){return i},this.setWidth=function(a){J("width")&&(i=extractStringFromParam(a,i))},this.getHeight=function(){return j},this.setHeight=function(a){J("height")&&(j=extractStringFromParam(a,j))},this.getMaxMessages=function(){return y},this.setMaxMessages=function(a){y=extractIntFromParam(a,y),K()&&G().setMaxMessages(y)},this.isShowCommandLine=function(){return z},this.setShowCommandLine=function(a){z=bool(a),K()&&G().setShowCommandLine(z)},this.isShowHideButton=function(){return B},this.setShowHideButton=function(a){B=bool(a),K()&&G().setShowHideButton(B)},this.isShowCloseButton=function(){return C},this.setShowCloseButton=function(a){C=bool(a),K()&&G().setShowCloseButton(C)},this.getCommandLineObjectExpansionDepth=function(){return A},this.setCommandLineObjectExpansionDepth=function(a){A=extractIntFromParam(a,A)};var L=g;this.isInitiallyMinimized=function(){return g},this.setInitiallyMinimized=function(a){J("initiallyMinimized")&&(g=bool(a),L=g)},this.isUseDocumentWrite=function(){return h},this.setUseDocumentWrite=function(a){J("useDocumentWrite")&&(h=bool(a))},l.prototype.append=function(){G().log(this.levelName,this.formattedMessage)},m.prototype.append=function(){G().group(this.name,this.initiallyExpanded)},n.prototype.append=function(){G().groupEnd()};var M=function(){F(),p?s&&ba&&E():D(),F()&&N()};this.append=function(a){if(u){var b=o.getLayout().formatWithException(a);t.push(new l(a,b)),M()}},this.group=function(a,b){u&&(t.push(new m(a,b)),M())},this.groupEnd=function(){u&&(t.push(new n),M())};var N=function(){for(;t.length>0;)t.shift().append();k&&G().focus()};this.setAddedToLogger=function(a){this.loggers.push(a),enabled&&!f&&D()},this.clear=function(){K()&&G().clearLog(),t.length=0},this.focus=function(){K()&&G().focus()},this.focusCommandLine=function(){K()&&G().focusCommandLine()},this.focusSearch=function(){K()&&G().focusSearch()};var O=window;this.getCommandWindow=function(){return O},this.setCommandWindow=function(a){O=a},this.executeLastCommand=function(){K()&&G().evalLastCommand()};var P=new PatternLayout("%m");this.getCommandLayout=function(){return P},this.setCommandLayout=function(a){P=a},this.evalCommandAndAppend=function(a){var b={appendResult:!0,isError:!1},c="";try{var d,e;!O.eval&&O.execScript&&O.execScript("null");var f={};for(e=0,len=Q.length;e<len;e++)f[Q[e][0]]=Q[e][1];var g=[],h=function(a){g.push([a,O[a]])};h("appender"),O.appender=o,h("commandReturnValue"),O.commandReturnValue=b,h("commandLineFunctionsHash"),O.commandLineFunctionsHash=f;var i=function(a){h(a),O[a]=function(){return this.commandLineFunctionsHash[a](o,arguments,b)}};for(e=0,len=Q.length;e<len;e++)i(Q[e][0]);for(O===window&&O.execScript?(h("evalExpr"),h("result"),window.evalExpr=a,O.execScript("window.result=eval(window.evalExpr);"),d=window.result):d=O.eval(a),c=isUndefined(d)?d:formatObjectExpansion(d,A),e=0,len=g.length;e<len;e++)O[g[e][0]]=g[e][1]}catch(a){c="Error evaluating command: "+getExceptionStringRep(a),b.isError=!0}if(b.appendResult){var j=">>> "+a;isUndefined(c)||(j+=newLine+c);var k=b.isError?Level.ERROR:Level.INFO,l=new LoggingEvent(null,new Date,k,[j],null),m=this.getLayout();this.setLayout(P),this.append(l),this.setLayout(m)}};var Q=d.concat([]);this.addCommandLineFunction=function(a,b){Q.push([a,b])};var R="log4javascriptCommandHistory";this.storeCommandHistory=function(a){setCookie(R,a.join(","))};var S=function(a){var b=c();a.open();for(var d=0,e=b.length;d<e;d++)a.writeln(b[d]);a.close()};this.setEventTypes(["load","unload"]);var T=function(){var a=G();a.setAppender(o),a.setNewestAtTop(w),a.setScrollToLatest(x),a.setMaxMessages(y),a.setShowCommandLine(z),a.setShowHideButton(B),a.setShowCloseButton(C),a.setMainWindow(window);var b=getCookie(R);b&&(a.commandHistory=b.split(","),a.currentCommandIndex=a.commandHistory.length),o.dispatchEvent("load",{win:a})};this.unload=function(){logLog.debug("unload "+this+", caller: "+this.unload.caller),s||(logLog.debug("really doing unload "+this),s=!0,r=!1,q=!1,o.dispatchEvent("unload",{}))};var U=function(a,b,c,d){function e(){try{s&&clearInterval(f),a(G())&&(clearInterval(f),c())}catch(a){clearInterval(f),u=!1,handleError(d,a)}}var f=setInterval(e,b)},V=function(){var a=document.domain!=location.hostname;return h?"":getBaseUrl()+"console.html"+(a?"?log4javascript_domain="+escape(document.domain):"")};if(a){var W=null,X=[];this.addCssProperty=function(a,b){J("cssProperties")&&X.push([a,b])};var Y,Z=!1,$=uniqueId+"_InPageAppender_"+v;this.hide=function(){p&&q&&(K()&&G().$("command").blur(),Y.style.display="none",L=!0)},this.show=function(){p&&(q?(Y.style.display="block",this.setShowCommandLine(z),L=!1):Z||E(!0))},this.isVisible=function(){return!L&&!s},this.close=function(a){s||a&&!confirm("This will permanently remove the console from the page. No more messages will be logged. Do you wish to continue?")||(Y.parentNode.removeChild(Y),this.unload())},H=function(){function a(){try{g||o.show(),T(),r=!0,N()}catch(a){u=!1,handleError(c,a)}}function b(){try{var b=function(a){return isLoaded(a)};h&&S(G().document),b(G())?a():U(b,100,a,c)}catch(a){u=!1,handleError(c,a)}}var c="InPageAppender.open: unable to create console iframe";L=!1,Y=W.appendChild(document.createElement("div")),Y.style.width=i,Y.style.height=j,Y.style.border="solid gray 1px";for(var d=0,e=X.length;d<e;d++)Y.style[X[d][0]]=X[d][1];var f=h?"":" src='"+V()+"'";Y.innerHTML="<iframe id='"+$+"' name='"+$+"' width='100%' height='100%' frameborder='0'"+f+" scrolling='no'></iframe>",s=!1;var k=function(a){try{return bool(a)&&bool(a.document)}catch(a){return!1}};k(G())?b():U(k,100,b,c),q=!0},E=function(a){if(a||!g){var c=function(){if(b)try{var a=document.getElementById(b);1==a.nodeType&&(W=a),H()}catch(a){handleError("InPageAppender.init: invalid container element '"+b+"' supplied",a)}else W=document.createElement("div"),W.style.position="fixed",W.style.left="0",W.style.right="0",W.style.bottom="0",document.body.appendChild(W),o.addCssProperty("borderWidth","1px 0 0 0"),o.addCssProperty("zIndex",1e6),H()};pageLoaded&&b&&b.appendChild?(W=b,H()):pageLoaded?c():log4javascript.addEventListener("load",c),Z=!0}},D=function(){E(),p=!0},G=function(){var a=window.frames[$];if(a)return a},F=function(){return!(!u||s)&&(q&&!r&&G()&&isLoaded(G())&&(r=!0),r)}}else{var _=o.defaults.useOldPopUp,aa=o.defaults.complainAboutPopUpBlocking,ba=this.defaults.reopenWhenClosed;this.isUseOldPopUp=function(){return _},this.setUseOldPopUp=function(a){J("useOldPopUp")&&(_=bool(a))},this.isComplainAboutPopUpBlocking=function(){return aa},this.setComplainAboutPopUpBlocking=function(a){J("complainAboutPopUpBlocking")&&(aa=bool(a))},this.isFocusPopUp=function(){return k},this.setFocusPopUp=function(a){k=bool(a)},this.isReopenWhenClosed=function(){return ba},this.setReopenWhenClosed=function(a){ba=bool(a)},this.close=function(){logLog.debug("close "+this);try{ca.close(),this.unload()}catch(a){}},this.hide=function(){logLog.debug("hide "+this),K()&&this.close()},this.show=function(){logLog.debug("show "+this),q||H()},this.isVisible=function(){return F()};var ca;H=function(){function a(){G().setCloseIfOpenerCloses(!_||!h),T(),r=!0,N(),U(f,500,g,"PopUpAppender.checkPopUpClosed: error checking pop-up window")}var b="width="+i+",height="+j+",status,resizable",c="";try{var d=window.frameElement;d&&(c="_"+d.tagName+"_"+(d.name||d.id||""))}catch(a){c="_inaccessibleParentFrame"}var e="PopUp_"+location.host.replace(/[^a-z0-9]/gi,"_")+"_"+v+c;_&&h||(e=e+"_"+uniqueId);var f=function(a){if(s)return!0;try{return bool(a)&&a.closed}catch(a){}return!1},g=function(){s||o.unload()};try{if(ca=window.open(V(),e,b),s=!1,q=!0,ca&&ca.document)if(h&&_&&isLoaded(ca))ca.mainPageReloaded(),a();else{h&&S(ca.document);var k=function(a){return bool(a)&&isLoaded(a)};isLoaded(ca)?a():U(k,100,a,"PopUpAppender.init: unable to create console window")}else u=!1,logLog.warn("PopUpAppender.init: pop-ups blocked, please unblock to use PopUpAppender"),aa&&handleError("log4javascript: pop-up windows appear to be blocked. Please unblock them to use pop-up logging.")}catch(a){handleError("PopUpAppender.init: error creating pop-up",a)}},E=function(){g||H()},D=function(){E(),p=!0},G=function(){return ca},F=function(){if(u&&!isUndefined(ca)&&!s){if(ca.closed||r&&isUndefined(ca.closed))return o.unload(),logLog.debug("PopUpAppender: pop-up closed"),!1;!r&&isLoaded(ca)&&(r=!0)}return u&&r&&!s}}this.getConsoleWindow=G},ConsoleAppender.addGlobalCommandLineFunction=function(a,b){d.push([a,b])},a.prototype=new ConsoleAppender,a.prototype.defaults={layout:new PatternLayout("%d{HH:mm:ss} %-5p - %m{1}%n"),initiallyMinimized:!1,focusPopUp:!1,lazyInit:!0,useOldPopUp:!0,complainAboutPopUpBlocking:!0,newestMessageAtTop:!1,scrollToLatestMessage:!0,width:"600",height:"400",reopenWhenClosed:!1,maxMessages:null,showCommandLine:!0,commandLineObjectExpansionDepth:1,showHideButton:!1,showCloseButton:!0,useDocumentWrite:!0},a.prototype.toString=function(){return"PopUpAppender"},log4javascript.PopUpAppender=a,b.prototype=new ConsoleAppender,b.prototype.defaults={layout:new PatternLayout("%d{HH:mm:ss} %-5p - %m{1}%n"),initiallyMinimized:!1,lazyInit:!0,newestMessageAtTop:!1,scrollToLatestMessage:!0,width:"100%",height:"220px",maxMessages:null,showCommandLine:!0,commandLineObjectExpansionDepth:1,showHideButton:!1,showCloseButton:!1,showLogEntryDeleteButtons:!0,useDocumentWrite:!0},b.prototype.toString=function(){return"InPageAppender"},log4javascript.InPageAppender=b,log4javascript.InlineAppender=b}(),function(){function a(a){var b=0;for(var c in a)b=Math.max(toStr(c).length,b);var d=[];for(c in a){var e,f="  "+padWithSpaces(toStr(c),b+2);try{e=splitIntoLines(toStr(a[c])).join(padWithSpaces(newLine,b+6))}catch(a){e="[Error obtaining property. Details: "+getExceptionMessage(a)+"]"}d.push(f+e)}return d.join(newLine)}function b(a,c,d,i,j){function k(a){return a.nodeType==e.TEXT_NODE&&/^[ \t\r\n]*$/.test(a.nodeValue)}function l(a){return a.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;")}function m(a){for(var b=a.style.cssText.split(";"),c="",d=0,e=b.length;d<e;d++){var f=b[d].split(":"),g=[];/^\s*$/.test(f[0])||g.push(trim(f[0]).toLowerCase()+":"+trim(f[1])),c=g.join(";")}return c}function n(a){if(a.prefix)return a.prefix;if(a.outerHTML){var b=new RegExp("<([^:]+):"+a.tagName+"[^>]*>","i");if(b.test(a.outerHTML))return RegExp.$1.toLowerCase()}return""}c="undefined"==typeof c||!!c,"string"!=typeof d&&(d=""),i=!!i,j=!!j;var o,p,q,r="<",s=">";if(!c||a.nodeType==e.DOCUMENT_FRAGMENT_NODE){for(o="",p=0,q=a.childNodes.length;p<q;p++)o+=b(a.childNodes[p],!0,d+h);return o}switch(a.nodeType){case e.ELEMENT_NODE:var t=a.tagName.toLowerCase();o=i?newLine+d:"",o+=r;var u=n(a),v=!!u;for(v&&(o+=u+":"),o+=t,p=0,q=a.attributes.length;p<q;p++){var w=a.attributes[p];w.specified&&null!==w.nodeValue&&"style"!==w.nodeName.toLowerCase()&&"string"==typeof w.nodeValue&&0!==w.nodeName.indexOf("_moz")&&(o+=" "+w.nodeName.toLowerCase()+'="',o+=l(w.nodeValue),o+='"')}if(a.style.cssText){var x=m(a);""!==x&&(o+=' style="'+m(a)+'"')}if(array_contains(g,t)||v&&!a.hasChildNodes())o+="/"+s;else{o+=s;var y=!(1===a.childNodes.length&&a.childNodes[0].nodeType===e.TEXT_NODE),z=array_contains(f,t);for(p=0,q=a.childNodes.length;p<q;p++)o+=b(a.childNodes[p],!0,d+h,y,z);var A=r+"/"+t+s;o+=y?newLine+d+A:A}return o;case e.TEXT_NODE:if(k(a))o="";else{if(j)o=a.nodeValue;else{var B=splitIntoLines(trim(a.nodeValue)),C=[];for(p=0,q=B.length;p<q;p++)C[p]=trim(B[p]);o=C.join(newLine+d)}i&&(o=newLine+d+o)}return o;case e.CDATA_SECTION_NODE:return"<![CDATA["+a.nodeValue+"]]>"+newLine;case e.DOCUMENT_NODE:for(o="",p=0,q=a.childNodes.length;p<q;p++)o+=b(a.childNodes[p],!0,d);return o;default:return""}}function c(){ConsoleAppender.addGlobalCommandLineFunction("$",function(a,b,c){return document.getElementById(b[0])}),ConsoleAppender.addGlobalCommandLineFunction("dir",function(b,c,d){for(var e=[],f=0,g=c.length;f<g;f++)e[f]=a(c[f]);return e.join(newLine+newLine)}),ConsoleAppender.addGlobalCommandLineFunction("dirxml",function(a,c,d){for(var e=[],f=0,g=c.length;f<g;f++)e[f]=b(c[f]);return e.join(newLine+newLine)}),ConsoleAppender.addGlobalCommandLineFunction("cd",function(a,b,c){var d,e;return 0===b.length||""===b[0]?(d=window,e="Command line set to run in main window"):b[0].window==b[0]?(d=b[0],e="Command line set to run in frame '"+b[0].name+"'"):(d=window.frames[b[0]],d?e="Command line set to run in frame '"+b[0]+"'":(c.isError=!0,e="Frame '"+b[0]+"' does not exist",d=a.getCommandWindow())),a.setCommandWindow(d),e}),ConsoleAppender.addGlobalCommandLineFunction("clear",function(a,b,c){c.appendResult=!1,a.clear()}),ConsoleAppender.addGlobalCommandLineFunction("keys",function(a,b,c){var d=[];for(var e in b[0])d.push(e);return d}),ConsoleAppender.addGlobalCommandLineFunction("values",function(a,b,c){var d=[];for(var e in b[0])try{d.push(b[0][e])}catch(a){logLog.warn("values(): Unable to obtain value for key "+e+". Details: "+getExceptionMessage(a))}return d}),ConsoleAppender.addGlobalCommandLineFunction("expansionDepth",function(a,b,c){var d=parseInt(b[0],10);return isNaN(d)||d<0?(c.isError=!0,""+b[0]+" is not a valid expansion depth"):(a.setCommandLineObjectExpansionDepth(d),"Object expansion depth set to "+d)})}function d(){c()}var e={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},f=["script","pre"],g=["br","img","hr","param","link","area","input","col","base","meta"],h="  ";d()}(),log4javascript.setDocumentReady=function(){pageLoaded=!0,log4javascript.dispatchEvent("load",{})},window.addEventListener)window.addEventListener("load",log4javascript.setDocumentReady,!1);else if(window.attachEvent)window.attachEvent("onload",log4javascript.setDocumentReady);else{var oldOnload=window.onload;"function"!=typeof window.onload?window.onload=log4javascript.setDocumentReady:window.onload=function(a){oldOnload&&oldOnload(a),log4javascript.setDocumentReady()}}return log4javascript},this),!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.PhotoSwipe=b()}(this,function(){"use strict";var a=function(a,b,c,d){var e={features:null,bind:function(a,b,c,d){var e=(d?"remove":"add")+"EventListener";b=b.split(" ");for(var f=0;f<b.length;f++)b[f]&&a[e](b[f],c,!1)},isArray:function(a){return a instanceof Array},createEl:function(a,b){var c=document.createElement(b||"div");return a&&(c.className=a),c},getScrollY:function(){var a=window.pageYOffset;return void 0!==a?a:document.documentElement.scrollTop},unbind:function(a,b,c){e.bind(a,b,c,!0)},removeClass:function(a,b){var c=new RegExp("(\\s|^)"+b+"(\\s|$)");a.className=a.className.replace(c," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")},addClass:function(a,b){e.hasClass(a,b)||(a.className+=(a.className?" ":"")+b)},hasClass:function(a,b){return a.className&&new RegExp("(^|\\s)"+b+"(\\s|$)").test(a.className)},getChildByClass:function(a,b){for(var c=a.firstChild;c;){if(e.hasClass(c,b))return c;c=c.nextSibling}},arraySearch:function(a,b,c){for(var d=a.length;d--;)if(a[d][c]===b)return d;return-1},extend:function(a,b,c){for(var d in b)if(b.hasOwnProperty(d)){if(c&&a.hasOwnProperty(d))continue;a[d]=b[d]}},easing:{sine:{out:function(a){return Math.sin(a*(Math.PI/2))},inOut:function(a){return-(Math.cos(Math.PI*a)-1)/2}},cubic:{out:function(a){return--a*a*a+1}}},detectFeatures:function(){if(e.features)return e.features;var a=e.createEl(),b=a.style,c="",d={};if(d.oldIE=document.all&&!document.addEventListener,d.touch="ontouchstart"in window,window.requestAnimationFrame&&(d.raf=window.requestAnimationFrame,d.caf=window.cancelAnimationFrame),d.pointerEvent=navigator.pointerEnabled||navigator.msPointerEnabled,!d.pointerEvent){var f=navigator.userAgent;if(/iP(hone|od)/.test(navigator.platform)){var g=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);g&&g.length>0&&(g=parseInt(g[1],10),g>=1&&8>g&&(d.isOldIOSPhone=!0))}var h=f.match(/Android\s([0-9\.]*)/),i=h?h[1]:0;i=parseFloat(i),i>=1&&(4.4>i&&(d.isOldAndroid=!0),d.androidVersion=i),d.isMobileOpera=/opera mini|opera mobi/i.test(f)}for(var j,k,l=["transform","perspective","animationName"],m=["","webkit","Moz","ms","O"],n=0;4>n;n++){c=m[n];for(var o=0;3>o;o++)j=l[o],k=c+(c?j.charAt(0).toUpperCase()+j.slice(1):j),!d[j]&&k in b&&(d[j]=k);c&&!d.raf&&(c=c.toLowerCase(),d.raf=window[c+"RequestAnimationFrame"],d.raf&&(d.caf=window[c+"CancelAnimationFrame"]||window[c+"CancelRequestAnimationFrame"]))}if(!d.raf){var p=0;d.raf=function(a){var b=(new Date).getTime(),c=Math.max(0,16-(b-p)),d=window.setTimeout(function(){a(b+c)},c);return p=b+c,d},d.caf=function(a){clearTimeout(a)}}return d.svg=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,e.features=d,d}};e.detectFeatures(),e.features.oldIE&&(e.bind=function(a,b,c,d){b=b.split(" ");for(var e,f=(d?"detach":"attach")+"Event",g=function(){c.handleEvent.call(c)},h=0;h<b.length;h++)if(e=b[h])if("object"==typeof c&&c.handleEvent){if(d){if(!c["oldIE"+e])return!1}else c["oldIE"+e]=g;a[f]("on"+e,c["oldIE"+e])}else a[f]("on"+e,c)});var f=this,g=25,h=3,i={allowPanToNext:!0,spacing:.12,bgOpacity:1,mouseUsed:!1,loop:!0,pinchToClose:!0,closeOnScroll:!0,closeOnVerticalDrag:!0,verticalDragRange:.75,hideAnimationDuration:333,showAnimationDuration:333,showHideOpacity:!1,focus:!0,escKey:!0,arrowKeys:!0,mainScrollEndFriction:.35,panEndFriction:.35,isClickableElement:function(a){return"A"===a.tagName},getDoubleTapZoom:function(a,b){return a?1:b.initialZoomLevel<.7?1:1.33},maxSpreadZoom:1.33,modal:!0,scaleMode:"fit",alwaysFadeIn:!1};e.extend(i,d);var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la=function(){return{x:0,y:0}},ma=la(),na=la(),oa=la(),pa={},qa=0,ra={},sa=la(),ta=0,ua=!0,va=[],wa={},xa=!1,ya=function(a,b){e.extend(f,b.publicMethods),va.push(a)},za=function(a){var b=_b();return a>b-1?a-b:0>a?b+a:a},Aa={},Ba=function(a,b){return Aa[a]||(Aa[a]=[]),Aa[a].push(b)},Ca=function(a){var b=Aa[a];if(b){var c=Array.prototype.slice.call(arguments);c.shift();for(var d=0;d<b.length;d++)b[d].apply(f,c)}},Da=function(){return(new Date).getTime()},Ea=function(a){ia=a,f.bg.style.opacity=a*i.bgOpacity},Fa=function(a,b,c,d,e){(!xa||e&&e!==f.currItem)&&(d/=e?e.fitRatio:f.currItem.fitRatio),a[E]=u+b+"px, "+c+"px"+v+" scale("+d+")"},Ga=function(a){da&&(a&&(s>f.currItem.fitRatio?xa||(lc(f.currItem,!1,!0),xa=!0):xa&&(lc(f.currItem),xa=!1)),Fa(da,oa.x,oa.y,s))},Ha=function(a){a.container&&Fa(a.container.style,a.initialPosition.x,a.initialPosition.y,a.initialZoomLevel,a)},Ia=function(a,b){b[E]=u+a+"px, 0px"+v},Ja=function(a,b){if(!i.loop&&b){var c=m+(sa.x*qa-a)/sa.x,d=Math.round(a-sb.x);(0>c&&d>0||c>=_b()-1&&0>d)&&(a=sb.x+d*i.mainScrollEndFriction)}sb.x=a,Ia(a,n)},Ka=function(a,b){var c=tb[a]-ra[a];return na[a]+ma[a]+c-c*(b/t)},La=function(a,b){a.x=b.x,a.y=b.y,b.id&&(a.id=b.id)},Ma=function(a){a.x=Math.round(a.x),a.y=Math.round(a.y)},Na=null,Oa=function(){Na&&(e.unbind(document,"mousemove",Oa),e.addClass(a,"pswp--has_mouse"),i.mouseUsed=!0,Ca("mouseUsed")),Na=setTimeout(function(){Na=null},100)},Pa=function(){e.bind(document,"keydown",f),N.transform&&e.bind(f.scrollWrap,"click",f),i.mouseUsed||e.bind(document,"mousemove",Oa),e.bind(window,"resize scroll",f),Ca("bindEvents")},Qa=function(){e.unbind(window,"resize",f),e.unbind(window,"scroll",r.scroll),e.unbind(document,"keydown",f),e.unbind(document,"mousemove",Oa),N.transform&&e.unbind(f.scrollWrap,"click",f),U&&e.unbind(window,p,f),Ca("unbindEvents")},Ra=function(a,b){var c=hc(f.currItem,pa,a);return b&&(ca=c),c},Sa=function(a){return a||(a=f.currItem),a.initialZoomLevel},Ta=function(a){return a||(a=f.currItem),a.w>0?i.maxSpreadZoom:1},Ua=function(a,b,c,d){return d===f.currItem.initialZoomLevel?(c[a]=f.currItem.initialPosition[a],!0):(c[a]=Ka(a,d),c[a]>b.min[a]?(c[a]=b.min[a],!0):c[a]<b.max[a]&&(c[a]=b.max[a],!0))},Va=function(){if(E){var b=N.perspective&&!G;return u="translate"+(b?"3d(":"("),void(v=N.perspective?", 0px)":")")}E="left",e.addClass(a,"pswp--ie"),Ia=function(a,b){b.left=a+"px"},Ha=function(a){var b=a.fitRatio>1?1:a.fitRatio,c=a.container.style,d=b*a.w,e=b*a.h;c.width=d+"px",c.height=e+"px",c.left=a.initialPosition.x+"px",c.top=a.initialPosition.y+"px"},Ga=function(){if(da){var a=da,b=f.currItem,c=b.fitRatio>1?1:b.fitRatio,d=c*b.w,e=c*b.h;a.width=d+"px",a.height=e+"px",a.left=oa.x+"px",a.top=oa.y+"px"}}},Wa=function(a){var b="";i.escKey&&27===a.keyCode?b="close":i.arrowKeys&&(37===a.keyCode?b="prev":39===a.keyCode&&(b="next")),b&&(a.ctrlKey||a.altKey||a.shiftKey||a.metaKey||(a.preventDefault?a.preventDefault():a.returnValue=!1,f[b]()))},Xa=function(a){a&&(X||W||ea||S)&&(a.preventDefault(),a.stopPropagation())},Ya=function(){f.setScrollOffset(0,e.getScrollY())},Za={},$a=0,_a=function(a){Za[a]&&(Za[a].raf&&I(Za[a].raf),$a--,delete Za[a])},ab=function(a){Za[a]&&_a(a),Za[a]||($a++,Za[a]={})},bb=function(){for(var a in Za)Za.hasOwnProperty(a)&&_a(a)},cb=function(a,b,c,d,e,f,g){var h,i=Da();ab(a);var j=function(){if(Za[a]){if(h=Da()-i,h>=d)return _a(a),f(c),void(g&&g());f((c-b)*e(h/d)+b),Za[a].raf=H(j)}};j()},db={shout:Ca,listen:Ba,viewportSize:pa,options:i,isMainScrollAnimating:function(){return ea},getZoomLevel:function(){return s},getCurrentIndex:function(){return m},isDragging:function(){return U},isZooming:function(){return _},setScrollOffset:function(a,b){ra.x=a,M=ra.y=b,Ca("updateScrollOffset",ra)},applyZoomPan:function(a,b,c,d){oa.x=b,oa.y=c,s=a,Ga(d)},init:function(){if(!j&&!k){var c;f.framework=e,f.template=a,f.bg=e.getChildByClass(a,"pswp__bg"),J=a.className,j=!0,N=e.detectFeatures(),H=N.raf,I=N.caf,E=N.transform,L=N.oldIE,f.scrollWrap=e.getChildByClass(a,"pswp__scroll-wrap"),f.container=e.getChildByClass(f.scrollWrap,"pswp__container"),n=f.container.style,f.itemHolders=y=[{el:f.container.children[0],wrap:0,index:-1},{el:f.container.children[1],wrap:0,index:-1},{el:f.container.children[2],wrap:0,index:-1}],y[0].el.style.display=y[2].el.style.display="none",Va(),r={resize:f.updateSize,scroll:Ya,keydown:Wa,click:Xa};var d=N.isOldIOSPhone||N.isOldAndroid||N.isMobileOpera;for(N.animationName&&N.transform&&!d||(i.showAnimationDuration=i.hideAnimationDuration=0),c=0;c<va.length;c++)f["init"+va[c]]();if(b){var g=f.ui=new b(f,e);g.init()}Ca("firstUpdate"),m=m||i.index||0,(isNaN(m)||0>m||m>=_b())&&(m=0),f.currItem=$b(m),(N.isOldIOSPhone||N.isOldAndroid)&&(ua=!1),a.setAttribute("aria-hidden","false"),i.modal&&(ua?a.style.position="fixed":(a.style.position="absolute",a.style.top=e.getScrollY()+"px")),void 0===M&&(Ca("initialLayout"),M=K=e.getScrollY());var l="pswp--open ";for(i.mainClass&&(l+=i.mainClass+" "),i.showHideOpacity&&(l+="pswp--animate_opacity "),l+=G?"pswp--touch":"pswp--notouch",l+=N.animationName?" pswp--css_animation":"",l+=N.svg?" pswp--svg":"",e.addClass(a,l),f.updateSize(),o=-1,ta=null,c=0;h>c;c++)Ia((c+o)*sa.x,y[c].el.style);L||e.bind(f.scrollWrap,q,f),Ba("initialZoomInEnd",function(){f.setContent(y[0],m-1),f.setContent(y[2],m+1),y[0].el.style.display=y[2].el.style.display="block",i.focus&&a.focus(),Pa()}),f.setContent(y[1],m),f.updateCurrItem(),Ca("afterInit"),ua||(w=setInterval(function(){$a||U||_||s!==f.currItem.initialZoomLevel||f.updateSize()},1e3)),e.addClass(a,"pswp--visible")}},close:function(){j&&(j=!1,k=!0,Ca("close"),Qa(),bc(f.currItem,null,!0,f.destroy))},destroy:function(){Ca("destroy"),Wb&&clearTimeout(Wb),a.setAttribute("aria-hidden","true"),a.className=J,w&&clearInterval(w),e.unbind(f.scrollWrap,q,f),e.unbind(window,"scroll",f),yb(),bb(),Aa=null},panTo:function(a,b,c){c||(a>ca.min.x?a=ca.min.x:a<ca.max.x&&(a=ca.max.x),b>ca.min.y?b=ca.min.y:b<ca.max.y&&(b=ca.max.y)),oa.x=a,oa.y=b,Ga()},handleEvent:function(a){a=a||window.event,r[a.type]&&r[a.type](a)},goTo:function(a){a=za(a);var b=a-m;ta=b,m=a,f.currItem=$b(m),qa-=b,Ja(sa.x*qa),bb(),ea=!1,f.updateCurrItem()},next:function(){f.goTo(m+1)},prev:function(){f.goTo(m-1)},updateCurrZoomItem:function(a){if(a&&Ca("beforeChange",0),y[1].el.children.length){var b=y[1].el.children[0];da=e.hasClass(b,"pswp__zoom-wrap")?b.style:null}else da=null;ca=f.currItem.bounds,t=s=f.currItem.initialZoomLevel,oa.x=ca.center.x,oa.y=ca.center.y,a&&Ca("afterChange")},invalidateCurrItems:function(){x=!0;for(var a=0;h>a;a++)y[a].item&&(y[a].item.needsUpdate=!0)},updateCurrItem:function(a){if(0!==ta){var b,c=Math.abs(ta);if(!(a&&2>c)){f.currItem=$b(m),xa=!1,Ca("beforeChange",ta),c>=h&&(o+=ta+(ta>0?-h:h),c=h);for(var d=0;c>d;d++)ta>0?(b=y.shift(),y[h-1]=b,o++,Ia((o+2)*sa.x,b.el.style),f.setContent(b,m-c+d+1+1)):(b=y.pop(),y.unshift(b),o--,Ia(o*sa.x,b.el.style),f.setContent(b,m+c-d-1-1));if(da&&1===Math.abs(ta)){var e=$b(z);e.initialZoomLevel!==s&&(hc(e,pa),lc(e),Ha(e))}ta=0,f.updateCurrZoomItem(),z=m,Ca("afterChange")}}},updateSize:function(b){if(!ua&&i.modal){var c=e.getScrollY();if(M!==c&&(a.style.top=c+"px",M=c),!b&&wa.x===window.innerWidth&&wa.y===window.innerHeight)return;wa.x=window.innerWidth,wa.y=window.innerHeight,a.style.height=wa.y+"px"}if(pa.x=f.scrollWrap.clientWidth,pa.y=f.scrollWrap.clientHeight,Ya(),sa.x=pa.x+Math.round(pa.x*i.spacing),sa.y=pa.y,Ja(sa.x*qa),Ca("beforeResize"),void 0!==o){for(var d,g,j,k=0;h>k;k++)d=y[k],Ia((k+o)*sa.x,d.el.style),j=m+k-1,i.loop&&_b()>2&&(j=za(j)),g=$b(j),g&&(x||g.needsUpdate||!g.bounds)?(f.cleanSlide(g),f.setContent(d,j),1===k&&(f.currItem=g,f.updateCurrZoomItem(!0)),g.needsUpdate=!1):-1===d.index&&j>=0&&f.setContent(d,j),g&&g.container&&(hc(g,pa),lc(g),Ha(g));x=!1}t=s=f.currItem.initialZoomLevel,ca=f.currItem.bounds,ca&&(oa.x=ca.center.x,oa.y=ca.center.y,Ga(!0)),Ca("resize")},zoomTo:function(a,b,c,d,f){b&&(t=s,tb.x=Math.abs(b.x)-oa.x,tb.y=Math.abs(b.y)-oa.y,La(na,oa));var g=Ra(a,!1),h={};Ua("x",g,h,a),Ua("y",g,h,a);var i=s,j={x:oa.x,y:oa.y};Ma(h);var k=function(b){1===b?(s=a,oa.x=h.x,oa.y=h.y):(s=(a-i)*b+i,oa.x=(h.x-j.x)*b+j.x,oa.y=(h.y-j.y)*b+j.y),f&&f(b),Ga(1===b)};c?cb("customZoomTo",0,1,c,d||e.easing.sine.inOut,k):k(1)}},eb=30,fb=10,gb={},hb={},ib={},jb={},kb={},lb=[],mb={},nb=[],ob={},pb=0,qb=la(),rb=0,sb=la(),tb=la(),ub=la(),vb=function(a,b){return a.x===b.x&&a.y===b.y},wb=function(a,b){return Math.abs(a.x-b.x)<g&&Math.abs(a.y-b.y)<g},xb=function(a,b){return ob.x=Math.abs(a.x-b.x),ob.y=Math.abs(a.y-b.y),Math.sqrt(ob.x*ob.x+ob.y*ob.y)},yb=function(){Y&&(I(Y),Y=null)},zb=function(){U&&(Y=H(zb),Pb())},Ab=function(){return!("fit"===i.scaleMode&&s===f.currItem.initialZoomLevel)},Bb=function(a,b){return!!a&&(!(a.className&&a.className.indexOf("pswp__scroll-wrap")>-1)&&(b(a)?a:Bb(a.parentNode,b)))},Cb={},Db=function(a,b){return Cb.prevent=!Bb(a.target,i.isClickableElement),Ca("preventDragEvent",a,b,Cb),Cb.prevent},Eb=function(a,b){return b.x=a.pageX,b.y=a.pageY,b.id=a.identifier,b},Fb=function(a,b,c){c.x=.5*(a.x+b.x),c.y=.5*(a.y+b.y)},Gb=function(a,b,c){if(a-P>50){var d=nb.length>2?nb.shift():{};d.x=b,d.y=c,nb.push(d),P=a}},Hb=function(){var a=oa.y-f.currItem.initialPosition.y;return 1-Math.abs(a/(pa.y/2))},Ib={},Jb={},Kb=[],Lb=function(a){for(;Kb.length>0;)Kb.pop();return F?(ka=0,lb.forEach(function(a){0===ka?Kb[0]=a:1===ka&&(Kb[1]=a),ka++})):a.type.indexOf("touch")>-1?a.touches&&a.touches.length>0&&(Kb[0]=Eb(a.touches[0],Ib),a.touches.length>1&&(Kb[1]=Eb(a.touches[1],Jb))):(Ib.x=a.pageX,Ib.y=a.pageY,Ib.id="",Kb[0]=Ib),Kb},Mb=function(a,b){var c,d,e,g,h=0,j=oa[a]+b[a],k=b[a]>0,l=sb.x+b.x,m=sb.x-mb.x;return c=j>ca.min[a]||j<ca.max[a]?i.panEndFriction:1,j=oa[a]+b[a]*c,!i.allowPanToNext&&s!==f.currItem.initialZoomLevel||(da?"h"!==fa||"x"!==a||W||(k?(j>ca.min[a]&&(c=i.panEndFriction,h=ca.min[a]-j,d=ca.min[a]-na[a]),(0>=d||0>m)&&_b()>1?(g=l,0>m&&l>mb.x&&(g=mb.x)):ca.min.x!==ca.max.x&&(e=j)):(j<ca.max[a]&&(c=i.panEndFriction,h=j-ca.max[a],d=na[a]-ca.max[a]),(0>=d||m>0)&&_b()>1?(g=l,m>0&&l<mb.x&&(g=mb.x)):ca.min.x!==ca.max.x&&(e=j))):g=l,"x"!==a)?void(ea||Z||s>f.currItem.fitRatio&&(oa[a]+=b[a]*c)):(void 0!==g&&(Ja(g,!0),Z=g!==mb.x),ca.min.x!==ca.max.x&&(void 0!==e?oa.x=e:Z||(oa.x+=b.x*c)),void 0!==g)},Nb=function(a){if(!("mousedown"===a.type&&a.button>0)){if(Zb)return void a.preventDefault();if(!T||"mousedown"!==a.type){if(Db(a,!0)&&a.preventDefault(),Ca("pointerDown"),F){var b=e.arraySearch(lb,a.pointerId,"id");0>b&&(b=lb.length),lb[b]={x:a.pageX,y:a.pageY,id:a.pointerId}}var c=Lb(a),d=c.length;$=null,bb(),U&&1!==d||(U=ga=!0,e.bind(window,p,f),R=ja=ha=S=Z=X=V=W=!1,fa=null,Ca("firstTouchStart",c),La(na,oa),ma.x=ma.y=0,La(jb,c[0]),La(kb,jb),mb.x=sa.x*qa,nb=[{x:jb.x,y:jb.y}],P=O=Da(),Ra(s,!0),yb(),zb()),!_&&d>1&&!ea&&!Z&&(t=s,W=!1,_=V=!0,ma.y=ma.x=0,La(na,oa),La(gb,c[0]),La(hb,c[1]),Fb(gb,hb,ub),tb.x=Math.abs(ub.x)-oa.x,tb.y=Math.abs(ub.y)-oa.y,aa=ba=xb(gb,hb))}}},Ob=function(a){if(a.preventDefault(),F){var b=e.arraySearch(lb,a.pointerId,"id");if(b>-1){var c=lb[b];c.x=a.pageX,c.y=a.pageY}}if(U){var d=Lb(a);if(fa||X||_)$=d;else if(sb.x!==sa.x*qa)fa="h";else{var f=Math.abs(d[0].x-jb.x)-Math.abs(d[0].y-jb.y);Math.abs(f)>=fb&&(fa=f>0?"h":"v",$=d)}}},Pb=function(){if($){var a=$.length;if(0!==a)if(La(gb,$[0]),ib.x=gb.x-jb.x,ib.y=gb.y-jb.y,_&&a>1){if(jb.x=gb.x,jb.y=gb.y,!ib.x&&!ib.y&&vb($[1],hb))return;La(hb,$[1]),W||(W=!0,Ca("zoomGestureStarted"));var b=xb(gb,hb),c=Ub(b);c>f.currItem.initialZoomLevel+f.currItem.initialZoomLevel/15&&(ja=!0);var d=1,e=Sa(),g=Ta();if(e>c)if(i.pinchToClose&&!ja&&t<=f.currItem.initialZoomLevel){var h=e-c,j=1-h/(e/1.2);Ea(j),Ca("onPinchClose",j),ha=!0}else d=(e-c)/e,d>1&&(d=1),c=e-d*(e/3);else c>g&&(d=(c-g)/(6*e),d>1&&(d=1),c=g+d*e);0>d&&(d=0),aa=b,Fb(gb,hb,qb),ma.x+=qb.x-ub.x,ma.y+=qb.y-ub.y,La(ub,qb),oa.x=Ka("x",c),oa.y=Ka("y",c),R=c>s,s=c,Ga()}else{if(!fa)return;if(ga&&(ga=!1,Math.abs(ib.x)>=fb&&(ib.x-=$[0].x-kb.x),Math.abs(ib.y)>=fb&&(ib.y-=$[0].y-kb.y)),jb.x=gb.x,jb.y=gb.y,0===ib.x&&0===ib.y)return;if("v"===fa&&i.closeOnVerticalDrag&&!Ab()){ma.y+=ib.y,oa.y+=ib.y;var k=Hb();return S=!0,Ca("onVerticalDrag",k),Ea(k),void Ga()}Gb(Da(),gb.x,gb.y),X=!0,ca=f.currItem.bounds;var l=Mb("x",ib);l||(Mb("y",ib),Ma(oa),Ga())}}},Qb=function(a){if(N.isOldAndroid){if(T&&"mouseup"===a.type)return;a.type.indexOf("touch")>-1&&(clearTimeout(T),T=setTimeout(function(){T=0},600))}Ca("pointerUp"),Db(a,!1)&&a.preventDefault();var b;if(F){var c=e.arraySearch(lb,a.pointerId,"id");if(c>-1)if(b=lb.splice(c,1)[0],navigator.pointerEnabled)b.type=a.pointerType||"mouse";else{var d={4:"mouse",2:"touch",3:"pen"};b.type=d[a.pointerType],b.type||(b.type=a.pointerType||"mouse")}}var g,h=Lb(a),j=h.length;if("mouseup"===a.type&&(j=0),2===j)return $=null,!0;1===j&&La(kb,h[0]),0!==j||fa||ea||(b||("mouseup"===a.type?b={
x:a.pageX,y:a.pageY,type:"mouse"}:a.changedTouches&&a.changedTouches[0]&&(b={x:a.changedTouches[0].pageX,y:a.changedTouches[0].pageY,type:"touch"})),Ca("touchRelease",a,b));var k=-1;if(0===j&&(U=!1,e.unbind(window,p,f),yb(),_?k=0:-1!==rb&&(k=Da()-rb)),rb=1===j?Da():-1,g=-1!==k&&150>k?"zoom":"swipe",_&&2>j&&(_=!1,1===j&&(g="zoomPointerUp"),Ca("zoomGestureEnded")),$=null,X||W||ea||S)if(bb(),Q||(Q=Rb()),Q.calculateSwipeSpeed("x"),S){var l=Hb();if(l<i.verticalDragRange)f.close();else{var m=oa.y,n=ia;cb("verticalDrag",0,1,300,e.easing.cubic.out,function(a){oa.y=(f.currItem.initialPosition.y-m)*a+m,Ea((1-n)*a+n),Ga()}),Ca("onVerticalDrag",1)}}else{if((Z||ea)&&0===j){var o=Tb(g,Q);if(o)return;g="zoomPointerUp"}if(!ea)return"swipe"!==g?void Vb():void(!Z&&s>f.currItem.fitRatio&&Sb(Q))}},Rb=function(){var a,b,c={lastFlickOffset:{},lastFlickDist:{},lastFlickSpeed:{},slowDownRatio:{},slowDownRatioReverse:{},speedDecelerationRatio:{},speedDecelerationRatioAbs:{},distanceOffset:{},backAnimDestination:{},backAnimStarted:{},calculateSwipeSpeed:function(d){nb.length>1?(a=Da()-P+50,b=nb[nb.length-2][d]):(a=Da()-O,b=kb[d]),c.lastFlickOffset[d]=jb[d]-b,c.lastFlickDist[d]=Math.abs(c.lastFlickOffset[d]),c.lastFlickDist[d]>20?c.lastFlickSpeed[d]=c.lastFlickOffset[d]/a:c.lastFlickSpeed[d]=0,Math.abs(c.lastFlickSpeed[d])<.1&&(c.lastFlickSpeed[d]=0),c.slowDownRatio[d]=.95,c.slowDownRatioReverse[d]=1-c.slowDownRatio[d],c.speedDecelerationRatio[d]=1},calculateOverBoundsAnimOffset:function(a,b){c.backAnimStarted[a]||(oa[a]>ca.min[a]?c.backAnimDestination[a]=ca.min[a]:oa[a]<ca.max[a]&&(c.backAnimDestination[a]=ca.max[a]),void 0!==c.backAnimDestination[a]&&(c.slowDownRatio[a]=.7,c.slowDownRatioReverse[a]=1-c.slowDownRatio[a],c.speedDecelerationRatioAbs[a]<.05&&(c.lastFlickSpeed[a]=0,c.backAnimStarted[a]=!0,cb("bounceZoomPan"+a,oa[a],c.backAnimDestination[a],b||300,e.easing.sine.out,function(b){oa[a]=b,Ga()}))))},calculateAnimOffset:function(a){c.backAnimStarted[a]||(c.speedDecelerationRatio[a]=c.speedDecelerationRatio[a]*(c.slowDownRatio[a]+c.slowDownRatioReverse[a]-c.slowDownRatioReverse[a]*c.timeDiff/10),c.speedDecelerationRatioAbs[a]=Math.abs(c.lastFlickSpeed[a]*c.speedDecelerationRatio[a]),c.distanceOffset[a]=c.lastFlickSpeed[a]*c.speedDecelerationRatio[a]*c.timeDiff,oa[a]+=c.distanceOffset[a])},panAnimLoop:function(){return Za.zoomPan&&(Za.zoomPan.raf=H(c.panAnimLoop),c.now=Da(),c.timeDiff=c.now-c.lastNow,c.lastNow=c.now,c.calculateAnimOffset("x"),c.calculateAnimOffset("y"),Ga(),c.calculateOverBoundsAnimOffset("x"),c.calculateOverBoundsAnimOffset("y"),c.speedDecelerationRatioAbs.x<.05&&c.speedDecelerationRatioAbs.y<.05)?(oa.x=Math.round(oa.x),oa.y=Math.round(oa.y),Ga(),void _a("zoomPan")):void 0}};return c},Sb=function(a){return a.calculateSwipeSpeed("y"),ca=f.currItem.bounds,a.backAnimDestination={},a.backAnimStarted={},Math.abs(a.lastFlickSpeed.x)<=.05&&Math.abs(a.lastFlickSpeed.y)<=.05?(a.speedDecelerationRatioAbs.x=a.speedDecelerationRatioAbs.y=0,a.calculateOverBoundsAnimOffset("x"),a.calculateOverBoundsAnimOffset("y"),!0):(ab("zoomPan"),a.lastNow=Da(),void a.panAnimLoop())},Tb=function(a,b){var c;ea||(pb=m);var d;if("swipe"===a){var g=jb.x-kb.x,h=b.lastFlickDist.x<10;g>eb&&(h||b.lastFlickOffset.x>20)?d=-1:-eb>g&&(h||b.lastFlickOffset.x<-20)&&(d=1)}var j;d&&(m+=d,0>m?(m=i.loop?_b()-1:0,j=!0):m>=_b()&&(m=i.loop?0:_b()-1,j=!0),(!j||i.loop)&&(ta+=d,qa-=d,c=!0));var k,l=sa.x*qa,n=Math.abs(l-sb.x);return c||l>sb.x==b.lastFlickSpeed.x>0?(k=Math.abs(b.lastFlickSpeed.x)>0?n/Math.abs(b.lastFlickSpeed.x):333,k=Math.min(k,400),k=Math.max(k,250)):k=333,pb===m&&(c=!1),ea=!0,Ca("mainScrollAnimStart"),cb("mainScroll",sb.x,l,k,e.easing.cubic.out,Ja,function(){bb(),ea=!1,pb=-1,(c||pb!==m)&&f.updateCurrItem(),Ca("mainScrollAnimComplete")}),c&&f.updateCurrItem(!0),c},Ub=function(a){return 1/ba*a*t},Vb=function(){var a=s,b=Sa(),c=Ta();b>s?a=b:s>c&&(a=c);var d,g=1,h=ia;return ha&&!R&&!ja&&b>s?(f.close(),!0):(ha&&(d=function(a){Ea((g-h)*a+h)}),f.zoomTo(a,0,200,e.easing.cubic.out,d),!0)};ya("Gestures",{publicMethods:{initGestures:function(){var a=function(a,b,c,d,e){A=a+b,B=a+c,C=a+d,D=e?a+e:""};F=N.pointerEvent,F&&N.touch&&(N.touch=!1),F?navigator.pointerEnabled?a("pointer","down","move","up","cancel"):a("MSPointer","Down","Move","Up","Cancel"):N.touch?(a("touch","start","move","end","cancel"),G=!0):a("mouse","down","move","up"),p=B+" "+C+" "+D,q=A,F&&!G&&(G=navigator.maxTouchPoints>1||navigator.msMaxTouchPoints>1),f.likelyTouchDevice=G,r[A]=Nb,r[B]=Ob,r[C]=Qb,D&&(r[D]=r[C]),N.touch&&(q+=" mousedown",p+=" mousemove mouseup",r.mousedown=r[A],r.mousemove=r[B],r.mouseup=r[C]),G||(i.allowPanToNext=!1)}}});var Wb,Xb,Yb,Zb,$b,_b,ac,bc=function(b,c,d,g){Wb&&clearTimeout(Wb),Zb=!0,Yb=!0;var h;b.initialLayout?(h=b.initialLayout,b.initialLayout=null):h=i.getThumbBoundsFn&&i.getThumbBoundsFn(m);var j=d?i.hideAnimationDuration:i.showAnimationDuration,k=function(){_a("initialZoom"),d?(f.template.removeAttribute("style"),f.bg.removeAttribute("style")):(Ea(1),c&&(c.style.display="block"),e.addClass(a,"pswp--animated-in"),Ca("initialZoom"+(d?"OutEnd":"InEnd"))),g&&g(),Zb=!1};if(!j||!h||void 0===h.x){var n=function(){Ca("initialZoom"+(d?"Out":"In")),s=b.initialZoomLevel,La(oa,b.initialPosition),Ga(),a.style.opacity=d?0:1,Ea(1),k()};return void n()}var o=function(){var c=l,g=!f.currItem.src||f.currItem.loadError||i.showHideOpacity;b.miniImg&&(b.miniImg.style.webkitBackfaceVisibility="hidden"),d||(s=h.w/b.w,oa.x=h.x,oa.y=h.y-K,f[g?"template":"bg"].style.opacity=.001,Ga()),ab("initialZoom"),d&&!c&&e.removeClass(a,"pswp--animated-in"),g&&(d?e[(c?"remove":"add")+"Class"](a,"pswp--animate_opacity"):setTimeout(function(){e.addClass(a,"pswp--animate_opacity")},30)),Wb=setTimeout(function(){if(Ca("initialZoom"+(d?"Out":"In")),d){var f=h.w/b.w,i={x:oa.x,y:oa.y},l=s,m=ia,n=function(b){1===b?(s=f,oa.x=h.x,oa.y=h.y-M):(s=(f-l)*b+l,oa.x=(h.x-i.x)*b+i.x,oa.y=(h.y-M-i.y)*b+i.y),Ga(),g?a.style.opacity=1-b:Ea(m-b*m)};c?cb("initialZoom",0,1,j,e.easing.cubic.out,n,k):(n(1),Wb=setTimeout(k,j+20))}else s=b.initialZoomLevel,La(oa,b.initialPosition),Ga(),Ea(1),g?a.style.opacity=1:Ea(1),Wb=setTimeout(k,j+20)},d?25:90)};o()},cc={},dc=[],ec={index:0,errorMsg:'<div class="pswp__error-msg"><a href="%url%" target="_blank">The image</a> could not be loaded.</div>',forceProgressiveLoading:!1,preload:[1,1],getNumItemsFn:function(){return Xb.length}},fc=function(){return{center:{x:0,y:0},max:{x:0,y:0},min:{x:0,y:0}}},gc=function(a,b,c){var d=a.bounds;d.center.x=Math.round((cc.x-b)/2),d.center.y=Math.round((cc.y-c)/2)+a.vGap.top,d.max.x=b>cc.x?Math.round(cc.x-b):d.center.x,d.max.y=c>cc.y?Math.round(cc.y-c)+a.vGap.top:d.center.y,d.min.x=b>cc.x?0:d.center.x,d.min.y=c>cc.y?a.vGap.top:d.center.y},hc=function(a,b,c){if(a.src&&!a.loadError){var d=!c;if(d&&(a.vGap||(a.vGap={top:0,bottom:0}),Ca("parseVerticalMargin",a)),cc.x=b.x,cc.y=b.y-a.vGap.top-a.vGap.bottom,d){var e=cc.x/a.w,f=cc.y/a.h;a.fitRatio=f>e?e:f;var g=i.scaleMode;"orig"===g?c=1:"fit"===g&&(c=a.fitRatio),c>1&&(c=1),a.initialZoomLevel=c,a.bounds||(a.bounds=fc())}if(!c)return;return gc(a,a.w*c,a.h*c),d&&c===a.initialZoomLevel&&(a.initialPosition=a.bounds.center),a.bounds}return a.w=a.h=0,a.initialZoomLevel=a.fitRatio=1,a.bounds=fc(),a.initialPosition=a.bounds.center,a.bounds},ic=function(a,b,c,d,e,f){b.loadError||d&&(b.imageAppended=!0,lc(b,d),c.appendChild(d),f&&setTimeout(function(){b&&b.loaded&&b.placeholder&&(b.placeholder.style.display="none",b.placeholder=null)},500))},jc=function(a){a.loading=!0,a.loaded=!1;var b=a.img=e.createEl("pswp__img","img"),c=function(){a.loading=!1,a.loaded=!0,a.loadComplete?a.loadComplete(a):a.img=null,b.onload=b.onerror=null,b=null};return b.onload=c,b.onerror=function(){a.loadError=!0,c()},b.src=a.src,b},kc=function(a,b){return a.src&&a.loadError&&a.container?(b&&(a.container.innerHTML=""),a.container.innerHTML=i.errorMsg.replace("%url%",a.src),!0):void 0},lc=function(a,b,c){if(a.src){b||(b=a.container.lastChild);var d=c?a.w:Math.round(a.w*a.fitRatio),e=c?a.h:Math.round(a.h*a.fitRatio);a.placeholder&&!a.loaded&&(a.placeholder.style.width=d+"px",a.placeholder.style.height=e+"px"),b.style.width=d+"px",b.style.height=e+"px"}},mc=function(){if(dc.length){for(var a,b=0;b<dc.length;b++)a=dc[b],a.holder.index===a.index&&ic(a.index,a.item,a.baseDiv,a.img,!1,a.clearPlaceholder);dc=[]}};ya("Controller",{publicMethods:{lazyLoadItem:function(a){a=za(a);var b=$b(a);!b||b.loaded||b.loading||(Ca("gettingData",a,b),b.src&&jc(b))},initController:function(){e.extend(i,ec,!0),f.items=Xb=c,$b=f.getItemAt,_b=i.getNumItemsFn,ac=i.loop,_b()<3&&(i.loop=!1),Ba("beforeChange",function(a){var b,c=i.preload,d=null===a||a>0,e=Math.min(c[0],_b()),g=Math.min(c[1],_b());for(b=1;(d?g:e)>=b;b++)f.lazyLoadItem(m+b);for(b=1;(d?e:g)>=b;b++)f.lazyLoadItem(m-b)}),Ba("initialLayout",function(){f.currItem.initialLayout=i.getThumbBoundsFn&&i.getThumbBoundsFn(m)}),Ba("mainScrollAnimComplete",mc),Ba("initialZoomInEnd",mc),Ba("destroy",function(){for(var a,b=0;b<Xb.length;b++)a=Xb[b],a.container&&(a.container=null),a.placeholder&&(a.placeholder=null),a.img&&(a.img=null),a.preloader&&(a.preloader=null),a.loadError&&(a.loaded=a.loadError=!1);dc=null})},getItemAt:function(a){return a>=0&&void 0!==Xb[a]&&Xb[a]},allowProgressiveImg:function(){return i.forceProgressiveLoading||!G||i.mouseUsed||screen.width>1200},setContent:function(a,b){i.loop&&(b=za(b));var c=f.getItemAt(a.index);c&&(c.container=null);var d,g=f.getItemAt(b);if(!g)return void(a.el.innerHTML="");Ca("gettingData",b,g),a.index=b,a.item=g;var h=g.container=e.createEl("pswp__zoom-wrap");if(!g.src&&g.html&&(g.html.tagName?h.appendChild(g.html):h.innerHTML=g.html),kc(g),hc(g,pa),!g.src||g.loadError||g.loaded)g.src&&!g.loadError&&(d=e.createEl("pswp__img","img"),d.style.opacity=1,d.src=g.src,lc(g,d),ic(b,g,h,d,!0));else{if(g.loadComplete=function(c){if(j){if(a&&a.index===b){if(kc(c,!0))return c.loadComplete=c.img=null,hc(c,pa),Ha(c),void(a.index===m&&f.updateCurrZoomItem());c.imageAppended?!Zb&&c.placeholder&&(c.placeholder.style.display="none",c.placeholder=null):N.transform&&(ea||Zb)?dc.push({item:c,baseDiv:h,img:c.img,index:b,holder:a,clearPlaceholder:!0}):ic(b,c,h,c.img,ea||Zb,!0)}c.loadComplete=null,c.img=null,Ca("imageLoadComplete",b,c)}},e.features.transform){var k="pswp__img pswp__img--placeholder";k+=g.msrc?"":" pswp__img--placeholder--blank";var l=e.createEl(k,g.msrc?"img":"");g.msrc&&(l.src=g.msrc),lc(g,l),h.appendChild(l),g.placeholder=l}g.loading||jc(g),f.allowProgressiveImg()&&(!Yb&&N.transform?dc.push({item:g,baseDiv:h,img:g.img,index:b,holder:a}):ic(b,g,h,g.img,!0,!0))}Yb||b!==m?Ha(g):(da=h.style,bc(g,d||g.img)),a.el.innerHTML="",a.el.appendChild(h)},cleanSlide:function(a){a.img&&(a.img.onload=a.img.onerror=null),a.loaded=a.loading=a.img=a.imageAppended=!1}}});var nc,oc={},pc=function(a,b,c){var d=document.createEvent("CustomEvent"),e={origEvent:a,target:a.target,releasePoint:b,pointerType:c||"touch"};d.initCustomEvent("pswpTap",!0,!0,e),a.target.dispatchEvent(d)};ya("Tap",{publicMethods:{initTap:function(){Ba("firstTouchStart",f.onTapStart),Ba("touchRelease",f.onTapRelease),Ba("destroy",function(){oc={},nc=null})},onTapStart:function(a){a.length>1&&(clearTimeout(nc),nc=null)},onTapRelease:function(a,b){if(b&&!X&&!V&&!$a){var c=b;if(nc&&(clearTimeout(nc),nc=null,wb(c,oc)))return void Ca("doubleTap",c);if("mouse"===b.type)return void pc(a,b,"mouse");var d=a.target.tagName.toUpperCase();if("BUTTON"===d||e.hasClass(a.target,"pswp__single-tap"))return void pc(a,b);La(oc,c),nc=setTimeout(function(){pc(a,b),nc=null},300)}}}});var qc;ya("DesktopZoom",{publicMethods:{initDesktopZoom:function(){L||(G?Ba("mouseUsed",function(){f.setupDesktopZoom()}):f.setupDesktopZoom(!0))},setupDesktopZoom:function(b){qc={};var c="wheel mousewheel DOMMouseScroll";Ba("bindEvents",function(){e.bind(a,c,f.handleMouseWheel)}),Ba("unbindEvents",function(){qc&&e.unbind(a,c,f.handleMouseWheel)}),f.mouseZoomedIn=!1;var d,g=function(){f.mouseZoomedIn&&(e.removeClass(a,"pswp--zoomed-in"),f.mouseZoomedIn=!1),1>s?e.addClass(a,"pswp--zoom-allowed"):e.removeClass(a,"pswp--zoom-allowed"),h()},h=function(){d&&(e.removeClass(a,"pswp--dragging"),d=!1)};Ba("resize",g),Ba("afterChange",g),Ba("pointerDown",function(){f.mouseZoomedIn&&(d=!0,e.addClass(a,"pswp--dragging"))}),Ba("pointerUp",h),b||g()},handleMouseWheel:function(a){if(s<=f.currItem.fitRatio)return i.modal&&(!i.closeOnScroll||$a||U?a.preventDefault():E&&Math.abs(a.deltaY)>2&&(l=!0,f.close())),!0;if(a.stopPropagation(),qc.x=0,"deltaX"in a)1===a.deltaMode?(qc.x=18*a.deltaX,qc.y=18*a.deltaY):(qc.x=a.deltaX,qc.y=a.deltaY);else if("wheelDelta"in a)a.wheelDeltaX&&(qc.x=-.16*a.wheelDeltaX),a.wheelDeltaY?qc.y=-.16*a.wheelDeltaY:qc.y=-.16*a.wheelDelta;else{if(!("detail"in a))return;qc.y=a.detail}Ra(s,!0);var b=oa.x-qc.x,c=oa.y-qc.y;(i.modal||b<=ca.min.x&&b>=ca.max.x&&c<=ca.min.y&&c>=ca.max.y)&&a.preventDefault(),f.panTo(b,c)},toggleDesktopZoom:function(b){b=b||{x:pa.x/2+ra.x,y:pa.y/2+ra.y};var c=i.getDoubleTapZoom(!0,f.currItem),d=s===c;f.mouseZoomedIn=!d,f.zoomTo(d?f.currItem.initialZoomLevel:c,b,333),e[(d?"remove":"add")+"Class"](a,"pswp--zoomed-in")}}});var rc,sc,tc,uc,vc,wc,xc,yc,zc,Ac,Bc,Cc,Dc={history:!0,galleryUID:1},Ec=function(){return Bc.hash.substring(1)},Fc=function(){rc&&clearTimeout(rc),tc&&clearTimeout(tc)},Gc=function(){var a=Ec(),b={};if(a.length<5)return b;var c,d=a.split("&");for(c=0;c<d.length;c++)if(d[c]){var e=d[c].split("=");e.length<2||(b[e[0]]=e[1])}if(i.galleryPIDs){var f=b.pid;for(b.pid=0,c=0;c<Xb.length;c++)if(Xb[c].pid===f){b.pid=c;break}}else b.pid=parseInt(b.pid,10)-1;return b.pid<0&&(b.pid=0),b},Hc=function(){if(tc&&clearTimeout(tc),$a||U)return void(tc=setTimeout(Hc,500));uc?clearTimeout(sc):uc=!0;var a=m+1,b=$b(m);b.hasOwnProperty("pid")&&(a=b.pid);var c=xc+"&gid="+i.galleryUID+"&pid="+a;yc||-1===Bc.hash.indexOf(c)&&(Ac=!0);var d=Bc.href.split("#")[0]+"#"+c;Cc?"#"+c!==window.location.hash&&history[yc?"replaceState":"pushState"]("",document.title,d):yc?Bc.replace(d):Bc.hash=c,yc=!0,sc=setTimeout(function(){uc=!1},60)};ya("History",{publicMethods:{initHistory:function(){if(e.extend(i,Dc,!0),i.history){Bc=window.location,Ac=!1,zc=!1,yc=!1,xc=Ec(),Cc="pushState"in history,xc.indexOf("gid=")>-1&&(xc=xc.split("&gid=")[0],xc=xc.split("?gid=")[0]),Ba("afterChange",f.updateURL),Ba("unbindEvents",function(){e.unbind(window,"hashchange",f.onHashChange)});var a=function(){wc=!0,zc||(Ac?history.back():xc?Bc.hash=xc:Cc?history.pushState("",document.title,Bc.pathname+Bc.search):Bc.hash=""),Fc()};Ba("unbindEvents",function(){l&&a()}),Ba("destroy",function(){wc||a()}),Ba("firstUpdate",function(){m=Gc().pid});var b=xc.indexOf("pid=");b>-1&&(xc=xc.substring(0,b),"&"===xc.slice(-1)&&(xc=xc.slice(0,-1))),setTimeout(function(){j&&e.bind(window,"hashchange",f.onHashChange)},40)}},onHashChange:function(){return Ec()===xc?(zc=!0,void f.close()):void(uc||(vc=!0,f.goTo(Gc().pid),vc=!1))},updateURL:function(){Fc(),vc||(yc?rc=setTimeout(Hc,800):Hc())}}}),e.extend(f,db)};return a}),!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.PhotoSwipeUI_Default=b()}(this,function(){"use strict";var a=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=this,w=!1,x=!0,y=!0,z={barsSize:{top:44,bottom:"auto"},closeElClasses:["item","caption","zoom-wrap","ui","top-bar"],timeToIdle:4e3,timeToIdleOutside:1e3,loadingIndicatorDelay:1e3,addCaptionHTMLFn:function(a,b){return a.title?(b.children[0].innerHTML=a.title,!0):(b.children[0].innerHTML="",!1)},closeEl:!0,captionEl:!0,fullscreenEl:!0,zoomEl:!0,shareEl:!0,counterEl:!0,arrowEl:!0,preloaderEl:!0,tapToClose:!1,tapToToggleControls:!0,clickToCloseNonZoomable:!0,shareButtons:[{id:"facebook",label:"Share on Facebook",url:"https://www.facebook.com/sharer/sharer.php?u={{url}}"},{id:"twitter",label:"Tweet",url:"https://twitter.com/intent/tweet?text={{text}}&url={{url}}"},{id:"pinterest",label:"Pin it",url:"http://www.pinterest.com/pin/create/button/?url={{url}}&media={{image_url}}&description={{text}}"},{id:"download",label:"Download image",url:"{{raw_image_url}}",download:!0}],getImageURLForShare:function(){return a.currItem.src||""},getPageURLForShare:function(){return window.location.href},getTextForShare:function(){return a.currItem.title||""},indexIndicatorSep:" / "},A=function(a){if(r)return!0;a=a||window.event,q.timeToIdle&&q.mouseUsed&&!k&&K();for(var c,d,e=a.target||a.srcElement,f=e.className,g=0;g<S.length;g++)c=S[g],c.onTap&&f.indexOf("pswp__"+c.name)>-1&&(c.onTap(),d=!0);if(d){a.stopPropagation&&a.stopPropagation(),r=!0;var h=b.features.isOldAndroid?600:30;s=setTimeout(function(){r=!1},h)}},B=function(){return!a.likelyTouchDevice||q.mouseUsed||screen.width>1200},C=function(a,c,d){b[(d?"add":"remove")+"Class"](a,"pswp__"+c)},D=function(){var a=1===q.getNumItemsFn();a!==p&&(C(d,"ui--one-slide",a),p=a)},E=function(){C(i,"share-modal--hidden",y)},F=function(){return y=!y,y?(b.removeClass(i,"pswp__share-modal--fade-in"),setTimeout(function(){y&&E()},300)):(E(),setTimeout(function(){y||b.addClass(i,"pswp__share-modal--fade-in")},30)),y||H(),!1},G=function(b){b=b||window.event;var c=b.target||b.srcElement;return a.shout("shareLinkClick",b,c),!!c.href&&(!!c.hasAttribute("download")||(window.open(c.href,"pswp_share","scrollbars=yes,resizable=yes,toolbar=no,location=yes,width=550,height=420,top=100,left="+(window.screen?Math.round(screen.width/2-275):100)),y||F(),!1))},H=function(){for(var a,b,c,d,e,f="",g=0;g<q.shareButtons.length;g++)a=q.shareButtons[g],c=q.getImageURLForShare(a),d=q.getPageURLForShare(a),e=q.getTextForShare(a),b=a.url.replace("{{url}}",encodeURIComponent(d)).replace("{{image_url}}",encodeURIComponent(c)).replace("{{raw_image_url}}",c).replace("{{text}}",encodeURIComponent(e)),f+='<a href="'+b+'" target="_blank" class="pswp__share--'+a.id+'"'+(a.download?"download":"")+">"+a.label+"</a>",q.parseShareButtonOut&&(f=q.parseShareButtonOut(a,f));i.children[0].innerHTML=f,i.children[0].onclick=G},I=function(a){for(var c=0;c<q.closeElClasses.length;c++)if(b.hasClass(a,"pswp__"+q.closeElClasses[c]))return!0},J=0,K=function(){clearTimeout(u),J=0,k&&v.setIdle(!1)},L=function(a){a=a?a:window.event;var b=a.relatedTarget||a.toElement;b&&"HTML"!==b.nodeName||(clearTimeout(u),u=setTimeout(function(){v.setIdle(!0)},q.timeToIdleOutside))},M=function(){q.fullscreenEl&&(c||(c=v.getFullscreenAPI()),c?(b.bind(document,c.eventK,v.updateFullscreen),v.updateFullscreen(),b.addClass(a.template,"pswp--supports-fs")):b.removeClass(a.template,"pswp--supports-fs"))},N=function(){q.preloaderEl&&(O(!0),l("beforeChange",function(){clearTimeout(o),o=setTimeout(function(){a.currItem&&a.currItem.loading?(!a.allowProgressiveImg()||a.currItem.img&&!a.currItem.img.naturalWidth)&&O(!1):O(!0)},q.loadingIndicatorDelay)}),l("imageLoadComplete",function(b,c){a.currItem===c&&O(!0)}))},O=function(a){n!==a&&(C(m,"preloader--active",!a),n=a)},P=function(a){var c=a.vGap;if(B()){var g=q.barsSize;if(q.captionEl&&"auto"===g.bottom)if(f||(f=b.createEl("pswp__caption pswp__caption--fake"),f.appendChild(b.createEl("pswp__caption__center")),d.insertBefore(f,e),b.addClass(d,"pswp__ui--fit")),q.addCaptionHTMLFn(a,f,!0)){var h=f.clientHeight;c.bottom=parseInt(h,10)||44}else c.bottom=g.top;else c.bottom="auto"===g.bottom?0:g.bottom;c.top=g.top}else c.top=c.bottom=0},Q=function(){q.timeToIdle&&l("mouseUsed",function(){b.bind(document,"mousemove",K),b.bind(document,"mouseout",L),t=setInterval(function(){J++,2===J&&v.setIdle(!0)},q.timeToIdle/2)})},R=function(){l("onVerticalDrag",function(a){x&&.95>a?v.hideControls():!x&&a>=.95&&v.showControls()});var a;l("onPinchClose",function(b){x&&.9>b?(v.hideControls(),a=!0):a&&!x&&b>.9&&v.showControls()}),l("zoomGestureEnded",function(){a=!1,a&&!x&&v.showControls()})},S=[{name:"caption",option:"captionEl",onInit:function(a){e=a}},{name:"share-modal",option:"shareEl",onInit:function(a){i=a},onTap:function(){F()}},{name:"button--share",option:"shareEl",onInit:function(a){h=a},onTap:function(){F()}},{name:"button--zoom",option:"zoomEl",onTap:a.toggleDesktopZoom},{name:"counter",option:"counterEl",onInit:function(a){g=a}},{name:"button--close",option:"closeEl",onTap:a.close},{name:"button--arrow--left",option:"arrowEl",onTap:a.prev},{name:"button--arrow--right",option:"arrowEl",onTap:a.next},{name:"button--fs",option:"fullscreenEl",onTap:function(){c.isFullscreen()?c.exit():c.enter()}},{name:"preloader",option:"preloaderEl",onInit:function(a){m=a}}],T=function(){var a,c,e,f=function(d){if(d)for(var f=d.length,g=0;f>g;g++){a=d[g],c=a.className;for(var h=0;h<S.length;h++)e=S[h],c.indexOf("pswp__"+e.name)>-1&&(q[e.option]?(b.removeClass(a,"pswp__element--disabled"),e.onInit&&e.onInit(a)):b.addClass(a,"pswp__element--disabled"))}};f(d.children);var g=b.getChildByClass(d,"pswp__top-bar");g&&f(g.children)};v.init=function(){b.extend(a.options,z,!0),q=a.options,d=b.getChildByClass(a.scrollWrap,"pswp__ui"),l=a.listen,R(),l("beforeChange",v.update),l("doubleTap",function(b){var c=a.currItem.initialZoomLevel;a.getZoomLevel()!==c?a.zoomTo(c,b,333):a.zoomTo(q.getDoubleTapZoom(!1,a.currItem),b,333)}),l("preventDragEvent",function(a,b,c){var d=a.target||a.srcElement;d&&d.className&&a.type.indexOf("mouse")>-1&&(d.className.indexOf("__caption")>0||/(SMALL|STRONG|EM)/i.test(d.tagName))&&(c.prevent=!1)}),l("bindEvents",function(){b.bind(d,"pswpTap click",A),b.bind(a.scrollWrap,"pswpTap",v.onGlobalTap),a.likelyTouchDevice||b.bind(a.scrollWrap,"mouseover",v.onMouseOver)}),l("unbindEvents",function(){y||F(),t&&clearInterval(t),b.unbind(document,"mouseout",L),b.unbind(document,"mousemove",K),b.unbind(d,"pswpTap click",A),b.unbind(a.scrollWrap,"pswpTap",v.onGlobalTap),b.unbind(a.scrollWrap,"mouseover",v.onMouseOver),c&&(b.unbind(document,c.eventK,v.updateFullscreen),c.isFullscreen()&&(q.hideAnimationDuration=0,c.exit()),c=null)}),l("destroy",function(){q.captionEl&&(f&&d.removeChild(f),b.removeClass(e,"pswp__caption--empty")),i&&(i.children[0].onclick=null),b.removeClass(d,"pswp__ui--over-close"),b.addClass(d,"pswp__ui--hidden"),v.setIdle(!1)}),q.showAnimationDuration||b.removeClass(d,"pswp__ui--hidden"),l("initialZoomIn",function(){q.showAnimationDuration&&b.removeClass(d,"pswp__ui--hidden")}),l("initialZoomOut",function(){b.addClass(d,"pswp__ui--hidden")}),l("parseVerticalMargin",P),T(),q.shareEl&&h&&i&&(y=!0),D(),Q(),M(),N()},v.setIdle=function(a){k=a,C(d,"ui--idle",a)},v.update=function(){x&&a.currItem?(v.updateIndexIndicator(),q.captionEl&&(q.addCaptionHTMLFn(a.currItem,e),C(e,"caption--empty",!a.currItem.title)),w=!0):w=!1,y||F(),D()},v.updateFullscreen=function(d){d&&setTimeout(function(){a.setScrollOffset(0,b.getScrollY())},50),b[(c.isFullscreen()?"add":"remove")+"Class"](a.template,"pswp--fs")},v.updateIndexIndicator=function(){q.counterEl&&(g.innerHTML=a.getCurrentIndex()+1+q.indexIndicatorSep+q.getNumItemsFn())},v.onGlobalTap=function(c){c=c||window.event;var d=c.target||c.srcElement;if(!r)if(c.detail&&"mouse"===c.detail.pointerType){if(I(d))return void a.close();b.hasClass(d,"pswp__img")&&(1===a.getZoomLevel()&&a.getZoomLevel()<=a.currItem.fitRatio?q.clickToCloseNonZoomable&&a.close():a.toggleDesktopZoom(c.detail.releasePoint))}else if(q.tapToToggleControls&&(x?v.hideControls():v.showControls()),q.tapToClose&&(b.hasClass(d,"pswp__img")||I(d)))return void a.close()},v.onMouseOver=function(a){a=a||window.event;var b=a.target||a.srcElement;C(d,"ui--over-close",I(b))},v.hideControls=function(){b.addClass(d,"pswp__ui--hidden"),x=!1},v.showControls=function(){x=!0,w||v.update(),b.removeClass(d,"pswp__ui--hidden")},v.supportsFullscreen=function(){var a=document;return!!(a.exitFullscreen||a.mozCancelFullScreen||a.webkitExitFullscreen||a.msExitFullscreen)},v.getFullscreenAPI=function(){var b,c=document.documentElement,d="fullscreenchange";return c.requestFullscreen?b={enterK:"requestFullscreen",exitK:"exitFullscreen",elementK:"fullscreenElement",eventK:d}:c.mozRequestFullScreen?b={enterK:"mozRequestFullScreen",exitK:"mozCancelFullScreen",elementK:"mozFullScreenElement",eventK:"moz"+d}:c.webkitRequestFullscreen?b={enterK:"webkitRequestFullscreen",exitK:"webkitExitFullscreen",elementK:"webkitFullscreenElement",eventK:"webkit"+d}:c.msRequestFullscreen&&(b={enterK:"msRequestFullscreen",exitK:"msExitFullscreen",elementK:"msFullscreenElement",eventK:"MSFullscreenChange"}),b&&(b.enter=function(){return j=q.closeOnScroll,q.closeOnScroll=!1,"webkitRequestFullscreen"!==this.enterK?a.template[this.enterK]():void a.template[this.enterK](Element.ALLOW_KEYBOARD_INPUT)},b.exit=function(){return q.closeOnScroll=j,document[this.exitK]()},b.isFullscreen=function(){return document[this.elementK]}),b}};return a}),"undefined"==typeof YAHOO||!YAHOO)var YAHOO={};YAHOO.namespace=function(){var a,b,c,d=arguments,e=null;for(a=0;a<d.length;a+=1)for(c=(""+d[a]).split("."),e=YAHOO,b="YAHOO"==c[0]?1:0;b<c.length;b+=1)e[c[b]]=e[c[b]]||{},e=e[c[b]];return e},YAHOO.log=function(a,b,c){var d=YAHOO.widget.Logger;return!(!d||!d.log)&&d.log(a,b,c)},YAHOO.register=function(a,b,c){var d,e,f,g,h,i=YAHOO.env.modules;for(i[a]||(i[a]={versions:[],builds:[]}),d=i[a],e=c.version,f=c.build,g=YAHOO.env.listeners,d.name=a,d.version=e,d.build=f,d.versions.push(e),d.builds.push(f),d.mainClass=b,h=0;h<g.length;h+=1)g[h](d);b?(b.VERSION=e,b.BUILD=f):YAHOO.log("mainClass is undefined for module "+a,"warn")},YAHOO.env=YAHOO.env||{modules:[],listeners:[]},YAHOO.env.getVersion=function(a){return YAHOO.env.modules[a]||null},YAHOO.env.parseUA=function(a){var b,c=function(a){var b=0;return parseFloat(a.replace(/\./g,function(){return 1==b++?"":"."}))},d=navigator,e={ie:0,opera:0,gecko:0,webkit:0,chrome:0,mobile:null,air:0,ipad:0,iphone:0,ipod:0,ios:null,android:0,webos:0,caja:d&&d.cajaVersion,secure:!1,os:null},f=a||navigator&&navigator.userAgent,g=window&&window.location,h=g&&g.href;return e.secure=h&&0===h.toLowerCase().indexOf("https"),f&&(/windows|win32/i.test(f)?e.os="windows":/macintosh/i.test(f)?e.os="macintosh":/rhino/i.test(f)&&(e.os="rhino"),/KHTML/.test(f)&&(e.webkit=1),b=f.match(/AppleWebKit\/([^\s]*)/),b&&b[1]&&(e.webkit=c(b[1]),/ Mobile\//.test(f)?(e.mobile="Apple",b=f.match(/OS ([^\s]*)/),b&&b[1]&&(b=c(b[1].replace("_","."))),e.ios=b,e.ipad=e.ipod=e.iphone=0,b=f.match(/iPad|iPod|iPhone/),b&&b[0]&&(e[b[0].toLowerCase()]=e.ios)):(b=f.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/),b&&(e.mobile=b[0]),/webOS/.test(f)&&(e.mobile="WebOS",b=f.match(/webOS\/([^\s]*);/),b&&b[1]&&(e.webos=c(b[1]))),/ Android/.test(f)&&(e.mobile="Android",b=f.match(/Android ([^\s]*);/),b&&b[1]&&(e.android=c(b[1])))),b=f.match(/Chrome\/([^\s]*)/),b&&b[1]?e.chrome=c(b[1]):(b=f.match(/AdobeAIR\/([^\s]*)/),b&&(e.air=b[0]))),e.webkit||(b=f.match(/Opera[\s\/]([^\s]*)/),b&&b[1]?(e.opera=c(b[1]),b=f.match(/Version\/([^\s]*)/),b&&b[1]&&(e.opera=c(b[1])),b=f.match(/Opera Mini[^;]*/),b&&(e.mobile=b[0])):(b=f.match(/MSIE\s([^;]*)/),b&&b[1]?e.ie=c(b[1]):(b=f.match(/Gecko\/([^\s]*)/),b&&(e.gecko=1,b=f.match(/rv:([^\s\)]*)/),b&&b[1]&&(e.gecko=c(b[1]))))))),e},YAHOO.env.ua=YAHOO.env.parseUA(),function(){if(YAHOO.namespace("util","widget","example"),"undefined"!=typeof YAHOO_config){var a,b=YAHOO_config.listener,c=YAHOO.env.listeners,d=!0;if(b){for(a=0;a<c.length;a++)if(c[a]==b){d=!1;break}d&&c.push(b)}}}(),YAHOO.lang=YAHOO.lang||{},function(){var a=YAHOO.lang,b=Object.prototype,c="[object Array]",d="[object Function]",e="[object Object]",f=[],g={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;","`":"&#x60;"},h=["toString","valueOf"],i={isArray:function(a){return b.toString.apply(a)===c},isBoolean:function(a){return"boolean"==typeof a},isFunction:function(a){return"function"==typeof a||b.toString.apply(a)===d},isNull:function(a){return null===a},isNumber:function(a){return"number"==typeof a&&isFinite(a)},isObject:function(b){return b&&("object"==typeof b||a.isFunction(b))||!1},isString:function(a){return"string"==typeof a},isUndefined:function(a){return"undefined"==typeof a},_IEEnumFix:YAHOO.env.ua.ie?function(c,d){var e,f,g;for(e=0;e<h.length;e+=1)f=h[e],g=d[f],a.isFunction(g)&&g!=b[f]&&(c[f]=g)}:function(){},escapeHTML:function(a){return a.replace(/[&<>"'\/`]/g,function(a){return g[a]})},extend:function(c,d,e){if(!d||!c)throw new Error("extend failed, please check that all dependencies are included.");var f,g=function(){};if(g.prototype=d.prototype,c.prototype=new g,c.prototype.constructor=c,c.superclass=d.prototype,d.prototype.constructor==b.constructor&&(d.prototype.constructor=d),e){for(f in e)a.hasOwnProperty(e,f)&&(c.prototype[f]=e[f]);a._IEEnumFix(c.prototype,e)}},augmentObject:function(b,c){if(!c||!b)throw new Error("Absorb failed, verify dependencies.");var d,e,f=arguments,g=f[2];if(g&&g!==!0)for(d=2;d<f.length;d+=1)b[f[d]]=c[f[d]];else{for(e in c)!g&&e in b||(b[e]=c[e]);a._IEEnumFix(b,c)}return b},augmentProto:function(b,c){if(!c||!b)throw new Error("Augment failed, verify dependencies.");var d,e=[b.prototype,c.prototype];for(d=2;d<arguments.length;d+=1)e.push(arguments[d]);return a.augmentObject.apply(this,e),b},dump:function(b,c){var d,e,f=[],g="{...}",h="f(){...}",i=", ",j=" => ";if(!a.isObject(b))return b+"";if(b instanceof Date||"nodeType"in b&&"tagName"in b)return b;if(a.isFunction(b))return h;if(c=a.isNumber(c)?c:3,a.isArray(b)){for(f.push("["),d=0,e=b.length;d<e;d+=1)a.isObject(b[d])?f.push(c>0?a.dump(b[d],c-1):g):f.push(b[d]),f.push(i);f.length>1&&f.pop(),f.push("]")}else{f.push("{");for(d in b)a.hasOwnProperty(b,d)&&(f.push(d+j),a.isObject(b[d])?f.push(c>0?a.dump(b[d],c-1):g):f.push(b[d]),f.push(i));f.length>1&&f.pop(),f.push("}")}return f.join("")},substitute:function(b,c,d,f){for(var g,h,i,j,k,l,m,n,o,p=[],q=b.length,r="dump",s=" ",t="{",u="}";(g=b.lastIndexOf(t,q),!(g<0))&&(h=b.indexOf(u,g),!(g+1>h));)m=b.substring(g+1,h),j=m,l=null,i=j.indexOf(s),i>-1&&(l=j.substring(i+1),j=j.substring(0,i)),k=c[j],d&&(k=d(j,k,l)),a.isObject(k)?a.isArray(k)?k=a.dump(k,parseInt(l,10)):(l=l||"",n=l.indexOf(r),n>-1&&(l=l.substring(4)),o=k.toString(),k=o===e||n>-1?a.dump(k,parseInt(l,10)):o):a.isString(k)||a.isNumber(k)||(k="~-"+p.length+"-~",p[p.length]=m),b=b.substring(0,g)+k+b.substring(h+1),f===!1&&(q=g-1);for(g=p.length-1;g>=0;g-=1)b=b.replace(new RegExp("~-"+g+"-~"),"{"+p[g]+"}","g");return b},trim:function(a){try{return a.replace(/^\s+|\s+$/g,"")}catch(b){return a}},merge:function(){var b,c={},d=arguments,e=d.length;for(b=0;b<e;b+=1)a.augmentObject(c,d[b],!0);return c},later:function(b,c,d,e,g){b=b||0,c=c||{};var h,i,j=d,k=e;if(a.isString(d)&&(j=c[d]),!j)throw new TypeError("method undefined");return a.isUndefined(e)||a.isArray(k)||(k=[e]),h=function(){j.apply(c,k||f)},i=g?setInterval(h,b):setTimeout(h,b),{interval:g,cancel:function(){this.interval?clearInterval(i):clearTimeout(i)}}},isValue:function(b){return a.isObject(b)||a.isString(b)||a.isNumber(b)||a.isBoolean(b)}};a.hasOwnProperty=b.hasOwnProperty?function(a,b){return a&&a.hasOwnProperty&&a.hasOwnProperty(b)}:function(b,c){return!a.isUndefined(b[c])&&b.constructor.prototype[c]!==b[c]},i.augmentObject(a,i,!0),YAHOO.util.Lang=a,a.augment=a.augmentProto,YAHOO.augment=a.augmentProto,YAHOO.extend=a.extend}(),YAHOO.register("yahoo",YAHOO,{version:"2.9.0",build:"2800"});var CryptoJS=CryptoJS||function(a,b){var c={},d=c.lib={},e=d.Base=function(){function a(){}return{extend:function(b){a.prototype=this;var c=new a;return b&&c.mixIn(b),c.hasOwnProperty("init")||(c.init=function(){c.$super.init.apply(this,arguments)}),c.init.prototype=c,c.$super=this,c},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=d.WordArray=e.extend({init:function(a,c){a=this.words=a||[],c!=b?this.sigBytes=c:this.sigBytes=4*a.length},toString:function(a){return(a||h).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes,e=a.sigBytes;if(this.clamp(),d%4)for(var f=0;f<e;f++){
var g=c[f>>>2]>>>24-f%4*8&255;b[d+f>>>2]|=g<<24-(d+f)%4*8}else for(var f=0;f<e;f+=4)b[d+f>>>2]=c[f>>>2];return this.sigBytes+=e,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-c%4*8,b.length=a.ceil(c/4)},clone:function(){var a=e.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c=[],d=0;d<b;d+=4)c.push(4294967296*a.random()|0);return new f.init(c,b)}}),g=c.enc={},h=g.Hex={stringify:function(a){for(var b=a.words,c=a.sigBytes,d=[],e=0;e<c;e++){var f=b[e>>>2]>>>24-e%4*8&255;d.push((f>>>4).toString(16)),d.push((15&f).toString(16))}return d.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new f.init(c,b/2)}},i=g.Latin1={stringify:function(a){for(var b=a.words,c=a.sigBytes,d=[],e=0;e<c;e++){var f=b[e>>>2]>>>24-e%4*8&255;d.push(String.fromCharCode(f))}return d.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-d%4*8;return new f.init(c,b)}},j=g.Utf8={stringify:function(a){try{return decodeURIComponent(escape(i.stringify(a)))}catch(a){throw new Error("Malformed UTF-8 data")}},parse:function(a){return i.parse(unescape(encodeURIComponent(a)))}},k=d.BufferedBlockAlgorithm=e.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=j.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,g=this.blockSize,h=4*g,i=e/h;i=b?a.ceil(i):a.max((0|i)-this._minBufferSize,0);var j=i*g,k=a.min(4*j,e);if(j){for(var l=0;l<j;l+=g)this._doProcessBlock(d,l);var m=d.splice(0,j);c.sigBytes-=k}return new f.init(m,k)},clone:function(){var a=e.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0}),l=(d.Hasher=k.extend({cfg:e.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){k.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){a&&this._append(a);var b=this._doFinalize();return b},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new l.HMAC.init(a,c).finalize(b)}}}),c.algo={});return c}(Math);!function(a){var b=CryptoJS,c=b.lib,d=c.Base,e=c.WordArray,b=b.x64={};b.Word=d.extend({init:function(a,b){this.high=a,this.low=b}}),b.WordArray=d.extend({init:function(b,c){b=this.words=b||[],this.sigBytes=c!=a?c:8*b.length},toX32:function(){for(var a=this.words,b=a.length,c=[],d=0;d<b;d++){var f=a[d];c.push(f.high),c.push(f.low)}return e.create(c,this.sigBytes)},clone:function(){for(var a=d.clone.call(this),b=a.words=this.words.slice(0),c=b.length,e=0;e<c;e++)b[e]=b[e].clone();return a}})}(),function(){var a=CryptoJS,b=a.enc.Utf8;a.algo.HMAC=a.lib.Base.extend({init:function(a,c){a=this._hasher=new a.init,"string"==typeof c&&(c=b.parse(c));var d=a.blockSize,e=4*d;c.sigBytes>e&&(c=a.finalize(c)),c.clamp();for(var f=this._oKey=c.clone(),g=this._iKey=c.clone(),h=f.words,i=g.words,j=0;j<d;j++)h[j]^=1549556828,i[j]^=909522486;f.sigBytes=g.sigBytes=e,this.reset()},reset:function(){var a=this._hasher;a.reset(),a.update(this._iKey)},update:function(a){return this._hasher.update(a),this},finalize:function(a){var b=this._hasher;return a=b.finalize(a),b.reset(),b.finalize(this._oKey.clone().concat(a))}})}(),function(a){for(var b=CryptoJS,c=b.lib,d=c.WordArray,e=c.Hasher,c=b.algo,f=[],g=[],h=function(a){return 4294967296*(a-(0|a))|0},i=2,j=0;64>j;){var k;a:{k=i;for(var l=a.sqrt(k),m=2;m<=l;m++)if(!(k%m)){k=!1;break a}k=!0}k&&(8>j&&(f[j]=h(a.pow(i,.5))),g[j]=h(a.pow(i,1/3)),j++),i++}var n=[],c=c.SHA256=e.extend({_doReset:function(){this._hash=new d.init(f.slice(0))},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],e=c[1],f=c[2],h=c[3],i=c[4],j=c[5],k=c[6],l=c[7],m=0;64>m;m++){if(16>m)n[m]=0|a[b+m];else{var o=n[m-15],p=n[m-2];n[m]=((o<<25|o>>>7)^(o<<14|o>>>18)^o>>>3)+n[m-7]+((p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10)+n[m-16]}o=l+((i<<26|i>>>6)^(i<<21|i>>>11)^(i<<7|i>>>25))+(i&j^~i&k)+g[m]+n[m],p=((d<<30|d>>>2)^(d<<19|d>>>13)^(d<<10|d>>>22))+(d&e^d&f^e&f),l=k,k=j,j=i,i=h+o|0,h=f,f=e,e=d,d=o+p|0}c[0]=c[0]+d|0,c[1]=c[1]+e|0,c[2]=c[2]+f|0,c[3]=c[3]+h|0,c[4]=c[4]+i|0,c[5]=c[5]+j|0,c[6]=c[6]+k|0,c[7]=c[7]+l|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;return c[e>>>5]|=128<<24-e%32,c[(e+64>>>9<<4)+14]=a.floor(d/4294967296),c[(e+64>>>9<<4)+15]=d,b.sigBytes=4*c.length,this._process(),this._hash},clone:function(){var a=e.clone.call(this);return a._hash=this._hash.clone(),a}});b.SHA256=e._createHelper(c),b.HmacSHA256=e._createHmacHelper(c)}(Math),function(){var a=CryptoJS,b=a.lib.WordArray,c=a.algo,d=c.SHA256,c=c.SHA224=d.extend({_doReset:function(){this._hash=new b.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var a=d._doFinalize.call(this);return a.sigBytes-=4,a}});a.SHA224=d._createHelper(c),a.HmacSHA224=d._createHmacHelper(c)}(),function(){function a(){return e.create.apply(e,arguments)}for(var b=CryptoJS,c=b.lib.Hasher,d=b.x64,e=d.Word,f=d.WordArray,d=b.algo,g=[a(1116352408,3609767458),a(1899447441,602891725),a(3049323471,3964484399),a(3921009573,2173295548),a(961987163,4081628472),a(1508970993,3053834265),a(2453635748,2937671579),a(2870763221,3664609560),a(3624381080,2734883394),a(310598401,1164996542),a(607225278,1323610764),a(1426881987,3590304994),a(1925078388,4068182383),a(2162078206,991336113),a(2614888103,633803317),a(3248222580,3479774868),a(3835390401,2666613458),a(4022224774,944711139),a(264347078,2341262773),a(604807628,2007800933),a(770255983,1495990901),a(1249150122,1856431235),a(1555081692,3175218132),a(1996064986,2198950837),a(2554220882,3999719339),a(2821834349,766784016),a(2952996808,2566594879),a(3210313671,3203337956),a(3336571891,1034457026),a(3584528711,2466948901),a(113926993,3758326383),a(338241895,168717936),a(666307205,1188179964),a(773529912,1546045734),a(1294757372,1522805485),a(1396182291,2643833823),a(1695183700,2343527390),a(1986661051,1014477480),a(2177026350,1206759142),a(2456956037,344077627),a(2730485921,1290863460),a(2820302411,3158454273),a(3259730800,3505952657),a(3345764771,106217008),a(3516065817,3606008344),a(3600352804,1432725776),a(4094571909,1467031594),a(275423344,851169720),a(430227734,3100823752),a(506948616,1363258195),a(659060556,3750685593),a(883997877,3785050280),a(958139571,3318307427),a(1322822218,3812723403),a(1537002063,2003034995),a(1747873779,3602036899),a(1955562222,1575990012),a(2024104815,1125592928),a(2227730452,2716904306),a(2361852424,442776044),a(2428436474,593698344),a(2756734187,3733110249),a(3204031479,2999351573),a(3329325298,3815920427),a(3391569614,3928383900),a(3515267271,566280711),a(3940187606,3454069534),a(4118630271,4000239992),a(116418474,1914138554),a(174292421,2731055270),a(289380356,3203993006),a(460393269,320620315),a(685471733,587496836),a(852142971,1086792851),a(1017036298,365543100),a(1126000580,2618297676),a(1288033470,3409855158),a(1501505948,4234509866),a(1607167915,987167468),a(1816402316,1246189591)],h=[],i=0;80>i;i++)h[i]=a();d=d.SHA512=c.extend({_doReset:function(){this._hash=new f.init([new e.init(1779033703,4089235720),new e.init(3144134277,2227873595),new e.init(1013904242,4271175723),new e.init(2773480762,1595750129),new e.init(1359893119,2917565137),new e.init(2600822924,725511199),new e.init(528734635,4215389547),new e.init(1541459225,327033209)])},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],e=c[1],f=c[2],i=c[3],j=c[4],k=c[5],l=c[6],c=c[7],m=d.high,n=d.low,o=e.high,p=e.low,q=f.high,r=f.low,s=i.high,t=i.low,u=j.high,v=j.low,w=k.high,x=k.low,y=l.high,z=l.low,A=c.high,B=c.low,C=m,D=n,E=o,F=p,G=q,H=r,I=s,J=t,K=u,L=v,M=w,N=x,O=y,P=z,Q=A,R=B,S=0;80>S;S++){var T=h[S];if(16>S)var U=T.high=0|a[b+2*S],V=T.low=0|a[b+2*S+1];else{var U=h[S-15],V=U.high,W=U.low,U=(V>>>1|W<<31)^(V>>>8|W<<24)^V>>>7,W=(W>>>1|V<<31)^(W>>>8|V<<24)^(W>>>7|V<<25),X=h[S-2],V=X.high,Y=X.low,X=(V>>>19|Y<<13)^(V<<3|Y>>>29)^V>>>6,Y=(Y>>>19|V<<13)^(Y<<3|V>>>29)^(Y>>>6|V<<26),V=h[S-7],Z=V.high,$=h[S-16],_=$.high,$=$.low,V=W+V.low,U=U+Z+(V>>>0<W>>>0?1:0),V=V+Y,U=U+X+(V>>>0<Y>>>0?1:0),V=V+$,U=U+_+(V>>>0<$>>>0?1:0);T.high=U,T.low=V}var Z=K&M^~K&O,$=L&N^~L&P,T=C&E^C&G^E&G,aa=D&F^D&H^F&H,W=(C>>>28|D<<4)^(C<<30|D>>>2)^(C<<25|D>>>7),X=(D>>>28|C<<4)^(D<<30|C>>>2)^(D<<25|C>>>7),Y=g[S],ba=Y.high,ca=Y.low,Y=R+((L>>>14|K<<18)^(L>>>18|K<<14)^(L<<23|K>>>9)),_=Q+((K>>>14|L<<18)^(K>>>18|L<<14)^(K<<23|L>>>9))+(Y>>>0<R>>>0?1:0),Y=Y+$,_=_+Z+(Y>>>0<$>>>0?1:0),Y=Y+ca,_=_+ba+(Y>>>0<ca>>>0?1:0),Y=Y+V,_=_+U+(Y>>>0<V>>>0?1:0),V=X+aa,T=W+T+(V>>>0<X>>>0?1:0),Q=O,R=P,O=M,P=N,M=K,N=L,L=J+Y|0,K=I+_+(L>>>0<J>>>0?1:0)|0,I=G,J=H,G=E,H=F,E=C,F=D,D=Y+V|0,C=_+T+(D>>>0<Y>>>0?1:0)|0}n=d.low=n+D,d.high=m+C+(n>>>0<D>>>0?1:0),p=e.low=p+F,e.high=o+E+(p>>>0<F>>>0?1:0),r=f.low=r+H,f.high=q+G+(r>>>0<H>>>0?1:0),t=i.low=t+J,i.high=s+I+(t>>>0<J>>>0?1:0),v=j.low=v+L,j.high=u+K+(v>>>0<L>>>0?1:0),x=k.low=x+N,k.high=w+M+(x>>>0<N>>>0?1:0),z=l.low=z+P,l.high=y+O+(z>>>0<P>>>0?1:0),B=c.low=B+R,c.high=A+Q+(B>>>0<R>>>0?1:0)},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;return b[d>>>5]|=128<<24-d%32,b[(d+128>>>10<<5)+30]=Math.floor(c/4294967296),b[(d+128>>>10<<5)+31]=c,a.sigBytes=4*b.length,this._process(),this._hash.toX32()},clone:function(){var a=c.clone.call(this);return a._hash=this._hash.clone(),a},blockSize:32}),b.SHA512=c._createHelper(d),b.HmacSHA512=c._createHmacHelper(d)}(),function(){var a=CryptoJS,b=a.x64,c=b.Word,d=b.WordArray,b=a.algo,e=b.SHA512,b=b.SHA384=e.extend({_doReset:function(){this._hash=new d.init([new c.init(3418070365,3238371032),new c.init(1654270250,914150663),new c.init(2438529370,812702999),new c.init(355462360,4144912697),new c.init(1731405415,4290775857),new c.init(2394180231,1750603025),new c.init(3675008525,1694076839),new c.init(1203062813,3204075428)])},_doFinalize:function(){var a=e._doFinalize.call(this);return a.sigBytes-=16,a}});a.SHA384=e._createHelper(b),a.HmacSHA384=e._createHmacHelper(b)}(),function(a){function b(a,b,c,d,e,f,g){return a=a+(b&c|~b&d)+e+g,(a<<f|a>>>32-f)+b}function c(a,b,c,d,e,f,g){return a=a+(b&d|c&~d)+e+g,(a<<f|a>>>32-f)+b}function d(a,b,c,d,e,f,g){return a=a+(b^c^d)+e+g,(a<<f|a>>>32-f)+b}function e(a,b,c,d,e,f,g){return a=a+(c^(b|~d))+e+g,(a<<f|a>>>32-f)+b}for(var f=CryptoJS,g=f.lib,h=g.WordArray,i=g.Hasher,g=f.algo,j=[],k=0;64>k;k++)j[k]=4294967296*a.abs(a.sin(k+1))|0;g=g.MD5=i.extend({_doReset:function(){this._hash=new h.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(a,f){for(var g=0;16>g;g++){var h=f+g,i=a[h];a[h]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var g=this._hash.words,h=a[f+0],i=a[f+1],k=a[f+2],l=a[f+3],m=a[f+4],n=a[f+5],o=a[f+6],p=a[f+7],q=a[f+8],r=a[f+9],s=a[f+10],t=a[f+11],u=a[f+12],v=a[f+13],w=a[f+14],x=a[f+15],y=g[0],z=g[1],A=g[2],B=g[3],y=b(y,z,A,B,h,7,j[0]),B=b(B,y,z,A,i,12,j[1]),A=b(A,B,y,z,k,17,j[2]),z=b(z,A,B,y,l,22,j[3]),y=b(y,z,A,B,m,7,j[4]),B=b(B,y,z,A,n,12,j[5]),A=b(A,B,y,z,o,17,j[6]),z=b(z,A,B,y,p,22,j[7]),y=b(y,z,A,B,q,7,j[8]),B=b(B,y,z,A,r,12,j[9]),A=b(A,B,y,z,s,17,j[10]),z=b(z,A,B,y,t,22,j[11]),y=b(y,z,A,B,u,7,j[12]),B=b(B,y,z,A,v,12,j[13]),A=b(A,B,y,z,w,17,j[14]),z=b(z,A,B,y,x,22,j[15]),y=c(y,z,A,B,i,5,j[16]),B=c(B,y,z,A,o,9,j[17]),A=c(A,B,y,z,t,14,j[18]),z=c(z,A,B,y,h,20,j[19]),y=c(y,z,A,B,n,5,j[20]),B=c(B,y,z,A,s,9,j[21]),A=c(A,B,y,z,x,14,j[22]),z=c(z,A,B,y,m,20,j[23]),y=c(y,z,A,B,r,5,j[24]),B=c(B,y,z,A,w,9,j[25]),A=c(A,B,y,z,l,14,j[26]),z=c(z,A,B,y,q,20,j[27]),y=c(y,z,A,B,v,5,j[28]),B=c(B,y,z,A,k,9,j[29]),A=c(A,B,y,z,p,14,j[30]),z=c(z,A,B,y,u,20,j[31]),y=d(y,z,A,B,n,4,j[32]),B=d(B,y,z,A,q,11,j[33]),A=d(A,B,y,z,t,16,j[34]),z=d(z,A,B,y,w,23,j[35]),y=d(y,z,A,B,i,4,j[36]),B=d(B,y,z,A,m,11,j[37]),A=d(A,B,y,z,p,16,j[38]),z=d(z,A,B,y,s,23,j[39]),y=d(y,z,A,B,v,4,j[40]),B=d(B,y,z,A,h,11,j[41]),A=d(A,B,y,z,l,16,j[42]),z=d(z,A,B,y,o,23,j[43]),y=d(y,z,A,B,r,4,j[44]),B=d(B,y,z,A,u,11,j[45]),A=d(A,B,y,z,x,16,j[46]),z=d(z,A,B,y,k,23,j[47]),y=e(y,z,A,B,h,6,j[48]),B=e(B,y,z,A,p,10,j[49]),A=e(A,B,y,z,w,15,j[50]),z=e(z,A,B,y,n,21,j[51]),y=e(y,z,A,B,u,6,j[52]),B=e(B,y,z,A,l,10,j[53]),A=e(A,B,y,z,s,15,j[54]),z=e(z,A,B,y,i,21,j[55]),y=e(y,z,A,B,q,6,j[56]),B=e(B,y,z,A,x,10,j[57]),A=e(A,B,y,z,o,15,j[58]),z=e(z,A,B,y,v,21,j[59]),y=e(y,z,A,B,m,6,j[60]),B=e(B,y,z,A,t,10,j[61]),A=e(A,B,y,z,k,15,j[62]),z=e(z,A,B,y,r,21,j[63]);g[0]=g[0]+y|0,g[1]=g[1]+z|0,g[2]=g[2]+A|0,g[3]=g[3]+B|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;c[e>>>5]|=128<<24-e%32;var f=a.floor(d/4294967296);for(c[(e+64>>>9<<4)+15]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),c[(e+64>>>9<<4)+14]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),b.sigBytes=4*(c.length+1),this._process(),b=this._hash,c=b.words,d=0;4>d;d++)e=c[d],c[d]=16711935&(e<<8|e>>>24)|4278255360&(e<<24|e>>>8);return b},clone:function(){var a=i.clone.call(this);return a._hash=this._hash.clone(),a}}),f.MD5=i._createHelper(g),f.HmacMD5=i._createHmacHelper(g)}(Math),function(){var a=CryptoJS,b=a.lib.WordArray;a.enc.Base64={stringify:function(a){var b=a.words,c=a.sigBytes,d=this._map;a.clamp(),a=[];for(var e=0;e<c;e+=3)for(var f=(b[e>>>2]>>>24-8*(e%4)&255)<<16|(b[e+1>>>2]>>>24-8*((e+1)%4)&255)<<8|b[e+2>>>2]>>>24-8*((e+2)%4)&255,g=0;4>g&&e+.75*g<c;g++)a.push(d.charAt(f>>>6*(3-g)&63));if(b=d.charAt(64))for(;a.length%4;)a.push(b);return a.join("")},parse:function(a){var c=a.length,d=this._map,e=d.charAt(64);e&&(e=a.indexOf(e),-1!=e&&(c=e));for(var e=[],f=0,g=0;g<c;g++)if(g%4){var h=d.indexOf(a.charAt(g-1))<<2*(g%4),i=d.indexOf(a.charAt(g))>>>6-2*(g%4);e[f>>>2]|=(h|i)<<24-8*(f%4),f++}return b.create(e,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),CryptoJS.lib.Cipher||function(a){var b=CryptoJS,c=b.lib,d=c.Base,e=c.WordArray,f=c.BufferedBlockAlgorithm,g=b.enc.Base64,h=b.algo.EvpKDF,i=c.Cipher=f.extend({cfg:d.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c),this._xformMode=a,this._key=b,this.reset()},reset:function(){f.reset.call(this),this._doReset()},process:function(a){return this._append(a),this._process()},finalize:function(a){return a&&this._append(a),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(a){return{encrypt:function(b,c,d){return("string"==typeof c?o:n).encrypt(a,b,c,d)},decrypt:function(b,c,d){return("string"==typeof c?o:n).decrypt(a,b,c,d)}}}});c.StreamCipher=i.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var j=b.mode={},k=function(b,c,d){var e=this._iv;e?this._iv=a:e=this._prevBlock;for(var f=0;f<d;f++)b[c+f]^=e[f]},l=(c.BlockCipherMode=d.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a,this._iv=b}})).extend();l.Encryptor=l.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize;k.call(this,a,b,d),c.encryptBlock(a,b),this._prevBlock=a.slice(b,b+d)}}),l.Decryptor=l.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize,e=a.slice(b,b+d);c.decryptBlock(a,b),k.call(this,a,b,d),this._prevBlock=e}}),j=j.CBC=l,l=(b.pad={}).Pkcs7={pad:function(a,b){for(var c=4*b,c=c-a.sigBytes%c,d=c<<24|c<<16|c<<8|c,f=[],g=0;g<c;g+=4)f.push(d);c=e.create(f,c),a.concat(c)},unpad:function(a){a.sigBytes-=255&a.words[a.sigBytes-1>>>2]}},c.BlockCipher=i.extend({cfg:i.cfg.extend({mode:j,padding:l}),reset:function(){i.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var c=a.createEncryptor;else c=a.createDecryptor,this._minBufferSize=1;this._mode=c.call(a,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var m=c.CipherParams=d.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),j=(b.format={}).OpenSSL={stringify:function(a){var b=a.ciphertext;return a=a.salt,(a?e.create([1398893684,1701076831]).concat(a).concat(b):b).toString(g)},parse:function(a){a=g.parse(a);var b=a.words;if(1398893684==b[0]&&1701076831==b[1]){var c=e.create(b.slice(2,4));b.splice(0,4),a.sigBytes-=16}return m.create({ciphertext:a,salt:c})}},n=c.SerializableCipher=d.extend({cfg:d.extend({format:j}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);var e=a.createEncryptor(c,d);return b=e.finalize(b),e=e.cfg,m.create({ciphertext:b,key:c,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),a.createDecryptor(c,d).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),b=(b.kdf={}).OpenSSL={execute:function(a,b,c,d){return d||(d=e.random(8)),a=h.create({keySize:b+c}).compute(a,d),c=e.create(a.words.slice(b),4*c),a.sigBytes=4*b,m.create({key:a,iv:c,salt:d})}},o=c.PasswordBasedCipher=n.extend({cfg:n.cfg.extend({kdf:b}),encrypt:function(a,b,c,d){return d=this.cfg.extend(d),c=d.kdf.execute(c,a.keySize,a.ivSize),d.iv=c.iv,a=n.encrypt.call(this,a,b,c.key,d),a.mixIn(c),a},decrypt:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),c=d.kdf.execute(c,a.keySize,a.ivSize,b.salt),d.iv=c.iv,n.decrypt.call(this,a,b,c.key,d)}})}(),function(){for(var a=CryptoJS,b=a.lib.BlockCipher,c=a.algo,d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=0;256>o;o++)n[o]=128>o?o<<1:o<<1^283;for(var p=0,q=0,o=0;256>o;o++){var r=q^q<<1^q<<2^q<<3^q<<4,r=r>>>8^255&r^99;d[p]=r,e[r]=p;var s=n[p],t=n[s],u=n[t],v=257*n[r]^16843008*r;f[p]=v<<24|v>>>8,g[p]=v<<16|v>>>16,h[p]=v<<8|v>>>24,i[p]=v,v=16843009*u^65537*t^257*s^16843008*p,j[r]=v<<24|v>>>8,k[r]=v<<16|v>>>16,l[r]=v<<8|v>>>24,m[r]=v,p?(p=s^n[n[n[u^s]]],q^=n[n[q]]):p=q=1}var w=[0,1,2,4,8,16,32,64,128,27,54],c=c.AES=b.extend({_doReset:function(){for(var a=this._key,b=a.words,c=a.sigBytes/4,a=4*((this._nRounds=c+6)+1),e=this._keySchedule=[],f=0;f<a;f++)if(f<c)e[f]=b[f];else{var g=e[f-1];f%c?6<c&&4==f%c&&(g=d[g>>>24]<<24|d[g>>>16&255]<<16|d[g>>>8&255]<<8|d[255&g]):(g=g<<8|g>>>24,g=d[g>>>24]<<24|d[g>>>16&255]<<16|d[g>>>8&255]<<8|d[255&g],g^=w[f/c|0]<<24),e[f]=e[f-c]^g}for(b=this._invKeySchedule=[],c=0;c<a;c++)f=a-c,g=c%4?e[f]:e[f-4],b[c]=4>c||4>=f?g:j[d[g>>>24]]^k[d[g>>>16&255]]^l[d[g>>>8&255]]^m[d[255&g]]},encryptBlock:function(a,b){this._doCryptBlock(a,b,this._keySchedule,f,g,h,i,d)},decryptBlock:function(a,b){var c=a[b+1];a[b+1]=a[b+3],a[b+3]=c,this._doCryptBlock(a,b,this._invKeySchedule,j,k,l,m,e),c=a[b+1],a[b+1]=a[b+3],a[b+3]=c},_doCryptBlock:function(a,b,c,d,e,f,g,h){for(var i=this._nRounds,j=a[b]^c[0],k=a[b+1]^c[1],l=a[b+2]^c[2],m=a[b+3]^c[3],n=4,o=1;o<i;o++)var p=d[j>>>24]^e[k>>>16&255]^f[l>>>8&255]^g[255&m]^c[n++],q=d[k>>>24]^e[l>>>16&255]^f[m>>>8&255]^g[255&j]^c[n++],r=d[l>>>24]^e[m>>>16&255]^f[j>>>8&255]^g[255&k]^c[n++],m=d[m>>>24]^e[j>>>16&255]^f[k>>>8&255]^g[255&l]^c[n++],j=p,k=q,l=r;p=(h[j>>>24]<<24|h[k>>>16&255]<<16|h[l>>>8&255]<<8|h[255&m])^c[n++],q=(h[k>>>24]<<24|h[l>>>16&255]<<16|h[m>>>8&255]<<8|h[255&j])^c[n++],r=(h[l>>>24]<<24|h[m>>>16&255]<<16|h[j>>>8&255]<<8|h[255&k])^c[n++],m=(h[m>>>24]<<24|h[j>>>16&255]<<16|h[k>>>8&255]<<8|h[255&l])^c[n++],a[b]=p,a[b+1]=q,a[b+2]=r,a[b+3]=m},keySize:8});a.AES=b._createHelper(c)}(),function(){function a(a,b){var c=(this._lBlock>>>a^this._rBlock)&b;this._rBlock^=c,this._lBlock^=c<<a}function b(a,b){var c=(this._rBlock>>>a^this._lBlock)&b;this._lBlock^=c,this._rBlock^=c<<a}var c=CryptoJS,d=c.lib,e=d.WordArray,d=d.BlockCipher,f=c.algo,g=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],h=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],i=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],j=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],k=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],l=f.DES=d.extend({_doReset:function(){for(var a=this._key.words,b=[],c=0;56>c;c++){var d=g[c]-1;b[c]=a[d>>>5]>>>31-d%32&1}for(a=this._subKeys=[],d=0;16>d;d++){for(var e=a[d]=[],f=i[d],c=0;24>c;c++)e[c/6|0]|=b[(h[c]-1+f)%28]<<31-c%6,e[4+(c/6|0)]|=b[28+(h[c+24]-1+f)%28]<<31-c%6;for(e[0]=e[0]<<1|e[0]>>>31,c=1;7>c;c++)e[c]>>>=4*(c-1)+3;e[7]=e[7]<<5|e[7]>>>27}for(b=this._invSubKeys=[],c=0;16>c;c++)b[c]=a[15-c]},encryptBlock:function(a,b){this._doCryptBlock(a,b,this._subKeys)},decryptBlock:function(a,b){this._doCryptBlock(a,b,this._invSubKeys)},_doCryptBlock:function(c,d,e){this._lBlock=c[d],this._rBlock=c[d+1],a.call(this,4,252645135),a.call(this,16,65535),b.call(this,2,858993459),b.call(this,8,16711935),a.call(this,1,1431655765);for(var f=0;16>f;f++){for(var g=e[f],h=this._lBlock,i=this._rBlock,l=0,m=0;8>m;m++)l|=j[m][((i^g[m])&k[m])>>>0];this._lBlock=i,this._rBlock=h^l}e=this._lBlock,this._lBlock=this._rBlock,this._rBlock=e,a.call(this,1,1431655765),b.call(this,8,16711935),b.call(this,2,858993459),a.call(this,16,65535),a.call(this,4,252645135),c[d]=this._lBlock,c[d+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});c.DES=d._createHelper(l),f=f.TripleDES=d.extend({_doReset:function(){var a=this._key.words;this._des1=l.createEncryptor(e.create(a.slice(0,2))),this._des2=l.createEncryptor(e.create(a.slice(2,4))),this._des3=l.createEncryptor(e.create(a.slice(4,6)))},encryptBlock:function(a,b){this._des1.encryptBlock(a,b),this._des2.decryptBlock(a,b),this._des3.encryptBlock(a,b)},decryptBlock:function(a,b){this._des3.decryptBlock(a,b),this._des2.encryptBlock(a,b),this._des1.decryptBlock(a,b)},keySize:6,ivSize:2,blockSize:2}),c.TripleDES=d._createHelper(f)}(),function(){var a=CryptoJS,b=a.lib,c=b.WordArray,d=b.Hasher,e=[],b=a.algo.SHA1=d.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],f=c[1],g=c[2],h=c[3],i=c[4],j=0;80>j;j++){if(16>j)e[j]=0|a[b+j];else{var k=e[j-3]^e[j-8]^e[j-14]^e[j-16];e[j]=k<<1|k>>>31}k=(d<<5|d>>>27)+i+e[j],k=20>j?k+((f&g|~f&h)+1518500249):40>j?k+((f^g^h)+1859775393):60>j?k+((f&g|f&h|g&h)-1894007588):k+((f^g^h)-899497514),i=h,h=g,g=f<<30|f>>>2,f=d,d=k}c[0]=c[0]+d|0,c[1]=c[1]+f|0,c[2]=c[2]+g|0,c[3]=c[3]+h|0,c[4]=c[4]+i|0},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;return b[d>>>5]|=128<<24-d%32,b[(d+64>>>9<<4)+14]=Math.floor(c/4294967296),b[(d+64>>>9<<4)+15]=c,a.sigBytes=4*b.length,this._process(),this._hash},clone:function(){var a=d.clone.call(this);return a._hash=this._hash.clone(),a}});a.SHA1=d._createHelper(b),a.HmacSHA1=d._createHmacHelper(b)}(),function(){var a=CryptoJS,b=a.lib,c=b.WordArray,d=b.Hasher,b=a.algo,e=c.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),f=c.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),g=c.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),h=c.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),i=c.create([0,1518500249,1859775393,2400959708,2840853838]),j=c.create([1352829926,1548603684,1836072691,2053994217,0]),b=b.RIPEMD160=d.extend({_doReset:function(){this._hash=c.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,b){for(var c=0;16>c;c++){var d=b+c,k=a[d];a[d]=16711935&(k<<8|k>>>24)|4278255360&(k<<24|k>>>8)}var l,m,n,o,p,q,r,s,t,u,d=this._hash.words,k=i.words,v=j.words,w=e.words,x=f.words,y=g.words,z=h.words;
q=l=d[0],r=m=d[1],s=n=d[2],t=o=d[3],u=p=d[4];for(var A,c=0;80>c;c+=1)A=l+a[b+w[c]]|0,A=16>c?A+((m^n^o)+k[0]):32>c?A+((m&n|~m&o)+k[1]):48>c?A+(((m|~n)^o)+k[2]):64>c?A+((m&o|n&~o)+k[3]):A+((m^(n|~o))+k[4]),A|=0,A=A<<y[c]|A>>>32-y[c],A=A+p|0,l=p,p=o,o=n<<10|n>>>22,n=m,m=A,A=q+a[b+x[c]]|0,A=16>c?A+((r^(s|~t))+v[0]):32>c?A+((r&t|s&~t)+v[1]):48>c?A+(((r|~s)^t)+v[2]):64>c?A+((r&s|~r&t)+v[3]):A+((r^s^t)+v[4]),A|=0,A=A<<z[c]|A>>>32-z[c],A=A+u|0,q=u,u=t,t=s<<10|s>>>22,s=r,r=A;A=d[1]+n+t|0,d[1]=d[2]+o+u|0,d[2]=d[3]+p+q|0,d[3]=d[4]+l+r|0,d[4]=d[0]+m+s|0,d[0]=A},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;for(b[d>>>5]|=128<<24-d%32,b[(d+64>>>9<<4)+14]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8),a.sigBytes=4*(b.length+1),this._process(),a=this._hash,b=a.words,c=0;5>c;c++)d=b[c],b[c]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8);return a},clone:function(){var a=d.clone.call(this);return a._hash=this._hash.clone(),a}});a.RIPEMD160=d._createHelper(b),a.HmacRIPEMD160=d._createHmacHelper(b)}(Math),function(){var a=CryptoJS,b=a.lib,c=b.Base,d=b.WordArray,b=a.algo,e=b.HMAC,f=b.PBKDF2=c.extend({cfg:c.extend({keySize:4,hasher:b.SHA1,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,b){for(var c=this.cfg,f=e.create(c.hasher,a),g=d.create(),h=d.create([1]),i=g.words,j=h.words,k=c.keySize,c=c.iterations;i.length<k;){var l=f.update(b).finalize(h);f.reset();for(var m=l.words,n=m.length,o=l,p=1;p<c;p++){o=f.finalize(o),f.reset();for(var q=o.words,r=0;r<n;r++)m[r]^=q[r]}g.concat(l),j[0]++}return g.sigBytes=4*k,g}});a.PBKDF2=function(a,b,c){return f.create(c).compute(a,b)}}();var b64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64pad="=",dbits,canary=0xdeadbeefcafe,j_lm=15715070==(16777215&canary);j_lm&&"Microsoft Internet Explorer"==navigator.appName?(BigInteger.prototype.am=am2,dbits=30):j_lm&&"Netscape"!=navigator.appName?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28),BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP),BigInteger.prototype.F1=BI_FP-dbits,BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=new Array,rr,vv;for(rr="0".charCodeAt(0),vv=0;vv<=9;++vv)BI_RC[rr++]=vv;for(rr="a".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;for(rr="A".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;Classic.prototype.convert=cConvert,Classic.prototype.revert=cRevert,Classic.prototype.reduce=cReduce,Classic.prototype.mulTo=cMulTo,Classic.prototype.sqrTo=cSqrTo,Montgomery.prototype.convert=montConvert,Montgomery.prototype.revert=montRevert,Montgomery.prototype.reduce=montReduce,Montgomery.prototype.mulTo=montMulTo,Montgomery.prototype.sqrTo=montSqrTo,BigInteger.prototype.copyTo=bnpCopyTo,BigInteger.prototype.fromInt=bnpFromInt,BigInteger.prototype.fromString=bnpFromString,BigInteger.prototype.clamp=bnpClamp,BigInteger.prototype.dlShiftTo=bnpDLShiftTo,BigInteger.prototype.drShiftTo=bnpDRShiftTo,BigInteger.prototype.lShiftTo=bnpLShiftTo,BigInteger.prototype.rShiftTo=bnpRShiftTo,BigInteger.prototype.subTo=bnpSubTo,BigInteger.prototype.multiplyTo=bnpMultiplyTo,BigInteger.prototype.squareTo=bnpSquareTo,BigInteger.prototype.divRemTo=bnpDivRemTo,BigInteger.prototype.invDigit=bnpInvDigit,BigInteger.prototype.isEven=bnpIsEven,BigInteger.prototype.exp=bnpExp,BigInteger.prototype.toString=bnToString,BigInteger.prototype.negate=bnNegate,BigInteger.prototype.abs=bnAbs,BigInteger.prototype.compareTo=bnCompareTo,BigInteger.prototype.bitLength=bnBitLength,BigInteger.prototype.mod=bnMod,BigInteger.prototype.modPowInt=bnModPowInt,BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1),NullExp.prototype.convert=nNop,NullExp.prototype.revert=nNop,NullExp.prototype.mulTo=nMulTo,NullExp.prototype.sqrTo=nSqrTo,Barrett.prototype.convert=barrettConvert,Barrett.prototype.revert=barrettRevert,Barrett.prototype.reduce=barrettReduce,Barrett.prototype.mulTo=barrettMulTo,Barrett.prototype.sqrTo=barrettSqrTo;var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],lplim=(1<<26)/lowprimes[lowprimes.length-1];BigInteger.prototype.chunkSize=bnpChunkSize,BigInteger.prototype.toRadix=bnpToRadix,BigInteger.prototype.fromRadix=bnpFromRadix,BigInteger.prototype.fromNumber=bnpFromNumber,BigInteger.prototype.bitwiseTo=bnpBitwiseTo,BigInteger.prototype.changeBit=bnpChangeBit,BigInteger.prototype.addTo=bnpAddTo,BigInteger.prototype.dMultiply=bnpDMultiply,BigInteger.prototype.dAddOffset=bnpDAddOffset,BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo,BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo,BigInteger.prototype.modInt=bnpModInt,BigInteger.prototype.millerRabin=bnpMillerRabin,BigInteger.prototype.clone=bnClone,BigInteger.prototype.intValue=bnIntValue,BigInteger.prototype.byteValue=bnByteValue,BigInteger.prototype.shortValue=bnShortValue,BigInteger.prototype.signum=bnSigNum,BigInteger.prototype.toByteArray=bnToByteArray,BigInteger.prototype.equals=bnEquals,BigInteger.prototype.min=bnMin,BigInteger.prototype.max=bnMax,BigInteger.prototype.and=bnAnd,BigInteger.prototype.or=bnOr,BigInteger.prototype.xor=bnXor,BigInteger.prototype.andNot=bnAndNot,BigInteger.prototype.not=bnNot,BigInteger.prototype.shiftLeft=bnShiftLeft,BigInteger.prototype.shiftRight=bnShiftRight,BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit,BigInteger.prototype.bitCount=bnBitCount,BigInteger.prototype.testBit=bnTestBit,BigInteger.prototype.setBit=bnSetBit,BigInteger.prototype.clearBit=bnClearBit,BigInteger.prototype.flipBit=bnFlipBit,BigInteger.prototype.add=bnAdd,BigInteger.prototype.subtract=bnSubtract,BigInteger.prototype.multiply=bnMultiply,BigInteger.prototype.divide=bnDivide,BigInteger.prototype.remainder=bnRemainder,BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder,BigInteger.prototype.modPow=bnModPow,BigInteger.prototype.modInverse=bnModInverse,BigInteger.prototype.pow=bnPow,BigInteger.prototype.gcd=bnGCD,BigInteger.prototype.isProbablePrime=bnIsProbablePrime,BigInteger.prototype.square=bnSquare,Arcfour.prototype.init=ARC4init,Arcfour.prototype.next=ARC4next;var rng_psize=256,rng_state,rng_pool,rng_pptr;if(null==rng_pool){rng_pool=new Array,rng_pptr=0;var t;if("Netscape"==navigator.appName&&navigator.appVersion<"5"&&window.crypto){var z=window.crypto.random(32);for(t=0;t<z.length;++t)rng_pool[rng_pptr++]=255&z.charCodeAt(t)}for(;rng_pptr<rng_psize;)t=Math.floor(65536*Math.random()),rng_pool[rng_pptr++]=t>>>8,rng_pool[rng_pptr++]=255&t;rng_pptr=0,rng_seed_time()}SecureRandom.prototype.nextBytes=rng_get_bytes;var SHA1_SIZE=20;RSAKey.prototype.doPublic=RSADoPublic,RSAKey.prototype.setPublic=RSASetPublic,RSAKey.prototype.encrypt=RSAEncrypt,RSAKey.prototype.encryptOAEP=RSAEncryptOAEP,RSAKey.prototype.type="RSA";var SHA1_SIZE=20;RSAKey.prototype.doPrivate=RSADoPrivate,RSAKey.prototype.setPrivate=RSASetPrivate,RSAKey.prototype.setPrivateEx=RSASetPrivateEx,RSAKey.prototype.generate=RSAGenerate,RSAKey.prototype.decrypt=RSADecrypt,RSAKey.prototype.decryptOAEP=RSADecryptOAEP,ECFieldElementFp.prototype.equals=feFpEquals,ECFieldElementFp.prototype.toBigInteger=feFpToBigInteger,ECFieldElementFp.prototype.negate=feFpNegate,ECFieldElementFp.prototype.add=feFpAdd,ECFieldElementFp.prototype.subtract=feFpSubtract,ECFieldElementFp.prototype.multiply=feFpMultiply,ECFieldElementFp.prototype.square=feFpSquare,ECFieldElementFp.prototype.divide=feFpDivide,ECPointFp.prototype.getX=pointFpGetX,ECPointFp.prototype.getY=pointFpGetY,ECPointFp.prototype.equals=pointFpEquals,ECPointFp.prototype.isInfinity=pointFpIsInfinity,ECPointFp.prototype.negate=pointFpNegate,ECPointFp.prototype.add=pointFpAdd,ECPointFp.prototype.twice=pointFpTwice,ECPointFp.prototype.multiply=pointFpMultiply,ECPointFp.prototype.multiplyTwo=pointFpMultiplyTwo,ECCurveFp.prototype.getQ=curveFpGetQ,ECCurveFp.prototype.getA=curveFpGetA,ECCurveFp.prototype.getB=curveFpGetB,ECCurveFp.prototype.equals=curveFpEquals,ECCurveFp.prototype.getInfinity=curveFpGetInfinity,ECCurveFp.prototype.fromBigInteger=curveFpFromBigInteger,ECCurveFp.prototype.decodePointHex=curveFpDecodePointHex,ECFieldElementFp.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},ECPointFp.prototype.getEncoded=function(a){var b=function(a,b){var c=a.toByteArrayUnsigned();if(b<c.length)c=c.slice(c.length-b);else for(;b>c.length;)c.unshift(0);return c},c=this.getX().toBigInteger(),d=this.getY().toBigInteger(),e=b(c,32);return a?d.isEven()?e.unshift(2):e.unshift(3):(e.unshift(4),e=e.concat(b(d,32))),e},ECPointFp.decodeFrom=function(a,b){var c=(b[0],b.length-1),d=b.slice(1,1+c/2),e=b.slice(1+c/2,1+c);d.unshift(0),e.unshift(0);var f=new BigInteger(d),g=new BigInteger(e);return new ECPointFp(a,a.fromBigInteger(f),a.fromBigInteger(g))},ECPointFp.decodeFromHex=function(a,b){var c=(b.substr(0,2),b.length-2),d=b.substr(2,c/2),e=b.substr(2+c/2,c/2),f=new BigInteger(d,16),g=new BigInteger(e,16);return new ECPointFp(a,a.fromBigInteger(f),a.fromBigInteger(g))},ECPointFp.prototype.add2D=function(a){if(this.isInfinity())return a;if(a.isInfinity())return this;if(this.x.equals(a.x))return this.y.equals(a.y)?this.twice():this.curve.getInfinity();var b=a.x.subtract(this.x),c=a.y.subtract(this.y),d=c.divide(b),e=d.square().subtract(this.x).subtract(a.x),f=d.multiply(this.x.subtract(e)).subtract(this.y);return new ECPointFp(this.curve,e,f)},ECPointFp.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var a=this.curve.fromBigInteger(BigInteger.valueOf(2)),b=this.curve.fromBigInteger(BigInteger.valueOf(3)),c=this.x.square().multiply(b).add(this.curve.a).divide(this.y.multiply(a)),d=c.square().subtract(this.x.multiply(a)),e=c.multiply(this.x.subtract(d)).subtract(this.y);return new ECPointFp(this.curve,d,e)},ECPointFp.prototype.multiply2D=function(a){if(this.isInfinity())return this;if(0==a.signum())return this.curve.getInfinity();var b,c=a,d=c.multiply(new BigInteger("3")),e=this.negate(),f=this;for(b=d.bitLength()-2;b>0;--b){f=f.twice();var g=d.testBit(b),h=c.testBit(b);g!=h&&(f=f.add2D(g?this:e))}return f},ECPointFp.prototype.isOnCurve=function(){var a=this.getX().toBigInteger(),b=this.getY().toBigInteger(),c=this.curve.getA().toBigInteger(),d=this.curve.getB().toBigInteger(),e=this.curve.getQ(),f=b.multiply(b).mod(e),g=a.multiply(a).multiply(a).add(c.multiply(a)).add(d).mod(e);return f.equals(g)},ECPointFp.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},ECPointFp.prototype.validate=function(){var a=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var b=this.getX().toBigInteger(),c=this.getY().toBigInteger();if(b.compareTo(BigInteger.ONE)<0||b.compareTo(a.subtract(BigInteger.ONE))>0)throw new Error("x coordinate out of bounds");if(c.compareTo(BigInteger.ONE)<0||c.compareTo(a.subtract(BigInteger.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(a).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0},"undefined"!=typeof KJUR&&KJUR||(KJUR={}),"undefined"!=typeof KJUR.asn1&&KJUR.asn1||(KJUR.asn1={}),KJUR.asn1.ASN1Util=new function(){this.integerToByteHex=function(a){var b=a.toString(16);return b.length%2==1&&(b="0"+b),b},this.bigIntToMinTwosComplementsHex=function(a){var b=a.toString(16);if("-"!=b.substr(0,1))b.length%2==1?b="0"+b:b.match(/^[0-7]/)||(b="00"+b);else{var c=b.substr(1),d=c.length;d%2==1?d+=1:b.match(/^[0-7]/)||(d+=2);for(var e="",f=0;f<d;f++)e+="f";var g=new BigInteger(e,16),h=g.xor(a).add(BigInteger.ONE);b=h.toString(16).replace(/^-/,"")}return b},this.getPEMStringFromHex=function(a,b){var c=(KJUR.asn1,CryptoJS.enc.Hex.parse(a)),d=CryptoJS.enc.Base64.stringify(c),e=d.replace(/(.{64})/g,"$1\r\n");return e=e.replace(/\r\n$/,""),"-----BEGIN "+b+"-----\r\n"+e+"\r\n-----END "+b+"-----\r\n"},this.newObject=function(a){var b=KJUR.asn1,c=Object.keys(a);if(1!=c.length)throw"key of param shall be only one.";var d=c[0];if(":bool:int:bitstr:octstr:null:oid:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+d+":")==-1)throw"undefined key: "+d;if("bool"==d)return new b.DERBoolean(a[d]);if("int"==d)return new b.DERInteger(a[d]);if("bitstr"==d)return new b.DERBitString(a[d]);if("octstr"==d)return new b.DEROctetString(a[d]);if("null"==d)return new b.DERNull(a[d]);if("oid"==d)return new b.DERObjectIdentifier(a[d]);if("utf8str"==d)return new b.DERUTF8String(a[d]);if("numstr"==d)return new b.DERNumericString(a[d]);if("prnstr"==d)return new b.DERPrintableString(a[d]);if("telstr"==d)return new b.DERTeletexString(a[d]);if("ia5str"==d)return new b.DERIA5String(a[d]);if("utctime"==d)return new b.DERUTCTime(a[d]);if("gentime"==d)return new b.DERGeneralizedTime(a[d]);if("seq"==d){for(var e=a[d],f=[],g=0;g<e.length;g++){var h=b.ASN1Util.newObject(e[g]);f.push(h)}return new b.DERSequence({array:f})}if("set"==d){for(var e=a[d],f=[],g=0;g<e.length;g++){var h=b.ASN1Util.newObject(e[g]);f.push(h)}return new b.DERSet({array:f})}if("tag"==d){var i={};if(void 0!==a[d].explicit&&(i.explicit=a[d].explicit),void 0!==a[d].tag&&(i.tag=a[d].tag),void 0===a[d].obj)throw"obj shall be specified for 'tag'.";return i.obj=b.ASN1Util.newObject(a[d].obj),new b.DERTaggedObject(i)}}},KJUR.asn1.ASN1Object=function(){var a="";this.getLengthHexFromValue=function(){if("undefined"==typeof this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+a.length+",v="+this.hV;var b=this.hV.length/2,c=b.toString(16);if(c.length%2==1&&(c="0"+c),b<128)return c;var d=c.length/2;if(d>15)throw"ASN.1 length too long to represent by 8x: n = "+b.toString(16);var e=128+d;return e.toString(16)+c},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},KJUR.asn1.DERAbstractString=function(a){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);this.getString=function(){return this.s},this.setString=function(a){this.hTLV=null,this.isModified=!0,this.s=a,this.hV=stohex(this.s)},this.setStringHex=function(a){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=a},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof a&&("string"==typeof a?this.setString(a):"undefined"!=typeof a.str?this.setString(a.str):"undefined"!=typeof a.hex&&this.setStringHex(a.hex))},YAHOO.lang.extend(KJUR.asn1.DERAbstractString,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractTime=function(a){KJUR.asn1.DERAbstractTime.superclass.constructor.call(this);this.localDateToUTC=function(a){utc=a.getTime()+6e4*a.getTimezoneOffset();var b=new Date(utc);return b},this.formatDate=function(a,b){var c=this.zeroPadding,d=this.localDateToUTC(a),e=String(d.getFullYear());"utc"==b&&(e=e.substr(2,2));var f=c(String(d.getMonth()+1),2),g=c(String(d.getDate()),2),h=c(String(d.getHours()),2),i=c(String(d.getMinutes()),2),j=c(String(d.getSeconds()),2);return e+f+g+h+i+j+"Z"},this.zeroPadding=function(a,b){return a.length>=b?a:new Array(b-a.length+1).join("0")+a},this.getString=function(){return this.s},this.setString=function(a){this.hTLV=null,this.isModified=!0,this.s=a,this.hV=stohex(a)},this.setByDateValue=function(a,b,c,d,e,f){var g=new Date(Date.UTC(a,b-1,c,d,e,f,0));this.setByDate(g)},this.getFreshValueHex=function(){return this.hV}},YAHOO.lang.extend(KJUR.asn1.DERAbstractTime,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractStructured=function(a){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);this.setByASN1ObjectArray=function(a){this.hTLV=null,this.isModified=!0,this.asn1Array=a},this.appendASN1Object=function(a){this.hTLV=null,this.isModified=!0,this.asn1Array.push(a)},this.asn1Array=new Array,"undefined"!=typeof a&&"undefined"!=typeof a.array&&(this.asn1Array=a.array)},YAHOO.lang.extend(KJUR.asn1.DERAbstractStructured,KJUR.asn1.ASN1Object),KJUR.asn1.DERBoolean=function(){KJUR.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},YAHOO.lang.extend(KJUR.asn1.DERBoolean,KJUR.asn1.ASN1Object),KJUR.asn1.DERInteger=function(a){KJUR.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(a){this.hTLV=null,this.isModified=!0,this.hV=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(a)},this.setByInteger=function(a){var b=new BigInteger(String(a),10);this.setByBigInteger(b)},this.setValueHex=function(a){this.hV=a},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof a&&("undefined"!=typeof a.bigint?this.setByBigInteger(a.bigint):"undefined"!=typeof a.int?this.setByInteger(a.int):"number"==typeof a?this.setByInteger(a):"undefined"!=typeof a.hex&&this.setValueHex(a.hex))},YAHOO.lang.extend(KJUR.asn1.DERInteger,KJUR.asn1.ASN1Object),KJUR.asn1.DERBitString=function(a){KJUR.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(a){this.hTLV=null,this.isModified=!0,this.hV=a},this.setUnusedBitsAndHexValue=function(a,b){if(a<0||7<a)throw"unused bits shall be from 0 to 7: u = "+a;var c="0"+a;this.hTLV=null,this.isModified=!0,this.hV=c+b},this.setByBinaryString=function(a){a=a.replace(/0+$/,"");var b=8-a.length%8;8==b&&(b=0);for(var c=0;c<=b;c++)a+="0";for(var d="",c=0;c<a.length-1;c+=8){var e=a.substr(c,8),f=parseInt(e,2).toString(16);1==f.length&&(f="0"+f),d+=f}this.hTLV=null,this.isModified=!0,this.hV="0"+b+d},this.setByBooleanArray=function(a){for(var b="",c=0;c<a.length;c++)b+=1==a[c]?"1":"0";this.setByBinaryString(b)},this.newFalseArray=function(a){for(var b=new Array(a),c=0;c<a;c++)b[c]=!1;return b},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof a&&("string"==typeof a&&a.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(a):"undefined"!=typeof a.hex?this.setHexValueIncludingUnusedBits(a.hex):"undefined"!=typeof a.bin?this.setByBinaryString(a.bin):"undefined"!=typeof a.array&&this.setByBooleanArray(a.array))},YAHOO.lang.extend(KJUR.asn1.DERBitString,KJUR.asn1.ASN1Object),KJUR.asn1.DEROctetString=function(a){KJUR.asn1.DEROctetString.superclass.constructor.call(this,a),this.hT="04"},YAHOO.lang.extend(KJUR.asn1.DEROctetString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNull=function(){KJUR.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},YAHOO.lang.extend(KJUR.asn1.DERNull,KJUR.asn1.ASN1Object),KJUR.asn1.DERObjectIdentifier=function(a){var b=function(a){var b=a.toString(16);return 1==b.length&&(b="0"+b),b},c=function(a){var c="",d=new BigInteger(a,10),e=d.toString(2),f=7-e.length%7;7==f&&(f=0);for(var g="",h=0;h<f;h++)g+="0";e=g+e;for(var h=0;h<e.length-1;h+=7){var i=e.substr(h,7);h!=e.length-7&&(i="1"+i),c+=b(parseInt(i,2))}return c};KJUR.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(a){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=a},this.setValueOidString=function(a){if(!a.match(/^[0-9.]+$/))throw"malformed oid string: "+a;var d="",e=a.split("."),f=40*parseInt(e[0])+parseInt(e[1]);d+=b(f),e.splice(0,2);for(var g=0;g<e.length;g++)d+=c(e[g]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=d},this.setValueName=function(a){if("undefined"==typeof KJUR.asn1.x509.OID.name2oidList[a])throw"DERObjectIdentifier oidName undefined: "+a;var b=KJUR.asn1.x509.OID.name2oidList[a];this.setValueOidString(b)},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof a&&("string"==typeof a&&a.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(a):void 0!==KJUR.asn1.x509.OID.name2oidList[a]?this.setValueOidString(KJUR.asn1.x509.OID.name2oidList[a]):"undefined"!=typeof a.oid?this.setValueOidString(a.oid):"undefined"!=typeof a.hex?this.setValueHex(a.hex):"undefined"!=typeof a.name&&this.setValueName(a.name))},YAHOO.lang.extend(KJUR.asn1.DERObjectIdentifier,KJUR.asn1.ASN1Object),KJUR.asn1.DERUTF8String=function(a){KJUR.asn1.DERUTF8String.superclass.constructor.call(this,a),this.hT="0c"},YAHOO.lang.extend(KJUR.asn1.DERUTF8String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNumericString=function(a){KJUR.asn1.DERNumericString.superclass.constructor.call(this,a),this.hT="12"},YAHOO.lang.extend(KJUR.asn1.DERNumericString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERPrintableString=function(a){KJUR.asn1.DERPrintableString.superclass.constructor.call(this,a),this.hT="13"},YAHOO.lang.extend(KJUR.asn1.DERPrintableString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERTeletexString=function(a){KJUR.asn1.DERTeletexString.superclass.constructor.call(this,a),this.hT="14"},YAHOO.lang.extend(KJUR.asn1.DERTeletexString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERIA5String=function(a){KJUR.asn1.DERIA5String.superclass.constructor.call(this,a),this.hT="16"},YAHOO.lang.extend(KJUR.asn1.DERIA5String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERUTCTime=function(a){KJUR.asn1.DERUTCTime.superclass.constructor.call(this,a),this.hT="17",this.setByDate=function(a){this.hTLV=null,this.isModified=!0,this.date=a,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},"undefined"!=typeof a&&("undefined"!=typeof a.str?this.setString(a.str):"string"==typeof a&&a.match(/^[0-9]{12}Z$/)?this.setString(a):"undefined"!=typeof a.hex?this.setStringHex(a.hex):"undefined"!=typeof a.date&&this.setByDate(a.date))},YAHOO.lang.extend(KJUR.asn1.DERUTCTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERGeneralizedTime=function(a){KJUR.asn1.DERGeneralizedTime.superclass.constructor.call(this,a),this.hT="18",this.setByDate=function(a){this.hTLV=null,this.isModified=!0,this.date=a,this.s=this.formatDate(this.date,"gen"),this.hV=stohex(this.s)},"undefined"!=typeof a&&("undefined"!=typeof a.str?this.setString(a.str):"string"==typeof a&&a.match(/^[0-9]{14}Z$/)?this.setString(a):"undefined"!=typeof a.hex?this.setStringHex(a.hex):"undefined"!=typeof a.date&&this.setByDate(a.date))},YAHOO.lang.extend(KJUR.asn1.DERGeneralizedTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERSequence=function(a){KJUR.asn1.DERSequence.superclass.constructor.call(this,a),this.hT="30",this.getFreshValueHex=function(){for(var a="",b=0;b<this.asn1Array.length;b++){var c=this.asn1Array[b];a+=c.getEncodedHex()}return this.hV=a,this.hV}},YAHOO.lang.extend(KJUR.asn1.DERSequence,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERSet=function(a){KJUR.asn1.DERSet.superclass.constructor.call(this,a),this.hT="31",this.getFreshValueHex=function(){for(var a=new Array,b=0;b<this.asn1Array.length;b++){var c=this.asn1Array[b];a.push(c.getEncodedHex())}return a.sort(),this.hV=a.join(""),this.hV}},YAHOO.lang.extend(KJUR.asn1.DERSet,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERTaggedObject=function(a){KJUR.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(a,b,c){this.hT=b,this.isExplicit=a,this.asn1Object=c,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=c.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,b),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof a&&("undefined"!=typeof a.tag&&(this.hT=a.tag),"undefined"!=typeof a.explicit&&(this.isExplicit=a.explicit),"undefined"!=typeof a.obj&&(this.asn1Object=a.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},YAHOO.lang.extend(KJUR.asn1.DERTaggedObject,KJUR.asn1.ASN1Object);var ASN1HEX=new function(){this.getByteLengthOfL_AtObj=function(a,b){if("8"!=a.substring(b+2,b+3))return 1;var c=parseInt(a.substring(b+3,b+4));return 0==c?-1:0<c&&c<10?c+1:-2},this.getHexOfL_AtObj=function(a,b){var c=this.getByteLengthOfL_AtObj(a,b);return c<1?"":a.substring(b+2,b+2+2*c)},this.getIntOfL_AtObj=function(a,b){var c=this.getHexOfL_AtObj(a,b);if(""==c)return-1;var d;return d=parseInt(c.substring(0,1))<8?new BigInteger(c,16):new BigInteger(c.substring(2),16),d.intValue()},this.getStartPosOfV_AtObj=function(a,b){var c=this.getByteLengthOfL_AtObj(a,b);return c<0?c:b+2*(c+1)},this.getHexOfV_AtObj=function(a,b){var c=this.getStartPosOfV_AtObj(a,b),d=this.getIntOfL_AtObj(a,b);return a.substring(c,c+2*d)},this.getHexOfTLV_AtObj=function(a,b){var c=a.substr(b,2),d=this.getHexOfL_AtObj(a,b),e=this.getHexOfV_AtObj(a,b);return c+d+e},this.getPosOfNextSibling_AtObj=function(a,b){var c=this.getStartPosOfV_AtObj(a,b),d=this.getIntOfL_AtObj(a,b);return c+2*d},this.getPosArrayOfChildren_AtObj=function(a,b){var c=new Array,d=this.getStartPosOfV_AtObj(a,b);c.push(d);for(var e=this.getIntOfL_AtObj(a,b),f=d,g=0;;){var h=this.getPosOfNextSibling_AtObj(a,f);if(null==h||h-d>=2*e)break;if(g>=200)break;c.push(h),f=h,g++}return c},this.getNthChildIndex_AtObj=function(a,b,c){var d=this.getPosArrayOfChildren_AtObj(a,b);return d[c]},this.getDecendantIndexByNthList=function(a,b,c){if(0==c.length)return b;var d=c.shift(),e=this.getPosArrayOfChildren_AtObj(a,b);return this.getDecendantIndexByNthList(a,e[d],c)},this.getDecendantHexTLVByNthList=function(a,b,c){var d=this.getDecendantIndexByNthList(a,b,c);return this.getHexOfTLV_AtObj(a,d)},this.getDecendantHexVByNthList=function(a,b,c){var d=this.getDecendantIndexByNthList(a,b,c);return this.getHexOfV_AtObj(a,d)}};"undefined"!=typeof KJUR&&KJUR||(KJUR={}),"undefined"!=typeof KJUR.asn1&&KJUR.asn1||(KJUR.asn1={}),"undefined"!=typeof KJUR.asn1.x509&&KJUR.asn1.x509||(KJUR.asn1.x509={}),KJUR.asn1.x509.Certificate=function(a){KJUR.asn1.x509.Certificate.superclass.constructor.call(this);this.setRsaPrvKeyByPEMandPass=function(a,b){var c=PKCS5PKEY.getDecryptedKeyHex(a,b),d=new RSAKey;d.readPrivateKeyFromASN1HexString(c),this.rsaPrvKey=d},this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg,sig=new KJUR.crypto.Signature({alg:"SHA1withRSA",prov:"cryptojs/jsrsa"}),sig.initSign(this.rsaPrvKey),sig.updateHex(this.asn1TBSCert.getEncodedHex()),this.hexSig=sig.sign(),this.asn1Sig=new KJUR.asn1.DERBitString({hex:"00"+this.hexSig});var a=new KJUR.asn1.DERSequence({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=a.getEncodedHex(),this.isModified=!1},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},this.getPEMString=function(){var a=this.getEncodedHex(),b=CryptoJS.enc.Hex.parse(a),c=CryptoJS.enc.Base64.stringify(b),d=c.replace(/(.{64})/g,"$1\r\n");return"-----BEGIN CERTIFICATE-----\r\n"+d+"\r\n-----END CERTIFICATE-----\r\n"},"undefined"!=typeof a&&("undefined"!=typeof a.tbscertobj&&(this.asn1TBSCert=a.tbscertobj),"undefined"!=typeof a.rsaprvkey&&(this.rsaPrvKey=a.rsaprvkey),"undefined"!=typeof a.rsaprvpem&&"undefined"!=typeof a.rsaprvpas&&this.setRsaPrvKeyByPEMandPass(a.rsaprvpem,a.rsaprvpas))},YAHOO.lang.extend(KJUR.asn1.x509.Certificate,KJUR.asn1.ASN1Object),KJUR.asn1.x509.TBSCertificate=function(a){KJUR.asn1.x509.TBSCertificate.superclass.constructor.call(this),this._initialize=function(){this.asn1Array=new Array,this.asn1Version=new KJUR.asn1.DERTaggedObject({obj:new KJUR.asn1.DERInteger({int:2})}),this.asn1SerialNumber=null,this.asn1SignatureAlg=null,this.asn1Issuer=null,this.asn1NotBefore=null,this.asn1NotAfter=null,this.asn1Subject=null,this.asn1SubjPKey=null,this.extensionsArray=new Array},this.setSerialNumberByParam=function(a){this.asn1SerialNumber=new KJUR.asn1.DERInteger(a)},this.setSignatureAlgByParam=function(a){this.asn1SignatureAlg=new KJUR.asn1.x509.AlgorithmIdentifier(a)},this.setIssuerByParam=function(a){this.asn1Issuer=new KJUR.asn1.x509.X500Name(a)},this.setNotBeforeByParam=function(a){this.asn1NotBefore=new KJUR.asn1.x509.Time(a)},this.setNotAfterByParam=function(a){this.asn1NotAfter=new KJUR.asn1.x509.Time(a)},this.setSubjectByParam=function(a){this.asn1Subject=new KJUR.asn1.x509.X500Name(a)},this.setSubjectPublicKeyByParam=function(a){this.asn1SubjPKey=new KJUR.asn1.x509.SubjectPublicKeyInfo(a)},this.appendExtension=function(a){this.extensionsArray.push(a)},this.getEncodedHex=function(){if(null==this.asn1NotBefore||null==this.asn1NotAfter)throw"notBefore and/or notAfter not set";var a=new KJUR.asn1.DERSequence({array:[this.asn1NotBefore,this.asn1NotAfter]});if(this.asn1Array=new Array,this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1SerialNumber),this.asn1Array.push(this.asn1SignatureAlg),this.asn1Array.push(this.asn1Issuer),this.asn1Array.push(a),this.asn1Array.push(this.asn1Subject),this.asn1Array.push(this.asn1SubjPKey),this.extensionsArray.length>0){var b=new KJUR.asn1.DERSequence({array:this.extensionsArray}),c=new KJUR.asn1.DERTaggedObject({explicit:!0,tag:"a3",obj:b});this.asn1Array.push(c)}var d=new KJUR.asn1.DERSequence({array:this.asn1Array});return this.hTLV=d.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize()},YAHOO.lang.extend(KJUR.asn1.x509.TBSCertificate,KJUR.asn1.ASN1Object),KJUR.asn1.x509.Extension=function(a){KJUR.asn1.x509.Extension.superclass.constructor.call(this);this.getEncodedHex=function(){var a=new KJUR.asn1.DERObjectIdentifier({oid:this.oid}),b=new KJUR.asn1.DEROctetString({hex:this.getExtnValueHex()}),c=new Array;c.push(a),this.critical&&c.push(new KJUR.asn1.DERBoolean),c.push(b);var d=new KJUR.asn1.DERSequence({array:c});return d.getEncodedHex()},this.critical=!1,"undefined"!=typeof a&&"undefined"!=typeof a.critical&&(this.critical=a.critical)},YAHOO.lang.extend(KJUR.asn1.x509.Extension,KJUR.asn1.ASN1Object),KJUR.asn1.x509.KeyUsage=function(a){KJUR.asn1.x509.KeyUsage.superclass.constructor.call(this,a),this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.15","undefined"!=typeof a&&"undefined"!=typeof a.bin&&(this.asn1ExtnValue=new KJUR.asn1.DERBitString(a))},YAHOO.lang.extend(KJUR.asn1.x509.KeyUsage,KJUR.asn1.x509.Extension),KJUR.asn1.x509.BasicConstraints=function(a){KJUR.asn1.x509.BasicConstraints.superclass.constructor.call(this,a);this.getExtnValueHex=function(){var a=new Array;this.cA&&a.push(new KJUR.asn1.DERBoolean),this.pathLen>-1&&a.push(new KJUR.asn1.DERInteger({int:this.pathLen}));var b=new KJUR.asn1.DERSequence({array:a});return this.asn1ExtnValue=b,this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,"undefined"!=typeof a&&("undefined"!=typeof a.cA&&(this.cA=a.cA),"undefined"!=typeof a.pathLen&&(this.pathLen=a.pathLen))},YAHOO.lang.extend(KJUR.asn1.x509.BasicConstraints,KJUR.asn1.x509.Extension),KJUR.asn1.x509.CRLDistributionPoints=function(a){KJUR.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,a),this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.setByDPArray=function(a){this.asn1ExtnValue=new KJUR.asn1.DERSequence({array:a})},this.setByOneURI=function(a){var b=new KJUR.asn1.x509.GeneralNames([{uri:a}]),c=new KJUR.asn1.x509.DistributionPointName(b),d=new KJUR.asn1.x509.DistributionPoint({dpobj:c});this.setByDPArray([d])},this.oid="2.5.29.31","undefined"!=typeof a&&("undefined"!=typeof a.array?this.setByDPArray(a.array):"undefined"!=typeof a.uri&&this.setByOneURI(a.uri))},YAHOO.lang.extend(KJUR.asn1.x509.CRLDistributionPoints,KJUR.asn1.x509.Extension),KJUR.asn1.x509.ExtKeyUsage=function(a){KJUR.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,a),
this.setPurposeArray=function(a){this.asn1ExtnValue=new KJUR.asn1.DERSequence;for(var b=0;b<a.length;b++){var c=new KJUR.asn1.DERObjectIdentifier(a[b]);this.asn1ExtnValue.appendASN1Object(c)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.37","undefined"!=typeof a&&"undefined"!=typeof a.array&&this.setPurposeArray(a.array)},YAHOO.lang.extend(KJUR.asn1.x509.ExtKeyUsage,KJUR.asn1.x509.Extension),KJUR.asn1.x509.CRL=function(a){KJUR.asn1.x509.CRL.superclass.constructor.call(this);this.setRsaPrvKeyByPEMandPass=function(a,b){var c=PKCS5PKEY.getDecryptedKeyHex(a,b),d=new RSAKey;d.readPrivateKeyFromASN1HexString(c),this.rsaPrvKey=d},this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCertList.asn1SignatureAlg,sig=new KJUR.crypto.Signature({alg:"SHA1withRSA",prov:"cryptojs/jsrsa"}),sig.initSign(this.rsaPrvKey),sig.updateHex(this.asn1TBSCertList.getEncodedHex()),this.hexSig=sig.sign(),this.asn1Sig=new KJUR.asn1.DERBitString({hex:"00"+this.hexSig});var a=new KJUR.asn1.DERSequence({array:[this.asn1TBSCertList,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=a.getEncodedHex(),this.isModified=!1},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},this.getPEMString=function(){var a=this.getEncodedHex(),b=CryptoJS.enc.Hex.parse(a),c=CryptoJS.enc.Base64.stringify(b),d=c.replace(/(.{64})/g,"$1\r\n");return"-----BEGIN X509 CRL-----\r\n"+d+"\r\n-----END X509 CRL-----\r\n"},"undefined"!=typeof a&&("undefined"!=typeof a.tbsobj&&(this.asn1TBSCertList=a.tbsobj),"undefined"!=typeof a.rsaprvkey&&(this.rsaPrvKey=a.rsaprvkey),"undefined"!=typeof a.rsaprvpem&&"undefined"!=typeof a.rsaprvpas&&this.setRsaPrvKeyByPEMandPass(a.rsaprvpem,a.rsaprvpas))},YAHOO.lang.extend(KJUR.asn1.x509.CRL,KJUR.asn1.ASN1Object),KJUR.asn1.x509.TBSCertList=function(a){KJUR.asn1.x509.TBSCertList.superclass.constructor.call(this);this.setSignatureAlgByParam=function(a){this.asn1SignatureAlg=new KJUR.asn1.x509.AlgorithmIdentifier(a)},this.setIssuerByParam=function(a){this.asn1Issuer=new KJUR.asn1.x509.X500Name(a)},this.setThisUpdateByParam=function(a){this.asn1ThisUpdate=new KJUR.asn1.x509.Time(a)},this.setNextUpdateByParam=function(a){this.asn1NextUpdate=new KJUR.asn1.x509.Time(a)},this.addRevokedCert=function(a,b){var c={};void 0!=a&&null!=a&&(c.sn=a),void 0!=b&&null!=b&&(c.time=b);var d=new KJUR.asn1.x509.CRLEntry(c);this.aRevokedCert.push(d)},this.getEncodedHex=function(){if(this.asn1Array=new Array,null!=this.asn1Version&&this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1SignatureAlg),this.asn1Array.push(this.asn1Issuer),this.asn1Array.push(this.asn1ThisUpdate),null!=this.asn1NextUpdate&&this.asn1Array.push(this.asn1NextUpdate),this.aRevokedCert.length>0){var a=new KJUR.asn1.DERSequence({array:this.aRevokedCert});this.asn1Array.push(a)}var b=new KJUR.asn1.DERSequence({array:this.asn1Array});return this.hTLV=b.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize=function(){this.asn1Version=null,this.asn1SignatureAlg=null,this.asn1Issuer=null,this.asn1ThisUpdate=null,this.asn1NextUpdate=null,this.aRevokedCert=new Array},this._initialize()},YAHOO.lang.extend(KJUR.asn1.x509.TBSCertList,KJUR.asn1.ASN1Object),KJUR.asn1.x509.CRLEntry=function(a){KJUR.asn1.x509.CRLEntry.superclass.constructor.call(this);this.setCertSerial=function(a){this.sn=new KJUR.asn1.DERInteger(a)},this.setRevocationDate=function(a){this.time=new KJUR.asn1.x509.Time(a)},this.getEncodedHex=function(){var a=new KJUR.asn1.DERSequence({array:[this.sn,this.time]});return this.TLV=a.getEncodedHex(),this.TLV},"undefined"!=typeof a&&("undefined"!=typeof a.time&&this.setRevocationDate(a.time),"undefined"!=typeof a.sn&&this.setCertSerial(a.sn))},YAHOO.lang.extend(KJUR.asn1.x509.CRLEntry,KJUR.asn1.ASN1Object),KJUR.asn1.x509.X500Name=function(a){KJUR.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=new Array,this.setByString=function(a){var b=a.split("/");b.shift();for(var c=0;c<b.length;c++)this.asn1Array.push(new KJUR.asn1.x509.RDN({str:b[c]}))},this.getEncodedHex=function(){var a=new KJUR.asn1.DERSequence({array:this.asn1Array});return this.TLV=a.getEncodedHex(),this.TLV},"undefined"!=typeof a&&"undefined"!=typeof a.str&&this.setByString(a.str)},YAHOO.lang.extend(KJUR.asn1.x509.X500Name,KJUR.asn1.ASN1Object),KJUR.asn1.x509.RDN=function(a){KJUR.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=new Array,this.addByString=function(a){this.asn1Array.push(new KJUR.asn1.x509.AttributeTypeAndValue({str:a}))},this.getEncodedHex=function(){var a=new KJUR.asn1.DERSet({array:this.asn1Array});return this.TLV=a.getEncodedHex(),this.TLV},"undefined"!=typeof a&&"undefined"!=typeof a.str&&this.addByString(a.str)},YAHOO.lang.extend(KJUR.asn1.x509.RDN,KJUR.asn1.ASN1Object),KJUR.asn1.x509.AttributeTypeAndValue=function(a){KJUR.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this);var b="utf8";this.setByString=function(a){if(!a.match(/^([^=]+)=(.+)$/))throw"malformed attrTypeAndValueStr: "+a;this.setByAttrTypeAndValueStr(RegExp.$1,RegExp.$2)},this.setByAttrTypeAndValueStr=function(a,c){this.typeObj=KJUR.asn1.x509.OID.atype2obj(a);var d=b;"C"==a&&(d="prn"),this.valueObj=this.getValueObj(d,c)},this.getValueObj=function(a,b){if("utf8"==a)return new KJUR.asn1.DERUTF8String({str:b});if("prn"==a)return new KJUR.asn1.DERPrintableString({str:b});if("tel"==a)return new KJUR.asn1.DERTeletexString({str:b});if("ia5"==a)return new KJUR.asn1.DERIA5String({str:b});throw"unsupported directory string type: type="+a+" value="+b},this.getEncodedHex=function(){var a=new KJUR.asn1.DERSequence({array:[this.typeObj,this.valueObj]});return this.TLV=a.getEncodedHex(),this.TLV},"undefined"!=typeof a&&"undefined"!=typeof a.str&&this.setByString(a.str)},YAHOO.lang.extend(KJUR.asn1.x509.AttributeTypeAndValue,KJUR.asn1.ASN1Object),KJUR.asn1.x509.SubjectPublicKeyInfo=function(a){KJUR.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);this.setRSAKey=function(a){if(!RSAKey.prototype.isPrototypeOf(a))throw"argument is not RSAKey instance";this.rsaKey=a;var b=new KJUR.asn1.DERInteger({bigint:a.n}),c=new KJUR.asn1.DERInteger({int:a.e}),d=new KJUR.asn1.DERSequence({array:[b,c]}),e=d.getEncodedHex();this.asn1AlgId=new KJUR.asn1.x509.AlgorithmIdentifier({name:"rsaEncryption"}),this.asn1SubjPKey=new KJUR.asn1.DERBitString({hex:"00"+e})},this.setRSAPEM=function(a){if(!a.match(/-----BEGIN PUBLIC KEY-----/))throw"key not supported";var b=a;b=b.replace(/^-----[^-]+-----/,""),b=b.replace(/-----[^-]+-----\s*$/,"");var c=b.replace(/\s+/g,""),d=CryptoJS.enc.Base64.parse(c),e=CryptoJS.enc.Hex.stringify(d),f=_rsapem_getHexValueArrayOfChildrenFromHex(e),g=f[1],h=g.substr(2),i=_rsapem_getHexValueArrayOfChildrenFromHex(h),j=new RSAKey;j.setPublic(i[0],i[1]),this.setRSAKey(j)},this.getEncodedHex=function(){if(null==this.asn1AlgId||null==this.asn1SubjPKey)throw"algId and/or subjPubKey not set";var a=new KJUR.asn1.DERSequence({array:[this.asn1AlgId,this.asn1SubjPKey]});return this.hTLV=a.getEncodedHex(),this.hTLV},"undefined"!=typeof a&&("undefined"!=typeof a.rsakey&&this.setRSAKey(a.rsakey),"undefined"!=typeof a.rsapem&&this.setRSAPEM(a.rsapem))},YAHOO.lang.extend(KJUR.asn1.x509.SubjectPublicKeyInfo,KJUR.asn1.ASN1Object),KJUR.asn1.x509.Time=function(a){KJUR.asn1.x509.Time.superclass.constructor.call(this);this.setTimeParams=function(a){this.timeParams=a},this.getEncodedHex=function(){if(null==this.timeParams)throw"timeParams shall be specified. ({'str':'130403235959Z'}}";var a=null;return a="utc"==this.type?new KJUR.asn1.DERUTCTime(this.timeParams):new KJUR.asn1.DERGeneralizedTime(this.timeParams),this.TLV=a.getEncodedHex(),this.TLV},this.type="utc","undefined"!=typeof a&&("undefined"!=typeof a.type&&(this.type=a.type),this.timeParams=a)},YAHOO.lang.extend(KJUR.asn1.x509.Time,KJUR.asn1.ASN1Object),KJUR.asn1.x509.AlgorithmIdentifier=function(a){KJUR.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this);this.getEncodedHex=function(){if(null==this.nameAlg&&null==this.asn1Alg)throw"algorithm not specified";null!=this.nameAlg&&null==this.asn1Alg&&(this.asn1Alg=KJUR.asn1.x509.OID.name2obj(this.nameAlg));var a=new KJUR.asn1.DERSequence({array:[this.asn1Alg,this.asn1Params]});return this.hTLV=a.getEncodedHex(),this.hTLV},"undefined"!=typeof a&&("undefined"!=typeof a.name&&(this.nameAlg=a.name),"undefined"!=typeof a.asn1params&&(this.asn1Params=a.asn1params)),null==this.asn1Params&&(this.asn1Params=new KJUR.asn1.DERNull)},YAHOO.lang.extend(KJUR.asn1.x509.AlgorithmIdentifier,KJUR.asn1.ASN1Object),KJUR.asn1.x509.GeneralName=function(a){KJUR.asn1.x509.GeneralName.superclass.constructor.call(this);var b={rfc822:"81",dns:"82",uri:"86"};this.setByParam=function(a){var c=null;if("undefined"!=typeof a.rfc822&&(this.type="rfc822",c=new KJUR.asn1.DERIA5String({str:a[this.type]})),"undefined"!=typeof a.dns&&(this.type="dns",c=new KJUR.asn1.DERIA5String({str:a[this.type]})),"undefined"!=typeof a.uri&&(this.type="uri",c=new KJUR.asn1.DERIA5String({str:a[this.type]})),null==this.type)throw"unsupported type in params="+a;this.asn1Obj=new KJUR.asn1.DERTaggedObject({explicit:!1,tag:b[this.type],obj:c})},this.getEncodedHex=function(){return this.asn1Obj.getEncodedHex()},"undefined"!=typeof a&&this.setByParam(a)},YAHOO.lang.extend(KJUR.asn1.x509.GeneralName,KJUR.asn1.ASN1Object),KJUR.asn1.x509.GeneralNames=function(a){KJUR.asn1.x509.GeneralNames.superclass.constructor.call(this);this.setByParamArray=function(a){for(var b=0;b<a.length;b++){var c=new KJUR.asn1.x509.GeneralName(a[b]);this.asn1Array.push(c)}},this.getEncodedHex=function(){var a=new KJUR.asn1.DERSequence({array:this.asn1Array});return a.getEncodedHex()},this.asn1Array=new Array,"undefined"!=typeof a&&this.setByParamArray(a)},YAHOO.lang.extend(KJUR.asn1.x509.GeneralNames,KJUR.asn1.ASN1Object),KJUR.asn1.x509.DistributionPointName=function(a){KJUR.asn1.x509.DistributionPointName.superclass.constructor.call(this);if(this.getEncodedHex=function(){if("full"!=this.type)throw"currently type shall be 'full': "+this.type;return this.asn1Obj=new KJUR.asn1.DERTaggedObject({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.getEncodedHex(),this.hTLV},"undefined"!=typeof a){if(!KJUR.asn1.x509.GeneralNames.prototype.isPrototypeOf(a))throw"This class supports GeneralNames only as argument";this.type="full",this.tag="a0",this.asn1V=a}},YAHOO.lang.extend(KJUR.asn1.x509.DistributionPointName,KJUR.asn1.ASN1Object),KJUR.asn1.x509.DistributionPoint=function(a){KJUR.asn1.x509.DistributionPoint.superclass.constructor.call(this);this.getEncodedHex=function(){var a=new KJUR.asn1.DERSequence;if(null!=this.asn1DP){var b=new KJUR.asn1.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});a.appendASN1Object(b)}return this.hTLV=a.getEncodedHex(),this.hTLV},"undefined"!=typeof a&&"undefined"!=typeof a.dpobj&&(this.asn1DP=a.dpobj)},YAHOO.lang.extend(KJUR.asn1.x509.DistributionPoint,KJUR.asn1.ASN1Object),KJUR.asn1.x509.OID=new function(a){this.atype2oidList={C:"2.5.4.6",O:"2.5.4.10",OU:"2.5.4.11",ST:"2.5.4.8",L:"2.5.4.7",CN:"2.5.4.3"},this.name2oidList={sha384:"2.16.840.1.101.3.4.2.2",sha224:"2.16.840.1.101.3.4.2.4",SHA1withRSA:"1.2.840.113549.1.1.5",rsaEncryption:"1.2.840.113549.1.1.1",subjectKeyIdentifier:"2.5.29.14",countryName:"2.5.4.6",organization:"2.5.4.10",organizationalUnit:"2.5.4.11",stateOrProvinceName:"2.5.4.8",locality:"2.5.4.7",commonName:"2.5.4.3",keyUsage:"2.5.29.15",basicConstraints:"2.5.29.19",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",authorityKeyIdentifier:"2.5.29.35",extKeyUsage:"2.5.29.37",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9"},this.objCache={},this.name2obj=function(a){if("undefined"!=typeof this.objCache[a])return this.objCache[a];if("undefined"==typeof this.name2oidList[a])throw"Name of ObjectIdentifier not defined: "+a;var b=this.name2oidList[a],c=new KJUR.asn1.DERObjectIdentifier({oid:b});return this.objCache[a]=c,c},this.atype2obj=function(a){if("undefined"!=typeof this.objCache[a])return this.objCache[a];if("undefined"==typeof this.atype2oidList[a])throw"AttributeType name undefined: "+a;var b=this.atype2oidList[a],c=new KJUR.asn1.DERObjectIdentifier({oid:b});return this.objCache[a]=c,c}},KJUR.asn1.x509.X509Util=new function(){this.getPKCS8PubKeyPEMfromRSAKey=function(a){var b=null,c=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(a.n),d=KJUR.asn1.ASN1Util.integerToByteHex(a.e),e=new KJUR.asn1.DERInteger({hex:c}),f=new KJUR.asn1.DERInteger({hex:d}),g=new KJUR.asn1.DERSequence({array:[e,f]}),h=g.getEncodedHex(),i=new KJUR.asn1.x509.AlgorithmIdentifier({name:"rsaEncryption"}),j=new KJUR.asn1.DERBitString({hex:"00"+h}),k=new KJUR.asn1.DERSequence({array:[i,j]}),l=k.getEncodedHex(),b=KJUR.asn1.ASN1Util.getPEMStringFromHex(l,"PUBLIC KEY");return b}};var utf8tob64u,b64utoutf8;"function"==typeof Buffer?(utf8tob64u=function(a){return b64tob64u(new Buffer(a,"utf8").toString("base64"))},b64utoutf8=function(a){return new Buffer(b64utob64(a),"base64").toString("utf8")}):(utf8tob64u=function(a){return hextob64u(uricmptohex(encodeURIComponentAll(a)))},b64utoutf8=function(a){return decodeURIComponent(hextouricmp(b64utohex(a)))}),"undefined"!=typeof KJUR&&KJUR||(KJUR={}),"undefined"!=typeof KJUR.crypto&&KJUR.crypto||(KJUR.crypto={}),KJUR.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:"CryptoJS.algo.MD5",sha1:"CryptoJS.algo.SHA1",sha224:"CryptoJS.algo.SHA224",sha256:"CryptoJS.algo.SHA256",sha384:"CryptoJS.algo.SHA384",sha512:"CryptoJS.algo.SHA512",ripemd160:"CryptoJS.algo.RIPEMD160"},this.getDigestInfoHex=function(a,b){if("undefined"==typeof this.DIGESTINFOHEAD[b])throw"alg not supported in Util.DIGESTINFOHEAD: "+b;return this.DIGESTINFOHEAD[b]+a},this.getPaddedDigestInfoHex=function(a,b,c){var d=this.getDigestInfoHex(a,b),e=c/4;if(d.length+22>e)throw"key is too short for SigAlg: keylen="+c+","+b;for(var f="0001",g="00"+d,h="",i=e-f.length-g.length,j=0;j<i;j+=2)h+="ff";var k=f+h+g;return k},this.hashString=function(a,b){var c=new KJUR.crypto.MessageDigest({alg:b});return c.digestString(a)},this.hashHex=function(a,b){var c=new KJUR.crypto.MessageDigest({alg:b});return c.digestHex(a)},this.sha1=function(a){var b=new KJUR.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"});return b.digestString(a)},this.sha256=function(a){var b=new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"});return b.digestString(a)},this.sha256Hex=function(a){var b=new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"});return b.digestHex(a)},this.sha512=function(a){var b=new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"});return b.digestString(a)},this.sha512Hex=function(a){var b=new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"});return b.digestHex(a)},this.md5=function(a){var b=new KJUR.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return b.digestString(a)},this.ripemd160=function(a){var b=new KJUR.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return b.digestString(a)},this.getCryptoJSMDByName=function(a){}},KJUR.crypto.MessageDigest=function(params){var md=null,algName=null,provName=null;this.setAlgAndProvider=function(alg,prov){if(null!=alg&&void 0===prov&&(prov=KJUR.crypto.Util.DEFAULTPROVIDER[alg]),":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(alg)!=-1&&"cryptojs"==prov){try{this.md=eval(KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[alg]).create()}catch(a){throw"setAlgAndProvider hash alg set fail alg="+alg+"/"+a}this.updateString=function(a){this.md.update(a)},this.updateHex=function(a){var b=CryptoJS.enc.Hex.parse(a);this.md.update(b)},this.digest=function(){var a=this.md.finalize();return a.toString(CryptoJS.enc.Hex)},this.digestString=function(a){return this.updateString(a),this.digest()},this.digestHex=function(a){return this.updateHex(a),this.digest()}}if(":sha256:".indexOf(alg)!=-1&&"sjcl"==prov){try{this.md=new sjcl.hash.sha256}catch(a){throw"setAlgAndProvider hash alg set fail alg="+alg+"/"+a}this.updateString=function(a){this.md.update(a)},this.updateHex=function(a){var b=sjcl.codec.hex.toBits(a);this.md.update(b)},this.digest=function(){var a=this.md.finalize();return sjcl.codec.hex.fromBits(a)},this.digestString=function(a){return this.updateString(a),this.digest()},this.digestHex=function(a){return this.updateHex(a),this.digest()}}},this.updateString=function(a){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(a){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(a){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(a){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==params&&void 0!==params.alg&&(this.algName=params.alg,void 0===params.prov&&(this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},KJUR.crypto.Mac=function(params){var mac=null,pass=null,algName=null,provName=null,algProv=null;this.setAlgAndProvider=function(alg,prov){if(null==alg&&(alg="hmacsha1"),alg=alg.toLowerCase(),"hmac"!=alg.substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+alg;void 0===prov&&(prov=KJUR.crypto.Util.DEFAULTPROVIDER[alg]),this.algProv=alg+"/"+prov;var hashAlg=alg.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(hashAlg)!=-1&&"cryptojs"==prov){try{var mdObj=eval(KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[hashAlg]);this.mac=CryptoJS.algo.HMAC.create(mdObj,this.pass)}catch(a){throw"setAlgAndProvider hash alg set fail hashAlg="+hashAlg+"/"+a}this.updateString=function(a){this.mac.update(a)},this.updateHex=function(a){var b=CryptoJS.enc.Hex.parse(a);this.mac.update(b)},this.doFinal=function(){var a=this.mac.finalize();return a.toString(CryptoJS.enc.Hex)},this.doFinalString=function(a){return this.updateString(a),this.doFinal()},this.doFinalHex=function(a){return this.updateHex(a),this.doFinal()}}},this.updateString=function(a){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(a){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(a){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(a){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},void 0!==params&&(void 0!==params.pass&&(this.pass=params.pass),void 0!==params.alg&&(this.algName=params.alg,void 0===params.prov&&(this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},KJUR.crypto.Signature=function(a){var b=null;if(this._setAlgNames=function(){this.algName.match(/^(.+)with(.+)$/)&&(this.mdAlgName=RegExp.$1.toLowerCase(),this.pubkeyAlgName=RegExp.$2.toLowerCase())},this._zeroPaddingOfSignature=function(a,b){for(var c="",d=b/4-a.length,e=0;e<d;e++)c+="0";return c+a},this.setAlgAndProvider=function(a,b){if(this._setAlgNames(),"cryptojs/jsrsa"!=b)throw"provider not supported: "+b;if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new KJUR.crypto.MessageDigest({alg:this.mdAlgName})}catch(a){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+a}this.init=function(a,b){if("string"==typeof a)if(a.indexOf("-END ENCRYPTED PRIVATE KEY-",0)!=-1&&void 0!==b)this.prvKey=PKCS5PKEY.getKeyFromEncryptedPKCS8PEM(a,b),this.state="SIGN";else if(a.indexOf("-END RSA PRIVATE KEY-",0)!=-1&&a.indexOf(",ENCRYPTED",0)!=-1&&void 0!==b)this.prvKey=PKCS5PKEY.getRSAKeyFromEncryptedPKCS5PEM(a,b),this.state="SIGN";else if(a.indexOf("-END RSA PRIVATE KEY-",0)!=-1&&a.indexOf(",ENCRYPTED",0)==-1&&void 0===b)this.prvKey=new RSAKey,this.prvKey.readPrivateKeyFromPEMString(a),this.state="SIGN";else if(a.indexOf("-END PRIVATE KEY-",0)!=-1&&void 0===b)this.prvKey=PKCS5PKEY.getKeyFromPlainPrivatePKCS8PEM(a),this.state="SIGN";else if(a.indexOf("-END PUBLIC KEY-",0)!=-1&&void 0===b)this.pubKey=PKCS5PKEY.getKeyFromPublicPKCS8PEM(a),this.state="VERIFY";else{if(a.indexOf("-END CERTIFICATE-",0)==-1&&a.indexOf("-END X509 CERTIFICATE-",0)==-1&&a.indexOf("-END TRUSTED CERTIFICATE-",0)==-1||void 0!==b)throw"unsupported arguments";this.pubKey=X509.getPublicKeyFromCertPEM(a),this.state="VERIFY"}else if(a instanceof RSAKey)if(null!=a.d)this.prvKey=a,this.state="SIGN";else{if(null==a.n)throw"RSAKey object is not private and public key";this.pubKey=a,this.state="VERIFY"}else if(a instanceof KJUR.crypto.ECDSA)if(null!=a.prvKeyHex)this.prvKey=a,this.state="SIGN";else{if(null==a.pubKeyHex)throw"ECDSA object is not private and public key";this.pubKey=a,this.state="VERIFY"}},this.initSign=function(a){"string"==typeof a.ecprvhex&&"string"==typeof a.eccurvename?(this.ecprvhex=a.ecprvhex,this.eccurvename=a.eccurvename):this.prvKey=a,this.state="SIGN"},this.initVerifyByPublicKey=function(a){"string"==typeof a.ecpubhex&&"string"==typeof a.eccurvename?(this.ecpubhex=a.ecpubhex,this.eccurvename=a.eccurvename):a instanceof KJUR.crypto.ECDSA?this.pubKey=a:a instanceof RSAKey&&(this.pubKey=a),this.state="VERIFY"},this.initVerifyByCertificatePEM=function(a){var b=new X509;b.readCertPEM(a),this.pubKey=b.subjectPublicKeyRSA,this.state="VERIFY"},this.updateString=function(a){this.md.updateString(a)},this.updateHex=function(a){this.md.updateHex(a)},this.sign=function(){if(this.sHashHex=this.md.digest(),"undefined"!=typeof this.ecprvhex&&"undefined"!=typeof this.eccurvename){var a=new KJUR.crypto.ECDSA({curve:this.eccurvename});this.hSign=a.signHex(this.sHashHex,this.ecprvhex)}else if("rsaandmgf1"==this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if("rsa"==this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else{if(!(this.prvKey instanceof KJUR.crypto.ECDSA))throw"Signature: unsupported public key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(a){this.updateString(a),this.sign()},this.signHex=function(a){this.updateHex(a),this.sign()},this.verify=function(a){if(this.sHashHex=this.md.digest(),"undefined"!=typeof this.ecpubhex&&"undefined"!=typeof this.eccurvename){var b=new KJUR.crypto.ECDSA({curve:this.eccurvename});return b.verifyHex(this.sHashHex,a,this.ecpubhex)}if("rsaandmgf1"==this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,a,this.mdAlgName,this.pssSaltLen);if("rsa"==this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,a);if(this.pubKey instanceof KJUR.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,a);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(a,b){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.initVerifyByPublicKey=function(a){throw"initVerifyByPublicKey(rsaPubKeyy) not supported for this alg:prov="+this.algProvName},this.initVerifyByCertificatePEM=function(a){throw"initVerifyByCertificatePEM(certPEM) not supported for this alg:prov="+this.algProvName},this.initSign=function(a){throw"initSign(prvKey) not supported for this alg:prov="+this.algProvName},this.updateString=function(a){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(a){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(a){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(a){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(a){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=a,void 0!==a&&(void 0!==a.alg&&(this.algName=a.alg,void 0===a.prov?this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=a.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==a.psssaltlen&&(this.pssSaltLen=a.psssaltlen),void 0!==a.prvkeypem)){if(void 0!==a.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{var b=new RSAKey;b.readPrivateKeyFromPEMString(a.prvkeypem),this.initSign(b)}catch(a){throw"fatal error to load pem private key: "+a}}},KJUR.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1"}},"undefined"!=typeof KJUR&&KJUR||(KJUR={}),"undefined"!=typeof KJUR.crypto&&KJUR.crypto||(KJUR.crypto={}),KJUR.crypto.ECDSA=function(a){var b="secp256r1",c=new SecureRandom;this.type="EC",this.getBigRandom=function(a){return new BigInteger(a.bitLength(),c).mod(a.subtract(BigInteger.ONE)).add(BigInteger.ONE)},this.setNamedCurve=function(a){this.ecparams=KJUR.crypto.ECParameterDB.getByName(a),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=a},this.setPrivateKeyHex=function(a){this.prvKeyHex=a},this.setPublicKeyHex=function(a){this.pubKeyHex=a},this.generateKeyPairHex=function(){var a=this.ecparams.n,b=this.getBigRandom(a),c=this.ecparams.G.multiply(b),d=c.getX().toBigInteger(),e=c.getY().toBigInteger(),f=this.ecparams.keylen/4,g=("0000000000"+b.toString(16)).slice(-f),h=("0000000000"+d.toString(16)).slice(-f),i=("0000000000"+e.toString(16)).slice(-f),j="04"+h+i;return this.prvKeyHex=g,this.pubKeyHex=j,{ecprvhex:g,ecpubhex:j}},this.signWithMessageHash=function(a){return this.signHex(a,this.prvKeyHex)},this.signHex=function(a,b){var c=new BigInteger(b,16),d=this.ecparams.n,e=new BigInteger(a,16);do var f=this.getBigRandom(d),g=this.ecparams.G,h=g.multiply(f),i=h.getX().toBigInteger().mod(d);while(i.compareTo(BigInteger.ZERO)<=0);var j=f.modInverse(d).multiply(e.add(c.multiply(i))).mod(d);return KJUR.crypto.ECDSA.biRSSigToASN1Sig(i,j)},this.sign=function(a,b){var c=b,d=this.ecparams.n,e=BigInteger.fromByteArrayUnsigned(a);do var f=this.getBigRandom(d),g=this.ecparams.G,h=g.multiply(f),i=h.getX().toBigInteger().mod(d);while(i.compareTo(BigInteger.ZERO)<=0);var j=f.modInverse(d).multiply(e.add(c.multiply(i))).mod(d);return this.serializeSig(i,j)},this.verifyWithMessageHash=function(a,b){return this.verifyHex(a,b,this.pubKeyHex)},this.verifyHex=function(a,b,c){var d,e,f=KJUR.crypto.ECDSA.parseSigHex(b);d=f.r,e=f.s;var g;g=ECPointFp.decodeFromHex(this.ecparams.curve,c);var h=new BigInteger(a,16);return this.verifyRaw(h,d,e,g)},this.verify=function(a,b,c){var d,e;if(Bitcoin.Util.isArray(b)){var f=this.parseSig(b);d=f.r,e=f.s}else{if("object"!=typeof b||!b.r||!b.s)throw"Invalid value for signature";d=b.r,e=b.s}var g;if(c instanceof ECPointFp)g=c;else{if(!Bitcoin.Util.isArray(c))throw"Invalid format for pubkey value, must be byte array or ECPointFp";g=ECPointFp.decodeFrom(this.ecparams.curve,c)}var h=BigInteger.fromByteArrayUnsigned(a);return this.verifyRaw(h,d,e,g)},this.verifyRaw=function(a,b,c,d){var e=this.ecparams.n,f=this.ecparams.G;if(b.compareTo(BigInteger.ONE)<0||b.compareTo(e)>=0)return!1;if(c.compareTo(BigInteger.ONE)<0||c.compareTo(e)>=0)return!1;var g=c.modInverse(e),h=a.multiply(g).mod(e),i=b.multiply(g).mod(e),j=f.multiply(h).add(d.multiply(i)),k=j.getX().toBigInteger().mod(e);return k.equals(b)},this.serializeSig=function(a,b){var c=a.toByteArraySigned(),d=b.toByteArraySigned(),e=[];return e.push(2),e.push(c.length),e=e.concat(c),e.push(2),e.push(d.length),e=e.concat(d),e.unshift(e.length),e.unshift(48),e},this.parseSig=function(a){var b;if(48!=a[0])throw new Error("Signature not a valid DERSequence");if(b=2,2!=a[b])throw new Error("First element in signature must be a DERInteger");var c=a.slice(b+2,b+2+a[b+1]);if(b+=2+a[b+1],2!=a[b])throw new Error("Second element in signature must be a DERInteger");var d=a.slice(b+2,b+2+a[b+1]);b+=2+a[b+1];var e=BigInteger.fromByteArrayUnsigned(c),f=BigInteger.fromByteArrayUnsigned(d);return{r:e,s:f}},this.parseSigCompact=function(a){if(65!==a.length)throw"Signature has the wrong length";var b=a[0]-27;if(b<0||b>7)throw"Invalid signature type";var c=this.ecparams.n,d=BigInteger.fromByteArrayUnsigned(a.slice(1,33)).mod(c),e=BigInteger.fromByteArrayUnsigned(a.slice(33,65)).mod(c);return{r:d,s:e,i:b}},void 0!==a&&void 0!==a.curve&&(this.curveName=a.curve),void 0===this.curveName&&(this.curveName=b),this.setNamedCurve(this.curveName),void 0!==a&&(void 0!==a.prv&&(this.prvKeyHex=a.prv),void 0!==a.pub&&(this.pubKeyHex=a.pub))},KJUR.crypto.ECDSA.parseSigHex=function(a){var b=KJUR.crypto.ECDSA.parseSigHexInHexRS(a),c=new BigInteger(b.r,16),d=new BigInteger(b.s,16);return{r:c,s:d}},KJUR.crypto.ECDSA.parseSigHexInHexRS=function(a){if("30"!=a.substr(0,2))throw"signature is not a ASN.1 sequence";var b=ASN1HEX.getPosArrayOfChildren_AtObj(a,0);if(2!=b.length)throw"number of signature ASN.1 sequence elements seem wrong";var c=b[0],d=b[1];if("02"!=a.substr(c,2))throw"1st item of sequene of signature is not ASN.1 integer";if("02"!=a.substr(d,2))throw"2nd item of sequene of signature is not ASN.1 integer";var e=ASN1HEX.getHexOfV_AtObj(a,c),f=ASN1HEX.getHexOfV_AtObj(a,d);return{r:e,s:f}},KJUR.crypto.ECDSA.asn1SigToConcatSig=function(a){var b=KJUR.crypto.ECDSA.parseSigHexInHexRS(a),c=b.r,d=b.s;if("00"==c.substr(0,2)&&c.length/2*8%128==8&&(c=c.substr(2)),"00"==d.substr(0,2)&&d.length/2*8%128==8&&(d=d.substr(2)),c.length/2*8%128!=0)throw"unknown ECDSA sig r length error";if(d.length/2*8%128!=0)throw"unknown ECDSA sig s length error";return c+d},KJUR.crypto.ECDSA.concatSigToASN1Sig=function(a){if(a.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var b=a.substr(0,a.length/2),c=a.substr(a.length/2);return KJUR.crypto.ECDSA.hexRSSigToASN1Sig(b,c)},KJUR.crypto.ECDSA.hexRSSigToASN1Sig=function(a,b){var c=new BigInteger(a,16),d=new BigInteger(b,16);return KJUR.crypto.ECDSA.biRSSigToASN1Sig(c,d)},KJUR.crypto.ECDSA.biRSSigToASN1Sig=function(a,b){var c=new KJUR.asn1.DERInteger({bigint:a}),d=new KJUR.asn1.DERInteger({bigint:b}),e=new KJUR.asn1.DERSequence({array:[c,d]});return e.getEncodedHex()},"undefined"!=typeof KJUR&&KJUR||(KJUR={}),
"undefined"!=typeof KJUR.crypto&&KJUR.crypto||(KJUR.crypto={}),KJUR.crypto.ECParameterDB=new function(){function a(a){return new BigInteger(a,16)}var b={},c={};this.getByName=function(a){var d=a;if("undefined"!=typeof c[d]&&(d=c[a]),"undefined"!=typeof b[d])return b[d];throw"unregistered EC curve name: "+d},this.regist=function(d,e,f,g,h,i,j,k,l,m,n,o){b[d]={};var p=a(f),q=a(g),r=a(h),s=a(i),t=a(j),u=new ECCurveFp(p,q,r),v=u.decodePointHex("04"+k+l);b[d].name=d,b[d].keylen=e,b[d].curve=u,b[d].G=v,b[d].n=s,b[d].h=t,b[d].oid=n,b[d].info=o;for(var w=0;w<m.length;w++)c[m[w]]=d}},KJUR.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),KJUR.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),KJUR.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),KJUR.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),KJUR.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),KJUR.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),KJUR.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),KJUR.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),KJUR.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),KJUR.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);var PKCS5PKEY=function(){var a=function(a,b,d){return c(CryptoJS.AES,a,b,d)},b=function(a,b,d){return c(CryptoJS.TripleDES,a,b,d)},c=function(a,b,c,d){var e=CryptoJS.enc.Hex.parse(b),f=CryptoJS.enc.Hex.parse(c),g=CryptoJS.enc.Hex.parse(d),h={};h.key=f,h.iv=g,h.ciphertext=e;var i=a.decrypt(h,f,{iv:g});return CryptoJS.enc.Hex.stringify(i)},d=function(a,b,c){return f(CryptoJS.AES,a,b,c)},e=function(a,b,c){return f(CryptoJS.TripleDES,a,b,c)},f=function(a,b,c,d){var e=CryptoJS.enc.Hex.parse(b),f=CryptoJS.enc.Hex.parse(c),g=CryptoJS.enc.Hex.parse(d),h=a.encrypt(e,f,{iv:g}),i=CryptoJS.enc.Hex.parse(h.toString()),j=CryptoJS.enc.Base64.stringify(i);return j},g={"AES-256-CBC":{proc:a,eproc:d,keylen:32,ivlen:16},"AES-192-CBC":{proc:a,eproc:d,keylen:24,ivlen:16},"AES-128-CBC":{proc:a,eproc:d,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:b,eproc:e,keylen:24,ivlen:8}},h=function(a){return g[a].proc},i=function(a){var b=CryptoJS.lib.WordArray.random(a),c=CryptoJS.enc.Hex.stringify(b);return c},j=function(a){var b={};a.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"))&&(b.cipher=RegExp.$1,b.ivsalt=RegExp.$2),a.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"))&&(b.type=RegExp.$1);var c=-1,d=0;a.indexOf("\r\n\r\n")!=-1&&(c=a.indexOf("\r\n\r\n"),d=2),a.indexOf("\n\n")!=-1&&(c=a.indexOf("\n\n"),d=1);var e=a.indexOf("-----END");if(c!=-1&&e!=-1){var f=a.substring(c+2*d,e-d);f=f.replace(/\s+/g,""),b.data=f}return b},k=function(a,b,c){for(var d=c.substring(0,16),e=CryptoJS.enc.Hex.parse(d),f=CryptoJS.enc.Utf8.parse(b),h=g[a].keylen+g[a].ivlen,i="",j=null;;){var k=CryptoJS.algo.MD5.create();if(null!=j&&k.update(j),k.update(f),k.update(e),j=k.finalize(),i+=CryptoJS.enc.Hex.stringify(j),i.length>=2*h)break}var l={};return l.keyhex=i.substr(0,2*g[a].keylen),l.ivhex=i.substr(2*g[a].keylen,2*g[a].ivlen),l},l=function(a,b,c,d){var e=CryptoJS.enc.Base64.parse(a),f=CryptoJS.enc.Hex.stringify(e),h=g[b].proc,i=h(f,c,d);return i},m=function(a,b,c,d){var e=g[b].eproc,f=e(a,c,d);return f};return{version:"1.0.5",getHexFromPEM:function(a,b){var c=a;if(c.indexOf("BEGIN "+b)==-1)throw"can't find PEM header: "+b;c=c.replace("-----BEGIN "+b+"-----",""),c=c.replace("-----END "+b+"-----","");var d=c.replace(/\s+/g,""),e=b64tohex(d);return e},getDecryptedKeyHexByKeyIV:function(a,b,c,d){var e=h(b);return e(a,c,d)},parsePKCS5PEM:function(a){return j(a)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(a,b,c){return k(a,b,c)},decryptKeyB64:function(a,b,c,d){return l(a,b,c,d)},getDecryptedKeyHex:function(a,b){var c=j(a),d=(c.type,c.cipher),e=c.ivsalt,f=c.data,g=k(d,b,e),h=g.keyhex,i=l(f,d,h,e);return i},getRSAKeyFromEncryptedPKCS5PEM:function(a,b){var c=this.getDecryptedKeyHex(a,b),d=new RSAKey;return d.readPrivateKeyFromASN1HexString(c),d},getEryptedPKCS5PEMFromPrvKeyHex:function(a,b,c,d){var e="";if("undefined"!=typeof c&&null!=c||(c="AES-256-CBC"),"undefined"==typeof g[c])throw"PKCS5PKEY unsupported algorithm: "+c;if("undefined"==typeof d||null==d){var f=g[c].ivlen,h=i(f);d=h.toUpperCase()}var j=k(c,b,d),l=j.keyhex,n=m(a,c,l,d),o=n.replace(/(.{64})/g,"$1\r\n"),e="-----BEGIN RSA PRIVATE KEY-----\r\n";return e+="Proc-Type: 4,ENCRYPTED\r\n",e+="DEK-Info: "+c+","+d+"\r\n",e+="\r\n",e+=o,e+="\r\n-----END RSA PRIVATE KEY-----\r\n"},getEryptedPKCS5PEMFromRSAKey:function(a,b,c,d){var e=new KJUR.asn1.DERInteger({int:0}),f=new KJUR.asn1.DERInteger({bigint:a.n}),g=new KJUR.asn1.DERInteger({int:a.e}),h=new KJUR.asn1.DERInteger({bigint:a.d}),i=new KJUR.asn1.DERInteger({bigint:a.p}),j=new KJUR.asn1.DERInteger({bigint:a.q}),k=new KJUR.asn1.DERInteger({bigint:a.dmp1}),l=new KJUR.asn1.DERInteger({bigint:a.dmq1}),m=new KJUR.asn1.DERInteger({bigint:a.coeff}),n=new KJUR.asn1.DERSequence({array:[e,f,g,h,i,j,k,l,m]}),o=n.getEncodedHex();return this.getEryptedPKCS5PEMFromPrvKeyHex(o,b,c,d)},newEncryptedPKCS5PEM:function(a,b,c,d){"undefined"!=typeof b&&null!=b||(b=1024),"undefined"!=typeof c&&null!=c||(c="10001");var e=new RSAKey;e.generate(b,c);var f=null;return f="undefined"==typeof d||null==d?this.getEncryptedPKCS5PEMFromRSAKey(pkey,a):this.getEncryptedPKCS5PEMFromRSAKey(pkey,a,d)},getRSAKeyFromPlainPKCS8PEM:function(a){if(a.match(/ENCRYPTED/))throw"pem shall be not ENCRYPTED";var b=this.getHexFromPEM(a,"PRIVATE KEY"),c=this.getRSAKeyFromPlainPKCS8Hex(b);return c},getRSAKeyFromPlainPKCS8Hex:function(a){var b=ASN1HEX.getPosArrayOfChildren_AtObj(a,0);if(3!=b.length)throw"outer DERSequence shall have 3 elements: "+b.length;var c=ASN1HEX.getHexOfTLV_AtObj(a,b[1]);if("300d06092a864886f70d0101010500"!=c)throw"PKCS8 AlgorithmIdentifier is not rsaEnc: "+c;var c=ASN1HEX.getHexOfTLV_AtObj(a,b[1]),d=ASN1HEX.getHexOfTLV_AtObj(a,b[2]),e=ASN1HEX.getHexOfV_AtObj(d,0),f=new RSAKey;return f.readPrivateKeyFromASN1HexString(e),f},parseHexOfEncryptedPKCS8:function(a){var b={},c=ASN1HEX.getPosArrayOfChildren_AtObj(a,0);if(2!=c.length)throw"malformed format: SEQUENCE(0).items != 2: "+c.length;b.ciphertext=ASN1HEX.getHexOfV_AtObj(a,c[1]);var d=ASN1HEX.getPosArrayOfChildren_AtObj(a,c[0]);if(2!=d.length)throw"malformed format: SEQUENCE(0.0).items != 2: "+d.length;if("2a864886f70d01050d"!=ASN1HEX.getHexOfV_AtObj(a,d[0]))throw"this only supports pkcs5PBES2";var e=ASN1HEX.getPosArrayOfChildren_AtObj(a,d[1]);if(2!=d.length)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+e.length;var f=ASN1HEX.getPosArrayOfChildren_AtObj(a,e[1]);if(2!=f.length)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+f.length;if("2a864886f70d0307"!=ASN1HEX.getHexOfV_AtObj(a,f[0]))throw"this only supports TripleDES";b.encryptionSchemeAlg="TripleDES",b.encryptionSchemeIV=ASN1HEX.getHexOfV_AtObj(a,f[1]);var g=ASN1HEX.getPosArrayOfChildren_AtObj(a,e[0]);if(2!=g.length)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+g.length;if("2a864886f70d01050c"!=ASN1HEX.getHexOfV_AtObj(a,g[0]))throw"this only supports pkcs5PBKDF2";var h=ASN1HEX.getPosArrayOfChildren_AtObj(a,g[1]);if(h.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+h.length;b.pbkdf2Salt=ASN1HEX.getHexOfV_AtObj(a,h[0]);var i=ASN1HEX.getHexOfV_AtObj(a,h[1]);try{b.pbkdf2Iter=parseInt(i,16)}catch(a){throw"malformed format pbkdf2Iter: "+i}return b},getPBKDF2KeyHexFromParam:function(a,b){var c=CryptoJS.enc.Hex.parse(a.pbkdf2Salt),d=a.pbkdf2Iter,e=CryptoJS.PBKDF2(b,c,{keySize:6,iterations:d}),f=CryptoJS.enc.Hex.stringify(e);return f},getPlainPKCS8HexFromEncryptedPKCS8PEM:function(a,b){var c=this.getHexFromPEM(a,"ENCRYPTED PRIVATE KEY"),d=this.parseHexOfEncryptedPKCS8(c),e=PKCS5PKEY.getPBKDF2KeyHexFromParam(d,b),f={};f.ciphertext=CryptoJS.enc.Hex.parse(d.ciphertext);var g=CryptoJS.enc.Hex.parse(e),h=CryptoJS.enc.Hex.parse(d.encryptionSchemeIV),i=CryptoJS.TripleDES.decrypt(f,g,{iv:h}),j=CryptoJS.enc.Hex.stringify(i);return j},getRSAKeyFromEncryptedPKCS8PEM:function(a,b){var c=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(a,b),d=this.getRSAKeyFromPlainPKCS8Hex(c);return d},getKeyFromEncryptedPKCS8PEM:function(a,b){var c=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(a,b),d=this.getKeyFromPlainPrivatePKCS8Hex(c);return d},parsePlainPrivatePKCS8Hex:function(a){var b={};if(b.algparam=null,"30"!=a.substr(0,2))throw"malformed plain PKCS8 private key(code:001)";var c=ASN1HEX.getPosArrayOfChildren_AtObj(a,0);if(3!=c.length)throw"malformed plain PKCS8 private key(code:002)";if("30"!=a.substr(c[1],2))throw"malformed PKCS8 private key(code:003)";var d=ASN1HEX.getPosArrayOfChildren_AtObj(a,c[1]);if(2!=d.length)throw"malformed PKCS8 private key(code:004)";if("06"!=a.substr(d[0],2))throw"malformed PKCS8 private key(code:005)";if(b.algoid=ASN1HEX.getHexOfV_AtObj(a,d[0]),"06"==a.substr(d[1],2)&&(b.algparam=ASN1HEX.getHexOfV_AtObj(a,d[1])),"04"!=a.substr(c[2],2))throw"malformed PKCS8 private key(code:006)";return b.keyidx=ASN1HEX.getStartPosOfV_AtObj(a,c[2]),b},getKeyFromPlainPrivatePKCS8PEM:function(a){var b=this.getHexFromPEM(a,"PRIVATE KEY"),c=this.getKeyFromPlainPrivatePKCS8Hex(b);return c},getKeyFromPlainPrivatePKCS8Hex:function(a){var b=this.parsePlainPrivatePKCS8Hex(a);if("2a864886f70d010101"==b.algoid){this.parsePrivateRawRSAKeyHexAtObj(a,b);var c=b.key,d=new RSAKey;return d.setPrivateEx(c.n,c.e,c.d,c.p,c.q,c.dp,c.dq,c.co),d}if("2a8648ce3d0201"==b.algoid){if(this.parsePrivateRawECKeyHexAtObj(a,b),void 0===KJUR.crypto.OID.oidhex2name[b.algparam])throw"KJUR.crypto.OID.oidhex2name undefined: "+b.algparam;var e=KJUR.crypto.OID.oidhex2name[b.algparam],d=new KJUR.crypto.ECDSA({curve:e,prv:b.key});return d}throw"unsupported private key algorithm"},getRSAKeyFromPublicPKCS8PEM:function(a){var b=this.getHexFromPEM(a,"PUBLIC KEY"),c=this.getRSAKeyFromPublicPKCS8Hex(b);return c},getKeyFromPublicPKCS8PEM:function(a){var b=this.getHexFromPEM(a,"PUBLIC KEY"),c=this.getKeyFromPublicPKCS8Hex(b);return c},getKeyFromPublicPKCS8Hex:function(a){var b=this.parsePublicPKCS8Hex(a);if("2a864886f70d010101"==b.algoid){var c=this.parsePublicRawRSAKeyHex(b.key),d=new RSAKey;return d.setPublic(c.n,c.e),d}if("2a8648ce3d0201"==b.algoid){if(void 0===KJUR.crypto.OID.oidhex2name[b.algparam])throw"KJUR.crypto.OID.oidhex2name undefined: "+b.algparam;var e=KJUR.crypto.OID.oidhex2name[b.algparam],d=new KJUR.crypto.ECDSA({curve:e,pub:b.key});return d}throw"unsupported public key algorithm"},parsePublicRawRSAKeyHex:function(a){var b={};if("30"!=a.substr(0,2))throw"malformed RSA key(code:001)";var c=ASN1HEX.getPosArrayOfChildren_AtObj(a,0);if(2!=c.length)throw"malformed RSA key(code:002)";if("02"!=a.substr(c[0],2))throw"malformed RSA key(code:003)";if(b.n=ASN1HEX.getHexOfV_AtObj(a,c[0]),"02"!=a.substr(c[1],2))throw"malformed RSA key(code:004)";return b.e=ASN1HEX.getHexOfV_AtObj(a,c[1]),b},parsePrivateRawRSAKeyHexAtObj:function(a,b){var c=b.keyidx;if("30"!=a.substr(c,2))throw"malformed RSA private key(code:001)";var d=ASN1HEX.getPosArrayOfChildren_AtObj(a,c);if(9!=d.length)throw"malformed RSA private key(code:002)";b.key={},b.key.n=ASN1HEX.getHexOfV_AtObj(a,d[1]),b.key.e=ASN1HEX.getHexOfV_AtObj(a,d[2]),b.key.d=ASN1HEX.getHexOfV_AtObj(a,d[3]),b.key.p=ASN1HEX.getHexOfV_AtObj(a,d[4]),b.key.q=ASN1HEX.getHexOfV_AtObj(a,d[5]),b.key.dp=ASN1HEX.getHexOfV_AtObj(a,d[6]),b.key.dq=ASN1HEX.getHexOfV_AtObj(a,d[7]),b.key.co=ASN1HEX.getHexOfV_AtObj(a,d[8])},parsePrivateRawECKeyHexAtObj:function(a,b){var c=b.keyidx;if("30"!=a.substr(c,2))throw"malformed ECC private key(code:001)";var d=ASN1HEX.getPosArrayOfChildren_AtObj(a,c);if(3!=d.length)throw"malformed ECC private key(code:002)";if("04"!=a.substr(d[1],2))throw"malformed ECC private key(code:003)";b.key=ASN1HEX.getHexOfV_AtObj(a,d[1])},parsePublicPKCS8Hex:function(a){var b={};b.algparam=null;var c=ASN1HEX.getPosArrayOfChildren_AtObj(a,0);if(2!=c.length)throw"outer DERSequence shall have 2 elements: "+c.length;var d=c[0];if("30"!=a.substr(d,2))throw"malformed PKCS8 public key(code:001)";var e=ASN1HEX.getPosArrayOfChildren_AtObj(a,d);if(2!=e.length)throw"malformed PKCS8 public key(code:002)";if("06"!=a.substr(e[0],2))throw"malformed PKCS8 public key(code:003)";if(b.algoid=ASN1HEX.getHexOfV_AtObj(a,e[0]),"06"==a.substr(e[1],2)&&(b.algparam=ASN1HEX.getHexOfV_AtObj(a,e[1])),"03"!=a.substr(c[1],2))throw"malformed PKCS8 public key(code:004)";return b.key=ASN1HEX.getHexOfV_AtObj(a,c[1]).substr(2),b},getRSAKeyFromPublicPKCS8Hex:function(a){var b=ASN1HEX.getPosArrayOfChildren_AtObj(a,0);if(2!=b.length)throw"outer DERSequence shall have 2 elements: "+b.length;var c=ASN1HEX.getHexOfTLV_AtObj(a,b[0]);if("300d06092a864886f70d0101010500"!=c)throw"PKCS8 AlgorithmId is not rsaEncryption";if("03"!=a.substr(b[1],2))throw"PKCS8 Public Key is not BITSTRING encapslated.";var d=ASN1HEX.getStartPosOfV_AtObj(a,b[1])+2;if("30"!=a.substr(d,2))throw"PKCS8 Public Key is not SEQUENCE.";var e=ASN1HEX.getPosArrayOfChildren_AtObj(a,d);if(2!=e.length)throw"inner DERSequence shall have 2 elements: "+e.length;if("02"!=a.substr(e[0],2))throw"N is not ASN.1 INTEGER";if("02"!=a.substr(e[1],2))throw"E is not ASN.1 INTEGER";var f=ASN1HEX.getHexOfV_AtObj(a,e[0]),g=ASN1HEX.getHexOfV_AtObj(a,e[1]),h=new RSAKey;return h.setPublic(f,g),h}}}(),KEYUTIL=function(){var a=function(a,b,d){return c(CryptoJS.AES,a,b,d)},b=function(a,b,d){return c(CryptoJS.TripleDES,a,b,d)},c=function(a,b,c,d){var e=CryptoJS.enc.Hex.parse(b),f=CryptoJS.enc.Hex.parse(c),g=CryptoJS.enc.Hex.parse(d),h={};h.key=f,h.iv=g,h.ciphertext=e;var i=a.decrypt(h,f,{iv:g});return CryptoJS.enc.Hex.stringify(i)},d=function(a,b,c){return f(CryptoJS.AES,a,b,c)},e=function(a,b,c){return f(CryptoJS.TripleDES,a,b,c)},f=function(a,b,c,d){var e=CryptoJS.enc.Hex.parse(b),f=CryptoJS.enc.Hex.parse(c),g=CryptoJS.enc.Hex.parse(d),h=a.encrypt(e,f,{iv:g}),i=CryptoJS.enc.Hex.parse(h.toString()),j=CryptoJS.enc.Base64.stringify(i);return j},g={"AES-256-CBC":{proc:a,eproc:d,keylen:32,ivlen:16},"AES-192-CBC":{proc:a,eproc:d,keylen:24,ivlen:16},"AES-128-CBC":{proc:a,eproc:d,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:b,eproc:e,keylen:24,ivlen:8}},h=function(a){return g[a].proc},i=function(a){var b=CryptoJS.lib.WordArray.random(a),c=CryptoJS.enc.Hex.stringify(b);return c},j=function(a){var b={};a.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"))&&(b.cipher=RegExp.$1,b.ivsalt=RegExp.$2),a.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"))&&(b.type=RegExp.$1);var c=-1,d=0;a.indexOf("\r\n\r\n")!=-1&&(c=a.indexOf("\r\n\r\n"),d=2),a.indexOf("\n\n")!=-1&&(c=a.indexOf("\n\n"),d=1);var e=a.indexOf("-----END");if(c!=-1&&e!=-1){var f=a.substring(c+2*d,e-d);f=f.replace(/\s+/g,""),b.data=f}return b},k=function(a,b,c){for(var d=c.substring(0,16),e=CryptoJS.enc.Hex.parse(d),f=CryptoJS.enc.Utf8.parse(b),h=g[a].keylen+g[a].ivlen,i="",j=null;;){var k=CryptoJS.algo.MD5.create();if(null!=j&&k.update(j),k.update(f),k.update(e),j=k.finalize(),i+=CryptoJS.enc.Hex.stringify(j),i.length>=2*h)break}var l={};return l.keyhex=i.substr(0,2*g[a].keylen),l.ivhex=i.substr(2*g[a].keylen,2*g[a].ivlen),l},l=function(a,b,c,d){var e=CryptoJS.enc.Base64.parse(a),f=CryptoJS.enc.Hex.stringify(e),h=g[b].proc,i=h(f,c,d);return i},m=function(a,b,c,d){var e=g[b].eproc,f=e(a,c,d);return f};return{version:"1.0.0",getHexFromPEM:function(a,b){var c=a;if(c.indexOf("BEGIN "+b)==-1)throw"can't find PEM header: "+b;c=c.replace("-----BEGIN "+b+"-----",""),c=c.replace("-----END "+b+"-----","");var d=c.replace(/\s+/g,""),e=b64tohex(d);return e},getDecryptedKeyHexByKeyIV:function(a,b,c,d){var e=h(b);return e(a,c,d)},parsePKCS5PEM:function(a){return j(a)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(a,b,c){return k(a,b,c)},decryptKeyB64:function(a,b,c,d){return l(a,b,c,d)},getDecryptedKeyHex:function(a,b){var c=j(a),d=(c.type,c.cipher),e=c.ivsalt,f=c.data,g=k(d,b,e),h=g.keyhex,i=l(f,d,h,e);return i},getRSAKeyFromEncryptedPKCS5PEM:function(a,b){var c=this.getDecryptedKeyHex(a,b),d=new RSAKey;return d.readPrivateKeyFromASN1HexString(c),d},getEncryptedPKCS5PEMFromPrvKeyHex:function(a,b,c,d){var e="";if("undefined"!=typeof c&&null!=c||(c="AES-256-CBC"),"undefined"==typeof g[c])throw"KEYUTIL unsupported algorithm: "+c;if("undefined"==typeof d||null==d){var f=g[c].ivlen,h=i(f);d=h.toUpperCase()}var j=k(c,b,d),l=j.keyhex,n=m(a,c,l,d),o=n.replace(/(.{64})/g,"$1\r\n"),e="-----BEGIN RSA PRIVATE KEY-----\r\n";return e+="Proc-Type: 4,ENCRYPTED\r\n",e+="DEK-Info: "+c+","+d+"\r\n",e+="\r\n",e+=o,e+="\r\n-----END RSA PRIVATE KEY-----\r\n"},getEncryptedPKCS5PEMFromRSAKey:function(a,b,c,d){var e=new KJUR.asn1.DERInteger({int:0}),f=new KJUR.asn1.DERInteger({bigint:a.n}),g=new KJUR.asn1.DERInteger({int:a.e}),h=new KJUR.asn1.DERInteger({bigint:a.d}),i=new KJUR.asn1.DERInteger({bigint:a.p}),j=new KJUR.asn1.DERInteger({bigint:a.q}),k=new KJUR.asn1.DERInteger({bigint:a.dmp1}),l=new KJUR.asn1.DERInteger({bigint:a.dmq1}),m=new KJUR.asn1.DERInteger({bigint:a.coeff}),n=new KJUR.asn1.DERSequence({array:[e,f,g,h,i,j,k,l,m]}),o=n.getEncodedHex();return this.getEncryptedPKCS5PEMFromPrvKeyHex(o,b,c,d)},newEncryptedPKCS5PEM:function(a,b,c,d){"undefined"!=typeof b&&null!=b||(b=1024),"undefined"!=typeof c&&null!=c||(c="10001");var e=new RSAKey;e.generate(b,c);var f=null;return f="undefined"==typeof d||null==d?this.getEncryptedPKCS5PEMFromRSAKey(pkey,a):this.getEncryptedPKCS5PEMFromRSAKey(pkey,a,d)},getRSAKeyFromPlainPKCS8PEM:function(a){if(a.match(/ENCRYPTED/))throw"pem shall be not ENCRYPTED";var b=this.getHexFromPEM(a,"PRIVATE KEY"),c=this.getRSAKeyFromPlainPKCS8Hex(b);return c},getRSAKeyFromPlainPKCS8Hex:function(a){var b=ASN1HEX.getPosArrayOfChildren_AtObj(a,0);if(3!=b.length)throw"outer DERSequence shall have 3 elements: "+b.length;var c=ASN1HEX.getHexOfTLV_AtObj(a,b[1]);if("300d06092a864886f70d0101010500"!=c)throw"PKCS8 AlgorithmIdentifier is not rsaEnc: "+c;var c=ASN1HEX.getHexOfTLV_AtObj(a,b[1]),d=ASN1HEX.getHexOfTLV_AtObj(a,b[2]),e=ASN1HEX.getHexOfV_AtObj(d,0),f=new RSAKey;return f.readPrivateKeyFromASN1HexString(e),f},parseHexOfEncryptedPKCS8:function(a){var b={},c=ASN1HEX.getPosArrayOfChildren_AtObj(a,0);if(2!=c.length)throw"malformed format: SEQUENCE(0).items != 2: "+c.length;b.ciphertext=ASN1HEX.getHexOfV_AtObj(a,c[1]);var d=ASN1HEX.getPosArrayOfChildren_AtObj(a,c[0]);if(2!=d.length)throw"malformed format: SEQUENCE(0.0).items != 2: "+d.length;if("2a864886f70d01050d"!=ASN1HEX.getHexOfV_AtObj(a,d[0]))throw"this only supports pkcs5PBES2";var e=ASN1HEX.getPosArrayOfChildren_AtObj(a,d[1]);if(2!=d.length)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+e.length;var f=ASN1HEX.getPosArrayOfChildren_AtObj(a,e[1]);if(2!=f.length)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+f.length;if("2a864886f70d0307"!=ASN1HEX.getHexOfV_AtObj(a,f[0]))throw"this only supports TripleDES";b.encryptionSchemeAlg="TripleDES",b.encryptionSchemeIV=ASN1HEX.getHexOfV_AtObj(a,f[1]);var g=ASN1HEX.getPosArrayOfChildren_AtObj(a,e[0]);if(2!=g.length)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+g.length;if("2a864886f70d01050c"!=ASN1HEX.getHexOfV_AtObj(a,g[0]))throw"this only supports pkcs5PBKDF2";var h=ASN1HEX.getPosArrayOfChildren_AtObj(a,g[1]);if(h.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+h.length;b.pbkdf2Salt=ASN1HEX.getHexOfV_AtObj(a,h[0]);var i=ASN1HEX.getHexOfV_AtObj(a,h[1]);try{b.pbkdf2Iter=parseInt(i,16)}catch(a){throw"malformed format pbkdf2Iter: "+i}return b},getPBKDF2KeyHexFromParam:function(a,b){var c=CryptoJS.enc.Hex.parse(a.pbkdf2Salt),d=a.pbkdf2Iter,e=CryptoJS.PBKDF2(b,c,{keySize:6,iterations:d}),f=CryptoJS.enc.Hex.stringify(e);return f},getPlainPKCS8HexFromEncryptedPKCS8PEM:function(a,b){var c=this.getHexFromPEM(a,"ENCRYPTED PRIVATE KEY"),d=this.parseHexOfEncryptedPKCS8(c),e=KEYUTIL.getPBKDF2KeyHexFromParam(d,b),f={};f.ciphertext=CryptoJS.enc.Hex.parse(d.ciphertext);var g=CryptoJS.enc.Hex.parse(e),h=CryptoJS.enc.Hex.parse(d.encryptionSchemeIV),i=CryptoJS.TripleDES.decrypt(f,g,{iv:h}),j=CryptoJS.enc.Hex.stringify(i);return j},getRSAKeyFromEncryptedPKCS8PEM:function(a,b){var c=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(a,b),d=this.getRSAKeyFromPlainPKCS8Hex(c);return d},getKeyFromEncryptedPKCS8PEM:function(a,b){var c=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(a,b),d=this.getKeyFromPlainPrivatePKCS8Hex(c);return d},parsePlainPrivatePKCS8Hex:function(a){var b={};if(b.algparam=null,"30"!=a.substr(0,2))throw"malformed plain PKCS8 private key(code:001)";var c=ASN1HEX.getPosArrayOfChildren_AtObj(a,0);if(3!=c.length)throw"malformed plain PKCS8 private key(code:002)";if("30"!=a.substr(c[1],2))throw"malformed PKCS8 private key(code:003)";var d=ASN1HEX.getPosArrayOfChildren_AtObj(a,c[1]);if(2!=d.length)throw"malformed PKCS8 private key(code:004)";if("06"!=a.substr(d[0],2))throw"malformed PKCS8 private key(code:005)";if(b.algoid=ASN1HEX.getHexOfV_AtObj(a,d[0]),"06"==a.substr(d[1],2)&&(b.algparam=ASN1HEX.getHexOfV_AtObj(a,d[1])),"04"!=a.substr(c[2],2))throw"malformed PKCS8 private key(code:006)";return b.keyidx=ASN1HEX.getStartPosOfV_AtObj(a,c[2]),b},getKeyFromPlainPrivatePKCS8PEM:function(a){var b=this.getHexFromPEM(a,"PRIVATE KEY"),c=this.getKeyFromPlainPrivatePKCS8Hex(b);return c},getKeyFromPlainPrivatePKCS8Hex:function(a){var b=this.parsePlainPrivatePKCS8Hex(a);if("2a864886f70d010101"==b.algoid){this.parsePrivateRawRSAKeyHexAtObj(a,b);var c=b.key,d=new RSAKey;return d.setPrivateEx(c.n,c.e,c.d,c.p,c.q,c.dp,c.dq,c.co),d}if("2a8648ce3d0201"==b.algoid){if(this.parsePrivateRawECKeyHexAtObj(a,b),void 0===KJUR.crypto.OID.oidhex2name[b.algparam])throw"KJUR.crypto.OID.oidhex2name undefined: "+b.algparam;var e=KJUR.crypto.OID.oidhex2name[b.algparam],d=new KJUR.crypto.ECDSA({curve:e,prv:b.key});return d}throw"unsupported private key algorithm"},getRSAKeyFromPublicPKCS8PEM:function(a){var b=this.getHexFromPEM(a,"PUBLIC KEY"),c=this.getRSAKeyFromPublicPKCS8Hex(b);return c},getKeyFromPublicPKCS8PEM:function(a){var b=this.getHexFromPEM(a,"PUBLIC KEY"),c=this.getKeyFromPublicPKCS8Hex(b);return c},getKeyFromPublicPKCS8Hex:function(a){var b=this.parsePublicPKCS8Hex(a);if("2a864886f70d010101"==b.algoid){var c=this.parsePublicRawRSAKeyHex(b.key),d=new RSAKey;return d.setPublic(c.n,c.e),d}if("2a8648ce3d0201"==b.algoid){if(void 0===KJUR.crypto.OID.oidhex2name[b.algparam])throw"KJUR.crypto.OID.oidhex2name undefined: "+b.algparam;var e=KJUR.crypto.OID.oidhex2name[b.algparam],d=new KJUR.crypto.ECDSA({curve:e,pub:b.key});return d}throw"unsupported public key algorithm"},parsePublicRawRSAKeyHex:function(a){var b={};if("30"!=a.substr(0,2))throw"malformed RSA key(code:001)";var c=ASN1HEX.getPosArrayOfChildren_AtObj(a,0);if(2!=c.length)throw"malformed RSA key(code:002)";if("02"!=a.substr(c[0],2))throw"malformed RSA key(code:003)";if(b.n=ASN1HEX.getHexOfV_AtObj(a,c[0]),"02"!=a.substr(c[1],2))throw"malformed RSA key(code:004)";return b.e=ASN1HEX.getHexOfV_AtObj(a,c[1]),b},parsePrivateRawRSAKeyHexAtObj:function(a,b){var c=b.keyidx;if("30"!=a.substr(c,2))throw"malformed RSA private key(code:001)";var d=ASN1HEX.getPosArrayOfChildren_AtObj(a,c);if(9!=d.length)throw"malformed RSA private key(code:002)";b.key={},b.key.n=ASN1HEX.getHexOfV_AtObj(a,d[1]),b.key.e=ASN1HEX.getHexOfV_AtObj(a,d[2]),b.key.d=ASN1HEX.getHexOfV_AtObj(a,d[3]),b.key.p=ASN1HEX.getHexOfV_AtObj(a,d[4]),b.key.q=ASN1HEX.getHexOfV_AtObj(a,d[5]),b.key.dp=ASN1HEX.getHexOfV_AtObj(a,d[6]),b.key.dq=ASN1HEX.getHexOfV_AtObj(a,d[7]),b.key.co=ASN1HEX.getHexOfV_AtObj(a,d[8])},parsePrivateRawECKeyHexAtObj:function(a,b){var c=b.keyidx;if("30"!=a.substr(c,2))throw"malformed ECC private key(code:001)";var d=ASN1HEX.getPosArrayOfChildren_AtObj(a,c);if(3!=d.length)throw"malformed ECC private key(code:002)";if("04"!=a.substr(d[1],2))throw"malformed ECC private key(code:003)";b.key=ASN1HEX.getHexOfV_AtObj(a,d[1])},parsePublicPKCS8Hex:function(a){var b={};b.algparam=null;var c=ASN1HEX.getPosArrayOfChildren_AtObj(a,0);if(2!=c.length)throw"outer DERSequence shall have 2 elements: "+c.length;var d=c[0];if("30"!=a.substr(d,2))throw"malformed PKCS8 public key(code:001)";var e=ASN1HEX.getPosArrayOfChildren_AtObj(a,d);if(2!=e.length)throw"malformed PKCS8 public key(code:002)";if("06"!=a.substr(e[0],2))throw"malformed PKCS8 public key(code:003)";if(b.algoid=ASN1HEX.getHexOfV_AtObj(a,e[0]),"06"==a.substr(e[1],2)&&(b.algparam=ASN1HEX.getHexOfV_AtObj(a,e[1])),"03"!=a.substr(c[1],2))throw"malformed PKCS8 public key(code:004)";return b.key=ASN1HEX.getHexOfV_AtObj(a,c[1]).substr(2),b},getRSAKeyFromPublicPKCS8Hex:function(a){var b=ASN1HEX.getPosArrayOfChildren_AtObj(a,0);if(2!=b.length)throw"outer DERSequence shall have 2 elements: "+b.length;var c=ASN1HEX.getHexOfTLV_AtObj(a,b[0]);if("300d06092a864886f70d0101010500"!=c)throw"PKCS8 AlgorithmId is not rsaEncryption";if("03"!=a.substr(b[1],2))throw"PKCS8 Public Key is not BITSTRING encapslated.";var d=ASN1HEX.getStartPosOfV_AtObj(a,b[1])+2;if("30"!=a.substr(d,2))throw"PKCS8 Public Key is not SEQUENCE.";var e=ASN1HEX.getPosArrayOfChildren_AtObj(a,d);if(2!=e.length)throw"inner DERSequence shall have 2 elements: "+e.length;if("02"!=a.substr(e[0],2))throw"N is not ASN.1 INTEGER";if("02"!=a.substr(e[1],2))throw"E is not ASN.1 INTEGER";var f=ASN1HEX.getHexOfV_AtObj(a,e[0]),g=ASN1HEX.getHexOfV_AtObj(a,e[1]),h=new RSAKey;return h.setPublic(f,g),h}}}();KEYUTIL.getKey=function(a,b,c){if(a instanceof RSAKey)return a;if(a instanceof KJUR.crypto.ECDSA)return a;if(void 0!==a.xy&&void 0!==a.curve)return new KJUR.crypto.ECDSA({prv:a.xy,curve:a.curve});if(void 0!==a.n&&void 0!==a.e&&void 0!==a.d&&void 0!==a.p&&void 0!==a.q&&void 0!==a.dp&&void 0!==a.dq&&void 0!==a.co){var d=new RSAKey;return d.setPrivateEx(a.n,a.e,a.d,a.p,a.q,a.dp,a.dq,a.co),d}if(void 0!==a.d&&void 0!==a.curve)return new KJUR.crypto.ECDSA({pub:a.d,curve:a.curve});if(void 0!==a.n&&a.e){var d=new RSAKey;return d.setPublic(a.n,a.e),d}if(a.indexOf("-END CERTIFICATE-",0)!=-1||a.indexOf("-END X509 CERTIFICATE-",0)!=-1||a.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1)return X509.getPublicKeyFromCertPEM(a);if("pkcs8pub"===c)return KEYUTIL.getKeyFromPublicPKCS8Hex(a);if(a.indexOf("-END PUBLIC KEY-")!=-1)return KEYUTIL.getKeyFromPublicPKCS8PEM(a);if("pkcs5prv"===c){var d=new RSAKey;return d.readPrivateKeyFromASN1HexString(a),d}if("pkcs5prv"===c){var d=new RSAKey;return d.readPrivateKeyFromASN1HexString(a),d}if(a.indexOf("-END RSA PRIVATE KEY-")!=-1&&a.indexOf("4,ENCRYPTED")==-1){var d=new RSAKey;return d.readPrivateKeyFromPEMString(a),d}if(a.indexOf("-END PRIVATE KEY-")!=-1)return KEYUTIL.getKeyFromPlainPrivatePKCS8PEM(a);if(a.indexOf("-END RSA PRIVATE KEY-")!=-1&&a.indexOf("4,ENCRYPTED")!=-1)return KEYUTIL.getRSAKeyFromEncryptedPKCS5PEM(a,b);if(a.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1)return KEYUTIL.getKeyFromEncryptedPKCS8PEM(a,b);throw"not supported argument"},KEYUTIL.generateKeypair=function(a,b){if("RSA"==a){var c=b,d=new RSAKey;d.generate(c,"10001");var e=new RSAKey,f=d.n.toString(16),g=d.e.toString(16);e.setPublic(f,g);var h={};return h.prvKeyObj=d,h.pubKeyObj=e,h}if("EC"==a){var i=b,j=new KJUR.crypto.ECDSA({curve:i}),k=j.generateKeyPairHex(),d=new KJUR.crypto.ECDSA({curve:i});d.setPrivateKeyHex(k.ecprvhex);var e=new KJUR.crypto.ECDSA({curve:i});e.setPublicKeyHex(k.ecpubhex);var h={};return h.prvKeyObj=d,h.pubKeyObj=e,h}throw"unknown algorithm: "+a},RSAKey.prototype.readPrivateKeyFromPEMString=_rsapem_readPrivateKeyFromPEMString,RSAKey.prototype.readPrivateKeyFromASN1HexString=_rsapem_readPrivateKeyFromASN1HexString;var _RE_HEXDECONLY=new RegExp("");_RE_HEXDECONLY.compile("[^0-9a-f]","gi"),RSAKey.prototype.signWithMessageHash=_rsasign_signWithMessageHash,RSAKey.prototype.signString=_rsasign_signString,RSAKey.prototype.signStringWithSHA1=_rsasign_signStringWithSHA1,RSAKey.prototype.signStringWithSHA256=_rsasign_signStringWithSHA256,RSAKey.prototype.sign=_rsasign_signString,RSAKey.prototype.signWithSHA1=_rsasign_signStringWithSHA1,RSAKey.prototype.signWithSHA256=_rsasign_signStringWithSHA256,RSAKey.prototype.signWithMessageHashPSS=_rsasign_signWithMessageHashPSS,RSAKey.prototype.signStringPSS=_rsasign_signStringPSS,RSAKey.prototype.signPSS=_rsasign_signStringPSS,RSAKey.SALT_LEN_HLEN=-1,RSAKey.SALT_LEN_MAX=-2,RSAKey.prototype.verifyWithMessageHash=_rsasign_verifyWithMessageHash,RSAKey.prototype.verifyString=_rsasign_verifyString,RSAKey.prototype.verifyHexSignatureForMessage=_rsasign_verifyHexSignatureForMessage,RSAKey.prototype.verify=_rsasign_verifyString,
RSAKey.prototype.verifyHexSignatureForByteArrayMessage=_rsasign_verifyHexSignatureForMessage,RSAKey.prototype.verifyWithMessageHashPSS=_rsasign_verifyWithMessageHashPSS,RSAKey.prototype.verifyStringPSS=_rsasign_verifyStringPSS,RSAKey.prototype.verifyPSS=_rsasign_verifyStringPSS,RSAKey.SALT_LEN_RECOVER=-2,X509.pemToBase64=function(a){var b=a;return b=b.replace("-----BEGIN CERTIFICATE-----",""),b=b.replace("-----END CERTIFICATE-----",""),b=b.replace(/[ \n]+/g,"")},X509.pemToHex=function(a){var b=X509.pemToBase64(a),c=b64tohex(b);return c},X509.getSubjectPublicKeyPosFromCertHex=function(a){var b=X509.getSubjectPublicKeyInfoPosFromCertHex(a);if(b==-1)return-1;var c=ASN1HEX.getPosArrayOfChildren_AtObj(a,b);if(2!=c.length)return-1;var d=c[1];if("03"!=a.substring(d,d+2))return-1;var e=ASN1HEX.getStartPosOfV_AtObj(a,d);return"00"!=a.substring(e,e+2)?-1:e+2},X509.getSubjectPublicKeyInfoPosFromCertHex=function(a){var b=ASN1HEX.getStartPosOfV_AtObj(a,0),c=ASN1HEX.getPosArrayOfChildren_AtObj(a,b);return c.length<1?-1:"a003020102"==a.substring(c[0],c[0]+10)?c.length<6?-1:c[6]:c.length<5?-1:c[5]},X509.getPublicKeyHexArrayFromCertHex=function(a){var b=X509.getSubjectPublicKeyPosFromCertHex(a),c=ASN1HEX.getPosArrayOfChildren_AtObj(a,b);if(2!=c.length)return[];var d=ASN1HEX.getHexOfV_AtObj(a,c[0]),e=ASN1HEX.getHexOfV_AtObj(a,c[1]);return null!=d&&null!=e?[d,e]:[]},X509.getHexTbsCertificateFromCert=function(a){var b=ASN1HEX.getStartPosOfV_AtObj(a,0);return b},X509.getPublicKeyHexArrayFromCertPEM=function(a){var b=X509.pemToHex(a),c=X509.getPublicKeyHexArrayFromCertHex(b);return c},X509.hex2dn=function(a){for(var b="",c=ASN1HEX.getPosArrayOfChildren_AtObj(a,0),d=0;d<c.length;d++){var e=ASN1HEX.getHexOfTLV_AtObj(a,c[d]);b=b+"/"+X509.hex2rdn(e)}return b},X509.hex2rdn=function(a){var b=ASN1HEX.getDecendantHexTLVByNthList(a,0,[0,0]),c=ASN1HEX.getDecendantHexVByNthList(a,0,[0,1]),d="";try{d=X509.DN_ATTRHEX[b]}catch(a){d=b}c=c.replace(/(..)/g,"%$1");var e=decodeURIComponent(c);return d+"="+e},X509.DN_ATTRHEX={"0603550406":"C","060355040a":"O","060355040b":"OU","0603550403":"CN","0603550405":"SN","0603550408":"ST","0603550407":"L"},X509.getPublicKeyFromCertPEM=function(a){var b=X509.getPublicKeyInfoPropOfCertPEM(a);if("2a864886f70d010101"==b.algoid){var c=PKCS5PKEY.parsePublicRawRSAKeyHex(b.keyhex),d=new RSAKey;return d.setPublic(c.n,c.e),d}if(b.algoid="2a8648ce3d0201"){var e=KJUR.crypto.OID.oidhex2name[b.algparam],d=new KJUR.crypto.ECDSA({curve:e,info:b.keyhex});return d.setPublicKeyHex(b.keyhex),d}throw"unsupported key"},X509.getPublicKeyInfoPropOfCertPEM=function(a){var b={};b.algparam=null;var c=X509.pemToHex(a),d=ASN1HEX.getPosArrayOfChildren_AtObj(c,0);if(3!=d.length)throw"malformed X.509 certificate PEM (code:001)";if("30"!=c.substr(d[0],2))throw"malformed X.509 certificate PEM (code:002)";var e=ASN1HEX.getPosArrayOfChildren_AtObj(c,d[0]);if(e.length<7)throw"malformed X.509 certificate PEM (code:003)";var f=ASN1HEX.getPosArrayOfChildren_AtObj(c,e[6]);if(2!=f.length)throw"malformed X.509 certificate PEM (code:004)";var g=ASN1HEX.getPosArrayOfChildren_AtObj(c,f[0]);if(2!=g.length)throw"malformed X.509 certificate PEM (code:005)";if(b.algoid=ASN1HEX.getHexOfV_AtObj(c,g[0]),"06"==c.substr(g[1],2)&&(b.algparam=ASN1HEX.getHexOfV_AtObj(c,g[1])),"03"!=c.substr(f[1],2))throw"malformed X.509 certificate PEM (code:006)";var h=ASN1HEX.getHexOfV_AtObj(c,f[1]);return b.keyhex=h.substr(2),b};var jsonParse=function(){function a(a,b,c){return b?g[b]:String.fromCharCode(parseInt(c,16))}var b="(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)",c='(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))',d='(?:"'+c+'*")',e=new RegExp("(?:false|true|null|[\\{\\}\\[\\]]|"+b+"|"+d+")","g"),f=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),g={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},h=new String(""),i="\\",j=({"{":Object,"[":Array},Object.hasOwnProperty);return function(b,c){var d,g=b.match(e),k=g[0],l=!1;"{"===k?d={}:"["===k?d=[]:(d=[],l=!0);for(var m,n=[d],o=1-l,p=g.length;o<p;++o){k=g[o];var q;switch(k.charCodeAt(0)){default:q=n[0],q[m||q.length]=+k,m=void 0;break;case 34:if(k=k.substring(1,k.length-1),k.indexOf(i)!==-1&&(k=k.replace(f,a)),q=n[0],!m){if(!(q instanceof Array)){m=k||h;break}m=q.length}q[m]=k,m=void 0;break;case 91:q=n[0],n.unshift(q[m||q.length]=[]),m=void 0;break;case 93:n.shift();break;case 102:q=n[0],q[m||q.length]=!1,m=void 0;break;case 110:q=n[0],q[m||q.length]=null,m=void 0;break;case 116:q=n[0],q[m||q.length]=!0,m=void 0;break;case 123:q=n[0],n.unshift(q[m||q.length]={}),m=void 0;break;case 125:n.shift()}}if(l){if(1!==n.length)throw new Error;d=d[0]}else if(n.length)throw new Error;if(c){var r=function(a,b){var d=a[b];if(d&&"object"==typeof d){var e=null;for(var f in d)if(j.call(d,f)&&d!==a){var g=r(d,f);void 0!==g?d[f]=g:(e||(e=[]),e.push(f))}if(e)for(var h=e.length;--h>=0;)delete d[e[h]]}return c.call(a,b,d)};d=r({"":d},"")}return d}}();"undefined"!=typeof KJUR&&KJUR||(KJUR={}),"undefined"!=typeof KJUR.jws&&KJUR.jws||(KJUR.jws={}),KJUR.jws.JWS=function(){function a(a,b){return utf8tob64u(a)+"."+utf8tob64u(b)}function b(a){var b=a.alg,c="";if("RS256"!=b&&"RS512"!=b&&"PS256"!=b&&"PS512"!=b)throw"JWS signature algorithm not supported: "+b;return"256"==b.substr(2)&&(c="sha256"),"512"==b.substr(2)&&(c="sha512"),c}function c(a){return b(jsonParse(a))}function d(a,b,d,e,f,g){var h=new RSAKey;h.setPrivate(e,f,g);var i=c(a),j=h.signString(d,i);return j}function e(a,d,e,f,g){var h=null;h="undefined"==typeof g?c(a):b(g);var i="PS"==g.alg.substr(0,2);return f.hashAndSign?b64tob64u(f.hashAndSign(h,e,"binary","base64",i)):hextob64u(i?f.signStringPSS(e,h):f.signString(e,h))}function f(a,b,d,e){var f=new RSAKey;f.readPrivateKeyFromPEMString(e);var g=c(a),h=f.signString(d,g);return h}this.parseJWS=function(a,b){if(void 0===this.parsedJWS||!b&&void 0===this.parsedJWS.sigvalH){if(null==a.match(/^([^.]+)\.([^.]+)\.([^.]+)$/))throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var c=RegExp.$1,d=RegExp.$2,e=RegExp.$3,f=c+"."+d;if(this.parsedJWS={},this.parsedJWS.headB64U=c,this.parsedJWS.payloadB64U=d,this.parsedJWS.sigvalB64U=e,this.parsedJWS.si=f,!b){var g=b64utohex(e),h=parseBigInt(g,16);this.parsedJWS.sigvalH=g,this.parsedJWS.sigvalBI=h}var i=b64utoutf8(c),j=b64utoutf8(d);if(this.parsedJWS.headS=i,this.parsedJWS.payloadS=j,!this.isSafeJSONString(i,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+i}},this.verifyJWSByNE=function(a,b,c){return this.parseJWS(a),_rsasign_verifySignatureWithArgs(this.parsedJWS.si,this.parsedJWS.sigvalBI,b,c)},this.verifyJWSByKey=function(a,c){this.parseJWS(a);var d=b(this.parsedJWS.headP),e="PS"==this.parsedJWS.headP.alg.substr(0,2);return c.hashAndVerify?c.hashAndVerify(d,new Buffer(this.parsedJWS.si,"utf8").toString("base64"),b64utob64(this.parsedJWS.sigvalB64U),"base64",e):e?c.verifyStringPSS(this.parsedJWS.si,this.parsedJWS.sigvalH,d):c.verifyString(this.parsedJWS.si,this.parsedJWS.sigvalH)},this.verifyJWSByPemX509Cert=function(a,b){this.parseJWS(a);var c=new X509;return c.readCertPEM(b),c.subjectPublicKeyRSA.verifyString(this.parsedJWS.si,this.parsedJWS.sigvalH)},this.generateJWSByNED=function(b,c,e,f,g){if(!this.isSafeJSONString(b))throw"JWS Head is not safe JSON string: "+b;var h=a(b,c),i=d(b,c,h,e,f,g),j=hextob64u(i);return this.parsedJWS={},this.parsedJWS.headB64U=h.split(".")[0],this.parsedJWS.payloadB64U=h.split(".")[1],this.parsedJWS.sigvalB64U=j,h+"."+j},this.generateJWSByKey=function(b,c,d){var f={};if(!this.isSafeJSONString(b,f,"headP"))throw"JWS Head is not safe JSON string: "+b;var g=a(b,c),h=e(b,c,g,d,f.headP);return this.parsedJWS={},this.parsedJWS.headB64U=g.split(".")[0],this.parsedJWS.payloadB64U=g.split(".")[1],this.parsedJWS.sigvalB64U=h,g+"."+h},this.generateJWSByP1PrvKey=function(b,c,d){if(!this.isSafeJSONString(b))throw"JWS Head is not safe JSON string: "+b;var e=a(b,c),g=f(b,c,e,d),h=hextob64u(g);return this.parsedJWS={},this.parsedJWS.headB64U=e.split(".")[0],this.parsedJWS.payloadB64U=e.split(".")[1],this.parsedJWS.sigvalB64U=h,e+"."+h}},KJUR.jws.JWS.sign=function(a,b,c,d,e){var f=KJUR.jws.JWS;if(!f.isSafeJSONString(b))throw"JWS Head is not safe JSON string: "+sHead;var g=f.readSafeJSONString(b);""!=a&&null!=a||void 0===g.alg||(a=g.alg),""!=a&&null!=a&&void 0===g.alg&&(g.alg=a,b=JSON.stringify(g));var h=null;if(void 0===f.jwsalg2sigalg[a])throw"unsupported alg name: "+a;h=f.jwsalg2sigalg[a];var i=utf8tob64u(b),j=utf8tob64u(c),k=i+"."+j,l="";if("Hmac"==h.substr(0,4)){if(void 0===d)throw"hexadecimal key shall be specified for HMAC";var m=new KJUR.crypto.Mac({alg:h,pass:hextorstr(d)});m.updateString(k),l=m.doFinal()}else if(h.indexOf("withECDSA")!=-1){var n=new KJUR.crypto.Signature({alg:h});n.init(d,e),n.updateString(k),hASN1Sig=n.sign(),l=KJUR.crypto.ECDSA.asn1SigToConcatSig(hASN1Sig)}else if("none"!=h){var n=new KJUR.crypto.Signature({alg:h});n.init(d,e),n.updateString(k),l=n.sign()}var o=hextob64u(l);return k+"."+o},KJUR.jws.JWS.verify=function(a,b){var c=KJUR.jws.JWS,d=a.split("."),e=d[0],f=d[1],g=e+"."+f,h=b64utohex(d[2]),i=c.readSafeJSONString(b64utoutf8(d[0])),j=null;if(void 0===i.alg)throw"algorithm not specified in header";j=i.alg;var k=null;if(void 0===c.jwsalg2sigalg[i.alg])throw"unsupported alg name: "+j;if(k=c.jwsalg2sigalg[j],"none"==k)return!0;if("Hmac"==k.substr(0,4)){if(void 0===b)throw"hexadecimal key shall be specified for HMAC";var l=new KJUR.crypto.Mac({alg:k,pass:hextorstr(b)});return l.updateString(g),hSig2=l.doFinal(),h==hSig2}if(k.indexOf("withECDSA")!=-1){var m=null;try{m=KJUR.crypto.ECDSA.concatSigToASN1Sig(h)}catch(a){return!1}var n=new KJUR.crypto.Signature({alg:k});return n.init(b),n.updateString(g),n.verify(m)}var n=new KJUR.crypto.Signature({alg:k});return n.init(b),n.updateString(g),n.verify(h)},KJUR.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},KJUR.jws.JWS.isSafeJSONString=function(a,b,c){var d=null;try{return d=jsonParse(a),"object"!=typeof d?0:d.constructor===Array?0:(b&&(b[c]=d),1)}catch(a){return 0}},KJUR.jws.JWS.readSafeJSONString=function(a){var b=null;try{return b=jsonParse(a),"object"!=typeof b?null:b.constructor===Array?null:b}catch(a){return null}},KJUR.jws.JWS.getEncodedSignatureValueFromJWS=function(a){if(null==a.match(/^[^.]+\.[^.]+\.([^.]+)$/))throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return RegExp.$1},KJUR.jws.IntDate=function(){},KJUR.jws.IntDate.get=function(a){if("now"==a)return KJUR.jws.IntDate.getNow();if("now + 1hour"==a)return KJUR.jws.IntDate.getNow()+3600;if("now + 1day"==a)return KJUR.jws.IntDate.getNow()+86400;if("now + 1month"==a)return KJUR.jws.IntDate.getNow()+2592e3;if("now + 1year"==a)return KJUR.jws.IntDate.getNow()+31536e3;if(a.match(/Z$/))return KJUR.jws.IntDate.getZulu(a);if(a.match(/^[0-9]+$/))return parseInt(a);throw"unsupported format: "+a},KJUR.jws.IntDate.getZulu=function(b){if(a=b.match(/(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)Z/)){var c=parseInt(RegExp.$1),d=parseInt(RegExp.$2)-1,e=parseInt(RegExp.$3),f=parseInt(RegExp.$4),g=parseInt(RegExp.$5),h=parseInt(RegExp.$6),i=new Date(Date.UTC(c,d,e,f,g,h));return~~(i/1e3)}throw"unsupported format: "+b},KJUR.jws.IntDate.getNow=function(){var a=~~(new Date/1e3);return a},KJUR.jws.IntDate.intDate2UTCString=function(a){var b=new Date(1e3*a);return b.toUTCString()},KJUR.jws.IntDate.intDate2Zulu=function(a){var b=new Date(1e3*a),c=("0000"+b.getUTCFullYear()).slice(-4),d=("00"+(b.getUTCMonth()+1)).slice(-2),e=("00"+b.getUTCDate()).slice(-2),f=("00"+b.getUTCHours()).slice(-2),g=("00"+b.getUTCMinutes()).slice(-2),h=("00"+b.getUTCSeconds()).slice(-2);return c+d+e+f+g+h+"Z"},function(a,b){"function"==typeof define&&define.amd?define([],b):a.forge=b()}(this,function(){var a,b,c;return function(d){function e(a,b){return u.call(a,b)}function f(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=b&&b.split("/"),o=s.map,p=o&&o["*"]||{};if(a&&"."===a.charAt(0))if(b){for(n=n.slice(0,n.length-1),a=a.split("/"),g=a.length-1,s.nodeIdCompat&&w.test(a[g])&&(a[g]=a[g].replace(w,"")),a=n.concat(a),k=0;k<a.length;k+=1)if(m=a[k],"."===m)a.splice(k,1),k-=1;else if(".."===m){if(1===k&&(".."===a[2]||".."===a[0]))break;k>0&&(a.splice(k-1,2),k-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((n||p)&&o){for(c=a.split("/"),k=c.length;k>0;k-=1){if(d=c.slice(0,k).join("/"),n)for(l=n.length;l>0;l-=1)if(e=o[n.slice(0,l).join("/")],e&&(e=e[d])){f=e,h=k;break}if(f)break;!i&&p&&p[d]&&(i=p[d],j=k)}!f&&i&&(f=i,h=j),f&&(c.splice(0,h,f),a=c.join("/"))}return a}function g(a,b){return function(){return n.apply(d,v.call(arguments,0).concat([a,b]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){q[a]=b}}function j(a){if(e(r,a)){var b=r[a];delete r[a],t[a]=!0,m.apply(d,b)}if(!e(q,a)&&!e(t,a))throw new Error("No "+a);return q[a]}function k(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return function(){return s&&s.config&&s.config[a]||{}}}var m,n,o,p,q={},r={},s={},t={},u=Object.prototype.hasOwnProperty,v=[].slice,w=/\.js$/;o=function(a,b){var c,d=k(a),e=d[0];return a=d[1],e&&(e=f(e,b),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(b)):f(a,b):(a=f(a,b),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+"!"+a:a,n:a,pr:e,p:c}},p={require:function(a){return g(a)},exports:function(a){var b=q[a];return"undefined"!=typeof b?b:q[a]={}},module:function(a){return{id:a,uri:"",exports:q[a],config:l(a)}}},m=function(a,b,c,f){var h,k,l,m,n,s,u=[],v=typeof c;if(f=f||a,"undefined"===v||"function"===v){for(b=!b.length&&c.length?["require","exports","module"]:b,n=0;n<b.length;n+=1)if(m=o(b[n],f),k=m.f,"require"===k)u[n]=p.require(a);else if("exports"===k)u[n]=p.exports(a),s=!0;else if("module"===k)h=u[n]=p.module(a);else if(e(q,k)||e(r,k)||e(t,k))u[n]=j(k);else{if(!m.p)throw new Error(a+" missing "+k);m.p.load(m.n,g(f,!0),i(k),{}),u[n]=q[k]}l=c?c.apply(q[a],u):void 0,a&&(h&&h.exports!==d&&h.exports!==q[a]?q[a]=h.exports:l===d&&s||(q[a]=l))}else a&&(q[a]=c)},a=b=n=function(a,b,c,e,f){if("string"==typeof a)return p[a]?p[a](b):j(o(a,b).f);if(!a.splice){if(s=a,s.deps&&n(s.deps,s.callback),!b)return;b.splice?(a=b,b=c,c=null):a=d}return b=b||function(){},"function"==typeof c&&(c=e,e=f),e?m(d,a,b,c):setTimeout(function(){m(d,a,b,c)},4),n},n.config=function(a){return n(a)},a._defined=q,c=function(a,b,c){b.splice||(c=b,b=[]),e(q,a)||e(r,a)||(r[a]=[a,b,c])},c.amd={jQuery:!0}}(),c("node_modules/almond/almond",function(){}),function(){function a(a){function b(a){if(this.data="",this.read=0,"string"==typeof a)this.data=a;else if(d.isArrayBuffer(a)||d.isArrayBufferView(a)){var c=new Uint8Array(a);try{this.data=String.fromCharCode.apply(null,c)}catch(a){for(var e=0;e<c.length;++e)this.putByte(c[e])}}else(a instanceof b||"object"==typeof a&&"string"==typeof a.data&&"number"==typeof a.read)&&(this.data=a.data,this.read=a.read);this._constructedStringLength=0}function c(a,b){b=b||{},this.read=b.readOffset||0,this.growSize=b.growSize||1024;var c=d.isArrayBuffer(a),e=d.isArrayBufferView(a);return c||e?(c?this.data=new DataView(a):this.data=new DataView(a.buffer,a.byteOffset,a.byteLength),void(this.write="writeOffset"in b?b.writeOffset:this.data.byteLength)):(this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!==a&&void 0!==a&&this.putBytes(a),void("writeOffset"in b&&(this.write=b.writeOffset)))}var d=a.util=a.util||{};!function(){function a(a){if(a.source===window&&a.data===b){a.stopPropagation();var d=c.slice();c.length=0,d.forEach(function(a){a()})}}if("undefined"!=typeof process&&process.nextTick)return d.nextTick=process.nextTick,void("function"==typeof setImmediate?d.setImmediate=setImmediate:d.setImmediate=d.nextTick);if("function"==typeof setImmediate)return d.setImmediate=setImmediate,void(d.nextTick=function(a){return setImmediate(a)});if(d.setImmediate=function(a){setTimeout(a,0)},"undefined"!=typeof window&&"function"==typeof window.postMessage){var b="forge.setImmediate",c=[];d.setImmediate=function(a){c.push(a),1===c.length&&window.postMessage(b,"*")},window.addEventListener("message",a,!0)}if("undefined"!=typeof MutationObserver){var e=Date.now(),f=!0,g=document.createElement("div"),c=[];new MutationObserver(function(){var a=c.slice();c.length=0,a.forEach(function(a){a()})}).observe(g,{attributes:!0});var h=d.setImmediate;d.setImmediate=function(a){Date.now()-e>15?(e=Date.now(),h(a)):(c.push(a),1===c.length&&g.setAttribute("a",f=!f))}}d.nextTick=d.setImmediate}(),d.isArray=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},d.isArrayBuffer=function(a){return"undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer},d.isArrayBufferView=function(a){return a&&d.isArrayBuffer(a.buffer)&&void 0!==a.byteLength},d.ByteBuffer=b,d.ByteStringBuffer=b;var e=4096;d.ByteStringBuffer.prototype._optimizeConstructedString=function(a){this._constructedStringLength+=a,this._constructedStringLength>e&&(this.data.substr(0,1),this._constructedStringLength=0)},d.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},d.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},d.ByteStringBuffer.prototype.putByte=function(a){return this.putBytes(String.fromCharCode(a))},d.ByteStringBuffer.prototype.fillWithByte=function(a,b){a=String.fromCharCode(a);for(var c=this.data;b>0;)1&b&&(c+=a),b>>>=1,b>0&&(a+=a);return this.data=c,this._optimizeConstructedString(b),this},d.ByteStringBuffer.prototype.putBytes=function(a){return this.data+=a,this._optimizeConstructedString(a.length),this},d.ByteStringBuffer.prototype.putString=function(a){return this.putBytes(d.encodeUtf8(a))},d.ByteStringBuffer.prototype.putInt16=function(a){return this.putBytes(String.fromCharCode(a>>8&255)+String.fromCharCode(255&a))},d.ByteStringBuffer.prototype.putInt24=function(a){return this.putBytes(String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(255&a))},d.ByteStringBuffer.prototype.putInt32=function(a){return this.putBytes(String.fromCharCode(a>>24&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(255&a))},d.ByteStringBuffer.prototype.putInt16Le=function(a){return this.putBytes(String.fromCharCode(255&a)+String.fromCharCode(a>>8&255))},d.ByteStringBuffer.prototype.putInt24Le=function(a){return this.putBytes(String.fromCharCode(255&a)+String.fromCharCode(a>>8&255)+String.fromCharCode(a>>16&255))},d.ByteStringBuffer.prototype.putInt32Le=function(a){return this.putBytes(String.fromCharCode(255&a)+String.fromCharCode(a>>8&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>24&255))},d.ByteStringBuffer.prototype.putInt=function(a,b){var c="";do b-=8,c+=String.fromCharCode(a>>b&255);while(b>0);return this.putBytes(c)},d.ByteStringBuffer.prototype.putSignedInt=function(a,b){return a<0&&(a+=2<<b-1),this.putInt(a,b)},d.ByteStringBuffer.prototype.putBuffer=function(a){return this.putBytes(a.getBytes())},d.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},d.ByteStringBuffer.prototype.getInt16=function(){var a=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,a},d.ByteStringBuffer.prototype.getInt24=function(){var a=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,a},d.ByteStringBuffer.prototype.getInt32=function(){var a=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,a},d.ByteStringBuffer.prototype.getInt16Le=function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,a},d.ByteStringBuffer.prototype.getInt24Le=function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,a},d.ByteStringBuffer.prototype.getInt32Le=function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,a},d.ByteStringBuffer.prototype.getInt=function(a){var b=0;do b=(b<<8)+this.data.charCodeAt(this.read++),a-=8;while(a>0);return b},d.ByteStringBuffer.prototype.getSignedInt=function(a){var b=this.getInt(a),c=2<<a-2;return b>=c&&(b-=c<<1),b},d.ByteStringBuffer.prototype.getBytes=function(a){var b;return a?(a=Math.min(this.length(),a),b=this.data.slice(this.read,this.read+a),this.read+=a):0===a?b="":(b=0===this.read?this.data:this.data.slice(this.read),this.clear()),b},d.ByteStringBuffer.prototype.bytes=function(a){return"undefined"==typeof a?this.data.slice(this.read):this.data.slice(this.read,this.read+a)},d.ByteStringBuffer.prototype.at=function(a){return this.data.charCodeAt(this.read+a)},d.ByteStringBuffer.prototype.setAt=function(a,b){return this.data=this.data.substr(0,this.read+a)+String.fromCharCode(b)+this.data.substr(this.read+a+1),this},d.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},d.ByteStringBuffer.prototype.copy=function(){var a=d.createBuffer(this.data);return a.read=this.read,a},d.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},d.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},d.ByteStringBuffer.prototype.truncate=function(a){var b=Math.max(0,this.length()-a);return this.data=this.data.substr(this.read,b),this.read=0,this},d.ByteStringBuffer.prototype.toHex=function(){for(var a="",b=this.read;b<this.data.length;++b){var c=this.data.charCodeAt(b);c<16&&(a+="0"),a+=c.toString(16)}return a},d.ByteStringBuffer.prototype.toString=function(){return d.decodeUtf8(this.bytes())},d.DataBuffer=c,d.DataBuffer.prototype.length=function(){return this.write-this.read},d.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},d.DataBuffer.prototype.accommodate=function(a,b){if(this.length()>=a)return this;b=Math.max(b||this.growSize,a);var c=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),d=new Uint8Array(this.length()+b);return d.set(c),this.data=new DataView(d.buffer),this},d.DataBuffer.prototype.putByte=function(a){return this.accommodate(1),this.data.setUint8(this.write++,a),this},d.DataBuffer.prototype.fillWithByte=function(a,b){this.accommodate(b);for(var c=0;c<b;++c)this.data.setUint8(a);return this},d.DataBuffer.prototype.putBytes=function(a,b){if(d.isArrayBufferView(a)){var c=new Uint8Array(a.buffer,a.byteOffset,a.byteLength),e=c.byteLength-c.byteOffset;this.accommodate(e);var f=new Uint8Array(this.data.buffer,this.write);return f.set(c),this.write+=e,this}if(d.isArrayBuffer(a)){var c=new Uint8Array(a);this.accommodate(c.byteLength);var f=new Uint8Array(this.data.buffer);return f.set(c,this.write),this.write+=c.byteLength,this}if(a instanceof d.DataBuffer||"object"==typeof a&&"number"==typeof a.read&&"number"==typeof a.write&&d.isArrayBufferView(a.data)){var c=new Uint8Array(a.data.byteLength,a.read,a.length());this.accommodate(c.byteLength);var f=new Uint8Array(a.data.byteLength,this.write);return f.set(c),this.write+=c.byteLength,this}if(a instanceof d.ByteStringBuffer&&(a=a.data,b="binary"),b=b||"binary","string"==typeof a){var g;if("hex"===b)return this.accommodate(Math.ceil(a.length/2)),g=new Uint8Array(this.data.buffer,this.write),this.write+=d.binary.hex.decode(a,g,this.write),this;if("base64"===b)return this.accommodate(3*Math.ceil(a.length/4)),g=new Uint8Array(this.data.buffer,this.write),this.write+=d.binary.base64.decode(a,g,this.write),this;if("utf8"===b&&(a=d.encodeUtf8(a),b="binary"),"binary"===b||"raw"===b)return this.accommodate(a.length),g=new Uint8Array(this.data.buffer,this.write),this.write+=d.binary.raw.decode(g),this;if("utf16"===b)return this.accommodate(2*a.length),g=new Uint16Array(this.data.buffer,this.write),this.write+=d.text.utf16.encode(g),this;throw new Error("Invalid encoding: "+b)}throw Error("Invalid parameter: "+a)},d.DataBuffer.prototype.putBuffer=function(a){return this.putBytes(a),a.clear(),this},d.DataBuffer.prototype.putString=function(a){return this.putBytes(a,"utf16")},d.DataBuffer.prototype.putInt16=function(a){return this.accommodate(2),this.data.setInt16(this.write,a),this.write+=2,this},d.DataBuffer.prototype.putInt24=function(a){return this.accommodate(3),this.data.setInt16(this.write,a>>8&65535),this.data.setInt8(this.write,a>>16&255),this.write+=3,this},d.DataBuffer.prototype.putInt32=function(a){return this.accommodate(4),this.data.setInt32(this.write,a),this.write+=4,this},d.DataBuffer.prototype.putInt16Le=function(a){return this.accommodate(2),this.data.setInt16(this.write,a,!0),this.write+=2,this},d.DataBuffer.prototype.putInt24Le=function(a){return this.accommodate(3),this.data.setInt8(this.write,a>>16&255),this.data.setInt16(this.write,a>>8&65535,!0),this.write+=3,this},d.DataBuffer.prototype.putInt32Le=function(a){return this.accommodate(4),this.data.setInt32(this.write,a,!0),this.write+=4,this},d.DataBuffer.prototype.putInt=function(a,b){this.accommodate(b/8);do b-=8,this.data.setInt8(this.write++,a>>b&255);while(b>0);return this},d.DataBuffer.prototype.putSignedInt=function(a,b){return this.accommodate(b/8),a<0&&(a+=2<<b-1),this.putInt(a,b)},d.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},d.DataBuffer.prototype.getInt16=function(){var a=this.data.getInt16(this.read);return this.read+=2,a},d.DataBuffer.prototype.getInt24=function(){var a=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,a},d.DataBuffer.prototype.getInt32=function(){var a=this.data.getInt32(this.read);return this.read+=4,a},d.DataBuffer.prototype.getInt16Le=function(){var a=this.data.getInt16(this.read,!0);return this.read+=2,a},d.DataBuffer.prototype.getInt24Le=function(){var a=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,a},d.DataBuffer.prototype.getInt32Le=function(){var a=this.data.getInt32(this.read,!0);return this.read+=4,a},d.DataBuffer.prototype.getInt=function(a){var b=0;do b=(b<<8)+this.data.getInt8(this.read++),a-=8;while(a>0);return b},d.DataBuffer.prototype.getSignedInt=function(a){var b=this.getInt(a),c=2<<a-2;return b>=c&&(b-=c<<1),b},d.DataBuffer.prototype.getBytes=function(a){var b;return a?(a=Math.min(this.length(),a),b=this.data.slice(this.read,this.read+a),this.read+=a):0===a?b="":(b=0===this.read?this.data:this.data.slice(this.read),this.clear()),b},d.DataBuffer.prototype.bytes=function(a){return"undefined"==typeof a?this.data.slice(this.read):this.data.slice(this.read,this.read+a)},d.DataBuffer.prototype.at=function(a){return this.data.getUint8(this.read+a)},d.DataBuffer.prototype.setAt=function(a,b){return this.data.setUint8(a,b),this},d.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},d.DataBuffer.prototype.copy=function(){return new d.DataBuffer(this)},d.DataBuffer.prototype.compact=function(){if(this.read>0){var a=new Uint8Array(this.data.buffer,this.read),b=new Uint8Array(a.byteLength);b.set(a),this.data=new DataView(b),this.write-=this.read,this.read=0}return this},d.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},d.DataBuffer.prototype.truncate=function(a){return this.write=Math.max(0,this.length()-a),this.read=Math.min(this.read,this.write),this},d.DataBuffer.prototype.toHex=function(){for(var a="",b=this.read;b<this.data.byteLength;++b){var c=this.data.getUint8(b);c<16&&(a+="0"),a+=c.toString(16)}return a},d.DataBuffer.prototype.toString=function(a){var b=new Uint8Array(this.data,this.read,this.length());if(a=a||"utf8","binary"===a||"raw"===a)return d.binary.raw.encode(b);if("hex"===a)return d.binary.hex.encode(b);if("base64"===a)return d.binary.base64.encode(b);if("utf8"===a)return d.text.utf8.decode(b);if("utf16"===a)return d.text.utf16.decode(b);throw new Error("Invalid encoding: "+a)},d.createBuffer=function(a,b){return b=b||"raw",void 0!==a&&"utf8"===b&&(a=d.encodeUtf8(a)),new d.ByteBuffer(a)},d.fillString=function(a,b){for(var c="";b>0;)1&b&&(c+=a),b>>>=1,b>0&&(a+=a);return c},d.xorBytes=function(a,b,c){for(var d="",e="",f="",g=0,h=0;c>0;--c,++g)e=a.charCodeAt(g)^b.charCodeAt(g),h>=10&&(d+=f,f="",h=0),f+=String.fromCharCode(e),++h;return d+=f},d.hexToBytes=function(a){var b="",c=0;for(a.length&!0&&(c=1,b+=String.fromCharCode(parseInt(a[0],16)));c<a.length;c+=2)b+=String.fromCharCode(parseInt(a.substr(c,2),16));return b},d.bytesToHex=function(a){return d.createBuffer(a).toHex()},d.int32ToBytes=function(a){return String.fromCharCode(a>>24&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(255&a)};var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",g=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];d.encode64=function(a,b){for(var c,d,e,g="",h="",i=0;i<a.length;)c=a.charCodeAt(i++),d=a.charCodeAt(i++),e=a.charCodeAt(i++),g+=f.charAt(c>>2),g+=f.charAt((3&c)<<4|d>>4),isNaN(d)?g+="==":(g+=f.charAt((15&d)<<2|e>>6),g+=isNaN(e)?"=":f.charAt(63&e)),b&&g.length>b&&(h+=g.substr(0,b)+"\r\n",g=g.substr(b));return h+=g},d.decode64=function(a){a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var b,c,d,e,f="",h=0;h<a.length;)b=g[a.charCodeAt(h++)-43],c=g[a.charCodeAt(h++)-43],d=g[a.charCodeAt(h++)-43],e=g[a.charCodeAt(h++)-43],f+=String.fromCharCode(b<<2|c>>4),64!==d&&(f+=String.fromCharCode((15&c)<<4|d>>2),64!==e&&(f+=String.fromCharCode((3&d)<<6|e)));return f},d.encodeUtf8=function(a){return unescape(encodeURIComponent(a))},d.decodeUtf8=function(a){return decodeURIComponent(escape(a))},d.binary={raw:{},hex:{},base64:{}},d.binary.raw.encode=function(a){return String.fromCharCode.apply(null,a)},d.binary.raw.decode=function(a,b,c){var d=b;d||(d=new Uint8Array(a.length)),c=c||0;for(var e=c,f=0;f<a.length;++f)d[e++]=a.charCodeAt(f);return b?e-c:d},d.binary.hex.encode=d.bytesToHex,d.binary.hex.decode=function(a,b,c){var d=b;d||(d=new Uint8Array(Math.ceil(a.length/2))),c=c||0;var e=0,f=c;for(1&a.length&&(e=1,d[f++]=parseInt(a[0],16));e<a.length;e+=2)d[f++]=parseInt(a.substr(e,2),16);return b?f-c:d},d.binary.base64.encode=function(a,b){for(var c,d,e,g="",h="",i=0;i<a.byteLength;)c=a[i++],d=a[i++],e=a[i++],g+=f.charAt(c>>2),g+=f.charAt((3&c)<<4|d>>4),isNaN(d)?g+="==":(g+=f.charAt((15&d)<<2|e>>6),g+=isNaN(e)?"=":f.charAt(63&e)),b&&g.length>b&&(h+=g.substr(0,b)+"\r\n",g=g.substr(b));return h+=g},d.binary.base64.decode=function(a,b,c){var d=b;d||(d=new Uint8Array(3*Math.ceil(a.length/4))),a=a.replace(/[^A-Za-z0-9\+\/\=]/g,""),c=c||0;for(var e,f,h,i,j=0,k=c;j<a.length;)e=g[a.charCodeAt(j++)-43],f=g[a.charCodeAt(j++)-43],h=g[a.charCodeAt(j++)-43],i=g[a.charCodeAt(j++)-43],d[k++]=e<<2|f>>4,64!==h&&(d[k++]=(15&f)<<4|h>>2,64!==i&&(d[k++]=(3&h)<<6|i));return b?k-c:d.subarray(0,k)},d.text={utf8:{},utf16:{}},d.text.utf8.encode=function(a,b,c){a=d.encodeUtf8(a);var e=b;e||(e=new Uint8Array(a.length)),c=c||0;for(var f=c,g=0;g<a.length;++g)e[f++]=a.charCodeAt(g);return b?f-c:e},d.text.utf8.decode=function(a){return d.decodeUtf8(String.fromCharCode.apply(null,a))},d.text.utf16.encode=function(a,b,c){var d=b;d||(d=new Uint8Array(a.length));var e=new Uint16Array(d);c=c||0;for(var f=c,g=c,h=0;h<a.length;++h)e[g++]=a.charCodeAt(h),f+=2;return b?f-c:d},d.text.utf16.decode=function(a){return String.fromCharCode.apply(null,new Uint16Array(a))},d.deflate=function(a,b,c){if(b=d.decode64(a.deflate(d.encode64(b)).rval),c){var e=2,f=b.charCodeAt(1);32&f&&(e=6),b=b.substring(e,b.length-4)}return b},d.inflate=function(a,b,c){
var e=a.inflate(d.encode64(b)).rval;return null===e?null:d.decode64(e)};var h=function(a,b,c){if(!a)throw new Error("WebStorage not available.");var e;if(null===c?e=a.removeItem(b):(c=d.encode64(JSON.stringify(c)),e=a.setItem(b,c)),"undefined"!=typeof e&&e.rval!==!0){var f=new Error(e.error.message);throw f.id=e.error.id,f.name=e.error.name,f}},i=function(a,b){if(!a)throw new Error("WebStorage not available.");var c=a.getItem(b);if(a.init)if(null===c.rval){if(c.error){var e=new Error(c.error.message);throw e.id=c.error.id,e.name=c.error.name,e}c=null}else c=c.rval;return null!==c&&(c=JSON.parse(d.decode64(c))),c},j=function(a,b,c,d){var e=i(a,b);null===e&&(e={}),e[c]=d,h(a,b,e)},k=function(a,b,c){var d=i(a,b);return null!==d&&(d=c in d?d[c]:null),d},l=function(a,b,c){var d=i(a,b);if(null!==d&&c in d){delete d[c];var e=!0;for(var f in d){e=!1;break}e&&(d=null),h(a,b,d)}},m=function(a,b){h(a,b,null)},n=function(a,b,c){var d=null;"undefined"==typeof c&&(c=["web","flash"]);var e,f=!1,g=null;for(var h in c){e=c[h];try{if("flash"===e||"both"===e){if(null===b[0])throw new Error("Flash local storage not available.");d=a.apply(this,b),f="flash"===e}"web"!==e&&"both"!==e||(b[0]=localStorage,d=a.apply(this,b),f=!0)}catch(a){g=a}if(f)break}if(!f)throw g;return d};d.setItem=function(a,b,c,d,e){n(j,arguments,e)},d.getItem=function(a,b,c,d){return n(k,arguments,d)},d.removeItem=function(a,b,c,d){n(l,arguments,d)},d.clearItems=function(a,b,c){n(m,arguments,c)},d.parseUrl=function(a){var b=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;b.lastIndex=0;var c=b.exec(a),d=null===c?null:{full:a,scheme:c[1],host:c[2],port:c[3],path:c[4]};return d&&(d.fullHost=d.host,d.port?80!==d.port&&"http"===d.scheme?d.fullHost+=":"+d.port:443!==d.port&&"https"===d.scheme&&(d.fullHost+=":"+d.port):"http"===d.scheme?d.port=80:"https"===d.scheme&&(d.port=443),d.full=d.scheme+"://"+d.fullHost),d};var o=null;d.getQueryVariables=function(a){var b,c=function(a){for(var b={},c=a.split("&"),d=0;d<c.length;d++){var e,f,g=c[d].indexOf("=");g>0?(e=c[d].substring(0,g),f=c[d].substring(g+1)):(e=c[d],f=null),e in b||(b[e]=[]),e in Object.prototype||null===f||b[e].push(unescape(f))}return b};return"undefined"==typeof a?(null===o&&(o="undefined"!=typeof window&&window.location&&window.location.search?c(window.location.search.substring(1)):{}),b=o):b=c(a),b},d.parseFragment=function(a){var b=a,c="",e=a.indexOf("?");e>0&&(b=a.substring(0,e),c=a.substring(e+1));var f=b.split("/");f.length>0&&""===f[0]&&f.shift();var g=""===c?{}:d.getQueryVariables(c);return{pathString:b,queryString:c,path:f,query:g}},d.makeRequest=function(a){var b=d.parseFragment(a),c={path:b.pathString,query:b.queryString,getPath:function(a){return"undefined"==typeof a?b.path:b.path[a]},getQuery:function(a,c){var d;return"undefined"==typeof a?d=b.query:(d=b.query[a],d&&"undefined"!=typeof c&&(d=d[c])),d},getQueryLast:function(a,b){var d,e=c.getQuery(a);return d=e?e[e.length-1]:b}};return c},d.makeLink=function(a,b,c){a=jQuery.isArray(a)?a.join("/"):a;var d=jQuery.param(b||{});return c=c||"",a+(d.length>0?"?"+d:"")+(c.length>0?"#"+c:"")},d.setPath=function(a,b,c){if("object"==typeof a&&null!==a)for(var d=0,e=b.length;d<e;){var f=b[d++];if(d==e)a[f]=c;else{var g=f in a;(!g||g&&"object"!=typeof a[f]||g&&null===a[f])&&(a[f]={}),a=a[f]}}},d.getPath=function(a,b,c){for(var d=0,e=b.length,f=!0;f&&d<e&&"object"==typeof a&&null!==a;){var g=b[d++];f=g in a,f&&(a=a[g])}return f?a:c},d.deletePath=function(a,b){if("object"==typeof a&&null!==a)for(var c=0,d=b.length;c<d;){var e=b[c++];if(c==d)delete a[e];else{if(!(e in a)||"object"!=typeof a[e]||null===a[e])break;a=a[e]}}},d.isEmpty=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},d.format=function(a){for(var b,c,d=/%./g,e=0,f=[],g=0;b=d.exec(a);){c=a.substring(g,d.lastIndex-2),c.length>0&&f.push(c),g=d.lastIndex;var h=b[0][1];switch(h){case"s":case"o":e<arguments.length?f.push(arguments[e++ +1]):f.push("<?>");break;case"%":f.push("%");break;default:f.push("<%"+h+"?>")}}return f.push(a.substring(g)),f.join("")},d.formatNumber=function(a,b,c,d){var e=a,f=isNaN(b=Math.abs(b))?2:b,g=void 0===c?",":c,h=void 0===d?".":d,i=e<0?"-":"",j=parseInt(e=Math.abs(+e||0).toFixed(f),10)+"",k=j.length>3?j.length%3:0;return i+(k?j.substr(0,k)+h:"")+j.substr(k).replace(/(\d{3})(?=\d)/g,"$1"+h)+(f?g+Math.abs(e-j).toFixed(f).slice(2):"")},d.formatSize=function(a){return a=a>=1073741824?d.formatNumber(a/1073741824,2,".","")+" GiB":a>=1048576?d.formatNumber(a/1048576,2,".","")+" MiB":a>=1024?d.formatNumber(a/1024,0)+" KiB":d.formatNumber(a,0)+" bytes"},d.bytesFromIP=function(a){return a.indexOf(".")!==-1?d.bytesFromIPv4(a):a.indexOf(":")!==-1?d.bytesFromIPv6(a):null},d.bytesFromIPv4=function(a){if(a=a.split("."),4!==a.length)return null;for(var b=d.createBuffer(),c=0;c<a.length;++c){var e=parseInt(a[c],10);if(isNaN(e))return null;b.putByte(e)}return b.getBytes()},d.bytesFromIPv6=function(a){var b=0;a=a.split(":").filter(function(a){return 0===a.length&&++b,!0});for(var c=2*(8-a.length+b),e=d.createBuffer(),f=0;f<8;++f)if(a[f]&&0!==a[f].length){var g=d.hexToBytes(a[f]);g.length<2&&e.putByte(0),e.putBytes(g)}else e.fillWithByte(0,c),c=0;return e.getBytes()},d.bytesToIP=function(a){return 4===a.length?d.bytesToIPv4(a):16===a.length?d.bytesToIPv6(a):null},d.bytesToIPv4=function(a){if(4!==a.length)return null;for(var b=[],c=0;c<a.length;++c)b.push(a.charCodeAt(c));return b.join(".")},d.bytesToIPv6=function(a){if(16!==a.length)return null;for(var b=[],c=[],e=0,f=0;f<a.length;f+=2){for(var g=d.bytesToHex(a[f]+a[f+1]);"0"===g[0]&&"0"!==g;)g=g.substr(1);if("0"===g){var h=c[c.length-1],i=b.length;h&&i===h.end+1?(h.end=i,h.end-h.start>c[e].end-c[e].start&&(e=c.length-1)):c.push({start:i,end:i})}b.push(g)}if(c.length>0){var j=c[e];j.end-j.start>0&&(b.splice(j.start,j.end-j.start+1,""),0===j.start&&b.unshift(""),7===j.end&&b.push(""))}return b.join(":")},d.estimateCores=function(a,b){function c(a,h,i){if(0===h){var j=Math.floor(a.reduce(function(a,b){return a+b},0)/a.length);return d.cores=Math.max(1,j),URL.revokeObjectURL(g),b(null,d.cores)}e(i,function(b,d){a.push(f(i,d)),c(a,h-1,i)})}function e(a,b){for(var c=[],d=[],e=0;e<a;++e){var f=new Worker(g);f.addEventListener("message",function(e){if(d.push(e.data),d.length===a){for(var f=0;f<a;++f)c[f].terminate();b(null,d)}}),c.push(f)}for(var e=0;e<a;++e)c[e].postMessage(e)}function f(a,b){for(var c=[],d=0;d<a;++d)for(var e=b[d],f=c[d]=[],g=0;g<a;++g)if(d!==g){var h=b[g];(e.st>h.st&&e.st<h.et||h.st>e.st&&h.st<e.et)&&f.push(g)}return c.reduce(function(a,b){return Math.max(a,b.length)},0)}if("function"==typeof a&&(b=a,a={}),a=a||{},"cores"in d&&!a.update)return b(null,d.cores);if("undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return d.cores=navigator.hardwareConcurrency,b(null,d.cores);if("undefined"==typeof Worker)return d.cores=1,b(null,d.cores);if("undefined"==typeof Blob)return d.cores=2,b(null,d.cores);var g=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(a){for(var b=Date.now(),c=b+4;Date.now()<c;);self.postMessage({st:b,et:c})})}.toString(),")()"],{type:"application/javascript"}));c([],5,16)}}var d="util";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/util",["require","module"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){a.cipher=a.cipher||{},a.cipher.algorithms=a.cipher.algorithms||{},a.cipher.createCipher=function(b,c){var d=b;if("string"==typeof d&&(d=a.cipher.getAlgorithm(d),d&&(d=d())),!d)throw new Error("Unsupported algorithm: "+b);return new a.cipher.BlockCipher({algorithm:d,key:c,decrypt:!1})},a.cipher.createDecipher=function(b,c){var d=b;if("string"==typeof d&&(d=a.cipher.getAlgorithm(d),d&&(d=d())),!d)throw new Error("Unsupported algorithm: "+b);return new a.cipher.BlockCipher({algorithm:d,key:c,decrypt:!0})},a.cipher.registerAlgorithm=function(b,c){b=b.toUpperCase(),a.cipher.algorithms[b]=c},a.cipher.getAlgorithm=function(b){return b=b.toUpperCase(),b in a.cipher.algorithms?a.cipher.algorithms[b]:null};var b=a.cipher.BlockCipher=function(a){this.algorithm=a.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=a.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=a.decrypt,this.algorithm.initialize(a)};b.prototype.start=function(b){b=b||{};var c={};for(var d in b)c[d]=b[d];c.decrypt=this._decrypt,this._finish=!1,this._input=a.util.createBuffer(),this.output=b.output||a.util.createBuffer(),this.mode.start(c)},b.prototype.update=function(a){for(a&&this._input.putBuffer(a);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},b.prototype.finish=function(a){a&&"CBC"===this.mode.name&&(this.mode.pad=function(b){return a(this.blockSize,b,!1)},this.mode.unpad=function(b){return a(this.blockSize,b,!0)});var b={};return b.decrypt=this._decrypt,b.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,b))&&(this._finish=!0,this.update(),!(this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,b))&&!(this.mode.afterFinish&&!this.mode.afterFinish(this.output,b)))}}var d="cipher";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/cipher",["require","module","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(b){if("string"==typeof b&&(b=a.util.createBuffer(b)),a.util.isArray(b)&&b.length>4){var c=b;b=a.util.createBuffer();for(var d=0;d<c.length;++d)b.putByte(c[d])}return a.util.isArray(b)||(b=[b.getInt32(),b.getInt32(),b.getInt32(),b.getInt32()]),b}function c(a){a[a.length-1]=a[a.length-1]+1&4294967295}function d(a){return[a/4294967296|0,4294967295&a]}a.cipher=a.cipher||{};var e=a.cipher.modes=a.cipher.modes||{};e.ecb=function(a){a=a||{},this.name="ECB",this.cipher=a.cipher,this.blockSize=a.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.ecb.prototype.start=function(a){},e.ecb.prototype.encrypt=function(a,b,c){if(a.length()<this.blockSize&&!(c&&a.length()>0))return!0;for(var d=0;d<this._ints;++d)this._inBlock[d]=a.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var d=0;d<this._ints;++d)b.putInt32(this._outBlock[d])},e.ecb.prototype.decrypt=function(a,b,c){if(a.length()<this.blockSize&&!(c&&a.length()>0))return!0;for(var d=0;d<this._ints;++d)this._inBlock[d]=a.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var d=0;d<this._ints;++d)b.putInt32(this._outBlock[d])},e.ecb.prototype.pad=function(a,b){var c=a.length()===this.blockSize?this.blockSize:this.blockSize-a.length();return a.fillWithByte(c,c),!0},e.ecb.prototype.unpad=function(a,b){if(b.overflow>0)return!1;var c=a.length(),d=a.at(c-1);return!(d>this.blockSize<<2)&&(a.truncate(d),!0)},e.cbc=function(a){a=a||{},this.name="CBC",this.cipher=a.cipher,this.blockSize=a.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.cbc.prototype.start=function(a){if(null===a.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in a))throw new Error("Invalid IV parameter.");this._iv=b(a.iv),this._prev=this._iv.slice(0)}},e.cbc.prototype.encrypt=function(a,b,c){if(a.length()<this.blockSize&&!(c&&a.length()>0))return!0;for(var d=0;d<this._ints;++d)this._inBlock[d]=this._prev[d]^a.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var d=0;d<this._ints;++d)b.putInt32(this._outBlock[d]);this._prev=this._outBlock},e.cbc.prototype.decrypt=function(a,b,c){if(a.length()<this.blockSize&&!(c&&a.length()>0))return!0;for(var d=0;d<this._ints;++d)this._inBlock[d]=a.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var d=0;d<this._ints;++d)b.putInt32(this._prev[d]^this._outBlock[d]);this._prev=this._inBlock.slice(0)},e.cbc.prototype.pad=function(a,b){var c=a.length()===this.blockSize?this.blockSize:this.blockSize-a.length();return a.fillWithByte(c,c),!0},e.cbc.prototype.unpad=function(a,b){if(b.overflow>0)return!1;var c=a.length(),d=a.at(c-1);return!(d>this.blockSize<<2)&&(a.truncate(d),!0)},e.cfb=function(b){b=b||{},this.name="CFB",this.cipher=b.cipher,this.blockSize=b.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=a.util.createBuffer(),this._partialBytes=0},e.cfb.prototype.start=function(a){if(!("iv"in a))throw new Error("Invalid IV parameter.");this._iv=b(a.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.cfb.prototype.encrypt=function(a,b,c){var d=a.length();if(0===d)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&d>=this.blockSize)for(var e=0;e<this._ints;++e)this._inBlock[e]=a.getInt32()^this._outBlock[e],b.putInt32(this._inBlock[e]);else{var f=(this.blockSize-d)%this.blockSize;f>0&&(f=this.blockSize-f),this._partialOutput.clear();for(var e=0;e<this._ints;++e)this._partialBlock[e]=a.getInt32()^this._outBlock[e],this._partialOutput.putInt32(this._partialBlock[e]);if(f>0)a.read-=this.blockSize;else for(var e=0;e<this._ints;++e)this._inBlock[e]=this._partialBlock[e];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),f>0&&!c)return b.putBytes(this._partialOutput.getBytes(f-this._partialBytes)),this._partialBytes=f,!0;b.putBytes(this._partialOutput.getBytes(d-this._partialBytes)),this._partialBytes=0}},e.cfb.prototype.decrypt=function(a,b,c){var d=a.length();if(0===d)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&d>=this.blockSize)for(var e=0;e<this._ints;++e)this._inBlock[e]=a.getInt32(),b.putInt32(this._inBlock[e]^this._outBlock[e]);else{var f=(this.blockSize-d)%this.blockSize;f>0&&(f=this.blockSize-f),this._partialOutput.clear();for(var e=0;e<this._ints;++e)this._partialBlock[e]=a.getInt32(),this._partialOutput.putInt32(this._partialBlock[e]^this._outBlock[e]);if(f>0)a.read-=this.blockSize;else for(var e=0;e<this._ints;++e)this._inBlock[e]=this._partialBlock[e];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),f>0&&!c)return b.putBytes(this._partialOutput.getBytes(f-this._partialBytes)),this._partialBytes=f,!0;b.putBytes(this._partialOutput.getBytes(d-this._partialBytes)),this._partialBytes=0}},e.ofb=function(b){b=b||{},this.name="OFB",this.cipher=b.cipher,this.blockSize=b.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=a.util.createBuffer(),this._partialBytes=0},e.ofb.prototype.start=function(a){if(!("iv"in a))throw new Error("Invalid IV parameter.");this._iv=b(a.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ofb.prototype.encrypt=function(a,b,c){var d=a.length();if(0===a.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&d>=this.blockSize)for(var e=0;e<this._ints;++e)b.putInt32(a.getInt32()^this._outBlock[e]),this._inBlock[e]=this._outBlock[e];else{var f=(this.blockSize-d)%this.blockSize;f>0&&(f=this.blockSize-f),this._partialOutput.clear();for(var e=0;e<this._ints;++e)this._partialOutput.putInt32(a.getInt32()^this._outBlock[e]);if(f>0)a.read-=this.blockSize;else for(var e=0;e<this._ints;++e)this._inBlock[e]=this._outBlock[e];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),f>0&&!c)return b.putBytes(this._partialOutput.getBytes(f-this._partialBytes)),this._partialBytes=f,!0;b.putBytes(this._partialOutput.getBytes(d-this._partialBytes)),this._partialBytes=0}},e.ofb.prototype.decrypt=e.ofb.prototype.encrypt,e.ctr=function(b){b=b||{},this.name="CTR",this.cipher=b.cipher,this.blockSize=b.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=a.util.createBuffer(),this._partialBytes=0},e.ctr.prototype.start=function(a){if(!("iv"in a))throw new Error("Invalid IV parameter.");this._iv=b(a.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ctr.prototype.encrypt=function(a,b,d){var e=a.length();if(0===e)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&e>=this.blockSize)for(var f=0;f<this._ints;++f)b.putInt32(a.getInt32()^this._outBlock[f]);else{var g=(this.blockSize-e)%this.blockSize;g>0&&(g=this.blockSize-g),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialOutput.putInt32(a.getInt32()^this._outBlock[f]);if(g>0&&(a.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),g>0&&!d)return b.putBytes(this._partialOutput.getBytes(g-this._partialBytes)),this._partialBytes=g,!0;b.putBytes(this._partialOutput.getBytes(e-this._partialBytes)),this._partialBytes=0}c(this._inBlock)},e.ctr.prototype.decrypt=e.ctr.prototype.encrypt,e.gcm=function(b){b=b||{},this.name="GCM",this.cipher=b.cipher,this.blockSize=b.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=a.util.createBuffer(),this._partialBytes=0,this._R=3774873600},e.gcm.prototype.start=function(b){if(!("iv"in b))throw new Error("Invalid IV parameter.");var e=a.util.createBuffer(b.iv);this._cipherLength=0;var f;if(f="additionalData"in b?a.util.createBuffer(b.additionalData):a.util.createBuffer(),"tagLength"in b?this._tagLength=b.tagLength:this._tagLength=128,this._tag=null,b.decrypt&&(this._tag=a.util.createBuffer(b.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var g=e.length();if(12===g)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(d(8*g)))}this._inBlock=this._j0.slice(0),c(this._inBlock),this._partialBytes=0,f=a.util.createBuffer(f),this._aDataLength=d(8*f.length());var h=f.length()%this.blockSize;for(h&&f.fillWithByte(0,this.blockSize-h),this._s=[0,0,0,0];f.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[f.getInt32(),f.getInt32(),f.getInt32(),f.getInt32()])},e.gcm.prototype.encrypt=function(a,b,d){var e=a.length();if(0===e)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&e>=this.blockSize){for(var f=0;f<this._ints;++f)b.putInt32(this._outBlock[f]^=a.getInt32());this._cipherLength+=this.blockSize}else{var g=(this.blockSize-e)%this.blockSize;g>0&&(g=this.blockSize-g),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialOutput.putInt32(a.getInt32()^this._outBlock[f]);if(0===g||d){if(d){var h=e%this.blockSize;this._cipherLength+=h,this._partialOutput.truncate(this.blockSize-h)}else this._cipherLength+=this.blockSize;for(var f=0;f<this._ints;++f)this._outBlock[f]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),g>0&&!d)return a.read-=this.blockSize,b.putBytes(this._partialOutput.getBytes(g-this._partialBytes)),this._partialBytes=g,!0;b.putBytes(this._partialOutput.getBytes(e-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),c(this._inBlock)},e.gcm.prototype.decrypt=function(a,b,d){var e=a.length();if(e<this.blockSize&&!(d&&e>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),c(this._inBlock),this._hashBlock[0]=a.getInt32(),this._hashBlock[1]=a.getInt32(),this._hashBlock[2]=a.getInt32(),this._hashBlock[3]=a.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var f=0;f<this._ints;++f)b.putInt32(this._outBlock[f]^this._hashBlock[f]);e<this.blockSize?this._cipherLength+=e%this.blockSize:this._cipherLength+=this.blockSize},e.gcm.prototype.afterFinish=function(b,c){var e=!0;c.decrypt&&c.overflow&&b.truncate(this.blockSize-c.overflow),this.tag=a.util.createBuffer();var f=this._aDataLength.concat(d(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,f);var g=[];this.cipher.encrypt(this._j0,g);for(var h=0;h<this._ints;++h)this.tag.putInt32(this._s[h]^g[h]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),c.decrypt&&this.tag.bytes()!==this._tag&&(e=!1),e},e.gcm.prototype.multiply=function(a,b){for(var c=[0,0,0,0],d=b.slice(0),e=0;e<128;++e){var f=a[e/32|0]&1<<31-e%32;f&&(c[0]^=d[0],c[1]^=d[1],c[2]^=d[2],c[3]^=d[3]),this.pow(d,d)}return c},e.gcm.prototype.pow=function(a,b){for(var c=1&a[3],d=3;d>0;--d)b[d]=a[d]>>>1|(1&a[d-1])<<31;b[0]=a[0]>>>1,c&&(b[0]^=this._R)},e.gcm.prototype.tableMultiply=function(a){for(var b=[0,0,0,0],c=0;c<32;++c){var d=c/8|0,e=a[d]>>>4*(7-c%8)&15,f=this._m[c][e];b[0]^=f[0],b[1]^=f[1],b[2]^=f[2],b[3]^=f[3]}return b},e.gcm.prototype.ghash=function(a,b,c){return b[0]^=c[0],b[1]^=c[1],b[2]^=c[2],b[3]^=c[3],this.tableMultiply(b)},e.gcm.prototype.generateHashTable=function(a,b){for(var c=8/b,d=4*c,e=16*c,f=new Array(e),g=0;g<e;++g){var h=[0,0,0,0],i=g/d|0,j=(d-1-g%d)*b;h[i]=1<<b-1<<j,f[g]=this.generateSubHashTable(this.multiply(h,a),b)}return f},e.gcm.prototype.generateSubHashTable=function(a,b){var c=1<<b,d=c>>>1,e=new Array(c);e[d]=a.slice(0);for(var f=d>>>1;f>0;)this.pow(e[2*f],e[f]=[]),f>>=1;for(f=2;f<d;){for(var g=1;g<f;++g){var h=e[f],i=e[g];e[f+g]=[h[0]^i[0],h[1]^i[1],h[2]^i[2],h[3]^i[3]]}f*=2}for(e[0]=[0,0,0,0],f=d+1;f<c;++f){var j=e[f^d];e[f]=[a[0]^j[0],a[1]^j[1],a[2]^j[2],a[3]^j[3]]}return e}}var d="cipherModes";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/cipherModes",["require","module","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(b,c){var d=function(){return new a.aes.Algorithm(b,c)};a.cipher.registerAlgorithm(b,d)}function c(){l=!0,i=[0,1,2,4,8,16,32,64,128,27,54];for(var a=new Array(256),b=0;b<128;++b)a[b]=b<<1,a[b+128]=b+128<<1^283;g=new Array(256),h=new Array(256),j=new Array(4),k=new Array(4);for(var b=0;b<4;++b)j[b]=new Array(256),k[b]=new Array(256);for(var c,d,e,f,m,n,o,p=0,q=0,b=0;b<256;++b){f=q^q<<1^q<<2^q<<3^q<<4,f=f>>8^255&f^99,g[p]=f,h[f]=p,m=a[f],c=a[p],d=a[c],e=a[d],n=m<<24^f<<16^f<<8^(f^m),o=(c^d^e)<<24^(p^e)<<16^(p^d^e)<<8^(p^c^e);for(var r=0;r<4;++r)j[r][p]=n,k[r][f]=o,n=n<<24|n>>>8,o=o<<24|o>>>8;0===p?p=q=1:(p=c^a[a[a[c^e]]],q^=a[a[q]])}}function d(a,b){for(var c,d=a.slice(0),e=1,f=d.length,h=f+6+1,j=m*h,l=f;l<j;++l)c=d[l-1],l%f===0?(c=g[c>>>16&255]<<24^g[c>>>8&255]<<16^g[255&c]<<8^g[c>>>24]^i[e]<<24,e++):f>6&&l%f===4&&(c=g[c>>>24]<<24^g[c>>>16&255]<<16^g[c>>>8&255]<<8^g[255&c]),d[l]=d[l-f]^c;if(b){var n,o=k[0],p=k[1],q=k[2],r=k[3],s=d.slice(0);j=d.length;for(var l=0,t=j-m;l<j;l+=m,t-=m)if(0===l||l===j-m)s[l]=d[t],s[l+1]=d[t+3],s[l+2]=d[t+2],s[l+3]=d[t+1];else for(var u=0;u<m;++u)n=d[t+u],s[l+(3&-u)]=o[g[n>>>24]]^p[g[n>>>16&255]]^q[g[n>>>8&255]]^r[g[255&n]];d=s}return d}function e(a,b,c,d){var e,f,i,l,m,n=a.length/4-1;d?(e=k[0],f=k[1],i=k[2],l=k[3],m=h):(e=j[0],f=j[1],i=j[2],l=j[3],m=g);var o,p,q,r,s,t,u;o=b[0]^a[0],p=b[d?3:1]^a[1],q=b[2]^a[2],r=b[d?1:3]^a[3];for(var v=3,w=1;w<n;++w)s=e[o>>>24]^f[p>>>16&255]^i[q>>>8&255]^l[255&r]^a[++v],t=e[p>>>24]^f[q>>>16&255]^i[r>>>8&255]^l[255&o]^a[++v],u=e[q>>>24]^f[r>>>16&255]^i[o>>>8&255]^l[255&p]^a[++v],r=e[r>>>24]^f[o>>>16&255]^i[p>>>8&255]^l[255&q]^a[++v],o=s,p=t,q=u;c[0]=m[o>>>24]<<24^m[p>>>16&255]<<16^m[q>>>8&255]<<8^m[255&r]^a[++v],c[d?3:1]=m[p>>>24]<<24^m[q>>>16&255]<<16^m[r>>>8&255]<<8^m[255&o]^a[++v],c[2]=m[q>>>24]<<24^m[r>>>16&255]<<16^m[o>>>8&255]<<8^m[255&p]^a[++v],c[d?1:3]=m[r>>>24]<<24^m[o>>>16&255]<<16^m[p>>>8&255]<<8^m[255&q]^a[++v]}function f(b){b=b||{};var c,d=(b.mode||"CBC").toUpperCase(),e="AES-"+d;c=b.decrypt?a.cipher.createDecipher(e,b.key):a.cipher.createCipher(e,b.key);var f=c.start;return c.start=function(b,d){var e=null;d instanceof a.util.ByteBuffer&&(e=d,d={}),d=d||{},d.output=e,d.iv=b,f.call(c,d)},c}a.aes=a.aes||{},a.aes.startEncrypting=function(a,b,c,d){var e=f({key:a,output:c,decrypt:!1,mode:d});return e.start(b),e},a.aes.createEncryptionCipher=function(a,b){return f({key:a,output:null,decrypt:!1,mode:b})},a.aes.startDecrypting=function(a,b,c,d){var e=f({key:a,output:c,decrypt:!0,mode:d});return e.start(b),e},a.aes.createDecryptionCipher=function(a,b){return f({key:a,output:null,decrypt:!0,mode:b})},a.aes.Algorithm=function(a,b){l||c();var d=this;d.name=a,d.mode=new b({blockSize:16,cipher:{encrypt:function(a,b){return e(d._w,a,b,!1)},decrypt:function(a,b){return e(d._w,a,b,!0)}}}),d._init=!1},a.aes.Algorithm.prototype.initialize=function(b){if(!this._init){var c,e=b.key;if("string"!=typeof e||16!==e.length&&24!==e.length&&32!==e.length){if(a.util.isArray(e)&&(16===e.length||24===e.length||32===e.length)){c=e,e=a.util.createBuffer();for(var f=0;f<c.length;++f)e.putByte(c[f])}}else e=a.util.createBuffer(e);if(!a.util.isArray(e)){c=e,e=[];var g=c.length();if(16===g||24===g||32===g){g>>>=2;for(var f=0;f<g;++f)e.push(c.getInt32())}}if(!a.util.isArray(e)||4!==e.length&&6!==e.length&&8!==e.length)throw new Error("Invalid key parameter.");var h=this.mode.name,i=["CFB","OFB","CTR","GCM"].indexOf(h)!==-1;this._w=d(e,b.decrypt&&!i),this._init=!0}},a.aes._expandKey=function(a,b){return l||c(),d(a,b)},a.aes._updateBlock=e,b("AES-CBC",a.cipher.modes.cbc),b("AES-CFB",a.cipher.modes.cfb),b("AES-OFB",a.cipher.modes.ofb),b("AES-CTR",a.cipher.modes.ctr),b("AES-GCM",a.cipher.modes.gcm);var g,h,i,j,k,l=!1,m=4}var d="aes";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/aes",["require","module","./cipher","./cipherModes","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){a.pki=a.pki||{};var b=a.pki.oids=a.oids=a.oids||{};b["1.2.840.113549.1.1.1"]="rsaEncryption",b.rsaEncryption="1.2.840.113549.1.1.1",b["1.2.840.113549.1.1.4"]="md5WithRSAEncryption",b.md5WithRSAEncryption="1.2.840.113549.1.1.4",b["1.2.840.113549.1.1.5"]="sha1WithRSAEncryption",b.sha1WithRSAEncryption="1.2.840.113549.1.1.5",b["1.2.840.113549.1.1.7"]="RSAES-OAEP",b["RSAES-OAEP"]="1.2.840.113549.1.1.7",b["1.2.840.113549.1.1.8"]="mgf1",b.mgf1="1.2.840.113549.1.1.8",b["1.2.840.113549.1.1.9"]="pSpecified",b.pSpecified="1.2.840.113549.1.1.9",b["1.2.840.113549.1.1.10"]="RSASSA-PSS",b["RSASSA-PSS"]="1.2.840.113549.1.1.10",b["1.2.840.113549.1.1.11"]="sha256WithRSAEncryption",b.sha256WithRSAEncryption="1.2.840.113549.1.1.11",b["1.2.840.113549.1.1.12"]="sha384WithRSAEncryption",b.sha384WithRSAEncryption="1.2.840.113549.1.1.12",b["1.2.840.113549.1.1.13"]="sha512WithRSAEncryption",b.sha512WithRSAEncryption="1.2.840.113549.1.1.13",b["1.3.14.3.2.7"]="desCBC",b.desCBC="1.3.14.3.2.7",b["1.3.14.3.2.26"]="sha1",b.sha1="1.3.14.3.2.26",b["2.16.840.1.101.3.4.2.1"]="sha256",b.sha256="2.16.840.1.101.3.4.2.1",b["2.16.840.1.101.3.4.2.2"]="sha384",b.sha384="2.16.840.1.101.3.4.2.2",b["2.16.840.1.101.3.4.2.3"]="sha512",b.sha512="2.16.840.1.101.3.4.2.3",b["1.2.840.113549.2.5"]="md5",b.md5="1.2.840.113549.2.5",b["1.2.840.113549.1.7.1"]="data",b.data="1.2.840.113549.1.7.1",b["1.2.840.113549.1.7.2"]="signedData",b.signedData="1.2.840.113549.1.7.2",b["1.2.840.113549.1.7.3"]="envelopedData",b.envelopedData="1.2.840.113549.1.7.3",b["1.2.840.113549.1.7.4"]="signedAndEnvelopedData",b.signedAndEnvelopedData="1.2.840.113549.1.7.4",b["1.2.840.113549.1.7.5"]="digestedData",b.digestedData="1.2.840.113549.1.7.5",b["1.2.840.113549.1.7.6"]="encryptedData",b.encryptedData="1.2.840.113549.1.7.6",b["1.2.840.113549.1.9.1"]="emailAddress",b.emailAddress="1.2.840.113549.1.9.1",b["1.2.840.113549.1.9.2"]="unstructuredName",b.unstructuredName="1.2.840.113549.1.9.2",b["1.2.840.113549.1.9.3"]="contentType",b.contentType="1.2.840.113549.1.9.3",b["1.2.840.113549.1.9.4"]="messageDigest",b.messageDigest="1.2.840.113549.1.9.4",b["1.2.840.113549.1.9.5"]="signingTime",b.signingTime="1.2.840.113549.1.9.5",b["1.2.840.113549.1.9.6"]="counterSignature",b.counterSignature="1.2.840.113549.1.9.6",b["1.2.840.113549.1.9.7"]="challengePassword",b.challengePassword="1.2.840.113549.1.9.7",b["1.2.840.113549.1.9.8"]="unstructuredAddress",b.unstructuredAddress="1.2.840.113549.1.9.8",b["1.2.840.113549.1.9.14"]="extensionRequest",b.extensionRequest="1.2.840.113549.1.9.14",b["1.2.840.113549.1.9.20"]="friendlyName",b.friendlyName="1.2.840.113549.1.9.20",b["1.2.840.113549.1.9.21"]="localKeyId",b.localKeyId="1.2.840.113549.1.9.21",b["1.2.840.113549.1.9.22.1"]="x509Certificate",b.x509Certificate="1.2.840.113549.1.9.22.1",b["1.2.840.113549.1.12.10.1.1"]="keyBag",b.keyBag="1.2.840.113549.1.12.10.1.1",b["1.2.840.113549.1.12.10.1.2"]="pkcs8ShroudedKeyBag",b.pkcs8ShroudedKeyBag="1.2.840.113549.1.12.10.1.2",b["1.2.840.113549.1.12.10.1.3"]="certBag",b.certBag="1.2.840.113549.1.12.10.1.3",b["1.2.840.113549.1.12.10.1.4"]="crlBag",b.crlBag="1.2.840.113549.1.12.10.1.4",b["1.2.840.113549.1.12.10.1.5"]="secretBag",b.secretBag="1.2.840.113549.1.12.10.1.5",b["1.2.840.113549.1.12.10.1.6"]="safeContentsBag",b.safeContentsBag="1.2.840.113549.1.12.10.1.6",b["1.2.840.113549.1.5.13"]="pkcs5PBES2",b.pkcs5PBES2="1.2.840.113549.1.5.13",b["1.2.840.113549.1.5.12"]="pkcs5PBKDF2",b.pkcs5PBKDF2="1.2.840.113549.1.5.12",b["1.2.840.113549.1.12.1.1"]="pbeWithSHAAnd128BitRC4",b.pbeWithSHAAnd128BitRC4="1.2.840.113549.1.12.1.1",b["1.2.840.113549.1.12.1.2"]="pbeWithSHAAnd40BitRC4",b.pbeWithSHAAnd40BitRC4="1.2.840.113549.1.12.1.2",b["1.2.840.113549.1.12.1.3"]="pbeWithSHAAnd3-KeyTripleDES-CBC",b["pbeWithSHAAnd3-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.3",b["1.2.840.113549.1.12.1.4"]="pbeWithSHAAnd2-KeyTripleDES-CBC",b["pbeWithSHAAnd2-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.4",
b["1.2.840.113549.1.12.1.5"]="pbeWithSHAAnd128BitRC2-CBC",b["pbeWithSHAAnd128BitRC2-CBC"]="1.2.840.113549.1.12.1.5",b["1.2.840.113549.1.12.1.6"]="pbewithSHAAnd40BitRC2-CBC",b["pbewithSHAAnd40BitRC2-CBC"]="1.2.840.113549.1.12.1.6",b["1.2.840.113549.3.7"]="des-EDE3-CBC",b["des-EDE3-CBC"]="1.2.840.113549.3.7",b["2.16.840.1.101.3.4.1.2"]="aes128-CBC",b["aes128-CBC"]="2.16.840.1.101.3.4.1.2",b["2.16.840.1.101.3.4.1.22"]="aes192-CBC",b["aes192-CBC"]="2.16.840.1.101.3.4.1.22",b["2.16.840.1.101.3.4.1.42"]="aes256-CBC",b["aes256-CBC"]="2.16.840.1.101.3.4.1.42",b["2.5.4.3"]="commonName",b.commonName="2.5.4.3",b["2.5.4.5"]="serialName",b.serialName="2.5.4.5",b["2.5.4.6"]="countryName",b.countryName="2.5.4.6",b["2.5.4.7"]="localityName",b.localityName="2.5.4.7",b["2.5.4.8"]="stateOrProvinceName",b.stateOrProvinceName="2.5.4.8",b["2.5.4.10"]="organizationName",b.organizationName="2.5.4.10",b["2.5.4.11"]="organizationalUnitName",b.organizationalUnitName="2.5.4.11",b["2.16.840.1.113730.1.1"]="nsCertType",b.nsCertType="2.16.840.1.113730.1.1",b["2.5.29.1"]="authorityKeyIdentifier",b["2.5.29.2"]="keyAttributes",b["2.5.29.3"]="certificatePolicies",b["2.5.29.4"]="keyUsageRestriction",b["2.5.29.5"]="policyMapping",b["2.5.29.6"]="subtreesConstraint",b["2.5.29.7"]="subjectAltName",b["2.5.29.8"]="issuerAltName",b["2.5.29.9"]="subjectDirectoryAttributes",b["2.5.29.10"]="basicConstraints",b["2.5.29.11"]="nameConstraints",b["2.5.29.12"]="policyConstraints",b["2.5.29.13"]="basicConstraints",b["2.5.29.14"]="subjectKeyIdentifier",b.subjectKeyIdentifier="2.5.29.14",b["2.5.29.15"]="keyUsage",b.keyUsage="2.5.29.15",b["2.5.29.16"]="privateKeyUsagePeriod",b["2.5.29.17"]="subjectAltName",b.subjectAltName="2.5.29.17",b["2.5.29.18"]="issuerAltName",b.issuerAltName="2.5.29.18",b["2.5.29.19"]="basicConstraints",b.basicConstraints="2.5.29.19",b["2.5.29.20"]="cRLNumber",b["2.5.29.21"]="cRLReason",b["2.5.29.22"]="expirationDate",b["2.5.29.23"]="instructionCode",b["2.5.29.24"]="invalidityDate",b["2.5.29.25"]="cRLDistributionPoints",b["2.5.29.26"]="issuingDistributionPoint",b["2.5.29.27"]="deltaCRLIndicator",b["2.5.29.28"]="issuingDistributionPoint",b["2.5.29.29"]="certificateIssuer",b["2.5.29.30"]="nameConstraints",b["2.5.29.31"]="cRLDistributionPoints",b["2.5.29.32"]="certificatePolicies",b["2.5.29.33"]="policyMappings",b["2.5.29.34"]="policyConstraints",b["2.5.29.35"]="authorityKeyIdentifier",b["2.5.29.36"]="policyConstraints",b["2.5.29.37"]="extKeyUsage",b.extKeyUsage="2.5.29.37",b["2.5.29.46"]="freshestCRL",b["2.5.29.54"]="inhibitAnyPolicy",b["1.3.6.1.5.5.7.3.1"]="serverAuth",b.serverAuth="1.3.6.1.5.5.7.3.1",b["1.3.6.1.5.5.7.3.2"]="clientAuth",b.clientAuth="1.3.6.1.5.5.7.3.2",b["1.3.6.1.5.5.7.3.3"]="codeSigning",b.codeSigning="1.3.6.1.5.5.7.3.3",b["1.3.6.1.5.5.7.3.4"]="emailProtection",b.emailProtection="1.3.6.1.5.5.7.3.4",b["1.3.6.1.5.5.7.3.8"]="timeStamping",b.timeStamping="1.3.6.1.5.5.7.3.8"}var d="oids";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/oids",["require","module"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=a.asn1=a.asn1||{};b.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},b.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},b.create=function(b,c,d,e){if(a.util.isArray(e)){for(var f=[],g=0;g<e.length;++g)void 0!==e[g]&&f.push(e[g]);e=f}return{tagClass:b,type:c,constructed:d,composed:d||a.util.isArray(e),value:e}};var c=function(a){var b=a.getByte();if(128!==b){var c,d=128&b;return c=d?a.getInt((127&b)<<3):b}};b.fromDer=function(d,e){if(void 0===e&&(e=!0),"string"==typeof d&&(d=a.util.createBuffer(d)),d.length()<2){var f=new Error("Too few bytes to parse DER.");throw f.bytes=d.length(),f}var g=d.getByte(),h=192&g,i=31&g,j=c(d);if(d.length()<j){if(e){var f=new Error("Too few bytes to read ASN.1 value.");throw f.detail=d.length()+" < "+j,f}j=d.length()}var k,l=32===(32&g),m=l;if(!m&&h===b.Class.UNIVERSAL&&i===b.Type.BITSTRING&&j>1){var n=d.read,o=d.getByte();if(0===o){g=d.getByte();var p=192&g;if(p===b.Class.UNIVERSAL||p===b.Class.CONTEXT_SPECIFIC)try{var q=c(d);m=q===j-(d.read-n),m&&(++n,--j)}catch(a){}}d.read=n}if(m)if(k=[],void 0===j)for(;;){if(d.bytes(2)===String.fromCharCode(0,0)){d.getBytes(2);break}k.push(b.fromDer(d,e))}else for(var r=d.length();j>0;)k.push(b.fromDer(d,e)),j-=r-d.length(),r=d.length();else{if(void 0===j){if(e)throw new Error("Non-constructed ASN.1 object of indefinite length.");j=d.length()}if(i===b.Type.BMPSTRING){k="";for(var s=0;s<j;s+=2)k+=String.fromCharCode(d.getInt16())}else k=d.getBytes(j)}return b.create(h,i,l,k)},b.toDer=function(c){var d=a.util.createBuffer(),e=c.tagClass|c.type,f=a.util.createBuffer();if(c.composed){c.constructed?e|=32:f.putByte(0);for(var g=0;g<c.value.length;++g)void 0!==c.value[g]&&f.putBuffer(b.toDer(c.value[g]))}else if(c.type===b.Type.BMPSTRING)for(var g=0;g<c.value.length;++g)f.putInt16(c.value.charCodeAt(g));else f.putBytes(c.value);if(d.putByte(e),f.length()<=127)d.putByte(127&f.length());else{var h=f.length(),i="";do i+=String.fromCharCode(255&h),h>>>=8;while(h>0);d.putByte(128|i.length);for(var g=i.length-1;g>=0;--g)d.putByte(i.charCodeAt(g))}return d.putBuffer(f),d},b.oidToDer=function(b){var c=b.split("."),d=a.util.createBuffer();d.putByte(40*parseInt(c[0],10)+parseInt(c[1],10));for(var e,f,g,h,i=2;i<c.length;++i){e=!0,f=[],g=parseInt(c[i],10);do h=127&g,g>>>=7,e||(h|=128),f.push(h),e=!1;while(g>0);for(var j=f.length-1;j>=0;--j)d.putByte(f[j])}return d},b.derToOid=function(b){var c;"string"==typeof b&&(b=a.util.createBuffer(b));var d=b.getByte();c=Math.floor(d/40)+"."+d%40;for(var e=0;b.length()>0;)d=b.getByte(),e<<=7,128&d?e+=127&d:(c+="."+(e+d),e=0);return c},b.utcTimeToDate=function(a){var b=new Date,c=parseInt(a.substr(0,2),10);c=c>=50?1900+c:2e3+c;var d=parseInt(a.substr(2,2),10)-1,e=parseInt(a.substr(4,2),10),f=parseInt(a.substr(6,2),10),g=parseInt(a.substr(8,2),10),h=0;if(a.length>11){var i=a.charAt(10),j=10;"+"!==i&&"-"!==i&&(h=parseInt(a.substr(10,2),10),j+=2)}if(b.setUTCFullYear(c,d,e),b.setUTCHours(f,g,h,0),j&&(i=a.charAt(j),"+"===i||"-"===i)){var k=parseInt(a.substr(j+1,2),10),l=parseInt(a.substr(j+4,2),10),m=60*k+l;m*=6e4,"+"===i?b.setTime(+b-m):b.setTime(+b+m)}return b},b.generalizedTimeToDate=function(a){var b=new Date,c=parseInt(a.substr(0,4),10),d=parseInt(a.substr(4,2),10)-1,e=parseInt(a.substr(6,2),10),f=parseInt(a.substr(8,2),10),g=parseInt(a.substr(10,2),10),h=parseInt(a.substr(12,2),10),i=0,j=0,k=!1;"Z"===a.charAt(a.length-1)&&(k=!0);var l=a.length-5,m=a.charAt(l);if("+"===m||"-"===m){var n=parseInt(a.substr(l+1,2),10),o=parseInt(a.substr(l+4,2),10);j=60*n+o,j*=6e4,"+"===m&&(j*=-1),k=!0}return"."===a.charAt(14)&&(i=1e3*parseFloat(a.substr(14),10)),k?(b.setUTCFullYear(c,d,e),b.setUTCHours(f,g,h,i),b.setTime(+b+j)):(b.setFullYear(c,d,e),b.setHours(f,g,h,i)),b},b.dateToUtcTime=function(a){var b="",c=[];c.push((""+a.getUTCFullYear()).substr(2)),c.push(""+(a.getUTCMonth()+1)),c.push(""+a.getUTCDate()),c.push(""+a.getUTCHours()),c.push(""+a.getUTCMinutes()),c.push(""+a.getUTCSeconds());for(var d=0;d<c.length;++d)c[d].length<2&&(b+="0"),b+=c[d];return b+="Z"},b.integerToDer=function(b){var c=a.util.createBuffer();if(b>=-128&&b<128)return c.putSignedInt(b,8);if(b>=-32768&&b<32768)return c.putSignedInt(b,16);if(b>=-8388608&&b<8388608)return c.putSignedInt(b,24);if(b>=-2147483648&&b<2147483648)return c.putSignedInt(b,32);var d=new Error("Integer too large; max is 32-bits.");throw d.integer=b,d},b.derToInteger=function(b){"string"==typeof b&&(b=a.util.createBuffer(b));var c=8*b.length();if(c>32)throw new Error("Integer too large; max is 32-bits.");return b.getSignedInt(c)},b.validate=function(c,d,e,f){var g=!1;if(c.tagClass!==d.tagClass&&"undefined"!=typeof d.tagClass||c.type!==d.type&&"undefined"!=typeof d.type)f&&(c.tagClass!==d.tagClass&&f.push("["+d.name+'] Expected tag class "'+d.tagClass+'", got "'+c.tagClass+'"'),c.type!==d.type&&f.push("["+d.name+'] Expected type "'+d.type+'", got "'+c.type+'"'));else if(c.constructed===d.constructed||"undefined"==typeof d.constructed){if(g=!0,d.value&&a.util.isArray(d.value))for(var h=0,i=0;g&&i<d.value.length;++i)g=d.value[i].optional||!1,c.value[h]&&(g=b.validate(c.value[h],d.value[i],e,f),g?++h:d.value[i].optional&&(g=!0)),!g&&f&&f.push("["+d.name+'] Tag class "'+d.tagClass+'", type "'+d.type+'" expected value length "'+d.value.length+'", got "'+c.value.length+'"');g&&e&&(d.capture&&(e[d.capture]=c.value),d.captureAsn1&&(e[d.captureAsn1]=c))}else f&&f.push("["+d.name+'] Expected constructed "'+d.constructed+'", got "'+c.constructed+'"');return g};var d=/[^\\u0000-\\u00ff]/;b.prettyPrint=function(c,e,f){var g="";e=e||0,f=f||2,e>0&&(g+="\n");for(var h="",i=0;i<e*f;++i)h+=" ";switch(g+=h+"Tag: ",c.tagClass){case b.Class.UNIVERSAL:g+="Universal:";break;case b.Class.APPLICATION:g+="Application:";break;case b.Class.CONTEXT_SPECIFIC:g+="Context-Specific:";break;case b.Class.PRIVATE:g+="Private:"}if(c.tagClass===b.Class.UNIVERSAL)switch(g+=c.type,c.type){case b.Type.NONE:g+=" (None)";break;case b.Type.BOOLEAN:g+=" (Boolean)";break;case b.Type.BITSTRING:g+=" (Bit string)";break;case b.Type.INTEGER:g+=" (Integer)";break;case b.Type.OCTETSTRING:g+=" (Octet string)";break;case b.Type.NULL:g+=" (Null)";break;case b.Type.OID:g+=" (Object Identifier)";break;case b.Type.ODESC:g+=" (Object Descriptor)";break;case b.Type.EXTERNAL:g+=" (External or Instance of)";break;case b.Type.REAL:g+=" (Real)";break;case b.Type.ENUMERATED:g+=" (Enumerated)";break;case b.Type.EMBEDDED:g+=" (Embedded PDV)";break;case b.Type.UTF8:g+=" (UTF8)";break;case b.Type.ROID:g+=" (Relative Object Identifier)";break;case b.Type.SEQUENCE:g+=" (Sequence)";break;case b.Type.SET:g+=" (Set)";break;case b.Type.PRINTABLESTRING:g+=" (Printable String)";break;case b.Type.IA5String:g+=" (IA5String (ASCII))";break;case b.Type.UTCTIME:g+=" (UTC time)";break;case b.Type.GENERALIZEDTIME:g+=" (Generalized time)";break;case b.Type.BMPSTRING:g+=" (BMP String)"}else g+=c.type;if(g+="\n",g+=h+"Constructed: "+c.constructed+"\n",c.composed){for(var j=0,k="",i=0;i<c.value.length;++i)void 0!==c.value[i]&&(j+=1,k+=b.prettyPrint(c.value[i],e+1,f),i+1<c.value.length&&(k+=","));g+=h+"Sub values: "+j+k}else{if(g+=h+"Value: ",c.type===b.Type.OID){var l=b.derToOid(c.value);g+=l,a.pki&&a.pki.oids&&l in a.pki.oids&&(g+=" ("+a.pki.oids[l]+") ")}if(c.type===b.Type.INTEGER)try{g+=b.derToInteger(c.value)}catch(b){g+="0x"+a.util.bytesToHex(c.value)}else c.type===b.Type.OCTETSTRING?(d.test(c.value)||(g+="("+c.value+") "),g+="0x"+a.util.bytesToHex(c.value)):g+=c.type===b.Type.UTF8?a.util.decodeUtf8(c.value):c.type===b.Type.PRINTABLESTRING||c.type===b.Type.IA5String?c.value:d.test(c.value)?"0x"+a.util.bytesToHex(c.value):0===c.value.length?"[null]":c.value}return g}}var d="asn1";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/asn1",["require","module","./util","./oids"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(){e=String.fromCharCode(128),e+=a.util.fillString(String.fromCharCode(0),64),f=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],g=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],h=new Array(64);for(var b=0;b<64;++b)h[b]=Math.floor(4294967296*Math.abs(Math.sin(b+1)));i=!0}function c(a,b,c){for(var d,e,i,j,k,l,m,n,o=c.length();o>=64;){for(e=a.h0,i=a.h1,j=a.h2,k=a.h3,n=0;n<16;++n)b[n]=c.getInt32Le(),l=k^i&(j^k),d=e+l+h[n]+b[n],m=g[n],e=k,k=j,j=i,i+=d<<m|d>>>32-m;for(;n<32;++n)l=j^k&(i^j),d=e+l+h[n]+b[f[n]],m=g[n],e=k,k=j,j=i,i+=d<<m|d>>>32-m;for(;n<48;++n)l=i^j^k,d=e+l+h[n]+b[f[n]],m=g[n],e=k,k=j,j=i,i+=d<<m|d>>>32-m;for(;n<64;++n)l=j^(i|~k),d=e+l+h[n]+b[f[n]],m=g[n],e=k,k=j,j=i,i+=d<<m|d>>>32-m;a.h0=a.h0+e|0,a.h1=a.h1+i|0,a.h2=a.h2+j|0,a.h3=a.h3+k|0,o-=64}}var d=a.md5=a.md5||{};a.md=a.md||{},a.md.algorithms=a.md.algorithms||{},a.md.md5=a.md.algorithms.md5=d,d.create=function(){i||b();var d=null,f=a.util.createBuffer(),g=new Array(16),h={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,messageLength64:[0,0]};return h.start=function(){return h.messageLength=0,h.messageLength64=[0,0],f=a.util.createBuffer(),d={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},h},h.start(),h.update=function(b,e){return"utf8"===e&&(b=a.util.encodeUtf8(b)),h.messageLength+=b.length,h.messageLength64[0]+=b.length/4294967296>>>0,h.messageLength64[1]+=b.length>>>0,f.putBytes(b),c(d,g,f),(f.read>2048||0===f.length())&&f.compact(),h},h.digest=function(){var b=a.util.createBuffer();b.putBytes(f.bytes()),b.putBytes(e.substr(0,64-(h.messageLength64[1]+8&63))),b.putInt32Le(h.messageLength64[1]<<3),b.putInt32Le(h.messageLength64[0]<<3|h.messageLength64[0]>>>28);var i={h0:d.h0,h1:d.h1,h2:d.h2,h3:d.h3};c(i,g,b);var j=a.util.createBuffer();return j.putInt32Le(i.h0),j.putInt32Le(i.h1),j.putInt32Le(i.h2),j.putInt32Le(i.h3),j},h};var e=null,f=null,g=null,h=null,i=!1}var d="md5";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/md5",["require","module","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(){e=String.fromCharCode(128),e+=a.util.fillString(String.fromCharCode(0),64),f=!0}function c(a,b,c){for(var d,e,f,g,h,i,j,k,l=c.length();l>=64;){for(e=a.h0,f=a.h1,g=a.h2,h=a.h3,i=a.h4,k=0;k<16;++k)d=c.getInt32(),b[k]=d,j=h^f&(g^h),d=(e<<5|e>>>27)+j+i+1518500249+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;for(;k<20;++k)d=b[k-3]^b[k-8]^b[k-14]^b[k-16],d=d<<1|d>>>31,b[k]=d,j=h^f&(g^h),d=(e<<5|e>>>27)+j+i+1518500249+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;for(;k<32;++k)d=b[k-3]^b[k-8]^b[k-14]^b[k-16],d=d<<1|d>>>31,b[k]=d,j=f^g^h,d=(e<<5|e>>>27)+j+i+1859775393+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;for(;k<40;++k)d=b[k-6]^b[k-16]^b[k-28]^b[k-32],d=d<<2|d>>>30,b[k]=d,j=f^g^h,d=(e<<5|e>>>27)+j+i+1859775393+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;for(;k<60;++k)d=b[k-6]^b[k-16]^b[k-28]^b[k-32],d=d<<2|d>>>30,b[k]=d,j=f&g|h&(f^g),d=(e<<5|e>>>27)+j+i+2400959708+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;for(;k<80;++k)d=b[k-6]^b[k-16]^b[k-28]^b[k-32],d=d<<2|d>>>30,b[k]=d,j=f^g^h,d=(e<<5|e>>>27)+j+i+3395469782+d,i=h,h=g,g=f<<30|f>>>2,f=e,e=d;a.h0=a.h0+e|0,a.h1=a.h1+f|0,a.h2=a.h2+g|0,a.h3=a.h3+h|0,a.h4=a.h4+i|0,l-=64}}var d=a.sha1=a.sha1||{};a.md=a.md||{},a.md.algorithms=a.md.algorithms||{},a.md.sha1=a.md.algorithms.sha1=d,d.create=function(){f||b();var d=null,g=a.util.createBuffer(),h=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,messageLength64:[0,0]};return i.start=function(){return i.messageLength=0,i.messageLength64=[0,0],g=a.util.createBuffer(),d={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i},i.start(),i.update=function(b,e){return"utf8"===e&&(b=a.util.encodeUtf8(b)),i.messageLength+=b.length,i.messageLength64[0]+=b.length/4294967296>>>0,i.messageLength64[1]+=b.length>>>0,g.putBytes(b),c(d,h,g),(g.read>2048||0===g.length())&&g.compact(),i},i.digest=function(){var b=a.util.createBuffer();b.putBytes(g.bytes()),b.putBytes(e.substr(0,64-(i.messageLength64[1]+8&63))),b.putInt32(i.messageLength64[0]<<3|i.messageLength64[0]>>>28),b.putInt32(i.messageLength64[1]<<3);var f={h0:d.h0,h1:d.h1,h2:d.h2,h3:d.h3,h4:d.h4};c(f,h,b);var j=a.util.createBuffer();return j.putInt32(f.h0),j.putInt32(f.h1),j.putInt32(f.h2),j.putInt32(f.h3),j.putInt32(f.h4),j},i};var e=null,f=!1}var d="sha1";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/sha1",["require","module","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(){e=String.fromCharCode(128),e+=a.util.fillString(String.fromCharCode(0),64),g=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],f=!0}function c(a,b,c){for(var d,e,f,h,i,j,k,l,m,n,o,p,q,r,s,t=c.length();t>=64;){for(k=0;k<16;++k)b[k]=c.getInt32();for(;k<64;++k)d=b[k-2],d=(d>>>17|d<<15)^(d>>>19|d<<13)^d>>>10,e=b[k-15],e=(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3,b[k]=d+b[k-7]+e+b[k-16]|0;for(l=a.h0,m=a.h1,n=a.h2,o=a.h3,p=a.h4,q=a.h5,r=a.h6,s=a.h7,k=0;k<64;++k)h=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),i=r^p&(q^r),f=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),j=l&m|n&(l^m),d=s+h+i+g[k]+b[k],e=f+j,s=r,r=q,q=p,p=o+d|0,o=n,n=m,m=l,l=d+e|0;a.h0=a.h0+l|0,a.h1=a.h1+m|0,a.h2=a.h2+n|0,a.h3=a.h3+o|0,a.h4=a.h4+p|0,a.h5=a.h5+q|0,a.h6=a.h6+r|0,a.h7=a.h7+s|0,t-=64}}var d=a.sha256=a.sha256||{};a.md=a.md||{},a.md.algorithms=a.md.algorithms||{},a.md.sha256=a.md.algorithms.sha256=d,d.create=function(){f||b();var d=null,g=a.util.createBuffer(),h=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,messageLength64:[0,0]};return i.start=function(){return i.messageLength=0,i.messageLength64=[0,0],g=a.util.createBuffer(),d={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i},i.start(),i.update=function(b,e){return"utf8"===e&&(b=a.util.encodeUtf8(b)),i.messageLength+=b.length,i.messageLength64[0]+=b.length/4294967296>>>0,i.messageLength64[1]+=b.length>>>0,g.putBytes(b),c(d,h,g),(g.read>2048||0===g.length())&&g.compact(),i},i.digest=function(){var b=a.util.createBuffer();b.putBytes(g.bytes()),b.putBytes(e.substr(0,64-(i.messageLength64[1]+8&63))),b.putInt32(i.messageLength64[0]<<3|i.messageLength64[0]>>>28),b.putInt32(i.messageLength64[1]<<3);var f={h0:d.h0,h1:d.h1,h2:d.h2,h3:d.h3,h4:d.h4,h5:d.h5,h6:d.h6,h7:d.h7};c(f,h,b);var j=a.util.createBuffer();return j.putInt32(f.h0),j.putInt32(f.h1),j.putInt32(f.h2),j.putInt32(f.h3),j.putInt32(f.h4),j.putInt32(f.h5),j.putInt32(f.h6),j.putInt32(f.h7),j},i};var e=null,f=!1,g=null}var d="sha256";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/sha256",["require","module","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(){f=String.fromCharCode(128),f+=a.util.fillString(String.fromCharCode(0),128),h=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],i={},i["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],i["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],i["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],i["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],g=!0}function c(a,b,c){for(var d,e,f,g,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N=c.length();N>=128;){for(G=0;G<16;++G)b[G][0]=c.getInt32()>>>0,b[G][1]=c.getInt32()>>>0;for(;G<80;++G)J=b[G-2],H=J[0],I=J[1],d=((H>>>19|I<<13)^(I>>>29|H<<3)^H>>>6)>>>0,e=((H<<13|I>>>19)^(I<<3|H>>>29)^(H<<26|I>>>6))>>>0,L=b[G-15],H=L[0],I=L[1],f=((H>>>1|I<<31)^(H>>>8|I<<24)^H>>>7)>>>0,g=((H<<31|I>>>1)^(H<<24|I>>>8)^(H<<25|I>>>7))>>>0,K=b[G-7],M=b[G-16],I=e+K[1]+g+M[1],b[G][0]=d+K[0]+f+M[0]+(I/4294967296>>>0)>>>0,b[G][1]=I>>>0;for(q=a[0][0],r=a[0][1],s=a[1][0],t=a[1][1],u=a[2][0],v=a[2][1],w=a[3][0],x=a[3][1],y=a[4][0],z=a[4][1],A=a[5][0],B=a[5][1],C=a[6][0],D=a[6][1],E=a[7][0],F=a[7][1],G=0;G<80;++G)k=((y>>>14|z<<18)^(y>>>18|z<<14)^(z>>>9|y<<23))>>>0,l=((y<<18|z>>>14)^(y<<14|z>>>18)^(z<<23|y>>>9))>>>0,m=(C^y&(A^C))>>>0,n=(D^z&(B^D))>>>0,i=((q>>>28|r<<4)^(r>>>2|q<<30)^(r>>>7|q<<25))>>>0,j=((q<<4|r>>>28)^(r<<30|q>>>2)^(r<<25|q>>>7))>>>0,o=(q&s|u&(q^s))>>>0,p=(r&t|v&(r^t))>>>0,I=F+l+n+h[G][1]+b[G][1],d=E+k+m+h[G][0]+b[G][0]+(I/4294967296>>>0)>>>0,e=I>>>0,I=j+p,f=i+o+(I/4294967296>>>0)>>>0,g=I>>>0,E=C,F=D,C=A,D=B,A=y,B=z,I=x+e,y=w+d+(I/4294967296>>>0)>>>0,z=I>>>0,w=u,x=v,u=s,v=t,s=q,t=r,I=e+g,q=d+f+(I/4294967296>>>0)>>>0,r=I>>>0;I=a[0][1]+r,a[0][0]=a[0][0]+q+(I/4294967296>>>0)>>>0,a[0][1]=I>>>0,I=a[1][1]+t,a[1][0]=a[1][0]+s+(I/4294967296>>>0)>>>0,a[1][1]=I>>>0,I=a[2][1]+v,a[2][0]=a[2][0]+u+(I/4294967296>>>0)>>>0,a[2][1]=I>>>0,I=a[3][1]+x,a[3][0]=a[3][0]+w+(I/4294967296>>>0)>>>0,a[3][1]=I>>>0,I=a[4][1]+z,a[4][0]=a[4][0]+y+(I/4294967296>>>0)>>>0,a[4][1]=I>>>0,I=a[5][1]+B,a[5][0]=a[5][0]+A+(I/4294967296>>>0)>>>0,a[5][1]=I>>>0,I=a[6][1]+D,a[6][0]=a[6][0]+C+(I/4294967296>>>0)>>>0,a[6][1]=I>>>0,I=a[7][1]+F,a[7][0]=a[7][0]+E+(I/4294967296>>>0)>>>0,a[7][1]=I>>>0,N-=128}}var d=a.sha512=a.sha512||{};a.md=a.md||{},a.md.algorithms=a.md.algorithms||{},a.md.sha512=a.md.algorithms.sha512=d;var e=a.sha384=a.sha512.sha384=a.sha512.sha384||{};e.create=function(){return d.create("SHA-384")},a.md.sha384=a.md.algorithms.sha384=e,a.sha512.sha256=a.sha512.sha256||{create:function(){return d.create("SHA-512/256")}},a.md["sha512/256"]=a.md.algorithms["sha512/256"]=a.sha512.sha256,a.sha512.sha224=a.sha512.sha224||{create:function(){return d.create("SHA-512/224")}},a.md["sha512/224"]=a.md.algorithms["sha512/224"]=a.sha512.sha224,d.create=function(d){if(g||b(),"undefined"==typeof d&&(d="SHA-512"),!(d in i))throw new Error("Invalid SHA-512 algorithm: "+d);for(var e=i[d],h=null,j=a.util.createBuffer(),k=new Array(80),l=0;l<80;++l)k[l]=new Array(2);var m={algorithm:d.replace("-","").toLowerCase(),blockLength:128,digestLength:64,messageLength:0,messageLength128:[0,0,0,0]};return m.start=function(){m.messageLength=0,m.messageLength128=[0,0,0,0],j=a.util.createBuffer(),h=new Array(e.length);for(var b=0;b<e.length;++b)h[b]=e[b].slice(0);return m},m.start(),m.update=function(b,d){"utf8"===d&&(b=a.util.encodeUtf8(b)),m.messageLength+=b.length;var e=b.length;e=[e/4294967296>>>0,e>>>0];for(var f=3;f>=0;--f)m.messageLength128[f]+=e[1],e[1]=e[0]+(m.messageLength128[f]/4294967296>>>0),m.messageLength128[f]=m.messageLength128[f]>>>0,e[0]=e[1]/4294967296>>>0;return j.putBytes(b),c(h,k,j),(j.read>2048||0===j.length())&&j.compact(),m},m.digest=function(){var b=a.util.createBuffer();b.putBytes(j.bytes()),b.putBytes(f.substr(0,128-(m.messageLength128[3]+16&127)));for(var e=[],g=0;g<3;++g)e[g]=m.messageLength128[g]<<3|m.messageLength128[g-1]>>>28;e[3]=m.messageLength128[3]<<3,b.putInt32(e[0]),b.putInt32(e[1]),b.putInt32(e[2]),b.putInt32(e[3]);for(var i=new Array(h.length),g=0;g<h.length;++g)i[g]=h[g].slice(0);c(i,k,b);var l,n=a.util.createBuffer();l="SHA-512"===d?i.length:"SHA-384"===d?i.length-2:i.length-4;for(var g=0;g<l;++g)n.putInt32(i[g][0]),g===l-1&&"SHA-512/224"===d||n.putInt32(i[g][1]);return n},m};var f=null,g=!1,h=null,i=null}var d="sha512";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/sha512",["require","module","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){a.md=a.md||{},a.md.algorithms={md5:a.md5,sha1:a.sha1,sha256:a.sha256},a.md.md5=a.md5,a.md.sha1=a.sha1,a.md.sha256=a.sha256}var d="md";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/md",["require","module","./md5","./sha1","./sha256","./sha512"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=a.hmac=a.hmac||{};b.create=function(){var b=null,c=null,d=null,e=null,f={};return f.start=function(f,g){if(null!==f)if("string"==typeof f){if(f=f.toLowerCase(),!(f in a.md.algorithms))throw new Error('Unknown hash algorithm "'+f+'"');c=a.md.algorithms[f].create()}else c=f;if(null===g)g=b;else{if("string"==typeof g)g=a.util.createBuffer(g);else if(a.util.isArray(g)){var h=g;g=a.util.createBuffer();for(var i=0;i<h.length;++i)g.putByte(h[i])}var j=g.length();j>c.blockLength&&(c.start(),c.update(g.bytes()),g=c.digest()),d=a.util.createBuffer(),e=a.util.createBuffer(),j=g.length();for(var i=0;i<j;++i){var h=g.at(i);d.putByte(54^h),e.putByte(92^h)}if(j<c.blockLength)for(var h=c.blockLength-j,i=0;i<h;++i)d.putByte(54),e.putByte(92);b=g,d=d.bytes(),e=e.bytes()}c.start(),c.update(d)},f.update=function(a){c.update(a)},f.getMac=function(){var a=c.digest().bytes();return c.start(),c.update(e),c.update(a),c.digest()},f.digest=f.getMac,f}}var d="hmac";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/hmac",["require","module","./md","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(a){for(var b=a.name+": ",c=[],d=function(a,b){return" "+b},e=0;e<a.values.length;++e)c.push(a.values[e].replace(/^(\S+\r\n)/,d));b+=c.join(",")+"\r\n";for(var f=0,g=-1,e=0;e<b.length;++e,++f)if(f>65&&g!==-1){var h=b[g];","===h?(++g,b=b.substr(0,g)+"\r\n "+b.substr(g)):b=b.substr(0,g)+"\r\n"+h+b.substr(g+1),f=e-g-1,g=-1,++e}else" "!==b[e]&&"\t"!==b[e]&&","!==b[e]||(g=e);return b}function c(a){return a.replace(/^\s+/,"")}var d=a.pem=a.pem||{};d.encode=function(c,d){d=d||{};var e,f="-----BEGIN "+c.type+"-----\r\n";if(c.procType&&(e={name:"Proc-Type",values:[String(c.procType.version),c.procType.type]},f+=b(e)),c.contentDomain&&(e={name:"Content-Domain",values:[c.contentDomain]
},f+=b(e)),c.dekInfo&&(e={name:"DEK-Info",values:[c.dekInfo.algorithm]},c.dekInfo.parameters&&e.values.push(c.dekInfo.parameters),f+=b(e)),c.headers)for(var g=0;g<c.headers.length;++g)f+=b(c.headers[g]);return c.procType&&(f+="\r\n"),f+=a.util.encode64(c.body,d.maxline||64)+"\r\n",f+="-----END "+c.type+"-----\r\n"},d.decode=function(b){for(var d,e=[],f=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,g=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,h=/\r?\n/;;){if(d=f.exec(b),!d)break;var i={type:d[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:a.util.decode64(d[3])};if(e.push(i),d[2]){for(var j=d[2].split(h),k=0;d&&k<j.length;){for(var l=j[k].replace(/\s+$/,""),m=k+1;m<j.length;++m){var n=j[m];if(!/\s/.test(n[0]))break;l+=n,k=m}if(d=l.match(g)){for(var o={name:d[1],values:[]},p=d[2].split(","),q=0;q<p.length;++q)o.values.push(c(p[q]));if(i.procType)if(i.contentDomain||"Content-Domain"!==o.name)if(i.dekInfo||"DEK-Info"!==o.name)i.headers.push(o);else{if(0===o.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');i.dekInfo={algorithm:p[0],parameters:p[1]||null}}else i.contentDomain=p[0]||"";else{if("Proc-Type"!==o.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==o.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');i.procType={version:p[0],type:p[1]}}}++k}if("ENCRYPTED"===i.procType&&!i.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===e.length)throw new Error("Invalid PEM formatted message.");return e}}var d="pem";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pem",["require","module","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(b,c){var d=function(){return new a.des.Algorithm(b,c)};a.cipher.registerAlgorithm(b,d)}function c(a){for(var b,c=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],d=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],e=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],f=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],g=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],h=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],i=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],j=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],k=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],m=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],n=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],o=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],q=a.length()>8?3:1,r=[],s=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],t=0,u=0;u<q;u++){var v=a.getInt32(),w=a.getInt32();b=252645135&(v>>>4^w),w^=b,v^=b<<4,b=65535&(w>>>-16^v),v^=b,w^=b<<-16,b=858993459&(v>>>2^w),w^=b,v^=b<<2,b=65535&(w>>>-16^v),v^=b,w^=b<<-16,b=1431655765&(v>>>1^w),w^=b,v^=b<<1,b=16711935&(w>>>8^v),v^=b,w^=b<<8,b=1431655765&(v>>>1^w),w^=b,v^=b<<1,b=v<<8|w>>>20&240,v=w<<24|w<<8&16711680|w>>>8&65280|w>>>24&240,w=b;for(var x=0;x<s.length;++x){s[x]?(v=v<<2|v>>>26,w=w<<2|w>>>26):(v=v<<1|v>>>27,w=w<<1|w>>>27),v&=-15,w&=-15;var y=c[v>>>28]|d[v>>>24&15]|e[v>>>20&15]|f[v>>>16&15]|g[v>>>12&15]|h[v>>>8&15]|i[v>>>4&15],z=j[w>>>28]|k[w>>>24&15]|l[w>>>20&15]|m[w>>>16&15]|n[w>>>12&15]|o[w>>>8&15]|p[w>>>4&15];b=65535&(z>>>16^y),r[t++]=y^b,r[t++]=z^b<<16}}return r}function d(a,b,c,d){var e,n=32===a.length?3:9;e=3===n?d?[30,-2,-2]:[0,32,2]:d?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,p=b[0],q=b[1];o=252645135&(p>>>4^q),q^=o,p^=o<<4,o=65535&(p>>>16^q),q^=o,p^=o<<16,o=858993459&(q>>>2^p),p^=o,q^=o<<2,o=16711935&(q>>>8^p),p^=o,q^=o<<8,o=1431655765&(p>>>1^q),q^=o,p^=o<<1,p=p<<1|p>>>31,q=q<<1|q>>>31;for(var r=0;r<n;r+=3){for(var s=e[r+1],t=e[r+2],u=e[r];u!=s;u+=t){var v=q^a[u],w=(q>>>4|q<<28)^a[u+1];o=p,p=q,q=o^(g[v>>>24&63]|i[v>>>16&63]|k[v>>>8&63]|m[63&v]|f[w>>>24&63]|h[w>>>16&63]|j[w>>>8&63]|l[63&w])}o=p,p=q,q=o}p=p>>>1|p<<31,q=q>>>1|q<<31,o=1431655765&(p>>>1^q),q^=o,p^=o<<1,o=16711935&(q>>>8^p),p^=o,q^=o<<8,o=858993459&(q>>>2^p),p^=o,q^=o<<2,o=65535&(p>>>16^q),q^=o,p^=o<<16,o=252645135&(p>>>4^q),q^=o,p^=o<<4,c[0]=p,c[1]=q}function e(b){b=b||{};var c,d=(b.mode||"CBC").toUpperCase(),e="DES-"+d;c=b.decrypt?a.cipher.createDecipher(e,b.key):a.cipher.createCipher(e,b.key);var f=c.start;return c.start=function(b,d){var e=null;d instanceof a.util.ByteBuffer&&(e=d,d={}),d=d||{},d.output=e,d.iv=b,f.call(c,d)},c}a.des=a.des||{},a.des.startEncrypting=function(a,b,c,d){var f=e({key:a,output:c,decrypt:!1,mode:d||(null===b?"ECB":"CBC")});return f.start(b),f},a.des.createEncryptionCipher=function(a,b){return e({key:a,output:null,decrypt:!1,mode:b})},a.des.startDecrypting=function(a,b,c,d){var f=e({key:a,output:c,decrypt:!0,mode:d||(null===b?"ECB":"CBC")});return f.start(b),f},a.des.createDecryptionCipher=function(a,b){return e({key:a,output:null,decrypt:!0,mode:b})},a.des.Algorithm=function(a,b){var c=this;c.name=a,c.mode=new b({blockSize:8,cipher:{encrypt:function(a,b){return d(c._keys,a,b,!1)},decrypt:function(a,b){return d(c._keys,a,b,!0)}}}),c._init=!1},a.des.Algorithm.prototype.initialize=function(b){if(!this._init){var d=a.util.createBuffer(b.key);if(0===this.name.indexOf("3DES")&&24!==d.length())throw new Error("Invalid Triple-DES key size: "+8*d.length());this._keys=c(d),this._init=!0}},b("DES-ECB",a.cipher.modes.ecb),b("DES-CBC",a.cipher.modes.cbc),b("DES-CFB",a.cipher.modes.cfb),b("DES-OFB",a.cipher.modes.ofb),b("DES-CTR",a.cipher.modes.ctr),b("3DES-ECB",a.cipher.modes.ecb),b("3DES-CBC",a.cipher.modes.cbc),b("3DES-CFB",a.cipher.modes.cfb),b("3DES-OFB",a.cipher.modes.ofb),b("3DES-CTR",a.cipher.modes.ctr);var f=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],g=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],h=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],i=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],j=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],k=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],l=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],m=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696]}var d="des";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/des",["require","module","./cipher","./cipherModes","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var c,d=a.pkcs5=a.pkcs5||{},e="undefined"!=typeof process&&process.versions&&process.versions.node;e&&!a.disableNativeCode&&(c=b("crypto")),a.pbkdf2=d.pbkdf2=function(b,d,f,g,h,i){function j(){return u>n?i(null,t):(p.start(null,null),p.update(d),p.update(a.util.int32ToBytes(u)),q=s=p.digest().getBytes(),v=2,void k())}function k(){return v<=f?(p.start(null,null),p.update(s),r=p.digest().getBytes(),q=a.util.xorBytes(q,r,l),s=r,++v,a.util.setImmediate(k)):(t+=u<n?q:q.substr(0,o),++u,void j())}if("function"==typeof h&&(i=h,h=null),e&&!a.disableNativeCode&&c.pbkdf2&&(null===h||"object"!=typeof h)&&(c.pbkdf2Sync.length>4||!h||"sha1"===h))return"string"!=typeof h&&(h="sha1"),d=new Buffer(d,"binary"),i?4===c.pbkdf2Sync.length?c.pbkdf2(b,d,f,g,function(a,b){return a?i(a):void i(null,b.toString("binary"))}):c.pbkdf2(b,d,f,g,h,function(a,b){return a?i(a):void i(null,b.toString("binary"))}):4===c.pbkdf2Sync.length?c.pbkdf2Sync(b,d,f,g).toString("binary"):c.pbkdf2Sync(b,d,f,g,h).toString("binary");if("undefined"!=typeof h&&null!==h||(h=a.md.sha1.create()),"string"==typeof h){if(!(h in a.md.algorithms))throw new Error("Unknown hash algorithm: "+h);h=a.md[h].create()}var l=h.digestLength;if(g>4294967295*l){var m=new Error("Derived key is too long.");if(i)return i(m);throw m}var n=Math.ceil(g/l),o=g-(n-1)*l,p=a.hmac.create();p.start(h,b);var q,r,s,t="";if(!i){for(var u=1;u<=n;++u){p.start(null,null),p.update(d),p.update(a.util.int32ToBytes(u)),q=s=p.digest().getBytes();for(var v=2;v<=f;++v)p.start(null,null),p.update(s),r=p.digest().getBytes(),q=a.util.xorBytes(q,r,l),s=r;t+=u<n?q:q.substr(0,o)}return t}var v,u=1;j()}}var d="pbkdf2";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pbkdf2",["require","module","./hmac","./md","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var c="undefined"!=typeof process&&process.versions&&process.versions.node,d=null;a.disableNativeCode||!c||process.versions["node-webkit"]||(d=b("crypto"));var e=a.prng=a.prng||{};e.create=function(b){function c(a){if(h.pools[0].messageLength>=32)return f(),a();var b=32-h.pools[0].messageLength<<5;h.seedFile(b,function(b,c){return b?a(b):(h.collect(c),f(),void a())})}function e(){if(h.pools[0].messageLength>=32)return f();var a=32-h.pools[0].messageLength<<5;h.collect(h.seedFileSync(a)),f()}function f(){var a=h.plugin.md.create();a.update(h.pools[0].digest().getBytes()),h.pools[0].start();for(var b=1,c=1;c<32;++c)b=31===b?2147483648:b<<2,b%h.reseeds===0&&(a.update(h.pools[c].digest().getBytes()),h.pools[c].start());var d=a.digest().getBytes();a.start(),a.update(d);var e=a.digest().getBytes();h.key=h.plugin.formatKey(d),h.seed=h.plugin.formatSeed(e),h.reseeds=4294967295===h.reseeds?0:h.reseeds+1,h.generated=0}function g(b){var c=null;if("undefined"!=typeof window){var d=window.crypto||window.msCrypto;d&&d.getRandomValues&&(c=function(a){return d.getRandomValues(a)})}var e=a.util.createBuffer();if(c)for(;e.length()<b;){var f=Math.max(1,Math.min(b-e.length(),65536)/4),g=new Uint32Array(Math.floor(f));try{c(g);for(var h=0;h<g.length;++h)e.putInt32(g[h])}catch(a){if(!("undefined"!=typeof QuotaExceededError&&a instanceof QuotaExceededError))throw a}}if(e.length()<b)for(var i,j,k,l=Math.floor(65536*Math.random());e.length()<b;){j=16807*(65535&l),i=16807*(l>>16),j+=(32767&i)<<16,j+=i>>15,j=(2147483647&j)+(j>>31),l=4294967295&j;for(var h=0;h<3;++h)k=l>>>(h<<3),k^=Math.floor(256*Math.random()),e.putByte(String.fromCharCode(255&k))}return e.getBytes(b)}for(var h={plugin:b,key:null,seed:null,time:null,reseeds:0,generated:0},i=b.md,j=new Array(32),k=0;k<32;++k)j[k]=i.create();return h.pools=j,h.pool=0,h.generate=function(b,d){function e(l){if(l)return d(l);if(k.length()>=b)return d(null,k.getBytes(b));if(h.generated>1048575&&(h.key=null),null===h.key)return a.util.nextTick(function(){c(e)});var m=f(h.key,h.seed);h.generated+=m.length,k.putBytes(m),h.key=i(f(h.key,g(h.seed))),h.seed=j(f(h.key,h.seed)),a.util.setImmediate(e)}if(!d)return h.generateSync(b);var f=h.plugin.cipher,g=h.plugin.increment,i=h.plugin.formatKey,j=h.plugin.formatSeed,k=a.util.createBuffer();h.key=null,e()},h.generateSync=function(b){var c=h.plugin.cipher,d=h.plugin.increment,f=h.plugin.formatKey,g=h.plugin.formatSeed;h.key=null;for(var i=a.util.createBuffer();i.length()<b;){h.generated>1048575&&(h.key=null),null===h.key&&e();var j=c(h.key,h.seed);h.generated+=j.length,i.putBytes(j),h.key=f(c(h.key,d(h.seed))),h.seed=g(c(h.key,h.seed))}return i.getBytes(b)},d?(h.seedFile=function(a,b){d.randomBytes(a,function(a,c){return a?b(a):void b(null,c.toString())})},h.seedFileSync=function(a){return d.randomBytes(a).toString()}):(h.seedFile=function(a,b){try{b(null,g(a))}catch(a){b(a)}},h.seedFileSync=g),h.collect=function(a){for(var b=a.length,c=0;c<b;++c)h.pools[h.pool].update(a.substr(c,1)),h.pool=31===h.pool?0:h.pool+1},h.collectInt=function(a,b){for(var c="",d=0;d<b;d+=8)c+=String.fromCharCode(a>>d&255);h.collect(c)},h.registerWorker=function(a){if(a===self)h.seedFile=function(a,b){function c(a){var d=a.data;d.forge&&d.forge.prng&&(self.removeEventListener("message",c),b(d.forge.prng.err,d.forge.prng.bytes))}self.addEventListener("message",c),self.postMessage({forge:{prng:{needed:a}}})};else{var b=function(b){var c=b.data;c.forge&&c.forge.prng&&h.seedFile(c.forge.prng.needed,function(b,c){a.postMessage({forge:{prng:{err:b,bytes:c}}})})};a.addEventListener("message",b)}},h}}var d="prng";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/prng",["require","module","./md","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){a.random&&a.random.getBytes||!function(b){function c(){var b=a.prng.create(d);return b.getBytes=function(a,c){return b.generate(a,c)},b.getBytesSync=function(a){return b.generate(a)},b}var d={},e=new Array(4),f=a.util.createBuffer();d.formatKey=function(b){var c=a.util.createBuffer(b);return b=new Array(4),b[0]=c.getInt32(),b[1]=c.getInt32(),b[2]=c.getInt32(),b[3]=c.getInt32(),a.aes._expandKey(b,!1)},d.formatSeed=function(b){var c=a.util.createBuffer(b);return b=new Array(4),b[0]=c.getInt32(),b[1]=c.getInt32(),b[2]=c.getInt32(),b[3]=c.getInt32(),b},d.cipher=function(b,c){return a.aes._updateBlock(b,c,e,!1),f.putInt32(e[0]),f.putInt32(e[1]),f.putInt32(e[2]),f.putInt32(e[3]),f.getBytes()},d.increment=function(a){return++a[3],a},d.md=a.md.sha256;var g=c(),h="undefined"!=typeof process&&process.versions&&process.versions.node,i=null;if("undefined"!=typeof window){var j=window.crypto||window.msCrypto;j&&j.getRandomValues&&(i=function(a){return j.getRandomValues(a)})}if(a.disableNativeCode||!h&&!i){if("undefined"==typeof window||void 0===window.document,g.collectInt(+new Date,32),"undefined"!=typeof navigator){var k="";for(var l in navigator)try{"string"==typeof navigator[l]&&(k+=navigator[l])}catch(a){}g.collect(k),k=null}b&&(b().mousemove(function(a){g.collectInt(a.clientX,16),g.collectInt(a.clientY,16)}),b().keypress(function(a){g.collectInt(a.charCode,8)}))}if(a.random)for(var l in g)a.random[l]=g[l];else a.random=g;a.random.createInstance=c}("undefined"!=typeof jQuery?jQuery:null)}var d="random";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/random",["require","module","./aes","./md","./prng","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],c=[1,2,3,5],d=function(a,b){return a<<b&65535|(65535&a)>>16-b},e=function(a,b){return(65535&a)>>b|a<<16-b&65535};a.rc2=a.rc2||{},a.rc2.expandKey=function(c,d){"string"==typeof c&&(c=a.util.createBuffer(c)),d=d||128;var e,f=c,g=c.length(),h=d,i=Math.ceil(h/8),j=255>>(7&h);for(e=g;e<128;e++)f.putByte(b[f.at(e-1)+f.at(e-g)&255]);for(f.setAt(128-i,b[f.at(128-i)&j]),e=127-i;e>=0;e--)f.setAt(e,b[f.at(e+1)^f.at(e+i)]);return f};var f=function(b,f,g){var h,i,j,k,l=!1,m=null,n=null,o=null,p=[];for(b=a.rc2.expandKey(b,f),j=0;j<64;j++)p.push(b.getInt16Le());g?(h=function(a){for(j=0;j<4;j++)a[j]+=p[k]+(a[(j+3)%4]&a[(j+2)%4])+(~a[(j+3)%4]&a[(j+1)%4]),a[j]=d(a[j],c[j]),k++},i=function(a){for(j=0;j<4;j++)a[j]+=p[63&a[(j+3)%4]]}):(h=function(a){for(j=3;j>=0;j--)a[j]=e(a[j],c[j]),a[j]-=p[k]+(a[(j+3)%4]&a[(j+2)%4])+(~a[(j+3)%4]&a[(j+1)%4]),k--},i=function(a){for(j=3;j>=0;j--)a[j]-=p[63&a[(j+3)%4]]});var q=function(a){var b=[];for(j=0;j<4;j++){var c=m.getInt16Le();null!==o&&(g?c^=o.getInt16Le():o.putInt16Le(c)),b.push(65535&c)}k=g?0:63;for(var d=0;d<a.length;d++)for(var e=0;e<a[d][0];e++)a[d][1](b);for(j=0;j<4;j++)null!==o&&(g?o.putInt16Le(b[j]):b[j]^=o.getInt16Le()),n.putInt16Le(b[j])},r=null;return r={start:function(b,c){b&&"string"==typeof b&&(b=a.util.createBuffer(b)),l=!1,m=a.util.createBuffer(),n=c||new a.util.createBuffer,o=b,r.output=n},update:function(a){for(l||m.putBuffer(a);m.length()>=8;)q([[5,h],[1,i],[6,h],[1,i],[5,h]])},finish:function(a){var b=!0;if(g)if(a)b=a(8,m,!g);else{var c=8===m.length()?8:8-m.length();m.fillWithByte(c,c)}if(b&&(l=!0,r.update()),!g&&(b=0===m.length()))if(a)b=a(8,n,!g);else{var d=n.length(),e=n.at(d-1);e>d?b=!1:n.truncate(e)}return b}}};a.rc2.startEncrypting=function(b,c,d){var e=a.rc2.createEncryptionCipher(b,128);return e.start(c,d),e},a.rc2.createEncryptionCipher=function(a,b){return f(a,b,!0)},a.rc2.startDecrypting=function(b,c,d){var e=a.rc2.createDecryptionCipher(b,128);return e.start(c,d),e},a.rc2.createDecryptionCipher=function(a,b){return f(a,b,!1)}}var d="rc2";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/rc2",["require","module","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(a,b,c){this.data=[],null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function c(){return new b(null)}function d(a,b,c,d,e,f){for(;--f>=0;){var g=b*this.data[a++]+c.data[d]+e;e=Math.floor(g/67108864),c.data[d++]=67108863&g}return e}function e(a,b,c,d,e,f){for(var g=32767&b,h=b>>15;--f>=0;){var i=32767&this.data[a],j=this.data[a++]>>15,k=h*i+j*g;i=g*i+((32767&k)<<15)+c.data[d]+(1073741823&e),e=(i>>>30)+(k>>>15)+h*j+(e>>>30),c.data[d++]=1073741823&i}return e}function f(a,b,c,d,e,f){for(var g=16383&b,h=b>>14;--f>=0;){var i=16383&this.data[a],j=this.data[a++]>>14,k=h*i+j*g;i=g*i+((16383&k)<<14)+c.data[d]+e,e=(i>>28)+(k>>14)+h*j,c.data[d++]=268435455&i}return e}function g(a){return fb.charAt(a)}function h(a,b){var c=gb[a.charCodeAt(b)];return null==c?-1:c}function i(a){for(var b=this.t-1;b>=0;--b)a.data[b]=this.data[b];a.t=this.t,a.s=this.s}function j(a){this.t=1,this.s=a<0?-1:0,a>0?this.data[0]=a:a<-1?this.data[0]=a+this.DV:this.t=0}function k(a){var b=c();return b.fromInt(a),b}function l(a,c){var d;if(16==c)d=4;else if(8==c)d=3;else if(256==c)d=8;else if(2==c)d=1;else if(32==c)d=5;else{if(4!=c)return void this.fromRadix(a,c);d=2}this.t=0,this.s=0;for(var e=a.length,f=!1,g=0;--e>=0;){var i=8==d?255&a[e]:h(a,e);i<0?"-"==a.charAt(e)&&(f=!0):(f=!1,0==g?this.data[this.t++]=i:g+d>this.DB?(this.data[this.t-1]|=(i&(1<<this.DB-g)-1)<<g,this.data[this.t++]=i>>this.DB-g):this.data[this.t-1]|=i<<g,g+=d,g>=this.DB&&(g-=this.DB))}8==d&&0!=(128&a[0])&&(this.s=-1,g>0&&(this.data[this.t-1]|=(1<<this.DB-g)-1<<g)),this.clamp(),f&&b.ZERO.subTo(this,this)}function m(){for(var a=this.s&this.DM;this.t>0&&this.data[this.t-1]==a;)--this.t}function n(a){if(this.s<0)return"-"+this.negate().toString(a);var b;if(16==a)b=4;else if(8==a)b=3;else if(2==a)b=1;else if(32==a)b=5;else{if(4!=a)return this.toRadix(a);b=2}var c,d=(1<<b)-1,e=!1,f="",h=this.t,i=this.DB-h*this.DB%b;if(h-- >0)for(i<this.DB&&(c=this.data[h]>>i)>0&&(e=!0,f=g(c));h>=0;)i<b?(c=(this.data[h]&(1<<i)-1)<<b-i,c|=this.data[--h]>>(i+=this.DB-b)):(c=this.data[h]>>(i-=b)&d,i<=0&&(i+=this.DB,--h)),c>0&&(e=!0),e&&(f+=g(c));return e?f:"0"}function o(){var a=c();return b.ZERO.subTo(this,a),a}function p(){return this.s<0?this.negate():this}function q(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t;if(b=c-a.t,0!=b)return this.s<0?-b:b;for(;--c>=0;)if(0!=(b=this.data[c]-a.data[c]))return b;return 0}function r(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=(b=a>>1)&&(a=b,c+=1),c}function s(){return this.t<=0?0:this.DB*(this.t-1)+r(this.data[this.t-1]^this.s&this.DM)}function t(a,b){var c;for(c=this.t-1;c>=0;--c)b.data[c+a]=this.data[c];for(c=a-1;c>=0;--c)b.data[c]=0;b.t=this.t+a,b.s=this.s}function u(a,b){for(var c=a;c<this.t;++c)b.data[c-a]=this.data[c];b.t=Math.max(this.t-a,0),b.s=this.s}function v(a,b){var c,d=a%this.DB,e=this.DB-d,f=(1<<e)-1,g=Math.floor(a/this.DB),h=this.s<<d&this.DM;for(c=this.t-1;c>=0;--c)b.data[c+g+1]=this.data[c]>>e|h,h=(this.data[c]&f)<<d;for(c=g-1;c>=0;--c)b.data[c]=0;b.data[g]=h,b.t=this.t+g+1,b.s=this.s,b.clamp()}function w(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)return void(b.t=0);var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b.data[0]=this.data[c]>>d;for(var g=c+1;g<this.t;++g)b.data[g-c-1]|=(this.data[g]&f)<<e,b.data[g-c]=this.data[g]>>d;d>0&&(b.data[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()}function x(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);c<e;)d+=this.data[c]-a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=d<0?-1:0,d<-1?b.data[c++]=this.DV+d:d>0&&(b.data[c++]=d),b.t=c,b.clamp()}function y(a,c){var d=this.abs(),e=a.abs(),f=d.t;for(c.t=f+e.t;--f>=0;)c.data[f]=0;for(f=0;f<e.t;++f)c.data[f+d.t]=d.am(0,e.data[f],c,f,0,d.t);c.s=0,c.clamp(),this.s!=a.s&&b.ZERO.subTo(c,c)}function z(a){for(var b=this.abs(),c=a.t=2*b.t;--c>=0;)a.data[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b.data[c],a,2*c,0,1);(a.data[c+b.t]+=b.am(c+1,2*b.data[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a.data[c+b.t]-=b.DV,a.data[c+b.t+1]=1)}a.t>0&&(a.data[a.t-1]+=b.am(c,b.data[c],a,2*c,0,1)),a.s=0,a.clamp()}function A(a,d,e){var f=a.abs();if(!(f.t<=0)){var g=this.abs();if(g.t<f.t)return null!=d&&d.fromInt(0),void(null!=e&&this.copyTo(e));null==e&&(e=c());var h=c(),i=this.s,j=a.s,k=this.DB-r(f.data[f.t-1]);k>0?(f.lShiftTo(k,h),g.lShiftTo(k,e)):(f.copyTo(h),g.copyTo(e));var l=h.t,m=h.data[l-1];if(0!=m){var n=m*(1<<this.F1)+(l>1?h.data[l-2]>>this.F2:0),o=this.FV/n,p=(1<<this.F1)/n,q=1<<this.F2,s=e.t,t=s-l,u=null==d?c():d;for(h.dlShiftTo(t,u),e.compareTo(u)>=0&&(e.data[e.t++]=1,e.subTo(u,e)),b.ONE.dlShiftTo(l,u),u.subTo(h,h);h.t<l;)h.data[h.t++]=0;for(;--t>=0;){var v=e.data[--s]==m?this.DM:Math.floor(e.data[s]*o+(e.data[s-1]+q)*p);if((e.data[s]+=h.am(0,v,e,t,0,l))<v)for(h.dlShiftTo(t,u),e.subTo(u,e);e.data[s]<--v;)e.subTo(u,e)}null!=d&&(e.drShiftTo(l,d),i!=j&&b.ZERO.subTo(d,d)),e.t=l,e.clamp(),k>0&&e.rShiftTo(k,e),i<0&&b.ZERO.subTo(e,e)}}}function B(a){var d=c();return this.abs().divRemTo(a,null,d),this.s<0&&d.compareTo(b.ZERO)>0&&a.subTo(d,d),d}function C(a){this.m=a}function D(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a}function E(a){return a}function F(a){a.divRemTo(this.m,null,a)}function G(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function H(a,b){a.squareTo(b),this.reduce(b)}function I(){if(this.t<1)return 0;var a=this.data[0];if(0==(1&a))return 0;var b=3&a;return b=b*(2-(15&a)*b)&15,b=b*(2-(255&a)*b)&255,b=b*(2-((65535&a)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV,b>0?this.DV-b:-b}function J(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function K(a){var d=c();return a.abs().dlShiftTo(this.m.t,d),d.divRemTo(this.m,null,d),a.s<0&&d.compareTo(b.ZERO)>0&&this.m.subTo(d,d),d}function L(a){var b=c();return a.copyTo(b),this.reduce(b),b}function M(a){for(;a.t<=this.mt2;)a.data[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=32767&a.data[b],d=c*this.mpl+((c*this.mph+(a.data[b]>>15)*this.mpl&this.um)<<15)&a.DM;for(c=b+this.m.t,a.data[c]+=this.m.am(0,d,a,b,0,this.m.t);a.data[c]>=a.DV;)a.data[c]-=a.DV,a.data[++c]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)}function N(a,b){a.squareTo(b),this.reduce(b)}function O(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function P(){return 0==(this.t>0?1&this.data[0]:this.s)}function Q(a,d){if(a>4294967295||a<1)return b.ONE;var e=c(),f=c(),g=d.convert(this),h=r(a)-1;for(g.copyTo(e);--h>=0;)if(d.sqrTo(e,f),(a&1<<h)>0)d.mulTo(f,g,e);else{var i=e;e=f,f=i}return d.revert(e)}function R(a,b){var c;return c=a<256||b.isEven()?new C(b):new J(b),this.exp(a,c)}function S(){var a=c();return this.copyTo(a),a}function T(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function U(){return 0==this.t?this.s:this.data[0]<<24>>24}function V(){return 0==this.t?this.s:this.data[0]<<16>>16}function W(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function X(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1}function Y(a){if(null==a&&(a=10),0==this.signum()||a<2||a>36)return"0";
var b=this.chunkSize(a),d=Math.pow(a,b),e=k(d),f=c(),g=c(),h="";for(this.divRemTo(e,f,g);f.signum()>0;)h=(d+g.intValue()).toString(a).substr(1)+h,f.divRemTo(e,f,g);return g.intValue().toString(a)+h}function Z(a,c){this.fromInt(0),null==c&&(c=10);for(var d=this.chunkSize(c),e=Math.pow(c,d),f=!1,g=0,i=0,j=0;j<a.length;++j){var k=h(a,j);k<0?"-"==a.charAt(j)&&0==this.signum()&&(f=!0):(i=c*i+k,++g>=d&&(this.dMultiply(e),this.dAddOffset(i,0),g=0,i=0))}g>0&&(this.dMultiply(Math.pow(c,g)),this.dAddOffset(i,0)),f&&b.ZERO.subTo(this,this)}function $(a,c,d){if("number"==typeof c)if(a<2)this.fromInt(1);else for(this.fromNumber(a,d),this.testBit(a-1)||this.bitwiseTo(b.ONE.shiftLeft(a-1),ga,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(c);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(b.ONE.shiftLeft(a-1),this);else{var e=new Array,f=7&a;e.length=(a>>3)+1,c.nextBytes(e),f>0?e[0]&=(1<<f)-1:e[0]=0,this.fromString(e,256)}}function _(){var a=this.t,b=new Array;b[0]=this.s;var c,d=this.DB-a*this.DB%8,e=0;if(a-- >0)for(d<this.DB&&(c=this.data[a]>>d)!=(this.s&this.DM)>>d&&(b[e++]=c|this.s<<this.DB-d);a>=0;)d<8?(c=(this.data[a]&(1<<d)-1)<<8-d,c|=this.data[--a]>>(d+=this.DB-8)):(c=this.data[a]>>(d-=8)&255,d<=0&&(d+=this.DB,--a)),0!=(128&c)&&(c|=-256),0==e&&(128&this.s)!=(128&c)&&++e,(e>0||c!=this.s)&&(b[e++]=c);return b}function aa(a){return 0==this.compareTo(a)}function ba(a){return this.compareTo(a)<0?this:a}function ca(a){return this.compareTo(a)>0?this:a}function da(a,b,c){var d,e,f=Math.min(a.t,this.t);for(d=0;d<f;++d)c.data[d]=b(this.data[d],a.data[d]);if(a.t<this.t){for(e=a.s&this.DM,d=f;d<this.t;++d)c.data[d]=b(this.data[d],e);c.t=this.t}else{for(e=this.s&this.DM,d=f;d<a.t;++d)c.data[d]=b(e,a.data[d]);c.t=a.t}c.s=b(this.s,a.s),c.clamp()}function ea(a,b){return a&b}function fa(a){var b=c();return this.bitwiseTo(a,ea,b),b}function ga(a,b){return a|b}function ha(a){var b=c();return this.bitwiseTo(a,ga,b),b}function ia(a,b){return a^b}function ja(a){var b=c();return this.bitwiseTo(a,ia,b),b}function ka(a,b){return a&~b}function la(a){var b=c();return this.bitwiseTo(a,ka,b),b}function ma(){for(var a=c(),b=0;b<this.t;++b)a.data[b]=this.DM&~this.data[b];return a.t=this.t,a.s=~this.s,a}function na(a){var b=c();return a<0?this.rShiftTo(-a,b):this.lShiftTo(a,b),b}function oa(a){var b=c();return a<0?this.lShiftTo(-a,b):this.rShiftTo(a,b),b}function pa(a){if(0==a)return-1;var b=0;return 0==(65535&a)&&(a>>=16,b+=16),0==(255&a)&&(a>>=8,b+=8),0==(15&a)&&(a>>=4,b+=4),0==(3&a)&&(a>>=2,b+=2),0==(1&a)&&++b,b}function qa(){for(var a=0;a<this.t;++a)if(0!=this.data[a])return a*this.DB+pa(this.data[a]);return this.s<0?this.t*this.DB:-1}function ra(a){for(var b=0;0!=a;)a&=a-1,++b;return b}function sa(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c)a+=ra(this.data[c]^b);return a}function ta(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this.data[b]&1<<a%this.DB)}function ua(a,c){var d=b.ONE.shiftLeft(a);return this.bitwiseTo(d,c,d),d}function va(a){return this.changeBit(a,ga)}function wa(a){return this.changeBit(a,ka)}function xa(a){return this.changeBit(a,ia)}function ya(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);c<e;)d+=this.data[c]+a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a.data[c],b.data[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=d<0?-1:0,d>0?b.data[c++]=d:d<-1&&(b.data[c++]=this.DV+d),b.t=c,b.clamp()}function za(a){var b=c();return this.addTo(a,b),b}function Aa(a){var b=c();return this.subTo(a,b),b}function Ba(a){var b=c();return this.multiplyTo(a,b),b}function Ca(a){var b=c();return this.divRemTo(a,b,null),b}function Da(a){var b=c();return this.divRemTo(a,null,b),b}function Ea(a){var b=c(),d=c();return this.divRemTo(a,b,d),new Array(b,d)}function Fa(a){this.data[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()}function Ga(a,b){if(0!=a){for(;this.t<=b;)this.data[this.t++]=0;for(this.data[b]+=a;this.data[b]>=this.DV;)this.data[b]-=this.DV,++b>=this.t&&(this.data[this.t++]=0),++this.data[b]}}function Ha(){}function Ia(a){return a}function Ja(a,b,c){a.multiplyTo(b,c)}function Ka(a,b){a.squareTo(b)}function La(a){return this.exp(a,new Ha)}function Ma(a,b,c){var d=Math.min(this.t+a.t,b);for(c.s=0,c.t=d;d>0;)c.data[--d]=0;var e;for(e=c.t-this.t;d<e;++d)c.data[d+this.t]=this.am(0,a.data[d],c,d,0,this.t);for(e=Math.min(a.t,b);d<e;++d)this.am(0,a.data[d],c,d,0,b-d);c.clamp()}function Na(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;--d>=0;)c.data[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c.data[this.t+d-b]=this.am(b-d,a.data[d],c,0,0,this.t+d-b);c.clamp(),c.drShiftTo(1,c)}function Oa(a){this.r2=c(),this.q3=c(),b.ONE.dlShiftTo(2*a.t,this.r2),this.mu=this.r2.divide(a),this.m=a}function Pa(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(a.compareTo(this.m)<0)return a;var b=c();return a.copyTo(b),this.reduce(b),b}function Qa(a){return a}function Ra(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);a.compareTo(this.r2)<0;)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)}function Sa(a,b){a.squareTo(b),this.reduce(b)}function Ta(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function Ua(a,b){var d,e,f=a.bitLength(),g=k(1);if(f<=0)return g;d=f<18?1:f<48?3:f<144?4:f<768?5:6,e=f<8?new C(b):b.isEven()?new Oa(b):new J(b);var h=new Array,i=3,j=d-1,l=(1<<d)-1;if(h[1]=e.convert(this),d>1){var m=c();for(e.sqrTo(h[1],m);i<=l;)h[i]=c(),e.mulTo(m,h[i-2],h[i]),i+=2}var n,o,p=a.t-1,q=!0,s=c();for(f=r(a.data[p])-1;p>=0;){for(f>=j?n=a.data[p]>>f-j&l:(n=(a.data[p]&(1<<f+1)-1)<<j-f,p>0&&(n|=a.data[p-1]>>this.DB+f-j)),i=d;0==(1&n);)n>>=1,--i;if((f-=i)<0&&(f+=this.DB,--p),q)h[n].copyTo(g),q=!1;else{for(;i>1;)e.sqrTo(g,s),e.sqrTo(s,g),i-=2;i>0?e.sqrTo(g,s):(o=g,g=s,s=o),e.mulTo(s,h[n],g)}for(;p>=0&&0==(a.data[p]&1<<f);)e.sqrTo(g,s),o=g,g=s,s=o,--f<0&&(f=this.DB-1,--p)}return e.revert(g)}function Va(a){var b=this.s<0?this.negate():this.clone(),c=a.s<0?a.negate():a.clone();if(b.compareTo(c)<0){var d=b;b=c,c=d}var e=b.getLowestSetBit(),f=c.getLowestSetBit();if(f<0)return b;for(e<f&&(f=e),f>0&&(b.rShiftTo(f,b),c.rShiftTo(f,c));b.signum()>0;)(e=b.getLowestSetBit())>0&&b.rShiftTo(e,b),(e=c.getLowestSetBit())>0&&c.rShiftTo(e,c),b.compareTo(c)>=0?(b.subTo(c,b),b.rShiftTo(1,b)):(c.subTo(b,c),c.rShiftTo(1,c));return f>0&&c.lShiftTo(f,c),c}function Wa(a){if(a<=0)return 0;var b=this.DV%a,c=this.s<0?a-1:0;if(this.t>0)if(0==b)c=this.data[0]%a;else for(var d=this.t-1;d>=0;--d)c=(b*c+this.data[d])%a;return c}function Xa(a){var c=a.isEven();if(this.isEven()&&c||0==a.signum())return b.ZERO;for(var d=a.clone(),e=this.clone(),f=k(1),g=k(0),h=k(0),i=k(1);0!=d.signum();){for(;d.isEven();)d.rShiftTo(1,d),c?(f.isEven()&&g.isEven()||(f.addTo(this,f),g.subTo(a,g)),f.rShiftTo(1,f)):g.isEven()||g.subTo(a,g),g.rShiftTo(1,g);for(;e.isEven();)e.rShiftTo(1,e),c?(h.isEven()&&i.isEven()||(h.addTo(this,h),i.subTo(a,i)),h.rShiftTo(1,h)):i.isEven()||i.subTo(a,i),i.rShiftTo(1,i);d.compareTo(e)>=0?(d.subTo(e,d),c&&f.subTo(h,f),g.subTo(i,g)):(e.subTo(d,e),c&&h.subTo(f,h),i.subTo(g,i))}return 0!=e.compareTo(b.ONE)?b.ZERO:i.compareTo(a)>=0?i.subtract(a):i.signum()<0?(i.addTo(a,i),i.signum()<0?i.add(a):i):i}function Ya(a){var b,c=this.abs();if(1==c.t&&c.data[0]<=hb[hb.length-1]){for(b=0;b<hb.length;++b)if(c.data[0]==hb[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<hb.length;){for(var d=hb[b],e=b+1;e<hb.length&&d<ib;)d*=hb[e++];for(d=c.modInt(d);b<e;)if(d%hb[b++]==0)return!1}return c.millerRabin(a)}function Za(a){var c=this.subtract(b.ONE),d=c.getLowestSetBit();if(d<=0)return!1;for(var e,f=c.shiftRight(d),g=$a(),h=0;h<a;++h){do e=new b(this.bitLength(),g);while(e.compareTo(b.ONE)<=0||e.compareTo(c)>=0);var i=e.modPow(f,this);if(0!=i.compareTo(b.ONE)&&0!=i.compareTo(c)){for(var j=1;j++<d&&0!=i.compareTo(c);)if(i=i.modPowInt(2,this),0==i.compareTo(b.ONE))return!1;if(0!=i.compareTo(c))return!1}}return!0}function $a(){return{nextBytes:function(a){for(var b=0;b<a.length;++b)a[b]=Math.floor(256*Math.random())}}}var _a,ab=0xdeadbeefcafe,bb=15715070==(16777215&ab);"undefined"==typeof navigator?(b.prototype.am=f,_a=28):bb&&"Microsoft Internet Explorer"==navigator.appName?(b.prototype.am=e,_a=30):bb&&"Netscape"!=navigator.appName?(b.prototype.am=d,_a=26):(b.prototype.am=f,_a=28),b.prototype.DB=_a,b.prototype.DM=(1<<_a)-1,b.prototype.DV=1<<_a;var cb=52;b.prototype.FV=Math.pow(2,cb),b.prototype.F1=cb-_a,b.prototype.F2=2*_a-cb;var db,eb,fb="0123456789abcdefghijklmnopqrstuvwxyz",gb=new Array;for(db="0".charCodeAt(0),eb=0;eb<=9;++eb)gb[db++]=eb;for(db="a".charCodeAt(0),eb=10;eb<36;++eb)gb[db++]=eb;for(db="A".charCodeAt(0),eb=10;eb<36;++eb)gb[db++]=eb;C.prototype.convert=D,C.prototype.revert=E,C.prototype.reduce=F,C.prototype.mulTo=G,C.prototype.sqrTo=H,J.prototype.convert=K,J.prototype.revert=L,J.prototype.reduce=M,J.prototype.mulTo=O,J.prototype.sqrTo=N,b.prototype.copyTo=i,b.prototype.fromInt=j,b.prototype.fromString=l,b.prototype.clamp=m,b.prototype.dlShiftTo=t,b.prototype.drShiftTo=u,b.prototype.lShiftTo=v,b.prototype.rShiftTo=w,b.prototype.subTo=x,b.prototype.multiplyTo=y,b.prototype.squareTo=z,b.prototype.divRemTo=A,b.prototype.invDigit=I,b.prototype.isEven=P,b.prototype.exp=Q,b.prototype.toString=n,b.prototype.negate=o,b.prototype.abs=p,b.prototype.compareTo=q,b.prototype.bitLength=s,b.prototype.mod=B,b.prototype.modPowInt=R,b.ZERO=k(0),b.ONE=k(1),Ha.prototype.convert=Ia,Ha.prototype.revert=Ia,Ha.prototype.mulTo=Ja,Ha.prototype.sqrTo=Ka,Oa.prototype.convert=Pa,Oa.prototype.revert=Qa,Oa.prototype.reduce=Ra,Oa.prototype.mulTo=Ta,Oa.prototype.sqrTo=Sa;var hb=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],ib=(1<<26)/hb[hb.length-1];b.prototype.chunkSize=W,b.prototype.toRadix=Y,b.prototype.fromRadix=Z,b.prototype.fromNumber=$,b.prototype.bitwiseTo=da,b.prototype.changeBit=ua,b.prototype.addTo=ya,b.prototype.dMultiply=Fa,b.prototype.dAddOffset=Ga,b.prototype.multiplyLowerTo=Ma,b.prototype.multiplyUpperTo=Na,b.prototype.modInt=Wa,b.prototype.millerRabin=Za,b.prototype.clone=S,b.prototype.intValue=T,b.prototype.byteValue=U,b.prototype.shortValue=V,b.prototype.signum=X,b.prototype.toByteArray=_,b.prototype.equals=aa,b.prototype.min=ba,b.prototype.max=ca,b.prototype.and=fa,b.prototype.or=ha,b.prototype.xor=ja,b.prototype.andNot=la,b.prototype.not=ma,b.prototype.shiftLeft=na,b.prototype.shiftRight=oa,b.prototype.getLowestSetBit=qa,b.prototype.bitCount=sa,b.prototype.testBit=ta,b.prototype.setBit=va,b.prototype.clearBit=wa,b.prototype.flipBit=xa,b.prototype.add=za,b.prototype.subtract=Aa,b.prototype.multiply=Ba,b.prototype.divide=Ca,b.prototype.remainder=Da,b.prototype.divideAndRemainder=Ea,b.prototype.modPow=Ua,b.prototype.modInverse=Xa,b.prototype.pow=La,b.prototype.gcd=Va,b.prototype.isProbablePrime=Ya,a.jsbn=a.jsbn||{},a.jsbn.BigInteger=b}var d="jsbn";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/jsbn",["require","module"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(b,c,d){d||(d=a.md.sha1.create());for(var e="",f=Math.ceil(c/d.digestLength),g=0;g<f;++g){var h=String.fromCharCode(g>>24&255,g>>16&255,g>>8&255,255&g);d.start(),d.update(b+h),e+=d.digest().getBytes()}return e.substring(0,c)}var c=a.pkcs1=a.pkcs1||{};c.encode_rsa_oaep=function(c,d,e){var f,g,h,i;"string"==typeof e?(f=e,g=arguments[3]||void 0,h=arguments[4]||void 0):e&&(f=e.label||void 0,g=e.seed||void 0,h=e.md||void 0,e.mgf1&&e.mgf1.md&&(i=e.mgf1.md)),h?h.start():h=a.md.sha1.create(),i||(i=h);var j=Math.ceil(c.n.bitLength()/8),k=j-2*h.digestLength-2;if(d.length>k){var l=new Error("RSAES-OAEP input message length is too long.");throw l.length=d.length,l.maxLength=k,l}f||(f=""),h.update(f,"raw");for(var m=h.digest(),n="",o=k-d.length,p=0;p<o;p++)n+="\0";var q=m.getBytes()+n+""+d;if(g){if(g.length!==h.digestLength){var l=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw l.seedLength=g.length,l.digestLength=h.digestLength,l}}else g=a.random.getBytes(h.digestLength);var r=b(g,j-h.digestLength-1,i),s=a.util.xorBytes(q,r,q.length),t=b(s,h.digestLength,i),u=a.util.xorBytes(g,t,g.length);return"\0"+u+s},c.decode_rsa_oaep=function(c,d,e){var f,g,h;"string"==typeof e?(f=e,g=arguments[3]||void 0):e&&(f=e.label||void 0,g=e.md||void 0,e.mgf1&&e.mgf1.md&&(h=e.mgf1.md));var i=Math.ceil(c.n.bitLength()/8);if(d.length!==i){var j=new Error("RSAES-OAEP encoded message length is invalid.");throw j.length=d.length,j.expectedLength=i,j}if(void 0===g?g=a.md.sha1.create():g.start(),h||(h=g),i<2*g.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");f||(f=""),g.update(f,"raw");for(var k=g.digest().getBytes(),l=d.charAt(0),m=d.substring(1,g.digestLength+1),n=d.substring(1+g.digestLength),o=b(n,g.digestLength,h),p=a.util.xorBytes(m,o,m.length),q=b(p,i-g.digestLength-1,h),r=a.util.xorBytes(n,q,n.length),s=r.substring(0,g.digestLength),j="\0"!==l,t=0;t<g.digestLength;++t)j|=k.charAt(t)!==s.charAt(t);for(var u=1,v=g.digestLength,w=g.digestLength;w<r.length;w++){var x=r.charCodeAt(w),y=1&x^1,z=u?65534:0;j|=x&z,u&=y,v+=u}if(j||1!==r.charCodeAt(v))throw new Error("Invalid RSAES-OAEP padding.");return r.substring(v+1)}}var d="pkcs1";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs1",["require","module","./util","./random","./sha1"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(a,b,e,f){return"workers"in e?d(a,b,e,f):c(a,b,e,f)}function c(b,d,g,h){var j=e(b,d),k=0,l=f(j.bitLength());"millerRabinTests"in g&&(l=g.millerRabinTests);var m=10;"maxBlockTime"in g&&(m=g.maxBlockTime);var n=+new Date;do{if(j.bitLength()>b&&(j=e(b,d)),j.isProbablePrime(l))return h(null,j);j.dAddOffset(i[k++%8],0)}while(m<0||+new Date-n<m);a.util.setImmediate(function(){c(b,d,g,h)})}function d(b,d,f,g){function i(){function a(a){if(!o){--i;var f=a.data;if(f.found){for(var k=0;k<c.length;++k)c[k].terminate();return o=!0,g(null,new h(f.prime,16))}j.bitLength()>b&&(j=e(b,d));var n=j.toString(16);a.target.postMessage({hex:n,workLoad:l}),j.dAddOffset(m,0)}}k=Math.max(1,k);for(var c=[],f=0;f<k;++f)c[f]=new Worker(n);for(var i=k,f=0;f<k;++f)c[f].addEventListener("message",a);var o=!1}if("undefined"==typeof Worker)return c(b,d,f,g);var j=e(b,d),k=f.workers,l=f.workLoad||100,m=30*l/8,n=f.workerScript||"forge/prime.worker.js";return k===-1?a.util.estimateCores(function(a,b){a&&(b=2),k=b-1,i()}):void i()}function e(a,b){var c=new h(a,b),d=a-1;return c.testBit(d)||c.bitwiseTo(h.ONE.shiftLeft(d),k,c),c.dAddOffset(31-c.mod(j).byteValue(),0),c}function f(a){return a<=100?27:a<=150?18:a<=200?15:a<=250?12:a<=300?9:a<=350?8:a<=400?7:a<=500?6:a<=600?5:a<=800?4:a<=1250?3:2}if(!a.prime){var g=a.prime=a.prime||{},h=a.jsbn.BigInteger,i=[6,4,2,4,2,4,6,2],j=new h(null);j.fromInt(30);var k=function(a,b){return a|b};g.generateProbablePrime=function(c,d,e){"function"==typeof d&&(e=d,d={}),d=d||{};var f=d.algorithm||"PRIMEINC";"string"==typeof f&&(f={name:f}),f.options=f.options||{};var g=d.prng||a.random,h={nextBytes:function(a){for(var b=g.getBytesSync(a.length),c=0;c<a.length;++c)a[c]=b.charCodeAt(c)}};if("PRIMEINC"===f.name)return b(c,h,f.options,e);throw new Error("Invalid prime generation algorithm: "+f.name)}}}var d="prime";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/prime",["require","module","./util","./jsbn","./random"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(b,c,d){var e=a.util.createBuffer(),f=Math.ceil(c.n.bitLength()/8);if(b.length>f-11){var g=new Error("Message is too long for PKCS#1 v1.5 padding.");throw g.length=b.length,g.max=f-11,g}e.putByte(0),e.putByte(d);var h,i=f-3-b.length;if(0===d||1===d){h=0===d?0:255;for(var j=0;j<i;++j)e.putByte(h)}else for(;i>0;){for(var k=0,l=a.random.getBytes(i),j=0;j<i;++j)h=l.charCodeAt(j),0===h?++k:e.putByte(h);i=k}return e.putByte(0),e.putBytes(b),e}function c(b,c,d,e){var f=Math.ceil(c.n.bitLength()/8),g=a.util.createBuffer(b),h=g.getByte(),i=g.getByte();if(0!==h||d&&0!==i&&1!==i||!d&&2!=i||d&&0===i&&"undefined"==typeof e)throw new Error("Encryption block is invalid.");var j=0;if(0===i){j=f-3-e;for(var k=0;k<j;++k)if(0!==g.getByte())throw new Error("Encryption block is invalid.")}else if(1===i)for(j=0;g.length()>1;){if(255!==g.getByte()){--g.read;break}++j}else if(2===i)for(j=0;g.length()>1;){if(0===g.getByte()){--g.read;break}++j}var l=g.getByte();if(0!==l||j!==f-3-g.length())throw new Error("Encryption block is invalid.");return g.getBytes()}function d(b,c,d){function e(){f(b.pBits,function(a,c){return a?d(a):(b.p=c,null!==b.q?h(a,b.q):void f(b.qBits,h))})}function f(b,c){a.prime.generateProbablePrime(b,j,c)}function h(a,c){if(a)return d(a);if(b.q=c,b.p.compareTo(b.q)<0){var j=b.p;b.p=b.q,b.q=j}if(0!==b.p.subtract(g.ONE).gcd(b.e).compareTo(g.ONE))return b.p=null,void e();if(0!==b.q.subtract(g.ONE).gcd(b.e).compareTo(g.ONE))return b.q=null,void f(b.qBits,h);if(b.p1=b.p.subtract(g.ONE),b.q1=b.q.subtract(g.ONE),b.phi=b.p1.multiply(b.q1),0!==b.phi.gcd(b.e).compareTo(g.ONE))return b.p=b.q=null,void e();if(b.n=b.p.multiply(b.q),b.n.bitLength()!==b.bits)return b.q=null,void f(b.qBits,h);var k=b.e.modInverse(b.phi);b.keys={privateKey:i.rsa.setPrivateKey(b.n,b.e,k,b.p,b.q,k.mod(b.p1),k.mod(b.q1),b.q.modInverse(b.p)),publicKey:i.rsa.setPublicKey(b.n,b.e)},d(null,b.keys)}"function"==typeof c&&(d=c,c={}),c=c||{};var j={algorithm:{name:c.algorithm||"PRIMEINC",options:{workers:c.workers||2,workLoad:c.workLoad||100,workerScript:c.workerScript}}};"prng"in c&&(j.prng=c.prng),e()}function e(b){var c=b.toString(16);return c[0]>="8"&&(c="00"+c),a.util.hexToBytes(c)}function f(a){return a<=100?27:a<=150?18:a<=200?15:a<=250?12:a<=300?9:a<=350?8:a<=400?7:a<=500?6:a<=600?5:a<=800?4:a<=1250?3:2}if("undefined"==typeof g)var g=a.jsbn.BigInteger;var h=a.asn1;a.pki=a.pki||{},a.pki.rsa=a.rsa=a.rsa||{};var i=a.pki,j=[6,4,2,4,2,4,6,2],k={name:"PrivateKeyInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},l={name:"RSAPrivateKey",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},m={name:"RSAPublicKey",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},n=a.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:h.Class.UNIVERSAL,type:h.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},o=function(a){var b;if(!(a.algorithm in i.oids)){var c=new Error("Unknown message digest algorithm.");throw c.algorithm=a.algorithm,c}b=i.oids[a.algorithm];var d=h.oidToDer(b).getBytes(),e=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]),f=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]);f.value.push(h.create(h.Class.UNIVERSAL,h.Type.OID,!1,d)),f.value.push(h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,""));var g=h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,a.digest().getBytes());return e.value.push(f),e.value.push(g),h.toDer(e).getBytes()},p=function(b,c,d){if(d)return b.modPow(c.e,c.n);if(!c.p||!c.q)return b.modPow(c.d,c.n);c.dP||(c.dP=c.d.mod(c.p.subtract(g.ONE))),c.dQ||(c.dQ=c.d.mod(c.q.subtract(g.ONE))),c.qInv||(c.qInv=c.q.modInverse(c.p));var e;do e=new g(a.util.bytesToHex(a.random.getBytes(c.n.bitLength()/8)),16).mod(c.n);while(e.equals(g.ZERO));b=b.multiply(e.modPow(c.e,c.n)).mod(c.n);for(var f=b.mod(c.p).modPow(c.dP,c.p),h=b.mod(c.q).modPow(c.dQ,c.q);f.compareTo(h)<0;)f=f.add(c.p);var i=f.subtract(h).multiply(c.qInv).mod(c.p).multiply(c.q).add(h);return i=i.multiply(e.modInverse(c.n)).mod(c.n)};i.rsa.encrypt=function(c,d,e){var f,h=e,i=Math.ceil(d.n.bitLength()/8);e!==!1&&e!==!0?(h=2===e,f=b(c,d,e)):(f=a.util.createBuffer(),f.putBytes(c));for(var j=new g(f.toHex(),16),k=p(j,d,h),l=k.toString(16),m=a.util.createBuffer(),n=i-Math.ceil(l.length/2);n>0;)m.putByte(0),--n;return m.putBytes(a.util.hexToBytes(l)),m.getBytes()},i.rsa.decrypt=function(b,d,e,f){var h=Math.ceil(d.n.bitLength()/8);if(b.length!==h){var i=new Error("Encrypted message length is invalid.");throw i.length=b.length,i.expected=h,i}var j=new g(a.util.createBuffer(b).toHex(),16);if(j.compareTo(d.n)>=0)throw new Error("Encrypted message is invalid.");for(var k=p(j,d,e),l=k.toString(16),m=a.util.createBuffer(),n=h-Math.ceil(l.length/2);n>0;)m.putByte(0),--n;return m.putBytes(a.util.hexToBytes(l)),f!==!1?c(m.getBytes(),d,e):m.getBytes()},i.rsa.createKeyPairGenerationState=function(b,c,d){"string"==typeof b&&(b=parseInt(b,10)),b=b||2048,d=d||{};var e,f=d.prng||a.random,h={nextBytes:function(a){for(var b=f.getBytesSync(a.length),c=0;c<a.length;++c)a[c]=b.charCodeAt(c)}},i=d.algorithm||"PRIMEINC";if("PRIMEINC"!==i)throw new Error("Invalid key generation algorithm: "+i);return e={algorithm:i,state:0,bits:b,rng:h,eInt:c||65537,e:new g(null),p:null,q:null,qBits:b>>1,pBits:b-(b>>1),pqState:0,num:null,keys:null},e.e.fromInt(e.eInt),e},i.rsa.stepKeyPairGenerationState=function(a,b){"algorithm"in a||(a.algorithm="PRIMEINC");var c=new g(null);c.fromInt(30);for(var d,e=0,h=function(a,b){return a|b},k=+new Date,l=0;null===a.keys&&(b<=0||l<b);){if(0===a.state){var m=null===a.p?a.pBits:a.qBits,n=m-1;0===a.pqState?(a.num=new g(m,a.rng),a.num.testBit(n)||a.num.bitwiseTo(g.ONE.shiftLeft(n),h,a.num),a.num.dAddOffset(31-a.num.mod(c).byteValue(),0),e=0,++a.pqState):1===a.pqState?a.num.bitLength()>m?a.pqState=0:a.num.isProbablePrime(f(a.num.bitLength()))?++a.pqState:a.num.dAddOffset(j[e++%8],0):2===a.pqState?a.pqState=0===a.num.subtract(g.ONE).gcd(a.e).compareTo(g.ONE)?3:0:3===a.pqState&&(a.pqState=0,null===a.p?a.p=a.num:a.q=a.num,null!==a.p&&null!==a.q&&++a.state,a.num=null)}else if(1===a.state)a.p.compareTo(a.q)<0&&(a.num=a.p,a.p=a.q,a.q=a.num),++a.state;else if(2===a.state)a.p1=a.p.subtract(g.ONE),a.q1=a.q.subtract(g.ONE),a.phi=a.p1.multiply(a.q1),++a.state;else if(3===a.state)0===a.phi.gcd(a.e).compareTo(g.ONE)?++a.state:(a.p=null,a.q=null,a.state=0);else if(4===a.state)a.n=a.p.multiply(a.q),a.n.bitLength()===a.bits?++a.state:(a.q=null,a.state=0);else if(5===a.state){var o=a.e.modInverse(a.phi);a.keys={privateKey:i.rsa.setPrivateKey(a.n,a.e,o,a.p,a.q,o.mod(a.p1),o.mod(a.q1),a.q.modInverse(a.p)),publicKey:i.rsa.setPublicKey(a.n,a.e)}}d=+new Date,l+=d-k,k=d}return null!==a.keys},i.rsa.generateKeyPair=function(a,b,c,e){1===arguments.length?"object"==typeof a?(c=a,a=void 0):"function"==typeof a&&(e=a,a=void 0):2===arguments.length?"number"==typeof a?"function"==typeof b?(e=b,b=void 0):"number"!=typeof b&&(c=b,b=void 0):(c=a,e=b,a=void 0,b=void 0):3===arguments.length&&("number"==typeof b?"function"==typeof c&&(e=c,c=void 0):(e=c,c=b,b=void 0)),c=c||{},void 0===a&&(a=c.bits||2048),void 0===b&&(b=c.e||65537);var f=i.rsa.createKeyPairGenerationState(a,b,c);return e?void d(f,c,e):(i.rsa.stepKeyPairGenerationState(f,0),f.keys)},i.setRsaPublicKey=i.rsa.setPublicKey=function(d,e){var f={n:d,e:e};return f.encrypt=function(c,d,e){if("string"==typeof d?d=d.toUpperCase():void 0===d&&(d="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===d)d={encode:function(a,c,d){return b(a,c,2).getBytes()}};else if("RSA-OAEP"===d||"RSAES-OAEP"===d)d={encode:function(b,c){return a.pkcs1.encode_rsa_oaep(c,b,e)}};else if(["RAW","NONE","NULL",null].indexOf(d)!==-1)d={encode:function(a){return a}};else if("string"==typeof d)throw new Error('Unsupported encryption scheme: "'+d+'".');var g=d.encode(c,f,!0);return i.rsa.encrypt(g,f,!0)},f.verify=function(a,b,d){"string"==typeof d?d=d.toUpperCase():void 0===d&&(d="RSASSA-PKCS1-V1_5"),"RSASSA-PKCS1-V1_5"===d?d={verify:function(a,b){b=c(b,f,!0);var d=h.fromDer(b);return a===d.value[1].value}}:"NONE"!==d&&"NULL"!==d&&null!==d||(d={verify:function(a,b){return b=c(b,f,!0),a===b}});var e=i.rsa.decrypt(b,f,!0,!1);return d.verify(a,e,f.n.bitLength())},f},i.setRsaPrivateKey=i.rsa.setPrivateKey=function(b,d,e,f,g,h,j,k){var l={n:b,e:d,d:e,p:f,q:g,dP:h,dQ:j,qInv:k};return l.decrypt=function(b,d,e){"string"==typeof d?d=d.toUpperCase():void 0===d&&(d="RSAES-PKCS1-V1_5");var f=i.rsa.decrypt(b,l,!1,!1);if("RSAES-PKCS1-V1_5"===d)d={decode:c};else if("RSA-OAEP"===d||"RSAES-OAEP"===d)d={decode:function(b,c){return a.pkcs1.decode_rsa_oaep(c,b,e)}};else{if(["RAW","NONE","NULL",null].indexOf(d)===-1)throw new Error('Unsupported encryption scheme: "'+d+'".');d={decode:function(a){return a}}}return d.decode(f,l,!1)},l.sign=function(a,b){var c=!1;"string"==typeof b&&(b=b.toUpperCase()),void 0===b||"RSASSA-PKCS1-V1_5"===b?(b={encode:o},c=1):"NONE"!==b&&"NULL"!==b&&null!==b||(b={encode:function(){return a}},c=1);var d=b.encode(a,l.n.bitLength());return i.rsa.encrypt(d,l,c)},l},i.wrapRsaPrivateKey=function(a){return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(0).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.rsaEncryption).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")]),h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,h.toDer(a).getBytes())])},i.privateKeyFromAsn1=function(b){var c={},d=[];if(h.validate(b,k,c,d)&&(b=h.fromDer(a.util.createBuffer(c.privateKey))),c={},d=[],!h.validate(b,l,c,d)){var e=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw e.errors=d,e}var f,j,m,n,o,p,q,r;return f=a.util.createBuffer(c.privateKeyModulus).toHex(),j=a.util.createBuffer(c.privateKeyPublicExponent).toHex(),m=a.util.createBuffer(c.privateKeyPrivateExponent).toHex(),n=a.util.createBuffer(c.privateKeyPrime1).toHex(),o=a.util.createBuffer(c.privateKeyPrime2).toHex(),p=a.util.createBuffer(c.privateKeyExponent1).toHex(),q=a.util.createBuffer(c.privateKeyExponent2).toHex(),r=a.util.createBuffer(c.privateKeyCoefficient).toHex(),i.setRsaPrivateKey(new g(f,16),new g(j,16),new g(m,16),new g(n,16),new g(o,16),new g(p,16),new g(q,16),new g(r,16))},i.privateKeyToAsn1=i.privateKeyToRSAPrivateKey=function(a){return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(0).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.n)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.e)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.d)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.p)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.q)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.dP)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.dQ)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.qInv))])},i.publicKeyFromAsn1=function(b){var c={},d=[];if(h.validate(b,n,c,d)){var e=h.derToOid(c.publicKeyOid);if(e!==i.oids.rsaEncryption){var f=new Error("Cannot read public key. Unknown OID.");throw f.oid=e,f}b=c.rsaPublicKey}if(d=[],!h.validate(b,m,c,d)){var f=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw f.errors=d,f}var j=a.util.createBuffer(c.publicKeyModulus).toHex(),k=a.util.createBuffer(c.publicKeyExponent).toHex();return i.setRsaPublicKey(new g(j,16),new g(k,16))},i.publicKeyToAsn1=i.publicKeyToSubjectPublicKeyInfo=function(a){return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.rsaEncryption).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")]),h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,[i.publicKeyToRSAPublicKey(a)])])},i.publicKeyToRSAPublicKey=function(a){return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.n)),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,e(a.e))])}}var d="rsa";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),
a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/rsa",["require","module","./asn1","./jsbn","./oids","./pkcs1","./prime","./random","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(a,b){return a.start().update(b).digest().getBytes()}if("undefined"==typeof c)var c=a.jsbn.BigInteger;var d=a.asn1,e=a.pki=a.pki||{};e.pbe=a.pbe=a.pbe||{};var f=e.oids,g={name:"EncryptedPrivateKeyInfo",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:d.Class.UNIVERSAL,type:d.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},h={name:"PBES2Algorithms",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:d.Class.UNIVERSAL,type:d.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,onstructed:!0,capture:"kdfIterationCount"}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:d.Class.UNIVERSAL,type:d.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},i={name:"pkcs-12PbeParams",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:d.Class.UNIVERSAL,type:d.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"iterations"}]};e.encryptPrivateKeyInfo=function(b,c,g){g=g||{},g.saltSize=g.saltSize||8,g.count=g.count||2048,g.algorithm=g.algorithm||"aes128";var h,i,j,k=a.random.getBytesSync(g.saltSize),l=g.count,m=d.integerToDer(l);if(0===g.algorithm.indexOf("aes")||"des"===g.algorithm){var n,o,p;switch(g.algorithm){case"aes128":h=16,n=16,o=f["aes128-CBC"],p=a.aes.createEncryptionCipher;break;case"aes192":h=24,n=16,o=f["aes192-CBC"],p=a.aes.createEncryptionCipher;break;case"aes256":h=32,n=16,o=f["aes256-CBC"],p=a.aes.createEncryptionCipher;break;case"des":h=8,n=8,o=f.desCBC,p=a.des.createEncryptionCipher;break;default:var q=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw q.algorithm=g.algorithm,q}var r=a.pkcs5.pbkdf2(c,k,l,h),s=a.random.getBytesSync(n),t=p(r);t.start(s),t.update(d.toDer(b)),t.finish(),j=t.output.getBytes(),i=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(f.pkcs5PBES2).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(f.pkcs5PBKDF2).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,k),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,m.getBytes())])]),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(o).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,s)])])])}else{if("3des"!==g.algorithm){var q=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw q.algorithm=g.algorithm,q}h=24;var u=new a.util.ByteBuffer(k),r=e.pbe.generatePkcs12Key(c,u,1,l,h),s=e.pbe.generatePkcs12Key(c,u,2,l,h),t=a.des.createEncryptionCipher(r);t.start(s),t.update(d.toDer(b)),t.finish(),j=t.output.getBytes(),i=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(f["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,k),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,m.getBytes())])])}var v=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[i,d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,j)]);return v},e.decryptPrivateKeyInfo=function(b,c){var f=null,h={},i=[];if(!d.validate(b,g,h,i)){var j=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw j.errors=i,j}var k=d.derToOid(h.encryptionOid),l=e.pbe.getCipher(k,h.encryptionParams,c),m=a.util.createBuffer(h.encryptedData);return l.update(m),l.finish()&&(f=d.fromDer(l.output)),f},e.encryptedPrivateKeyToPem=function(b,c){var e={type:"ENCRYPTED PRIVATE KEY",body:d.toDer(b).getBytes()};return a.pem.encode(e,{maxline:c})},e.encryptedPrivateKeyFromPem=function(b){var c=a.pem.decode(b)[0];if("ENCRYPTED PRIVATE KEY"!==c.type){var e=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw e.headerType=c.type,e}if(c.procType&&"ENCRYPTED"===c.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return d.fromDer(c.body)},e.encryptRsaPrivateKey=function(b,c,f){if(f=f||{},!f.legacy){var g=e.wrapRsaPrivateKey(e.privateKeyToAsn1(b));return g=e.encryptPrivateKeyInfo(g,c,f),e.encryptedPrivateKeyToPem(g)}var h,i,j,k;switch(f.algorithm){case"aes128":h="AES-128-CBC",j=16,i=a.random.getBytesSync(16),k=a.aes.createEncryptionCipher;break;case"aes192":h="AES-192-CBC",j=24,i=a.random.getBytesSync(16),k=a.aes.createEncryptionCipher;break;case"aes256":h="AES-256-CBC",j=32,i=a.random.getBytesSync(16),k=a.aes.createEncryptionCipher;break;case"3des":h="DES-EDE3-CBC",j=24,i=a.random.getBytesSync(8),k=a.des.createEncryptionCipher;break;case"des":h="DES-CBC",j=8,i=a.random.getBytesSync(8),k=a.des.createEncryptionCipher;break;default:var l=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+f.algorithm+'".');throw l.algorithm=f.algorithm,l}var m=a.pbe.opensslDeriveBytes(c,i.substr(0,8),j),n=k(m);n.start(i),n.update(d.toDer(e.privateKeyToAsn1(b))),n.finish();var o={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:h,parameters:a.util.bytesToHex(i).toUpperCase()},body:n.output.getBytes()};return a.pem.encode(o)},e.decryptRsaPrivateKey=function(b,c){var f=null,g=a.pem.decode(b)[0];if("ENCRYPTED PRIVATE KEY"!==g.type&&"PRIVATE KEY"!==g.type&&"RSA PRIVATE KEY"!==g.type){var h=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw h.headerType=h,h}if(g.procType&&"ENCRYPTED"===g.procType.type){var i,j;switch(g.dekInfo.algorithm){case"DES-CBC":i=8,j=a.des.createDecryptionCipher;break;case"DES-EDE3-CBC":i=24,j=a.des.createDecryptionCipher;break;case"AES-128-CBC":i=16,j=a.aes.createDecryptionCipher;break;case"AES-192-CBC":i=24,j=a.aes.createDecryptionCipher;break;case"AES-256-CBC":i=32,j=a.aes.createDecryptionCipher;break;case"RC2-40-CBC":i=5,j=function(b){return a.rc2.createDecryptionCipher(b,40)};break;case"RC2-64-CBC":i=8,j=function(b){return a.rc2.createDecryptionCipher(b,64)};break;case"RC2-128-CBC":i=16,j=function(b){return a.rc2.createDecryptionCipher(b,128)};break;default:var h=new Error('Could not decrypt private key; unsupported encryption algorithm "'+g.dekInfo.algorithm+'".');throw h.algorithm=g.dekInfo.algorithm,h}var k=a.util.hexToBytes(g.dekInfo.parameters),l=a.pbe.opensslDeriveBytes(c,k.substr(0,8),i),m=j(l);if(m.start(k),m.update(a.util.createBuffer(g.body)),!m.finish())return f;f=m.output.getBytes()}else f=g.body;return f="ENCRYPTED PRIVATE KEY"===g.type?e.decryptPrivateKeyInfo(d.fromDer(f),c):d.fromDer(f),null!==f&&(f=e.privateKeyFromAsn1(f)),f},e.pbe.generatePkcs12Key=function(b,c,d,e,f,g){var h,i;"undefined"!=typeof g&&null!==g||(g=a.md.sha1.create());var j=g.digestLength,k=g.blockLength,l=new a.util.ByteBuffer,m=new a.util.ByteBuffer;if(null!==b&&void 0!==b){for(i=0;i<b.length;i++)m.putInt16(b.charCodeAt(i));m.putInt16(0)}var n=m.length(),o=c.length(),p=new a.util.ByteBuffer;p.fillWithByte(d,k);var q=k*Math.ceil(o/k),r=new a.util.ByteBuffer;for(i=0;i<q;i++)r.putByte(c.at(i%o));var s=k*Math.ceil(n/k),t=new a.util.ByteBuffer;for(i=0;i<s;i++)t.putByte(m.at(i%n));var u=r;u.putBuffer(t);for(var v=Math.ceil(f/j),w=1;w<=v;w++){var x=new a.util.ByteBuffer;x.putBytes(p.bytes()),x.putBytes(u.bytes());for(var y=0;y<e;y++)g.start(),g.update(x.getBytes()),x=g.digest();var z=new a.util.ByteBuffer;for(i=0;i<k;i++)z.putByte(x.at(i%j));var A=Math.ceil(o/k)+Math.ceil(n/k),B=new a.util.ByteBuffer;for(h=0;h<A;h++){var C=new a.util.ByteBuffer(u.getBytes(k)),D=511;for(i=z.length()-1;i>=0;i--)D>>=8,D+=z.at(i)+C.at(i),C.setAt(i,255&D);B.putBuffer(C)}u=B,l.putBuffer(x)}return l.truncate(l.length()-f),l},e.pbe.getCipher=function(a,b,c){switch(a){case e.oids.pkcs5PBES2:return e.pbe.getCipherForPBES2(a,b,c);case e.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case e.oids["pbewithSHAAnd40BitRC2-CBC"]:return e.pbe.getCipherForPKCS12PBE(a,b,c);default:var d=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw d.oid=a,d.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],d}},e.pbe.getCipherForPBES2=function(b,c,f){var g={},i=[];if(!d.validate(c,h,g,i)){var j=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw j.errors=i,j}if(b=d.derToOid(g.kdfOid),b!==e.oids.pkcs5PBKDF2){var j=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw j.oid=b,j.supportedOids=["pkcs5PBKDF2"],j}if(b=d.derToOid(g.encOid),b!==e.oids["aes128-CBC"]&&b!==e.oids["aes192-CBC"]&&b!==e.oids["aes256-CBC"]&&b!==e.oids["des-EDE3-CBC"]&&b!==e.oids.desCBC){var j=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw j.oid=b,j.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],j}var k=g.kdfSalt,l=a.util.createBuffer(g.kdfIterationCount);l=l.getInt(l.length()<<3);var m,n;switch(e.oids[b]){case"aes128-CBC":m=16,n=a.aes.createDecryptionCipher;break;case"aes192-CBC":m=24,n=a.aes.createDecryptionCipher;break;case"aes256-CBC":m=32,n=a.aes.createDecryptionCipher;break;case"des-EDE3-CBC":m=24,n=a.des.createDecryptionCipher;break;case"desCBC":m=8,n=a.des.createDecryptionCipher}var o=a.pkcs5.pbkdf2(f,k,l,m),p=g.encIv,q=n(o);return q.start(p),q},e.pbe.getCipherForPKCS12PBE=function(b,c,f){var g={},h=[];if(!d.validate(c,i,g,h)){var j=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw j.errors=h,j}var k=a.util.createBuffer(g.salt),l=a.util.createBuffer(g.iterations);l=l.getInt(l.length()<<3);var m,n,o;switch(b){case e.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:m=24,n=8,o=a.des.startDecrypting;break;case e.oids["pbewithSHAAnd40BitRC2-CBC"]:m=5,n=8,o=function(b,c){var d=a.rc2.createDecryptionCipher(b,40);return d.start(c,null),d};break;default:var j=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw j.oid=b,j}var p=e.pbe.generatePkcs12Key(f,k,1,l,m),q=e.pbe.generatePkcs12Key(f,k,2,l,n);return o(p,q)},e.pbe.opensslDeriveBytes=function(c,d,e,f){"undefined"!=typeof f&&null!==f||(f=a.md.md5.create()),null===d&&(d="");for(var g=[b(f,c+d)],h=16,i=1;h<e;++i,h+=16)g.push(b(f,g[i-1]+c+d));return g.join("").substr(0,e)}}var d="pbe";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pbe",["require","module","./aes","./asn1","./des","./md","./oids","./pem","./pbkdf2","./random","./rc2","./rsa","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=a.asn1,c=a.pkcs7asn1=a.pkcs7asn1||{};a.pkcs7=a.pkcs7||{},a.pkcs7.asn1=c;var d={name:"ContentInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:b.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};c.contentInfoValidator=d;var e={name:"EncryptedContentInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:b.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:b.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};c.envelopedDataValidator={name:"EnvelopedData",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:b.Class.UNIVERSAL,type:b.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(e)},c.encryptedDataValidator={name:"EncryptedData",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"version"}].concat(e)};var f={name:"SignerInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.Version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1},{name:"SignerInfo.IssuerAndSerialNumber",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0},{name:"SignerInfo.DigestAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0},{name:"SignerInfo.AuthenticatedAttributes",tagClass:b.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.DigestEncryptionAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0},{name:"SignerInfo.EncryptedDigest",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.UnauthenticatedAttributes",tagClass:b.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0}]};c.signedDataValidator={name:"SignedData",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:b.Class.UNIVERSAL,type:b.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},d,{name:"SignedData.Certificates",tagClass:b.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:b.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:b.Class.UNIVERSAL,type:b.Type.SET,capture:"signerInfos",optional:!0,value:[f]}]},c.recipientInfoValidator={name:"RecipientInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:b.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}}var d="pkcs7asn1";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs7asn1",["require","module","./asn1","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){a.mgf=a.mgf||{};var b=a.mgf.mgf1=a.mgf1=a.mgf1||{};b.create=function(b){var c={generate:function(c,d){for(var e=new a.util.ByteBuffer,f=Math.ceil(d/b.digestLength),g=0;g<f;g++){var h=new a.util.ByteBuffer;h.putInt32(g),b.start(),b.update(c+h.getBytes()),e.putBuffer(b.digest())}return e.truncate(e.length()-d),e.getBytes()}};return c}}var d="mgf1";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/mgf1",["require","module","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){a.mgf=a.mgf||{},a.mgf.mgf1=a.mgf1}var d="mgf";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/mgf",["require","module","./mgf1"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=a.pss=a.pss||{};b.create=function(b){3===arguments.length&&(b={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var c=b.md,d=b.mgf,e=c.digestLength,f=b.salt||null;"string"==typeof f&&(f=a.util.createBuffer(f));var g;if("saltLength"in b)g=b.saltLength;else{if(null===f)throw new Error("Salt length not specified or specific salt not given.");g=f.length()}if(null!==f&&f.length()!==g)throw new Error("Given salt length does not match length of given salt.");var h=b.prng||a.random,i={};return i.encode=function(b,i){var j,k=i-1,l=Math.ceil(k/8),m=b.digest().getBytes();if(l<e+g+2)throw new Error("Message is too long to encrypt.");var n;n=null===f?h.getBytesSync(g):f.bytes();var o=new a.util.ByteBuffer;o.fillWithByte(0,8),o.putBytes(m),o.putBytes(n),c.start(),c.update(o.getBytes());var p=c.digest().getBytes(),q=new a.util.ByteBuffer;q.fillWithByte(0,l-g-e-2),q.putByte(1),q.putBytes(n);var r=q.getBytes(),s=l-e-1,t=d.generate(p,s),u="";for(j=0;j<s;j++)u+=String.fromCharCode(r.charCodeAt(j)^t.charCodeAt(j));var v=65280>>8*l-k&255;return u=String.fromCharCode(u.charCodeAt(0)&~v)+u.substr(1),u+p+String.fromCharCode(188)},i.verify=function(b,f,h){var i,j=h-1,k=Math.ceil(j/8);if(f=f.substr(-k),k<e+g+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==f.charCodeAt(k-1))throw new Error("Encoded message does not end in 0xBC.");var l=k-e-1,m=f.substr(0,l),n=f.substr(l,e),o=65280>>8*k-j&255;if(0!==(m.charCodeAt(0)&o))throw new Error("Bits beyond keysize not zero as expected.");var p=d.generate(n,l),q="";for(i=0;i<l;i++)q+=String.fromCharCode(m.charCodeAt(i)^p.charCodeAt(i));q=String.fromCharCode(q.charCodeAt(0)&~o)+q.substr(1);var r=k-e-g-2;for(i=0;i<r;i++)if(0!==q.charCodeAt(i))throw new Error("Leftmost octets not zero as expected");if(1!==q.charCodeAt(r))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var s=q.substr(-g),t=new a.util.ByteBuffer;t.fillWithByte(0,8),t.putBytes(b),t.putBytes(s),c.start(),c.update(t.getBytes());var u=c.digest().getBytes();return n===u},i}}var d="pss";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pss",["require","module","./random","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(a,b){"string"==typeof b&&(b={shortName:b});for(var c,d=null,e=0;null===d&&e<a.attributes.length;++e)c=a.attributes[e],b.type&&b.type===c.type?d=c:b.name&&b.name===c.name?d=c:b.shortName&&b.shortName===c.shortName&&(d=c);return d}function c(b){for(var c,d,e=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]),f=b.attributes,g=0;g<f.length;++g){c=f[g];var i=c.value,j=h.Type.PRINTABLESTRING;"valueTagClass"in c&&(j=c.valueTagClass,j===h.Type.UTF8&&(i=a.util.encodeUtf8(i))),d=h.create(h.Class.UNIVERSAL,h.Type.SET,!0,[h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(c.type).getBytes()),h.create(h.Class.UNIVERSAL,j,!1,i)])]),e.value.push(d)}return e}function d(a){for(var b,c=0;c<a.length;++c){if(b=a[c],"undefined"==typeof b.name&&(b.type&&b.type in i.oids?b.name=i.oids[b.type]:b.shortName&&b.shortName in k&&(b.name=i.oids[k[b.shortName]])),"undefined"==typeof b.type){if(!(b.name&&b.name in i.oids)){var d=new Error("Attribute type not specified.");throw d.attribute=b,d}b.type=i.oids[b.name]}if("undefined"==typeof b.shortName&&b.name&&b.name in k&&(b.shortName=k[b.name]),b.type===j.extensionRequest&&(b.valueConstructed=!0,b.valueTagClass=h.Type.SEQUENCE,!b.value&&b.extensions)){b.value=[];for(var f=0;f<b.extensions.length;++f)b.value.push(i.certificateExtensionToAsn1(e(b.extensions[f])))}if("undefined"==typeof b.value){var d=new Error("Attribute value not specified.");throw d.attribute=b,d}}}function e(b,c){if(c=c||{},"undefined"==typeof b.name&&b.id&&b.id in i.oids&&(b.name=i.oids[b.id]),"undefined"==typeof b.id){if(!(b.name&&b.name in i.oids)){var d=new Error("Extension ID not specified.");throw d.extension=b,d}b.id=i.oids[b.name]}if("undefined"==typeof b.value){if("keyUsage"===b.name){var e=0,f=0,g=0;b.digitalSignature&&(f|=128,e=7),b.nonRepudiation&&(f|=64,e=6),b.keyEncipherment&&(f|=32,e=5),b.dataEncipherment&&(f|=16,e=4),b.keyAgreement&&(f|=8,e=3),b.keyCertSign&&(f|=4,e=2),b.cRLSign&&(f|=2,e=1),b.encipherOnly&&(f|=1,e=0),b.decipherOnly&&(g|=128,e=7);var k=String.fromCharCode(e);0!==g?k+=String.fromCharCode(f)+String.fromCharCode(g):0!==f&&(k+=String.fromCharCode(f)),b.value=h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,k)}else if("basicConstraints"===b.name)b.value=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]),b.cA&&b.value.value.push(h.create(h.Class.UNIVERSAL,h.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in b&&b.value.value.push(h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(b.pathLenConstraint).getBytes()));else if("extKeyUsage"===b.name){b.value=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]);var l=b.value.value;for(var m in b)b[m]===!0&&(m in j?l.push(h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(j[m]).getBytes())):m.indexOf(".")!==-1&&l.push(h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(m).getBytes())))}else if("nsCertType"===b.name){var e=0,f=0;b.client&&(f|=128,e=7),b.server&&(f|=64,e=6),b.email&&(f|=32,e=5),b.objsign&&(f|=16,e=4),b.reserved&&(f|=8,e=3),b.sslCA&&(f|=4,e=2),b.emailCA&&(f|=2,e=1),b.objCA&&(f|=1,e=0);var k=String.fromCharCode(e);0!==f&&(k+=String.fromCharCode(f)),b.value=h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,k)}else if("subjectAltName"===b.name||"issuerAltName"===b.name){b.value=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]);for(var n,o=0;o<b.altNames.length;++o){n=b.altNames[o];var k=n.value;if(7===n.type&&n.ip){if(k=a.util.bytesFromIP(n.ip),null===k){var d=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw d.extension=b,d}}else 8===n.type&&(k=n.oid?h.oidToDer(h.oidToDer(n.oid)):h.oidToDer(k));b.value.value.push(h.create(h.Class.CONTEXT_SPECIFIC,n.type,!1,k))}}else if("subjectKeyIdentifier"===b.name&&c.cert){var p=c.cert.generateSubjectKeyIdentifier();b.subjectKeyIdentifier=p.toHex(),b.value=h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,p.getBytes())}if("undefined"==typeof b.value){var d=new Error("Extension value not specified.");throw d.extension=b,d}return b}}function f(a,b){switch(a){case j["RSASSA-PSS"]:var c=[];return void 0!==b.hash.algorithmOid&&c.push(h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(b.hash.algorithmOid).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")])])),void 0!==b.mgf.algorithmOid&&c.push(h.create(h.Class.CONTEXT_SPECIFIC,1,!0,[h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(b.mgf.algorithmOid).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(b.mgf.hash.algorithmOid).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")])])])),void 0!==b.saltLength&&c.push(h.create(h.Class.CONTEXT_SPECIFIC,2,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(b.saltLength).getBytes())])),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,c);default:return h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")}}function g(b){var c=h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===b.attributes.length)return c;for(var d=b.attributes,e=0;e<d.length;++e){var f=d[e],g=f.value,i=h.Type.UTF8;"valueTagClass"in f&&(i=f.valueTagClass),i===h.Type.UTF8&&(g=a.util.encodeUtf8(g));var j=!1;"valueConstructed"in f&&(j=f.valueConstructed);var k=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(f.type).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SET,!0,[h.create(h.Class.UNIVERSAL,i,j,g)])]);c.value.push(k)}return c}var h=a.asn1,i=a.pki=a.pki||{},j=i.oids,k={};k.CN=j.commonName,k.commonName="CN",k.C=j.countryName,k.countryName="C",k.L=j.localityName,k.localityName="L",k.ST=j.stateOrProvinceName,k.stateOrProvinceName="ST",k.O=j.organizationName,k.organizationName="O",k.OU=j.organizationalUnitName,k.organizationalUnitName="OU",k.E=j.emailAddress,k.emailAddress="E";var l=a.pki.rsa.publicKeyValidator,m={name:"Certificate",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:h.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:h.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:h.Class.UNIVERSAL,type:h.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:h.Class.UNIVERSAL,type:h.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:h.Class.UNIVERSAL,type:h.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:h.Class.UNIVERSAL,type:h.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},l,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:h.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:h.Class.UNIVERSAL,type:h.Type.BITSTRING,constructed:!1,capture:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:h.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:h.Class.UNIVERSAL,type:h.Type.BITSTRING,constructed:!1,capture:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:h.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",
tagClass:h.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:h.Class.UNIVERSAL,type:h.Type.BITSTRING,constructed:!1,capture:"certSignature"}]},n={name:"rsapss",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:h.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:h.Class.UNIVERSAL,type:h.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:h.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:h.Class.UNIVERSAL,type:h.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:h.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:h.Class.UNIVERSAL,type:h.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:h.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:h.Class.UNIVERSAL,type:h.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},o={name:"CertificationRequestInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},l,{name:"CertificationRequestInfo.attributes",tagClass:h.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:h.Class.UNIVERSAL,type:h.Type.SET,constructed:!0}]}]}]},p={name:"CertificationRequest",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[o,{name:"CertificationRequest.signatureAlgorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:h.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:h.Class.UNIVERSAL,type:h.Type.BITSTRING,constructed:!1,capture:"csrSignature"}]};i.RDNAttributesAsArray=function(a,b){for(var c,d,e,f=[],g=0;g<a.value.length;++g){c=a.value[g];for(var i=0;i<c.value.length;++i)e={},d=c.value[i],e.type=h.derToOid(d.value[0].value),e.value=d.value[1].value,e.valueTagClass=d.value[1].type,e.type in j&&(e.name=j[e.type],e.name in k&&(e.shortName=k[e.name])),b&&(b.update(e.type),b.update(e.value)),f.push(e)}return f},i.CRIAttributesAsArray=function(a){for(var b=[],c=0;c<a.length;++c)for(var d=a[c],e=h.derToOid(d.value[0].value),f=d.value[1].value,g=0;g<f.length;++g){var l={};if(l.type=e,l.value=f[g].value,l.valueTagClass=f[g].type,l.type in j&&(l.name=j[l.type],l.name in k&&(l.shortName=k[l.name])),l.type===j.extensionRequest){l.extensions=[];for(var m=0;m<l.value.length;++m)l.extensions.push(i.certificateExtensionFromAsn1(l.value[m]))}b.push(l)}return b};var q=function(a,b,c){var d={};if(a!==j["RSASSA-PSS"])return d;c&&(d={hash:{algorithmOid:j.sha1},mgf:{algorithmOid:j.mgf1,hash:{algorithmOid:j.sha1}},saltLength:20});var e={},f=[];if(!h.validate(b,n,e,f)){var g=new Error("Cannot read RSASSA-PSS parameter block.");throw g.errors=f,g}return void 0!==e.hashOid&&(d.hash=d.hash||{},d.hash.algorithmOid=h.derToOid(e.hashOid)),void 0!==e.maskGenOid&&(d.mgf=d.mgf||{},d.mgf.algorithmOid=h.derToOid(e.maskGenOid),d.mgf.hash=d.mgf.hash||{},d.mgf.hash.algorithmOid=h.derToOid(e.maskGenHashOid)),void 0!==e.saltLength&&(d.saltLength=e.saltLength.charCodeAt(0)),d};i.certificateFromPem=function(b,c,d){var e=a.pem.decode(b)[0];if("CERTIFICATE"!==e.type&&"X509 CERTIFICATE"!==e.type&&"TRUSTED CERTIFICATE"!==e.type){var f=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw f.headerType=e.type,f}if(e.procType&&"ENCRYPTED"===e.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var g=h.fromDer(e.body,d);return i.certificateFromAsn1(g,c)},i.certificateToPem=function(b,c){var d={type:"CERTIFICATE",body:h.toDer(i.certificateToAsn1(b)).getBytes()};return a.pem.encode(d,{maxline:c})},i.publicKeyFromPem=function(b){var c=a.pem.decode(b)[0];if("PUBLIC KEY"!==c.type&&"RSA PUBLIC KEY"!==c.type){var d=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw d.headerType=c.type,d}if(c.procType&&"ENCRYPTED"===c.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var e=h.fromDer(c.body);return i.publicKeyFromAsn1(e)},i.publicKeyToPem=function(b,c){var d={type:"PUBLIC KEY",body:h.toDer(i.publicKeyToAsn1(b)).getBytes()};return a.pem.encode(d,{maxline:c})},i.publicKeyToRSAPublicKeyPem=function(b,c){var d={type:"RSA PUBLIC KEY",body:h.toDer(i.publicKeyToRSAPublicKey(b)).getBytes()};return a.pem.encode(d,{maxline:c})},i.getPublicKeyFingerprint=function(b,c){c=c||{};var d,e=c.md||a.md.sha1.create(),f=c.type||"RSAPublicKey";switch(f){case"RSAPublicKey":d=h.toDer(i.publicKeyToRSAPublicKey(b)).getBytes();break;case"SubjectPublicKeyInfo":d=h.toDer(i.publicKeyToAsn1(b)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+c.type+'".')}e.start(),e.update(d);var g=e.digest();if("hex"===c.encoding){var j=g.toHex();return c.delimiter?j.match(/.{2}/g).join(c.delimiter):j}if("binary"===c.encoding)return g.getBytes();if(c.encoding)throw new Error('Unknown encoding "'+c.encoding+'".');return g},i.certificationRequestFromPem=function(b,c,d){var e=a.pem.decode(b)[0];if("CERTIFICATE REQUEST"!==e.type){var f=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw f.headerType=e.type,f}if(e.procType&&"ENCRYPTED"===e.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var g=h.fromDer(e.body,d);return i.certificationRequestFromAsn1(g,c)},i.certificationRequestToPem=function(b,c){var d={type:"CERTIFICATE REQUEST",body:h.toDer(i.certificationRequestToAsn1(b)).getBytes()};return a.pem.encode(d,{maxline:c})},i.createCertificate=function(){var c={};return c.version=2,c.serialNumber="00",c.signatureOid=null,c.signature=null,c.siginfo={},c.siginfo.algorithmOid=null,c.validity={},c.validity.notBefore=new Date,c.validity.notAfter=new Date,c.issuer={},c.issuer.getField=function(a){return b(c.issuer,a)},c.issuer.addField=function(a){d([a]),c.issuer.attributes.push(a)},c.issuer.attributes=[],c.issuer.hash=null,c.subject={},c.subject.getField=function(a){return b(c.subject,a)},c.subject.addField=function(a){d([a]),c.subject.attributes.push(a)},c.subject.attributes=[],c.subject.hash=null,c.extensions=[],c.publicKey=null,c.md=null,c.setSubject=function(a,b){d(a),c.subject.attributes=a,delete c.subject.uniqueId,b&&(c.subject.uniqueId=b),c.subject.hash=null},c.setIssuer=function(a,b){d(a),c.issuer.attributes=a,delete c.issuer.uniqueId,b&&(c.issuer.uniqueId=b),c.issuer.hash=null},c.setExtensions=function(a){for(var b=0;b<a.length;++b)e(a[b],{cert:c});c.extensions=a},c.getExtension=function(a){"string"==typeof a&&(a={name:a});for(var b,d=null,e=0;null===d&&e<c.extensions.length;++e)b=c.extensions[e],a.id&&b.id===a.id?d=b:a.name&&b.name===a.name&&(d=b);return d},c.sign=function(b,d){c.md=d||a.md.sha1.create();var e=j[c.md.algorithm+"WithRSAEncryption"];if(!e){var f=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw f.algorithm=c.md.algorithm,f}c.signatureOid=c.siginfo.algorithmOid=e,c.tbsCertificate=i.getTBSCertificate(c);var g=h.toDer(c.tbsCertificate);c.md.update(g.getBytes()),c.signature=b.sign(c.md)},c.verify=function(b){var d=!1;if(!c.issued(b)){var e=b.issuer,f=c.subject,g=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw g.expectedIssuer=e.attributes,g.actualIssuer=f.attributes,g}var k=b.md;if(null===k){if(b.signatureOid in j){var l=j[b.signatureOid];switch(l){case"sha1WithRSAEncryption":k=a.md.sha1.create();break;case"md5WithRSAEncryption":k=a.md.md5.create();break;case"sha256WithRSAEncryption":k=a.md.sha256.create();break;case"RSASSA-PSS":k=a.md.sha256.create()}}if(null===k){var g=new Error("Could not compute certificate digest. Unknown signature OID.");throw g.signatureOid=b.signatureOid,g}var m=b.tbsCertificate||i.getTBSCertificate(b),n=h.toDer(m);k.update(n.getBytes())}if(null!==k){var o;switch(b.signatureOid){case j.sha1WithRSAEncryption:o=void 0;break;case j["RSASSA-PSS"]:var p,q;if(p=j[b.signatureParameters.mgf.hash.algorithmOid],void 0===p||void 0===a.md[p]){var g=new Error("Unsupported MGF hash function.");throw g.oid=b.signatureParameters.mgf.hash.algorithmOid,g.name=p,g}if(q=j[b.signatureParameters.mgf.algorithmOid],void 0===q||void 0===a.mgf[q]){var g=new Error("Unsupported MGF function.");throw g.oid=b.signatureParameters.mgf.algorithmOid,g.name=q,g}if(q=a.mgf[q].create(a.md[p].create()),p=j[b.signatureParameters.hash.algorithmOid],void 0===p||void 0===a.md[p])throw{message:"Unsupported RSASSA-PSS hash function.",oid:b.signatureParameters.hash.algorithmOid,name:p};o=a.pss.create(a.md[p].create(),q,b.signatureParameters.saltLength)}d=c.publicKey.verify(k.digest().getBytes(),b.signature,o)}return d},c.isIssuer=function(a){var b=!1,d=c.issuer,e=a.subject;if(d.hash&&e.hash)b=d.hash===e.hash;else if(d.attributes.length===e.attributes.length){b=!0;for(var f,g,h=0;b&&h<d.attributes.length;++h)f=d.attributes[h],g=e.attributes[h],f.type===g.type&&f.value===g.value||(b=!1)}return b},c.issued=function(a){return a.isIssuer(c)},c.generateSubjectKeyIdentifier=function(){return i.getPublicKeyFingerprint(c.publicKey,{type:"RSAPublicKey"})},c.verifySubjectKeyIdentifier=function(){for(var b=j.subjectKeyIdentifier,d=0;d<c.extensions.length;++d){var e=c.extensions[d];if(e.id===b){var f=c.generateSubjectKeyIdentifier().getBytes();return a.util.hexToBytes(e.subjectKeyIdentifier)===f}}return!1},c},i.certificateFromAsn1=function(c,e){var f={},g=[];if(!h.validate(c,m,f,g)){var k=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw k.errors=g,k}if("string"!=typeof f.certSignature){for(var l="\0",n=0;n<f.certSignature.length;++n)l+=h.toDer(f.certSignature[n]).getBytes();f.certSignature=l}var o=h.derToOid(f.publicKeyOid);if(o!==i.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var p=i.createCertificate();p.version=f.certVersion?f.certVersion.charCodeAt(0):0;var r=a.util.createBuffer(f.certSerialNumber);p.serialNumber=r.toHex(),p.signatureOid=a.asn1.derToOid(f.certSignatureOid),p.signatureParameters=q(p.signatureOid,f.certSignatureParams,!0),p.siginfo.algorithmOid=a.asn1.derToOid(f.certinfoSignatureOid),p.siginfo.parameters=q(p.siginfo.algorithmOid,f.certinfoSignatureParams,!1);var s=a.util.createBuffer(f.certSignature);++s.read,p.signature=s.getBytes();var t=[];if(void 0!==f.certValidity1UTCTime&&t.push(h.utcTimeToDate(f.certValidity1UTCTime)),void 0!==f.certValidity2GeneralizedTime&&t.push(h.generalizedTimeToDate(f.certValidity2GeneralizedTime)),void 0!==f.certValidity3UTCTime&&t.push(h.utcTimeToDate(f.certValidity3UTCTime)),void 0!==f.certValidity4GeneralizedTime&&t.push(h.generalizedTimeToDate(f.certValidity4GeneralizedTime)),t.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(t.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(p.validity.notBefore=t[0],p.validity.notAfter=t[1],p.tbsCertificate=f.tbsCertificate,e){if(p.md=null,p.signatureOid in j){var o=j[p.signatureOid];switch(o){case"sha1WithRSAEncryption":p.md=a.md.sha1.create();break;case"md5WithRSAEncryption":p.md=a.md.md5.create();break;case"sha256WithRSAEncryption":p.md=a.md.sha256.create();break;case"RSASSA-PSS":p.md=a.md.sha256.create()}}if(null===p.md){var k=new Error("Could not compute certificate digest. Unknown signature OID.");throw k.signatureOid=p.signatureOid,k}var u=h.toDer(p.tbsCertificate);p.md.update(u.getBytes())}var v=a.md.sha1.create();p.issuer.getField=function(a){return b(p.issuer,a)},p.issuer.addField=function(a){d([a]),p.issuer.attributes.push(a)},p.issuer.attributes=i.RDNAttributesAsArray(f.certIssuer,v),f.certIssuerUniqueId&&(p.issuer.uniqueId=f.certIssuerUniqueId),p.issuer.hash=v.digest().toHex();var w=a.md.sha1.create();return p.subject.getField=function(a){return b(p.subject,a)},p.subject.addField=function(a){d([a]),p.subject.attributes.push(a)},p.subject.attributes=i.RDNAttributesAsArray(f.certSubject,w),f.certSubjectUniqueId&&(p.subject.uniqueId=f.certSubjectUniqueId),p.subject.hash=w.digest().toHex(),f.certExtensions?p.extensions=i.certificateExtensionsFromAsn1(f.certExtensions):p.extensions=[],p.publicKey=i.publicKeyFromAsn1(f.subjectPublicKeyInfo),p},i.certificateExtensionsFromAsn1=function(a){for(var b=[],c=0;c<a.value.length;++c)for(var d=a.value[c],e=0;e<d.value.length;++e)b.push(i.certificateExtensionFromAsn1(d.value[e]));return b},i.certificateExtensionFromAsn1=function(b){var c={};if(c.id=h.derToOid(b.value[0].value),c.critical=!1,b.value[1].type===h.Type.BOOLEAN?(c.critical=0!==b.value[1].value.charCodeAt(0),c.value=b.value[2].value):c.value=b.value[1].value,c.id in j)if(c.name=j[c.id],"keyUsage"===c.name){var d=h.fromDer(c.value),e=0,f=0;d.value.length>1&&(e=d.value.charCodeAt(1),f=d.value.length>2?d.value.charCodeAt(2):0),c.digitalSignature=128===(128&e),c.nonRepudiation=64===(64&e),c.keyEncipherment=32===(32&e),c.dataEncipherment=16===(16&e),c.keyAgreement=8===(8&e),c.keyCertSign=4===(4&e),c.cRLSign=2===(2&e),c.encipherOnly=1===(1&e),c.decipherOnly=128===(128&f)}else if("basicConstraints"===c.name){var d=h.fromDer(c.value);d.value.length>0&&d.value[0].type===h.Type.BOOLEAN?c.cA=0!==d.value[0].value.charCodeAt(0):c.cA=!1;var g=null;d.value.length>0&&d.value[0].type===h.Type.INTEGER?g=d.value[0].value:d.value.length>1&&(g=d.value[1].value),null!==g&&(c.pathLenConstraint=h.derToInteger(g))}else if("extKeyUsage"===c.name)for(var d=h.fromDer(c.value),i=0;i<d.value.length;++i){var k=h.derToOid(d.value[i].value);k in j?c[j[k]]=!0:c[k]=!0}else if("nsCertType"===c.name){var d=h.fromDer(c.value),e=0;d.value.length>1&&(e=d.value.charCodeAt(1)),c.client=128===(128&e),c.server=64===(64&e),c.email=32===(32&e),c.objsign=16===(16&e),c.reserved=8===(8&e),c.sslCA=4===(4&e),c.emailCA=2===(2&e),c.objCA=1===(1&e)}else if("subjectAltName"===c.name||"issuerAltName"===c.name){c.altNames=[];for(var l,d=h.fromDer(c.value),m=0;m<d.value.length;++m){l=d.value[m];var n={type:l.type,value:l.value};switch(c.altNames.push(n),l.type){case 1:case 2:case 6:break;case 7:n.ip=a.util.bytesToIP(l.value);break;case 8:n.oid=h.derToOid(l.value)}}}else if("subjectKeyIdentifier"===c.name){var d=h.fromDer(c.value);c.subjectKeyIdentifier=a.util.bytesToHex(d.value)}return c},i.certificationRequestFromAsn1=function(c,e){var f={},g=[];if(!h.validate(c,p,f,g)){var k=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw k.errors=g,k}if("string"!=typeof f.csrSignature){for(var l="\0",m=0;m<f.csrSignature.length;++m)l+=h.toDer(f.csrSignature[m]).getBytes();f.csrSignature=l}var n=h.derToOid(f.publicKeyOid);if(n!==i.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=i.createCertificationRequest();o.version=f.csrVersion?f.csrVersion.charCodeAt(0):0,o.signatureOid=a.asn1.derToOid(f.csrSignatureOid),o.signatureParameters=q(o.signatureOid,f.csrSignatureParams,!0),o.siginfo.algorithmOid=a.asn1.derToOid(f.csrSignatureOid),o.siginfo.parameters=q(o.siginfo.algorithmOid,f.csrSignatureParams,!1);var r=a.util.createBuffer(f.csrSignature);if(++r.read,o.signature=r.getBytes(),o.certificationRequestInfo=f.certificationRequestInfo,e){if(o.md=null,o.signatureOid in j){var n=j[o.signatureOid];switch(n){case"sha1WithRSAEncryption":o.md=a.md.sha1.create();break;case"md5WithRSAEncryption":o.md=a.md.md5.create();break;case"sha256WithRSAEncryption":o.md=a.md.sha256.create();break;case"RSASSA-PSS":o.md=a.md.sha256.create()}}if(null===o.md){var k=new Error("Could not compute certification request digest. Unknown signature OID.");throw k.signatureOid=o.signatureOid,k}var s=h.toDer(o.certificationRequestInfo);o.md.update(s.getBytes())}var t=a.md.sha1.create();return o.subject.getField=function(a){return b(o.subject,a)},o.subject.addField=function(a){d([a]),o.subject.attributes.push(a)},o.subject.attributes=i.RDNAttributesAsArray(f.certificationRequestInfoSubject,t),o.subject.hash=t.digest().toHex(),o.publicKey=i.publicKeyFromAsn1(f.subjectPublicKeyInfo),o.getAttribute=function(a){return b(o,a)},o.addAttribute=function(a){d([a]),o.attributes.push(a)},o.attributes=i.CRIAttributesAsArray(f.certificationRequestInfoAttributes||[]),o},i.createCertificationRequest=function(){var c={};return c.version=0,c.signatureOid=null,c.signature=null,c.siginfo={},c.siginfo.algorithmOid=null,c.subject={},c.subject.getField=function(a){return b(c.subject,a)},c.subject.addField=function(a){d([a]),c.subject.attributes.push(a)},c.subject.attributes=[],c.subject.hash=null,c.publicKey=null,c.attributes=[],c.getAttribute=function(a){return b(c,a)},c.addAttribute=function(a){d([a]),c.attributes.push(a)},c.md=null,c.setSubject=function(a){d(a),c.subject.attributes=a,c.subject.hash=null},c.setAttributes=function(a){d(a),c.attributes=a},c.sign=function(b,d){c.md=d||a.md.sha1.create();var e=j[c.md.algorithm+"WithRSAEncryption"];if(!e){var f=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw f.algorithm=c.md.algorithm,f}c.signatureOid=c.siginfo.algorithmOid=e,c.certificationRequestInfo=i.getCertificationRequestInfo(c);var g=h.toDer(c.certificationRequestInfo);c.md.update(g.getBytes()),c.signature=b.sign(c.md)},c.verify=function(){var b=!1,d=c.md;if(null===d){if(c.signatureOid in j){var e=j[c.signatureOid];switch(e){case"sha1WithRSAEncryption":d=a.md.sha1.create();break;case"md5WithRSAEncryption":d=a.md.md5.create();break;case"sha256WithRSAEncryption":d=a.md.sha256.create();break;case"RSASSA-PSS":d=a.md.sha256.create()}}if(null===d){var f=new Error("Could not compute certification request digest. Unknown signature OID.");throw f.signatureOid=c.signatureOid,f}var g=c.certificationRequestInfo||i.getCertificationRequestInfo(c),k=h.toDer(g);d.update(k.getBytes())}if(null!==d){var l;switch(c.signatureOid){case j.sha1WithRSAEncryption:break;case j["RSASSA-PSS"]:var m,n;if(m=j[c.signatureParameters.mgf.hash.algorithmOid],void 0===m||void 0===a.md[m]){var f=new Error("Unsupported MGF hash function.");throw f.oid=c.signatureParameters.mgf.hash.algorithmOid,f.name=m,f}if(n=j[c.signatureParameters.mgf.algorithmOid],void 0===n||void 0===a.mgf[n]){var f=new Error("Unsupported MGF function.");throw f.oid=c.signatureParameters.mgf.algorithmOid,f.name=n,f}if(n=a.mgf[n].create(a.md[m].create()),m=j[c.signatureParameters.hash.algorithmOid],void 0===m||void 0===a.md[m]){var f=new Error("Unsupported RSASSA-PSS hash function.");throw f.oid=c.signatureParameters.hash.algorithmOid,f.name=m,f}l=a.pss.create(a.md[m].create(),n,c.signatureParameters.saltLength)}b=c.publicKey.verify(d.digest().getBytes(),c.signature,l)}return b},c},i.getTBSCertificate=function(b){var d=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(b.version).getBytes())]),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,a.util.hexToBytes(b.serialNumber)),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(b.siginfo.algorithmOid).getBytes()),f(b.siginfo.algorithmOid,b.siginfo.parameters)]),c(b.issuer),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.UTCTIME,!1,h.dateToUtcTime(b.validity.notBefore)),h.create(h.Class.UNIVERSAL,h.Type.UTCTIME,!1,h.dateToUtcTime(b.validity.notAfter))]),c(b.subject),i.publicKeyToAsn1(b.publicKey)]);return b.issuer.uniqueId&&d.value.push(h.create(h.Class.CONTEXT_SPECIFIC,1,!0,[h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,String.fromCharCode(0)+b.issuer.uniqueId)])),b.subject.uniqueId&&d.value.push(h.create(h.Class.CONTEXT_SPECIFIC,2,!0,[h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,String.fromCharCode(0)+b.subject.uniqueId)])),b.extensions.length>0&&d.value.push(i.certificateExtensionsToAsn1(b.extensions)),d},i.getCertificationRequestInfo=function(a){var b=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(a.version).getBytes()),c(a.subject),i.publicKeyToAsn1(a.publicKey),g(a)]);return b},i.distinguishedNameToAsn1=function(a){return c(a)},i.certificateToAsn1=function(a){var b=a.tbsCertificate||i.getTBSCertificate(a);return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[b,h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(a.signatureOid).getBytes()),f(a.signatureOid,a.signatureParameters)]),h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,String.fromCharCode(0)+a.signature)])},i.certificateExtensionsToAsn1=function(a){var b=h.create(h.Class.CONTEXT_SPECIFIC,3,!0,[]),c=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]);b.value.push(c);for(var d=0;d<a.length;++d)c.value.push(i.certificateExtensionToAsn1(a[d]));return b},i.certificateExtensionToAsn1=function(a){var b=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[]);b.value.push(h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(a.id).getBytes())),a.critical&&b.value.push(h.create(h.Class.UNIVERSAL,h.Type.BOOLEAN,!1,String.fromCharCode(255)));var c=a.value;return"string"!=typeof a.value&&(c=h.toDer(c).getBytes()),b.value.push(h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,c)),b},i.certificationRequestToAsn1=function(a){var b=a.certificationRequestInfo||i.getCertificationRequestInfo(a);return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[b,h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(a.signatureOid).getBytes()),f(a.signatureOid,a.signatureParameters)]),h.create(h.Class.UNIVERSAL,h.Type.BITSTRING,!1,String.fromCharCode(0)+a.signature)])},i.createCaStore=function(b){function d(b){if(!b.hash){var d=a.md.sha1.create();b.attributes=i.RDNAttributesAsArray(c(b),d),b.hash=d.digest().toHex()}return e.certs[b.hash]||null}var e={certs:{}};if(e.getIssuer=function(a){var b=d(a.issuer);return b},e.addCertificate=function(b){if("string"==typeof b&&(b=a.pki.certificateFromPem(b)),!b.subject.hash){var d=a.md.sha1.create();b.subject.attributes=i.RDNAttributesAsArray(c(b.subject),d),b.subject.hash=d.digest().toHex()}if(b.subject.hash in e.certs){var f=e.certs[b.subject.hash];a.util.isArray(f)||(f=[f]),f.push(b)}else e.certs[b.subject.hash]=b},e.hasCertificate=function(b){var c=d(b.subject);if(!c)return!1;a.util.isArray(c)||(c=[c]);for(var e=h.toDer(i.certificateToAsn1(b)).getBytes(),f=0;f<c.length;++f){var g=h.toDer(i.certificateToAsn1(c[f])).getBytes();if(e===g)return!0}return!1},b)for(var f=0;f<b.length;++f){var g=b[f];e.addCertificate(g)}return e},i.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},i.verifyCertificateChain=function(b,c,d){c=c.slice(0);var e=c.slice(0),f=new Date,g=!0,h=null,j=0;do{var k=c.shift(),l=null,m=!1;if((f<k.validity.notBefore||f>k.validity.notAfter)&&(h={message:"Certificate is not valid yet or has expired.",error:i.certificateError.certificate_expired,notBefore:k.validity.notBefore,notAfter:k.validity.notAfter,now:f}),null===h){if(l=c[0]||b.getIssuer(k),null===l&&k.isIssuer(k)&&(m=!0,l=k),l){var n=l;a.util.isArray(n)||(n=[n]);for(var o=!1;!o&&n.length>0;){l=n.shift();try{o=l.verify(k)}catch(a){}}o||(h={message:"Certificate signature is invalid.",error:i.certificateError.bad_certificate})}null!==h||l&&!m||b.hasCertificate(k)||(h={message:"Certificate is not trusted.",error:i.certificateError.unknown_ca})}if(null===h&&l&&!k.isIssuer(l)&&(h={message:"Certificate issuer is invalid.",error:i.certificateError.bad_certificate}),null===h)for(var p={keyUsage:!0,basicConstraints:!0},q=0;null===h&&q<k.extensions.length;++q){var r=k.extensions[q];!r.critical||r.name in p||(h={message:"Certificate has an unsupported critical extension.",error:i.certificateError.unsupported_certificate})}if(null===h&&(!g||0===c.length&&(!l||m))){var s=k.getExtension("basicConstraints"),t=k.getExtension("keyUsage");if(null!==t&&(t.keyCertSign&&null!==s||(h={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:i.certificateError.bad_certificate})),null!==h||null===s||s.cA||(h={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:i.certificateError.bad_certificate}),null===h&&null!==t&&"pathLenConstraint"in s){var u=j-1;u>s.pathLenConstraint&&(h={message:"Certificate basicConstraints pathLenConstraint violated.",error:i.certificateError.bad_certificate})}}var v=null===h||h.error,w=d?d(v,j,e):v;if(w!==!0)throw v===!0&&(h={message:"The application rejected the certificate.",error:i.certificateError.bad_certificate}),(w||0===w)&&("object"!=typeof w||a.util.isArray(w)?"string"==typeof w&&(h.error=w):(w.message&&(h.message=w.message),w.error&&(h.error=w.error))),h;h=null,g=!1,++j}while(c.length>0);return!0}}var d="x509";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c.pki}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/x509",["require","module","./aes","./asn1","./des","./md","./mgf","./oids","./pem","./pss","./rsa","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(a,b,c,d){for(var e=[],f=0;f<a.length;f++)for(var g=0;g<a[f].safeBags.length;g++){var h=a[f].safeBags[g];void 0!==d&&h.type!==d||(null!==b?void 0!==h.attributes[b]&&h.attributes[b].indexOf(c)>=0&&e.push(h):e.push(h))}return e}function c(b){if(b.composed||b.constructed){for(var c=a.util.createBuffer(),d=0;d<b.value.length;++d)c.putBytes(b.value[d].value);b.composed=b.constructed=!1,b.value=c.getBytes()}return b}function d(a,b,d,g){if(b=h.fromDer(b,d),b.tagClass!==h.Class.UNIVERSAL||b.type!==h.Type.SEQUENCE||b.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var j=0;j<b.value.length;j++){var l=b.value[j],m={},n=[];if(!h.validate(l,k,m,n)){var o=new Error("Cannot read ContentInfo.");throw o.errors=n,o}var p={encrypted:!1},q=null,r=m.content.value[0];switch(h.derToOid(m.contentType)){case i.oids.data:if(r.tagClass!==h.Class.UNIVERSAL||r.type!==h.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");q=c(r).value;break;case i.oids.encryptedData:q=e(r,g),p.encrypted=!0;break;default:var o=new Error("Unsupported PKCS#12 contentType.");throw o.contentType=h.derToOid(m.contentType),o}p.safeBags=f(q,d,g),a.safeContents.push(p)}}function e(b,d){var e={},f=[];if(!h.validate(b,a.pkcs7.asn1.encryptedDataValidator,e,f)){var g=new Error("Cannot read EncryptedContentInfo.");throw g.errors=f,g}var j=h.derToOid(e.contentType);if(j!==i.oids.data){var g=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw g.oid=j,g}j=h.derToOid(e.encAlgorithm);var k=i.pbe.getCipher(j,e.encParameter,d),l=c(e.encryptedContentAsn1),m=a.util.createBuffer(l.value);if(k.update(m),!k.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return k.output.getBytes()}function f(a,b,c){if(!b&&0===a.length)return[];if(a=h.fromDer(a,b),a.tagClass!==h.Class.UNIVERSAL||a.type!==h.Type.SEQUENCE||a.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var d=[],e=0;e<a.value.length;e++){var f=a.value[e],j={},k=[];if(!h.validate(f,m,j,k)){var l=new Error("Cannot read SafeBag.");throw l.errors=k,l}var n={type:h.derToOid(j.bagId),attributes:g(j.bagAttributes)};d.push(n);var p,q,r=j.bagValue.value[0];switch(n.type){case i.oids.pkcs8ShroudedKeyBag:if(r=i.decryptPrivateKeyInfo(r,c),null===r)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case i.oids.keyBag:try{n.key=i.privateKeyFromAsn1(r)}catch(a){n.key=null,n.asn1=r}continue;case i.oids.certBag:p=o,q=function(){if(h.derToOid(j.certId)!==i.oids.x509Certificate){var a=new Error("Unsupported certificate type, only X.509 supported.");throw a.oid=h.derToOid(j.certId),a}var c=h.fromDer(j.cert,b);try{n.cert=i.certificateFromAsn1(c,!0)}catch(a){n.cert=null,n.asn1=c}};break;default:var l=new Error("Unsupported PKCS#12 SafeBag type.");throw l.oid=n.type,l}if(void 0!==p&&!h.validate(r,p,j,k)){var l=new Error("Cannot read PKCS#12 "+p.name);throw l.errors=k,l}q()}return d}function g(a){var b={};if(void 0!==a)for(var c=0;c<a.length;++c){var d={},e=[];if(!h.validate(a[c],n,d,e)){var f=new Error("Cannot read PKCS#12 BagAttribute.");throw f.errors=e,f}var g=h.derToOid(d.oid);if(void 0!==i.oids[g]){b[i.oids[g]]=[];for(var j=0;j<d.values.length;++j)b[i.oids[g]].push(d.values[j].value)}}return b}var h=a.asn1,i=a.pki,j=a.pkcs12=a.pkcs12||{},k={name:"ContentInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:h.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},l={name:"PFX",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"version"},k,{name:"PFX.macData",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",
tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:h.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:h.Class.UNIVERSAL,type:h.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:h.Class.UNIVERSAL,type:h.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},m={name:"SafeBag",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:h.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:h.Class.UNIVERSAL,type:h.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},n={name:"Attribute",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:h.Class.UNIVERSAL,type:h.Type.SET,constructed:!0,capture:"values"}]},o={name:"CertBag",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:h.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:h.Class.UNIVERSAL,type:h.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};j.pkcs12FromAsn1=function(e,f,g){"string"==typeof f?(g=f,f=!0):void 0===f&&(f=!0);var k={},m=[];if(!h.validate(e,l,k,m)){var n=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw n.errors=n,n}var o={version:k.version.charCodeAt(0),safeContents:[],getBags:function(c){var d,e={};return"localKeyId"in c?d=c.localKeyId:"localKeyIdHex"in c&&(d=a.util.hexToBytes(c.localKeyIdHex)),void 0===d&&!("friendlyName"in c)&&"bagType"in c&&(e[c.bagType]=b(o.safeContents,null,null,c.bagType)),void 0!==d&&(e.localKeyId=b(o.safeContents,"localKeyId",d,c.bagType)),"friendlyName"in c&&(e.friendlyName=b(o.safeContents,"friendlyName",c.friendlyName,c.bagType)),e},getBagsByFriendlyName:function(a,c){return b(o.safeContents,"friendlyName",a,c)},getBagsByLocalKeyId:function(a,c){return b(o.safeContents,"localKeyId",a,c)}};if(3!==k.version.charCodeAt(0)){var n=new Error("PKCS#12 PFX of version other than 3 not supported.");throw n.version=k.version.charCodeAt(0),n}if(h.derToOid(k.contentType)!==i.oids.data){var n=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw n.oid=h.derToOid(k.contentType),n}var p=k.content.value[0];if(p.tagClass!==h.Class.UNIVERSAL||p.type!==h.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(p=c(p),k.mac){var q=null,r=0,s=h.derToOid(k.macAlgorithm);switch(s){case i.oids.sha1:q=a.md.sha1.create(),r=20;break;case i.oids.sha256:q=a.md.sha256.create(),r=32;break;case i.oids.sha384:q=a.md.sha384.create(),r=48;break;case i.oids.sha512:q=a.md.sha512.create(),r=64;break;case i.oids.md5:q=a.md.md5.create(),r=16}if(null===q)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+s);var t=new a.util.ByteBuffer(k.macSalt),u="macIterations"in k?parseInt(a.util.bytesToHex(k.macIterations),16):1,v=j.generateKey(g,t,3,u,r,q),w=a.hmac.create();w.start(q,v),w.update(p.value);var x=w.getMac();if(x.getBytes()!==k.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return d(o,p.value,f,g),o},j.toPkcs12Asn1=function(b,c,d,e){e=e||{},e.saltSize=e.saltSize||8,e.count=e.count||2048,e.algorithm=e.algorithm||e.encAlgorithm||"aes128","useMac"in e||(e.useMac=!0),"localKeyId"in e||(e.localKeyId=null),"generateLocalKeyId"in e||(e.generateLocalKeyId=!0);var f,g=e.localKeyId;if(null!==g)g=a.util.hexToBytes(g);else if(e.generateLocalKeyId)if(c){var k=a.util.isArray(c)?c[0]:c;"string"==typeof k&&(k=i.certificateFromPem(k));var l=a.md.sha1.create();l.update(h.toDer(i.certificateToAsn1(k)).getBytes()),g=l.digest().getBytes()}else g=a.random.getBytes(20);var m=[];null!==g&&m.push(h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.localKeyId).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SET,!0,[h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,g)])])),"friendlyName"in e&&m.push(h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.friendlyName).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SET,!0,[h.create(h.Class.UNIVERSAL,h.Type.BMPSTRING,!1,e.friendlyName)])])),m.length>0&&(f=h.create(h.Class.UNIVERSAL,h.Type.SET,!0,m));var n=[],o=[];null!==c&&(o=a.util.isArray(c)?c:[c]);for(var p=[],q=0;q<o.length;++q){c=o[q],"string"==typeof c&&(c=i.certificateFromPem(c));var r=0===q?f:void 0,s=i.certificateToAsn1(c),t=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.certBag).getBytes()),h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.x509Certificate).getBytes()),h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,h.toDer(s).getBytes())])])]),r]);p.push(t)}if(p.length>0){var u=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,p),v=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.data).getBytes()),h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,h.toDer(u).getBytes())])]);n.push(v)}var w=null;if(null!==b){var x=i.wrapRsaPrivateKey(i.privateKeyToAsn1(b));w=null===d?h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.keyBag).getBytes()),h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[x]),f]):h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.pkcs8ShroudedKeyBag).getBytes()),h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[i.encryptPrivateKeyInfo(x,d,e)]),f]);var y=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[w]),z=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.data).getBytes()),h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,h.toDer(y).getBytes())])]);n.push(z)}var A,B=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,n);if(e.useMac){var l=a.md.sha1.create(),C=new a.util.ByteBuffer(a.random.getBytes(e.saltSize)),D=e.count,b=j.generateKey(d,C,3,D,20),E=a.hmac.create();E.start(l,b),E.update(h.toDer(B).getBytes());var F=E.getMac();A=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.sha1).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.NULL,!1,"")]),h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,F.getBytes())]),h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,C.getBytes()),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(D).getBytes())])}return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,h.integerToDer(3).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(i.oids.data).getBytes()),h.create(h.Class.CONTEXT_SPECIFIC,0,!0,[h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,h.toDer(B).getBytes())])]),A])},j.generateKey=a.pbe.generatePkcs12Key}var d="pkcs12";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs12",["require","module","./asn1","./hmac","./oids","./pkcs7asn1","./pbe","./random","./rsa","./sha1","./util","./x509"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=a.asn1,c=a.pki=a.pki||{};c.pemToDer=function(b){var c=a.pem.decode(b)[0];if(c.procType&&"ENCRYPTED"===c.procType.type)throw new Error("Could not convert PEM to DER; PEM is encrypted.");return a.util.createBuffer(c.body)},c.privateKeyFromPem=function(d){var e=a.pem.decode(d)[0];if("PRIVATE KEY"!==e.type&&"RSA PRIVATE KEY"!==e.type){var f=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw f.headerType=e.type,f}if(e.procType&&"ENCRYPTED"===e.procType.type)throw new Error("Could not convert private key from PEM; PEM is encrypted.");var g=b.fromDer(e.body);return c.privateKeyFromAsn1(g)},c.privateKeyToPem=function(d,e){var f={type:"RSA PRIVATE KEY",body:b.toDer(c.privateKeyToAsn1(d)).getBytes()};return a.pem.encode(f,{maxline:e})},c.privateKeyInfoToPem=function(c,d){var e={type:"PRIVATE KEY",body:b.toDer(c).getBytes()};return a.pem.encode(e,{maxline:d})}}var d="pki";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pki",["require","module","./asn1","./oids","./pbe","./pem","./pbkdf2","./pkcs12","./pss","./rsa","./util","./x509"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=function(b,c,d,e){var f=a.util.createBuffer(),g=b.length>>1,h=g+(1&b.length),i=b.substr(0,h),j=b.substr(g,h),k=a.util.createBuffer(),l=a.hmac.create();d=c+d;var m=Math.ceil(e/16),n=Math.ceil(e/20);l.start("MD5",i);var o=a.util.createBuffer();k.putBytes(d);for(var p=0;p<m;++p)l.start(null,null),l.update(k.getBytes()),k.putBuffer(l.digest()),l.start(null,null),l.update(k.bytes()+d),o.putBuffer(l.digest());l.start("SHA1",j);var q=a.util.createBuffer();k.clear(),k.putBytes(d);for(var p=0;p<n;++p)l.start(null,null),l.update(k.getBytes()),k.putBuffer(l.digest()),l.start(null,null),l.update(k.bytes()+d),q.putBuffer(l.digest());return f.putBytes(a.util.xorBytes(o.getBytes(),q.getBytes(),e)),f},c=function(b,c,d){var e=a.hmac.create();e.start("SHA1",b);var f=a.util.createBuffer();return f.putInt32(c[0]),f.putInt32(c[1]),f.putByte(d.type),f.putByte(d.version.major),f.putByte(d.version.minor),f.putInt16(d.length),f.putBytes(d.fragment.bytes()),e.update(f.getBytes()),e.digest().getBytes()},d=function(b,c,d){var e=!1;try{var f=b.deflate(c.fragment.getBytes());c.fragment=a.util.createBuffer(f),c.length=f.length,e=!0}catch(a){}return e},e=function(b,c,d){var e=!1;try{var f=b.inflate(c.fragment.getBytes());c.fragment=a.util.createBuffer(f),c.length=f.length,e=!0}catch(a){}return e},f=function(b,c){var d=0;switch(c){case 1:d=b.getByte();break;case 2:d=b.getInt16();break;case 3:d=b.getInt24();break;case 4:d=b.getInt32()}return a.util.createBuffer(b.getBytes(d))},g=function(a,b,c){a.putInt(c.length(),b<<3),a.putBuffer(c)},h={};h.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},h.SupportedVersions=[h.Versions.TLS_1_1,h.Versions.TLS_1_0],h.Version=h.SupportedVersions[0],h.MaxFragment=15360,h.ConnectionEnd={server:0,client:1},h.PRFAlgorithm={tls_prf_sha256:0},h.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},h.CipherType={stream:0,block:1,aead:2},h.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},h.CompressionMethod={none:0,deflate:1},h.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},h.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},h.Alert={},h.Alert.Level={warning:1,fatal:2},h.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},h.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},h.CipherSuites={},h.getCipherSuite=function(a){var b=null;for(var c in h.CipherSuites){var d=h.CipherSuites[c];if(d.id[0]===a.charCodeAt(0)&&d.id[1]===a.charCodeAt(1)){b=d;break}}return b},h.handleUnexpected=function(a,b){var c=!a.open&&a.entity===h.ConnectionEnd.client;c||a.error(a,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.unexpected_message}})},h.handleHelloRequest=function(a,b,c){!a.handshaking&&a.handshakes>0&&(h.queue(a,h.createAlert(a,{level:h.Alert.Level.warning,description:h.Alert.Description.no_renegotiation})),h.flush(a)),a.process()},h.parseHelloMessage=function(b,c,d){var e=null,g=b.entity===h.ConnectionEnd.client;if(d<38)b.error(b,{message:g?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}});else{var i=c.fragment,j=i.length();if(e={version:{major:i.getByte(),minor:i.getByte()},random:a.util.createBuffer(i.getBytes(32)),session_id:f(i,1),extensions:[]},g?(e.cipher_suite=i.getBytes(2),e.compression_method=i.getByte()):(e.cipher_suites=f(i,2),e.compression_methods=f(i,1)),j=d-(j-i.length()),j>0){for(var k=f(i,2);k.length()>0;)e.extensions.push({type:[k.getByte(),k.getByte()],data:f(k,2)});if(!g)for(var l=0;l<e.extensions.length;++l){var m=e.extensions[l];if(0===m.type[0]&&0===m.type[1])for(var n=f(m.data,2);n.length()>0;){var o=n.getByte();if(0!==o)break;b.session.extensions.server_name.serverNameList.push(f(n,2).getBytes())}}}if(b.session.version&&(e.version.major!==b.session.version.major||e.version.minor!==b.session.version.minor))return b.error(b,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.protocol_version}});if(g)b.session.cipherSuite=h.getCipherSuite(e.cipher_suite);else for(var p=a.util.createBuffer(e.cipher_suites.bytes());p.length()>0&&(b.session.cipherSuite=h.getCipherSuite(p.getBytes(2)),null===b.session.cipherSuite););if(null===b.session.cipherSuite)return b.error(b,{message:"No cipher suites in common.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.handshake_failure},cipherSuite:a.util.bytesToHex(e.cipher_suite)});g?b.session.compressionMethod=e.compression_method:b.session.compressionMethod=h.CompressionMethod.none}return e},h.createSecurityParameters=function(a,b){var c=a.entity===h.ConnectionEnd.client,d=b.random.bytes(),e=c?a.session.sp.client_random:d,f=c?d:h.createRandom().getBytes();a.session.sp={entity:a.entity,prf_algorithm:h.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:a.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:e,server_random:f}},h.handleServerHello=function(a,b,c){var d=h.parseHelloMessage(a,b,c);if(!a.fail){if(!(d.version.minor<=a.version.minor))return a.error(a,{message:"Incompatible TLS version.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.protocol_version}});a.version.minor=d.version.minor,a.session.version=a.version;var e=d.session_id.bytes();e.length>0&&e===a.session.id?(a.expect=n,a.session.resuming=!0,a.session.sp.server_random=d.random.bytes()):(a.expect=j,a.session.resuming=!1,h.createSecurityParameters(a,d)),a.session.id=e,a.process()}},h.handleClientHello=function(b,c,d){var e=h.parseHelloMessage(b,c,d);if(!b.fail){var f=e.session_id.bytes(),g=null;if(b.sessionCache&&(g=b.sessionCache.getSession(f),null===g?f="":(g.version.major!==e.version.major||g.version.minor>e.version.minor)&&(g=null,f="")),0===f.length&&(f=a.random.getBytes(32)),b.session.id=f,b.session.clientHelloVersion=e.version,b.session.sp={},g)b.version=b.session.version=g.version,b.session.sp=g.sp;else{for(var i,j=1;j<h.SupportedVersions.length&&(i=h.SupportedVersions[j],!(i.minor<=e.version.minor));++j);b.version={major:i.major,minor:i.minor},b.session.version=b.version}null!==g?(b.expect=v,b.session.resuming=!0,b.session.sp.client_random=e.random.bytes()):(b.expect=b.verifyClient!==!1?s:t,b.session.resuming=!1,h.createSecurityParameters(b,e)),b.open=!0,h.queue(b,h.createRecord(b,{type:h.ContentType.handshake,data:h.createServerHello(b)})),b.session.resuming?(h.queue(b,h.createRecord(b,{type:h.ContentType.change_cipher_spec,data:h.createChangeCipherSpec()})),b.state.pending=h.createConnectionState(b),b.state.current.write=b.state.pending.write,h.queue(b,h.createRecord(b,{type:h.ContentType.handshake,data:h.createFinished(b)}))):(h.queue(b,h.createRecord(b,{type:h.ContentType.handshake,data:h.createCertificate(b)})),b.fail||(h.queue(b,h.createRecord(b,{type:h.ContentType.handshake,data:h.createServerKeyExchange(b)})),b.verifyClient!==!1&&h.queue(b,h.createRecord(b,{type:h.ContentType.handshake,data:h.createCertificateRequest(b)})),h.queue(b,h.createRecord(b,{type:h.ContentType.handshake,data:h.createServerHelloDone(b)})))),h.flush(b),b.process()}},h.handleCertificate=function(b,c,d){if(d<3)return b.error(b,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}});var e,g,i=c.fragment,j={certificate_list:f(i,3)},l=[];try{for(;j.certificate_list.length()>0;)e=f(j.certificate_list,3),g=a.asn1.fromDer(e),e=a.pki.certificateFromAsn1(g,!0),l.push(e)}catch(a){return b.error(b,{message:"Could not parse certificate list.",cause:a,send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.bad_certificate}})}var m=b.entity===h.ConnectionEnd.client;!m&&b.verifyClient!==!0||0!==l.length?0===l.length?b.expect=m?k:t:(m?b.session.serverCertificate=l[0]:b.session.clientCertificate=l[0],h.verifyCertificateChain(b,l)&&(b.expect=m?k:t)):b.error(b,{message:m?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}}),b.process()},h.handleServerKeyExchange=function(a,b,c){return c>0?a.error(a,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.unsupported_certificate}}):(a.expect=l,void a.process())},h.handleClientKeyExchange=function(b,c,d){if(d<48)return b.error(b,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.unsupported_certificate}});var e=c.fragment,g={enc_pre_master_secret:f(e,2).getBytes()},i=null;if(b.getPrivateKey)try{i=b.getPrivateKey(b,b.session.serverCertificate),i=a.pki.privateKeyFromPem(i)}catch(a){b.error(b,{message:"Could not get private key.",cause:a,send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}})}if(null===i)return b.error(b,{message:"No private key set.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}});try{var j=b.session.sp;j.pre_master_secret=i.decrypt(g.enc_pre_master_secret);var k=b.session.clientHelloVersion;if(k.major!==j.pre_master_secret.charCodeAt(0)||k.minor!==j.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch(b){j.pre_master_secret=a.random.getBytes(48)}b.expect=v,null!==b.session.clientCertificate&&(b.expect=u),b.process()},h.handleCertificateRequest=function(a,b,c){if(c<3)return a.error(a,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}});var d=b.fragment,e={certificate_types:f(d,1),certificate_authorities:f(d,2)};a.session.certificateRequest=e,a.expect=m,a.process()},h.handleCertificateVerify=function(b,c,d){if(d<2)return b.error(b,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}});var e=c.fragment;e.read-=4;var g=e.bytes();e.read+=4;var i={signature:f(e,2).getBytes()},j=a.util.createBuffer();j.putBuffer(b.session.md5.digest()),j.putBuffer(b.session.sha1.digest()),j=j.getBytes();try{var k=b.session.clientCertificate;if(!k.publicKey.verify(j,i.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");b.session.md5.update(g),b.session.sha1.update(g)}catch(a){return b.error(b,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.handshake_failure}})}b.expect=v,b.process()},h.handleServerHelloDone=function(b,c,d){if(d>0)return b.error(b,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.record_overflow}});if(null===b.serverCertificate){var e={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.insufficient_security}},f=0,g=b.verify(b,e.alert.description,f,[]);if(g!==!0)return(g||0===g)&&("object"!=typeof g||a.util.isArray(g)?"number"==typeof g&&(e.alert.description=g):(g.message&&(e.message=g.message),g.alert&&(e.alert.description=g.alert))),b.error(b,e)}null!==b.session.certificateRequest&&(c=h.createRecord(b,{type:h.ContentType.handshake,data:h.createCertificate(b)}),h.queue(b,c)),c=h.createRecord(b,{type:h.ContentType.handshake,data:h.createClientKeyExchange(b)}),h.queue(b,c),b.expect=q;var i=function(a,b){null!==a.session.certificateRequest&&null!==a.session.clientCertificate&&h.queue(a,h.createRecord(a,{type:h.ContentType.handshake,data:h.createCertificateVerify(a,b)})),h.queue(a,h.createRecord(a,{type:h.ContentType.change_cipher_spec,data:h.createChangeCipherSpec()})),a.state.pending=h.createConnectionState(a),a.state.current.write=a.state.pending.write,h.queue(a,h.createRecord(a,{type:h.ContentType.handshake,data:h.createFinished(a)})),a.expect=n,h.flush(a),a.process()};return null===b.session.certificateRequest||null===b.session.clientCertificate?i(b,null):void h.getClientSignature(b,i)},h.handleChangeCipherSpec=function(a,b){if(1!==b.fragment.getByte())return a.error(a,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.illegal_parameter}});var c=a.entity===h.ConnectionEnd.client;(a.session.resuming&&c||!a.session.resuming&&!c)&&(a.state.pending=h.createConnectionState(a)),a.state.current.read=a.state.pending.read,(!a.session.resuming&&c||a.session.resuming&&!c)&&(a.state.pending=null),a.expect=c?o:w,a.process()},h.handleFinished=function(c,d,e){var f=d.fragment;f.read-=4;var g=f.bytes();f.read+=4;var i=d.fragment.getBytes();f=a.util.createBuffer(),f.putBuffer(c.session.md5.digest()),f.putBuffer(c.session.sha1.digest());var j=c.entity===h.ConnectionEnd.client,k=j?"server finished":"client finished",l=c.session.sp,m=12,n=b;return f=n(l.master_secret,k,f.getBytes(),m),f.getBytes()!==i?c.error(c,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.decrypt_error}}):(c.session.md5.update(g),c.session.sha1.update(g),(c.session.resuming&&j||!c.session.resuming&&!j)&&(h.queue(c,h.createRecord(c,{type:h.ContentType.change_cipher_spec,data:h.createChangeCipherSpec()})),c.state.current.write=c.state.pending.write,c.state.pending=null,h.queue(c,h.createRecord(c,{type:h.ContentType.handshake,data:h.createFinished(c)}))),c.expect=j?p:x,c.handshaking=!1,++c.handshakes,c.peerCertificate=j?c.session.serverCertificate:c.session.clientCertificate,h.flush(c),c.isConnected=!0,c.connected(c),void c.process())},h.handleAlert=function(a,b){var c,d=b.fragment,e={level:d.getByte(),description:d.getByte()};switch(e.description){case h.Alert.Description.close_notify:c="Connection closed.";break;case h.Alert.Description.unexpected_message:c="Unexpected message.";break;case h.Alert.Description.bad_record_mac:c="Bad record MAC.";break;case h.Alert.Description.decryption_failed:c="Decryption failed.";break;case h.Alert.Description.record_overflow:c="Record overflow.";break;case h.Alert.Description.decompression_failure:c="Decompression failed.";break;case h.Alert.Description.handshake_failure:c="Handshake failure.";break;case h.Alert.Description.bad_certificate:c="Bad certificate.";break;case h.Alert.Description.unsupported_certificate:c="Unsupported certificate.";break;case h.Alert.Description.certificate_revoked:c="Certificate revoked.";break;case h.Alert.Description.certificate_expired:c="Certificate expired.";break;case h.Alert.Description.certificate_unknown:c="Certificate unknown.";break;case h.Alert.Description.illegal_parameter:c="Illegal parameter.";break;case h.Alert.Description.unknown_ca:c="Unknown certificate authority.";break;case h.Alert.Description.access_denied:c="Access denied.";break;case h.Alert.Description.decode_error:c="Decode error.";break;case h.Alert.Description.decrypt_error:c="Decrypt error.";break;case h.Alert.Description.export_restriction:c="Export restriction.";break;case h.Alert.Description.protocol_version:c="Unsupported protocol version.";break;case h.Alert.Description.insufficient_security:c="Insufficient security.";break;case h.Alert.Description.internal_error:c="Internal error.";break;case h.Alert.Description.user_canceled:c="User canceled.";break;case h.Alert.Description.no_renegotiation:c="Renegotiation not supported.";break;default:c="Unknown error."}return e.description===h.Alert.Description.close_notify?a.close():(a.error(a,{message:c,send:!1,origin:a.entity===h.ConnectionEnd.client?"server":"client",alert:e}),void a.process())},h.handleHandshake=function(b,c){var d=c.fragment,e=d.getByte(),f=d.getInt24();if(f>d.length())return b.fragmented=c,c.fragment=a.util.createBuffer(),d.read-=4,b.process();b.fragmented=null,d.read-=4;var g=d.bytes(f+4);d.read+=4,e in M[b.entity][b.expect]?(b.entity!==h.ConnectionEnd.server||b.open||b.fail||(b.handshaking=!0,b.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:a.md.md5.create(),sha1:a.md.sha1.create()}),e!==h.HandshakeType.hello_request&&e!==h.HandshakeType.certificate_verify&&e!==h.HandshakeType.finished&&(b.session.md5.update(g),b.session.sha1.update(g)),M[b.entity][b.expect][e](b,c,f)):h.handleUnexpected(b,c)},h.handleApplicationData=function(a,b){a.data.putBuffer(b.fragment),a.dataReady(a),a.process()},h.handleHeartbeat=function(b,c){var d=c.fragment,e=d.getByte(),f=d.getInt16(),g=d.getBytes(f);if(e===h.HeartbeatMessageType.heartbeat_request){if(b.handshaking||f>g.length)return b.process();h.queue(b,h.createRecord(b,{type:h.ContentType.heartbeat,data:h.createHeartbeat(h.HeartbeatMessageType.heartbeat_response,g)})),h.flush(b)}else if(e===h.HeartbeatMessageType.heartbeat_response){if(g!==b.expectedHeartbeatPayload)return b.process();b.heartbeatReceived&&b.heartbeatReceived(b,a.util.createBuffer(g))}b.process()};var i=0,j=1,k=2,l=3,m=4,n=5,o=6,p=7,q=8,r=0,s=1,t=2,u=3,v=4,w=5,x=6,y=h.handleUnexpected,z=h.handleChangeCipherSpec,A=h.handleAlert,B=h.handleHandshake,C=h.handleApplicationData,D=h.handleHeartbeat,E=[];E[h.ConnectionEnd.client]=[[y,A,B,y,D],[y,A,B,y,D],[y,A,B,y,D],[y,A,B,y,D],[y,A,B,y,D],[z,A,y,y,D],[y,A,B,y,D],[y,A,B,C,D],[y,A,B,y,D]],E[h.ConnectionEnd.server]=[[y,A,B,y,D],[y,A,B,y,D],[y,A,B,y,D],[y,A,B,y,D],[z,A,y,y,D],[y,A,B,y,D],[y,A,B,C,D],[y,A,B,y,D]];var F=h.handleHelloRequest,G=h.handleServerHello,H=h.handleCertificate,I=h.handleServerKeyExchange,J=h.handleCertificateRequest,K=h.handleServerHelloDone,L=h.handleFinished,M=[];M[h.ConnectionEnd.client]=[[y,y,G,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[F,y,y,y,y,y,y,y,y,y,y,H,I,J,K,y,y,y,y,y,y],[F,y,y,y,y,y,y,y,y,y,y,y,I,J,K,y,y,y,y,y,y],[F,y,y,y,y,y,y,y,y,y,y,y,y,J,K,y,y,y,y,y,y],[F,y,y,y,y,y,y,y,y,y,y,y,y,y,K,y,y,y,y,y,y],[F,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[F,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,L],[F,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[F,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y]];var N=h.handleClientHello,O=h.handleClientKeyExchange,P=h.handleCertificateVerify;M[h.ConnectionEnd.server]=[[y,N,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,H,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,O,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,P,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,L],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y]],h.generateKeys=function(a,c){var d=b,e=c.client_random+c.server_random;a.session.resuming||(c.master_secret=d(c.pre_master_secret,"master secret",e,48).bytes(),c.pre_master_secret=null),e=c.server_random+c.client_random;var f=2*c.mac_key_length+2*c.enc_key_length,g=a.version.major===h.Versions.TLS_1_0.major&&a.version.minor===h.Versions.TLS_1_0.minor;g&&(f+=2*c.fixed_iv_length);var i=d(c.master_secret,"key expansion",e,f),j={client_write_MAC_key:i.getBytes(c.mac_key_length),server_write_MAC_key:i.getBytes(c.mac_key_length),client_write_key:i.getBytes(c.enc_key_length),server_write_key:i.getBytes(c.enc_key_length)};return g&&(j.client_write_IV=i.getBytes(c.fixed_iv_length),j.server_write_IV=i.getBytes(c.fixed_iv_length)),j},h.createConnectionState=function(a){var b=a.entity===h.ConnectionEnd.client,c=function(){var a={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(a){return!0},compressionState:null,compressFunction:function(a){return!0},updateSequenceNumber:function(){4294967295===a.sequenceNumber[1]?(a.sequenceNumber[1]=0,++a.sequenceNumber[0]):++a.sequenceNumber[1]}};return a},f={read:c(),write:c()};if(f.read.update=function(a,b){return f.read.cipherFunction(b,f.read)?f.read.compressFunction(a,b,f.read)||a.error(a,{message:"Could not decompress record.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.decompression_failure}}):a.error(a,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.bad_record_mac}}),!a.fail},f.write.update=function(a,b){return f.write.compressFunction(a,b,f.write)?f.write.cipherFunction(b,f.write)||a.error(a,{message:"Could not encrypt record.",send:!1,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}}):a.error(a,{message:"Could not compress record.",send:!1,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}}),!a.fail},a.session){var g=a.session.sp;switch(a.session.cipherSuite.initSecurityParameters(g),g.keys=h.generateKeys(a,g),f.read.macKey=b?g.keys.server_write_MAC_key:g.keys.client_write_MAC_key,f.write.macKey=b?g.keys.client_write_MAC_key:g.keys.server_write_MAC_key,
a.session.cipherSuite.initConnectionState(f,a,g),g.compression_algorithm){case h.CompressionMethod.none:break;case h.CompressionMethod.deflate:f.read.compressFunction=e,f.write.compressFunction=d;break;default:throw new Error("Unsupported compression algorithm.")}}return f},h.createRandom=function(){var b=new Date,c=+b+6e4*b.getTimezoneOffset(),d=a.util.createBuffer();return d.putInt32(c),d.putBytes(a.random.getBytes(28)),d},h.createRecord=function(a,b){if(!b.data)return null;var c={type:b.type,version:{major:a.version.major,minor:a.version.minor},length:b.data.length(),fragment:b.data};return c},h.createAlert=function(b,c){var d=a.util.createBuffer();return d.putByte(c.level),d.putByte(c.description),h.createRecord(b,{type:h.ContentType.alert,data:d})},h.createClientHello=function(b){b.session.clientHelloVersion={major:b.version.major,minor:b.version.minor};for(var c=a.util.createBuffer(),d=0;d<b.cipherSuites.length;++d){var e=b.cipherSuites[d];c.putByte(e.id[0]),c.putByte(e.id[1])}var f=c.length(),i=a.util.createBuffer();i.putByte(h.CompressionMethod.none);var j=i.length(),k=a.util.createBuffer();if(b.virtualHost){var l=a.util.createBuffer();l.putByte(0),l.putByte(0);var m=a.util.createBuffer();m.putByte(0),g(m,2,a.util.createBuffer(b.virtualHost));var n=a.util.createBuffer();g(n,2,m),g(l,2,n),k.putBuffer(l)}var o=k.length();o>0&&(o+=2);var p=b.session.id,q=p.length+1+2+4+28+2+f+1+j+o,r=a.util.createBuffer();return r.putByte(h.HandshakeType.client_hello),r.putInt24(q),r.putByte(b.version.major),r.putByte(b.version.minor),r.putBytes(b.session.sp.client_random),g(r,1,a.util.createBuffer(p)),g(r,2,c),g(r,1,i),o>0&&g(r,2,k),r},h.createServerHello=function(b){var c=b.session.id,d=c.length+1+2+4+28+2+1,e=a.util.createBuffer();return e.putByte(h.HandshakeType.server_hello),e.putInt24(d),e.putByte(b.version.major),e.putByte(b.version.minor),e.putBytes(b.session.sp.server_random),g(e,1,a.util.createBuffer(c)),e.putByte(b.session.cipherSuite.id[0]),e.putByte(b.session.cipherSuite.id[1]),e.putByte(b.session.compressionMethod),e},h.createCertificate=function(b){var c=b.entity===h.ConnectionEnd.client,d=null;if(b.getCertificate){var e;e=c?b.session.certificateRequest:b.session.extensions.server_name.serverNameList,d=b.getCertificate(b,e)}var f=a.util.createBuffer();if(null!==d)try{a.util.isArray(d)||(d=[d]);for(var i=null,j=0;j<d.length;++j){var k=a.pem.decode(d[j])[0];if("CERTIFICATE"!==k.type&&"X509 CERTIFICATE"!==k.type&&"TRUSTED CERTIFICATE"!==k.type){var l=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw l.headerType=k.type,l}if(k.procType&&"ENCRYPTED"===k.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var m=a.util.createBuffer(k.body);null===i&&(i=a.asn1.fromDer(m.bytes(),!1));var n=a.util.createBuffer();g(n,3,m),f.putBuffer(n)}d=a.pki.certificateFromAsn1(i),c?b.session.clientCertificate=d:b.session.serverCertificate=d}catch(a){return b.error(b,{message:"Could not send certificate list.",cause:a,send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.bad_certificate}})}var o=3+f.length(),p=a.util.createBuffer();return p.putByte(h.HandshakeType.certificate),p.putInt24(o),g(p,3,f),p},h.createClientKeyExchange=function(b){var c=a.util.createBuffer();c.putByte(b.session.clientHelloVersion.major),c.putByte(b.session.clientHelloVersion.minor),c.putBytes(a.random.getBytes(46));var d=b.session.sp;d.pre_master_secret=c.getBytes();var e=b.session.serverCertificate.publicKey;c=e.encrypt(d.pre_master_secret);var f=c.length+2,g=a.util.createBuffer();return g.putByte(h.HandshakeType.client_key_exchange),g.putInt24(f),g.putInt16(c.length),g.putBytes(c),g},h.createServerKeyExchange=function(b){var c=0,d=a.util.createBuffer();return c>0&&(d.putByte(h.HandshakeType.server_key_exchange),d.putInt24(c)),d},h.getClientSignature=function(b,c){var d=a.util.createBuffer();d.putBuffer(b.session.md5.digest()),d.putBuffer(b.session.sha1.digest()),d=d.getBytes(),b.getSignature=b.getSignature||function(b,c,d){var e=null;if(b.getPrivateKey)try{e=b.getPrivateKey(b,b.session.clientCertificate),e=a.pki.privateKeyFromPem(e)}catch(a){b.error(b,{message:"Could not get private key.",cause:a,send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}})}null===e?b.error(b,{message:"No private key set.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.internal_error}}):c=e.sign(c,null),d(b,c)},b.getSignature(b,d,c)},h.createCertificateVerify=function(b,c){var d=c.length+2,e=a.util.createBuffer();return e.putByte(h.HandshakeType.certificate_verify),e.putInt24(d),e.putInt16(c.length),e.putBytes(c),e},h.createCertificateRequest=function(b){var c=a.util.createBuffer();c.putByte(1);var d=a.util.createBuffer();for(var e in b.caStore.certs){var f=b.caStore.certs[e],i=a.pki.distinguishedNameToAsn1(f.subject);d.putBuffer(a.asn1.toDer(i))}var j=1+c.length()+2+d.length(),k=a.util.createBuffer();return k.putByte(h.HandshakeType.certificate_request),k.putInt24(j),g(k,1,c),g(k,2,d),k},h.createServerHelloDone=function(b){var c=a.util.createBuffer();return c.putByte(h.HandshakeType.server_hello_done),c.putInt24(0),c},h.createChangeCipherSpec=function(){var b=a.util.createBuffer();return b.putByte(1),b},h.createFinished=function(c){var d=a.util.createBuffer();d.putBuffer(c.session.md5.digest()),d.putBuffer(c.session.sha1.digest());var e=c.entity===h.ConnectionEnd.client,f=c.session.sp,g=12,i=b,j=e?"client finished":"server finished";d=i(f.master_secret,j,d.getBytes(),g);var k=a.util.createBuffer();return k.putByte(h.HandshakeType.finished),k.putInt24(d.length()),k.putBuffer(d),k},h.createHeartbeat=function(b,c,d){"undefined"==typeof d&&(d=c.length);var e=a.util.createBuffer();e.putByte(b),e.putInt16(d),e.putBytes(c);var f=e.length(),g=Math.max(16,f-d-3);return e.putBytes(a.random.getBytes(g)),e},h.queue=function(b,c){if(c){if(c.type===h.ContentType.handshake){var d=c.fragment.bytes();b.session.md5.update(d),b.session.sha1.update(d),d=null}var e;if(c.fragment.length()<=h.MaxFragment)e=[c];else{e=[];for(var f=c.fragment.bytes();f.length>h.MaxFragment;)e.push(h.createRecord(b,{type:c.type,data:a.util.createBuffer(f.slice(0,h.MaxFragment))})),f=f.slice(h.MaxFragment);f.length>0&&e.push(h.createRecord(b,{type:c.type,data:a.util.createBuffer(f)}))}for(var g=0;g<e.length&&!b.fail;++g){var i=e[g],j=b.state.current.write;j.update(b,i)&&b.records.push(i)}}},h.flush=function(a){for(var b=0;b<a.records.length;++b){var c=a.records[b];a.tlsData.putByte(c.type),a.tlsData.putByte(c.version.major),a.tlsData.putByte(c.version.minor),a.tlsData.putInt16(c.fragment.length()),a.tlsData.putBuffer(a.records[b].fragment)}return a.records=[],a.tlsDataReady(a)};var Q=function(b){switch(b){case!0:return!0;case a.pki.certificateError.bad_certificate:return h.Alert.Description.bad_certificate;case a.pki.certificateError.unsupported_certificate:return h.Alert.Description.unsupported_certificate;case a.pki.certificateError.certificate_revoked:return h.Alert.Description.certificate_revoked;case a.pki.certificateError.certificate_expired:return h.Alert.Description.certificate_expired;case a.pki.certificateError.certificate_unknown:return h.Alert.Description.certificate_unknown;case a.pki.certificateError.unknown_ca:return h.Alert.Description.unknown_ca;default:return h.Alert.Description.bad_certificate}},R=function(b){switch(b){case!0:return!0;case h.Alert.Description.bad_certificate:return a.pki.certificateError.bad_certificate;case h.Alert.Description.unsupported_certificate:return a.pki.certificateError.unsupported_certificate;case h.Alert.Description.certificate_revoked:return a.pki.certificateError.certificate_revoked;case h.Alert.Description.certificate_expired:return a.pki.certificateError.certificate_expired;case h.Alert.Description.certificate_unknown:return a.pki.certificateError.certificate_unknown;case h.Alert.Description.unknown_ca:return a.pki.certificateError.unknown_ca;default:return a.pki.certificateError.bad_certificate}};h.verifyCertificateChain=function(b,c){try{a.pki.verifyCertificateChain(b.caStore,c,function(c,d,e){var f=(Q(c),b.verify(b,c,d,e));if(f!==!0){if("object"==typeof f&&!a.util.isArray(f)){var g=new Error("The application rejected the certificate.");throw g.send=!0,g.alert={level:h.Alert.Level.fatal,description:h.Alert.Description.bad_certificate},f.message&&(g.message=f.message),f.alert&&(g.alert.description=f.alert),g}f!==c&&(f=R(f))}return f})}catch(c){var d=c;("object"!=typeof d||a.util.isArray(d))&&(d={send:!0,alert:{level:h.Alert.Level.fatal,description:Q(c)}}),"send"in d||(d.send=!0),"alert"in d||(d.alert={level:h.Alert.Level.fatal,description:Q(d.error)}),b.error(b,d)}return!b.fail},h.createSessionCache=function(b,c){var d=null;if(b&&b.getSession&&b.setSession&&b.order)d=b;else{d={},d.cache=b||{},d.capacity=Math.max(c||100,1),d.order=[];for(var e in b)d.order.length<=c?d.order.push(e):delete b[e];d.getSession=function(b){var c=null,e=null;if(b?e=a.util.bytesToHex(b):d.order.length>0&&(e=d.order[0]),null!==e&&e in d.cache){c=d.cache[e],delete d.cache[e];for(var f in d.order)if(d.order[f]===e){d.order.splice(f,1);break}}return c},d.setSession=function(b,c){if(d.order.length===d.capacity){var e=d.order.shift();delete d.cache[e]}var e=a.util.bytesToHex(b);d.order.push(e),d.cache[e]=c}}return d},h.createConnection=function(b){var c=null;c=b.caStore?a.util.isArray(b.caStore)?a.pki.createCaStore(b.caStore):b.caStore:a.pki.createCaStore();var d=b.cipherSuites||null;if(null===d){d=[];for(var e in h.CipherSuites)d.push(h.CipherSuites[e])}var f=b.server?h.ConnectionEnd.server:h.ConnectionEnd.client,g=b.sessionCache?h.createSessionCache(b.sessionCache):null,j={version:{major:h.Version.major,minor:h.Version.minor},entity:f,sessionId:b.sessionId,caStore:c,sessionCache:g,cipherSuites:d,connected:b.connected,virtualHost:b.virtualHost||null,verifyClient:b.verifyClient||!1,verify:b.verify||function(a,b,c,d){return b},getCertificate:b.getCertificate||null,getPrivateKey:b.getPrivateKey||null,getSignature:b.getSignature||null,input:a.util.createBuffer(),tlsData:a.util.createBuffer(),data:a.util.createBuffer(),tlsDataReady:b.tlsDataReady,dataReady:b.dataReady,heartbeatReceived:b.heartbeatReceived,closed:b.closed,error:function(a,c){c.origin=c.origin||(a.entity===h.ConnectionEnd.client?"client":"server"),c.send&&(h.queue(a,h.createAlert(a,c.alert)),h.flush(a));var d=c.fatal!==!1;d&&(a.fail=!0),b.error(a,c),d&&a.close(!1)},deflate:b.deflate||null,inflate:b.inflate||null};j.reset=function(a){j.version={major:h.Version.major,minor:h.Version.minor},j.record=null,j.session=null,j.peerCertificate=null,j.state={pending:null,current:null},j.expect=j.entity===h.ConnectionEnd.client?i:r,j.fragmented=null,j.records=[],j.open=!1,j.handshakes=0,j.handshaking=!1,j.isConnected=!1,j.fail=!(a||"undefined"==typeof a),j.input.clear(),j.tlsData.clear(),j.data.clear(),j.state.current=h.createConnectionState(j)},j.reset();var k=function(a,b){var c=b.type-h.ContentType.change_cipher_spec,d=E[a.entity][a.expect];c in d?d[c](a,b):h.handleUnexpected(a,b)},l=function(b){var c=0,d=b.input,e=d.length();if(e<5)c=5-e;else{b.record={type:d.getByte(),version:{major:d.getByte(),minor:d.getByte()},length:d.getInt16(),fragment:a.util.createBuffer(),ready:!1};var f=b.record.version.major===b.version.major;f&&b.session&&b.session.version&&(f=b.record.version.minor===b.version.minor),f||b.error(b,{message:"Incompatible TLS version.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.protocol_version}})}return c},m=function(a){var b=0,c=a.input,d=c.length();if(d<a.record.length)b=a.record.length-d;else{a.record.fragment.putBytes(c.getBytes(a.record.length)),c.compact();var e=a.state.current.read;e.update(a,a.record)&&(null!==a.fragmented&&(a.fragmented.type===a.record.type?(a.fragmented.fragment.putBuffer(a.record.fragment),a.record=a.fragmented):a.error(a,{message:"Invalid fragmented record.",send:!0,alert:{level:h.Alert.Level.fatal,description:h.Alert.Description.unexpected_message}})),a.record.ready=!0)}return b};return j.handshake=function(b){if(j.entity!==h.ConnectionEnd.client)j.error(j,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(j.handshaking)j.error(j,{message:"Handshake already in progress.",fatal:!1});else{j.fail&&!j.open&&0===j.handshakes&&(j.fail=!1),j.handshaking=!0,b=b||"";var c=null;b.length>0&&(j.sessionCache&&(c=j.sessionCache.getSession(b)),null===c&&(b="")),0===b.length&&j.sessionCache&&(c=j.sessionCache.getSession(),null!==c&&(b=c.id)),j.session={id:b,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:a.md.md5.create(),sha1:a.md.sha1.create()},c&&(j.version=c.version,j.session.sp=c.sp),j.session.sp.client_random=h.createRandom().getBytes(),j.open=!0,h.queue(j,h.createRecord(j,{type:h.ContentType.handshake,data:h.createClientHello(j)})),h.flush(j)}},j.process=function(a){var b=0;return a&&j.input.putBytes(a),j.fail||(null!==j.record&&j.record.ready&&j.record.fragment.isEmpty()&&(j.record=null),null===j.record&&(b=l(j)),j.fail||null===j.record||j.record.ready||(b=m(j)),!j.fail&&null!==j.record&&j.record.ready&&k(j,j.record)),b},j.prepare=function(b){return h.queue(j,h.createRecord(j,{type:h.ContentType.application_data,data:a.util.createBuffer(b)})),h.flush(j)},j.prepareHeartbeatRequest=function(b,c){return b instanceof a.util.ByteBuffer&&(b=b.bytes()),"undefined"==typeof c&&(c=b.length),j.expectedHeartbeatPayload=b,h.queue(j,h.createRecord(j,{type:h.ContentType.heartbeat,data:h.createHeartbeat(h.HeartbeatMessageType.heartbeat_request,b,c)})),h.flush(j)},j.close=function(a){if(!j.fail&&j.sessionCache&&j.session){var b={id:j.session.id,version:j.session.version,sp:j.session.sp};b.sp.keys=null,j.sessionCache.setSession(b.id,b)}j.open&&(j.open=!1,j.input.clear(),(j.isConnected||j.handshaking)&&(j.isConnected=j.handshaking=!1,h.queue(j,h.createAlert(j,{level:h.Alert.Level.warning,description:h.Alert.Description.close_notify})),h.flush(j)),j.closed(j)),j.reset(a)},j},a.tls=a.tls||{};for(var S in h)"function"!=typeof h[S]&&(a.tls[S]=h[S]);a.tls.prf_tls1=b,a.tls.hmac_sha1=c,a.tls.createSessionCache=h.createSessionCache,a.tls.createConnection=h.createConnection}var d="tls";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/tls",["require","module","./asn1","./hmac","./md","./pem","./pki","./random","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(b,d,e){var h=d.entity===a.tls.ConnectionEnd.client;b.read.cipherState={init:!1,cipher:a.cipher.createDecipher("AES-CBC",h?e.keys.server_write_key:e.keys.client_write_key),iv:h?e.keys.server_write_IV:e.keys.client_write_IV},b.write.cipherState={init:!1,cipher:a.cipher.createCipher("AES-CBC",h?e.keys.client_write_key:e.keys.server_write_key),iv:h?e.keys.client_write_IV:e.keys.server_write_IV},b.read.cipherFunction=f,b.write.cipherFunction=c,b.read.macLength=b.write.macLength=e.mac_length,b.read.macFunction=b.write.macFunction=g.hmac_sha1}function c(b,c){var e=!1,f=c.macFunction(c.macKey,c.sequenceNumber,b);b.fragment.putBytes(f),c.updateSequenceNumber();var h;h=b.version.minor===g.Versions.TLS_1_0.minor?c.cipherState.init?null:c.cipherState.iv:a.random.getBytesSync(16),c.cipherState.init=!0;var i=c.cipherState.cipher;return i.start({iv:h}),b.version.minor>=g.Versions.TLS_1_1.minor&&i.output.putBytes(h),i.update(b.fragment),i.finish(d)&&(b.fragment=i.output,b.length=b.fragment.length(),e=!0),e}function d(a,b,c){if(!c){var d=a-b.length()%a;b.fillWithByte(d-1,d)}return!0}function e(a,b,c){var d=!0;if(c){for(var e=b.length(),f=b.last(),g=e-1-f;g<e-1;++g)d=d&&b.at(g)==f;d&&b.truncate(f+1)}return d}function f(b,c){var d=!1;++h;var f;f=b.version.minor===g.Versions.TLS_1_0.minor?c.cipherState.init?null:c.cipherState.iv:b.fragment.getBytes(16),c.cipherState.init=!0;var i=c.cipherState.cipher;i.start({iv:f}),i.update(b.fragment),d=i.finish(e);for(var j=c.macLength,k="",l=0;l<j;++l)k+=String.fromCharCode(0);var m=i.output.length();m>=j?(b.fragment=i.output.getBytes(m-j),k=i.output.getBytes(j)):b.fragment=i.output.getBytes(),b.fragment=a.util.createBuffer(b.fragment),b.length=b.fragment.length();var n=c.macFunction(c.macKey,c.sequenceNumber,b);return c.updateSequenceNumber(),d=n===k&&d}var g=a.tls;g.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(a){a.bulk_cipher_algorithm=g.BulkCipherAlgorithm.aes,a.cipher_type=g.CipherType.block,a.enc_key_length=16,a.block_length=16,a.fixed_iv_length=16,a.record_iv_length=16,a.mac_algorithm=g.MACAlgorithm.hmac_sha1,a.mac_length=20,a.mac_key_length=20},initConnectionState:b},g.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(a){a.bulk_cipher_algorithm=g.BulkCipherAlgorithm.aes,a.cipher_type=g.CipherType.block,a.enc_key_length=32,a.block_length=16,a.fixed_iv_length=16,a.record_iv_length=16,a.mac_algorithm=g.MACAlgorithm.hmac_sha1,a.mac_length=20,a.mac_key_length=20},initConnectionState:b};var h=0}var d="aesCipherSuites";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/aesCipherSuites",["require","module","./aes","./tls"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){a.debug=a.debug||{},a.debug.storage={},a.debug.get=function(b,c){var d;return"undefined"==typeof b?d=a.debug.storage:b in a.debug.storage&&(d="undefined"==typeof c?a.debug.storage[b]:a.debug.storage[b][c]),d},a.debug.set=function(b,c,d){b in a.debug.storage||(a.debug.storage[b]={}),a.debug.storage[b][c]=d},a.debug.clear=function(b,c){"undefined"==typeof b?a.debug.storage={}:b in a.debug.storage&&("undefined"==typeof c?delete a.debug.storage[b]:delete a.debug.storage[b][c])}}var d="debug";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/debug",["require","module"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(b,c,d,e){b.generate=function(b,f){for(var g=new a.util.ByteBuffer,h=Math.ceil(f/e)+d,i=new a.util.ByteBuffer,j=d;j<h;++j){i.putInt32(j),c.start(),c.update(b+i.getBytes());var k=c.digest();g.putBytes(k.getBytes(e))}return g.truncate(g.length()-f),g.getBytes()}}a.kem=a.kem||{};var c=a.jsbn.BigInteger;a.kem.rsa={},a.kem.rsa.create=function(b,d){d=d||{};var e=d.prng||a.random,f={};return f.encrypt=function(d,f){var g,h=Math.ceil(d.n.bitLength()/8);do g=new c(a.util.bytesToHex(e.getBytesSync(h)),16).mod(d.n);while(g.equals(c.ZERO));g=a.util.hexToBytes(g.toString(16));var i=h-g.length;i>0&&(g=a.util.fillString(String.fromCharCode(0),i)+g);var j=d.encrypt(g,"NONE"),k=b.generate(g,f);return{encapsulation:j,key:k}},f.decrypt=function(a,c,d){var e=a.decrypt(c,"NONE");return b.generate(e,d)},f},a.kem.kdf1=function(a,c){b(this,a,0,c||a.digestLength)},a.kem.kdf2=function(a,c){b(this,a,1,c||a.digestLength)}}var d="kem";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/kem",["require","module","./util","./random","./jsbn"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){a.log=a.log||{},a.log.levels=["none","error","warning","info","debug","verbose","max"];var b={},c=[],d=null;a.log.LEVEL_LOCKED=2,a.log.NO_LEVEL_CHECK=4,a.log.INTERPOLATE=8;for(var e=0;e<a.log.levels.length;++e){var f=a.log.levels[e];b[f]={index:e,name:f.toUpperCase()}}a.log.logMessage=function(d){for(var e=b[d.level].index,f=0;f<c.length;++f){var g=c[f];if(g.flags&a.log.NO_LEVEL_CHECK)g.f(d);else{var h=b[g.level].index;e<=h&&g.f(g,d)}}},a.log.prepareStandard=function(a){"standard"in a||(a.standard=b[a.level].name+" ["+a.category+"] "+a.message)},a.log.prepareFull=function(b){if(!("full"in b)){var c=[b.message];c=c.concat([]||b.arguments),b.full=a.util.format.apply(this,c)}},a.log.prepareStandardFull=function(b){"standardFull"in b||(a.log.prepareStandard(b),b.standardFull=b.standard)};for(var g=["error","warning","info","debug","verbose"],e=0;e<g.length;++e)!function(b){a.log[b]=function(c,d){var e=Array.prototype.slice.call(arguments).slice(2),f={timestamp:new Date,level:b,category:c,message:d,arguments:e};a.log.logMessage(f)}}(g[e]);if(a.log.makeLogger=function(b){var c={flags:0,f:b};return a.log.setLevel(c,"none"),c},a.log.setLevel=function(b,c){var d=!1;if(b&&!(b.flags&a.log.LEVEL_LOCKED))for(var e=0;e<a.log.levels.length;++e){var f=a.log.levels[e];if(c==f){b.level=c,d=!0;break}}return d},a.log.lock=function(b,c){"undefined"==typeof c||c?b.flags|=a.log.LEVEL_LOCKED:b.flags&=~a.log.LEVEL_LOCKED},a.log.addLogger=function(a){c.push(a)},"undefined"!=typeof console&&"log"in console){var h;if(console.error&&console.warn&&console.info&&console.debug){var i={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},j=function(b,c){a.log.prepareStandard(c);var d=i[c.level],e=[c.standard];e=e.concat(c.arguments.slice()),d.apply(console,e)};h=a.log.makeLogger(j)}else{var j=function(b,c){a.log.prepareStandardFull(c),console.log(c.standardFull)};h=a.log.makeLogger(j)}a.log.setLevel(h,"debug"),a.log.addLogger(h),d=h}else console={log:function(){}};if(null!==d){var k=a.util.getQueryVariables();if("console.level"in k&&a.log.setLevel(d,k["console.level"].slice(-1)[0]),"console.lock"in k){var l=k["console.lock"].slice(-1)[0];"true"==l&&a.log.lock(d)}}a.log.consoleLogger=d}var d="log";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/log",["require","module","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b=a.asn1,c=a.pkcs7=a.pkcs7||{};c.messageFromPem=function(d){var e=a.pem.decode(d)[0];if("PKCS7"!==e.type){var f=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw f.headerType=e.type,f}if(e.procType&&"ENCRYPTED"===e.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var g=b.fromDer(e.body);return c.messageFromAsn1(g)},c.messageToPem=function(c,d){var e={type:"PKCS7",body:b.toDer(c.toAsn1()).getBytes()};return a.pem.encode(e,{maxline:d})},c.messageFromAsn1=function(d){var e={},f=[];if(!b.validate(d,c.asn1.contentInfoValidator,e,f)){var g=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw g.errors=f,g}var h,i=b.derToOid(e.contentType);switch(i){case a.pki.oids.envelopedData:h=c.createEnvelopedData();break;case a.pki.oids.encryptedData:h=c.createEncryptedData();break;case a.pki.oids.signedData:h=c.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+i+" is not (yet) supported.")}return h.fromAsn1(e.content.value[0]),h};var d=function(d){var e={},f=[];if(!b.validate(d,c.asn1.recipientInfoValidator,e,f)){var g=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 EnvelopedData.");throw g.errors=f,g}return{version:e.version.charCodeAt(0),issuer:a.pki.RDNAttributesAsArray(e.issuer),serialNumber:a.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:b.derToOid(e.encAlgorithm),parameter:e.encParameter.value,content:e.encKey}}},e=function(c){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(c.version).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[a.pki.distinguishedNameToAsn1({attributes:c.issuer}),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,a.util.hexToBytes(c.serialNumber))]),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(c.encryptedContent.algorithm).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")]),b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,c.encryptedContent.content)])},f=function(a){for(var b=[],c=0;c<a.length;c++)b.push(d(a[c]));return b},g=function(a){for(var b=[],c=0;c<a.length;c++)b.push(e(a[c]));return b},h=function(c){return[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(a.pki.oids.data).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(c.algorithm).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,c.parameter.getBytes())]),b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,c.content.getBytes())])]},i=function(c,d,e){var f={},g=[];if(!b.validate(d,e,f,g)){var h=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw h.errors=h,h}var i=b.derToOid(f.contentType);if(i!==a.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(f.encryptedContent){var j="";if(a.util.isArray(f.encryptedContent))for(var k=0;k<f.encryptedContent.length;++k){if(f.encryptedContent[k].type!==b.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");j+=f.encryptedContent[k].value}else j=f.encryptedContent;c.encryptedContent={algorithm:b.derToOid(f.encAlgorithm),parameter:a.util.createBuffer(f.encParameter.value),content:a.util.createBuffer(j)}}if(f.content){var j="";if(a.util.isArray(f.content))for(var k=0;k<f.content.length;++k){if(f.content[k].type!==b.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");j+=f.content[k].value}else j=f.content;c.content=a.util.createBuffer(j)}return c.version=f.version.charCodeAt(0),c.rawCapture=f,f},j=function(b){if(void 0===b.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===b.content){var c;switch(b.encryptedContent.algorithm){case a.pki.oids["aes128-CBC"]:case a.pki.oids["aes192-CBC"]:case a.pki.oids["aes256-CBC"]:c=a.aes.createDecryptionCipher(b.encryptedContent.key);break;case a.pki.oids.desCBC:case a.pki.oids["des-EDE3-CBC"]:c=a.des.createDecryptionCipher(b.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+b.encryptedContent.algorithm)}if(c.start(b.encryptedContent.parameter),c.update(b.encryptedContent.content),!c.finish())throw new Error("Symmetric decryption failed.");b.content=c.output}};c.createSignedData=function(){var d=null;return d={type:a.pki.oids.signedData,version:1,certificates:[],crls:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(b){i(d,b,c.asn1.signedDataValidator),d.certificates=[],d.crls=[],d.digestAlgorithmIdentifiers=[],d.contentInfo=null,d.signerInfos=[];for(var e=d.rawCapture.certificates.value,f=0;f<e.length;++f)d.certificates.push(a.pki.certificateFromAsn1(e[f]))},toAsn1:function(){if("content"in d)throw new Error("Signing PKCS#7 content not yet implemented.");d.contentInfo||d.sign();for(var c=[],e=0;e<d.certificates.length;++e)c.push(a.pki.certificateToAsn1(d.certificates[0]));var f=[];return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(d.type).getBytes()),b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(d.version).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SET,!0,d.digestAlgorithmIdentifiers),d.contentInfo,b.create(b.Class.CONTEXT_SPECIFIC,0,!0,c),b.create(b.Class.CONTEXT_SPECIFIC,1,!0,f),b.create(b.Class.UNIVERSAL,b.Type.SET,!0,d.signerInfos)])])])},sign:function(c){if("content"in d)throw new Error("PKCS#7 signing not yet implemented.");"object"!=typeof d.content&&(d.contentInfo=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(a.pki.oids.data).getBytes())]),"content"in d&&d.contentInfo.value.push(b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,d.content)])))},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(b){"string"==typeof b&&(b=a.pki.certificateFromPem(b)),d.certificates.push(b)},addCertificateRevokationList:function(a){throw new Error("PKCS#7 CRL support not yet implemented.")}}},c.createEncryptedData=function(){var b=null;return b={type:a.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:a.pki.oids["aes256-CBC"]},fromAsn1:function(a){i(b,a,c.asn1.encryptedDataValidator)},decrypt:function(a){void 0!==a&&(b.encryptedContent.key=a),j(b)}}},c.createEnvelopedData=function(){var d=null;return d={type:a.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:a.pki.oids["aes256-CBC"]},fromAsn1:function(a){var b=i(d,a,c.asn1.envelopedDataValidator);d.recipients=f(b.recipientInfos.value)},toAsn1:function(){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(d.type).getBytes()),b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(d.version).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SET,!0,g(d.recipients)),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,h(d.encryptedContent))])])])},findRecipient:function(a){for(var b=a.issuer.attributes,c=0;c<d.recipients.length;++c){var e=d.recipients[c],f=e.issuer;if(e.serialNumber===a.serialNumber&&f.length===b.length){for(var g=!0,h=0;h<b.length;++h)if(f[h].type!==b[h].type||f[h].value!==b[h].value){
g=!1;break}if(g)return e}}return null},decrypt:function(b,c){if(void 0===d.encryptedContent.key&&void 0!==b&&void 0!==c)switch(b.encryptedContent.algorithm){case a.pki.oids.rsaEncryption:case a.pki.oids.desCBC:var e=c.decrypt(b.encryptedContent.content);d.encryptedContent.key=a.util.createBuffer(e);break;default:throw new Error("Unsupported asymmetric cipher, OID "+b.encryptedContent.algorithm)}j(d)},addRecipient:function(b){d.recipients.push({version:0,issuer:b.issuer.attributes,serialNumber:b.serialNumber,encryptedContent:{algorithm:a.pki.oids.rsaEncryption,key:b.publicKey}})},encrypt:function(b,c){if(void 0===d.encryptedContent.content){c=c||d.encryptedContent.algorithm,b=b||d.encryptedContent.key;var e,f,g;switch(c){case a.pki.oids["aes128-CBC"]:e=16,f=16,g=a.aes.createEncryptionCipher;break;case a.pki.oids["aes192-CBC"]:e=24,f=16,g=a.aes.createEncryptionCipher;break;case a.pki.oids["aes256-CBC"]:e=32,f=16,g=a.aes.createEncryptionCipher;break;case a.pki.oids["des-EDE3-CBC"]:e=24,f=8,g=a.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+c)}if(void 0===b)b=a.util.createBuffer(a.random.getBytes(e));else if(b.length()!=e)throw new Error("Symmetric key has wrong length; got "+b.length()+" bytes, expected "+e+".");d.encryptedContent.algorithm=c,d.encryptedContent.key=b,d.encryptedContent.parameter=a.util.createBuffer(a.random.getBytes(f));var h=g(b);if(h.start(d.encryptedContent.parameter.copy()),h.update(d.content),!h.finish())throw new Error("Symmetric encryption failed.");d.encryptedContent.content=h.output}for(var i=0;i<d.recipients.length;i++){var j=d.recipients[i];if(void 0===j.encryptedContent.content)switch(j.encryptedContent.algorithm){case a.pki.oids.rsaEncryption:j.encryptedContent.content=j.encryptedContent.key.encrypt(d.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+j.encryptedContent.algorithm)}}}}}}var d="pkcs7";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs7",["require","module","./aes","./asn1","./des","./oids","./pem","./pkcs7asn1","./random","./util","./x509"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){function b(b,c){var d=c.toString(16);d[0]>="8"&&(d="00"+d);var e=a.util.hexToBytes(d);b.putInt32(e.length),b.putBytes(e)}function c(a,b){a.putInt32(b.length),a.putString(b)}function d(){for(var b=a.md.sha1.create(),c=arguments.length,d=0;d<c;++d)b.update(arguments[d]);return b.digest()}var e=a.ssh=a.ssh||{};e.privateKeyToPutty=function(e,f,g){g=g||"",f=f||"";var h="ssh-rsa",i=""===f?"none":"aes256-cbc",j="PuTTY-User-Key-File-2: "+h+"\r\n";j+="Encryption: "+i+"\r\n",j+="Comment: "+g+"\r\n";var k=a.util.createBuffer();c(k,h),b(k,e.e),b(k,e.n);var l=a.util.encode64(k.bytes(),64),m=Math.floor(l.length/66)+1;j+="Public-Lines: "+m+"\r\n",j+=l;var n=a.util.createBuffer();b(n,e.d),b(n,e.p),b(n,e.q),b(n,e.qInv);var o;if(f){var p=n.length()+16-1;p-=p%16;var q=d(n.bytes());q.truncate(q.length()-p+n.length()),n.putBuffer(q);var r=a.util.createBuffer();r.putBuffer(d("\0\0\0\0",f)),r.putBuffer(d("\0\0\0",f));var s=a.aes.createEncryptionCipher(r.truncate(8),"CBC");s.start(a.util.createBuffer().fillWithByte(0,16)),s.update(n.copy()),s.finish();var t=s.output;t.truncate(16),o=a.util.encode64(t.bytes(),64)}else o=a.util.encode64(n.bytes(),64);m=Math.floor(o.length/66)+1,j+="\r\nPrivate-Lines: "+m+"\r\n",j+=o;var u=d("putty-private-key-file-mac-key",f),v=a.util.createBuffer();c(v,h),c(v,i),c(v,g),v.putInt32(k.length()),v.putBuffer(k),v.putInt32(n.length()),v.putBuffer(n);var w=a.hmac.create();return w.start("sha1",u),w.update(v.bytes()),j+="\r\nPrivate-MAC: "+w.digest().toHex()+"\r\n"},e.publicKeyToOpenSSH=function(d,e){var f="ssh-rsa";e=e||"";var g=a.util.createBuffer();return c(g,f),b(g,d.e),b(g,d.n),f+" "+a.util.encode64(g.bytes())+" "+e},e.privateKeyToOpenSSH=function(b,c){return c?a.pki.encryptRsaPrivateKey(b,c,{legacy:!0,algorithm:"aes128"}):a.pki.privateKeyToPem(b)},e.getPublicKeyFingerprint=function(d,e){e=e||{};var f=e.md||a.md.md5.create(),g="ssh-rsa",h=a.util.createBuffer();c(h,g),b(h,d.e),b(h,d.n),f.start(),f.update(h.getBytes());var i=f.digest();if("hex"===e.encoding){var j=i.toHex();return e.delimiter?j.match(/.{2}/g).join(e.delimiter):j}if("binary"===e.encoding)return i.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".');return i}}var d="ssh";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/ssh",["require","module","./aes","./hmac","./md5","./sha1","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function a(a){var b="forge.task",c=0,d={},e=0;a.debug.set(b,"tasks",d);var f={};a.debug.set(b,"queues",f);var g="?",h=30,i=20,j="ready",k="running",l="blocked",m="sleeping",n="done",o="error",p="stop",q="start",r="block",s="unblock",t="sleep",u="wakeup",v="cancel",w="fail",x={};x[j]={},x[j][p]=j,x[j][q]=k,x[j][v]=n,x[j][w]=o,x[k]={},x[k][p]=j,x[k][q]=k,x[k][r]=l,x[k][s]=k,x[k][t]=m,x[k][u]=k,x[k][v]=n,x[k][w]=o,x[l]={},x[l][p]=l,x[l][q]=l,x[l][r]=l,x[l][s]=l,x[l][t]=l,x[l][u]=l,x[l][v]=n,x[l][w]=o,x[m]={},x[m][p]=m,x[m][q]=m,x[m][r]=m,x[m][s]=m,x[m][t]=m,x[m][u]=m,x[m][v]=n,x[m][w]=o,x[n]={},x[n][p]=n,x[n][q]=n,x[n][r]=n,x[n][s]=n,x[n][t]=n,x[n][u]=n,x[n][v]=n,x[n][w]=o,x[o]={},x[o][p]=o,x[o][q]=o,x[o][r]=o,x[o][s]=o,x[o][t]=o,x[o][u]=o,x[o][v]=o,x[o][w]=o;var y=function(f){this.id=-1,this.name=f.name||g,this.parent=f.parent||null,this.run=f.run,this.subtasks=[],this.error=!1,this.state=j,this.blocks=0,this.timeoutId=null,this.swapTime=null,this.userData=null,this.id=e++,d[this.id]=this,c>=1&&a.log.verbose(b,"[%s][%s] init",this.id,this.name,this)};y.prototype.debug=function(c){c=c||"",a.log.debug(b,c,"[%s][%s] task:",this.id,this.name,this,"subtasks:",this.subtasks.length,"queue:",f)},y.prototype.next=function(a,b){"function"==typeof a&&(b=a,a=this.name);var c=new y({run:b,name:a,parent:this});return c.state=k,c.type=this.type,c.successCallback=this.successCallback||null,c.failureCallback=this.failureCallback||null,this.subtasks.push(c),this},y.prototype.parallel=function(b,c){return a.util.isArray(b)&&(c=b,b=this.name),this.next(b,function(d){var e=d;e.block(c.length);for(var f=function(b,d){a.task.start({type:b,run:function(a){c[d](a)},success:function(a){e.unblock()},failure:function(a){e.unblock()}})},g=0;g<c.length;g++){var h=b+"__parallel-"+d.id+"-"+g,i=g;f(h,i)}})},y.prototype.stop=function(){this.state=x[this.state][p]},y.prototype.start=function(){this.error=!1,this.state=x[this.state][q],this.state===k&&(this.start=new Date,this.run(this),A(this,0))},y.prototype.block=function(a){a="undefined"==typeof a?1:a,this.blocks+=a,this.blocks>0&&(this.state=x[this.state][r])},y.prototype.unblock=function(a){return a="undefined"==typeof a?1:a,this.blocks-=a,0===this.blocks&&this.state!==n&&(this.state=k,A(this,0)),this.blocks},y.prototype.sleep=function(a){a="undefined"==typeof a?0:a,this.state=x[this.state][t];var b=this;this.timeoutId=setTimeout(function(){b.timeoutId=null,b.state=k,A(b,0)},a)},y.prototype.wait=function(a){a.wait(this)},y.prototype.wakeup=function(){this.state===m&&(cancelTimeout(this.timeoutId),this.timeoutId=null,this.state=k,A(this,0))},y.prototype.cancel=function(){this.state=x[this.state][v],this.permitsNeeded=0,null!==this.timeoutId&&(cancelTimeout(this.timeoutId),this.timeoutId=null),this.subtasks=[]},y.prototype.fail=function(a){if(this.error=!0,B(this,!0),a)a.error=this.error,a.swapTime=this.swapTime,a.userData=this.userData,A(a,0);else{if(null!==this.parent){for(var b=this.parent;null!==b.parent;)b.error=this.error,b.swapTime=this.swapTime,b.userData=this.userData,b=b.parent;B(b,!0)}this.failureCallback&&this.failureCallback(this)}};var z=function(a){a.error=!1,a.state=x[a.state][q],setTimeout(function(){a.state===k&&(a.swapTime=+new Date,a.run(a),A(a,0))},0)},A=function(a,b){var c=b>h||+new Date-a.swapTime>i,d=function(b){if(b++,a.state===k)if(c&&(a.swapTime=+new Date),a.subtasks.length>0){var d=a.subtasks.shift();d.error=a.error,d.swapTime=a.swapTime,d.userData=a.userData,d.run(d),d.error||A(d,b)}else B(a),a.error||null!==a.parent&&(a.parent.error=a.error,a.parent.swapTime=a.swapTime,a.parent.userData=a.userData,A(a.parent,b))};c?setTimeout(d,0):d(b)},B=function(e,g){e.state=n,delete d[e.id],c>=1&&a.log.verbose(b,"[%s][%s] finish",e.id,e.name,e),null===e.parent&&(e.type in f?0===f[e.type].length?a.log.error(b,"[%s][%s] task queue empty [%s]",e.id,e.name,e.type):f[e.type][0]!==e?a.log.error(b,"[%s][%s] task not first in queue [%s]",e.id,e.name,e.type):(f[e.type].shift(),0===f[e.type].length?(c>=1&&a.log.verbose(b,"[%s][%s] delete queue [%s]",e.id,e.name,e.type),delete f[e.type]):(c>=1&&a.log.verbose(b,"[%s][%s] queue start next [%s] remain:%s",e.id,e.name,e.type,f[e.type].length),f[e.type][0].start())):a.log.error(b,"[%s][%s] task queue missing [%s]",e.id,e.name,e.type),g||(e.error&&e.failureCallback?e.failureCallback(e):!e.error&&e.successCallback&&e.successCallback(e)))};a.task=a.task||{},a.task.start=function(d){var e=new y({run:d.run,name:d.name||g});e.type=d.type,e.successCallback=d.success||null,e.failureCallback=d.failure||null,e.type in f?f[d.type].push(e):(c>=1&&a.log.verbose(b,"[%s][%s] create queue [%s]",e.id,e.name,e.type),f[e.type]=[e],z(e))},a.task.cancel=function(a){a in f&&(f[a]=[f[a][0]])},a.task.createCondition=function(){var a={tasks:{}};return a.wait=function(b){b.id in a.tasks||(b.block(),a.tasks[b.id]=b)},a.notify=function(){var b=a.tasks;a.tasks={};for(var c in b)b[c].unblock()},a}}var d="task";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),a(forge);var e=!0;c=function(a,c){c(b,module)}}var f,g=function(b,c){c.exports=function(c){var e=f.map(function(a){return b(a)}).concat(a);if(c=c||{},c.defined=c.defined||{},c.defined[d])return c[d];c.defined[d]=!0;for(var g=0;g<e.length;++g)e[g](c);return c[d]}},h=c;(c=function(a,b){return f="string"==typeof a?b.slice(2):a.slice(2),e?(delete c,h.apply(null,Array.prototype.slice.call(arguments,0))):(c=h,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/task",["require","module","./debug","./log","./util"],function(){g.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){var a="forge";if("function"!=typeof c){if("object"!=typeof module||!module.exports)return void("undefined"==typeof forge&&(forge={disableNativeCode:!1}));var d=!0;c=function(a,c){c(b,module)}}var e,f=function(b,c){c.exports=function(c){var d=e.map(function(a){return b(a)});if(c=c||{},c.defined=c.defined||{},c.defined[a])return c[a];c.defined[a]=!0;for(var f=0;f<d.length;++f)d[f](c);return c},c.exports.disableNativeCode=!1,c.exports(c.exports)},g=c;(c=function(a,b){return e="string"==typeof a?b.slice(2):a.slice(2),d?(delete c,g.apply(null,Array.prototype.slice.call(arguments,0))):(c=g,c.apply(null,Array.prototype.slice.call(arguments,0)))})("js/forge",["require","module","./aes","./aesCipherSuites","./asn1","./cipher","./cipherModes","./debug","./des","./hmac","./kem","./log","./md","./mgf1","./pbkdf2","./pem","./pkcs7","./pkcs1","./pkcs12","./pki","./prime","./prng","./pss","./random","./rc2","./ssh","./task","./tls","./util"],function(){f.apply(null,Array.prototype.slice.call(arguments,0))})}(),b("js/forge")});var idbModules={util:{cleanInterface:!1}};!function(){"use strict";var a={test:!0};if(Object.defineProperty)try{Object.defineProperty(a,"test",{enumerable:!1}),a.test&&(idbModules.util.cleanInterface=!0)}catch(a){}}(),function(a){"use strict";function b(a,b,c){c.target=b,"function"==typeof b[a]&&b[a].apply(b,[c])}var c=function(){this.length=0,this._items=[],a.util.cleanInterface&&Object.defineProperty(this,"_items",{enumerable:!1})};if(c.prototype={contains:function(a){return-1!==this._items.indexOf(a)},item:function(a){return this._items[a]},indexOf:function(a){return this._items.indexOf(a)},push:function(a){this._items.push(a),this.length+=1;for(var b=0;b<this._items.length;b++)this[b]=this._items[b]},splice:function(){this._items.splice.apply(this._items,arguments),this.length=this._items.length;for(var a in this)a===String(parseInt(a,10))&&delete this[a];for(a=0;a<this._items.length;a++)this[a]=this._items[a]}},a.util.cleanInterface)for(var d in{indexOf:!1,push:!1,splice:!1})Object.defineProperty(c.prototype,d,{enumerable:!1});a.util.callback=b,a.util.StringList=c,a.util.quote=function(a){return'"'+a+'"'}}(idbModules),function(a){"use strict";function b(){(navigator.userAgent.match(/MSIE/)||navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/))&&c()}function c(){var a=IDBFactory.prototype.cmp,b=IDBDatabase.prototype.createObjectStore,c=IDBObjectStore.prototype.createIndex,f=IDBObjectStore.prototype.add,j=IDBObjectStore.prototype.put,k=IDBIndex.prototype.get,l=IDBIndex.prototype.getKey,m=IDBIndex.prototype.openCursor,n=IDBIndex.prototype.openKeyCursor,o=IDBObjectStore.prototype.get,p=IDBObjectStore.prototype.delete,q=IDBObjectStore.prototype.openCursor,r=IDBObjectStore.prototype.openKeyCursor,s=IDBKeyRange.bound,t=IDBKeyRange.upperBound,u=IDBKeyRange.lowerBound,v=IDBKeyRange.only,w=Object.getOwnPropertyDescriptor(IDBRequest.prototype,"result"),x=Object.getOwnPropertyDescriptor(IDBCursor.prototype,"primaryKey"),y=Object.getOwnPropertyDescriptor(IDBCursor.prototype,"key"),z=Object.getOwnPropertyDescriptor(IDBCursorWithValue.prototype,"value");IDBFactory.prototype.cmp=function(b,c){var d=Array.prototype.slice.call(arguments);return b instanceof Array&&(d[0]=i(b)),c instanceof Array&&(d[1]=i(c)),a.apply(this,d)},IDBDatabase.prototype.createObjectStore=function(a,c){return c&&c.keyPath instanceof Array&&(c.keyPath=e(c.keyPath)),b.apply(this,arguments)},IDBObjectStore.prototype.createIndex=function(a,b,d){var f=Array.prototype.slice.call(arguments);return b instanceof Array&&(f[1]=e(b)),c.apply(this,f)},IDBObjectStore.prototype.add=function(a,b){return this.__insertData(f,arguments)},IDBObjectStore.prototype.put=function(a,b){return this.__insertData(j,arguments)},IDBObjectStore.prototype.__insertData=function(a,b){b=Array.prototype.slice.call(b);var c=b[0],e=b[1];if(e instanceof Array&&(b[1]=i(e)),"object"==typeof c){d(this.keyPath)&&g(c,this.keyPath);for(var f=0;f<this.indexNames.length;f++){var h=this.index(this.indexNames[f]);if(d(h.keyPath))try{g(c,h.keyPath)}catch(a){}}}return a.apply(this,b)},IDBIndex.prototype.get=function(a){var b=Array.prototype.slice.call(arguments);return a instanceof Array&&(b[0]=i(a)),k.apply(this,b)},IDBIndex.prototype.getKey=function(a){var b=Array.prototype.slice.call(arguments);return a instanceof Array&&(b[0]=i(a)),l.apply(this,b)},IDBIndex.prototype.openCursor=function(a){var b=Array.prototype.slice.call(arguments);return a instanceof Array&&(b[0]=i(a)),m.apply(this,b)},IDBIndex.prototype.openKeyCursor=function(a){var b=Array.prototype.slice.call(arguments);return a instanceof Array&&(b[0]=i(a)),n.apply(this,b)},IDBObjectStore.prototype.get=function(a){var b=Array.prototype.slice.call(arguments);return a instanceof Array&&(b[0]=i(a)),o.apply(this,b)},IDBObjectStore.prototype.delete=function(a){var b=Array.prototype.slice.call(arguments);return a instanceof Array&&(b[0]=i(a)),p.apply(this,b)},IDBObjectStore.prototype.openCursor=function(a){var b=Array.prototype.slice.call(arguments);return a instanceof Array&&(b[0]=i(a)),q.apply(this,b)},IDBObjectStore.prototype.openKeyCursor=function(a){var b=Array.prototype.slice.call(arguments);return a instanceof Array&&(b[0]=i(a)),r.apply(this,b)},IDBKeyRange.bound=function(a,b,c,d){var e=Array.prototype.slice.call(arguments);return a instanceof Array&&(e[0]=i(a)),b instanceof Array&&(e[1]=i(b)),s.apply(IDBKeyRange,e)},IDBKeyRange.upperBound=function(a,b){var c=Array.prototype.slice.call(arguments);return a instanceof Array&&(c[0]=i(a)),t.apply(IDBKeyRange,c)},IDBKeyRange.lowerBound=function(a,b){var c=Array.prototype.slice.call(arguments);return a instanceof Array&&(c[0]=i(a)),u.apply(IDBKeyRange,c)},IDBKeyRange.only=function(a){var b=Array.prototype.slice.call(arguments);return a instanceof Array&&(b[0]=i(a)),v.apply(IDBKeyRange,b)},Object.defineProperty(IDBRequest.prototype,"result",{enumerable:w.enumerable,configurable:w.configurable,get:function(){var a=w.get.call(this);return h(a)}}),Object.defineProperty(IDBCursor.prototype,"primaryKey",{enumerable:x.enumerable,configurable:x.configurable,get:function(){var a=x.get.call(this);return h(a)}}),Object.defineProperty(IDBCursor.prototype,"key",{enumerable:y.enumerable,configurable:y.configurable,get:function(){var a=y.get.call(this);return h(a)}}),Object.defineProperty(IDBCursorWithValue.prototype,"value",{enumerable:z.enumerable,configurable:z.configurable,get:function(){var a=z.get.call(this);return h(a)}});try{IDBTransaction.VERSION_CHANGE||(IDBTransaction.VERSION_CHANGE="versionchange")}catch(a){}}function d(a){return a&&0===a.indexOf(l+".")}function e(a){for(var b=0;b<a.length;b++)a[b]=a[b].replace(/\./g,n);return l+"."+a.join(o)}function f(a){a=a.substr(l.length+1),a=a.split(o);for(var b=0;b<a.length;b++)a[b]=a[b].replace(m,".");return a}function g(b,c){var d=f(c),e=a.Key.getValue(b,d),g=i(e);c=c.substr(l.length+1),b[l]=b[l]||{},b[l][c]=g}function h(a){return"string"==typeof a&&d(a)?j(a):(a&&"object"==typeof a[l]&&delete a[l],a)}function i(b){return a.Key.validate(b),b=a.Key.encode(b),b=l+"."+b,k(b),b}function j(b){return k(b),b=b.substr(l.length+1),b=a.Key.decode(b)}function k(b){if(b.length>889)throw a.util.createDOMException("DataError","The encoded key is "+b.length+" characters long, but IE only allows 889 characters. Consider replacing numeric keys with strings to reduce the encoded length.")}var l="__$$compoundKey",m=/\$\$/g,n="$$$$",o="$_$";a.polyfill=b}(idbModules),function(idbModules){"use strict";var Sca=function(){return{decycle:function(object,callback){function checkForCompletion(){0===queuedObjects.length&&returnCallback(derezObj)}function readBlobAsDataURL(a,b){var c=new FileReader;c.onloadend=function(c){var d=c.target.result,e="Blob";a instanceof File,updateEncodedBlob(d,b,e)},c.readAsDataURL(a)}function updateEncodedBlob(dataURL,path,blobtype){var encoded=queuedObjects.indexOf(path);path=path.replace("$","derezObj"),eval(path+'.$enc="'+dataURL+'"'),eval(path+'.$type="'+blobtype+'"'),queuedObjects.splice(encoded,1),checkForCompletion()}function derez(a,b){var c,d,e;if(!("object"!=typeof a||null===a||a instanceof Boolean||a instanceof Date||a instanceof Number||a instanceof RegExp||a instanceof Blob||a instanceof String)){for(c=0;c<objects.length;c+=1)if(objects[c]===a)return{$ref:paths[c]};if(objects.push(a),paths.push(b),"[object Array]"===Object.prototype.toString.apply(a))for(e=[],c=0;c<a.length;c+=1)e[c]=derez(a[c],b+"["+c+"]");else{e={};for(d in a)Object.prototype.hasOwnProperty.call(a,d)&&(e[d]=derez(a[d],b+"["+JSON.stringify(d)+"]"))}return e}return a instanceof Blob?(queuedObjects.push(b),readBlobAsDataURL(a,b)):a instanceof Boolean?a={$type:"Boolean",$enc:a.toString()}:a instanceof Date?a={$type:"Date",$enc:a.getTime()}:a instanceof Number?a={$type:"Number",$enc:a.toString()}:a instanceof RegExp?a={$type:"RegExp",$enc:a.toString()}:"number"==typeof a?a={$type:"number",$enc:a+""}:void 0===a&&(a={$type:"undefined"}),a}var objects=[],paths=[],queuedObjects=[],returnCallback=callback,derezObj=derez(object,"$");checkForCompletion()},retrocycle:function retrocycle($){function dataURLToBlob(a){var b,c,d,e=";base64,";if(-1===a.indexOf(e))return c=a.split(","),b=c[0].split(":")[1],d=c[1],new Blob([d],{type:b});c=a.split(e),b=c[0].split(":")[1],d=window.atob(c[1]);for(var f=d.length,g=new Uint8Array(f),h=0;f>h;++h)g[h]=d.charCodeAt(h);return new Blob([g.buffer],{type:b})}function rez(value){var i,item,name,path;if(value&&"object"==typeof value)if("[object Array]"===Object.prototype.toString.apply(value))for(i=0;i<value.length;i+=1)item=value[i],item&&"object"==typeof item&&(path=item.$ref,"string"==typeof path&&px.test(path)?value[i]=eval(path):value[i]=rez(item));else if(void 0!==value.$type)switch(value.$type){case"Blob":case"File":value=dataURLToBlob(value.$enc);break;case"Boolean":value=Boolean("true"===value.$enc);break;case"Date":value=new Date(value.$enc);break;case"Number":value=Number(value.$enc);break;case"RegExp":value=eval(value.$enc);break;case"number":value=parseFloat(value.$enc);break;case"undefined":value=void 0}else for(name in value)"object"==typeof value[name]&&(item=value[name],item&&(path=item.$ref,"string"==typeof path&&px.test(path)?value[name]=eval(path):value[name]=rez(item)));return value}var px=/^\$(?:\[(?:\d+|\"(?:[^\\\"\u0000-\u001f]|\\([\\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*\")\])*$/;return rez($)},encode:function(a,b){function c(a){b(JSON.stringify(a))}this.decycle(a,c)},decode:function(a){return this.retrocycle(JSON.parse(a))}}}();idbModules.Sca=Sca}(idbModules),function(idbModules){"use strict";function padBase32Exponent(a){return a=a.toString(32),1===a.length?"0"+a:a}function padBase32Mantissa(a){return(a+zeros(11)).slice(0,11)}function flipBase32(a){for(var b="",c=0;c<a.length;c++)b+=(31-parseInt(a[c],32)).toString(32);return b}function pow32(a,b){var c,d,e;return b=parseInt(b,32),0>b?roundToPrecision(parseInt(a,32)*Math.pow(32,b-10)):11>b?(c=a.slice(0,b),c=parseInt(c,32),d=a.slice(b),d=parseInt(d,32)*Math.pow(32,b-11),roundToPrecision(c+d)):(e=a+zeros(b-11),parseInt(e,32))}function roundToPrecision(a,b){return b=b||16,parseFloat(a.toPrecision(b))}function zeros(a){for(var b="";a--;)b+="0";return b}function negate(a){return"-"+a}function getType(a){return a instanceof Date?"date":a instanceof Array?"array":typeof a}function validate(a){var b=getType(a);if("array"===b)for(var c=0;c<a.length;c++)validate(a[c]);else if(!types[b]||"string"!==b&&isNaN(a))throw idbModules.util.createDOMException("DataError","Not a valid key")}function getValue(source,keyPath){try{if(keyPath instanceof Array){for(var arrayValue=[],i=0;i<keyPath.length;i++)arrayValue.push(eval("source."+keyPath[i]));return arrayValue}return eval("source."+keyPath)}catch(a){return}}function setValue(a,b,c){for(var d=b.split("."),e=0;e<d.length-1;e++){var f=d[e];a=a[f]=a[f]||{}}a[d[d.length-1]]=c}function isMultiEntryMatch(a,b){var c=collations[b.substring(0,1)];return"array"===c?b.indexOf(a)>1:b===a}function isKeyInRange(a,b){var c=void 0===b.lower,d=void 0===b.upper,e=idbModules.Key.encode(a,!0);return void 0!==b.lower&&(b.lowerOpen&&e>b.__lower&&(c=!0),!b.lowerOpen&&e>=b.__lower&&(c=!0)),void 0!==b.upper&&(b.upperOpen&&e<b.__upper&&(d=!0),!b.upperOpen&&e<=b.__upper&&(d=!0)),c&&d}function findMultiEntryMatches(a,b){var c=[];if(a instanceof Array)for(var d=0;d<a.length;d++){var e=a[d];if(e instanceof Array){if(b.lower===b.upper)continue;if(1!==e.length){var f=findMultiEntryMatches(e,b);f.length>0&&c.push(e);continue}e=e[0]}isKeyInRange(e,b)&&c.push(e)}else isKeyInRange(a,b)&&c.push(a);return c}var collations=["undefined","number","date","string","array"],signValues=["negativeInfinity","bigNegative","smallNegative","smallPositive","bigPositive","positiveInfinity"],types={undefined:{encode:function(a){return collations.indexOf("undefined")+"-"},decode:function(a){}},date:{encode:function(a){return collations.indexOf("date")+"-"+a.toJSON()},decode:function(a){return new Date(a.substring(2))}},number:{encode:function(a){var b=Math.abs(a).toString(32),c=b.indexOf(".");b=-1!==c?b.replace(".",""):b;var d=b.search(/[^0]/);b=b.slice(d);var e,f=zeros(2),g=zeros(11);return isFinite(a)?0>a?a>-1?(e=signValues.indexOf("smallNegative"),f=padBase32Exponent(d),g=flipBase32(padBase32Mantissa(b))):(e=signValues.indexOf("bigNegative"),f=flipBase32(padBase32Exponent(-1!==c?c:b.length)),g=flipBase32(padBase32Mantissa(b))):1>a?(e=signValues.indexOf("smallPositive"),f=flipBase32(padBase32Exponent(d)),g=padBase32Mantissa(b)):(e=signValues.indexOf("bigPositive"),f=padBase32Exponent(-1!==c?c:b.length),g=padBase32Mantissa(b)):e=signValues.indexOf(a>0?"positiveInfinity":"negativeInfinity"),collations.indexOf("number")+"-"+e+f+g},decode:function(a){var b=+a.substr(2,1),c=a.substr(3,2),d=a.substr(5,11);switch(signValues[b]){case"negativeInfinity":return-(1/0);case"positiveInfinity":return 1/0;case"bigPositive":return pow32(d,c);case"smallPositive":return c=negate(flipBase32(c)),pow32(d,c);case"smallNegative":return c=negate(c),d=flipBase32(d),-pow32(d,c);case"bigNegative":return c=flipBase32(c),d=flipBase32(d),-pow32(d,c);default:throw new Error("Invalid number.")}}},string:{encode:function(a,b){return b&&(a=a.replace(/(.)/g,"-$1")+" "),collations.indexOf("string")+"-"+a},decode:function(a,b){return a=a.substring(2),b&&(a=a.substr(0,a.length-1).replace(/-(.)/g,"$1")),a}},array:{encode:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=idbModules.Key.encode(d,!0);b[c]=e}return b.push(collations.indexOf("undefined")+"-"),collations.indexOf("array")+"-"+JSON.stringify(b)},decode:function(a){var b=JSON.parse(a.substring(2));b.pop();for(var c=0;c<b.length;c++){var d=b[c],e=idbModules.Key.decode(d,!0);b[c]=e}return b}}};idbModules.Key={encode:function(a,b){return void 0===a?null:types[getType(a)].encode(a,b)},decode:function(a,b){return"string"!=typeof a?void 0:types[collations[a.substring(0,1)]].decode(a,b)},validate:validate,getValue:getValue,setValue:setValue,isMultiEntryMatch:isMultiEntryMatch,findMultiEntryMatches:findMultiEntryMatches}}(idbModules),function(a){"use strict";function b(a,b){var c=new Event(a);return c.debug=b,Object.defineProperty(c,"target",{writable:!0}),c}function c(a,b){this.type=a,this.debug=b,this.bubbles=!1,this.cancelable=!1,this.eventPhase=0,this.timeStamp=(new Date).valueOf()}var d=!1;try{var e=b("test type","test debug"),f={test:"test target"};e.target=f,e instanceof Event&&"test type"===e.type&&"test debug"===e.debug&&e.target===f&&(d=!0)}catch(a){}d?(a.Event=Event,a.IDBVersionChangeEvent=Event,a.util.createEvent=b):(a.Event=c,a.IDBVersionChangeEvent=c,a.util.createEvent=function(a,b){return new c(a,b)})}(idbModules),function(a){"use strict";function b(a,b){var c=new DOMException.prototype.constructor(0,b);return c.name=a||"DOMException",c.message=b,c}function c(a,b){a=a||"DOMError";var c=new DOMError(a,b);return c.name===a||(c.name=a),c.message===b||(c.message=b),c}function d(a,b){var c=new Error(b);return c.name=a||"DOMException",c.message=b,c}a.util.logError=function(b,c,d){if(a.DEBUG){d&&d.message&&(d=d.message);var e="function"==typeof console.error?"error":"log";console[e](b+": "+c+". "+(d||"")),console.trace&&console.trace()}},a.util.findError=function(a){var b;if(a){if(1===a.length)return a[0];for(var c=0;c<a.length;c++){var d=a[c];if(d instanceof Error||d instanceof DOMException)return d;d&&"string"==typeof d.message&&(b=d)}}return b};var e,f=!1,g=!1;try{e=b("test name","test message"),e instanceof DOMException&&"test name"===e.name&&"test message"===e.message&&(f=!0)}catch(a){}try{e=c("test name","test message"),e instanceof DOMError&&"test name"===e.name&&"test message"===e.message&&(g=!0)}catch(a){}f?(a.DOMException=DOMException,a.util.createDOMException=function(c,d,e){return a.util.logError(c,d,e),b(c,d)}):(a.DOMException=Error,a.util.createDOMException=function(b,c,e){return a.util.logError(b,c,e),d(b,c)}),g?(a.DOMError=DOMError,a.util.createDOMError=function(b,d,e){return a.util.logError(b,d,e),c(b,d)}):(a.DOMError=Error,a.util.createDOMError=function(b,c,e){return a.util.logError(b,c,e),d(b,c)})}(idbModules),function(a){"use strict";function b(){this.onsuccess=this.onerror=this.result=this.error=this.source=this.transaction=null,this.readyState="pending"}function c(){this.onblocked=this.onupgradeneeded=null}c.prototype=new b,c.prototype.constructor=c,a.IDBRequest=b,a.IDBOpenDBRequest=c}(idbModules),function(a,b){"use strict";function c(c,d,e,f){c!==b&&a.Key.validate(c),d!==b&&a.Key.validate(d),this.lower=c,this.upper=d,this.lowerOpen=!!e,this.upperOpen=!!f}c.only=function(a){return new c(a,a,!1,!1)},c.lowerBound=function(a,d){return new c(a,b,d,b)},c.upperBound=function(a,d){return new c(b,a,b,d)},c.bound=function(a,b,d,e){return new c(a,b,d,e)},a.IDBKeyRange=c}(idbModules),function(a,b){"use strict";function c(c,d,e,f,g,h,i){if(null===c&&(c=b),c===b||c instanceof a.IDBKeyRange||(c=new a.IDBKeyRange(c,c,!1,!1)),e.transaction.__assertActive(),d!==b&&-1===["next","prev","nextunique","prevunique"].indexOf(d))throw new TypeError(d+"is not a valid cursor direction");this.source=f,this.direction=d||"next",this.key=b,this.primaryKey=b,this.__store=e,this.__range=c,this.__req=new a.IDBRequest,this.__keyColumnName=g,this.__valueColumnName=h,this.__valueDecoder="value"===h?a.Sca:a.Key,this.__count=i,this.__offset=-1,this.__lastKeyContinued=b,this.__multiEntryIndex=f instanceof a.IDBIndex&&f.multiEntry,this.__unique=-1!==this.direction.indexOf("unique"),c!==b&&(c.__lower=c.lower!==b&&a.Key.encode(c.lower,this.__multiEntryIndex),c.__upper=c.upper!==b&&a.Key.encode(c.upper,this.__multiEntryIndex)),this.continue()}c.prototype.__find=function(){var a=Array.prototype.slice.call(arguments);this.__multiEntryIndex?this.__findMultiEntry.apply(this,a):this.__findBasic.apply(this,a)},c.prototype.__findBasic=function(c,d,e,f,g){g=g||1;var h=this,i=a.util.quote(h.__keyColumnName),j=["SELECT * FROM",a.util.quote(h.__store.name)],k=[];j.push("WHERE",i,"NOT NULL"),!h.__range||h.__range.lower===b&&h.__range.upper===b||(j.push("AND"),h.__range.lower!==b&&(j.push(i,h.__range.lowerOpen?">":">=","?"),k.push(h.__range.__lower)),h.__range.lower!==b&&h.__range.upper!==b&&j.push("AND"),h.__range.upper!==b&&(j.push(i,h.__range.upperOpen?"<":"<=","?"),k.push(h.__range.__upper))),"undefined"!=typeof c&&(h.__lastKeyContinued=c,h.__offset=0),h.__lastKeyContinued!==b&&(j.push("AND",i,">= ?"),a.Key.validate(h.__lastKeyContinued),k.push(a.Key.encode(h.__lastKeyContinued)));var l="prev"===h.direction||"prevunique"===h.direction?"DESC":"ASC";h.__count||(j.push("ORDER BY",i,l),j.push("LIMIT",g,"OFFSET",h.__offset)),j=j.join(" "),a.DEBUG&&console.log(j,k),h.__prefetchedData=null,h.__prefetchedIndex=0,d.executeSql(j,k,function(c,d){h.__count?e(b,d.rows.length,b):d.rows.length>1?(h.__prefetchedData=d.rows,h.__prefetchedIndex=0,a.DEBUG&&console.log("Preloaded "+h.__prefetchedData.length+" records for cursor"),h.__decode(d.rows.item(0),e)):1===d.rows.length?h.__decode(d.rows.item(0),e):(a.DEBUG&&console.log("Reached end of cursors"),e(b,b,b))},function(b,c){a.DEBUG&&console.log("Could not execute Cursor.continue",j,k),f(c)})},c.prototype.__findMultiEntry=function(c,d,e,f){var g=this;if(g.__prefetchedData&&g.__prefetchedData.length===g.__prefetchedIndex)return a.DEBUG&&console.log("Reached end of multiEntry cursor"),void e(b,b,b);var h=a.util.quote(g.__keyColumnName),i=["SELECT * FROM",a.util.quote(g.__store.name)],j=[];i.push("WHERE",h,"NOT NULL"),g.__range&&g.__range.lower!==b&&g.__range.upper!==b&&0===g.__range.upper.indexOf(g.__range.lower)&&(i.push("AND",h,"LIKE ?"),j.push("%"+g.__range.__lower.slice(0,-1)+"%")),"undefined"!=typeof c&&(g.__lastKeyContinued=c,
g.__offset=0),g.__lastKeyContinued!==b&&(i.push("AND",h,">= ?"),a.Key.validate(g.__lastKeyContinued),j.push(a.Key.encode(g.__lastKeyContinued)));var k="prev"===g.direction||"prevunique"===g.direction?"DESC":"ASC";g.__count||i.push("ORDER BY key",k),i=i.join(" "),a.DEBUG&&console.log(i,j),g.__prefetchedData=null,g.__prefetchedIndex=0,d.executeSql(i,j,function(c,d){if(g.__multiEntryOffset=d.rows.length,d.rows.length>0){for(var f=[],h=0;h<d.rows.length;h++)for(var i=d.rows.item(h),j=a.Key.decode(i[g.__keyColumnName],!0),k=a.Key.findMultiEntryMatches(j,g.__range),l=0;l<k.length;l++){var m=k[l],n={matchingKey:a.Key.encode(m,!0),key:i.key};n[g.__keyColumnName]=i[g.__keyColumnName],n[g.__valueColumnName]=i[g.__valueColumnName],f.push(n)}var o=0===g.direction.indexOf("prev");f.sort(function(a,b){return a.matchingKey.replace("[","z")<b.matchingKey.replace("[","z")?o?1:-1:a.matchingKey.replace("[","z")>b.matchingKey.replace("[","z")?o?-1:1:a.key<b.key?"prev"===g.direction?1:-1:a.key>b.key?"prev"===g.direction?-1:1:0}),g.__prefetchedData={data:f,length:f.length,item:function(a){return this.data[a]}},g.__prefetchedIndex=0,g.__count?e(b,f.length,b):f.length>1?(a.DEBUG&&console.log("Preloaded "+g.__prefetchedData.length+" records for multiEntry cursor"),g.__decode(f[0],e)):1===f.length?(a.DEBUG&&console.log("Reached end of multiEntry cursor"),g.__decode(f[0],e)):(a.DEBUG&&console.log("Reached end of multiEntry cursor"),e(b,b,b))}else a.DEBUG&&console.log("Reached end of multiEntry cursor"),e(b,b,b)},function(b,c){a.DEBUG&&console.log("Could not execute Cursor.continue",i,j),f(c)})},c.prototype.__onsuccess=function(a){var c=this;return function(d,e,f){if(c.__count)a(e,c.__req);else{c.key=d===b?null:d,c.value=e===b?null:e,c.primaryKey=f===b?null:f;var g=d===b?null:c;a(g,c.__req)}}},c.prototype.__decode=function(c,d){if(this.__multiEntryIndex&&this.__unique){if(this.__matchedKeys||(this.__matchedKeys={}),this.__matchedKeys[c.matchingKey])return void d(b,b,b);this.__matchedKeys[c.matchingKey]=!0}var e=a.Key.decode(this.__multiEntryIndex?c.matchingKey:c[this.__keyColumnName],this.__multiEntryIndex),f=this.__valueDecoder.decode(c[this.__valueColumnName]),g=a.Key.decode(c.key);d(e,f,g)},c.prototype.continue=function(b){var c=a.cursorPreloadPackSize||100,d=this;this.__store.transaction.__pushToQueue(d.__req,function(a,e,f,g){return d.__offset++,d.__prefetchedData&&(d.__prefetchedIndex++,d.__prefetchedIndex<d.__prefetchedData.length)?void d.__decode(d.__prefetchedData.item(d.__prefetchedIndex),d.__onsuccess(f)):void d.__find(b,a,d.__onsuccess(f),g,c)})},c.prototype.advance=function(c){if(0>=c)throw a.util.createDOMException("Type Error","Count is invalid - 0 or negative",c);var d=this;this.__store.transaction.__pushToQueue(d.__req,function(a,e,f,g){d.__offset+=c,d.__find(b,a,d.__onsuccess(f),g)})},c.prototype.update=function(c){var d=this;return d.__store.transaction.__assertWritable(),d.__store.transaction.__addToTransactionQueue(function(e,f,g,h){a.Sca.encode(c,function(f){d.__find(b,e,function(b,i,j){var k=d.__store,l=[f],m=["UPDATE",a.util.quote(k.name),"SET value = ?"];a.Key.validate(j);for(var n=0;n<k.indexNames.length;n++){var o=k.__indexes[k.indexNames[n]],p=a.Key.getValue(c,o.keyPath);m.push(",",a.util.quote(o.name),"= ?"),l.push(a.Key.encode(p,o.multiEntry))}m.push("WHERE key = ?"),l.push(a.Key.encode(j)),a.DEBUG&&console.log(m.join(" "),f,b,j),e.executeSql(m.join(" "),l,function(a,c){d.__prefetchedData=null,d.__prefetchedIndex=0,1===c.rowsAffected?g(b):h("No rows with key found"+b)},function(a,b){h(b)})},h)})})},c.prototype.delete=function(){var c=this;return c.__store.transaction.__assertWritable(),this.__store.transaction.__addToTransactionQueue(function(d,e,f,g){c.__find(b,d,function(e,h,i){var j="DELETE FROM  "+a.util.quote(c.__store.name)+" WHERE key = ?";a.DEBUG&&console.log(j,e,i),a.Key.validate(i),d.executeSql(j,[a.Key.encode(i)],function(a,d){c.__prefetchedData=null,c.__prefetchedIndex=0,1===d.rowsAffected?(c.__offset--,f(b)):g("No rows with key found"+e)},function(a,b){g(b)})},g)})},a.IDBCursor=c}(idbModules),function(a,b){"use strict";function c(a,b){this.objectStore=a,this.name=b.columnName,this.keyPath=b.keyPath,this.multiEntry=b.optionalParams&&b.optionalParams.multiEntry,this.unique=b.optionalParams&&b.optionalParams.unique,this.__deleted=!!b.__deleted}c.__clone=function(a,b){return new c(b,{columnName:a.name,keyPath:a.keyPath,optionalParams:{multiEntry:a.multiEntry,unique:a.unique}})},c.__createIndex=function(b,d){var e=!!b.__indexes[d.name]&&b.__indexes[d.name].__deleted;b.__indexes[d.name]=d,b.indexNames.push(d.name);var f=b.transaction;f.__addToTransactionQueue(function(f,g,h,i){function j(b,c){i(a.util.createDOMException(0,'Could not create index "'+d.name+'"',c))}function k(e){c.__updateIndexList(b,e,function(){e.executeSql("SELECT * FROM "+a.util.quote(b.name),[],function(c,e){function f(g){if(g<e.rows.length)try{var i=a.Sca.decode(e.rows.item(g).value),k=a.Key.getValue(i,d.keyPath);k=a.Key.encode(k,d.multiEntry),c.executeSql("UPDATE "+a.util.quote(b.name)+" set "+a.util.quote(d.name)+" = ? where key = ?",[k,e.rows.item(g).key],function(a,b){f(g+1)},j)}catch(a){f(g+1)}else h(b)}a.DEBUG&&console.log("Adding existing "+b.name+" records to the "+d.name+" index"),f(0)},j)},j)}if(e)k(f);else{var l=["ALTER TABLE",a.util.quote(b.name),"ADD",a.util.quote(d.name),"BLOB"].join(" ");a.DEBUG&&console.log(l),f.executeSql(l,[],k,j)}})},c.__deleteIndex=function(b,d){b.__indexes[d.name].__deleted=!0,b.indexNames.splice(b.indexNames.indexOf(d.name),1);var e=b.transaction;e.__addToTransactionQueue(function(e,f,g,h){function i(b,c){h(a.util.createDOMException(0,'Could not delete index "'+d.name+'"',c))}c.__updateIndexList(b,e,g,i)})},c.__updateIndexList=function(b,c,d,e){for(var f={},g=0;g<b.indexNames.length;g++){var h=b.__indexes[b.indexNames[g]];f[h.name]={columnName:h.name,keyPath:h.keyPath,optionalParams:{unique:h.unique,multiEntry:h.multiEntry},deleted:!!h.deleted}}a.DEBUG&&console.log("Updating the index list for "+b.name,f),c.executeSql("UPDATE __sys__ set indexList = ? where name = ?",[JSON.stringify(f),b.name],function(){d(b)},e)},c.prototype.__fetchIndexData=function(c,d){var e,f,g=this;return 1===arguments.length?(d=c,e=!1):(a.Key.validate(c),f=a.Key.encode(c,g.multiEntry),e=!0),g.objectStore.transaction.__addToTransactionQueue(function(c,h,i,j){var k=["SELECT * FROM",a.util.quote(g.objectStore.name),"WHERE",a.util.quote(g.name),"NOT NULL"],l=[];e&&(g.multiEntry?(k.push("AND",a.util.quote(g.name),"LIKE ?"),l.push("%"+f+"%")):(k.push("AND",a.util.quote(g.name),"= ?"),l.push(f))),a.DEBUG&&console.log("Trying to fetch data for Index",k.join(" "),l),c.executeSql(k.join(" "),l,function(c,h){var j=0,k=null;if(g.multiEntry)for(var l=0;l<h.rows.length;l++){var m=h.rows.item(l),n=a.Key.decode(m[g.name]);e&&a.Key.isMultiEntryMatch(f,m[g.name])?(j++,k=k||m):e||n===b||(j+=n instanceof Array?n.length:1,k=k||m)}else j=h.rows.length,k=j&&h.rows.item(0);i("count"===d?j:0===j?b:"key"===d?a.Key.decode(k.key):a.Sca.decode(k.value))},j)})},c.prototype.openCursor=function(b,c){return new a.IDBCursor(b,c,this.objectStore,this,this.name,"value").__req},c.prototype.openKeyCursor=function(b,c){return new a.IDBCursor(b,c,this.objectStore,this,this.name,"key").__req},c.prototype.get=function(a){if(0===arguments.length)throw new TypeError("No key was specified");return this.__fetchIndexData(a,"value")},c.prototype.getKey=function(a){if(0===arguments.length)throw new TypeError("No key was specified");return this.__fetchIndexData(a,"key")},c.prototype.count=function(c){return c===b?this.__fetchIndexData("count"):c instanceof a.IDBKeyRange?new a.IDBCursor(c,"next",this.objectStore,this,this.name,"value",!0).__req:this.__fetchIndexData(c,"count")},a.IDBIndex=c}(idbModules),function(a){"use strict";function b(b,c){this.name=b.name,this.keyPath=JSON.parse(b.keyPath),this.transaction=c,this.autoIncrement="string"==typeof b.autoInc?"true"===b.autoInc:!!b.autoInc,this.__indexes={},this.indexNames=new a.util.StringList;var d=JSON.parse(b.indexList);for(var e in d)if(d.hasOwnProperty(e)){var f=new a.IDBIndex(this,d[e]);this.__indexes[f.name]=f,f.__deleted||this.indexNames.push(f.name)}}b.__clone=function(a,c){var d=new b({name:a.name,keyPath:JSON.stringify(a.keyPath),autoInc:JSON.stringify(a.autoIncrement),indexList:"{}"},c);return d.__indexes=a.__indexes,d.indexNames=a.indexNames,d},b.__createObjectStore=function(b,c){b.__objectStores[c.name]=c,b.objectStoreNames.push(c.name);var d=b.__versionTransaction;a.IDBTransaction.__assertVersionChange(d),d.__addToTransactionQueue(function(b,d,e,f){function g(b,d){throw a.util.createDOMException(0,'Could not create object store "'+c.name+'"',d)}var h=["CREATE TABLE",a.util.quote(c.name),"(key BLOB",c.autoIncrement?"UNIQUE, inc INTEGER PRIMARY KEY AUTOINCREMENT":"PRIMARY KEY",", value BLOB)"].join(" ");a.DEBUG&&console.log(h),b.executeSql(h,[],function(a,b){a.executeSql("INSERT INTO __sys__ VALUES (?,?,?,?)",[c.name,JSON.stringify(c.keyPath),c.autoIncrement,"{}"],function(){e(c)},g)},g)})},b.__deleteObjectStore=function(b,c){b.__objectStores[c.name]=void 0,b.objectStoreNames.splice(b.objectStoreNames.indexOf(c.name),1);var d=b.__versionTransaction;a.IDBTransaction.__assertVersionChange(d),d.__addToTransactionQueue(function(b,d,e,f){function g(b,c){f(a.util.createDOMException(0,"Could not delete ObjectStore",c))}b.executeSql("SELECT * FROM __sys__ where name = ?",[c.name],function(b,d){d.rows.length>0&&b.executeSql("DROP TABLE "+a.util.quote(c.name),[],function(){b.executeSql("DELETE FROM __sys__ WHERE name = ?",[c.name],function(){e()},g)},g)})})},b.prototype.__validateKey=function(b,c){if(this.keyPath){if("undefined"!=typeof c)throw a.util.createDOMException("DataError","The object store uses in-line keys and the key parameter was provided",this);if(!b||"object"!=typeof b)throw a.util.createDOMException("DataError","KeyPath was specified, but value was not an object");if(c=a.Key.getValue(b,this.keyPath),void 0===c){if(this.autoIncrement)return;throw a.util.createDOMException("DataError","Could not eval key from keyPath")}}else if("undefined"==typeof c){if(this.autoIncrement)return;throw a.util.createDOMException("DataError","The object store uses out-of-line keys and has no key generator and the key parameter was not provided. ",this)}a.Key.validate(c)},b.prototype.__deriveKey=function(b,c,d,e,f){function g(c){b.executeSql("SELECT * FROM sqlite_sequence where name like ?",[h.name],function(a,b){c(1!==b.rows.length?1:b.rows.item(0).seq+1)},function(b,c){f(a.util.createDOMException("DataError","Could not get the auto increment value for key",c))})}var h=this;if(h.keyPath){var i=a.Key.getValue(c,h.keyPath);void 0===i&&h.autoIncrement?g(function(b){try{a.Key.setValue(c,h.keyPath,b),e(b)}catch(b){f(a.util.createDOMException("DataError","Could not assign a generated value to the keyPath",b))}}):e(i)}else"undefined"==typeof d&&h.autoIncrement?g(e):e(d)},b.prototype.__insertData=function(b,c,d,e,f,g){try{var h={};"undefined"!=typeof e&&(a.Key.validate(e),h.key=a.Key.encode(e));for(var i=0;i<this.indexNames.length;i++){var j=this.__indexes[this.indexNames[i]];h[j.name]=a.Key.encode(a.Key.getValue(d,j.keyPath),j.multiEntry)}var k=["INSERT INTO ",a.util.quote(this.name),"("],l=[" VALUES ("],m=[];for(var n in h)k.push(a.util.quote(n)+","),l.push("?,"),m.push(h[n]);k.push("value )"),l.push("?)"),m.push(c);var o=k.join(" ")+l.join(" ");a.DEBUG&&console.log("SQL for adding",o,m),b.executeSql(o,m,function(b,c){a.Sca.encode(e,function(b){b=a.Sca.decode(b),f(b)})},function(b,c){g(a.util.createDOMError("ConstraintError",c.message,c))})}catch(a){g(a)}},b.prototype.add=function(b,c){var d=this;if(0===arguments.length)throw new TypeError("No value was specified");this.__validateKey(b,c),d.transaction.__assertWritable();var e=d.transaction.__createRequest();return d.transaction.__pushToQueue(e,function(e,f,g,h){d.__deriveKey(e,b,c,function(c){a.Sca.encode(b,function(a){d.__insertData(e,a,b,c,g,h)})},h)}),e},b.prototype.put=function(b,c){var d=this;if(0===arguments.length)throw new TypeError("No value was specified");this.__validateKey(b,c),d.transaction.__assertWritable();var e=d.transaction.__createRequest();return d.transaction.__pushToQueue(e,function(e,f,g,h){d.__deriveKey(e,b,c,function(c){a.Sca.encode(b,function(f){a.Key.validate(c);var i="DELETE FROM "+a.util.quote(d.name)+" where key = ?";e.executeSql(i,[a.Key.encode(c)],function(e,i){a.DEBUG&&console.log("Did the row with the",c,"exist? ",i.rowsAffected),d.__insertData(e,f,b,c,g,h)},function(a,b){h(b)})})},h)}),e},b.prototype.get=function(b){var c=this;if(0===arguments.length)throw new TypeError("No key was specified");a.Key.validate(b);var d=a.Key.encode(b);return c.transaction.__addToTransactionQueue(function(b,e,f,g){a.DEBUG&&console.log("Fetching",c.name,d),b.executeSql("SELECT * FROM "+a.util.quote(c.name)+" where key = ?",[d],function(b,c){a.DEBUG&&console.log("Fetched data",c);var d;try{if(0===c.rows.length)return f();d=a.Sca.decode(c.rows.item(0).value)}catch(b){a.DEBUG&&console.log(b)}f(d)},function(a,b){g(b)})})},b.prototype.delete=function(b){var c=this;if(0===arguments.length)throw new TypeError("No key was specified");c.transaction.__assertWritable(),a.Key.validate(b);var d=a.Key.encode(b);return c.transaction.__addToTransactionQueue(function(b,e,f,g){a.DEBUG&&console.log("Fetching",c.name,d),b.executeSql("DELETE FROM "+a.util.quote(c.name)+" where key = ?",[d],function(b,c){a.DEBUG&&console.log("Deleted from database",c.rowsAffected),f()},function(a,b){g(b)})})},b.prototype.clear=function(){var b=this;return b.transaction.__assertWritable(),b.transaction.__addToTransactionQueue(function(c,d,e,f){c.executeSql("DELETE FROM "+a.util.quote(b.name),[],function(b,c){a.DEBUG&&console.log("Cleared all records from database",c.rowsAffected),e()},function(a,b){f(b)})})},b.prototype.count=function(b){if(b instanceof a.IDBKeyRange)return new a.IDBCursor(b,"next",this,this,"key","value",!0).__req;var c=this,d=!1;return void 0!==b&&(d=!0,a.Key.validate(b)),c.transaction.__addToTransactionQueue(function(e,f,g,h){var i="SELECT * FROM "+a.util.quote(c.name)+(d?" WHERE key = ?":""),j=[];d&&j.push(a.Key.encode(b)),e.executeSql(i,j,function(a,b){g(b.rows.length)},function(a,b){h(b)})})},b.prototype.openCursor=function(b,c){return new a.IDBCursor(b,c,this,this,"key","value").__req},b.prototype.index=function(b){if(0===arguments.length)throw new TypeError("No index name was specified");var c=this.__indexes[b];if(!c)throw a.util.createDOMException("NotFoundError",'Index "'+b+'" does not exist on '+this.name);return a.IDBIndex.__clone(c,this)},b.prototype.createIndex=function(b,c,d){if(0===arguments.length)throw new TypeError("No index name was specified");if(1===arguments.length)throw new TypeError("No key path was specified");if(c instanceof Array&&d&&d.multiEntry)throw a.util.createDOMException("InvalidAccessError","The keyPath argument was an array and the multiEntry option is true.");if(this.__indexes[b]&&!this.__indexes[b].__deleted)throw a.util.createDOMException("ConstraintError",'Index "'+b+'" already exists on '+this.name);this.transaction.__assertVersionChange(),d=d||{};var e={columnName:b,keyPath:c,optionalParams:{unique:!!d.unique,multiEntry:!!d.multiEntry}},f=new a.IDBIndex(this,e);return a.IDBIndex.__createIndex(this,f),f},b.prototype.deleteIndex=function(b){if(0===arguments.length)throw new TypeError("No index name was specified");var c=this.__indexes[b];if(!c)throw a.util.createDOMException("NotFoundError",'Index "'+b+'" does not exist on '+this.name);this.transaction.__assertVersionChange(),a.IDBIndex.__deleteIndex(this,c)},a.IDBObjectStore=b}(idbModules),function(a){"use strict";function b(a,b,d){this.__id=++c,this.__active=!0,this.__running=!1,this.__errored=!1,this.__requests=[],this.__storeNames=b,this.mode=d,this.db=a,this.error=null,this.onabort=this.onerror=this.oncomplete=null;var e=this;setTimeout(function(){e.__executeRequests()},0)}var c=0;b.prototype.__executeRequests=function(){function b(b){if(a.util.logError("Error","An error occurred in a transaction",b),!d.__errored){if(d.__errored=!0,!d.__active)throw b;try{d.error=b;var c=a.util.createEvent("error");a.util.callback("onerror",d,c),a.util.callback("onerror",d.db,c)}finally{d.abort()}}}function c(){a.DEBUG&&console.log("Transaction completed");var b=a.util.createEvent("complete");try{a.util.callback("oncomplete",d,b),a.util.callback("__oncomplete",d,b)}catch(a){throw d.__errored=!0,a}}if(this.__running)return void(a.DEBUG&&console.log("Looks like the request set is already running",this.mode));this.__running=!0;var d=this;d.db.__db.transaction(function(e){function f(b,c){c&&(i.req=c),i.req.readyState="done",i.req.result=b,delete i.req.error;var d=a.util.createEvent("success");a.util.callback("onsuccess",i.req,d),j++,h()}function g(c,d){d=a.util.findError(arguments);try{i.req.readyState="done",i.req.error=d||"DOMError",i.req.result=void 0;var e=a.util.createEvent("error",d);a.util.callback("onerror",i.req,e)}finally{b(d)}}function h(){if(j>=d.__requests.length)d.__requests=[],d.__active&&(d.__active=!1,c());else try{i=d.__requests[j],i.op(e,i.args,f,g)}catch(a){g(a)}}d.__tx=e;var i=null,j=0;h()},function(a){b(a)})},b.prototype.__createRequest=function(){var b=new a.IDBRequest;return b.source=this.db,b.transaction=this,b},b.prototype.__addToTransactionQueue=function(a,b){var c=this.__createRequest();return this.__pushToQueue(c,a,b),c},b.prototype.__pushToQueue=function(a,b,c){this.__assertActive(),this.__requests.push({op:b,args:c,req:a})},b.prototype.__assertActive=function(){if(!this.__active)throw a.util.createDOMException("TransactionInactiveError","A request was placed against a transaction which is currently not active, or which is finished")},b.prototype.__assertWritable=function(){if(this.mode===b.READ_ONLY)throw a.util.createDOMException("ReadOnlyError","The transaction is read only")},b.prototype.__assertVersionChange=function(){b.__assertVersionChange(this)},b.__assertVersionChange=function(c){if(!c||c.mode!==b.VERSION_CHANGE)throw a.util.createDOMException("InvalidStateError","Not a version transaction")},b.prototype.objectStore=function(c){if(0===arguments.length)throw new TypeError("No object store name was specified");if(!this.__active)throw a.util.createDOMException("InvalidStateError","A request was placed against a transaction which is currently not active, or which is finished");if(-1===this.__storeNames.indexOf(c)&&this.mode!==b.VERSION_CHANGE)throw a.util.createDOMException("NotFoundError",c+" is not participating in this transaction");var d=this.db.__objectStores[c];if(!d)throw a.util.createDOMException("NotFoundError",c+" does not exist in "+this.db.name);return a.IDBObjectStore.__clone(d,this)},b.prototype.abort=function(){var b=this;a.DEBUG&&console.log("The transaction was aborted",b),b.__active=!1;var c=a.util.createEvent("abort");setTimeout(function(){a.util.callback("onabort",b,c)},0)},b.READ_ONLY="readonly",b.READ_WRITE="readwrite",b.VERSION_CHANGE="versionchange",a.IDBTransaction=b}(idbModules),function(a){"use strict";function b(b,c,d,e){this.__db=b,this.__closed=!1,this.version=d,this.name=c,this.onabort=this.onerror=this.onversionchange=null,this.__objectStores={},this.objectStoreNames=new a.util.StringList;for(var f=0;f<e.rows.length;f++){var g=new a.IDBObjectStore(e.rows.item(f));this.__objectStores[g.name]=g,this.objectStoreNames.push(g.name)}}b.prototype.createObjectStore=function(b,c){if(0===arguments.length)throw new TypeError("No object store name was specified");if(this.__objectStores[b])throw a.util.createDOMException("ConstraintError",'Object store "'+b+'" already exists in '+this.name);this.__versionTransaction.__assertVersionChange(),c=c||{};var d={name:b,keyPath:JSON.stringify(c.keyPath||null),autoInc:JSON.stringify(c.autoIncrement),indexList:"{}"},e=new a.IDBObjectStore(d,this.__versionTransaction);return a.IDBObjectStore.__createObjectStore(this,e),e},b.prototype.deleteObjectStore=function(b){if(0===arguments.length)throw new TypeError("No object store name was specified");var c=this.__objectStores[b];if(!c)throw a.util.createDOMException("NotFoundError",'Object store "'+b+'" does not exist in '+this.name);this.__versionTransaction.__assertVersionChange(),a.IDBObjectStore.__deleteObjectStore(this,c)},b.prototype.close=function(){this.__closed=!0},b.prototype.transaction=function(b,c){if(this.__closed)throw a.util.createDOMException("InvalidStateError","An attempt was made to start a new transaction on a database connection that is not open");if("number"==typeof c?(c=1===c?IDBTransaction.READ_WRITE:IDBTransaction.READ_ONLY,a.DEBUG&&console.log("Mode should be a string, but was specified as ",c)):c=c||IDBTransaction.READ_ONLY,c!==IDBTransaction.READ_ONLY&&c!==IDBTransaction.READ_WRITE)throw new TypeError("Invalid transaction mode: "+c);if(b="string"==typeof b?[b]:b,0===b.length)throw a.util.createDOMException("InvalidAccessError","No object store names were specified");for(var d=0;d<b.length;d++)if(!this.objectStoreNames.contains(b[d]))throw a.util.createDOMException("NotFoundError",'The "'+b[d]+'" object store does not exist');var e=new a.IDBTransaction(this,b,c);return e},a.IDBDatabase=b}(idbModules),function(a){"use strict";function b(b,c){function f(b,d){d=a.util.findError(arguments),a.DEBUG&&console.log("Error in sysdb transaction - when creating dbVersions",d),c(d)}d?b():(d=window.openDatabase("__sysdb__",1,"System Database",e),d.transaction(function(a){a.executeSql("CREATE TABLE IF NOT EXISTS dbVersions (name VARCHAR(255), version INT);",[],b,f)},f))}function c(){this.modules=a}var d,e=4194304;c.prototype.open=function(c,f){function g(b,c){if(!j){c=a.util.findError(arguments),j=!0;var d=a.util.createEvent("error",arguments);i.readyState="done",i.error=c||"DOMError",a.util.callback("onerror",i,d)}}function h(b){var h=window.openDatabase(c,1,c,e);if(i.readyState="done","undefined"==typeof f&&(f=b||1),0>=f||b>f){var j=a.util.createDOMError("VersionError","An attempt was made to open a database using a lower version than the existing version.",f);return void g(j)}h.transaction(function(e){e.executeSql("CREATE TABLE IF NOT EXISTS __sys__ (name VARCHAR(255), keyPath VARCHAR(255), autoInc BOOLEAN, indexList BLOB)",[],function(){e.executeSql("SELECT * FROM __sys__",[],function(e,j){var k=a.util.createEvent("success");i.source=i.result=new a.IDBDatabase(h,c,f,j),f>b?d.transaction(function(d){d.executeSql("UPDATE dbVersions set version = ? where name = ?",[f,c],function(){var c=a.util.createEvent("upgradeneeded");c.oldVersion=b,c.newVersion=f,i.transaction=i.result.__versionTransaction=new a.IDBTransaction(i.source,[],a.IDBTransaction.VERSION_CHANGE),i.transaction.__addToTransactionQueue(function(b,d,e){a.util.callback("onupgradeneeded",i,c),e()}),i.transaction.__oncomplete=function(){i.transaction=null;var b=a.util.createEvent("success");a.util.callback("onsuccess",i,b)}},g)},g):a.util.callback("onsuccess",i,k)},g)},g)},g)}var i=new a.IDBOpenDBRequest,j=!1;if(0===arguments.length)throw new TypeError("Database name is required");if(2===arguments.length&&(f=parseFloat(f),isNaN(f)||!isFinite(f)||0>=f))throw new TypeError("Invalid database version: "+f);return c+="",b(function(){d.transaction(function(a){a.executeSql("SELECT * FROM dbVersions where name = ?",[c],function(a,b){0===b.rows.length?a.executeSql("INSERT INTO dbVersions VALUES (?,?)",[c,f||1],function(){h(0)},g):h(b.rows.item(0).version)},g)},g)},g),i},c.prototype.deleteDatabase=function(c){function f(b,c){if(!i){c=a.util.findError(arguments),h.readyState="done",h.error=c||"DOMError";var d=a.util.createEvent("error");d.debug=arguments,a.util.callback("onerror",h,d),i=!0}}function g(){d.transaction(function(b){b.executeSql("DELETE FROM dbVersions where name = ? ",[c],function(){h.result=void 0;var b=a.util.createEvent("success");b.newVersion=null,b.oldVersion=j,a.util.callback("onsuccess",h,b)},f)},f)}var h=new a.IDBOpenDBRequest,i=!1,j=null;if(0===arguments.length)throw new TypeError("Database name is required");return c+="",b(function(){d.transaction(function(b){b.executeSql("SELECT * FROM dbVersions where name = ?",[c],function(b,d){if(0===d.rows.length){h.result=void 0;var i=a.util.createEvent("success");return i.newVersion=null,i.oldVersion=j,void a.util.callback("onsuccess",h,i)}j=d.rows.item(0).version;var k=window.openDatabase(c,1,c,e);k.transaction(function(b){b.executeSql("SELECT * FROM __sys__",[],function(b,c){var d=c.rows;!function c(e){e>=d.length?b.executeSql("DROP TABLE IF EXISTS __sys__",[],function(){g()},f):b.executeSql("DROP TABLE "+a.util.quote(d.item(e).name),[],function(){c(e+1)},function(){c(e+1)})}(0)},function(a){g()})})},f)},f)},f),h},c.prototype.cmp=function(b,c){if(arguments.length<2)throw new TypeError("You must provide two keys to be compared");a.Key.validate(b),a.Key.validate(c);var d=a.Key.encode(b),e=a.Key.encode(c),f=d>e?1:d===e?0:-1;if(a.DEBUG){var g=a.Key.decode(d),h=a.Key.decode(e);"object"==typeof b&&(b=JSON.stringify(b),g=JSON.stringify(g)),"object"==typeof c&&(c=JSON.stringify(c),h=JSON.stringify(h)),g!==b&&console.warn(b+" was incorrectly encoded as "+g),h!==c&&console.warn(c+" was incorrectly encoded as "+h)}return f},a.shimIndexedDB=new c,a.IDBFactory=c}(idbModules),function(a,b){"use strict";function c(b,c){try{a[b]=c}catch(a){}if(a[b]!==c&&Object.defineProperty){try{Object.defineProperty(a,b,{value:c})}catch(a){}a[b]!==c&&a.console&&console.warn&&console.warn("Unable to shim "+b)}}c("shimIndexedDB",b.shimIndexedDB),a.shimIndexedDB&&(a.shimIndexedDB.__useShim=function(){"undefined"!=typeof a.openDatabase?(c("indexedDB",b.shimIndexedDB),c("IDBFactory",b.IDBFactory),c("IDBDatabase",b.IDBDatabase),c("IDBObjectStore",b.IDBObjectStore),c("IDBIndex",b.IDBIndex),c("IDBTransaction",b.IDBTransaction),c("IDBCursor",b.IDBCursor),c("IDBKeyRange",b.IDBKeyRange),c("IDBRequest",b.IDBRequest),c("IDBOpenDBRequest",b.IDBOpenDBRequest),c("IDBVersionChangeEvent",b.IDBVersionChangeEvent)):"object"==typeof a.indexedDB&&b.polyfill()},a.shimIndexedDB.__debug=function(a){b.DEBUG=a}),"indexedDB"in a||(a.indexedDB=a.indexedDB||a.webkitIndexedDB||a.mozIndexedDB||a.oIndexedDB||a.msIndexedDB);var d=!1;if((navigator.userAgent.match(/Android 2/)||navigator.userAgent.match(/Android 3/)||navigator.userAgent.match(/Android 4\.[0-3]/))&&(navigator.userAgent.match(/Chrome/)||(d=!0)),"undefined"!=typeof a.indexedDB&&a.indexedDB&&!d||"undefined"==typeof a.openDatabase){a.IDBDatabase=a.IDBDatabase||a.webkitIDBDatabase,a.IDBTransaction=a.IDBTransaction||a.webkitIDBTransaction,a.IDBCursor=a.IDBCursor||a.webkitIDBCursor,a.IDBKeyRange=a.IDBKeyRange||a.webkitIDBKeyRange,a.IDBTransaction||(a.IDBTransaction={});try{a.IDBTransaction.READ_ONLY=a.IDBTransaction.READ_ONLY||"readonly",a.IDBTransaction.READ_WRITE=a.IDBTransaction.READ_WRITE||"readwrite"}catch(a){}}else a.shimIndexedDB.__useShim()}(window,idbModules),function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof module&&"object"==typeof module.exports?module.exports=b():a.Cldr=b()}(this,function(){var a=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},b=function(b,c){if(a(b)&&(b=b.join("/")),"string"!=typeof b)throw new Error('invalid path "'+b+'"');return b=b.replace(/^\//,"").replace(/^cldr\//,""),b=b.replace(/{[a-zA-Z]+}/g,function(a){return a=a.replace(/^{([^}]*)}$/,"$1"),c[a]}),b.split("/")},c=function(a,b){var c,d;if(a.some)return a.some(b);for(c=0,d=a.length;c<d;c++)if(b(a[c],c,a))return!0;return!1},d=function(a,b,d,e){var f,g,h=d[0],i=d[1],j=a.localeSep,k=d[2];return e=e||{},"und"!==h&&"Zzzz"!==i&&"ZZ"!==k?[h,i,k]:"undefined"!=typeof b.get("supplemental/likelySubtags")?(g=c([[h,i,k],[h,k],[h,i],[h],["und",i]],function(a){return f=!/\b(Zzzz|ZZ)\b/.test(a.join(j))&&b.get(["supplemental/likelySubtags",a.join(j)])}),g?(f=f.split(j),["und"!==h?h:f[0],"Zzzz"!==i?i:f[1],"ZZ"!==k?k:f[2]]):e.force?b.get("supplemental/likelySubtags/und").split(j):void 0):void 0},e=function(a,b,e){var f,g,h=e[0],i=e[1],j=e[2];return g=c([[[h,"Zzzz","ZZ"],[h]],[[h,"Zzzz",j],[h,j]],[[h,i,"ZZ"],[h,i]]],function(c){var g=d(a,b,c[0]);return f=c[1],g&&g[0]===e[0]&&g[1]===e[1]&&g[2]===e[2]}),g?f:e},f=function(a){var b,c,d=[];return a=a.replace(/_/,"-"),b=a.split("-u-"),b[1]&&(b[1]=b[1].split("-t-"),a=b[0]+(b[1][1]?"-t-"+b[1][1]:""),d[4]=b[1][0]),c=a.split("-t-")[0],b=c.match(/^(([a-z]{2,3})(-([A-Z][a-z]{3}))?(-([A-Z]{2}|[0-9]{3}))?)(-[a-zA-Z0-9]{5,8}|[0-9][a-zA-Z0-9]{3})*$|^(root)$/),null===b?["und","Zzzz","ZZ"]:(d[0]=b[9]||b[2]||"und",d[1]=b[4]||"Zzzz",d[2]=b[6]||"ZZ",d[3]=b[7],d)},g=function(a,b){var c,d;if(a.forEach)return a.forEach(b);for(c=0,d=a.length;c<d;c++)b(a[c],c,a)},h=function(a,b,c){var h=a._availableBundleMap,i=a._availableBundleMapQueue;return i.length&&(g(i,function(c){var g,j,k,l;l=f(c),j=d(a,b,l,{force:!0})||l,k=e(a,b,j),k=k.join(a.localeSep),g=i[k],g&&g.length<c.length||(h[k]=c)}),a._availableBundleMapQueue=[]),h[c]||null},i=function(a){var b,c=[];if(Object.keys)return Object.keys(a);for(b in a)c.push(b);return c},j=function(a,b){var c,d;return d=a+(b&&JSON?": "+JSON.stringify(b):""),c=new Error(d),c.code=a,g(i(b),function(a){c[a]=b[a]}),c},k=function(a,b,c){if(!b)throw j(a,c)},l=function(a,b){k("E_MISSING_PARAMETER","undefined"!=typeof a,{name:b})},m=function(a,b,c,d){k("E_INVALID_PAR_TYPE",c,{expected:d,name:b,value:a})},n=function(b,c){m(b,c,"string"==typeof b||a(b),"String or Array")},o=function(a){return null!==a&&""+a=="[object Object]"},p=function(a,b){m(a,b,"undefined"==typeof a||o(a),"Plain Object")},q=function(a,b){m(a,b,"string"==typeof a,"a string")},r=function(a,b){var c,d=a,e=b.length;for(c=0;c<e-1;c++)if(d=d[b[c]],!d)return;return d[b[c]]},s=function(a,b){var c,d=a._availableBundleMapQueue,e=r(b,["main"]);if(e)for(c in e)e.hasOwnProperty(c)&&"root"!==c&&d.push(c)},t=function(b){return a(b)?b:[b]},u=function(){var b=function(){var c={},d=[].slice.call(arguments,0);return g(d,function(d){var e;for(e in d)e in c&&"object"==typeof c[e]&&!a(c[e])?c[e]=b(c[e],d[e]):c[e]=d[e]}),c};return b}(),v=function(a,b,c){var d,e,f;for(l(c[0],"json"),d=0;d<c.length;d++)for(f=t(c[d]),e=0;e<f.length;e++)p(f[e],"json"),b=u(b,f[e]),s(a,f[e]);return b},w=function(a,c,d){var e=b(c,d);return r(a._resolved,e)},x=function(a){this.init(a)};return x._alwaysArray=t,x._coreLoad=v,x._createError=j,x._itemGetResolved=w,x._jsonMerge=u,x._pathNormalize=b,x._resourceGet=r,x._validatePresence=l,x._validateType=m,x._validateTypePath=n,x._validateTypePlainObject=p,x._availableBundleMap={},x._availableBundleMapQueue=[],x._resolved={},x.localeSep="-",x.load=function(){x._resolved=v(x,x._resolved,arguments)},x.prototype.init=function(a){var b,c,g,i,j,k,m,n,o,p=x.localeSep;l(a,"locale"),q(a,"locale"),k=f(a),n=k[4],o=k[3],g=d(x,this,k,{force:!0})||k,c=g[0],j=g[1],m=g[2],i=e(x,this,g).join(p),this.attributes=b={bundle:h(x,this,i),minlanguageId:i,maxLanguageId:g.join(p),language:c,script:j,territory:m,region:m,variant:o},n&&("-"+n).replace(/-[a-z]{3,8}|(-[a-z]{2})-([a-z]{3,8})/g,function(a,c,d){c?b["u"+c]=d:b["u"+a]=!0}),this.locale=a},x.prototype.get=function(a){return l(a,"path"),n(a,"path"),w(x,a,this.attributes)},x.prototype.main=function(a){return l(a,"path"),n(a,"path"),k("E_MISSING_BUNDLE",null!==this.attributes.bundle,{locale:this.locale}),a=t(a),this.get(["main/{bundle}"].concat(a))},x}),function(a){"function"==typeof define&&define.amd?define(["../cldr"],a):"object"==typeof module&&"object"==typeof module.exports?module.exports=a(require("cldrjs")):a(Cldr)}(function(a){function b(a,b){k(a,b,"string"==typeof a||a instanceof RegExp,"String or RegExp")}function c(a,c){return function(d,e){return j(d,"event"),b(d,"event"),j(e,"listener"),n(e,"listener"),c[a].apply(c,arguments)}}function d(a){return c("off",a)}function e(a){return c("on",a)}function f(a){return c("once",a)}function g(){l=a.prototype.get,a.prototype.get=function(a){var b=l.apply(this,arguments);return a=i(a,this.attributes).join("/"),
o.trigger("get",[a,b]),this.ee.trigger("get",[a,b]),b}}var h,i=a._pathNormalize,j=a._validatePresence,k=a._validateType;h=function(){function a(){}function b(a,b){for(var c=a.length;c--;)if(a[c].listener===b)return c;return-1}function c(a){return function(){return this[a].apply(this,arguments)}}var d=a.prototype,e=this,f=e.EventEmitter;return d.getListeners=function(a){var b,c,d=this._getEvents();if(a instanceof RegExp){b={};for(c in d)d.hasOwnProperty(c)&&a.test(c)&&(b[c]=d[c])}else b=d[a]||(d[a]=[]);return b},d.flattenListeners=function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push(a[b].listener);return c},d.getListenersAsObject=function(a){var b,c=this.getListeners(a);return c instanceof Array&&(b={},b[a]=c),b||c},d.addListener=function(a,c){var d,e=this.getListenersAsObject(a),f="object"==typeof c;for(d in e)e.hasOwnProperty(d)&&b(e[d],c)===-1&&e[d].push(f?c:{listener:c,once:!1});return this},d.on=c("addListener"),d.addOnceListener=function(a,b){return this.addListener(a,{listener:b,once:!0})},d.once=c("addOnceListener"),d.defineEvent=function(a){return this.getListeners(a),this},d.defineEvents=function(a){for(var b=0;b<a.length;b+=1)this.defineEvent(a[b]);return this},d.removeListener=function(a,c){var d,e,f=this.getListenersAsObject(a);for(e in f)f.hasOwnProperty(e)&&(d=b(f[e],c),d!==-1&&f[e].splice(d,1));return this},d.off=c("removeListener"),d.addListeners=function(a,b){return this.manipulateListeners(!1,a,b)},d.removeListeners=function(a,b){return this.manipulateListeners(!0,a,b)},d.manipulateListeners=function(a,b,c){var d,e,f=a?this.removeListener:this.addListener,g=a?this.removeListeners:this.addListeners;if("object"!=typeof b||b instanceof RegExp)for(d=c.length;d--;)f.call(this,b,c[d]);else for(d in b)b.hasOwnProperty(d)&&(e=b[d])&&("function"==typeof e?f.call(this,d,e):g.call(this,d,e));return this},d.removeEvent=function(a){var b,c=typeof a,d=this._getEvents();if("string"===c)delete d[a];else if(a instanceof RegExp)for(b in d)d.hasOwnProperty(b)&&a.test(b)&&delete d[b];else delete this._events;return this},d.removeAllListeners=c("removeEvent"),d.emitEvent=function(a,b){var c,d,e,f,g=this.getListenersAsObject(a);for(e in g)if(g.hasOwnProperty(e))for(d=g[e].length;d--;)c=g[e][d],c.once===!0&&this.removeListener(a,c.listener),f=c.listener.apply(this,b||[]),f===this._getOnceReturnValue()&&this.removeListener(a,c.listener);return this},d.trigger=c("emitEvent"),d.emit=function(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b)},d.setOnceReturnValue=function(a){return this._onceReturnValue=a,this},d._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},d._getEvents=function(){return this._events||(this._events={})},a.noConflict=function(){return e.EventEmitter=f,a},a}();var l,m,n=function(a,b){k(a,b,"undefined"==typeof a||"function"==typeof a,"Function")},o=new h;return a.off=d(o),a.on=e(o),a.once=f(o),m=a.prototype.init,a.prototype.init=function(){var a;this.ee=a=new h,this.off=d(a),this.on=e(a),this.once=f(a),m.apply(this,arguments)},a._eventInit=g,g(),a}),function(a){"function"==typeof define&&define.amd?define(["../cldr"],a):"object"==typeof module&&"object"==typeof module.exports?module.exports=a(require("cldrjs")):a(Cldr)}(function(a){var b=a._alwaysArray,c=function(a){var c,d;return c=function(c){return function(d){return d=b(d),a.get([c].concat(d))}},d=c("supplemental"),d.weekData=c("supplemental/weekData"),d.weekData.firstDay=function(){return a.get("supplemental/weekData/firstDay/{territory}")||a.get("supplemental/weekData/firstDay/001")},d.weekData.minDays=function(){var b=a.get("supplemental/weekData/minDays/{territory}")||a.get("supplemental/weekData/minDays/001");return parseInt(b,10)},d.timeData=c("supplemental/timeData"),d.timeData.allowed=function(){return a.get("supplemental/timeData/{territory}/_allowed")||a.get("supplemental/timeData/001/_allowed")},d.timeData.preferred=function(){return a.get("supplemental/timeData/{territory}/_preferred")||a.get("supplemental/timeData/001/_preferred")},d},d=a.prototype.init;return a.prototype.init=function(){d.apply(this,arguments),this.supplemental=c(this)},a}),function(a,b){"function"==typeof define&&define.amd?define(["cldr","cldr/event"],b):"object"==typeof exports?module.exports=b(require("cldrjs")):a.Globalize=b(a.Cldr)}(this,function(a){function b(a){a.once("get",m),a.get("supplemental/likelySubtags")}function c(a){return this instanceof c?(o(a,"locale"),r(a,"locale"),this.cldr=u(a),void b(this.cldr)):new c(a)}var d=function(a){return"string"==typeof a?a:"number"==typeof a?""+a:JSON.stringify(a)},e=function(a,b){return a=a.replace(/{[0-9a-zA-Z-_. ]+}/g,function(a){return a=a.replace(/^{([^}]*)}$/,"$1"),d(b[a])})},f=function(){var a=arguments[0],b=[].slice.call(arguments,1);return b.forEach(function(b){var c;for(c in b)a[c]=b[c]}),a},g=function(a,b,c){var d;return b=a+(b?": "+e(b,c):""),d=new Error(b),d.code=a,f(d,c),d},h=function(a){return[].reduce.call(a,function(a,b){var c=b.charCodeAt(0);return a=(a<<5)-a+c,0|a},0)},i=function(a,b,c,d){var e;return d=d||JSON.stringify(c),e=h(a+b+d),e>0?"a"+e:"b"+Math.abs(e)},j=function(a,b,c,d){var e=JSON.stringify(a),f=b.locale;return c.runtimeKey=i(c.name,f,null,e),c.generatorString=function(){return'Globalize("'+f+'").'+c.name+"("+e.slice(1,-1)+")"},c.runtimeArgs=d,c},k=function(a,b,c,d){if(!c)throw g(a,b,d)},l=function(a){return Array.isArray(a)?a:a?[a]:[]},m=function(a,b,c){var d;c=c||{},d=l(c.skip).some(function(b){return b.test(a)}),k("E_MISSING_CLDR","Missing required CLDR content `{path}`.",b||d,{path:a})},n=function(a){k("E_DEFAULT_LOCALE_NOT_DEFINED","Default locale has not been defined.",void 0!==a,{})},o=function(a,b){k("E_MISSING_PARAMETER","Missing required parameter `{name}`.",void 0!==a,{name:b})},p=function(a,b,c,d){k("E_PAR_OUT_OF_RANGE","Parameter `{name}` has value `{value}` out of range [{minimum}, {maximum}].",void 0===a||a>=c&&a<=d,{maximum:d,minimum:c,name:b,value:a})},q=function(a,b,c,d){k("E_INVALID_PAR_TYPE","Invalid `{name}` parameter ({value}). {expected} expected.",c,{expected:d,name:b,value:a})},r=function(b,c){q(b,c,void 0===b||"string"==typeof b||b instanceof a,"String or Cldr instance")},s=function(a){return null!==a&&""+a=="[object Object]"},t=function(a,b){q(a,b,void 0===a||s(a),"Plain Object")},u=function(b){return b instanceof a?b:new a(b)},v=function(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},w=function(a,b,c){var d;for("string"!=typeof a&&(a=String(a)),d=a.length;d<b;d+=1)a=c?a+"0":"0"+a;return a};return c.load=function(){a.load.apply(a,arguments)},c.locale=function(a){return r(a,"locale"),arguments.length&&(this.cldr=u(a),b(this.cldr)),this.cldr},c._alwaysArray=l,c._createError=g,c._formatMessage=e,c._isPlainObject=s,c._objectExtend=f,c._regexpEscape=v,c._runtimeBind=j,c._stringPad=w,c._validate=k,c._validateCldr=m,c._validateDefaultLocale=n,c._validateParameterPresence=o,c._validateParameterRange=p,c._validateParameterTypePlainObject=t,c._validateParameterType=q,c}),!function(a,b){"function"==typeof define&&define.amd?define(["cldr","../globalize","cldr/event","cldr/supplemental"],b):"object"==typeof exports?module.exports=b(require("cldrjs"),require("globalize")):b(a.Cldr,a.Globalize)}(this,function(a,b){function c(a){var b=a[2],c=a[3],d=a[4],e=a[5],f=a[6];if(isNaN(e*f)){if(!isNaN(e)||!isNaN(f))throw new Error("Neither or both the minimum and maximum significant digits must be present");l(b,"minimumIntegerDigits",1,21),l(c,"minimumFractionDigits",0,20),l(d,"maximumFractionDigits",c,20)}else l(e,"minimumSignificantDigits",1,21),l(f,"maximumSignificantDigits",e,21)}var d=b._createError,e=b._objectExtend,f=b._regexpEscape,g=b._runtimeBind,h=b._stringPad,i=b._validateCldr,j=b._validateDefaultLocale,k=b._validateParameterPresence,l=b._validateParameterRange,m=b._validateParameterType,n=b._validateParameterTypePlainObject,o=function(a){return d("E_UNSUPPORTED","Unsupported {feature}.",{feature:a})},p=function(a,b){m(a,b,void 0===a||"number"==typeof a,"Number")},q=function(a,b){m(a,b,void 0===a||"string"==typeof a,"a string")},r=function(a,b,c){var d,e=b,f="",g=",",h=!!c;for(a=String(a).split("."),d=a[0].length;d>e;)f=a[0].slice(d-e,d)+(f.length?g:"")+f,d-=e,h&&(e=c,h=!1);return a[0]=a[0].slice(0,d)+(f.length?g:"")+f,a.join(".")},s=function(a,b,c,d,e,f){return d?(a=f?e(a,f):e(a,{exponent:-d}),c&&(a=String(a).split("."),a[1]=h(a[1]||"",c,!0),a=a.join("."))):a=e(a),a=String(a),b&&(a=a.split("."),a[0]=h(a[0],b),a=a.join(".")),a},t=function(a,b,c){var d;return a=a.toPrecision(b+2),d=Math.ceil(Math.log(Math.abs(a))/Math.log(10)),d-=b,c(a,{exponent:d})},u=function(a,b,c,d){var e,f;if(b>c&&(c=b),e=t(a,b,d),f=t(a,c,d),a=+e===+f?e:f,a=(+a).toString(10),/e/.test(a))throw o({feature:"integers out of (1e21, 1e-7)"});return b-a.replace(/^0+|\./g,"").length>0&&(a=a.split("."),a[1]=h(a[1]||"",b-a[0].replace(/^0+/,"").length,!0),a=a.join(".")),a},v=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,t,v,w;return k=b[1],g=b[2],f=b[3],d=b[4],h=b[5],e=b[6],q=b[7],m=b[8],t=b[9],p=b[15],c=b[16],i=b[17],w=b[18],j=b[19],isNaN(a)?i:(a<0?(n=b[12],l=b[13],v=b[14]):(n=b[11],l=b[0],v=b[10]),isFinite(a)?(o=l,n.indexOf("%")!==-1?a*=100:n.indexOf("‰")!==-1&&(a*=1e3),a=isNaN(h*e)?s(a,g,f,d,p,q):u(a,h,e,p),a=a.replace(/^-/,""),m&&(a=r(a,m,t)),o+=a,o+=v,o.replace(/('([^']|'')+'|'')|./g,function(a,b){return b?(b=b.replace(/''/,"'"),b.length>2&&(b=b.slice(1,-1)),b):(a=a.replace(/[.,\-+E%\u2030]/,function(a){return w[a]}),j&&(a=a.replace(/[0-9]/,function(a){return j[+a]})),a)})):l+c+v)},w=function(a){return function(b){return k(b,"value"),p(b,"value"),v(b,a)}},x=function(a){var b=a.attributes["u-nu"];return b?("traditio"===b&&(b="traditional"),["native","traditional","finance"].indexOf(b)!==-1?a.main(["numbers/otherNumberingSystems",b]):b):a.main("numbers/defaultNumberingSystem")},y=function(a){var b,c=x(a);if("latn"!==c){if(b=a.supplemental(["numberingSystems",c]),"numeric"!==b._type)throw o("`"+b._type+"` numbering system");return b._digits}},z=/^(('[^']+'|''|[^*#@0,.E])*)(\*.)?((([#,]*[0,]*0+)(\.0*[0-9]*#*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,A=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,p,q,r,s,t;if(a=a.match(z),!a)throw new Error("Invalid pattern: "+a);if(m=a[1],l=a[3],e=a[4],s=a[8],q=a[9],t=a[10],s?s.replace(/(@+)(#*)/,function(a,b,c){k=b.length,h=k+c.length}):(d=a[7],f=a[6],d&&(d.replace(/[0-9]+/,function(a){i=a}),i?(p=+("0."+i),i=i.length):i=0,g=d.length-1),f.replace(/0+$/,function(a){j=a.length})),q)throw o({feature:"scientific notation (not implemented)"});if(l)throw o({feature:"padding (not implemented)"});return(b=e.lastIndexOf(","))!==-1&&(c=e.split(".")[0],n=c.length-b-1,(c=e.lastIndexOf(",",b-1))!==-1&&(r=b-1-c)),[m,l,j,i,g,k,h,p,n,r,t]},B=function(a,b){return b.main(["numbers/symbols-numberSystem-"+x(b),a])},C={".":"decimal",",":"group","%":"percentSign","+":"plusSign","-":"minusSign",E:"exponential","‰":"perMille"},D=function(a){var b,c={};for(b in C)c[b]=B(C[b],a);return c},E=function(a){return isNaN(a)?NaN:Math[a<0?"ceil":"floor"](a)},F=function(a){return a=a||"round",a="truncate"===a?E:Math[a],function(b,c){var d,e;if(b=+b,isNaN(b))return NaN;if("object"==typeof c&&c.exponent){if(d=+c.exponent,e=1,0===d)return a(b);if("number"!=typeof d||d%1!==0)return NaN}else{if(e=+c||1,1===e)return a(b);if(isNaN(e))return NaN;e=e.toExponential().split("e"),d=+e[1],e=+e[0]}return b=b.toString().split("e"),b[0]=+b[0]/e,b[1]=b[1]?+b[1]-d:-d,b=a(+(b[0]+"e"+b[1])),b=b.toString().split("e"),b[0]=+b[0]*e,b[1]=b[1]?+b[1]+d:d,+(b[0]+"e"+b[1])}},G=function(a,b,c){function d(a,b){a in c&&(k[b]=c[a])}var e,f,g,h,i,j,k;return c=c||{},a=a.split(";"),i=a[0],e=a[1]||"-"+i,g=A(e),f=g[0],h=g[10],j=F(c.round),j.generatorString=function(){return"numberRound("+(c.round?'"'+c.round+'"':"")+")"},k=A(i).concat([i,f+i+h,f,h,j,B("infinity",b),B("nan",b),D(b),y(b)]),d("minimumIntegerDigits",2),d("minimumFractionDigits",3),d("maximumFractionDigits",4),d("minimumSignificantDigits",5),d("maximumSignificantDigits",6),c.useGrouping===!1&&(k[8]=null),"minimumFractionDigits"in c&&!("maximumFractionDigits"in c)?k[4]=Math.max(k[3],k[4]):!("minimumFractionDigits"in c)&&"maximumFractionDigits"in c&&(k[3]=Math.min(k[3],k[4])),k},H=/^([^0-9]*)(([0-9,]*[0-9]+)(\.[0-9]+)?)(E[+-]?[0-9]+)?([^0-9]*)$/,I=function(a,b){var c,d,e,g,h,i,j,k,l,m,n;if(d=b[0],g=b[1],j=b[2],k=b[3],e=b[4],c=a.match(d))l=1/0,m=a.slice(0,c.length),n=a.slice(c.length+1);else{if(i=new RegExp(Object.keys(g).map(function(a){return f(a)}).join("|"),"g"),a=a.replace(i,function(a){return g[a]}),e&&(h=new RegExp(Object.keys(e).map(function(a){return f(a)}).join("|"),"g"),a=a.replace(h,function(a){return e[a]})),"."===a.charAt(0)&&(a="0"+a),a=a.match(H),!a)return NaN;if(m=a[1],n=a[6],l=a[2].replace(/,/g,""),a[5]&&(l+=a[5]),l=+l,isNaN(l))return NaN;a[0].indexOf("%")!==-1?(l/=100,n=n.replace("%","")):a[0].indexOf("‰")!==-1&&(l/=1e3,n=n.replace("‰",""))}return m===j&&n===k&&(l*=-1),l},J=function(a){return function(b){return k(b,"value"),q(b,"value"),I(b,a)}},K=function(a){var b,c={};for(b in C)c[B(C[b],a)]=b;return c},L=function(a,b){var c,d,f,g,h=y(b);return a=a.split(";"),f=a[1]||"-"+a[0],g=A(f),h&&(c=h.split("").reduce(function(a,b,c){return a[b]=String(c),a},{}),d="0123456789".split("").reduce(function(a,b){return a[b]="invalid",a},{}),c=e(d,c)),[B("infinity",b),e({},C,K(b)),g[0],g[10].replace("%","").replace("‰",""),c]},M=function(a,b){if("decimal"!==a&&"percent"!==a)throw new Error("Invalid style");return b.main(["numbers",a+"Formats-numberSystem-"+x(b),"standard"])};return b.numberFormatter=b.prototype.numberFormatter=function(a){var b,d,e,f,h;return n(a,"options"),a=a||{},d=this.cldr,b=[a],j(d),d.on("get",i),e=a.raw?a.raw:M(a.style||"decimal",d),f=G(e,d,a),d.off("get",i),c(f),h=w(f),g(b,d,h,[f]),h},b.numberParser=b.prototype.numberParser=function(a){var b,c,d,e,f;return n(a,"options"),a=a||{},c=this.cldr,b=[a],j(c),c.on("get",i),d=a.raw?a.raw:M(a.style||"decimal",c),e=L(d,c),c.off("get",i),f=J(e),g(b,c,f,[e]),f},b.formatNumber=b.prototype.formatNumber=function(a,b){return k(a,"value"),p(a,"value"),this.numberFormatter(b)(a)},b.parseNumber=b.prototype.parseNumber=function(a,b){return k(a,"value"),q(a,"value"),this.numberParser(b)(a)},b._createErrorUnsupportedFeature=o,b._numberNumberingSystem=x,b._numberPattern=M,b._numberSymbol=B,b._stringPad=h,b._validateParameterTypeNumber=p,b._validateParameterTypeString=q,b}),function(a,b){"function"==typeof define&&define.amd?define(["cldr","../globalize","./number","cldr/event","cldr/supplemental"],b):"object"==typeof exports?module.exports=b(require("cldrjs"),require("globalize")):b(a.Cldr,a.Globalize)}(this,function(a,b){function c(a,b){k(a,b,{skip:[/dates\/calendars\/gregorian\/dateTimeFormats\/availableFormats/,/dates\/calendars\/gregorian\/days\/.*\/short/,/supplemental\/timeData\/(?!001)/,/supplemental\/weekData\/(?!001)/]})}var d=b._createError,e=b._createErrorUnsupportedFeature,f=b._formatMessage,g=b._numberSymbol,h=b._regexpEscape,i=b._runtimeBind,j=b._stringPad,k=b._validateCldr,l=b._validateDefaultLocale,m=b._validateParameterPresence,n=b._validateParameterType,o=b._validateParameterTypePlainObject,p=b._validateParameterTypeString,q=function(a,b){n(a,b,void 0===a||a instanceof Date,"Date")},r=function(a,b){return d("E_INVALID_PAR_VALUE","Invalid `{name}` value ({value}).",{name:a,value:b})},s=function(a,b){function c(a,c,d){return f(b.main(["dates/calendars/gregorian/dateTimeFormats",a]),[d,c])}var d,e,g,h,i;switch(!0){case"skeleton"in a:g=a.skeleton,e=b.main(["dates/calendars/gregorian/dateTimeFormats/availableFormats",g]),e||(h=g.split(/[^hHKkmsSAzZOvVXx]/).slice(-1)[0],d=g.split(/[^GyYuUrQqMLlwWdDFgEec]/)[0],i=/(MMMM|LLLL).*[Ec]/.test(d)?"full":/MMMM/g.test(d)?"long":/MMM/g.test(d)||/LLL/g.test(d)?"medium":"short",e=c(i,b.main(["dates/calendars/gregorian/dateTimeFormats/availableFormats",d]),b.main(["dates/calendars/gregorian/dateTimeFormats/availableFormats",h])));break;case"date"in a:case"time"in a:e=b.main(["dates/calendars/gregorian","date"in a?"dateFormats":"timeFormats",a.date||a.time]);break;case"datetime"in a:e=c(a.datetime,b.main(["dates/calendars/gregorian/dateFormats",a.datetime]),b.main(["dates/calendars/gregorian/timeFormats",a.datetime]));break;case"raw"in a:e=a.raw;break;default:throw r({name:"options",value:a})}return e},t=function(a,b){return(a.getDay()-b+7)%7},u=function(a,b){var c=864e5;return(b.getTime()-a.getTime())/c},v=function(a,b){switch(a=new Date(a.getTime()),b){case"year":a.setMonth(0);case"month":a.setDate(1);case"day":a.setHours(0);case"hour":a.setMinutes(0);case"minute":a.setSeconds(0);case"second":a.setMilliseconds(0)}return a},w=function(a){return Math.floor(u(v(a,"year"),a))},x=function(a){return a-v(a,"day")},y=/([a-z])\1*|'([^']|'')+'|''|./gi,z=function(a,b,c,d){var e,f=a.getTimezoneOffset();return e=Math.abs(f),d=d||{1:function(a){return j(a,1)},2:function(a){return j(a,2)}},b.split(";")[f>0?1:0].replace(":",c).replace(/HH?/,function(a){return d[a.length](Math.floor(e/60))}).replace(/mm/,function(){return d[2](e%60)})},A=["sun","mon","tue","wed","thu","fri","sat"],B=function(a,b,c){var d=c.timeSeparator;return c.pattern.replace(y,function(e){var f,g=e.charAt(0),h=e.length;switch("j"===g&&(g=c.preferredTime),"Z"===g&&(h<4?(g="x",h=4):h<5?(g="O",h=4):(g="X",h=5)),g){case"G":f=c.eras[a.getFullYear()<0?0:1];break;case"y":f=a.getFullYear(),2===h&&(f=String(f),f=+f.substr(f.length-2));break;case"Y":f=new Date(a.getTime()),f.setDate(f.getDate()+7-t(a,c.firstDay)-c.firstDay-c.minDays),f=f.getFullYear(),2===h&&(f=String(f),f=+f.substr(f.length-2));break;case"Q":case"q":f=Math.ceil((a.getMonth()+1)/3),h>2&&(f=c.quarters[g][h][f]);break;case"M":case"L":f=a.getMonth()+1,h>2&&(f=c.months[g][h][f]);break;case"w":f=t(v(a,"year"),c.firstDay),f=Math.ceil((w(a)+f)/7)-(7-f>=c.minDays?0:1);break;case"W":f=t(v(a,"month"),c.firstDay),f=Math.ceil((a.getDate()+f)/7)-(7-f>=c.minDays?0:1);break;case"d":f=a.getDate();break;case"D":f=w(a)+1;break;case"F":f=Math.floor(a.getDate()/7)+1;break;case"e":case"c":if(h<=2){f=t(a,c.firstDay)+1;break}case"E":f=A[a.getDay()],f=c.days[g][h][f];break;case"a":f=c.dayPeriods[a.getHours()<12?"am":"pm"];break;case"h":f=a.getHours()%12||12;break;case"H":f=a.getHours();break;case"K":f=a.getHours()%12;break;case"k":f=a.getHours()||24;break;case"m":f=a.getMinutes();break;case"s":f=a.getSeconds();break;case"S":f=Math.round(a.getMilliseconds()*Math.pow(10,h-3));break;case"A":f=Math.round(x(a)*Math.pow(10,h-3));break;case"z":case"O":0===a.getTimezoneOffset()?f=c.gmtZeroFormat:(f=z(a,h<4?"+H;-H":c.tzLongHourFormat,d,b),f=c.gmtFormat.replace(/\{0\}/,f));break;case"X":if(0===a.getTimezoneOffset()){f="Z";break}case"x":f=1===h?"+HH;-HH":h%2?"+HH:mm;-HH:mm":"+HHmm;-HHmm",f=z(a,f,":");break;case":":f=d;break;case"'":e=e.replace(/''/,"'"),h>2&&(e=e.slice(1,-1)),f=e;break;default:f=e}return"number"==typeof f&&(f=b[h](f)),f})},C=function(a,b){return function(c){return m(c,"value"),q(c,"value"),B(c,a,b)}},D=function(a){return A.indexOf(a.supplemental.weekData.firstDay())},E=function(a,b){function c(a){d.numberFormatters[a]=j("",a)}var d={numberFormatters:{},pattern:a,timeSeparator:g("timeSeparator",b)},f=["abbreviated","wide","narrow"];return a.replace(y,function(a){var g,h=a.charAt(0),i=a.length;switch("j"===h&&(d.preferredTime=h=b.supplemental.timeData.preferred()),"Z"===h&&4===i&&(h="O",i=4),h){case"G":d.eras=b.main(["dates/calendars/gregorian/eras",i<=3?"eraAbbr":4===i?"eraNames":"eraNarrow"]);break;case"y":g=!0;break;case"Y":d.firstDay=D(b),d.minDays=b.supplemental.weekData.minDays(),g=!0;break;case"u":case"U":throw e({feature:"year pattern `"+h+"`"});case"Q":case"q":i>2?(d.quarters||(d.quarters={}),d.quarters[h]||(d.quarters[h]={}),d.quarters[h][i]=b.main(["dates/calendars/gregorian/quarters","Q"===h?"format":"stand-alone",f[i-3]])):g=!0;break;case"M":case"L":i>2?(d.months||(d.months={}),d.months[h]||(d.months[h]={}),d.months[h][i]=b.main(["dates/calendars/gregorian/months","M"===h?"format":"stand-alone",f[i-3]])):g=!0;break;case"w":case"W":d.firstDay=D(b),d.minDays=b.supplemental.weekData.minDays(),g=!0;break;case"d":case"D":case"F":g=!0;break;case"g":throw e({feature:"Julian day pattern `g`"});case"e":case"c":if(i<=2){d.firstDay=D(b),g=!0;break}case"E":d.days||(d.days={}),d.days[h]||(d.days[h]={}),6===i?d.days[h][i]=b.main(["dates/calendars/gregorian/days","c"===h?"stand-alone":"format","short"])||b.main(["dates/calendars/gregorian/days","c"===h?"stand-alone":"format","abbreviated"]):d.days[h][i]=b.main(["dates/calendars/gregorian/days","c"===h?"stand-alone":"format",f[i<3?0:i-3]]);break;case"a":d.dayPeriods=b.main("dates/calendars/gregorian/dayPeriods/format/wide");break;case"h":case"H":case"K":case"k":case"m":case"s":case"S":case"A":g=!0;break;case"z":case"O":d.gmtFormat=b.main("dates/timeZoneNames/gmtFormat"),d.gmtZeroFormat=b.main("dates/timeZoneNames/gmtZeroFormat"),d.tzLongHourFormat=b.main("dates/timeZoneNames/hourFormat");case"Z":case"X":case"x":c(1),c(2);break;case"v":case"V":throw e({feature:"timezone pattern `"+h+"`"})}g&&c(i)}),d},F=function(a){return 1===new Date(a,1,29).getMonth()},G=function(a){return new Date(a.getFullYear(),a.getMonth()+1,0).getDate()},H=function(a,b){var c=new Date(a.getFullYear(),a.getMonth()+1,0).getDate();a.setDate(b<1?1:b<c?b:c)},I=function(a,b){var c=a.getDate();a.setDate(1),a.setMonth(b),H(a,c)},J=function(a,b,c){return a<b||a>c},K=function(a,b,c){var d,f,g,h,i,j,k,l,m=0,n=1,o=2,p=3,q=4,r=5,s=6,t=new Date,u=[],w=["year","month","day","hour","minute","second","milliseconds"];if(!b.length)return null;if(l=b.every(function(a){var b,l,v,w;if("literal"===a.type)return!0;switch(l=a.type.charAt(0),w=a.type.length,"j"===l&&(l=c.preferredTimeData),l){case"G":u.push(m),h=+a.value;break;case"y":if(v=a.value,2===w){if(J(v,0,99))return!1;b=100*Math.floor(t.getFullYear()/100),v+=b,v>t.getFullYear()+20&&(v-=100)}t.setFullYear(v),u.push(m);break;case"Y":throw e({feature:"year pattern `"+l+"`"});case"Q":case"q":break;case"M":case"L":if(v=w<=2?a.value:+a.value,J(v,1,12))return!1;I(t,v-1),u.push(n);break;case"w":case"W":break;case"d":f=a.value,u.push(o);break;case"D":g=a.value,u.push(o);break;case"F":break;case"e":case"c":case"E":break;case"a":d=a.value;break;case"h":if(v=a.value,J(v,1,12))return!1;i=j=!0,t.setHours(12===v?0:v),u.push(p);break;case"K":if(v=a.value,J(v,0,11))return!1;i=j=!0,t.setHours(v),u.push(p);break;case"k":if(v=a.value,J(v,1,24))return!1;i=!0,t.setHours(24===v?0:v),u.push(p);break;case"H":if(v=a.value,J(v,0,23))return!1;i=!0,t.setHours(v),u.push(p);break;case"m":if(v=a.value,J(v,0,59))return!1;t.setMinutes(v),u.push(q);break;case"s":if(v=a.value,J(v,0,59))return!1;t.setSeconds(v),u.push(r);break;case"A":t.setHours(0),t.setMinutes(0),t.setSeconds(0);case"S":v=Math.round(a.value*Math.pow(10,3-w)),t.setMilliseconds(v),u.push(s);break;case"Z":case"z":case"O":case"X":case"x":k=a.value-t.getTimezoneOffset()}return!0}),!l)return null;if(i&&!(!d^j))return null;if(0===h&&t.setFullYear(t.getFullYear()*-1+1),void 0!==f){if(J(f,1,G(t)))return null;t.setDate(f)}else if(void 0!==g){if(J(g,1,F(t.getFullYear())?366:365))return null;t.setMonth(0),t.setDate(g)}return j&&"pm"===d&&t.setHours(t.getHours()+12),k&&t.setMinutes(t.getMinutes()+k),u=Math.max.apply(null,u),t=v(t,w[u])},L=/[0-9\xB2\xB3\xB9\xBC-\xBE\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u09F4-\u09F9\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0B72-\u0B77\u0BE6-\u0BF2\u0C66-\u0C6F\u0C78-\u0C7E\u0CE6-\u0CEF\u0D66-\u0D75\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F33\u1040-\u1049\u1090-\u1099\u1369-\u137C\u16EE-\u16F0\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1946-\u194F\u19D0-\u19DA\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\u2070\u2074-\u2079\u2080-\u2089\u2150-\u2182\u2185-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2CFD\u3007\u3021-\u3029\u3038-\u303A\u3192-\u3195\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\uA620-\uA629\uA6E6-\uA6EF\uA830-\uA835\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19]|\uD800[\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDEE1-\uDEFB\uDF20-\uDF23\uDF41\uDF4A\uDFD1-\uDFD5]|\uD801[\uDCA0-\uDCA9]|\uD802[\uDC58-\uDC5F\uDC79-\uDC7F\uDCA7-\uDCAF\uDD16-\uDD1B\uDE40-\uDE47\uDE7D\uDE7E\uDE9D-\uDE9F\uDEEB-\uDEEF\uDF58-\uDF5F\uDF78-\uDF7F\uDFA9-\uDFAF]|\uD803[\uDE60-\uDE7E]|\uD804[\uDC52-\uDC6F\uDCF0-\uDCF9\uDD36-\uDD3F\uDDD0-\uDDD9\uDDE1-\uDDF4\uDEF0-\uDEF9]|\uD805[\uDCD0-\uDCD9\uDE50-\uDE59\uDEC0-\uDEC9]|\uD806[\uDCE0-\uDCF2]|\uD809[\uDC00-\uDC6E]|\uD81A[\uDE60-\uDE69\uDF50-\uDF59\uDF5B-\uDF61]|\uD834[\uDF60-\uDF71]|\uD835[\uDFCE-\uDFFF]|\uD83A[\uDCC7-\uDCCF]|\uD83C[\uDD00-\uDD0C]/,M=function(a,b,c){var d,e=c.timeSeparator,f=[],g=["abbreviated","wide","narrow"];return d=c.pattern.match(y).every(function(d){function i(b,c){var d=a.match(b);return c=c||function(a){return+a},!!d&&(d.length<8?s.value=60*(d[1]?-c(d[1]):c(d[4])):s.value=60*(d[1]?-c(d[1]):c(d[7]))+(d[1]?-c(d[4]):c(d[10])),!0)}function j(a,b,c){var d;return b||(b="{0}"),d=a.replace("+","\\+").replace(/HH|mm/g,"(("+L.source+")("+L.source+"))").replace(/H|m/g,"(("+L.source+")("+L.source+")?)"),c&&(d=d.replace(/:/g,c)),d=d.split(";").map(function(a){return b.replace("{0}",a)}).join("|"),new RegExp(d)}function k(){if(1===p)return q=!0,r=L}function l(){if(1===p)return q=!0,r=new RegExp("("+L.source+")("+L.source+")?")}function m(){if(2===p)return q=!0,r=new RegExp("("+L.source+")("+L.source+")")}function n(b){var d,e,f=c[b.join("/")];for(d in f)if(e=new RegExp("^"+f[d]),e.test(a))return s.value=d,r=new RegExp(f[d]);return null}var o,p,q,r,s={};switch(s.type=d,o=d.charAt(0),p=d.length,"Z"===o&&(p<4?(o="x",p=4):p<5?(o="O",p=4):(o="X",p=5)),o){case"G":n(["gregorian/eras",p<=3?"eraAbbr":4===p?"eraNames":"eraNarrow"]);break;case"y":case"Y":q=!0,r=1===p?new RegExp("("+L.source+")+"):2===p?new RegExp("("+L.source+")("+L.source+")"):new RegExp("("+L.source+"){"+p+",}");break;case"Q":case"q":k()||m()||n(["gregorian/quarters","Q"===o?"format":"stand-alone",g[p-3]]);break;case"M":case"L":l()||m()||n(["gregorian/months","M"===o?"format":"stand-alone",g[p-3]]);break;case"D":p<=3&&(q=!0,r=new RegExp("("+L.source+"){"+p+",3}"));break;case"W":case"F":k();break;case"e":case"c":if(p<=2){k()||m();break}case"E":6===p?n(["gregorian/days",["c"===o?"stand-alone":"format"],"short"])||n(["gregorian/days",["c"===o?"stand-alone":"format"],"abbreviated"]):n(["gregorian/days",["c"===o?"stand-alone":"format"],g[p<3?0:p-3]]);break;case"a":n(["gregorian/dayPeriods/format/wide"]);break;case"w":case"d":case"h":case"H":case"K":case"k":case"j":case"m":case"s":l()||m();break;case"S":q=!0,r=new RegExp("("+L.source+"){"+p+"}");break;case"A":q=!0,r=new RegExp("("+L.source+"){"+(p+5)+"}");break;case"z":case"O":if(a===c["timeZoneNames/gmtZeroFormat"])s.value=0,r=new RegExp(c["timeZoneNames/gmtZeroFormat"]);else if(r=j(p<4?"+H;-H":c["timeZoneNames/hourFormat"],c["timeZoneNames/gmtFormat"],e),!i(r,b))return null;break;case"X":if("Z"===a){s.value=0,r=/Z/;break}case"x":if(r=j(1===p?"+HH;-HH":p%2?"+HH:mm;-HH:mm":"+HHmm;-HHmm"),!i(r))return null;break;case"'":s.type="literal",d=d.replace(/''/,"'"),p>2&&(d=d.slice(1,-1)),r=new RegExp(h(d));break;default:s.type="literal",r=/./}return!!r&&(a=a.replace(new RegExp("^"+r.source),function(a){return s.lexeme=a,q&&(s.value=b(a)),""}),!!s.lexeme&&(f.push(s),!0))}),d?f:[]},N=function(a,b,c){return function(d){var e;return m(d,"value"),p(d,"value"),e=M(d,a,c),K(d,e,b)||null}},O=function(a){return{preferredTimeData:a.supplemental.timeData.preferred()}},P=function(a,b){function c(a,b){d[a.replace(/^.*\/dates\//,"").replace(/calendars\//,"")]=b}var d={pattern:a,timeSeparator:g("timeSeparator",b)},f=["abbreviated","wide","narrow"];return b.on("get",c),a.match(y).forEach(function(a){var c,d;switch(c=a.charAt(0),d=a.length,"Z"===c&&d<5&&(c="O",d=4),c){case"G":b.main(["dates/calendars/gregorian/eras",d<=3?"eraAbbr":4===d?"eraNames":"eraNarrow"]);break;case"u":case"U":throw e({feature:"year pattern `"+c+"`"});case"Q":case"q":d>2&&b.main(["dates/calendars/gregorian/quarters","Q"===c?"format":"stand-alone",f[d-3]]);break;case"M":case"L":d>2&&b.main(["dates/calendars/gregorian/months","M"===c?"format":"stand-alone",f[d-3]]);break;case"g":throw e({feature:"Julian day pattern `g`"});case"e":case"c":if(d<=2)break;case"E":6===d?b.main(["dates/calendars/gregorian/days",["c"===c?"stand-alone":"format"],"short"])||b.main(["dates/calendars/gregorian/days",["c"===c?"stand-alone":"format"],"abbreviated"]):b.main(["dates/calendars/gregorian/days",["c"===c?"stand-alone":"format"],f[d<3?0:d-3]]);break;case"a":b.main(["dates/calendars/gregorian/dayPeriods/format/wide"]);break;case"z":case"O":b.main("dates/timeZoneNames/gmtFormat"),b.main("dates/timeZoneNames/gmtZeroFormat"),b.main("dates/timeZoneNames/hourFormat");break;case"v":case"V":throw e({feature:"timezone pattern `"+c+"`"})}}),b.off("get",c),d};return b.dateFormatter=b.prototype.dateFormatter=function(a){var b,d,e,f,g,h,j;o(a,"options"),d=this.cldr,a=a||{skeleton:"yMd"},b=[a],l(d),d.on("get",c),g=s(a,d),h=E(g,d),d.off("get",c),e=h.numberFormatters,delete h.numberFormatters;for(f in e)e[f]=this.numberFormatter({raw:e[f]});return j=C(e,h),i(b,d,j,[e,h]),j},b.dateParser=b.prototype.dateParser=function(a){var b,d,e,f,g,h,j;return o(a,"options"),d=this.cldr,a=a||{skeleton:"yMd"},b=[a],l(d),d.on("get",c),g=s(a,d),h=P(g,d),f=O(d),d.off("get",c),e=this.numberParser({raw:"0"}),j=N(e,f,h),i(b,d,j,[e,f,h]),j},b.formatDate=b.prototype.formatDate=function(a,b){return m(a,"value"),q(a,"value"),this.dateFormatter(b)(a)},b.parseDate=b.prototype.parseDate=function(a,b){return m(a,"value"),p(a,"value"),this.dateParser(b)(a)},b}),!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.io=a()}}(function(){var a;return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){b.exports=a("./lib/")},{"./lib/":2}],2:[function(a,b,c){function d(a,b){"object"==typeof a&&(b=a,a=void 0),b=b||{};var c,d=e(a),f=d.source,j=d.id;return b.forceNew||b["force new connection"]||!1===b.multiplex?(h("ignoring socket cache for %s",f),c=g(f,b)):(i[j]||(h("new io instance for %s",f),i[j]=g(f,b)),c=i[j]),c.socket(d.path)}var e=a("./url"),f=a("socket.io-parser"),g=a("./manager"),h=a("debug")("socket.io-client");b.exports=c=d;var i=c.managers={};c.protocol=f.protocol,c.connect=d,c.Manager=a("./manager"),c.Socket=a("./socket")},{"./manager":3,"./socket":5,"./url":6,debug:10,"socket.io-parser":46}],3:[function(a,b,c){function d(a,b){return this instanceof d?(a&&"object"==typeof a&&(b=a,a=void 0),b=b||{},b.path=b.path||"/socket.io",this.nsps={},this.subs=[],this.opts=b,this.reconnection(b.reconnection!==!1),this.reconnectionAttempts(b.reconnectionAttempts||1/0),this.reconnectionDelay(b.reconnectionDelay||1e3),this.reconnectionDelayMax(b.reconnectionDelayMax||5e3),this.randomizationFactor(b.randomizationFactor||.5),this.backoff=new m({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==b.timeout?2e4:b.timeout),this.readyState="closed",this.uri=a,this.connected=[],this.encoding=!1,this.packetBuffer=[],this.encoder=new h.Encoder,this.decoder=new h.Decoder,this.autoConnect=b.autoConnect!==!1,void(this.autoConnect&&this.open())):new d(a,b)}var e=(a("./url"),a("engine.io-client")),f=a("./socket"),g=a("component-emitter"),h=a("socket.io-parser"),i=a("./on"),j=a("component-bind"),k=(a("object-component"),
a("debug")("socket.io-client:manager")),l=a("indexof"),m=a("backo2");b.exports=d,d.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var a in this.nsps)this.nsps[a].emit.apply(this.nsps[a],arguments)},d.prototype.updateSocketIds=function(){for(var a in this.nsps)this.nsps[a].id=this.engine.id},g(d.prototype),d.prototype.reconnection=function(a){return arguments.length?(this._reconnection=!!a,this):this._reconnection},d.prototype.reconnectionAttempts=function(a){return arguments.length?(this._reconnectionAttempts=a,this):this._reconnectionAttempts},d.prototype.reconnectionDelay=function(a){return arguments.length?(this._reconnectionDelay=a,this.backoff&&this.backoff.setMin(a),this):this._reconnectionDelay},d.prototype.randomizationFactor=function(a){return arguments.length?(this._randomizationFactor=a,this.backoff&&this.backoff.setJitter(a),this):this._randomizationFactor},d.prototype.reconnectionDelayMax=function(a){return arguments.length?(this._reconnectionDelayMax=a,this.backoff&&this.backoff.setMax(a),this):this._reconnectionDelayMax},d.prototype.timeout=function(a){return arguments.length?(this._timeout=a,this):this._timeout},d.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},d.prototype.open=d.prototype.connect=function(a){if(k("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;k("opening %s",this.uri),this.engine=e(this.uri,this.opts);var b=this.engine,c=this;this.readyState="opening",this.skipReconnect=!1;var d=i(b,"open",function(){c.onopen(),a&&a()}),f=i(b,"error",function(b){if(k("connect_error"),c.cleanup(),c.readyState="closed",c.emitAll("connect_error",b),a){var d=new Error("Connection error");d.data=b,a(d)}else c.maybeReconnectOnOpen()});if(!1!==this._timeout){var g=this._timeout;k("connect attempt will timeout after %d",g);var h=setTimeout(function(){k("connect attempt timed out after %d",g),d.destroy(),b.close(),b.emit("error","timeout"),c.emitAll("connect_timeout",g)},g);this.subs.push({destroy:function(){clearTimeout(h)}})}return this.subs.push(d),this.subs.push(f),this},d.prototype.onopen=function(){k("open"),this.cleanup(),this.readyState="open",this.emit("open");var a=this.engine;this.subs.push(i(a,"data",j(this,"ondata"))),this.subs.push(i(this.decoder,"decoded",j(this,"ondecoded"))),this.subs.push(i(a,"error",j(this,"onerror"))),this.subs.push(i(a,"close",j(this,"onclose")))},d.prototype.ondata=function(a){this.decoder.add(a)},d.prototype.ondecoded=function(a){this.emit("packet",a)},d.prototype.onerror=function(a){k("error",a),this.emitAll("error",a)},d.prototype.socket=function(a){var b=this.nsps[a];if(!b){b=new f(this,a),this.nsps[a]=b;var c=this;b.on("connect",function(){b.id=c.engine.id,~l(c.connected,b)||c.connected.push(b)})}return b},d.prototype.destroy=function(a){var b=l(this.connected,a);~b&&this.connected.splice(b,1),this.connected.length||this.close()},d.prototype.packet=function(a){k("writing packet %j",a);var b=this;b.encoding?b.packetBuffer.push(a):(b.encoding=!0,this.encoder.encode(a,function(a){for(var c=0;c<a.length;c++)b.engine.write(a[c]);b.encoding=!1,b.processPacketQueue()}))},d.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var a=this.packetBuffer.shift();this.packet(a)}},d.prototype.cleanup=function(){for(var a;a=this.subs.shift();)a.destroy();this.packetBuffer=[],this.encoding=!1,this.decoder.destroy()},d.prototype.close=d.prototype.disconnect=function(){this.skipReconnect=!0,this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},d.prototype.onclose=function(a){k("close"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",a),this._reconnection&&!this.skipReconnect&&this.reconnect()},d.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var a=this;if(this.backoff.attempts>=this._reconnectionAttempts)k("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var b=this.backoff.duration();k("will wait %dms before reconnect attempt",b),this.reconnecting=!0;var c=setTimeout(function(){a.skipReconnect||(k("attempting reconnect"),a.emitAll("reconnect_attempt",a.backoff.attempts),a.emitAll("reconnecting",a.backoff.attempts),a.skipReconnect||a.open(function(b){b?(k("reconnect attempt error"),a.reconnecting=!1,a.reconnect(),a.emitAll("reconnect_error",b.data)):(k("reconnect success"),a.onreconnect())}))},b);this.subs.push({destroy:function(){clearTimeout(c)}})}},d.prototype.onreconnect=function(){var a=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",a)}},{"./on":4,"./socket":5,"./url":6,backo2:7,"component-bind":8,"component-emitter":9,debug:10,"engine.io-client":11,indexof:42,"object-component":43,"socket.io-parser":46}],4:[function(a,b,c){function d(a,b,c){return a.on(b,c),{destroy:function(){a.removeListener(b,c)}}}b.exports=d},{}],5:[function(a,b,c){function d(a,b){this.io=a,this.nsp=b,this.json=this,this.ids=0,this.acks={},this.io.autoConnect&&this.open(),this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0}var e=a("socket.io-parser"),f=a("component-emitter"),g=a("to-array"),h=a("./on"),i=a("component-bind"),j=a("debug")("socket.io-client:socket"),k=a("has-binary");b.exports=c=d;var l={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},m=f.prototype.emit;f(d.prototype),d.prototype.subEvents=function(){if(!this.subs){var a=this.io;this.subs=[h(a,"open",i(this,"onopen")),h(a,"packet",i(this,"onpacket")),h(a,"close",i(this,"onclose"))]}},d.prototype.open=d.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen(),this)},d.prototype.send=function(){var a=g(arguments);return a.unshift("message"),this.emit.apply(this,a),this},d.prototype.emit=function(a){if(l.hasOwnProperty(a))return m.apply(this,arguments),this;var b=g(arguments),c=e.EVENT;k(b)&&(c=e.BINARY_EVENT);var d={type:c,data:b};return"function"==typeof b[b.length-1]&&(j("emitting packet with ack id %d",this.ids),this.acks[this.ids]=b.pop(),d.id=this.ids++),this.connected?this.packet(d):this.sendBuffer.push(d),this},d.prototype.packet=function(a){a.nsp=this.nsp,this.io.packet(a)},d.prototype.onopen=function(){j("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:e.CONNECT})},d.prototype.onclose=function(a){j("close (%s)",a),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",a)},d.prototype.onpacket=function(a){if(a.nsp==this.nsp)switch(a.type){case e.CONNECT:this.onconnect();break;case e.EVENT:this.onevent(a);break;case e.BINARY_EVENT:this.onevent(a);break;case e.ACK:this.onack(a);break;case e.BINARY_ACK:this.onack(a);break;case e.DISCONNECT:this.ondisconnect();break;case e.ERROR:this.emit("error",a.data)}},d.prototype.onevent=function(a){var b=a.data||[];j("emitting event %j",b),null!=a.id&&(j("attaching ack callback to event"),b.push(this.ack(a.id))),this.connected?m.apply(this,b):this.receiveBuffer.push(b)},d.prototype.ack=function(a){var b=this,c=!1;return function(){if(!c){c=!0;var d=g(arguments);j("sending ack %j",d);var f=k(d)?e.BINARY_ACK:e.ACK;b.packet({type:f,id:a,data:d})}}},d.prototype.onack=function(a){j("calling ack %s with %j",a.id,a.data);var b=this.acks[a.id];b.apply(this,a.data),delete this.acks[a.id]},d.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},d.prototype.emitBuffered=function(){var a;for(a=0;a<this.receiveBuffer.length;a++)m.apply(this,this.receiveBuffer[a]);for(this.receiveBuffer=[],a=0;a<this.sendBuffer.length;a++)this.packet(this.sendBuffer[a]);this.sendBuffer=[]},d.prototype.ondisconnect=function(){j("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},d.prototype.destroy=function(){if(this.subs){for(var a=0;a<this.subs.length;a++)this.subs[a].destroy();this.subs=null}this.io.destroy(this)},d.prototype.close=d.prototype.disconnect=function(){return this.connected&&(j("performing disconnect (%s)",this.nsp),this.packet({type:e.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{"./on":4,"component-bind":8,"component-emitter":9,debug:10,"has-binary":38,"socket.io-parser":46,"to-array":50}],6:[function(a,b,c){(function(c){function d(a,b){var d=a,b=b||c.location;return null==a&&(a=b.protocol+"//"+b.host),"string"==typeof a&&("/"==a.charAt(0)&&(a="/"==a.charAt(1)?b.protocol+a:b.hostname+a),/^(https?|wss?):\/\//.test(a)||(f("protocol-less url %s",a),a="undefined"!=typeof b?b.protocol+"//"+a:"https://"+a),f("parse %s",a),d=e(a)),d.port||(/^(http|ws)$/.test(d.protocol)?d.port="80":/^(http|ws)s$/.test(d.protocol)&&(d.port="443")),d.path=d.path||"/",d.id=d.protocol+"://"+d.host+":"+d.port,d.href=d.protocol+"://"+d.host+(b&&b.port==d.port?"":":"+d.port),d}var e=a("parseuri"),f=a("debug")("socket.io-client:url");b.exports=d}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{debug:10,parseuri:44}],7:[function(a,b,c){function d(a){a=a||{},this.ms=a.min||100,this.max=a.max||1e4,this.factor=a.factor||2,this.jitter=a.jitter>0&&a.jitter<=1?a.jitter:0,this.attempts=0}b.exports=d,d.prototype.duration=function(){var a=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var b=Math.random(),c=Math.floor(b*this.jitter*a);a=0==(1&Math.floor(10*b))?a-c:a+c}return 0|Math.min(a,this.max)},d.prototype.reset=function(){this.attempts=0},d.prototype.setMin=function(a){this.ms=a},d.prototype.setMax=function(a){this.max=a},d.prototype.setJitter=function(a){this.jitter=a}},{}],8:[function(a,b,c){var d=[].slice;b.exports=function(a,b){if("string"==typeof b&&(b=a[b]),"function"!=typeof b)throw new Error("bind() requires a function");var c=d.call(arguments,2);return function(){return b.apply(a,c.concat(d.call(arguments)))}}},{}],9:[function(a,b,c){function d(a){if(a)return e(a)}function e(a){for(var b in d.prototype)a[b]=d.prototype[b];return a}b.exports=d,d.prototype.on=d.prototype.addEventListener=function(a,b){return this._callbacks=this._callbacks||{},(this._callbacks[a]=this._callbacks[a]||[]).push(b),this},d.prototype.once=function(a,b){function c(){d.off(a,c),b.apply(this,arguments)}var d=this;return this._callbacks=this._callbacks||{},c.fn=b,this.on(a,c),this},d.prototype.off=d.prototype.removeListener=d.prototype.removeAllListeners=d.prototype.removeEventListener=function(a,b){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var c=this._callbacks[a];if(!c)return this;if(1==arguments.length)return delete this._callbacks[a],this;for(var d,e=0;e<c.length;e++)if(d=c[e],d===b||d.fn===b){c.splice(e,1);break}return this},d.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),c=this._callbacks[a];if(c){c=c.slice(0);for(var d=0,e=c.length;d<e;++d)c[d].apply(this,b)}return this},d.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks[a]||[]},d.prototype.hasListeners=function(a){return!!this.listeners(a).length}},{}],10:[function(a,b,c){function d(a){return d.enabled(a)?function(b){b=e(b);var c=new Date,f=c-(d[a]||c);d[a]=c,b=a+" "+b+" +"+d.humanize(f),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function e(a){return a instanceof Error?a.stack||a.message:a}b.exports=d,d.names=[],d.skips=[],d.enable=function(a){try{localStorage.debug=a}catch(a){}for(var b=(a||"").split(/[\s,]+/),c=b.length,e=0;e<c;e++)a=b[e].replace("*",".*?"),"-"===a[0]?d.skips.push(new RegExp("^"+a.substr(1)+"$")):d.names.push(new RegExp("^"+a+"$"))},d.disable=function(){d.enable("")},d.humanize=function(a){var b=1e3,c=6e4,d=60*c;return a>=d?(a/d).toFixed(1)+"h":a>=c?(a/c).toFixed(1)+"m":a>=b?(a/b|0)+"s":a+"ms"},d.enabled=function(a){for(var b=0,c=d.skips.length;b<c;b++)if(d.skips[b].test(a))return!1;for(var b=0,c=d.names.length;b<c;b++)if(d.names[b].test(a))return!0;return!1};try{window.localStorage&&d.enable(localStorage.debug)}catch(a){}},{}],11:[function(a,b,c){b.exports=a("./lib/")},{"./lib/":12}],12:[function(a,b,c){b.exports=a("./socket"),b.exports.parser=a("engine.io-parser")},{"./socket":13,"engine.io-parser":25}],13:[function(a,b,c){(function(c){function d(a,b){if(!(this instanceof d))return new d(a,b);if(b=b||{},a&&"object"==typeof a&&(b=a,a=null),a&&(a=k(a),b.host=a.host,b.secure="https"==a.protocol||"wss"==a.protocol,b.port=a.port,a.query&&(b.query=a.query)),this.secure=null!=b.secure?b.secure:c.location&&"https:"==location.protocol,b.host){var e=b.host.split(":");b.hostname=e.shift(),e.length?b.port=e.pop():b.port||(b.port=this.secure?"443":"80")}this.agent=b.agent||!1,this.hostname=b.hostname||(c.location?location.hostname:"localhost"),this.port=b.port||(c.location&&location.port?location.port:this.secure?443:80),this.query=b.query||{},"string"==typeof this.query&&(this.query=m.decode(this.query)),this.upgrade=!1!==b.upgrade,this.path=(b.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!b.forceJSONP,this.jsonp=!1!==b.jsonp,this.forceBase64=!!b.forceBase64,this.enablesXDR=!!b.enablesXDR,this.timestampParam=b.timestampParam||"t",this.timestampRequests=b.timestampRequests,this.transports=b.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.callbackBuffer=[],this.policyPort=b.policyPort||843,this.rememberUpgrade=b.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=b.onlyBinaryUpgrades,this.pfx=b.pfx||null,this.key=b.key||null,this.passphrase=b.passphrase||null,this.cert=b.cert||null,this.ca=b.ca||null,this.ciphers=b.ciphers||null,this.rejectUnauthorized=b.rejectUnauthorized||null,this.open()}function e(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}var f=a("./transports"),g=a("component-emitter"),h=a("debug")("engine.io-client:socket"),i=a("indexof"),j=a("engine.io-parser"),k=a("parseuri"),l=a("parsejson"),m=a("parseqs");b.exports=d,d.priorWebsocketSuccess=!1,g(d.prototype),d.protocol=j.protocol,d.Socket=d,d.Transport=a("./transport"),d.transports=a("./transports"),d.parser=a("engine.io-parser"),d.prototype.createTransport=function(a){h('creating transport "%s"',a);var b=e(this.query);b.EIO=j.protocol,b.transport=a,this.id&&(b.sid=this.id);var c=new f[a]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:b,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized});return c},d.prototype.open=function(){var a;if(this.rememberUpgrade&&d.priorWebsocketSuccess&&this.transports.indexOf("websocket")!=-1)a="websocket";else{if(0==this.transports.length){var b=this;return void setTimeout(function(){b.emit("error","No transports available")},0)}a=this.transports[0]}this.readyState="opening";var a;try{a=this.createTransport(a)}catch(a){return this.transports.shift(),void this.open()}a.open(),this.setTransport(a)},d.prototype.setTransport=function(a){h("setting transport %s",a.name);var b=this;this.transport&&(h("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=a,a.on("drain",function(){b.onDrain()}).on("packet",function(a){b.onPacket(a)}).on("error",function(a){b.onError(a)}).on("close",function(){b.onClose("transport close")})},d.prototype.probe=function(a){function b(){if(m.onlyBinaryUpgrades){var b=!this.supportsBinary&&m.transport.supportsBinary;l=l||b}l||(h('probe transport "%s" opened',a),k.send([{type:"ping",data:"probe"}]),k.once("packet",function(b){if(!l)if("pong"==b.type&&"probe"==b.data){if(h('probe transport "%s" pong',a),m.upgrading=!0,m.emit("upgrading",k),!k)return;d.priorWebsocketSuccess="websocket"==k.name,h('pausing current transport "%s"',m.transport.name),m.transport.pause(function(){l||"closed"!=m.readyState&&(h("changing transport and sending upgrade packet"),j(),m.setTransport(k),k.send([{type:"upgrade"}]),m.emit("upgrade",k),k=null,m.upgrading=!1,m.flush())})}else{h('probe transport "%s" failed',a);var c=new Error("probe error");c.transport=k.name,m.emit("upgradeError",c)}}))}function c(){l||(l=!0,j(),k.close(),k=null)}function e(b){var d=new Error("probe error: "+b);d.transport=k.name,c(),h('probe transport "%s" failed because of error: %s',a,b),m.emit("upgradeError",d)}function f(){e("transport closed")}function g(){e("socket closed")}function i(a){k&&a.name!=k.name&&(h('"%s" works - aborting "%s"',a.name,k.name),c())}function j(){k.removeListener("open",b),k.removeListener("error",e),k.removeListener("close",f),m.removeListener("close",g),m.removeListener("upgrading",i)}h('probing transport "%s"',a);var k=this.createTransport(a,{probe:1}),l=!1,m=this;d.priorWebsocketSuccess=!1,k.once("open",b),k.once("error",e),k.once("close",f),this.once("close",g),this.once("upgrading",i),k.open()},d.prototype.onOpen=function(){if(h("socket open"),this.readyState="open",d.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){h("starting upgrade probes");for(var a=0,b=this.upgrades.length;a<b;a++)this.probe(this.upgrades[a])}},d.prototype.onPacket=function(a){if("opening"==this.readyState||"open"==this.readyState)switch(h('socket receive: type "%s", data "%s"',a.type,a.data),this.emit("packet",a),this.emit("heartbeat"),a.type){case"open":this.onHandshake(l(a.data));break;case"pong":this.setPing();break;case"error":var b=new Error("server error");b.code=a.data,this.emit("error",b);break;case"message":this.emit("data",a.data),this.emit("message",a.data)}else h('packet received with socket readyState "%s"',this.readyState)},d.prototype.onHandshake=function(a){this.emit("handshake",a),this.id=a.sid,this.transport.query.sid=a.sid,this.upgrades=this.filterUpgrades(a.upgrades),this.pingInterval=a.pingInterval,this.pingTimeout=a.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},d.prototype.onHeartbeat=function(a){clearTimeout(this.pingTimeoutTimer);var b=this;b.pingTimeoutTimer=setTimeout(function(){"closed"!=b.readyState&&b.onClose("ping timeout")},a||b.pingInterval+b.pingTimeout)},d.prototype.setPing=function(){var a=this;clearTimeout(a.pingIntervalTimer),a.pingIntervalTimer=setTimeout(function(){h("writing ping packet - expecting pong within %sms",a.pingTimeout),a.ping(),a.onHeartbeat(a.pingTimeout)},a.pingInterval)},d.prototype.ping=function(){this.sendPacket("ping")},d.prototype.onDrain=function(){for(var a=0;a<this.prevBufferLen;a++)this.callbackBuffer[a]&&this.callbackBuffer[a]();this.writeBuffer.splice(0,this.prevBufferLen),this.callbackBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0==this.writeBuffer.length?this.emit("drain"):this.flush()},d.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(h("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},d.prototype.write=d.prototype.send=function(a,b){return this.sendPacket("message",a,b),this},d.prototype.sendPacket=function(a,b,c){if("closing"!=this.readyState&&"closed"!=this.readyState){var d={type:a,data:b};this.emit("packetCreate",d),this.writeBuffer.push(d),this.callbackBuffer.push(c),this.flush()}},d.prototype.close=function(){function a(){d.onClose("forced close"),h("socket closing - telling transport to close"),d.transport.close()}function b(){d.removeListener("upgrade",b),d.removeListener("upgradeError",b),a()}function c(){d.once("upgrade",b),d.once("upgradeError",b)}if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var d=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?c():a()}):this.upgrading?c():a()}return this},d.prototype.onError=function(a){h("socket error %j",a),d.priorWebsocketSuccess=!1,this.emit("error",a),this.onClose("transport error",a)},d.prototype.onClose=function(a,b){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){h('socket close with reason: "%s"',a);var c=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),setTimeout(function(){c.writeBuffer=[],c.callbackBuffer=[],c.prevBufferLen=0},0),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",a,b)}},d.prototype.filterUpgrades=function(a){for(var b=[],c=0,d=a.length;c<d;c++)~i(this.transports,a[c])&&b.push(a[c]);return b}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./transport":14,"./transports":15,"component-emitter":9,debug:22,"engine.io-parser":25,indexof:42,parsejson:34,parseqs:35,parseuri:36}],14:[function(a,b,c){function d(a){this.path=a.path,this.hostname=a.hostname,this.port=a.port,this.secure=a.secure,this.query=a.query,this.timestampParam=a.timestampParam,this.timestampRequests=a.timestampRequests,this.readyState="",this.agent=a.agent||!1,this.socket=a.socket,this.enablesXDR=a.enablesXDR,this.pfx=a.pfx,this.key=a.key,this.passphrase=a.passphrase,this.cert=a.cert,this.ca=a.ca,this.ciphers=a.ciphers,this.rejectUnauthorized=a.rejectUnauthorized}var e=a("engine.io-parser"),f=a("component-emitter");b.exports=d,f(d.prototype),d.timestamps=0,d.prototype.onError=function(a,b){var c=new Error(a);return c.type="TransportError",c.description=b,this.emit("error",c),this},d.prototype.open=function(){return"closed"!=this.readyState&&""!=this.readyState||(this.readyState="opening",this.doOpen()),this},d.prototype.close=function(){return"opening"!=this.readyState&&"open"!=this.readyState||(this.doClose(),this.onClose()),this},d.prototype.send=function(a){if("open"!=this.readyState)throw new Error("Transport not open");this.write(a)},d.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},d.prototype.onData=function(a){var b=e.decodePacket(a,this.socket.binaryType);this.onPacket(b)},d.prototype.onPacket=function(a){this.emit("packet",a)},d.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"component-emitter":9,"engine.io-parser":25}],15:[function(a,b,c){(function(b){function d(a){var c,d=!1,h=!1,i=!1!==a.jsonp;if(b.location){var j="https:"==location.protocol,k=location.port;k||(k=j?443:80),d=a.hostname!=location.hostname||k!=a.port,h=a.secure!=j}if(a.xdomain=d,a.xscheme=h,c=new e(a),"open"in c&&!a.forceJSONP)return new f(a);if(!i)throw new Error("JSONP disabled");return new g(a)}var e=a("xmlhttprequest"),f=a("./polling-xhr"),g=a("./polling-jsonp"),h=a("./websocket");c.polling=d,c.websocket=h}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(a,b,c){(function(c){function d(){}function e(a){f.call(this,a),this.query=this.query||{},h||(c.___eio||(c.___eio=[]),h=c.___eio),this.index=h.length;var b=this;h.push(function(a){b.onData(a)}),this.query.j=this.index,c.document&&c.addEventListener&&c.addEventListener("beforeunload",function(){b.script&&(b.script.onerror=d)},!1)}var f=a("./polling"),g=a("component-inherit");b.exports=e;var h,i=/\n/g,j=/\\n/g;g(e,f),e.prototype.supportsBinary=!1,e.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),f.prototype.doClose.call(this)},e.prototype.doPoll=function(){var a=this,b=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),b.async=!0,b.src=this.uri(),b.onerror=function(b){a.onError("jsonp poll error",b)};var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c),this.script=b;var d="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);d&&setTimeout(function(){var a=document.createElement("iframe");document.body.appendChild(a),document.body.removeChild(a)},100)},e.prototype.doWrite=function(a,b){function c(){d(),b()}function d(){if(e.iframe)try{e.form.removeChild(e.iframe)}catch(a){e.onError("jsonp polling iframe removal error",a)}try{var a='<iframe src="javascript:0" name="'+e.iframeId+'">';f=document.createElement(a)}catch(a){f=document.createElement("iframe"),f.name=e.iframeId,f.src="javascript:0"}f.id=e.iframeId,e.form.appendChild(f),e.iframe=f}var e=this;if(!this.form){var f,g=document.createElement("form"),h=document.createElement("textarea"),k=this.iframeId="eio_iframe_"+this.index;g.className="socketio",g.style.position="absolute",g.style.top="-1000px",g.style.left="-1000px",g.target=k,g.method="POST",g.setAttribute("accept-charset","utf-8"),h.name="d",g.appendChild(h),document.body.appendChild(g),this.form=g,this.area=h}this.form.action=this.uri(),d(),a=a.replace(j,"\\\n"),this.area.value=a.replace(i,"\\n");try{this.form.submit()}catch(a){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==e.iframe.readyState&&c()}:this.iframe.onload=c}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-inherit":21}],17:[function(a,b,c){(function(c){function d(){}function e(a){if(i.call(this,a),c.location){var b="https:"==location.protocol,d=location.port;d||(d=b?443:80),this.xd=a.hostname!=c.location.hostname||d!=a.port,this.xs=a.secure!=b}}function f(a){this.method=a.method||"GET",this.uri=a.uri,this.xd=!!a.xd,this.xs=!!a.xs,this.async=!1!==a.async,this.data=void 0!=a.data?a.data:null,this.agent=a.agent,this.isBinary=a.isBinary,this.supportsBinary=a.supportsBinary,this.enablesXDR=a.enablesXDR,this.pfx=a.pfx,this.key=a.key,this.passphrase=a.passphrase,this.cert=a.cert,this.ca=a.ca,this.ciphers=a.ciphers,this.rejectUnauthorized=a.rejectUnauthorized,this.create()}function g(){for(var a in f.requests)f.requests.hasOwnProperty(a)&&f.requests[a].abort()}var h=a("xmlhttprequest"),i=a("./polling"),j=a("component-emitter"),k=a("component-inherit"),l=a("debug")("engine.io-client:polling-xhr");b.exports=e,b.exports.Request=f,k(e,i),e.prototype.supportsBinary=!0,e.prototype.request=function(a){return a=a||{},a.uri=this.uri(),a.xd=this.xd,a.xs=this.xs,a.agent=this.agent||!1,a.supportsBinary=this.supportsBinary,a.enablesXDR=this.enablesXDR,a.pfx=this.pfx,a.key=this.key,a.passphrase=this.passphrase,a.cert=this.cert,a.ca=this.ca,a.ciphers=this.ciphers,a.rejectUnauthorized=this.rejectUnauthorized,new f(a)},e.prototype.doWrite=function(a,b){var c="string"!=typeof a&&void 0!==a,d=this.request({method:"POST",data:a,isBinary:c}),e=this;d.on("success",b),d.on("error",function(a){e.onError("xhr post error",a)}),this.sendXhr=d},e.prototype.doPoll=function(){l("xhr poll");var a=this.request(),b=this;a.on("data",function(a){b.onData(a)}),a.on("error",function(a){b.onError("xhr poll error",a)}),this.pollXhr=a},j(f.prototype),f.prototype.create=function(){var a={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};a.pfx=this.pfx,a.key=this.key,a.passphrase=this.passphrase,a.cert=this.cert,a.ca=this.ca,a.ciphers=this.ciphers,a.rejectUnauthorized=this.rejectUnauthorized;var b=this.xhr=new h(a),d=this;try{if(l("xhr open %s: %s",this.method,this.uri),b.open(this.method,this.uri,this.async),this.supportsBinary&&(b.responseType="arraybuffer"),"POST"==this.method)try{this.isBinary?b.setRequestHeader("Content-type","application/octet-stream"):b.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(a){}"withCredentials"in b&&(b.withCredentials=!0),this.hasXDR()?(b.onload=function(){d.onLoad()},b.onerror=function(){d.onError(b.responseText)}):b.onreadystatechange=function(){4==b.readyState&&(200==b.status||1223==b.status?d.onLoad():setTimeout(function(){d.onError(b.status)},0))},l("xhr data %s",this.data),b.send(this.data)}catch(a){return void setTimeout(function(){d.onError(a)},0)}c.document&&(this.index=f.requestsCount++,f.requests[this.index]=this)},f.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},f.prototype.onData=function(a){this.emit("data",a),this.onSuccess()},f.prototype.onError=function(a){this.emit("error",a),this.cleanup(!0)},f.prototype.cleanup=function(a){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=d:this.xhr.onreadystatechange=d,a)try{this.xhr.abort()}catch(a){}c.document&&delete f.requests[this.index],this.xhr=null}},f.prototype.onLoad=function(){var a;try{var b;try{b=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(a){}a="application/octet-stream"===b?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(a){this.onError(a)}null!=a&&this.onData(a)},f.prototype.hasXDR=function(){return"undefined"!=typeof c.XDomainRequest&&!this.xs&&this.enablesXDR},f.prototype.abort=function(){this.cleanup()},c.document&&(f.requestsCount=0,f.requests={},c.attachEvent?c.attachEvent("onunload",g):c.addEventListener&&c.addEventListener("beforeunload",g,!1))}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-emitter":9,"component-inherit":21,debug:22,xmlhttprequest:20}],18:[function(a,b,c){function d(a){var b=a&&a.forceBase64;j&&!b||(this.supportsBinary=!1),e.call(this,a)}var e=a("../transport"),f=a("parseqs"),g=a("engine.io-parser"),h=a("component-inherit"),i=a("debug")("engine.io-client:polling");b.exports=d;var j=function(){var b=a("xmlhttprequest"),c=new b({xdomain:!1});return null!=c.responseType}();h(d,e),d.prototype.name="polling",d.prototype.doOpen=function(){this.poll()},d.prototype.pause=function(a){function b(){i("paused"),c.readyState="paused",a()}var c=this;if(this.readyState="pausing",this.polling||!this.writable){var d=0;this.polling&&(i("we are currently polling - waiting to pause"),d++,this.once("pollComplete",function(){i("pre-pause polling complete"),--d||b()})),this.writable||(i("we are currently writing - waiting to pause"),d++,this.once("drain",function(){i("pre-pause writing complete"),--d||b()}))}else b()},d.prototype.poll=function(){i("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},d.prototype.onData=function(a){var b=this;i("polling got data %s",a);var c=function(a,c,d){return"opening"==b.readyState&&b.onOpen(),"close"==a.type?(b.onClose(),!1):void b.onPacket(a)};g.decodePayload(a,this.socket.binaryType,c),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():i('ignoring poll - transport state "%s"',this.readyState))},d.prototype.doClose=function(){function a(){i("writing close packet"),b.write([{type:"close"}])}var b=this;"open"==this.readyState?(i("transport open - closing"),a()):(i("transport not open - deferring close"),this.once("open",a))},d.prototype.write=function(a){var b=this;this.writable=!1;var c=function(){b.writable=!0,b.emit("drain")},b=this;g.encodePayload(a,this.supportsBinary,function(a){b.doWrite(a,c)})},d.prototype.uri=function(){var a=this.query||{},b=this.secure?"https":"http",c="";return!1!==this.timestampRequests&&(a[this.timestampParam]=+new Date+"-"+e.timestamps++),this.supportsBinary||a.sid||(a.b64=1),a=f.encode(a),this.port&&("https"==b&&443!=this.port||"http"==b&&80!=this.port)&&(c=":"+this.port),a.length&&(a="?"+a),b+"://"+this.hostname+c+this.path+a}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:35,xmlhttprequest:20}],19:[function(a,b,c){
function d(a){var b=a&&a.forceBase64;b&&(this.supportsBinary=!1),e.call(this,a)}var e=a("../transport"),f=a("engine.io-parser"),g=a("parseqs"),h=a("component-inherit"),i=a("debug")("engine.io-client:websocket"),j=a("ws");b.exports=d,h(d,e),d.prototype.name="websocket",d.prototype.supportsBinary=!0,d.prototype.doOpen=function(){if(this.check()){var a=this.uri(),b=void 0,c={agent:this.agent};c.pfx=this.pfx,c.key=this.key,c.passphrase=this.passphrase,c.cert=this.cert,c.ca=this.ca,c.ciphers=this.ciphers,c.rejectUnauthorized=this.rejectUnauthorized,this.ws=new j(a,b,c),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.binaryType="arraybuffer",this.addEventListeners()}},d.prototype.addEventListeners=function(){var a=this;this.ws.onopen=function(){a.onOpen()},this.ws.onclose=function(){a.onClose()},this.ws.onmessage=function(b){a.onData(b.data)},this.ws.onerror=function(b){a.onError("websocket error",b)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(d.prototype.onData=function(a){var b=this;setTimeout(function(){e.prototype.onData.call(b,a)},0)}),d.prototype.write=function(a){function b(){c.writable=!0,c.emit("drain")}var c=this;this.writable=!1;for(var d=0,e=a.length;d<e;d++)f.encodePacket(a[d],this.supportsBinary,function(a){try{c.ws.send(a)}catch(a){i("websocket closed before onclose event")}});setTimeout(b,0)},d.prototype.onClose=function(){e.prototype.onClose.call(this)},d.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},d.prototype.uri=function(){var a=this.query||{},b=this.secure?"wss":"ws",c="";return this.port&&("wss"==b&&443!=this.port||"ws"==b&&80!=this.port)&&(c=":"+this.port),this.timestampRequests&&(a[this.timestampParam]=+new Date),this.supportsBinary||(a.b64=1),a=g.encode(a),a.length&&(a="?"+a),b+"://"+this.hostname+c+this.path+a},d.prototype.check=function(){return!(!j||"__initialize"in j&&this.name===d.prototype.name)}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:35,ws:37}],20:[function(a,b,c){var d=a("has-cors");b.exports=function(a){var b=a.xdomain,c=a.xscheme,e=a.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!b||d))return new XMLHttpRequest}catch(a){}try{if("undefined"!=typeof XDomainRequest&&!c&&e)return new XDomainRequest}catch(a){}if(!b)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}},{"has-cors":40}],21:[function(a,b,c){b.exports=function(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],22:[function(a,b,c){function d(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function e(){var a=arguments,b=this.useColors;if(a[0]=(b?"%c":"")+this.namespace+(b?" %c":" ")+a[0]+(b?"%c ":" ")+"+"+c.humanize(this.diff),!b)return a;var d="color: "+this.color;a=[a[0],d,"color: inherit"].concat(Array.prototype.slice.call(a,1));var e=0,f=0;return a[0].replace(/%[a-z%]/g,function(a){"%"!==a&&(e++,"%c"===a&&(f=e))}),a.splice(f,0,d),a}function f(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)}function g(a){try{null==a?localStorage.removeItem("debug"):localStorage.debug=a}catch(a){}}function h(){var a;try{a=localStorage.debug}catch(a){}return a}c=b.exports=a("./debug"),c.log=f,c.formatArgs=e,c.save=g,c.load=h,c.useColors=d,c.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],c.formatters.j=function(a){return JSON.stringify(a)},c.enable(h())},{"./debug":23}],23:[function(a,b,c){function d(){return c.colors[k++%c.colors.length]}function e(a){function b(){}function e(){var a=e,b=+new Date,f=b-(j||b);a.diff=f,a.prev=j,a.curr=b,j=b,null==a.useColors&&(a.useColors=c.useColors()),null==a.color&&a.useColors&&(a.color=d());var g=Array.prototype.slice.call(arguments);g[0]=c.coerce(g[0]),"string"!=typeof g[0]&&(g=["%o"].concat(g));var h=0;g[0]=g[0].replace(/%([a-z%])/g,function(b,d){if("%"===b)return b;h++;var e=c.formatters[d];if("function"==typeof e){var f=g[h];b=e.call(a,f),g.splice(h,1),h--}return b}),"function"==typeof c.formatArgs&&(g=c.formatArgs.apply(a,g));var i=e.log||c.log||console.log.bind(console);i.apply(a,g)}b.enabled=!1,e.enabled=!0;var f=c.enabled(a)?e:b;return f.namespace=a,f}function f(a){c.save(a);for(var b=(a||"").split(/[\s,]+/),d=b.length,e=0;e<d;e++)b[e]&&(a=b[e].replace(/\*/g,".*?"),"-"===a[0]?c.skips.push(new RegExp("^"+a.substr(1)+"$")):c.names.push(new RegExp("^"+a+"$")))}function g(){c.enable("")}function h(a){var b,d;for(b=0,d=c.skips.length;b<d;b++)if(c.skips[b].test(a))return!1;for(b=0,d=c.names.length;b<d;b++)if(c.names[b].test(a))return!0;return!1}function i(a){return a instanceof Error?a.stack||a.message:a}c=b.exports=e,c.coerce=i,c.disable=g,c.enable=f,c.enabled=h,c.humanize=a("ms"),c.names=[],c.skips=[],c.formatters={};var j,k=0},{ms:24}],24:[function(a,b,c){function d(a){var b=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(a);if(b){var c=parseFloat(b[1]),d=(b[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"y":return c*l;case"days":case"day":case"d":return c*k;case"hours":case"hour":case"h":return c*j;case"minutes":case"minute":case"m":return c*i;case"seconds":case"second":case"s":return c*h;case"ms":return c}}}function e(a){return a>=k?Math.round(a/k)+"d":a>=j?Math.round(a/j)+"h":a>=i?Math.round(a/i)+"m":a>=h?Math.round(a/h)+"s":a+"ms"}function f(a){return g(a,k,"day")||g(a,j,"hour")||g(a,i,"minute")||g(a,h,"second")||a+" ms"}function g(a,b,c){if(!(a<b))return a<1.5*b?Math.floor(a/b)+" "+c:Math.ceil(a/b)+" "+c+"s"}var h=1e3,i=60*h,j=60*i,k=24*j,l=365.25*k;b.exports=function(a,b){return b=b||{},"string"==typeof a?d(a):b.long?f(a):e(a)}},{}],25:[function(a,b,c){(function(b){function d(a,b){var d="b"+c.packets[a.type]+a.data.data;return b(d)}function e(a,b,d){if(!b)return c.encodeBase64Packet(a,d);var e=a.data,f=new Uint8Array(e),g=new Uint8Array(1+e.byteLength);g[0]=r[a.type];for(var h=0;h<f.length;h++)g[h+1]=f[h];return d(g.buffer)}function f(a,b,d){if(!b)return c.encodeBase64Packet(a,d);var e=new FileReader;return e.onload=function(){a.data=e.result,c.encodePacket(a,b,!0,d)},e.readAsArrayBuffer(a.data)}function g(a,b,d){if(!b)return c.encodeBase64Packet(a,d);if(q)return f(a,b,d);var e=new Uint8Array(1);e[0]=r[a.type];var g=new u([e.buffer,a.data]);return d(g)}function h(a,b,c){for(var d=new Array(a.length),e=m(a.length,c),f=function(a,c,e){b(c,function(b,c){d[a]=c,e(b,d)})},g=0;g<a.length;g++)f(g,a[g],e)}var i=a("./keys"),j=a("has-binary"),k=a("arraybuffer.slice"),l=a("base64-arraybuffer"),m=a("after"),n=a("utf8"),o=navigator.userAgent.match(/Android/i),p=/PhantomJS/i.test(navigator.userAgent),q=o||p;c.protocol=3;var r=c.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},s=i(r),t={type:"error",data:"parser error"},u=a("blob");c.encodePacket=function(a,c,f,h){"function"==typeof c&&(h=c,c=!1),"function"==typeof f&&(h=f,f=null);var i=void 0===a.data?void 0:a.data.buffer||a.data;if(b.ArrayBuffer&&i instanceof ArrayBuffer)return e(a,c,h);if(u&&i instanceof b.Blob)return g(a,c,h);if(i&&i.base64)return d(a,h);var j=r[a.type];return void 0!==a.data&&(j+=f?n.encode(String(a.data)):String(a.data)),h(""+j)},c.encodeBase64Packet=function(a,d){var e="b"+c.packets[a.type];if(u&&a.data instanceof u){var f=new FileReader;return f.onload=function(){var a=f.result.split(",")[1];d(e+a)},f.readAsDataURL(a.data)}var g;try{g=String.fromCharCode.apply(null,new Uint8Array(a.data))}catch(b){for(var h=new Uint8Array(a.data),i=new Array(h.length),j=0;j<h.length;j++)i[j]=h[j];g=String.fromCharCode.apply(null,i)}return e+=b.btoa(g),d(e)},c.decodePacket=function(a,b,d){if("string"==typeof a||void 0===a){if("b"==a.charAt(0))return c.decodeBase64Packet(a.substr(1),b);if(d)try{a=n.decode(a)}catch(a){return t}var e=a.charAt(0);return Number(e)==e&&s[e]?a.length>1?{type:s[e],data:a.substring(1)}:{type:s[e]}:t}var f=new Uint8Array(a),e=f[0],g=k(a,1);return u&&"blob"===b&&(g=new u([g])),{type:s[e],data:g}},c.decodeBase64Packet=function(a,c){var d=s[a.charAt(0)];if(!b.ArrayBuffer)return{type:d,data:{base64:!0,data:a.substr(1)}};var e=l.decode(a.substr(1));return"blob"===c&&u&&(e=new u([e])),{type:d,data:e}},c.encodePayload=function(a,b,d){function e(a){return a.length+":"+a}function f(a,d){c.encodePacket(a,!!g&&b,!0,function(a){d(null,e(a))})}"function"==typeof b&&(d=b,b=null);var g=j(a);return b&&g?u&&!q?c.encodePayloadAsBlob(a,d):c.encodePayloadAsArrayBuffer(a,d):a.length?void h(a,f,function(a,b){return d(b.join(""))}):d("0:")},c.decodePayload=function(a,b,d){if("string"!=typeof a)return c.decodePayloadAsBinary(a,b,d);"function"==typeof b&&(d=b,b=null);var e;if(""==a)return d(t,0,1);for(var f,g,h="",i=0,j=a.length;i<j;i++){var k=a.charAt(i);if(":"!=k)h+=k;else{if(""==h||h!=(f=Number(h)))return d(t,0,1);if(g=a.substr(i+1,f),h!=g.length)return d(t,0,1);if(g.length){if(e=c.decodePacket(g,b,!0),t.type==e.type&&t.data==e.data)return d(t,0,1);var l=d(e,i+f,j);if(!1===l)return}i+=f,h=""}}return""!=h?d(t,0,1):void 0},c.encodePayloadAsArrayBuffer=function(a,b){function d(a,b){c.encodePacket(a,!0,!0,function(a){return b(null,a)})}return a.length?void h(a,d,function(a,c){var d=c.reduce(function(a,b){var c;return c="string"==typeof b?b.length:b.byteLength,a+c.toString().length+c+2},0),e=new Uint8Array(d),f=0;return c.forEach(function(a){var b="string"==typeof a,c=a;if(b){for(var d=new Uint8Array(a.length),g=0;g<a.length;g++)d[g]=a.charCodeAt(g);c=d.buffer}b?e[f++]=0:e[f++]=1;for(var h=c.byteLength.toString(),g=0;g<h.length;g++)e[f++]=parseInt(h[g]);e[f++]=255;for(var d=new Uint8Array(c),g=0;g<d.length;g++)e[f++]=d[g]}),b(e.buffer)}):b(new ArrayBuffer(0))},c.encodePayloadAsBlob=function(a,b){function d(a,b){c.encodePacket(a,!0,!0,function(a){var c=new Uint8Array(1);if(c[0]=1,"string"==typeof a){for(var d=new Uint8Array(a.length),e=0;e<a.length;e++)d[e]=a.charCodeAt(e);a=d.buffer,c[0]=0}for(var f=a instanceof ArrayBuffer?a.byteLength:a.size,g=f.toString(),h=new Uint8Array(g.length+1),e=0;e<g.length;e++)h[e]=parseInt(g[e]);if(h[g.length]=255,u){var i=new u([c.buffer,h.buffer,a]);b(null,i)}})}h(a,d,function(a,c){return b(new u(c))})},c.decodePayloadAsBinary=function(a,b,d){"function"==typeof b&&(d=b,b=null);for(var e=a,f=[],g=!1;e.byteLength>0;){for(var h=new Uint8Array(e),i=0===h[0],j="",l=1;255!=h[l];l++){if(j.length>310){g=!0;break}j+=h[l]}if(g)return d(t,0,1);e=k(e,2+j.length),j=parseInt(j);var m=k(e,0,j);if(i)try{m=String.fromCharCode.apply(null,new Uint8Array(m))}catch(a){var n=new Uint8Array(m);m="";for(var l=0;l<n.length;l++)m+=String.fromCharCode(n[l])}f.push(m),e=k(e,j)}var o=f.length;f.forEach(function(a,e){d(c.decodePacket(a,b,!0),e,o)})}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./keys":26,after:27,"arraybuffer.slice":28,"base64-arraybuffer":29,blob:30,"has-binary":31,utf8:33}],26:[function(a,b,c){b.exports=Object.keys||function(a){var b=[],c=Object.prototype.hasOwnProperty;for(var d in a)c.call(a,d)&&b.push(d);return b}},{}],27:[function(a,b,c){function d(a,b,c){function d(a,e){if(d.count<=0)throw new Error("after called too many times");--d.count,a?(f=!0,b(a),b=c):0!==d.count||f||b(null,e)}var f=!1;return c=c||e,d.count=a,0===a?b():d}function e(){}b.exports=d},{}],28:[function(a,b,c){b.exports=function(a,b,c){var d=a.byteLength;if(b=b||0,c=c||d,a.slice)return a.slice(b,c);if(b<0&&(b+=d),c<0&&(c+=d),c>d&&(c=d),b>=d||b>=c||0===d)return new ArrayBuffer(0);for(var e=new Uint8Array(a),f=new Uint8Array(c-b),g=b,h=0;g<c;g++,h++)f[h]=e[g];return f.buffer}},{}],29:[function(a,b,c){!function(a){"use strict";c.encode=function(b){var c,d=new Uint8Array(b),e=d.length,f="";for(c=0;c<e;c+=3)f+=a[d[c]>>2],f+=a[(3&d[c])<<4|d[c+1]>>4],f+=a[(15&d[c+1])<<2|d[c+2]>>6],f+=a[63&d[c+2]];return e%3===2?f=f.substring(0,f.length-1)+"=":e%3===1&&(f=f.substring(0,f.length-2)+"=="),f},c.decode=function(b){var c,d,e,f,g,h=.75*b.length,i=b.length,j=0;"="===b[b.length-1]&&(h--,"="===b[b.length-2]&&h--);var k=new ArrayBuffer(h),l=new Uint8Array(k);for(c=0;c<i;c+=4)d=a.indexOf(b[c]),e=a.indexOf(b[c+1]),f=a.indexOf(b[c+2]),g=a.indexOf(b[c+3]),l[j++]=d<<2|e>>4,l[j++]=(15&e)<<4|f>>2,l[j++]=(3&f)<<6|63&g;return k}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],30:[function(a,b,c){(function(a){function c(a,b){b=b||{};for(var c=new d,e=0;e<a.length;e++)c.append(a[e]);return b.type?c.getBlob(b.type):c.getBlob()}var d=a.BlobBuilder||a.WebKitBlobBuilder||a.MSBlobBuilder||a.MozBlobBuilder,e=function(){try{var a=new Blob(["hi"]);return 2==a.size}catch(a){return!1}}(),f=d&&d.prototype.append&&d.prototype.getBlob;b.exports=function(){return e?a.Blob:f?c:void 0}()}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],31:[function(a,b,c){(function(c){function d(a){function b(a){if(!a)return!1;if(c.Buffer&&c.Buffer.isBuffer(a)||c.ArrayBuffer&&a instanceof ArrayBuffer||c.Blob&&a instanceof Blob||c.File&&a instanceof File)return!0;if(e(a)){for(var d=0;d<a.length;d++)if(b(a[d]))return!0}else if(a&&"object"==typeof a){a.toJSON&&(a=a.toJSON());for(var f in a)if(a.hasOwnProperty(f)&&b(a[f]))return!0}return!1}return b(a)}var e=a("isarray");b.exports=d}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:32}],32:[function(a,b,c){b.exports=Array.isArray||function(a){return"[object Array]"==Object.prototype.toString.call(a)}},{}],33:[function(b,c,d){(function(b){!function(e){function f(a){for(var b,c,d=[],e=0,f=a.length;e<f;)b=a.charCodeAt(e++),b>=55296&&b<=56319&&e<f?(c=a.charCodeAt(e++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),e--)):d.push(b);return d}function g(a){for(var b,c=a.length,d=-1,e="";++d<c;)b=a[d],b>65535&&(b-=65536,e+=t(b>>>10&1023|55296),b=56320|1023&b),e+=t(b);return e}function h(a,b){return t(a>>b&63|128)}function i(a){if(0==(4294967168&a))return t(a);var b="";return 0==(4294965248&a)?b=t(a>>6&31|192):0==(4294901760&a)?(b=t(a>>12&15|224),b+=h(a,6)):0==(4292870144&a)&&(b=t(a>>18&7|240),b+=h(a,12),b+=h(a,6)),b+=t(63&a|128)}function j(a){for(var b,c=f(a),d=c.length,e=-1,g="";++e<d;)b=c[e],g+=i(b);return g}function k(){if(s>=r)throw Error("Invalid byte index");var a=255&q[s];if(s++,128==(192&a))return 63&a;throw Error("Invalid continuation byte")}function l(){var a,b,c,d,e;if(s>r)throw Error("Invalid byte index");if(s==r)return!1;if(a=255&q[s],s++,0==(128&a))return a;if(192==(224&a)){var b=k();if(e=(31&a)<<6|b,e>=128)return e;throw Error("Invalid continuation byte")}if(224==(240&a)){if(b=k(),c=k(),e=(15&a)<<12|b<<6|c,e>=2048)return e;throw Error("Invalid continuation byte")}if(240==(248&a)&&(b=k(),c=k(),d=k(),e=(15&a)<<18|b<<12|c<<6|d,e>=65536&&e<=1114111))return e;throw Error("Invalid UTF-8 detected")}function m(a){q=f(a),r=q.length,s=0;for(var b,c=[];(b=l())!==!1;)c.push(b);return g(c)}var n="object"==typeof d&&d,o="object"==typeof c&&c&&c.exports==n&&c,p="object"==typeof b&&b;p.global!==p&&p.window!==p||(e=p);var q,r,s,t=String.fromCharCode,u={version:"2.0.0",encode:j,decode:m};if("function"==typeof a&&"object"==typeof a.amd&&a.amd)a(function(){return u});else if(n&&!n.nodeType)if(o)o.exports=u;else{var v={},w=v.hasOwnProperty;for(var x in u)w.call(u,x)&&(n[x]=u[x])}else e.utf8=u}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],34:[function(a,b,c){(function(a){var c=/^[\],:{}\s]*$/,d=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,e=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,f=/(?:^|:|,)(?:\s*\[)+/g,g=/^\s+/,h=/\s+$/;b.exports=function(b){return"string"==typeof b&&b?(b=b.replace(g,"").replace(h,""),a.JSON&&JSON.parse?JSON.parse(b):c.test(b.replace(d,"@").replace(e,"]").replace(f,""))?new Function("return "+b)():void 0):null}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],35:[function(a,b,c){c.encode=function(a){var b="";for(var c in a)a.hasOwnProperty(c)&&(b.length&&(b+="&"),b+=encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b},c.decode=function(a){for(var b={},c=a.split("&"),d=0,e=c.length;d<e;d++){var f=c[d].split("=");b[decodeURIComponent(f[0])]=decodeURIComponent(f[1])}return b}},{}],36:[function(a,b,c){var d=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];b.exports=function(a){var b=a,c=a.indexOf("["),f=a.indexOf("]");c!=-1&&f!=-1&&(a=a.substring(0,c)+a.substring(c,f).replace(/:/g,";")+a.substring(f,a.length));for(var g=d.exec(a||""),h={},i=14;i--;)h[e[i]]=g[i]||"";return c!=-1&&f!=-1&&(h.source=b,h.host=h.host.substring(1,h.host.length-1).replace(/;/g,":"),h.authority=h.authority.replace("[","").replace("]","").replace(/;/g,":"),h.ipv6uri=!0),h}},{}],37:[function(a,b,c){function d(a,b,c){var d;return d=b?new f(a,b):new f(a)}var e=function(){return this}(),f=e.WebSocket||e.MozWebSocket;b.exports=f?d:null,f&&(d.prototype=f.prototype)},{}],38:[function(a,b,c){(function(c){function d(a){function b(a){if(!a)return!1;if(c.Buffer&&c.Buffer.isBuffer(a)||c.ArrayBuffer&&a instanceof ArrayBuffer||c.Blob&&a instanceof Blob||c.File&&a instanceof File)return!0;if(e(a)){for(var d=0;d<a.length;d++)if(b(a[d]))return!0}else if(a&&"object"==typeof a){a.toJSON&&(a=a.toJSON());for(var f in a)if(Object.prototype.hasOwnProperty.call(a,f)&&b(a[f]))return!0}return!1}return b(a)}var e=a("isarray");b.exports=d}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:39}],39:[function(a,b,c){b.exports=a(32)},{}],40:[function(a,b,c){var d=a("global");try{b.exports="XMLHttpRequest"in d&&"withCredentials"in new d.XMLHttpRequest}catch(a){b.exports=!1}},{global:41}],41:[function(a,b,c){b.exports=function(){return this}()},{}],42:[function(a,b,c){var d=[].indexOf;b.exports=function(a,b){if(d)return a.indexOf(b);for(var c=0;c<a.length;++c)if(a[c]===b)return c;return-1}},{}],43:[function(a,b,c){var d=Object.prototype.hasOwnProperty;c.keys=Object.keys||function(a){var b=[];for(var c in a)d.call(a,c)&&b.push(c);return b},c.values=function(a){var b=[];for(var c in a)d.call(a,c)&&b.push(a[c]);return b},c.merge=function(a,b){for(var c in b)d.call(b,c)&&(a[c]=b[c]);return a},c.length=function(a){return c.keys(a).length},c.isEmpty=function(a){return 0==c.length(a)}},{}],44:[function(a,b,c){var d=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];b.exports=function(a){for(var b=d.exec(a||""),c={},f=14;f--;)c[e[f]]=b[f]||"";return c}},{}],45:[function(a,b,c){(function(b){var d=a("isarray"),e=a("./is-buffer");c.deconstructPacket=function(a){function b(a){if(!a)return a;if(e(a)){var f={_placeholder:!0,num:c.length};return c.push(a),f}if(d(a)){for(var g=new Array(a.length),h=0;h<a.length;h++)g[h]=b(a[h]);return g}if("object"==typeof a&&!(a instanceof Date)){var g={};for(var i in a)g[i]=b(a[i]);return g}return a}var c=[],f=a.data,g=a;return g.data=b(f),g.attachments=c.length,{packet:g,buffers:c}},c.reconstructPacket=function(a,b){function c(a){if(a&&a._placeholder){var e=b[a.num];return e}if(d(a)){for(var f=0;f<a.length;f++)a[f]=c(a[f]);return a}if(a&&"object"==typeof a){for(var g in a)a[g]=c(a[g]);return a}return a}return a.data=c(a.data),a.attachments=void 0,a},c.removeBlobs=function(a,c){function f(a,i,j){if(!a)return a;if(b.Blob&&a instanceof Blob||b.File&&a instanceof File){g++;var k=new FileReader;k.onload=function(){j?j[i]=this.result:h=this.result,--g||c(h)},k.readAsArrayBuffer(a)}else if(d(a))for(var l=0;l<a.length;l++)f(a[l],l,a);else if(a&&"object"==typeof a&&!e(a))for(var m in a)f(a[m],m,a)}var g=0,h=a;f(h),g||c(h)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-buffer":47,isarray:48}],46:[function(a,b,c){function d(){}function e(a){var b="",d=!1;return b+=a.type,c.BINARY_EVENT!=a.type&&c.BINARY_ACK!=a.type||(b+=a.attachments,b+="-"),a.nsp&&"/"!=a.nsp&&(d=!0,b+=a.nsp),null!=a.id&&(d&&(b+=",",d=!1),b+=a.id),null!=a.data&&(d&&(b+=","),b+=l.stringify(a.data)),k("encoded %j as %s",a,b),b}function f(a,b){function c(a){var c=n.deconstructPacket(a),d=e(c.packet),f=c.buffers;f.unshift(d),b(f)}n.removeBlobs(a,c)}function g(){this.reconstructor=null}function h(a){var b={},d=0;if(b.type=Number(a.charAt(0)),null==c.types[b.type])return j();if(c.BINARY_EVENT==b.type||c.BINARY_ACK==b.type){for(var e="";"-"!=a.charAt(++d)&&(e+=a.charAt(d),d!=a.length););if(e!=Number(e)||"-"!=a.charAt(d))throw new Error("Illegal attachments");b.attachments=Number(e)}if("/"==a.charAt(d+1))for(b.nsp="";++d;){var f=a.charAt(d);if(","==f)break;if(b.nsp+=f,d==a.length)break}else b.nsp="/";var g=a.charAt(d+1);if(""!==g&&Number(g)==g){for(b.id="";++d;){var f=a.charAt(d);if(null==f||Number(f)!=f){--d;break}if(b.id+=a.charAt(d),d==a.length)break}b.id=Number(b.id)}if(a.charAt(++d))try{b.data=l.parse(a.substr(d))}catch(a){return j()}return k("decoded %s as %j",a,b),b}function i(a){this.reconPack=a,this.buffers=[]}function j(a){return{type:c.ERROR,data:"parser error"}}var k=a("debug")("socket.io-parser"),l=a("json3"),m=(a("isarray"),a("component-emitter")),n=a("./binary"),o=a("./is-buffer");c.protocol=4,c.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],c.CONNECT=0,c.DISCONNECT=1,c.EVENT=2,c.ACK=3,c.ERROR=4,c.BINARY_EVENT=5,c.BINARY_ACK=6,c.Encoder=d,c.Decoder=g,d.prototype.encode=function(a,b){if(k("encoding packet %j",a),c.BINARY_EVENT==a.type||c.BINARY_ACK==a.type)f(a,b);else{var d=e(a);b([d])}},m(g.prototype),g.prototype.add=function(a){var b;if("string"==typeof a)b=h(a),c.BINARY_EVENT==b.type||c.BINARY_ACK==b.type?(this.reconstructor=new i(b),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",b)):this.emit("decoded",b);else{if(!o(a)&&!a.base64)throw new Error("Unknown type: "+a);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");b=this.reconstructor.takeBinaryData(a),b&&(this.reconstructor=null,this.emit("decoded",b))}},g.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},i.prototype.takeBinaryData=function(a){if(this.buffers.push(a),this.buffers.length==this.reconPack.attachments){var b=n.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),b}return null},i.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{"./binary":45,"./is-buffer":47,"component-emitter":9,debug:10,isarray:48,json3:49}],47:[function(a,b,c){(function(a){function c(b){return a.Buffer&&a.Buffer.isBuffer(b)||a.ArrayBuffer&&b instanceof ArrayBuffer}b.exports=c}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],48:[function(a,b,c){b.exports=a(32)},{}],49:[function(b,c,d){!function(b){function c(a){if(c[a]!==g)return c[a];var b;if("bug-string-char-index"==a)b="a"!="a"[0];else if("json"==a)b=c("json-stringify")&&c("json-parse");else{var d,e='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==a){var f=k.stringify,i="function"==typeof f&&l;if(i){(d=function(){return 1}).toJSON=d;try{i="0"===f(0)&&"0"===f(new Number)&&'""'==f(new String)&&f(h)===g&&f(g)===g&&f()===g&&"1"===f(d)&&"[1]"==f([d])&&"[null]"==f([g])&&"null"==f(null)&&"[null,null,null]"==f([g,h,null])&&f({a:[d,!0,!1,null,"\0\b\n\f\r\t"]})==e&&"1"===f(null,d)&&"[\n 1,\n 2\n]"==f([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==f(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==f(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==f(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==f(new Date(-1))}catch(a){i=!1}}b=i}if("json-parse"==a){var j=k.parse;if("function"==typeof j)try{if(0===j("0")&&!j(!1)){d=j(e);var m=5==d.a.length&&1===d.a[0];if(m){try{m=!j('"\t"')}catch(a){}if(m)try{m=1!==j("01")}catch(a){}if(m)try{m=1!==j("1.")}catch(a){}}}}catch(a){m=!1}b=m}}return c[a]=!!b}var e,f,g,h={}.toString,i="function"==typeof a&&a.amd,j="object"==typeof JSON&&JSON,k="object"==typeof d&&d&&!d.nodeType&&d;k&&j?(k.stringify=j.stringify,k.parse=j.parse):k=b.JSON=j||{};var l=new Date(-0xc782b5b800cec);try{l=l.getUTCFullYear()==-109252&&0===l.getUTCMonth()&&1===l.getUTCDate()&&10==l.getUTCHours()&&37==l.getUTCMinutes()&&6==l.getUTCSeconds()&&708==l.getUTCMilliseconds()}catch(a){}if(!c("json")){var m="[object Function]",n="[object Date]",o="[object Number]",p="[object String]",q="[object Array]",r="[object Boolean]",s=c("bug-string-char-index");if(!l)var t=Math.floor,u=[0,31,59,90,120,151,181,212,243,273,304,334],v=function(a,b){return u[b]+365*(a-1970)+t((a-1969+(b=+(b>1)))/4)-t((a-1901+b)/100)+t((a-1601+b)/400)};(e={}.hasOwnProperty)||(e=function(a){var b,c={};return(c.__proto__=null,c.__proto__={toString:1},c).toString!=h?e=function(a){var b=this.__proto__,c=a in(this.__proto__=null,this);return this.__proto__=b,c}:(b=c.constructor,e=function(a){var c=(this.constructor||b).prototype;return a in this&&!(a in c&&this[a]===c[a])}),c=null,e.call(this,a)});var w={boolean:1,number:1,string:1,undefined:1},x=function(a,b){var c=typeof a[b];return"object"==c?!!a[b]:!w[c]};if(f=function(a,b){var c,d,g,i=0;(c=function(){this.valueOf=0}).prototype.valueOf=0,d=new c;for(g in d)e.call(d,g)&&i++;return c=d=null,i?f=2==i?function(a,b){var c,d={},f=h.call(a)==m;for(c in a)f&&"prototype"==c||e.call(d,c)||!(d[c]=1)||!e.call(a,c)||b(c)}:function(a,b){var c,d,f=h.call(a)==m;for(c in a)f&&"prototype"==c||!e.call(a,c)||(d="constructor"===c)||b(c);(d||e.call(a,c="constructor"))&&b(c)}:(d=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],f=function(a,b){var c,f,g=h.call(a)==m,i=!g&&"function"!=typeof a.constructor&&x(a,"hasOwnProperty")?a.hasOwnProperty:e;for(c in a)g&&"prototype"==c||!i.call(a,c)||b(c);for(f=d.length;c=d[--f];i.call(a,c)&&b(c));}),f(a,b)},!c("json-stringify")){var y={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},z="000000",A=function(a,b){return(z+(b||0)).slice(-a)},B="\\u00",C=function(a){var b,c='"',d=0,e=a.length,f=e>10&&s;for(f&&(b=a.split(""));d<e;d++){var g=a.charCodeAt(d);switch(g){case 8:case 9:case 10:case 12:case 13:case 34:case 92:c+=y[g];break;default:if(g<32){c+=B+A(2,g.toString(16));break}c+=f?b[d]:s?a.charAt(d):a[d]}}return c+'"'},D=function(a,b,c,d,i,j,k){var l,m,s,u,w,x,y,z,B,E,F,G,H,I,J,K;try{l=b[a]}catch(a){}if("object"==typeof l&&l)if(m=h.call(l),m!=n||e.call(l,"toJSON"))"function"==typeof l.toJSON&&(m!=o&&m!=p&&m!=q||e.call(l,"toJSON"))&&(l=l.toJSON(a));else if(l>-1/0&&l<1/0){if(v){for(w=t(l/864e5),s=t(w/365.2425)+1970-1;v(s+1,0)<=w;s++);for(u=t((w-v(s,0))/30.42);v(s,u+1)<=w;u++);w=1+w-v(s,u),x=(l%864e5+864e5)%864e5,y=t(x/36e5)%24,z=t(x/6e4)%60,B=t(x/1e3)%60,E=x%1e3}else s=l.getUTCFullYear(),u=l.getUTCMonth(),w=l.getUTCDate(),y=l.getUTCHours(),z=l.getUTCMinutes(),B=l.getUTCSeconds(),E=l.getUTCMilliseconds();l=(s<=0||s>=1e4?(s<0?"-":"+")+A(6,s<0?-s:s):A(4,s))+"-"+A(2,u+1)+"-"+A(2,w)+"T"+A(2,y)+":"+A(2,z)+":"+A(2,B)+"."+A(3,E)+"Z"}else l=null;if(c&&(l=c.call(b,a,l)),null===l)return"null";if(m=h.call(l),m==r)return""+l;if(m==o)return l>-1/0&&l<1/0?""+l:"null";if(m==p)return C(""+l);if("object"==typeof l){for(I=k.length;I--;)if(k[I]===l)throw TypeError();if(k.push(l),F=[],J=j,j+=i,m==q){for(H=0,I=l.length;H<I;H++)G=D(H,l,c,d,i,j,k),F.push(G===g?"null":G);K=F.length?i?"[\n"+j+F.join(",\n"+j)+"\n"+J+"]":"["+F.join(",")+"]":"[]"}else f(d||l,function(a){var b=D(a,l,c,d,i,j,k);b!==g&&F.push(C(a)+":"+(i?" ":"")+b)}),K=F.length?i?"{\n"+j+F.join(",\n"+j)+"\n"+J+"}":"{"+F.join(",")+"}":"{}";return k.pop(),K}};k.stringify=function(a,b,c){var d,e,f,g;if("function"==typeof b||"object"==typeof b&&b)if((g=h.call(b))==m)e=b;else if(g==q){f={};for(var i,j=0,k=b.length;j<k;i=b[j++],g=h.call(i),(g==p||g==o)&&(f[i]=1));}if(c)if((g=h.call(c))==o){if((c-=c%1)>0)for(d="",c>10&&(c=10);d.length<c;d+=" ");}else g==p&&(d=c.length<=10?c:c.slice(0,10));return D("",(i={},i[""]=a,i),e,f,d,"",[])}}if(!c("json-parse")){var E,F,G=String.fromCharCode,H={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},I=function(){throw E=F=null,SyntaxError()},J=function(){for(var a,b,c,d,e,f=F,g=f.length;E<g;)switch(e=f.charCodeAt(E)){case 9:case 10:case 13:case 32:E++;break;case 123:case 125:case 91:case 93:case 58:case 44:return a=s?f.charAt(E):f[E],E++,a;case 34:for(a="@",E++;E<g;)if(e=f.charCodeAt(E),e<32)I();else if(92==e)switch(e=f.charCodeAt(++E)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:a+=H[e],E++;break;case 117:for(b=++E,c=E+4;E<c;E++)e=f.charCodeAt(E),e>=48&&e<=57||e>=97&&e<=102||e>=65&&e<=70||I();a+=G("0x"+f.slice(b,E));break;default:I()}else{if(34==e)break;for(e=f.charCodeAt(E),b=E;e>=32&&92!=e&&34!=e;)e=f.charCodeAt(++E);a+=f.slice(b,E)}if(34==f.charCodeAt(E))return E++,a;I();default:if(b=E,45==e&&(d=!0,e=f.charCodeAt(++E)),e>=48&&e<=57){for(48==e&&(e=f.charCodeAt(E+1),e>=48&&e<=57)&&I(),d=!1;E<g&&(e=f.charCodeAt(E),e>=48&&e<=57);E++);if(46==f.charCodeAt(E)){for(c=++E;c<g&&(e=f.charCodeAt(c),e>=48&&e<=57);c++);c==E&&I(),E=c}if(e=f.charCodeAt(E),101==e||69==e){for(e=f.charCodeAt(++E),43!=e&&45!=e||E++,c=E;c<g&&(e=f.charCodeAt(c),e>=48&&e<=57);c++);c==E&&I(),E=c}return+f.slice(b,E)}if(d&&I(),"true"==f.slice(E,E+4))return E+=4,!0;if("false"==f.slice(E,E+5))return E+=5,!1;if("null"==f.slice(E,E+4))return E+=4,null;I()}return"$"},K=function(a){var b,c;if("$"==a&&I(),"string"==typeof a){if("@"==(s?a.charAt(0):a[0]))return a.slice(1);if("["==a){for(b=[];a=J(),"]"!=a;c||(c=!0))c&&(","==a?(a=J(),"]"==a&&I()):I()),","==a&&I(),b.push(K(a));return b}if("{"==a){for(b={};a=J(),"}"!=a;c||(c=!0))c&&(","==a?(a=J(),"}"==a&&I()):I()),","!=a&&"string"==typeof a&&"@"==(s?a.charAt(0):a[0])&&":"==J()||I(),b[a.slice(1)]=K(J());return b}I()}return a},L=function(a,b,c){var d=M(a,b,c);d===g?delete a[b]:a[b]=d},M=function(a,b,c){var d,e=a[b];if("object"==typeof e&&e)if(h.call(e)==q)for(d=e.length;d--;)L(e,d,c);else f(e,function(a){L(e,a,c)});return c.call(a,b,e)};k.parse=function(a,b){var c,d;return E=0,F=""+a,c=K(J()),"$"!=J()&&I(),E=F=null,b&&h.call(b)==m?M((d={},d[""]=c,d),"",b):c}}}i&&a(function(){return k})}(this)},{}],50:[function(a,b,c){function d(a,b){var c=[];b=b||0;for(var d=b||0;d<a.length;d++)c[d-b]=a[d];return c}b.exports=d},{}]},{},[1])(1)}),!function(a){"function"==typeof define&&define.amd?define("picker",["jquery"],a):"object"==typeof exports?module.exports=a(require("jquery")):this.Picker=a(jQuery)}(function(a){function b(f,g,i,m){function n(){return b._.node("div",b._.node("div",b._.node("div",b._.node("div",B.component.nodes(w.open),y.box),y.wrap),y.frame),y.holder,'tabindex="-1"')}function o(){z.data(g,B).addClass(y.input).val(z.data("value")?B.get("select",x.format):f.value),x.editable||z.on("focus."+w.id+" click."+w.id,function(a){a.preventDefault(),B.open()}).on("keydown."+w.id,u),e(f,{haspopup:!0,expanded:!1,readonly:!1,owns:f.id+"_root"})}function p(){e(B.$root[0],"hidden",!0)}function q(){B.$holder.on({keydown:u,"focus.toOpen":t,blur:function(){z.removeClass(y.target)},focusin:function(a){B.$root.removeClass(y.focused),a.stopPropagation()},"mousedown click":function(b){var c=b.target;c!=B.$holder[0]&&(b.stopPropagation(),"mousedown"!=b.type||a(c).is("input, select, textarea, button, option")||(b.preventDefault(),B.$holder[0].focus()))}}).on("click","[data-pick], [data-nav], [data-clear], [data-close]",function(){var b=a(this),c=b.data(),d=b.hasClass(y.navDisabled)||b.hasClass(y.disabled),e=h();
e=e&&(e.type||e.href),(d||e&&!a.contains(B.$root[0],e))&&B.$holder[0].focus(),!d&&c.nav?B.set("highlight",B.component.item.highlight,{nav:c.nav}):!d&&"pick"in c?(B.set("select",c.pick),x.closeOnSelect&&B.close(!0)):c.clear?(B.clear(),x.closeOnClear&&B.close(!0)):c.close&&B.close(!0)})}function r(){var b;x.hiddenName===!0?(b=f.name,f.name=""):(b=["string"==typeof x.hiddenPrefix?x.hiddenPrefix:"","string"==typeof x.hiddenSuffix?x.hiddenSuffix:"_submit"],b=b[0]+f.name+b[1]),B._hidden=a('<input type=hidden name="'+b+'"'+(z.data("value")||f.value?' value="'+B.get("select",x.formatSubmit)+'"':"")+">")[0],z.on("change."+w.id,function(){B._hidden.value=f.value?B.get("select",x.formatSubmit):""})}function s(){v&&l?B.$holder.find("."+y.frame).one("transitionend",function(){B.$holder[0].focus()}):B.$holder[0].focus()}function t(a){a.stopPropagation(),z.addClass(y.target),B.$root.addClass(y.focused),B.open()}function u(a){var b=a.keyCode,c=/^(8|46)$/.test(b);return 27==b?(B.close(!0),!1):void((32==b||c||!w.open&&B.component.key[b])&&(a.preventDefault(),a.stopPropagation(),c?B.clear().close():B.open()))}if(!f)return b;var v=!1,w={id:f.id||"P"+Math.abs(~~(Math.random()*new Date))},x=i?a.extend(!0,{},i.defaults,m):m||{},y=a.extend({},b.klasses(),x.klass),z=a(f),A=function(){return this.start()},B=A.prototype={constructor:A,$node:z,start:function(){return w&&w.start?B:(w.methods={},w.start=!0,w.open=!1,w.type=f.type,f.autofocus=f==h(),f.readOnly=!x.editable,f.id=f.id||w.id,"text"!=f.type&&(f.type="text"),B.component=new i(B,x),B.$root=a('<div class="'+y.picker+'" id="'+f.id+'_root" />'),p(),B.$holder=a(n()).appendTo(B.$root),q(),x.formatSubmit&&r(),o(),x.containerHidden?a(x.containerHidden).append(B._hidden):z.after(B._hidden),x.container?a(x.container).append(B.$root):z.after(B.$root),B.on({start:B.component.onStart,render:B.component.onRender,stop:B.component.onStop,open:B.component.onOpen,close:B.component.onClose,set:B.component.onSet}).on({start:x.onStart,render:x.onRender,stop:x.onStop,open:x.onOpen,close:x.onClose,set:x.onSet}),v=c(B.$holder[0]),f.autofocus&&B.open(),B.trigger("start").trigger("render"))},render:function(b){return b?(B.$holder=a(n()),q(),B.$root.html(B.$holder)):B.$root.find("."+y.box).html(B.component.nodes(w.open)),B.trigger("render")},stop:function(){return w.start?(B.close(),B._hidden&&B._hidden.parentNode.removeChild(B._hidden),B.$root.remove(),z.removeClass(y.input).removeData(g),setTimeout(function(){z.off("."+w.id)},0),f.type=w.type,f.readOnly=!1,B.trigger("stop"),w.methods={},w.start=!1,B):B},open:function(c){return w.open?B:(z.addClass(y.active),e(f,"expanded",!0),setTimeout(function(){B.$root.addClass(y.opened),e(B.$root[0],"hidden",!1)},0),c!==!1&&(w.open=!0,v&&k.css("overflow","hidden").css("padding-right","+="+d()),s(),j.on("click."+w.id+" focusin."+w.id,function(a){var b=a.target;b!=f&&b!=document&&3!=a.which&&B.close(b===B.$holder[0])}).on("keydown."+w.id,function(c){var d=c.keyCode,e=B.component.key[d],f=c.target;27==d?B.close(!0):f!=B.$holder[0]||!e&&13!=d?a.contains(B.$root[0],f)&&13==d&&(c.preventDefault(),f.click()):(c.preventDefault(),e?b._.trigger(B.component.key.go,B,[b._.trigger(e)]):B.$root.find("."+y.highlighted).hasClass(y.disabled)||(B.set("select",B.component.item.highlight),x.closeOnSelect&&B.close(!0)))})),B.trigger("open"))},close:function(a){return a&&(x.editable?f.focus():(B.$holder.off("focus.toOpen").focus(),setTimeout(function(){B.$holder.on("focus.toOpen",t)},0))),z.removeClass(y.active),e(f,"expanded",!1),setTimeout(function(){B.$root.removeClass(y.opened+" "+y.focused),e(B.$root[0],"hidden",!0)},0),w.open?(w.open=!1,v&&k.css("overflow","").css("padding-right","-="+d()),j.off("."+w.id),B.trigger("close")):B},clear:function(a){return B.set("clear",null,a)},set:function(b,c,d){var e,f,g=a.isPlainObject(b),h=g?b:{};if(d=g&&a.isPlainObject(c)?c:d||{},b){g||(h[b]=c);for(e in h)f=h[e],e in B.component.item&&(void 0===f&&(f=null),B.component.set(e,f,d)),("select"==e||"clear"==e)&&z.val("clear"==e?"":B.get(e,x.format)).trigger("change");B.render()}return d.muted?B:B.trigger("set",h)},get:function(a,c){if(a=a||"value",null!=w[a])return w[a];if("valueSubmit"==a){if(B._hidden)return B._hidden.value;a="value"}if("value"==a)return f.value;if(a in B.component.item){if("string"==typeof c){var d=B.component.get(a);return d?b._.trigger(B.component.formats.toString,B.component,[c,d]):""}return B.component.get(a)}},on:function(b,c,d){var e,f,g=a.isPlainObject(b),h=g?b:{};if(b){g||(h[b]=c);for(e in h)f=h[e],d&&(e="_"+e),w.methods[e]=w.methods[e]||[],w.methods[e].push(f)}return B},off:function(){var a,b,c=arguments;for(a=0,namesCount=c.length;a<namesCount;a+=1)b=c[a],b in w.methods&&delete w.methods[b];return B},trigger:function(a,c){var d=function(a){var d=w.methods[a];d&&d.map(function(a){b._.trigger(a,B,[c])})};return d("_"+a),d(a),B}};return new A}function c(a){var b,c="position";return a.currentStyle?b=a.currentStyle[c]:window.getComputedStyle&&(b=getComputedStyle(a)[c]),"fixed"==b}function d(){if(k.height()<=i.height())return 0;var b=a('<div style="visibility:hidden;width:100px" />').appendTo("body"),c=b[0].offsetWidth;b.css("overflow","scroll");var d=a('<div style="width:100%" />').appendTo(b),e=d[0].offsetWidth;return b.remove(),c-e}function e(b,c,d){if(a.isPlainObject(c))for(var e in c)f(b,e,c[e]);else f(b,c,d)}function f(a,b,c){a.setAttribute(("role"==b?"":"aria-")+b,c)}function g(b,c){a.isPlainObject(b)||(b={attribute:c}),c="";for(var d in b){var e=("role"==d?"":"aria-")+d,f=b[d];c+=null==f?"":e+'="'+b[d]+'"'}return c}function h(){try{return document.activeElement}catch(a){}}var i=a(window),j=a(document),k=a(document.documentElement),l=null!=document.documentElement.style.transition;return b.klasses=function(a){return a=a||"picker",{picker:a,opened:a+"--opened",focused:a+"--focused",input:a+"__input",active:a+"__input--active",target:a+"__input--target",holder:a+"__holder",frame:a+"__frame",wrap:a+"__wrap",box:a+"__box"}},b._={group:function(a){for(var c,d="",e=b._.trigger(a.min,a);e<=b._.trigger(a.max,a,[e]);e+=a.i)c=b._.trigger(a.item,a,[e]),d+=b._.node(a.node,c[0],c[1],c[2]);return d},node:function(b,c,d,e){return c?(c=a.isArray(c)?c.join(""):c,d=d?' class="'+d+'"':"",e=e?" "+e:"","<"+b+d+e+">"+c+"</"+b+">"):""},lead:function(a){return(10>a?"0":"")+a},trigger:function(a,b,c){return"function"==typeof a?a.apply(b,c||[]):a},digits:function(a){return/\d/.test(a[1])?2:1},isDate:function(a){return{}.toString.call(a).indexOf("Date")>-1&&this.isInteger(a.getDate())},isInteger:function(a){return{}.toString.call(a).indexOf("Number")>-1&&a%1===0},ariaAttr:g},b.extend=function(c,d){a.fn[c]=function(e,f){var g=this.data(c);return"picker"==e?g:g&&"string"==typeof e?b._.trigger(g[e],g,[f]):this.each(function(){var f=a(this);f.data(c)||new b(this,c,d,e)})},a.fn[c].defaults=d.defaults},b}),!function(a){"function"==typeof define&&define.amd?define(["picker","jquery"],a):"object"==typeof exports?module.exports=a(require("./picker.js"),require("jquery")):a(Picker,jQuery)}(function(a,b){function c(a,b){var c=this,d=a.$node[0],e=d.value,f=a.$node.data("value"),g=f||e,h=f?b.formatSubmit:b.format,i=function(){return d.currentStyle?"rtl"==d.currentStyle.direction:"rtl"==getComputedStyle(a.$root[0]).direction};c.settings=b,c.$node=a.$node,c.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse navigate create validate",view:"parse create validate viewset",disable:"deactivate",enable:"activate"},c.item={},c.item.clear=null,c.item.disable=(b.disable||[]).slice(0),c.item.enable=-function(a){return a[0]===!0?a.shift():-1}(c.item.disable),c.set("min",b.min).set("max",b.max).set("now"),g?c.set("select",g,{format:h,defaultValue:!0}):c.set("select",null).set("highlight",c.item.now),c.key={40:7,38:-7,39:function(){return i()?-1:1},37:function(){return i()?1:-1},go:function(a){var b=c.item.highlight,d=new Date(b.year,b.month,b.date+a);c.set("highlight",d,{interval:a}),this.render()}},a.on("render",function(){a.$root.find("."+b.klass.selectMonth).on("change",function(){var c=this.value;c&&(a.set("highlight",[a.get("view").year,c,a.get("highlight").date]),a.$root.find("."+b.klass.selectMonth).trigger("focus"))}),a.$root.find("."+b.klass.selectYear).on("change",function(){var c=this.value;c&&(a.set("highlight",[c,a.get("view").month,a.get("highlight").date]),a.$root.find("."+b.klass.selectYear).trigger("focus"))})},1).on("open",function(){var d="";c.disabled(c.get("now"))&&(d=":not(."+b.klass.buttonToday+")"),a.$root.find("button"+d+", select").attr("disabled",!1)},1).on("close",function(){a.$root.find("button, select").attr("disabled",!0)},1)}var d=7,e=6,f=a._;c.prototype.set=function(a,b,c){var d=this,e=d.item;return null===b?("clear"==a&&(a="select"),e[a]=b,d):(e["enable"==a?"disable":"flip"==a?"enable":a]=d.queue[a].split(" ").map(function(e){return b=d[e](a,b,c)}).pop(),"select"==a?d.set("highlight",e.select,c):"highlight"==a?d.set("view",e.highlight,c):a.match(/^(flip|min|max|disable|enable)$/)&&(e.select&&d.disabled(e.select)&&d.set("select",e.select,c),e.highlight&&d.disabled(e.highlight)&&d.set("highlight",e.highlight,c)),d)},c.prototype.get=function(a){return this.item[a]},c.prototype.create=function(a,c,d){var e,g=this;return c=void 0===c?a:c,c==-(1/0)||c==1/0?e=c:b.isPlainObject(c)&&f.isInteger(c.pick)?c=c.obj:b.isArray(c)?(c=new Date(c[0],c[1],c[2]),c=f.isDate(c)?c:g.create().obj):c=f.isInteger(c)||f.isDate(c)?g.normalize(new Date(c),d):g.now(a,c,d),{year:e||c.getFullYear(),month:e||c.getMonth(),date:e||c.getDate(),day:e||c.getDay(),obj:e||c,pick:e||c.getTime()}},c.prototype.createRange=function(a,c){var d=this,e=function(a){return a===!0||b.isArray(a)||f.isDate(a)?d.create(a):a};return f.isInteger(a)||(a=e(a)),f.isInteger(c)||(c=e(c)),f.isInteger(a)&&b.isPlainObject(c)?a=[c.year,c.month,c.date+a]:f.isInteger(c)&&b.isPlainObject(a)&&(c=[a.year,a.month,a.date+c]),{from:e(a),to:e(c)}},c.prototype.withinRange=function(a,b){return a=this.createRange(a.from,a.to),b.pick>=a.from.pick&&b.pick<=a.to.pick},c.prototype.overlapRanges=function(a,b){var c=this;return a=c.createRange(a.from,a.to),b=c.createRange(b.from,b.to),c.withinRange(a,b.from)||c.withinRange(a,b.to)||c.withinRange(b,a.from)||c.withinRange(b,a.to)},c.prototype.now=function(a,b,c){return b=new Date,c&&c.rel&&b.setDate(b.getDate()+c.rel),this.normalize(b,c)},c.prototype.navigate=function(a,c,d){var e,f,g,h,i=b.isArray(c),j=b.isPlainObject(c),k=this.item.view;if(i||j){for(j?(f=c.year,g=c.month,h=c.date):(f=+c[0],g=+c[1],h=+c[2]),d&&d.nav&&k&&k.month!==g&&(f=k.year,g=k.month),e=new Date(f,g+(d&&d.nav?d.nav:0),1),f=e.getFullYear(),g=e.getMonth();new Date(f,g,h).getMonth()!==g;)h-=1;c=[f,g,h]}return c},c.prototype.normalize=function(a){return a.setHours(0,0,0,0),a},c.prototype.measure=function(a,b){var c=this;return b?"string"==typeof b?b=c.parse(a,b):f.isInteger(b)&&(b=c.now(a,b,{rel:b})):b="min"==a?-(1/0):1/0,b},c.prototype.viewset=function(a,b){return this.create([b.year,b.month,1])},c.prototype.validate=function(a,c,d){var e,g,h,i,j=this,k=c,l=d&&d.interval?d.interval:1,m=-1===j.item.enable,n=j.item.min,o=j.item.max,p=m&&j.item.disable.filter(function(a){if(b.isArray(a)){var d=j.create(a).pick;d<c.pick?e=!0:d>c.pick&&(g=!0)}return f.isInteger(a)}).length;if((!d||!d.nav&&!d.defaultValue)&&(!m&&j.disabled(c)||m&&j.disabled(c)&&(p||e||g)||!m&&(c.pick<=n.pick||c.pick>=o.pick)))for(m&&!p&&(!g&&l>0||!e&&0>l)&&(l*=-1);j.disabled(c)&&(Math.abs(l)>1&&(c.month<k.month||c.month>k.month)&&(c=k,l=l>0?1:-1),c.pick<=n.pick?(h=!0,l=1,c=j.create([n.year,n.month,n.date+(c.pick===n.pick?0:-1)])):c.pick>=o.pick&&(i=!0,l=-1,c=j.create([o.year,o.month,o.date+(c.pick===o.pick?0:1)])),!h||!i);)c=j.create([c.year,c.month,c.date+l]);return c},c.prototype.disabled=function(a){var c=this,d=c.item.disable.filter(function(d){return f.isInteger(d)?a.day===(c.settings.firstDay?d:d-1)%7:b.isArray(d)||f.isDate(d)?a.pick===c.create(d).pick:b.isPlainObject(d)?c.withinRange(d,a):void 0});return d=d.length&&!d.filter(function(a){return b.isArray(a)&&"inverted"==a[3]||b.isPlainObject(a)&&a.inverted}).length,-1===c.item.enable?!d:d||a.pick<c.item.min.pick||a.pick>c.item.max.pick},c.prototype.parse=function(a,b,c){var d=this,e={};return b&&"string"==typeof b?(c&&c.format||(c=c||{},c.format=d.settings.format),d.formats.toArray(c.format).map(function(a){var c=d.formats[a],g=c?f.trigger(c,d,[b,e]):a.replace(/^!/,"").length;c&&(e[a]=b.substr(0,g)),b=b.substr(g)}),[e.yyyy||e.yy,+(e.mm||e.m)-1,e.dd||e.d]):b},c.prototype.formats=function(){function a(a,b,c){var d=a.match(/[^\x00-\x7F]+|\w+/)[0];return c.mm||c.m||(c.m=b.indexOf(d)+1),d.length}function b(a){return a.match(/\w+/)[0].length}return{d:function(a,b){return a?f.digits(a):b.date},dd:function(a,b){return a?2:f.lead(b.date)},ddd:function(a,c){return a?b(a):this.settings.weekdaysShort[c.day]},dddd:function(a,c){return a?b(a):this.settings.weekdaysFull[c.day]},m:function(a,b){return a?f.digits(a):b.month+1},mm:function(a,b){return a?2:f.lead(b.month+1)},mmm:function(b,c){var d=this.settings.monthsShort;return b?a(b,d,c):d[c.month]},mmmm:function(b,c){var d=this.settings.monthsFull;return b?a(b,d,c):d[c.month]},yy:function(a,b){return a?2:(""+b.year).slice(2)},yyyy:function(a,b){return a?4:b.year},toArray:function(a){return a.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(a,b){var c=this;return c.formats.toArray(a).map(function(a){return f.trigger(c.formats[a],c,[0,b])||a.replace(/^!/,"")}).join("")}}}(),c.prototype.isDateExact=function(a,c){var d=this;return f.isInteger(a)&&f.isInteger(c)||"boolean"==typeof a&&"boolean"==typeof c?a===c:(f.isDate(a)||b.isArray(a))&&(f.isDate(c)||b.isArray(c))?d.create(a).pick===d.create(c).pick:!(!b.isPlainObject(a)||!b.isPlainObject(c))&&(d.isDateExact(a.from,c.from)&&d.isDateExact(a.to,c.to))},c.prototype.isDateOverlap=function(a,c){var d=this,e=d.settings.firstDay?1:0;return f.isInteger(a)&&(f.isDate(c)||b.isArray(c))?(a=a%7+e,a===d.create(c).day+1):f.isInteger(c)&&(f.isDate(a)||b.isArray(a))?(c=c%7+e,c===d.create(a).day+1):!(!b.isPlainObject(a)||!b.isPlainObject(c))&&d.overlapRanges(a,c)},c.prototype.flipEnable=function(a){var b=this.item;b.enable=a||(-1==b.enable?1:-1)},c.prototype.deactivate=function(a,c){var d=this,e=d.item.disable.slice(0);return"flip"==c?d.flipEnable():c===!1?(d.flipEnable(1),e=[]):c===!0?(d.flipEnable(-1),e=[]):c.map(function(a){for(var c,g=0;g<e.length;g+=1)if(d.isDateExact(a,e[g])){c=!0;break}c||(f.isInteger(a)||f.isDate(a)||b.isArray(a)||b.isPlainObject(a)&&a.from&&a.to)&&e.push(a)}),e},c.prototype.activate=function(a,c){var d=this,e=d.item.disable,g=e.length;return"flip"==c?d.flipEnable():c===!0?(d.flipEnable(1),e=[]):c===!1?(d.flipEnable(-1),e=[]):c.map(function(a){var c,h,i,j;for(i=0;g>i;i+=1){if(h=e[i],d.isDateExact(h,a)){c=e[i]=null,j=!0;break}if(d.isDateOverlap(h,a)){b.isPlainObject(a)?(a.inverted=!0,c=a):b.isArray(a)?(c=a,c[3]||c.push("inverted")):f.isDate(a)&&(c=[a.getFullYear(),a.getMonth(),a.getDate(),"inverted"]);break}}if(c)for(i=0;g>i;i+=1)if(d.isDateExact(e[i],a)){e[i]=null;break}if(j)for(i=0;g>i;i+=1)if(d.isDateOverlap(e[i],a)){e[i]=null;break}c&&e.push(c)}),e.filter(function(a){return null!=a})},c.prototype.nodes=function(a){var b=this,c=b.settings,g=b.item,h=g.now,i=g.select,j=g.highlight,k=g.view,l=g.disable,m=g.min,n=g.max,o=function(a,b){return c.firstDay&&(a.push(a.shift()),b.push(b.shift())),f.node("thead",f.node("tr",f.group({min:0,max:d-1,i:1,node:"th",item:function(d){return[a[d],c.klass.weekdays,'scope=col title="'+b[d]+'"']}})))}((c.showWeekdaysFull?c.weekdaysFull:c.weekdaysShort).slice(0),c.weekdaysFull.slice(0)),p=function(a){return f.node("div"," ",c.klass["nav"+(a?"Next":"Prev")]+(a&&k.year>=n.year&&k.month>=n.month||!a&&k.year<=m.year&&k.month<=m.month?" "+c.klass.navDisabled:""),"data-nav="+(a||-1)+" "+f.ariaAttr({role:"button",controls:b.$node[0].id+"_table"})+' title="'+(a?c.labelMonthNext:c.labelMonthPrev)+'"')},q=function(){var d=c.showMonthsShort?c.monthsShort:c.monthsFull;return c.selectMonths?f.node("select",f.group({min:0,max:11,i:1,node:"option",item:function(a){return[d[a],0,"value="+a+(k.month==a?" selected":"")+(k.year==m.year&&a<m.month||k.year==n.year&&a>n.month?" disabled":"")]}}),c.klass.selectMonth,(a?"":"disabled")+" "+f.ariaAttr({controls:b.$node[0].id+"_table"})+' title="'+c.labelMonthSelect+'"'):f.node("div",d[k.month],c.klass.month)},r=function(){var d=k.year,e=c.selectYears===!0?5:~~(c.selectYears/2);if(e){var g=m.year,h=n.year,i=d-e,j=d+e;if(g>i&&(j+=g-i,i=g),j>h){var l=i-g,o=j-h;i-=l>o?o:l,j=h}return f.node("select",f.group({min:i,max:j,i:1,node:"option",item:function(a){return[a,0,"value="+a+(d==a?" selected":"")]}}),c.klass.selectYear,(a?"":"disabled")+" "+f.ariaAttr({controls:b.$node[0].id+"_table"})+' title="'+c.labelYearSelect+'"')}return f.node("div",d,c.klass.year)};return f.node("div",(c.selectYears?r()+q():q()+r())+p()+p(1),c.klass.header)+f.node("table",o+f.node("tbody",f.group({min:0,max:e-1,i:1,node:"tr",item:function(a){var e=c.firstDay&&0===b.create([k.year,k.month,1]).day?-7:0;return[f.group({min:d*a-k.day+e+1,max:function(){return this.min+d-1},i:1,node:"td",item:function(a){a=b.create([k.year,k.month,a+(c.firstDay?1:0)]);var d=i&&i.pick==a.pick,e=j&&j.pick==a.pick,g=l&&b.disabled(a)||a.pick<m.pick||a.pick>n.pick,o=f.trigger(b.formats.toString,b,[c.format,a]);return[f.node("div",a.date,function(b){return b.push(k.month==a.month?c.klass.infocus:c.klass.outfocus),h.pick==a.pick&&b.push(c.klass.now),d&&b.push(c.klass.selected),e&&b.push(c.klass.highlighted),g&&b.push(c.klass.disabled),b.join(" ")}([c.klass.day]),"data-pick="+a.pick+" "+f.ariaAttr({role:"gridcell",label:o,selected:!(!d||b.$node.val()!==o)||null,activedescendant:!!e||null,disabled:!!g||null})),"",f.ariaAttr({role:"presentation"})]}})]}})),c.klass.table,'id="'+b.$node[0].id+'_table" '+f.ariaAttr({role:"grid",controls:b.$node[0].id,readonly:!0}))+f.node("div",f.node("button",c.today,c.klass.buttonToday,"type=button data-pick="+h.pick+(a&&!b.disabled(h)?"":" disabled")+" "+f.ariaAttr({controls:b.$node[0].id}))+f.node("button",c.clear,c.klass.buttonClear,"type=button data-clear=1"+(a?"":" disabled")+" "+f.ariaAttr({controls:b.$node[0].id}))+f.node("button",c.close,c.klass.buttonClose,"type=button data-close=true "+(a?"":" disabled")+" "+f.ariaAttr({controls:b.$node[0].id})),c.klass.footer)},c.defaults=function(a){return{labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],today:"Today",clear:"Clear",close:"Close",closeOnSelect:!0,closeOnClear:!0,format:"d mmmm, yyyy",klass:{table:a+"table",header:a+"header",navPrev:a+"nav--prev",navNext:a+"nav--next",navDisabled:a+"nav--disabled",month:a+"month",year:a+"year",selectMonth:a+"select--month",selectYear:a+"select--year",weekdays:a+"weekday",day:a+"day",disabled:a+"day--disabled",selected:a+"day--selected",highlighted:a+"day--highlighted",now:a+"day--today",infocus:a+"day--infocus",outfocus:a+"day--outfocus",footer:a+"footer",buttonClear:a+"button--clear",buttonToday:a+"button--today",buttonClose:a+"button--close"}}}(a.klasses().picker+"__"),a.extend("pickadate",c)}),!function(a){"function"==typeof define&&define.amd?define(["picker","jquery"],a):"object"==typeof exports?module.exports=a(require("./picker.js"),require("jquery")):a(Picker,jQuery)}(function(a,b){function c(a,b){var c=this,d=a.$node[0].value,e=a.$node.data("value"),f=e||d,g=e?b.formatSubmit:b.format;c.settings=b,c.$node=a.$node,c.queue={interval:"i",min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse create validate",view:"parse create validate",disable:"deactivate",enable:"activate"},c.item={},c.item.clear=null,c.item.interval=b.interval||30,c.item.disable=(b.disable||[]).slice(0),c.item.enable=-function(a){return a[0]===!0?a.shift():-1}(c.item.disable),c.set("min",b.min).set("max",b.max).set("now"),f?c.set("select",f,{format:g}):c.set("select",null).set("highlight",c.item.now),c.key={40:1,38:-1,39:1,37:-1,go:function(a){c.set("highlight",c.item.highlight.pick+a*c.item.interval,{interval:a*c.item.interval}),this.render()}},a.on("render",function(){var c=a.$root.children(),d=c.find("."+b.klass.viewset),e=function(a){return["webkit","moz","ms","o",""].map(function(b){return(b?"-"+b+"-":"")+a})},f=function(a,b){e("transform").map(function(c){a.css(c,b)}),e("transition").map(function(c){a.css(c,b)})};d.length&&(f(c,"none"),c[0].scrollTop=~~d.position().top-2*d[0].clientHeight,f(c,""))},1).on("open",function(){a.$root.find("button").attr("disabled",!1)},1).on("close",function(){a.$root.find("button").attr("disabled",!0)},1)}var d=24,e=60,f=12,g=d*e,h=a._;c.prototype.set=function(a,b,c){var d=this,e=d.item;return null===b?("clear"==a&&(a="select"),e[a]=b,d):(e["enable"==a?"disable":"flip"==a?"enable":a]=d.queue[a].split(" ").map(function(e){return b=d[e](a,b,c)}).pop(),"select"==a?d.set("highlight",e.select,c):"highlight"==a?d.set("view",e.highlight,c):"interval"==a?d.set("min",e.min,c).set("max",e.max,c):a.match(/^(flip|min|max|disable|enable)$/)&&(e.select&&d.disabled(e.select)&&d.set("select",b,c),e.highlight&&d.disabled(e.highlight)&&d.set("highlight",b,c),"min"==a&&d.set("max",e.max,c)),d)},c.prototype.get=function(a){return this.item[a]},c.prototype.create=function(a,c,f){var i=this;return c=void 0===c?a:c,h.isDate(c)&&(c=[c.getHours(),c.getMinutes()]),b.isPlainObject(c)&&h.isInteger(c.pick)?c=c.pick:b.isArray(c)?c=+c[0]*e+ +c[1]:h.isInteger(c)||(c=i.now(a,c,f)),"max"==a&&c<i.item.min.pick&&(c+=g),"min"!=a&&"max"!=a&&(c-i.item.min.pick)%i.item.interval!==0&&(c+=i.item.interval),c=i.normalize(a,c,f),{hour:~~(d+c/e)%d,mins:(e+c%e)%e,time:(g+c)%g,pick:c%g}},c.prototype.createRange=function(a,c){var d=this,e=function(a){return a===!0||b.isArray(a)||h.isDate(a)?d.create(a):a};return h.isInteger(a)||(a=e(a)),h.isInteger(c)||(c=e(c)),h.isInteger(a)&&b.isPlainObject(c)?a=[c.hour,c.mins+a*d.settings.interval]:h.isInteger(c)&&b.isPlainObject(a)&&(c=[a.hour,a.mins+c*d.settings.interval]),{from:e(a),to:e(c)}},c.prototype.withinRange=function(a,b){return a=this.createRange(a.from,a.to),b.pick>=a.from.pick&&b.pick<=a.to.pick},c.prototype.overlapRanges=function(a,b){var c=this;return a=c.createRange(a.from,a.to),b=c.createRange(b.from,b.to),c.withinRange(a,b.from)||c.withinRange(a,b.to)||c.withinRange(b,a.from)||c.withinRange(b,a.to)},c.prototype.now=function(a,b){var c,d=this.item.interval,f=new Date,g=f.getHours()*e+f.getMinutes(),i=h.isInteger(b);return g-=g%d,c=0>b&&-d>=d*b+g,g+="min"==a&&c?0:d,i&&(g+=d*(c&&"max"!=a?b+1:b)),g},c.prototype.normalize=function(a,b){var c=this.item.interval,d=this.item.min&&this.item.min.pick||0;return b-="min"==a?0:(b-d)%c},c.prototype.measure=function(a,c,f){var g=this;return c||(c="min"==a?[0,0]:[d-1,e-1]),"string"==typeof c?c=g.parse(a,c):c===!0||h.isInteger(c)?c=g.now(a,c,f):b.isPlainObject(c)&&h.isInteger(c.pick)&&(c=g.normalize(a,c.pick,f)),c},c.prototype.validate=function(a,b,c){var d=this,e=c&&c.interval?c.interval:d.item.interval;return d.disabled(b)&&(b=d.shift(b,e)),b=d.scope(b),d.disabled(b)&&(b=d.shift(b,-1*e)),b},c.prototype.disabled=function(a){var c=this,d=c.item.disable.filter(function(d){return h.isInteger(d)?a.hour==d:b.isArray(d)||h.isDate(d)?a.pick==c.create(d).pick:b.isPlainObject(d)?c.withinRange(d,a):void 0});return d=d.length&&!d.filter(function(a){return b.isArray(a)&&"inverted"==a[2]||b.isPlainObject(a)&&a.inverted}).length,-1===c.item.enable?!d:d||a.pick<c.item.min.pick||a.pick>c.item.max.pick},c.prototype.shift=function(a,b){var c=this,d=c.item.min.pick,e=c.item.max.pick;for(b=b||c.item.interval;c.disabled(a)&&(a=c.create(a.pick+=b),!(a.pick<=d||a.pick>=e)););return a},c.prototype.scope=function(a){var b=this.item.min.pick,c=this.item.max.pick;return this.create(a.pick>c?c:a.pick<b?b:a)},c.prototype.parse=function(a,b,c){var d,f,g,i,j,k=this,l={};if(!b||"string"!=typeof b)return b;c&&c.format||(c=c||{},c.format=k.settings.format),k.formats.toArray(c.format).map(function(a){var c,d=k.formats[a],e=d?h.trigger(d,k,[b,l]):a.replace(/^!/,"").length;d&&(c=b.substr(0,e),l[a]=c.match(/^\d+$/)?+c:c),b=b.substr(e)});for(i in l)j=l[i],h.isInteger(j)?i.match(/^(h|hh)$/i)?(d=j,("h"==i||"hh"==i)&&(d%=12)):"i"==i&&(f=j):i.match(/^a$/i)&&j.match(/^p/i)&&("h"in l||"hh"in l)&&(g=!0);return(g?d+12:d)*e+f},c.prototype.formats={h:function(a,b){return a?h.digits(a):b.hour%f||f},hh:function(a,b){return a?2:h.lead(b.hour%f||f)},H:function(a,b){return a?h.digits(a):""+b.hour%24},HH:function(a,b){return a?h.digits(a):h.lead(b.hour%24)},i:function(a,b){return a?2:h.lead(b.mins)},a:function(a,b){return a?4:g/2>b.time%g?"a.m.":"p.m."},A:function(a,b){return a?2:g/2>b.time%g?"AM":"PM"},toArray:function(a){return a.split(/(h{1,2}|H{1,2}|i|a|A|!.)/g)},toString:function(a,b){var c=this;return c.formats.toArray(a).map(function(a){return h.trigger(c.formats[a],c,[0,b])||a.replace(/^!/,"")}).join("")}},c.prototype.isTimeExact=function(a,c){var d=this;return h.isInteger(a)&&h.isInteger(c)||"boolean"==typeof a&&"boolean"==typeof c?a===c:(h.isDate(a)||b.isArray(a))&&(h.isDate(c)||b.isArray(c))?d.create(a).pick===d.create(c).pick:!(!b.isPlainObject(a)||!b.isPlainObject(c))&&(d.isTimeExact(a.from,c.from)&&d.isTimeExact(a.to,c.to))},c.prototype.isTimeOverlap=function(a,c){var d=this;return h.isInteger(a)&&(h.isDate(c)||b.isArray(c))?a===d.create(c).hour:h.isInteger(c)&&(h.isDate(a)||b.isArray(a))?c===d.create(a).hour:!(!b.isPlainObject(a)||!b.isPlainObject(c))&&d.overlapRanges(a,c)},c.prototype.flipEnable=function(a){var b=this.item;b.enable=a||(-1==b.enable?1:-1)},c.prototype.deactivate=function(a,c){var d=this,e=d.item.disable.slice(0);return"flip"==c?d.flipEnable():c===!1?(d.flipEnable(1),e=[]):c===!0?(d.flipEnable(-1),e=[]):c.map(function(a){for(var c,f=0;f<e.length;f+=1)if(d.isTimeExact(a,e[f])){c=!0;break}c||(h.isInteger(a)||h.isDate(a)||b.isArray(a)||b.isPlainObject(a)&&a.from&&a.to)&&e.push(a)}),e},c.prototype.activate=function(a,c){var d=this,e=d.item.disable,f=e.length;return"flip"==c?d.flipEnable():c===!0?(d.flipEnable(1),e=[]):c===!1?(d.flipEnable(-1),e=[]):c.map(function(a){var c,g,i,j;for(i=0;f>i;i+=1){if(g=e[i],d.isTimeExact(g,a)){c=e[i]=null,j=!0;break}if(d.isTimeOverlap(g,a)){b.isPlainObject(a)?(a.inverted=!0,c=a):b.isArray(a)?(c=a,c[2]||c.push("inverted")):h.isDate(a)&&(c=[a.getFullYear(),a.getMonth(),a.getDate(),"inverted"]);break}}if(c)for(i=0;f>i;i+=1)if(d.isTimeExact(e[i],a)){e[i]=null;break}if(j)for(i=0;f>i;i+=1)if(d.isTimeOverlap(e[i],a)){e[i]=null;break}c&&e.push(c)}),e.filter(function(a){return null!=a})},c.prototype.i=function(a,b){return h.isInteger(b)&&b>0?b:this.item.interval},c.prototype.nodes=function(a){var b=this,c=b.settings,d=b.item.select,e=b.item.highlight,f=b.item.view,g=b.item.disable;return h.node("ul",h.group({min:b.item.min.pick,max:b.item.max.pick,i:b.item.interval,node:"li",item:function(a){a=b.create(a);var i=a.pick,j=d&&d.pick==i,k=e&&e.pick==i,l=g&&b.disabled(a),m=h.trigger(b.formats.toString,b,[c.format,a]);return[h.trigger(b.formats.toString,b,[h.trigger(c.formatLabel,b,[a])||c.format,a]),function(a){return j&&a.push(c.klass.selected),k&&a.push(c.klass.highlighted),f&&f.pick==i&&a.push(c.klass.viewset),l&&a.push(c.klass.disabled),a.join(" ")}([c.klass.listItem]),"data-pick="+a.pick+" "+h.ariaAttr({role:"option",label:m,selected:!(!j||b.$node.val()!==m)||null,activedescendant:!!k||null,disabled:!!l||null})]}})+h.node("li",h.node("button",c.clear,c.klass.buttonClear,"type=button data-clear=1"+(a?"":" disabled")+" "+h.ariaAttr({controls:b.$node[0].id})),"",h.ariaAttr({role:"presentation"})),c.klass.list,h.ariaAttr({role:"listbox",controls:b.$node[0].id}))},c.defaults=function(a){return{clear:"Clear",format:"h:i A",interval:30,closeOnSelect:!0,closeOnClear:!0,klass:{picker:a+" "+a+"--time",holder:a+"__holder",list:a+"__list",listItem:a+"__list-item",disabled:a+"__list-item--disabled",selected:a+"__list-item--selected",highlighted:a+"__list-item--highlighted",viewset:a+"__list-item--viewset",now:a+"__list-item--now",buttonClear:a+"__button--clear"}}}(a.klasses().picker),a.extend("pickatime",c)}),[].map||(Array.prototype.map=function(a,b){for(var c=this,d=c.length,e=new Array(d),f=0;d>f;f++)f in c&&(e[f]=a.call(b,c[f],f,c));return e}),[].filter||(Array.prototype.filter=function(a){if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=[],e=arguments[1],f=0;c>f;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d}),[].indexOf||(Array.prototype.indexOf=function(a){if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>1&&(d=Number(arguments[1]),d!=d?d=0:0!==d&&d!=1/0&&d!=-(1/0)&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);c>e;e++)if(e in b&&b[e]===a)return e;return-1});var nativeSplit=String.prototype.split,compliantExecNpcg=void 0===/()??/.exec("")[1];String.prototype.split=function(a,b){var c=this;if("[object RegExp]"!==Object.prototype.toString.call(a))return nativeSplit.call(c,a,b);var d,e,f,g,h=[],i=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.extended?"x":"")+(a.sticky?"y":""),j=0;for(a=new RegExp(a.source,i+"g"),c+="",compliantExecNpcg||(d=new RegExp("^"+a.source+"$(?!\\s)",i)),b=void 0===b?-1>>>0:b>>>0;(e=a.exec(c))&&(f=e.index+e[0].length,!(f>j&&(h.push(c.slice(j,e.index)),!compliantExecNpcg&&e.length>1&&e[0].replace(d,function(){for(var a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(e[a]=void 0)}),e.length>1&&e.index<c.length&&Array.prototype.push.apply(h,e.slice(1)),g=e[0].length,j=f,h.length>=b)));)a.lastIndex===e.index&&a.lastIndex++;return j===c.length?(g||!a.test(""))&&h.push(""):h.push(c.slice(j)),h.length>b?h.slice(0,b):h};var getUserMedia=null,attachMediaStream=null,reattachMediaStream=null,webrtcDetectedBrowser=null,webrtcDetectedVersion=null,webrtcMinimumVersion=null,webrtcUtils={log:function(){console.log.apply(console,arguments)},extractVersion:function(a,b,c){var d=a.match(b);return d&&d.length>=c&&parseInt(d[c],10)}};if("object"==typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return"mozSrcObject"in this?this.mozSrcObject:this._srcObject},set:function(a){"mozSrcObject"in this?this.mozSrcObject=a:(this._srcObject=a,this.src=URL.createObjectURL(a))}}),getUserMedia=window.navigator&&window.navigator.getUserMedia),attachMediaStream=function(a,b){a.srcObject=b},reattachMediaStream=function(a,b){a.srcObject=b.srcObject},"undefined"!=typeof window&&window.navigator)if(navigator.mozGetUserMedia){if(webrtcUtils.log("This appears to be Firefox"),webrtcDetectedBrowser="firefox",webrtcDetectedVersion=webrtcUtils.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1),webrtcMinimumVersion=31,window.RTCPeerConnection||(window.RTCPeerConnection=function(a,b){if(webrtcDetectedVersion<38&&a&&a.iceServers){for(var c=[],d=0;d<a.iceServers.length;d++){var e=a.iceServers[d];if(e.hasOwnProperty("urls"))for(var f=0;f<e.urls.length;f++){var g={url:e.urls[f]};0===e.urls[f].indexOf("turn")&&(g.username=e.username,g.credential=e.credential),c.push(g)}else c.push(a.iceServers[d])}a.iceServers=c}return new mozRTCPeerConnection(a,b)},mozRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return arguments.length?mozRTCPeerConnection.generateCertificate.apply(null,arguments):mozRTCPeerConnection.generateCertificate}}),window.RTCSessionDescription=mozRTCSessionDescription,
window.RTCIceCandidate=mozRTCIceCandidate),getUserMedia=function(a,b,c){var d=function(a){if("object"!=typeof a||a.require)return a;var b=[];return Object.keys(a).forEach(function(c){if("require"!==c&&"advanced"!==c&&"mediaSource"!==c){var d=a[c]="object"==typeof a[c]?a[c]:{ideal:a[c]};if(void 0===d.min&&void 0===d.max&&void 0===d.exact||b.push(c),void 0!==d.exact&&("number"==typeof d.exact?d.min=d.max=d.exact:a[c]=d.exact,delete d.exact),void 0!==d.ideal){a.advanced=a.advanced||[];var e={};"number"==typeof d.ideal?e[c]={min:d.ideal,max:d.ideal}:e[c]=d.ideal,a.advanced.push(e),delete d.ideal,Object.keys(d).length||delete a[c]}}}),b.length&&(a.require=b),a};return webrtcDetectedVersion<38&&(webrtcUtils.log("spec: "+JSON.stringify(a)),a.audio&&(a.audio=d(a.audio)),a.video&&(a.video=d(a.video)),webrtcUtils.log("ff37: "+JSON.stringify(a))),navigator.mozGetUserMedia(a,b,c)},navigator.getUserMedia=getUserMedia,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:requestUserMedia,addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(a){var b=[{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}];a(b)})},webrtcDetectedVersion<41){var orgEnumerateDevices=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return orgEnumerateDevices().then(void 0,function(a){if("NotFoundError"===a.name)return[];throw a})}}}else if(navigator.webkitGetUserMedia&&window.webkitRTCPeerConnection&&!window.RTCPeerConnection){webrtcUtils.log("This appears to be Chrome"),webrtcDetectedBrowser="chrome",webrtcDetectedVersion=webrtcUtils.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2),webrtcMinimumVersion=38,window.RTCPeerConnection=function(a,b){a&&a.iceTransportPolicy&&(a.iceTransports=a.iceTransportPolicy);var c=new webkitRTCPeerConnection(a,b),d=c.getStats.bind(c);return c.getStats=function(a,b,c){var e=this,f=arguments;if(arguments.length>0&&"function"==typeof a)return d(a,b);var g=function(a){var b={},c=a.result();return c.forEach(function(a){var c={id:a.id,timestamp:a.timestamp,type:a.type};a.names().forEach(function(b){c[b]=a.stat(b)}),b[c.id]=c}),b};if(arguments.length>=2){var h=function(a){f[1](g(a))};return d.apply(this,[h,arguments[0]])}return new Promise(function(b,c){1===f.length&&null===a?d.apply(e,[function(a){b.apply(null,[g(a)])},c]):d.apply(e,[b,c])})},c},webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return arguments.length?webkitRTCPeerConnection.generateCertificate.apply(null,arguments):webkitRTCPeerConnection.generateCertificate}}),["createOffer","createAnswer"].forEach(function(a){var b=webkitRTCPeerConnection.prototype[a];webkitRTCPeerConnection.prototype[a]=function(){var a=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var c=1===arguments.length?arguments[0]:void 0;return new Promise(function(d,e){b.apply(a,[d,e,c])})}return b.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(a){var b=webkitRTCPeerConnection.prototype[a];webkitRTCPeerConnection.prototype[a]=function(){var a=arguments,c=this;return new Promise(function(d,e){b.apply(c,[a[0],function(){d(),a.length>=2&&a[1].apply(null,[])},function(b){e(b),a.length>=3&&a[2].apply(null,[b])}])})}});var constraintsToChrome=function(a){if("object"!=typeof a||a.mandatory||a.optional)return a;var b={};return Object.keys(a).forEach(function(c){if("require"!==c&&"advanced"!==c&&"mediaSource"!==c){var d="object"==typeof a[c]?a[c]:{ideal:a[c]};void 0!==d.exact&&"number"==typeof d.exact&&(d.min=d.max=d.exact);var e=function(a,b){return a?a+b.charAt(0).toUpperCase()+b.slice(1):"deviceId"===b?"sourceId":b};if(void 0!==d.ideal){b.optional=b.optional||[];var f={};"number"==typeof d.ideal?(f[e("min",c)]=d.ideal,b.optional.push(f),f={},f[e("max",c)]=d.ideal,b.optional.push(f)):(f[e("",c)]=d.ideal,b.optional.push(f))}void 0!==d.exact&&"number"!=typeof d.exact?(b.mandatory=b.mandatory||{},b.mandatory[e("",c)]=d.exact):["min","max"].forEach(function(a){void 0!==d[a]&&(b.mandatory=b.mandatory||{},b.mandatory[e(a,c)]=d[a])})}}),a.advanced&&(b.optional=(b.optional||[]).concat(a.advanced)),b};if(getUserMedia=function(a,b,c){return a.audio&&(a.audio=constraintsToChrome(a.audio)),a.video&&(a.video=constraintsToChrome(a.video)),webrtcUtils.log("chrome: "+JSON.stringify(a)),navigator.webkitGetUserMedia(a,b,c)},navigator.getUserMedia=getUserMedia,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:requestUserMedia,enumerateDevices:function(){return new Promise(function(a){var b={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(c){a(c.map(function(a){return{label:a.label,kind:b[a.kind],deviceId:a.id,groupId:""}}))})})}}),navigator.mediaDevices.getUserMedia){var origGetUserMedia=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(a){return webrtcUtils.log("spec:   "+JSON.stringify(a)),a.audio=constraintsToChrome(a.audio),a.video=constraintsToChrome(a.video),webrtcUtils.log("chrome: "+JSON.stringify(a)),origGetUserMedia(a)}}else navigator.mediaDevices.getUserMedia=function(a){return requestUserMedia(a)};"undefined"==typeof navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){webrtcUtils.log("Dummy mediaDevices.addEventListener called.")}),"undefined"==typeof navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){webrtcUtils.log("Dummy mediaDevices.removeEventListener called.")}),attachMediaStream=function(a,b){webrtcDetectedVersion>=43?a.srcObject=b:"undefined"!=typeof a.src?a.src=URL.createObjectURL(b):webrtcUtils.log("Error attaching stream to element.")},reattachMediaStream=function(a,b){webrtcDetectedVersion>=43?a.srcObject=b.srcObject:a.src=b.src}}else if(navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)){if(webrtcUtils.log("This appears to be Edge"),webrtcDetectedBrowser="edge",webrtcDetectedVersion=webrtcUtils.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2),webrtcMinimumVersion=10547,window.RTCIceGatherer){var generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},localCName=generateIdentifier(),SDPUtils={};SDPUtils.splitLines=function(a){return a.trim().split("\n").map(function(a){return a.trim()})},SDPUtils.splitSections=function(a){var b=a.split("\r\nm=");return b.map(function(a,b){return(b>0?"m="+a:a).trim()+"\r\n"})},SDPUtils.matchPrefix=function(a,b){return SDPUtils.splitLines(a).filter(function(a){return 0===a.indexOf(b)})},SDPUtils.parseCandidate=function(a){var b;b=0===a.indexOf("a=candidate:")?a.substring(12).split(" "):a.substring(10).split(" ");for(var c={foundation:b[0],component:b[1],protocol:b[2].toLowerCase(),priority:parseInt(b[3],10),ip:b[4],port:parseInt(b[5],10),type:b[7]},d=8;d<b.length;d+=2)switch(b[d]){case"raddr":c.relatedAddress=b[d+1];break;case"rport":c.relatedPort=parseInt(b[d+1],10);break;case"tcptype":c.tcpType=b[d+1]}return c},SDPUtils.writeCandidate=function(a){var b=[];b.push(a.foundation),b.push(a.component),b.push(a.protocol.toUpperCase()),b.push(a.priority),b.push(a.ip),b.push(a.port);var c=a.type;return b.push("typ"),b.push(c),"host"!==c&&a.relatedAddress&&a.relatedPort&&(b.push("raddr"),b.push(a.relatedAddress),b.push("rport"),b.push(a.relatedPort)),a.tcpType&&"tcp"===a.protocol.toLowerCase()&&(b.push("tcptype"),b.push(a.tcpType)),"candidate:"+b.join(" ")},SDPUtils.parseRtpMap=function(a){var b=a.substr(9).split(" "),c={payloadType:parseInt(b.shift(),10)};return b=b[0].split("/"),c.name=b[0],c.clockRate=parseInt(b[1],10),c.numChannels=3===b.length?parseInt(b[2],10):1,c},SDPUtils.writeRtpMap=function(a){var b=a.payloadType;return void 0!==a.preferredPayloadType&&(b=a.preferredPayloadType),"a=rtpmap:"+b+" "+a.name+"/"+a.clockRate+(1!==a.numChannels?"/"+a.numChannels:"")+"\r\n"},SDPUtils.parseFmtp=function(a){for(var b,c={},d=a.substr(a.indexOf(" ")+1).split(";"),e=0;e<d.length;e++)b=d[e].trim().split("="),c[b[0].trim()]=b[1];return c},SDPUtils.writeFtmp=function(a){var b="",c=a.payloadType;if(void 0!==a.preferredPayloadType&&(c=a.preferredPayloadType),a.parameters&&a.parameters.length){var d=[];Object.keys(a.parameters).forEach(function(b){d.push(b+"="+a.parameters[b])}),b+="a=fmtp:"+c+" "+d.join(";")+"\r\n"}return b},SDPUtils.parseRtcpFb=function(a){var b=a.substr(a.indexOf(" ")+1).split(" ");return{type:b.shift(),parameter:b.join(" ")}},SDPUtils.writeRtcpFb=function(a){var b="",c=a.payloadType;return void 0!==a.preferredPayloadType&&(c=a.preferredPayloadType),a.rtcpFeedback&&a.rtcpFeedback.length&&a.rtcpFeedback.forEach(function(a){b+="a=rtcp-fb:"+c+" "+a.type+" "+a.parameter+"\r\n"}),b},SDPUtils.parseSsrcMedia=function(a){var b=a.indexOf(" "),c={ssrc:a.substr(7,b-7)},d=a.indexOf(":",b);return d>-1?(c.attribute=a.substr(b+1,d-b-1),c.value=a.substr(d+1)):c.attribute=a.substr(b+1),c},SDPUtils.getDtlsParameters=function(a,b){var c=SDPUtils.splitLines(a);c=c.concat(SDPUtils.splitLines(b));var d=c.filter(function(a){return 0===a.indexOf("a=fingerprint:")})[0].substr(14),e={role:"auto",fingerprints:[{algorithm:d.split(" ")[0],value:d.split(" ")[1]}]};return e},SDPUtils.writeDtlsParameters=function(a,b){var c="a=setup:"+b+"\r\n";return a.fingerprints.forEach(function(a){c+="a=fingerprint:"+a.algorithm+" "+a.value+"\r\n"}),c},SDPUtils.getIceParameters=function(a,b){var c=SDPUtils.splitLines(a);c=c.concat(SDPUtils.splitLines(b));var d={usernameFragment:c.filter(function(a){return 0===a.indexOf("a=ice-ufrag:")})[0].substr(12),password:c.filter(function(a){return 0===a.indexOf("a=ice-pwd:")})[0].substr(10)};return d},SDPUtils.writeIceParameters=function(a){return"a=ice-ufrag:"+a.usernameFragment+"\r\na=ice-pwd:"+a.password+"\r\n"},SDPUtils.parseRtpParameters=function(a){for(var b={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},c=SDPUtils.splitLines(a),d=c[0].split(" "),e=3;e<d.length;e++){var f=d[e],g=SDPUtils.matchPrefix(a,"a=rtpmap:"+f+" ")[0];if(g){var h=SDPUtils.parseRtpMap(g),i=SDPUtils.matchPrefix(a,"a=fmtp:"+f+" ");h.parameters=i.length?SDPUtils.parseFmtp(i[0]):{},h.rtcpFeedback=SDPUtils.matchPrefix(a,"a=rtcp-fb:"+f+" ").map(SDPUtils.parseRtcpFb),b.codecs.push(h)}}return b},SDPUtils.writeRtpDescription=function(a,b){var c="";return c+="m="+a+" ",c+=b.codecs.length>0?"9":"0",c+=" UDP/TLS/RTP/SAVPF ",c+=b.codecs.map(function(a){return void 0!==a.preferredPayloadType?a.preferredPayloadType:a.payloadType}).join(" ")+"\r\n",c+="c=IN IP4 0.0.0.0\r\n",c+="a=rtcp:9 IN IP4 0.0.0.0\r\n",b.codecs.forEach(function(a){c+=SDPUtils.writeRtpMap(a),c+=SDPUtils.writeFtmp(a),c+=SDPUtils.writeRtcpFb(a)}),c+="a=rtcp-mux\r\n"},SDPUtils.writeSessionBoilerplate=function(){return"v=0\r\no=thisisadapterortc 8169639915646943137 2 IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},SDPUtils.writeMediaSection=function(a,b,c,d){var e=SDPUtils.writeRtpDescription(a.kind,b);if(e+=SDPUtils.writeIceParameters(a.iceGatherer.getLocalParameters()),e+=SDPUtils.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),"offer"===c?"actpass":"active"),e+="a=mid:"+a.mid+"\r\n",e+=a.rtpSender&&a.rtpReceiver?"a=sendrecv\r\n":a.rtpSender?"a=sendonly\r\n":a.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",a.rtpSender){var f="msid:"+d.id+" "+a.rtpSender.track.id+"\r\n";e+="a="+f,e+="a=ssrc:"+a.sendSsrc+" "+f}return e+="a=ssrc:"+a.sendSsrc+" cname:"+localCName+"\r\n"},SDPUtils.getDirection=function(a,b){for(var c=SDPUtils.splitLines(a),d=0;d<c.length;d++)switch(c[d]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return c[d].substr(2)}return b?SDPUtils.getDirection(b):"sendrecv"},window.RTCIceCandidate||(window.RTCIceCandidate=function(a){return a}),window.RTCSessionDescription||(window.RTCSessionDescription=function(a){return a}),window.RTCPeerConnection=function(a){var b=this;if(this.onicecandidate=null,this.onaddstream=null,this.onremovestream=null,this.onsignalingstatechange=null,this.oniceconnectionstatechange=null,this.onnegotiationneeded=null,this.ondatachannel=null,this.localStreams=[],this.remoteStreams=[],this.getLocalStreams=function(){return b.localStreams},this.getRemoteStreams=function(){return b.remoteStreams},this.localDescription=new RTCSessionDescription({type:"",sdp:""}),this.remoteDescription=new RTCSessionDescription({type:"",sdp:""}),this.signalingState="stable",this.iceConnectionState="new",this.iceOptions={gatherPolicy:"all",iceServers:[]},a&&a.iceTransportPolicy)switch(a.iceTransportPolicy){case"all":case"relay":this.iceOptions.gatherPolicy=a.iceTransportPolicy;break;case"none":throw new TypeError('iceTransportPolicy "none" not supported')}a&&a.iceServers&&a.iceServers.forEach(function(a){if(a.urls){var c;c="string"==typeof a.urls?a.urls:a.urls[0],c.indexOf("transport=udp")!==-1&&b.iceServers.push({username:a.username,credential:a.credential,urls:c})}}),this.transceivers=[],this._localIceCandidatesBuffer=[]},window.RTCPeerConnection.prototype._emitBufferedCandidates=function(){var a=this;this._localIceCandidatesBuffer.forEach(function(b){null!==a.onicecandidate&&a.onicecandidate(b)}),this._localIceCandidatesBuffer=[]},window.RTCPeerConnection.prototype.addStream=function(a){this.localStreams.push(a.clone()),this._maybeFireNegotiationNeeded()},window.RTCPeerConnection.prototype.removeStream=function(a){var b=this.localStreams.indexOf(a);b>-1&&(this.localStreams.splice(b,1),this._maybeFireNegotiationNeeded())},window.RTCPeerConnection.prototype._getCommonCapabilities=function(a,b){var c={codecs:[],headerExtensions:[],fecMechanisms:[]};return a.codecs.forEach(function(a){for(var d=0;d<b.codecs.length;d++){var e=b.codecs[d];if(a.name.toLowerCase()===e.name.toLowerCase()&&a.clockRate===e.clockRate&&a.numChannels===e.numChannels){c.codecs.push(e);break}}}),a.headerExtensions.forEach(function(a){for(var d=0;d<b.headerExtensions.length;d++){var e=b.headerExtensions[d];if(a.uri===e.uri){c.headerExtensions.push(e);break}}}),c},window.RTCPeerConnection.prototype._createIceAndDtlsTransports=function(a,b){var c=this,d=new RTCIceGatherer(c.iceOptions),e=new RTCIceTransport(d);d.onlocalcandidate=function(f){var g={};g.candidate={sdpMid:a,sdpMLineIndex:b};var h=f.candidate;h&&0!==Object.keys(h).length?(h.component="RTCP"===e.component?2:1,g.candidate.candidate=SDPUtils.writeCandidate(h)):(void 0===d.state&&(d.state="completed"),g.candidate.candidate="candidate:1 1 udp 1 0.0.0.0 9 typ endOfCandidates");var i=c.transceivers.every(function(a){return a.iceGatherer&&"completed"===a.iceGatherer.state});null!==c.onicecandidate&&(c.localDescription&&""===c.localDescription.type?(c._localIceCandidatesBuffer.push(g),i&&c._localIceCandidatesBuffer.push({})):(c.onicecandidate(g),i&&c.onicecandidate({})))},e.onicestatechange=function(){c._updateConnectionState()};var f=new RTCDtlsTransport(e);return f.ondtlsstatechange=function(){c._updateConnectionState()},f.onerror=function(){f.state="failed",c._updateConnectionState()},{iceGatherer:d,iceTransport:e,dtlsTransport:f}},window.RTCPeerConnection.prototype._transceive=function(a,b,c){var d=this._getCommonCapabilities(a.localCapabilities,a.remoteCapabilities);b&&a.rtpSender&&(d.encodings=[{ssrc:a.sendSsrc}],d.rtcp={cname:localCName,ssrc:a.recvSsrc},a.rtpSender.send(d)),c&&a.rtpReceiver&&(d.encodings=[{ssrc:a.recvSsrc}],d.rtcp={cname:a.cname,ssrc:a.sendSsrc},a.rtpReceiver.receive(d))},window.RTCPeerConnection.prototype.setLocalDescription=function(a){var b=this;if("offer"===a.type)this._pendingOffer&&(this.transceivers=this._pendingOffer,delete this._pendingOffer);else if("answer"===a.type){var c=SDPUtils.splitSections(b.remoteDescription.sdp),d=c.shift();c.forEach(function(a,c){var e=b.transceivers[c],f=e.iceGatherer,g=e.iceTransport,h=e.dtlsTransport,i=e.localCapabilities,j=e.remoteCapabilities,k="0"===a.split("\n",1)[0].split(" ",2)[1];if(!k){var l=SDPUtils.getIceParameters(a,d);g.start(f,l,"controlled");var m=SDPUtils.getDtlsParameters(a,d);h.start(m);var n=b._getCommonCapabilities(i,j);b._transceive(e,n.codecs.length>0,!1)}})}switch(this.localDescription=a,a.type){case"offer":this._updateSignalingState("have-local-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+a.type+'"')}var e=arguments.length>1&&"function"==typeof arguments[1];if(e){var f=arguments[1];window.setTimeout(function(){f(),b._emitBufferedCandidates()},0)}var g=Promise.resolve();return g.then(function(){e||window.setTimeout(b._emitBufferedCandidates.bind(b),0)}),g},window.RTCPeerConnection.prototype.setRemoteDescription=function(a){var b=this,c=new MediaStream,d=SDPUtils.splitSections(a.sdp),e=d.shift();switch(d.forEach(function(d,f){var g,h,i,j,k,l,m,n,o,p,q,r=SDPUtils.splitLines(d),s=r[0].substr(2).split(" "),t=s[0],u="0"===s[1],v=SDPUtils.getDirection(d,e),w=SDPUtils.parseRtpParameters(d);u||(p=SDPUtils.getIceParameters(d,e),q=SDPUtils.getDtlsParameters(d,e));var x,y=SDPUtils.matchPrefix(d,"a=mid:")[0].substr(6),z=SDPUtils.matchPrefix(d,"a=ssrc:").map(function(a){return SDPUtils.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute})[0];if(z&&(n=parseInt(z.ssrc,10),x=z.value),"offer"===a.type){var A=b._createIceAndDtlsTransports(y,f);if(o=RTCRtpReceiver.getCapabilities(t),m=1001*(2*f+2),l=new RTCRtpReceiver(A.dtlsTransport,t),c.addTrack(l.track),b.localStreams.length>0&&b.localStreams[0].getTracks().length>=f){var B=b.localStreams[0].getTracks()[f];k=new RTCRtpSender(B,A.dtlsTransport)}b.transceivers[f]={iceGatherer:A.iceGatherer,iceTransport:A.iceTransport,dtlsTransport:A.dtlsTransport,localCapabilities:o,remoteCapabilities:w,rtpSender:k,rtpReceiver:l,kind:t,mid:y,cname:x,sendSsrc:m,recvSsrc:n},b._transceive(b.transceivers[f],!1,"sendrecv"===v||"sendonly"===v)}else"answer"!==a.type||u||(g=b.transceivers[f],h=g.iceGatherer,i=g.iceTransport,j=g.dtlsTransport,k=g.rtpSender,l=g.rtpReceiver,m=g.sendSsrc,o=g.localCapabilities,b.transceivers[f].recvSsrc=n,b.transceivers[f].remoteCapabilities=w,b.transceivers[f].cname=x,i.start(h,p,"controlling"),j.start(q),b._transceive(g,"sendrecv"===v||"recvonly"===v,"sendrecv"===v||"sendonly"===v),!l||"sendrecv"!==v&&"sendonly"!==v?delete g.rtpReceiver:c.addTrack(l.track))}),this.remoteDescription=a,a.type){case"offer":this._updateSignalingState("have-remote-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+a.type+'"')}return window.setTimeout(function(){null!==b.onaddstream&&c.getTracks().length&&(b.remoteStreams.push(c),window.setTimeout(function(){b.onaddstream({stream:c})},0))},0),arguments.length>1&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},window.RTCPeerConnection.prototype.close=function(){this.transceivers.forEach(function(a){a.iceTransport&&a.iceTransport.stop(),a.dtlsTransport&&a.dtlsTransport.stop(),a.rtpSender&&a.rtpSender.stop(),a.rtpReceiver&&a.rtpReceiver.stop()}),this._updateSignalingState("closed")},window.RTCPeerConnection.prototype._updateSignalingState=function(a){this.signalingState=a,null!==this.onsignalingstatechange&&this.onsignalingstatechange()},window.RTCPeerConnection.prototype._maybeFireNegotiationNeeded=function(){null!==this.onnegotiationneeded&&this.onnegotiationneeded()},window.RTCPeerConnection.prototype._updateConnectionState=function(){var a,b=this,c={new:0,closed:0,connecting:0,checking:0,connected:0,completed:0,failed:0};this.transceivers.forEach(function(a){c[a.iceTransport.state]++,c[a.dtlsTransport.state]++}),c.connected+=c.completed,a="new",c.failed>0?a="failed":c.connecting>0||c.checking>0?a="connecting":c.disconnected>0?a="disconnected":c.new>0?a="new":(c.connecting>0||c.completed>0)&&(a="connected"),a!==b.iceConnectionState&&(b.iceConnectionState=a,null!==this.oniceconnectionstatechange&&this.oniceconnectionstatechange())},window.RTCPeerConnection.prototype.createOffer=function(){var a=this;if(this._pendingOffer)throw new Error("createOffer called while there is a pending offer.");var b;1===arguments.length&&"function"!=typeof arguments[0]?b=arguments[0]:3===arguments.length&&(b=arguments[2]);var c=[],d=0,e=0;if(this.localStreams.length&&(d=this.localStreams[0].getAudioTracks().length,e=this.localStreams[0].getVideoTracks().length),b){if(b.mandatory||b.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==b.offerToReceiveAudio&&(d=b.offerToReceiveAudio),void 0!==b.offerToReceiveVideo&&(e=b.offerToReceiveVideo)}for(this.localStreams.length&&this.localStreams[0].getTracks().forEach(function(a){c.push({kind:a.kind,track:a,wantReceive:"audio"===a.kind?d>0:e>0}),"audio"===a.kind?d--:"video"===a.kind&&e--});d>0||e>0;)d>0&&(c.push({kind:"audio",wantReceive:!0}),d--),e>0&&(c.push({kind:"video",wantReceive:!0}),e--);var f=SDPUtils.writeSessionBoilerplate(),g=[];c.forEach(function(b,c){var d,e,h=b.track,i=b.kind,j=generateIdentifier(),k=a._createIceAndDtlsTransports(j,c),l=RTCRtpSender.getCapabilities(i),m=1001*(2*c+1);h&&(d=new RTCRtpSender(h,k.dtlsTransport)),b.wantReceive&&(e=new RTCRtpReceiver(k.dtlsTransport,i)),g[c]={iceGatherer:k.iceGatherer,iceTransport:k.iceTransport,dtlsTransport:k.dtlsTransport,localCapabilities:l,remoteCapabilities:null,rtpSender:d,rtpReceiver:e,kind:i,mid:j,sendSsrc:m,recvSsrc:null};var n=g[c];f+=SDPUtils.writeMediaSection(n,n.localCapabilities,"offer",a.localStreams[0])}),this._pendingOffer=g;var h=new RTCSessionDescription({type:"offer",sdp:f});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,h),Promise.resolve(h)},window.RTCPeerConnection.prototype.createAnswer=function(){var a,b=this;1===arguments.length&&"function"!=typeof arguments[0]?a=arguments[0]:3===arguments.length&&(a=arguments[2]);var c=SDPUtils.writeSessionBoilerplate();this.transceivers.forEach(function(a){var d=b._getCommonCapabilities(a.localCapabilities,a.remoteCapabilities);c+=SDPUtils.writeMediaSection(a,d,"answer",b.localStreams[0])});var d=new RTCSessionDescription({type:"answer",sdp:c});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,d),Promise.resolve(d)},window.RTCPeerConnection.prototype.addIceCandidate=function(a){var b=a.sdpMLineIndex;if(a.sdpMid)for(var c=0;c<this.transceivers.length;c++)if(this.transceivers[c].mid===a.sdpMid){b=c;break}var d=this.transceivers[b];if(d){var e=Object.keys(a.candidate).length>0?SDPUtils.parseCandidate(a.candidate):{};if("tcp"===e.protocol&&0===e.port)return;if("1"!==e.component)return;"endOfCandidates"===e.type&&(e={}),d.iceTransport.addRemoteCandidate(e)}return arguments.length>1&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},window.RTCPeerConnection.prototype.getStats=function(){var a=[];this.transceivers.forEach(function(b){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(c){b[c]&&a.push(b[c].getStats())})});var b=arguments.length>1&&"function"==typeof arguments[1]&&arguments[1];return new Promise(function(c){var d={};Promise.all(a).then(function(a){a.forEach(function(a){Object.keys(a).forEach(function(b){d[b]=a[b]})}),b&&window.setTimeout(b,0,d),c(d)})})}}}else webrtcUtils.log("Browser does not appear to be WebRTC-capable");else webrtcUtils.log("This does not appear to be a browser"),webrtcDetectedBrowser="not a browser";"object"!=typeof window||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection||Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=a),this.addEventListener("addstream",this._ontrackpoly=function(a){a.stream.getTracks().forEach(function(b){var c=new Event("track");c.track=b,c.receiver={track:b},c.streams=[a.stream],this.dispatchEvent(c)}.bind(this))}.bind(this))}});var webrtcTesting={};try{Object.defineProperty(webrtcTesting,"version",{set:function(a){webrtcDetectedVersion=a}})}catch(a){}var Easyrtc=function(){function a(a){if(null===a||void 0===a)return!0;var b;for(b in a)if(a.hasOwnProperty(b))return!1;return!0}function b(a){var b,c;for(c=a.getAudioTracks(),b=0;b<c.length;b++)try{c[b].stop()}catch(a){}for(c=a.getVideoTracks(),b=0;b<c.length;b++)try{c[b].stop()}catch(a){}if("function"==typeof a.stop)try{a.stop()}catch(a){}}function c(a){return a&&(a.socket&&a.socket.connected||a.connected)}function d(a,b){if("string"!=typeof a)throw U.showError(U.errCodes.DEVELOPER_ERR,b+" called without a string as the first argument"),"developer error";if(!aa[a])throw U.showError(U.errCodes.DEVELOPER_ERR,b+" called with a bad event name = "+a),"developer error"}function e(a,b){navigator.mediaDevices.enumerateDevices().then(function(c){for(var d=[],e=0;e<c.length;e++){var f=c[e];f.kind===b&&d.push(f)}a(d)}).catch(function(a){webrtcUtils.log("Unable to enumerate devices ("+a+")")})}function f(a,b){var c=JSON.stringify(b);JSON.parse(c);var d={msgType:"setRoomApiField",msgData:{setRoomApiField:{roomName:a,field:b}}};U.webSocket.json.emit("easyrtcCmd",d,function(a){"error"===a.msgType&&U.showError(a.msgData.errorCode,a.msgData.errorText)})}function g(a){ua&&clearTimeout(ua),ua=setTimeout(function(){f(a,U._roomApiFields[a]),ua=null},10)}function h(a,b){var c;if(b)for(c=0;c<b.length;c++){var d=b[c];d.enabled=a}}function i(a){return a||(a="default"),ca.hasOwnProperty(a)?ca[a]:null}function j(){var a,b={};for(a in ca)ca.hasOwnProperty(a)&&(b[a]=ca[a].id||"default");return b}function k(a,b){var c;if(b||(b="default"),a.streamName=b,ca[b]=a,"default"!==b){var d=j(),e=U.roomData;for(c in e)e.hasOwnProperty(c)&&U.setRoomApiField(c,"mediaIds",d)}}function l(a,b){var c,d,e;if(b||(b="default"),sa[a]&&(e=sa[a].remoteStreamIdToName[b]))return e;for(c in U.roomData)if(U.roomData.hasOwnProperty(c)){if(d=U.getRoomApiField(c,a,"mediaIds"),!d)continue;for(e in d)if(d.hasOwnProperty(e)&&d[e]===b)return e;if("firefox"===webrtcDetectedBrowser){if(d.default)return"default";for(var f in d)if(d.hasOwnProperty(f))return f}}}function m(a){a||(a="default");var c=U.getLocalStream(a);if(c){var d,e,f=c.id||"default";if(ca[a]){for(d in sa)if(sa.hasOwnProperty(d)){try{sa[d].pc.removeStream(c)}catch(a){}U.sendPeerMessage(d,"__closingMediaStream",{streamId:f,streamName:a})}if(b(ca[a]),delete ca[a],"default"!==a){var g=j();for(e in U.roomData)U.roomData.hasOwnProperty(e)&&U.setRoomApiField(e,"mediaIds",g)}}}}function n(a,b,c){var d,e;if(a){if(e=sa[a],!e)return U.showError(U.errCodes.DEVELOPER_ERR,"haveTracks called about a peer you don't have a connection to"),!1;d=e.getRemoteStreamByName(c)}else d=i(c);if(!d)return!1;var f;try{f=b?d.getAudioTracks():d.getVideoTracks()}catch(a){return!0}return!!f&&f.length>0}function o(){var a;if(U.loggingOut=!0,ha={},ta={},U.disconnecting=!0,ya=U.webSocket,U.webSocketConnected&&(Aa||U.webSocket.close(),U.webSocketConnected=!1),U.hangupAll(),la)for(a in oa)oa.hasOwnProperty(a)&&la(a,{},!1);oa={},U.emitEvent("roomOccupant",{}),U.roomData={},U.roomJoin={},U.loggingOut=!1,U.myEasyrtcid=null,U.disconnecting=!1,ga={}}function p(a,b,c,d,e){if(!U.webSocket)throw"Attempt to send message without a valid connection to the server.";var f={msgType:b};a&&(f.targetEasyrtcid=a),c&&(f.msgData=c),U.debugPrinter&&U.debugPrinter("sending socket message "+JSON.stringify(f)),U.webSocket.json.emit("easyrtcCmd",f,function(a){"error"!==a.msgType?(a.hasOwnProperty("msgData")||(a.msgData=null),d&&d(a.msgType,a.msgData)):e?e(a.msgData.errorCode,a.msgData.errorText):U.showError(a.msgData.errorCode,a.msgData.errorText)})}function q(a,b){var c,d,e,f,g,h=a+"-"+Ba++,i=Math.ceil(b.length/U.maxP2PMessageLength);for(e={transfer:"start",transferId:h,parts:i},g={transfer:"end",transferId:h},sa[a].dataChannelS.send(JSON.stringify(e)),c=0,d=b.length;c<d;c+=U.maxP2PMessageLength)f={transferId:h,data:b.substr(c,U.maxP2PMessageLength),transfer:"chunk"},sa[a].dataChannelS.send(JSON.stringify(f));sa[a].dataChannelS.send(JSON.stringify(g))}function r(){var a=[];return a.push({DtlsSrtpKeyAgreement:"true"}),{optional:a}}function s(a,b,c){var d;for(d=0;d<sa[a].candidatesToSend.length;d++)p(a,"candidate",sa[a].candidatesToSend[d],b,c)}function t(a,b){if(sa[a]){var c,d;d=b.id?b.id:"default",c=sa[a].remoteStreamIdToName[d]||"default",sa[a].liveRemoteStreams[c]&&U.onStreamClosed&&(delete sa[a].liveRemoteStreams[c],U.onStreamClosed(a,b,c)),delete sa[a].remoteStreamIdToName[d]}}function u(a,b){if(sa[a]&&(t(a,b),ra(),sa[a].pc))try{sa[a].pc.removeStream(b)}catch(a){}}function v(a,b){function c(a){var b;for(b in a)if(a.hasOwnProperty(b))return!0;return!1}var d={};return c(a)&&(d.added=a),c(b)&&(d.deleted=b),c(d)?d:null}function w(a,b){var c,d,e={},f={};for(c in b)b.hasOwnProperty(c)&&(null===a||"undefined"==typeof a[c]?e[c]=b[c]:"object"==typeof b[c]?(d=w(a[c],b[c]),null!==d&&(e[c]=b[c])):b[c]!==a[c]&&(e[c]=b[c]));for(c in a)b.hasOwnProperty(c)&&"undefined"==typeof b[c]&&(f[c]=a[c]);return v(e,f)}function x(){var b,c={};for(b in sa)sa.hasOwnProperty(b)&&(c[b]={connectTime:sa[b].connectTime,isInitiator:!!sa[b].isInitiator});var d={userSettings:{sharingAudio:!!_.audio,sharingVideo:!!_.video,sharingData:!!ja,nativeVideoWidth:U.nativeVideoWidth,nativeVideoHeight:U.nativeVideoHeight,windowWidth:window.innerWidth,windowHeight:window.innerHeight,screenWidth:window.screen.width,screenHeight:window.screen.height,cookieEnabled:navigator.cookieEnabled,os:navigator.oscpu,language:navigator.language}};return a(c)||(d.p2pList=c),d}function y(){var a=x(!1),b=function(){var b=w(ga,a);b&&(U.debugPrinter&&U.debugPrinter("cfg="+JSON.stringify(b.added)),U.webSocket&&p(null,"setUserCfg",{setUserCfg:b.added},null,null)),ga=a};ga==={}?b():setTimeout(b,100)}function z(a,b,c,d){function e(b){if(U.debugPrinter&&U.debugPrinter("saw dataChannel.onmessage event: "+JSON.stringify(b.data)),"dataChannelPrimed"===b.data)U.sendDataWS(a,"dataChannelPrimed","");else try{var c=JSON.parse(b.data);if(c)if(c.transfer&&c.transferId)if("start"===c.transfer){U.debugPrinter&&U.debugPrinter("start transfer #"+c.transferId);var d=parseInt(c.parts);q={chunks:[],parts:d,transferId:c.transferId}}else if("chunk"===c.transfer)U.debugPrinter&&U.debugPrinter("got chunk for transfer #"+c.transferId),"string"==typeof c.data&&c.data.length<=U.maxP2PMessageLength?q?c.transferId!==q.transferId?webrtcUtils.log("Developer error, invalid transfer id"):q.chunks.length+1>q.parts?webrtcUtils.log("Developer error, received too many chunks"):q.chunks.push(c.data):webrtcUtils.log("Developer error, unexpected chunk"):webrtcUtils.log("Developer error, invalid data");else if("end"===c.transfer){if(U.debugPrinter&&U.debugPrinter("end of transfer #"+c.transferId),q)if(c.transferId!==q.transferId)webrtcUtils.log("Developer error, invalid transfer id");else if(q.chunks.length!==q.parts)webrtcUtils.log("Developer error, received wrong number of chunks");else try{var e=JSON.parse(q.chunks.join(""));U.receivePeerDistribute(a,e,null)}catch(a){webrtcUtils.log("Developer error, unable to parse message")}else webrtcUtils.log("Developer error, unexpected end of transfer");q={}}else webrtcUtils.log("Developer error, got an unknown transfer message"+c.transfer);else U.receivePeerDistribute(a,c,null)}catch(a){}}function f(a){U.debugPrinter&&U.debugPrinter("saw initOutgoingChannel call");var b=h.createDataChannel(fa,U.getDatachannelConstraints());sa[a].dataChannelS=b,sa[a].dataChannelR=b,b.onmessage=e,b.onopen=function(c){U.debugPrinter&&U.debugPrinter("saw dataChannel.onopen event"),sa[a]&&b.send("dataChannelPrimed")},b.onclose=function(b){U.debugPrinter&&U.debugPrinter("saw dataChannelS.onclose event"),sa[a]&&(sa[a].dataChannelReady=!1,delete sa[a].dataChannelS),na&&na(a),
ra()}}function g(a){U.debugPrinter&&U.debugPrinter("initializing incoming channel handler for "+a),sa[a].pc.ondatachannel=function(b){U.debugPrinter&&U.debugPrinter("saw incoming data channel");var c=b.channel;sa[a].dataChannelR=c,sa[a].dataChannelS=c,sa[a].dataChannelReady=!0,c.onmessage=e,c.onclose=function(b){U.debugPrinter&&U.debugPrinter("saw dataChannelR.onclose event"),sa[a]&&(sa[a].dataChannelReady=!1,delete sa[a].dataChannelR),na&&na(a),ra()},c.onopen=function(b){U.debugPrinter&&U.debugPrinter("saw dataChannel.onopen event"),sa[a]&&c.send("dataChannelPrimed")}}}var h,j,k,m=wa?wa:va;U.debugPrinter&&U.debugPrinter("building peer connection to "+a);try{if(h=U.createRTCPeerConnection(m,r()),!h)throw j="Unable to create PeerConnection object, check your ice configuration("+JSON.stringify(m)+")",U.debugPrinter&&U.debugPrinter(j),j;ja&&"undefined"==typeof h.createDataChannel&&(ja=!1),h.onnegotiationneeded=function(b){sa[a]&&sa[a].enableNegotiateListener&&h.createOffer(function(b){W&&(b.sdp=W(b.sdp)),h.setLocalDescription(b,function(){U.sendPeerMessage(a,"__addedMediaStream",{sdp:b})},function(){})},function(a){webrtcUtils.log("unexpected error in creating offer")})},h.oniceconnectionstatechange=function(b){Z&&Z(a,b.target);var d=b.currentTarget?b.currentTarget.iceConnectionState:"unknown";switch(d){case"connected":sa[a]&&sa[a].callSuccessCB&&sa[a].callSuccessCB(a,"connection");break;case"failed":c&&c(U.errCodes.NOVIABLEICE,"No usable STUN/TURN path"),delete sa[a];break;case"disconnected":U.onPeerFailing&&U.onPeerFailing(a),sa[a]&&(sa[a].failing=Date.now());break;case"closed":U.onPeerClosed&&U.onPeerClosed(a);break;case"connected":case"completed":sa[a]&&(sa[a].failing&&U.onPeerRecovered&&U.onPeerRecovered(a,sa[a].failing,Date.now()),delete sa[a].failing),delete sa[a].failing}},h.onconnection=function(){U.debugPrinter&&U.debugPrinter("onconnection called prematurely")},k={pc:h,candidatesToSend:[],startedAV:!1,connectionAccepted:!1,isInitiator:b,remoteStreamIdToName:{},streamsAddedAcks:{},liveRemoteStreams:{},getRemoteStreamByName:function(b){var c,d,e=h.getRemoteStreams(),f=null;if(b||(b="default"),"default"===b)return e.length>0?e[0]:null;for(d in U.roomData)if(U.roomData.hasOwnProperty(d)){var g=U.getRoomApiField(d,a,"mediaIds");if(f=g?g[b]:null)break}for(f||U.showError(U.errCodes.DEVELOPER_ERR,"remote peer does not have media stream called "+b),c=0;c<e.length;c++){var i;if(i=e[c].id?e[c].id:"default",!f||i===f)return e[c]}return null}},h.onicecandidate=function(b){if(!sa[a]||!sa[a].cancelled){var d;if(b.candidate&&sa[a]){if(d={type:"candidate",label:b.candidate.sdpMLineIndex,id:b.candidate.sdpMid,candidate:b.candidate.candidate},Y&&(d=Y(d,!1),!d))return;if(b.candidate.candidate.indexOf("typ relay")>0){var e=b.candidate.candidate.match(/(udp|tcp) \d+ (\d+\.\d+\.\d+\.\d+)/i)[2];U._turnServers[e]=!0}sa[a].connectionAccepted?p(a,"candidate",d,null,function(){c(U.errCodes.PEER_GONE,"Candidate disappeared")}):sa[a].candidatesToSend.push(d)}}},h.onaddstream=function(b){if(!sa[a]||!sa[a].cancelled){U.debugPrinter&&U.debugPrinter("saw incoming media stream"),sa[a].startedAV||(sa[a].startedAV=!0,sa[a].sharingAudio=_.audio,sa[a].sharingVideo=_.video,sa[a].connectTime=(new Date).getTime(),sa[a].callSuccessCB&&(sa[a].sharingAudio||sa[a].sharingVideo)&&sa[a].callSuccessCB(a,"audiovideo"),(U.audioEnabled||U.videoEnabled)&&y());var c=l(a,b.stream.id||"default");c||(c="default"),sa[a].remoteStreamIdToName[b.stream.id||"default"]=c,sa[a].liveRemoteStreams[c]=!0,b.stream.streamName=c,U.streamAcceptor&&(U.streamAcceptor(a,b.stream,c),U.sendDataWS(a,"easyrtc_streamReceived",{streamName:c},function(){}))}},h.onremovestream=function(b){U.debugPrinter&&U.debugPrinter("saw remove on remote media stream"),u(a,b.stream)},sa[a]=k}catch(a){return U.debugPrinter&&U.debugPrinter(JSON.stringify(a)),c(U.errCodes.SYSTEM_ERR,a.message),null}var n,o;if(d)for(n=0;n<d.length;n++)o=i(d[n]),o?h.addStream(o):webrtcUtils.log("Developer error, attempt to access unknown local media stream "+d[n]);else V&&(U.videoEnabled||U.audioEnabled)&&(o=U.getLocalStream(),h.addStream(o));var q={};if(ja){if(U.setPeerListener(function(){sa[a].dataChannelReady=!0,sa[a].callSuccessCB&&sa[a].callSuccessCB(a,"datachannel"),ma&&ma(a,!0),ra()},"dataChannelPrimed",a),b)try{f(a)}catch(a){webrtcUtils.log("failed to init outgoing channel"),c(U.errCodes.SYSTEM_ERR,U.formatError(a))}b||g(a)}return h.onconnection=function(){U.debugPrinter&&U.debugPrinter("setup pc.onconnection ")},U.setPeerListener(function(a,b,c,d){k.streamsAddedAcks[c.streamName]&&(k.streamsAddedAcks[c.streamName](a,c.streamName),delete k.streamsAddedAcks[c.streamName])},"easyrtc_streamReceived",a),h}function A(a,b,c){var d=z(a,!1,function(a){U.showError(U.errCodes.SYSTEM_ERR,a)},c),e=sa[a];if(!d)return void(U.debugPrinter&&U.debugPrinter("buildPeerConnection failed. Call not answered"));var f=function(b){if(!e.cancelled){var c=function(){function c(){}function e(b,c){delete sa[a],U.showError(b,c)}U.debugPrinter&&U.debugPrinter("sending answer"),p(a,"answer",b,c,e),sa[a].connectionAccepted=!0,s(a,c,e),d.connectDataConnection&&(U.debugPrinter&&U.debugPrinter("calling connectDataConnection(5002,5001)"),d.connectDataConnection(5002,5001))};W&&(b.sdp=W(b.sdp)),d.setLocalDescription(b,c,function(a){U.showError(U.errCodes.INTERNAL_ERR,"setLocalDescription: "+a)})}},g=new RTCSessionDescription(b);if(!g)throw"Could not create the RTCSessionDescription";U.debugPrinter&&U.debugPrinter("sdp ||  "+JSON.stringify(g));var h=function(){e.cancelled||d.createAnswer(f,function(a){U.showError(U.errCodes.INTERNAL_ERR,"create-answer: "+a)},ea)};U.debugPrinter&&U.debugPrinter("about to call setRemoteDescription in doAnswer");try{X&&(g.sdp=X(g.sdp)),d.setRemoteDescription(g,h,function(a){U.showError(U.errCodes.INTERNAL_ERR,"set-remote-description: "+a)})}catch(a){webrtcUtils.log("set remote description failed"),U.debugPrinter&&U.debugPrinter("saw exception in setRemoteDescription"),U.showError(U.errCodes.INTERNAL_ERR,"setRemoteDescription failed: "+a.message)}}function B(a,b,c){if(!c&&V){var d=U.getLocalStream();if(!d&&(U.videoEnabled||U.audioEnabled))return void U.initMediaSource(function(){B(a,b)},function(a,b){U.showError(U.errCodes.MEDIA_ERR,U.format(U.getConstantString("localMediaError")))})}xa?U.getFreshIceConfig(function(d){d?A(a,b,c):U.showError(U.errCodes.CALL_ERR,"Failed to get fresh ice config")}):A(a,b,c)}function C(a,b,c,d,e){ta[a]=!0;var f,g=z(a,!0,c,e);if(!g)throw f="buildPeerConnection failed, call not completed",U.debugPrinter&&U.debugPrinter(f),f;sa[a].callSuccessCB=b,sa[a].callFailureCB=c,sa[a].wasAcceptedCB=d;var h=sa[a],i=function(b){if(!h.cancelled){var d=function(){p(a,"offer",b,null,c)};W&&(b.sdp=W(b.sdp)),g.setLocalDescription(b,d,function(a){c(U.errCodes.CALL_ERR,a)})}};setTimeout(function(){sa[a]&&g.createOffer(i,function(a){c(U.errCodes.CALL_ERR,JSON.stringify(a))},ea)},100)}function D(a){var b;return b=a.active===!0||a.ended===!1||a.getTracks().reduce(function(a){return a.enabled})}function E(a){Ca[a]={candidates:[]}}function F(a){var c;if(U.debugPrinter&&U.debugPrinter("Hanging up on "+a),E(a),sa[a]){if(sa[a].pc){var d=sa[a].pc.getRemoteStreams();for(c=0;c<d.length;c++)D(d[c])&&(t(a,d[c]),b(d[c]));try{sa[a].pc.close()}catch(a){U.debugPrinter&&U.debugPrinter("peer close failed:"+a)}}sa[a].cancelled=!0,delete sa[a],U.webSocket&&p(a,"hangup",null,function(){},function(a,b){U.debugPrinter&&U.debugPrinter("hangup failed:"+b)}),ta[a]&&delete ta[a]}}function G(a){if(delete ha[a],U.debugPrinter&&U.debugPrinter("Saw onRemote hangup event"),sa[a]){if(sa[a].cancelled=!0,sa[a].pc){var c=sa[a].pc.getRemoteStreams();if(c){var d;for(d=0;d<c.length;d++){t(a,c[d]);try{b(c[d])}catch(a){}}}try{sa[a].pc.close()}catch(a){}}else U.callCancelled&&U.callCancelled(a,!0);delete sa[a],ra()}else U.callCancelled&&U.callCancelled(a,!0)}function H(a){var b;for(b in oa)if(oa.hasOwnProperty(b)&&oa[b][a])return!0;return!1}function I(a){var b;for(b in sa)sa.hasOwnProperty(b)&&"undefined"==typeof a[b]&&(H(b)||((sa[b].pc||sa[b].isInitiator)&&G(b),delete ha[b],delete ta[b],E(b)));for(b in ha)ha.hasOwnProperty(b)&&!H(b)&&(G(b),E(b),delete ha[b],delete ta[b]);for(b in ta)ta.hasOwnProperty(b)&&!H(b)&&(G(b),E(b),delete ta[b])}function J(a,b,c){c||(c=100);var d=0;Da[a]&&(clearTimeout(Da[a].timer),d=Da[a].counter),d>20?(delete Da[a],b()):(Da[a]={counter:d+1},Da[a].timer=setTimeout(function(){delete Da[a],b()},c))}function K(a,b){var c,d=null,e={};for(c in b)b.hasOwnProperty(c)&&(c===U.myEasyrtcid?d=b[c]:e[c]=b[c]);I(e),J("roomOccupants&"+a,function(){la&&la(a,e,d),U.emitEvent("roomOccupants",{roomName:a,occupants:oa})},100)}function L(a,b){var c={};b&&b(U.ackMessage),a.targetEasyrtcid&&(c.targetEasyrtcid=a.targetEasyrtcid),a.targetRoom&&(c.targetRoom=a.targetRoom),a.targetGroup&&(c.targetGroup=a.targetGroup),a.senderEasyrtcid?U.receivePeerDistribute(a.senderEasyrtcid,a,c):qa?qa(a.msgType,a.msgData,c):webrtcUtils.log("Unhandled server message "+JSON.stringify(a))}function M(a){var b;0!==a.indexOf("turn:")&&0!==a.indexOf("turns:")||(b=a.split(/[@:&]/g)[1],U._turnServers[b]=!0)}function N(a){var b,c,d;for(va={iceServers:[]},U._turnServers={},a&&a.iceServers&&"undefined"!=typeof a.iceServers.length?va={iceServers:a.iceServers}:U.showError(U.errCodes.DEVELOPER_ERR,"iceConfig received from server didn't have an array called iceServers, ignoring it"),b=0;b<a.iceServers.length;b++)if(d=a.iceServers[b],d.urls&&d.urls.length)for(c=0;c<d.urls.length;c++)M(d.urls[c]);else d.url&&M(d.url)}function O(a){a&&(a.easyrtcsid&&(U.easyrtcsid=a.easyrtcsid),a.field&&(da=a.field))}function P(a){U.roomData=a;var b,c,d,e,f,g;for(c in U.roomData)if(U.roomData.hasOwnProperty(c)){if("join"===a[c].roomStatus){U.roomJoin[c]||(U.roomJoin[c]=a[c]);var h=j();h!=={}&&U.setRoomApiField(c,"mediaIds",h)}else if("leave"===a[c].roomStatus){U.roomEntryListener&&U.roomEntryListener(!1,c),delete U.roomJoin[c],delete oa[c];continue}if(a[c].clientList)oa[c]=a[c].clientList;else if(a[c].clientListDelta){if(e=a[c].clientListDelta.updateClient)for(f in e)if(e.hasOwnProperty(f)){oa[c]||(oa[c]=[]),oa[c][f]||(oa[c][f]=e[f]);for(b in e[f])"apiField"!==b&&"presence"!==b||(oa[c][f][b]=e[f][b])}if(d=a[c].clientListDelta.removeClient,d&&oa[c])for(g in d)d.hasOwnProperty(g)&&delete oa[c][g]}U.roomJoin[c]&&a[c].field&&(za.rooms[c]=a[c].field),"join"===a[c].roomStatus&&U.roomEntryListener&&U.roomEntryListener(!0,c),K(c,oa[c])}U.emitEvent("roomOccupant",oa)}function Q(a,b){function c(a){delete ta[a],Ca[a]&&delete Ca[a],sa[a]&&(sa[a].wasAcceptedCB&&sa[a].wasAcceptedCB(!1,a),delete sa[a])}function d(a,b){if(delete ta[a],sa[a]){sa[a].connectionAccepted=!0,sa[a].wasAcceptedCB&&sa[a].wasAcceptedCB(!0,a);var c=function(){},d=function(b,c){sa[a]&&delete sa[a],U.showError(b,c)};s(a,c,d),f=sa[a].pc;var e=new RTCSessionDescription(b);if(!e)throw"Could not create the RTCSessionDescription";U.debugPrinter&&U.debugPrinter("about to call initiating setRemoteDescription");try{X&&(e.sdp=X(e.sdp)),f.setRemoteDescription(e,function(){f.connectDataConnection&&(U.debugPrinter&&U.debugPrinter("calling connectDataConnection(5001,5002)"),f.connectDataConnection(5001,5002))},function(a){webrtcUtils.log("setRemoteDescription failed ",a)})}catch(a){webrtcUtils.log("setRemoteDescription failed ",a)}k(a)}}function e(a,b){sa[a]&&sa[a].pc?j(a,b):(sa[a]||(Ca[a]={candidates:[]}),Ca[a].candidates.push(b))}var f,g=a.senderEasyrtcid,h=a.msgType,i=a.msgData;U.debugPrinter&&U.debugPrinter("received message of type "+h),"undefined"==typeof Ca[g]&&E(g);var j=function(a,b){function c(){}function d(a){U.showError(U.errCodes.ICECANDIDATE_ERR,"bad ice candidate ("+a.name+"): "+JSON.stringify(e))}var e=null;if((!Y||(b=Y(b,!0)))&&(e=new RTCIceCandidate({sdpMLineIndex:b.label,candidate:b.candidate}),f=sa[a].pc,f.addIceCandidate(e,c,d),b.candidate.indexOf("typ relay")>0)){var g=b.candidate.match(/(udp|tcp) \d+ (\d+\.\d+\.\d+\.\d+)/i)[2];U._turnServers[g]=!0}},k=function(a){var b;if(Ca[a]){for(b=0;b<Ca[a].candidates.length;b++)j(a,Ca[a].candidates[b]);delete Ca[a]}},l=function(a,b){var c=function(c,d){if(d)if("string"==typeof d)d=[d];else if(void 0===d.length)return void U.showError(U.errCodes.DEVELOPER_ERR,"accept callback passed invalid streamNames");if(U.debugPrinter&&U.debugPrinter("offer accept="+c),delete ha[a],c){if(!U.supportsPeerConnections())return void U.showError(U.errCodes.CALL_ERR,U.getConstantString("noWebrtcSupport"));B(a,b,d),k(a)}else p(a,"reject",null,null,null),E(a)};return ta[a]&&a<U.myEasyrtcid?(delete ta[a],Ca[a]&&delete Ca[a],sa[a].wasAcceptedCB&&sa[a].wasAcceptedCB(!0,a),delete sa[a],void c(!0)):(ha[a]=b,void(U.acceptCheck?U.acceptCheck(a,c):c(!0)))};switch(h){case"sessionData":O(i.sessionData);break;case"roomData":P(i.roomData);break;case"iceConfig":N(i.iceConfig);break;case"forwardToUrl":i.newWindow?window.open(i.forwardToUrl.url):window.location.href=i.forwardToUrl.url;break;case"offer":l(g,i);break;case"reject":c(g);break;case"answer":d(g,i);break;case"candidate":e(g,i);break;case"hangup":G(g),E(g);break;case"error":U.showError(i.errorCode,i.errorText);break;default:return void U.showError(U.errCodes.DEVELOPER_ERR,"received unknown message type from server, msgType is "+h)}b&&b(U.ackMessage)}function R(a){var b=a.msgData;U.debugPrinter&&U.debugPrinter("entered process token"),b.easyrtcid&&(U.myEasyrtcid=b.easyrtcid),b.field&&(za.connection=b.field),b.iceConfig&&N(b.iceConfig),b.sessionData&&O(b.sessionData),b.roomData&&P(b.roomData),b.application.field&&(za.application=b.application.field)}function S(b,c){var d,e,f,h=null;if(U.cookieId&&document.cookie)for(d=document.cookie.split(/[; ]/g),e=U.cookieId+"=",f=0;f<d.length;f++)0===d[f].indexOf(e)&&(h=d[f].substring(e.length));var i={apiVersion:U.apiVersion,applicationName:U.applicationName,setUserCfg:x(!0)};U.roomJoin||(U.roomJoin={}),U.presenceShow&&(i.setPresence={show:U.presenceShow,status:U.presenceStatus}),U.username&&(i.username=U.username),U.roomJoin&&!a(U.roomJoin)&&(i.roomJoin=U.roomJoin),h&&(i.easyrtcsid=h),ia&&(i.credential=ia),U.webSocket.json.emit("easyrtcAuth",{msgType:"authenticate",msgData:i},function(a){var d;if("error"===a.msgType)c(a.msgData.errorCode,a.msgData.errorText),U.roomJoin={};else{if(R(a),U._roomApiFields)for(d in U._roomApiFields)U._roomApiFields.hasOwnProperty(d)&&g(d);b&&b(U.myEasyrtcid)}})}function T(a,b){function d(a,b){U.webSocket.on(a,b),U.websocketListeners.push({event:a,handler:b})}function e(c){U.webSocketConnected=!0,U.webSocket||U.showError(U.errCodes.CONNECT_ERR,U.getConstantString("badsocket")),U.debugPrinter&&U.debugPrinter("saw socket-server onconnect event"),U.webSocketConnected?S(a,b):b(U.errCodes.SIGNAL_ERR,U.getConstantString("icf"))}var f;if(Aa)U.webSocket=Aa;else if(U.webSocket)for(f in U.websocketListeners)U.websocketListeners.hasOwnProperty(f)&&U.webSocket.removeEventListener(U.websocketListeners[f].event,U.websocketListeners[f].handler);else try{if(U.webSocket=io.connect(ka,$),!U.webSocket)throw"io.connect failed"}catch(a){return U.webSocket=0,void b(U.errCodes.SYSTEM_ERROR,a.toString())}U.websocketListeners=[],d("close",function(a){webrtcUtils.log("the web socket closed")}),d("error",function(a){function d(){U.myEasyrtcid&&c(U.webSocket)?U.showError(U.errCodes.SIGNAL_ERR,U.getConstantString("miscSignalError")):b(U.errCodes.CONNECT_ERR,U.getConstantString("noServer"))}d()}),c(Aa)?e(null):d("connect",e),d("easyrtcMsg",L),d("easyrtcCmd",Q),d("disconnect",function(){U.webSocketConnected=!1,ra=function(){},ga={},o(),U.disconnectListener&&U.disconnectListener()})}var U=this,V=!0,W=null,X=null,Y=null,Z=null,$={"connect timeout":1e4,"force new connection":!0};this.setSdpFilters=function(a,b){W=a,X=b},this.setPeerClosedListener=function(a){this.onPeerClosed=a},this.setPeerFailingListener=function(a,b){this.onPeerFailing=a,this.onPeerRecovered=b},this.setIceCandidateFilter=function(a){Y=a},this.setIceConnectionStateChangeListener=function(a){Z=a},this.setAutoInitUserMedia=function(a){V=!!a},this.format=function(a,b,c,d){for(var e=arguments[0],f=1;f<arguments.length;f++){var g=new RegExp("\\{"+(f-1)+"\\}","gi");e=e.replace(g,arguments[f])}return e};var _={audio:!1,video:!1};this.getConstantString=function(a){return easyrtc_constantStrings[a]?easyrtc_constantStrings[a]:(U.showError(U.errCodes.DEVELOPER_ERR,"Could not find key='"+a+"' in easyrtc_constantStrings"),a)};var aa={roomOccupant:!0,roomOccupants:!0},ba={};this.addEventListener=function(a,b){if(d(a,"addEventListener"),"function"!=typeof b)throw U.showError(U.errCodes.DEVELOPER_ERR,"addEventListener called with a non-function for second argument"),"developer error";U.removeEventListener(a,b),ba[a]||(ba[a]=[]),ba[a][ba[a].length]=b},this.removeEventListener=function(a,b){d(a,"removeEventListener");var c=ba[a],e=0;if(c)for(e=0;e<c.length;e++)c[e]===b&&(e<c.length-1&&(c[e]=c[c.length-1]),c.length=c.length-1)},this.emitEvent=function(a,b){d(a,"emitEvent");var c=ba[a],e=0;if(c)for(e=0;e<c.length;e++)c[e](a,b)},this.errCodes={BAD_NAME:"BAD_NAME",CALL_ERR:"CALL_ERR",DEVELOPER_ERR:"DEVELOPER_ERR",SYSTEM_ERR:"SYSTEM_ERR",CONNECT_ERR:"CONNECT_ERR",MEDIA_ERR:"MEDIA_ERR",MEDIA_WARNING:"MEDIA_WARNING",INTERNAL_ERR:"INTERNAL_ERR",PEER_GONE:"PEER_GONE",ALREADY_CONNECTED:"ALREADY_CONNECTED",BAD_CREDENTIAL:"BAD_CREDENTIAL",ICECANDIDATE_ERR:"ICECANDIDATE_ERR",NOVIABLEICE:"NOVIABLEICE",SIGNAL_ERR:"SIGNAL_ERR"},this.apiVersion="1.0.17",this.ackMessage={msgType:"ack"},this.usernameRegExp=/^(.){1,64}$/,this.cookieId="easyrtcsid";this.loggingOut=!1,this.disconnecting=!1;var ca={},da=[],ea={};this.enableAudioReceive=function(a){"firefox"===webrtcDetectedBrowser?ea.offerToReceiveAudio=a:(ea.mandatory=ea.mandatory||{},ea.mandatory.OfferToReceiveAudio=a)},this.enableVideoReceive=function(a){"firefox"===webrtcDetectedBrowser?ea.offerToReceiveVideo=a:(ea.mandatory=ea.mandatory||{},ea.mandatory.OfferToReceiveVideo=a)},this.enableAudioReceive(!0),this.enableVideoReceive(!0),this.getAudioSourceList=function(a){e(a,"audioinput")},this.getVideoSourceList=function(a){e(a,"videoinput")},U.audioEnabled=!0,U.videoEnabled=!0;var fa="dc";this.debugPrinter=null,this.myEasyrtcid="";var ga={},ha={};this.nativeVideoHeight=0,this.maxP2PMessageLength=1e3,this.nativeVideoWidth=0;var ia=null;this.roomJoin={},this.isNameValid=function(a){return U.usernameRegExp.test(a)},this.setCookieId=function(a){U.cookieId=a},this._desiredVideoProperties={},this.setVideoSource=function(a){U._desiredVideoProperties.videoSrcId=a,delete U._desiredVideoProperties.screenCapture},this._desiredAudioProperties={},this.setAudioSource=function(a){U._desiredAudioProperties.audioSrcId=a},this.setVideoDims=function(a,b,c){U._desiredVideoProperties.width=a,U._desiredVideoProperties.height=b,void 0!==c&&(U._desiredVideoProperties.frameRate=c)},this.setScreenCapture=function(a){U._desiredVideoProperties.screenCapture=a!==!1},U.getUserMediaConstraints=function(){var a={};return U._presetMediaConstraints?(a=U._presetMediaConstraints,delete U._presetMediaConstraints,a):U._desiredVideoProperties.screenCapture?{video:{mandatory:{chromeMediaSource:"screen",maxWidth:screen.width,maxHeight:screen.height,minWidth:screen.width,minHeight:screen.height,minFrameRate:1,maxFrameRate:5},optional:[]},audio:!1}:(U.videoEnabled?"firefox"===webrtcDetectedBrowser?(a.video={},U._desiredVideoProperties.width&&(a.video.width=U._desiredVideoProperties.width),U._desiredVideoProperties.height&&(a.video.height=U._desiredVideoProperties.height),U._desiredVideoProperties.frameRate&&(a.video.frameRate={max:U._desiredVideoProperties.frameRate}),U._desiredVideoProperties.videoSrcId&&(a.video.deviceId=U._desiredVideoProperties.videoSrcId)):(a.video={mandatory:{},optional:[]},U._desiredVideoProperties.width&&(a.video.mandatory.maxWidth=U._desiredVideoProperties.width,a.video.mandatory.minWidth=U._desiredVideoProperties.width),U._desiredVideoProperties.height&&(a.video.mandatory.maxHeight=U._desiredVideoProperties.height,a.video.mandatory.minHeight=U._desiredVideoProperties.height),U._desiredVideoProperties.frameRate&&(a.video.mandatory.maxFrameRate=U._desiredVideoProperties.frameRate),U._desiredVideoProperties.videoSrcId&&(a.video.optional=a.video.optional||[],a.video.optional.push({sourceId:U._desiredVideoProperties.videoSrcId})),0===a.video.mandatory.length&&0===a.video.optional.length&&(a.video=!0)):a.video=!1,U.audioEnabled?"firefox"===webrtcDetectedBrowser?(a.audio={},U._desiredAudioProperties.audioSrcId&&(a.audio.deviceId=U._desiredAudioProperties.audioSrcId)):(a.audio={mandatory:{},optional:[]},U._desiredAudioProperties.audioSrcId&&(a.audio.optional=a.audio.optional||[],a.audio.optional.push({sourceId:U._desiredAudioProperties.audioSrcId}))):a.audio=!1,a)},this.setApplicationName=function(a){U.applicationName=a},this.enableDebug=function(a){a?U.debugPrinter=function(a){var b=(new Error).stack,c="location unknown";if(b){var d=b.split("\n");c="",d.length>=3&&(c=d[2])}webrtcUtils.log("debug "+(new Date).toISOString()+" : "+a+" ["+c+"]")}:U.debugPrinter=null},this.supportsGetUserMedia=function(){return!!getUserMedia},this.supportsPeerConnections=function(){return!!U.supportsGetUserMedia()&&!!window.RTCPeerConnection},this.createRTCPeerConnection=function(a,b){if(RTCPeerConnection)return new RTCPeerConnection(a,b);throw"Your browser doesn't support webRTC (RTCPeerConnection)"},this.getDatachannelConstraints=function(){return"chrome"===webrtcDetectedBrowser&&webrtcDetectedVersion<31?{reliable:!1}:{reliable:!0}},_={audio:!1,video:!1};var ja=!1,ka=null,la=null,ma=null,na=null,oa={},pa={msgTypes:{}},qa=null,ra=function(){},sa={},ta={};this.acceptCheck=function(a,b){b(!0)},this.streamAcceptor=function(a,b){},this.onStreamClosed=function(a){},this.callCancelled=function(a){},this.getPeerConnectionByUserId=function(a){return sa&&sa[a]?sa[a].pc:null};this.getPeerStatistics=function(a,b,c){"firefox"===webrtcDetectedBrowser?U.getFirefoxPeerStatistics(a,b,c):U.getChromePeerStatistics(a,b,c)};var ua=null;this.setRoomApiField=function(a,b,c){if(U._roomApiFields||(U._roomApiFields={}),!b&&!c)return void delete U._roomApiFields[a];if(U._roomApiFields[a]||(U._roomApiFields[a]={}),void 0!==c&&null!==c){if("object"==typeof c)try{JSON.stringify(c)}catch(a){return void U.showError(U.errCodes.DEVELOPER_ERR,"easyrtc.setRoomApiField passed bad object ")}U._roomApiFields[a][b]={fieldName:b,fieldValue:c}}else delete U._roomApiFields[a][b];U.webSocketConnected&&g(a)},this.showError=function(a,b){U.onError({errorCode:a,errorText:b})},this.onError=function(a){U.debugPrinter&&U.debugPrinter("saw error "+a.errorText);var b,c=document.getElementById("easyrtcErrorDialog");if(!c){c=document.createElement("div"),c.id="easyrtcErrorDialog";var d=document.createElement("div");d.innerHTML="Error messages",d.className="easyrtcErrorDialog_title",c.appendChild(d),b=document.createElement("div"),b.id="easyrtcErrorDialog_body",c.appendChild(b);var e=document.createElement("button");e.appendChild(document.createTextNode("Okay")),e.className="easyrtcErrorDialog_okayButton",e.onclick=function(){b.innerHTML="",c.style.display="none"},c.appendChild(e),document.body.appendChild(c)}b=document.getElementById("easyrtcErrorDialog_body");var f=document.createElement("div");f.className="easyrtcErrorDialog_element",f.appendChild(document.createTextNode(a.errorText)),b.appendChild(f),c.style.display="block"},this.createObjectURL=function(a){var b;if(window.URL&&window.URL.createObjectURL)return window.URL.createObjectURL(a);if(window.webkitURL&&window.webkitURL.createObjectURL)return window.webkit.createObjectURL(a);throw b="Your browsers does not support URL.createObjectURL.",U.debugPrinter&&U.debugPrinter("saw exception "+b),b},this.cleanId=function(a){var b={"&":"&amp;","<":"&lt;",">":"&gt;"};return a.replace(/[&<>]/g,function(a){return b[a]})},U.setRoomEntryListener=function(a){U.roomEntryListener=a},U.setRoomOccupantListener=function(a){la=a},this.setDataChannelOpenListener=function(a){ma=a},this.setDataChannelCloseListener=function(a){na=a},this.getConnectionCount=function(){var a,b=0;for(a in sa)sa.hasOwnProperty(a)&&U.getConnectStatus(a)===U.IS_CONNECTED&&b++;return b},this.setMaxP2PMessageLength=function(a){this.maxP2PMessageLength=a},this.enableAudio=function(a){U.audioEnabled=a},this.enableVideo=function(a){U.videoEnabled=a},this.enableDataChannels=function(a){ja=a},this.getLocalMediaIds=function(){return Object.keys(ca)},this.register3rdPartyLocalMediaStream=function(a,b){return k(a,b)},this.getNameOfRemoteStream=function(a,b){return"string"==typeof b?l(a,b):b.id?l(a,b.id):void 0},this.closeLocalMediaStream=function(a){return m(a)},this.closeLocalStream=this.closeLocalMediaStream,this.enableCamera=function(a,b){var c=i(b);c&&c.getVideoTracks&&h(a,c.getVideoTracks())},this.enableMicrophone=function(a,b){var c=i(b);c&&c.getAudioTracks&&h(a,c.getAudioTracks())},this.muteVideoObject=function(a,b){var c;if("string"==typeof a){if(c=document.getElementById(a),!c)throw"Unknown video object "+a}else{if(!a)throw"muteVideoObject passed a null";c=a}c.muted=!!b},U.getLocalStreamAsUrl=function(a){var b=i(a);if(null===b)throw"Developer error: attempt to get a MediaStream without invoking easyrtc.initMediaSource successfully";return U.createObjectURL(b)},this.getLocalStream=function(a){return i(a)||null},this.clearMediaStream=function(a){"undefined"!=typeof a.src?a.src="":"undefined"!=typeof a.srcObject?a.srcObject="":"undefined"!=typeof a.mozSrcObject&&(a.mozSrcObject=null)},this.setVideoObjectSrc=function(a,b){b&&""!==b?(a.autoplay=!0,attachMediaStream(a,b),a.play()):U.clearMediaStream(a)},this.buildLocalMediaStream=function(a,b,c){var d;if("string"!=typeof a)return U.showError(U.errCodes.DEVELOPER_ERR,"easyrtc.buildLocalMediaStream not supplied a stream name"),null;var e=null;for(var f in ca)if(ca.hasOwnProperty(f)&&(e=ca[f]))break;if(!e)for(f in sa)if(sa.hasOwnProperty(f)){var g=sa[f].pc.getRemoteStreams();g&&g.length>0&&(e=g[0])}if(!e)return U.showError(U.errCodes.DEVELOPER_ERR,"Attempt to create a mediastream without one to clone from"),null;var h=e.clone(),i=h.getTracks();if(b)for(d=0;d<b.length;d++)h.addTrack(b[d].clone());if(c)for(d=0;d<c.length;d++)h.addTrack(c[d].clone());for(d=0;d<i.length;d++)h.removeTrack(i[d]);return k(h,a),h},this.loadStylesheet=function(){var a,b,c=document.getElementsByTagName("link");for(a in c)if(c.hasOwnProperty(a)&&(b=c[a],b.href&&b.href.match(/\/easyrtc.css/)))return;var d=document.createElement("link");d.setAttribute("rel","stylesheet"),d.setAttribute("type","text/css"),d.setAttribute("href","/easyrtc/easyrtc.css");var e=document.getElementsByTagName("head")[0],f=e.childNodes[0];e.insertBefore(d,f)},this.formatError=function(a){var b,c;if(null===a||"undefined"==typeof a)return"null";if("string"==typeof a)return a;if(a.type&&a.description)return a.type+" : "+a.description;if("object"!=typeof a)return"Strange case";try{return JSON.stringify(a)}catch(d){c="{";for(b in a)a.hasOwnProperty(b)&&"string"==typeof a[b]&&(c=c+b+"='"+a[b]+"' ");return c+="}"}},this.initMediaSource=function(a,b,c){function d(){return(new Date).getTime()}function e(a){var b=d();b<i+1e3?(webrtcUtils.log("Trying getUserMedia a second time"),setTimeout(function(){getUserMedia(f,g,h)},3e3)):h(a)}if(U.debugPrinter&&U.debugPrinter("about to request local media"),c||(c="default"),_={audio:U.audioEnabled,video:U.videoEnabled},b||(b=function(a,b){var c="easyrtc.initMediaSource: "+U.formatError(b);U.debugPrinter&&U.debugPrinter(c),U.showError(U.errCodes.MEDIA_ERR,c)}),!U.supportsGetUserMedia())return void b(U.errCodes.MEDIA_ERR,U.getConstantString("noWebrtcSupport"));if(!a)return void U.showError(U.errCodes.DEVELOPER_ERR,"easyrtc.initMediaSource not supplied a successCallback");var f=U.getUserMediaConstraints(),g=function(b){U.debugPrinter&&U.debugPrinter("getUserMedia success callback entered"),U.debugPrinter&&U.debugPrinter("successfully got local media"),b.streamName=c,k(b,c);var d,e,f,g;_.video?(d=document.createElement("video"),d.muted=!0,e=30,f=function(){d.videoWidth>0||e<0?(U.nativeVideoWidth=d.videoWidth,U.nativeVideoHeight=d.videoHeight,!U._desiredVideoProperties.height||U.nativeVideoHeight===U._desiredVideoProperties.height&&U.nativeVideoWidth===U._desiredVideoProperties.width||U.showError(U.errCodes.MEDIA_WARNING,U.format(U.getConstantString("resolutionWarning"),U._desiredVideoProperties.width,U._desiredVideoProperties.height,U.nativeVideoWidth,U.nativeVideoHeight)),U.setVideoObjectSrc(d,null),d.removeNode?d.removeNode(!0):(g=document.createElement("div"),g.appendChild(d),g.removeChild(d)),ra(),a&&a(b)):(e-=1,setTimeout(f,300))},U.setVideoObjectSrc(d,b),f()):(ra(),a&&a(b))},h=function(a){webrtcUtils.log("getusermedia failed"),U.debugPrinter&&U.debugPrinter("failed to get local media");var d;d="string"==typeof a?a:a.name?a.name:"Unknown",b&&(webrtcUtils.log("invoking error callback",d),b(U.errCodes.MEDIA_ERR,U.format(U.getConstantString("gumFailed"),d))),m(c),_={audio:!1,video:!1},ra()};if(!U.audioEnabled&&!U.videoEnabled)return void h(U.getConstantString("requireAudioOrVideo"));var i;setTimeout(function(){try{i=d(),getUserMedia(f,g,e)}catch(a){e(a)}},1e3)},this.setAcceptChecker=function(a){U.acceptCheck=a},this.setStreamAcceptor=function(a){U.streamAcceptor=a},U.setOnError=function(a){U.onError=a},this.setCallCancelled=function(a){U.callCancelled=a},this.setOnStreamClosed=function(a){U.onStreamClosed=a},this.supportsDataChannels=function(){return navigator.userAgent.match(/android/i)?webrtcDetectedVersion>=34:"firefox"===webrtcDetectedBrowser||webrtcDetectedVersion>=32},this.setPeerListener=function(a,b,c){b?(pa.msgTypes[b]||(pa.msgTypes[b]={sources:{}}),c?pa.msgTypes[b].sources[c]={cb:a}:pa.msgTypes[b].cb=a):pa.cb=a},this.receivePeerDistribute=function(a,b,c){var d=b.msgType,e=b.msgData;if(!d)return void webrtcUtils.log("received peer message without msgType",b);if(pa.msgTypes[d]){if(pa.msgTypes[d].sources[a]&&pa.msgTypes[d].sources[a].cb)return void pa.msgTypes[d].sources[a].cb(a,d,e,c);if(pa.msgTypes[d].cb)return void pa.msgTypes[d].cb(a,d,e,c)}pa.cb&&pa.cb(a,d,e,c)},this.setServerListener=function(a){qa=a},this.setSocketUrl=function(a,b){U.debugPrinter&&U.debugPrinter("WebRTC signaling server URL set to "+a),ka=a,b&&($=b)},this.setUsername=function(a){return U.myEasyrtcid?(U.showError(U.errCodes.DEVELOPER_ERR,"easyrtc.setUsername called after authentication"),!1):U.isNameValid(a)?(U.username=a,!0):(U.showError(U.errCodes.BAD_NAME,U.format(U.getConstantString("badUserName"),a)),!1)},this.usernameToIds=function(a,b){var c,d,e=[];for(d in oa)if(oa.hasOwnProperty(d)&&(!b||d===b))for(c in oa[d])oa[d].hasOwnProperty(c)&&oa[d][c].username===a&&e.push({easyrtcid:c,roomName:d});return e},this.getRoomApiField=function(a,b,c){return oa[a]&&oa[a][b]&&oa[a][b].apiField&&oa[a][b].apiField[c]?oa[a][b].apiField[c].fieldValue:void 0},this.setCredential=function(a){try{return JSON.stringify(a),ia=a,!0}catch(a){throw U.showError(U.errCodes.BAD_CREDENTIAL,"easyrtc.setCredential passed a non-JSON-able object"),"easyrtc.setCredential passed a non-JSON-able object"}},this.setDisconnectListener=function(a){U.disconnectListener=a},this.idToName=function(a){var b;for(b in oa)if(oa.hasOwnProperty(b)&&oa[b][a]&&oa[b][a].username)return oa[b][a].username;return a},this.webSocket=null;var va={},wa=null,xa=!1;this.setUseFreshIceEachPeerConnection=function(a){xa=a},this.getServerIce=function(){return va},this.setIceUsedInCalls=function(a){a.iceServers?wa=a:U.showError(U.errCodes.DEVELOPER_ERR,"Bad ice configuration passed to easyrtc.setIceUsedInCalls")};var ya=null;this.haveAudioTrack=function(a,b){return n(a,!0,b)},this.haveVideoTrack=function(a,b){return n(a,!1,b)},this.getRoomField=function(a,b){var c=U.getRoomFields(a);return c&&c[b]?c[b].fieldValue:void 0},this.supportsStatistics=function(){var a;try{return a=new RTCPeerConnection({iceServers:[]},{}),!!a.getStats}catch(a){return!1}};var za=null,Aa=null;this.disconnect=function(){U.debugPrinter&&U.debugPrinter("attempt to disconnect from WebRTC signalling server"),U.disconnecting=!0,
U.hangupAll(),U.loggingOut=!0,setTimeout(function(){if(U.webSocket){try{U.webSocket.disconnect()}catch(a){}ya=U.webSocket,U.webSocket=0}U.loggingOut=!1,U.disconnecting=!1,la&&la(null,{},!1),U.emitEvent("roomOccupant",{}),ga={}},250)};var Ba=0;this.sendDataP2P=function(a,b,c){var d=JSON.stringify({msgType:b,msgData:c});if(U.debugPrinter&&U.debugPrinter("sending p2p message to "+a+" with data="+JSON.stringify(d)),sa[a])if(sa[a].dataChannelS)if(sa[a].dataChannelReady)try{d.length>U.maxP2PMessageLength?q(a,d):sa[a].dataChannelS.send(d)}catch(a){throw webrtcUtils.log("snedDataP2P error: ",a),a}else U.showError(U.errCodes.DEVELOPER_ERR,"Attempt to use data channel to "+a+" before it's ready to send.");else U.showError(U.errCodes.DEVELOPER_ERR,"Attempt to send data peer to peer without establishing a data channel to "+a+" first.");else U.showError(U.errCodes.DEVELOPER_ERR,"Attempt to send data peer to peer without a connection to "+a+" first.")},this.sendDataWS=function(a,b,c,d){U.debugPrinter&&U.debugPrinter("sending client message via websockets to "+a+" with data="+JSON.stringify(c)),d||(d=function(a){"error"===a.msgType&&U.showError(a.msgData.errorCode,a.msgData.errorText)});var e={msgType:b,msgData:c};if(a&&("string"==typeof a?e.targetEasyrtcid=a:"object"==typeof a&&(a.targetEasyrtcid&&(e.targetEasyrtcid=a.targetEasyrtcid),a.targetRoom&&(e.targetRoom=a.targetRoom),a.targetGroup&&(e.targetGroup=a.targetGroup))),!U.webSocket)throw U.debugPrinter&&U.debugPrinter("websocket failed because no connection to server"),"Attempt to send message without a valid connection to the server.";U.webSocket.json.emit("easyrtcMsg",e,d)},this.sendData=function(a,b,c,d){sa[a]&&sa[a].dataChannelReady?U.sendDataP2P(a,b,c):U.sendDataWS(a,b,c,d)},this.sendPeerMessage=function(a,b,c,d,e){function f(a){"error"===a.msgType?e&&e(a.msgData.errorCode,a.msgData.errorText):d&&d(a.msgType,a.msgData?a.msgData:null)}a||U.showError(U.errCodes.DEVELOPER_ERR,"destination was null in sendPeerMessage"),U.debugPrinter&&U.debugPrinter("sending peer message "+JSON.stringify(c)),U.sendDataWS(a,b,c,f)},this.sendServerMessage=function(a,b,c,d){function e(a){"error"===a.msgType?d&&d(a.msgData.errorCode,a.msgData.errorText):c&&c(a.msgType,a.msgData?a.msgData:null)}if(U.debugPrinter){var f={msgType:a,msgData:b};U.debugPrinter("sending server message "+JSON.stringify(f))}U.sendDataWS(null,a,b,e)},this.getRoomList=function(a,b){p(null,"getRoomList",null,function(b,c){a(c.roomList)},function(a,c){b?b(a,c):U.showError(a,c)})},this.NOT_CONNECTED="not connected",this.BECOMING_CONNECTED="connection in progress to us.",this.IS_CONNECTED="is connected",this.getConnectStatus=function(a){if(!sa.hasOwnProperty(a))return U.NOT_CONNECTED;var b=sa[a];return!b.sharingAudio&&!b.sharingVideo||b.startedAV?b.sharingData&&!b.dataChannelReady?U.BECOMING_CONNECTED:U.IS_CONNECTED:U.BECOMING_CONNECTED},this.call=function(a,b,c,d,e){if(e)if("string"==typeof e)e=[e];else if("undefined"==typeof e.length)return void U.showError(U.errCodes.DEVELOPER_ERR,"easyrtc.call passed bad streamNames");if(U.debugPrinter&&U.debugPrinter("initiating peer to peer call to "+a+" audio="+U.audioEnabled+" video="+U.videoEnabled+" data="+ja),!U.supportsPeerConnections())return void c(U.errCodes.CALL_ERR,U.getConstantString("noWebrtcSupport"));var f;if(!e&&V){var g=U.getLocalStream();if(!g&&(U.audioEnabled||U.videoEnabled))return void U.initMediaSource(function(){U.call(a,b,c,d)},c)}if(!U.webSocket)throw f="Attempt to make a call prior to connecting to service",U.debugPrinter&&U.debugPrinter(f),f;return ha[a]?(d(!0,a),B(a,ha[a],e),delete ha[a],void U.callCancelled(a,!1)):"undefined"!=typeof ta[a]?(f="Call already pending acceptance",U.debugPrinter&&U.debugPrinter(f),void c(U.errCodes.ALREADY_CONNECTED,f)):void(xa?U.getFreshIceConfig(function(f){f?C(a,b,c,d,e):c(U.errCodes.CALL_ERR,"Attempt to get fresh ice configuration failed")}):C(a,b,c,d,e))};var Ca={};this.hangup=function(a){F(a),ra()},this.hangupAll=function(){var a=!1;for(var b in sa)sa.hasOwnProperty(b)&&(a=!0,F(b));a&&ra()},this.doesDataChannelWork=function(a){return!!sa[a]&&!!sa[a].dataChannelReady},this.getRemoteStream=function(a,b){if(sa[a])return sa[a].getRemoteStreamByName(b);throw U.showError(U.errCodes.DEVELOPER_ERR,"attempt to get stream of uncalled party"),"Developer err: no such stream"},this.makeLocalStreamFromRemoteStream=function(a,b,c){var d;if(!sa[a].pc)throw"Developer err: no such peer ";if(d=sa[a].getRemoteStreamByName(b),!d)throw"Developer err: no such stream";k(d,c)},this.addStreamToCall=function(a,b,c){b||(b="default");var d=i(b);if(d)if(sa[a]&&sa[a].pc){var e=sa[a].pc;sa[a].enableNegotiateListener=!0,e.addStream(d),c&&(sa[a].streamsAddedAcks[b]=c)}else webrtcUtils.log("Can't add stream before a call has started.");else webrtcUtils.log("attempt to add nonexistent stream "+b)},this.setPeerListener(function(a,b,c){if(sa[a]&&sa[a].pc){var d=c.sdp,e=sa[a].pc,f=function(b){var d=function(){function c(){}function d(b,c){delete sa[a],U.showError(b,c)}U.debugPrinter&&U.debugPrinter("sending answer"),p(a,"answer",b,c,d),sa[a].connectionAccepted=!0,s(a,c,d)};W&&(b.sdp=W(b.sdp)),e.setLocalDescription(b,d,function(a){U.showError(U.errCodes.INTERNAL_ERR,"setLocalDescription: "+c)})},g=function(){e.createAnswer(f,function(a){U.showError(U.errCodes.INTERNAL_ERR,"create-answer: "+a)},ea),U.sendPeerMessage(a,"__gotAddedMediaStream",{sdp:d})};U.debugPrinter&&U.debugPrinter("about to call setRemoteDescription in doAnswer");try{X&&(d.sdp=X(d.sdp)),e.setRemoteDescription(new RTCSessionDescription(d),g,function(a){U.showError(U.errCodes.INTERNAL_ERR,"set-remote-description: "+a)})}catch(a){webrtcUtils.log("set remote description failed"),U.debugPrinter&&U.debugPrinter("saw exception in setRemoteDescription"),U.showError(U.errCodes.INTERNAL_ERR,"setRemoteDescription failed: "+a.message)}}else U.showError(U.errCodes.DEVELOPER_ERR,"Attempt to add additional stream before establishing the base call.")},"__addedMediaStream"),this.setPeerListener(function(a,b,c){if(sa[a]&&sa[a].pc){var d=c.sdp;X&&(d.sdp=X(d.sdp));var e=sa[a].pc;e.setRemoteDescription(new RTCSessionDescription(d),function(){},function(a){U.showError(U.errCodes.INTERNAL_ERR,"set-remote-description: "+a)})}else U.debugPrinter&&U.debugPrinter("setPeerListener failed: __gotAddedMediaStream Unknow easyrtcid "+a)},"__gotAddedMediaStream"),this.setPeerListener(function(a,c,d){if(sa[a]&&sa[a].pc){var e=sa[a].getRemoteStreamByName(d.streamName);e&&(u(a,e),b(e))}else U.debugPrinter&&U.debugPrinter("setPeerListener failed: __closingMediaStream Unknow easyrtcid "+a)},"__closingMediaStream"),this.dumpPeerConnectionInfo=function(){var a;for(var b in sa)if(sa.hasOwnProperty(b)){webrtcUtils.log("For peer "+b);var c=sa[b].pc,d=c.getRemoteStreams(),e=[];for(a=0;a<d.length;a++)e.push(d[a].id);var f=c.getLocalStreams(),g=[];for(a=0;a<f.length;a++)g.push(f[a].id);webrtcUtils.log("    "+JSON.stringify({local:g,remote:e}))}},this.isPeerInAnyRoom=function(a){return H(a)};var Da={};this.updatePresence=function(a,b){U.presenceShow=a,U.presenceStatus=b,U.webSocketConnected&&p(null,"setPresence",{setPresence:{show:U.presenceShow,status:U.presenceStatus}},null)},this.getSessionFields=function(){return da},this.getSessionField=function(a){return da[a]?da[a].fieldValue:void 0},this.getRoomOccupantsAsArray=function(a){return oa[a]?Object.keys(oa[a]):null},this.getRoomOccupantsAsMap=function(a){return oa[a]},this.isTurnServer=function(a){return!!U._turnServers[a]},this.getFreshIceConfig=function(a){var b={msgType:"getIceConfig",msgData:{}};a||(a=function(){}),U.webSocket.json.emit("easyrtcCmd",b,function(b){"iceConfig"===b.msgType?(N(b.msgData.iceConfig),a(!0)):(U.showError(b.msgData.errorCode,b.msgData.errorText),a(!1))})},this.joinRoom=function(a,b,c,d){if(U.roomJoin[a])return void U.showError(U.errCodes.DEVELOPER_ERR,"Attempt to join room "+a+" which you are already in.");var e={roomName:a};if(b){try{JSON.stringify(b)}catch(a){throw U.showError(U.errCodes.DEVELOPER_ERR,"non-jsonable parameter to easyrtc.joinRoom"),"Developer error, see application error messages"}var f={};for(var g in b)b.hasOwnProperty(g)&&(f[g]=b[g]);e.roomParameter=f}var h,i,j,k={roomJoin:{}};U.webSocket?(k.roomJoin[a]=e,i=function(b,d){h=d.roomData,U.roomJoin[a]=e,c&&c(a),P(h)},j=function(b,c){d?d(b,c,a):U.showError(b,U.format(U.getConstantString("unableToEnterRoom"),a,c))},p(null,"roomJoin",k,i,j)):U.roomJoin[a]=e},this.leaveRoom=function(a,b,c){var d;U.roomJoin[a]&&(U.webSocket?(d={},d[a]={roomName:a},p(null,"roomLeave",{roomLeave:d},function(c,d){var e=d.roomData;P(e),b&&b(a)},function(b,d){c&&c(b,d,a)})):delete U.roomJoin[a])},this.getRoomsJoined=function(){var a,b={};for(a in U.roomJoin)U.roomJoin.hasOwnProperty(a)&&(b[a]=!0);return b},this.getRoomFields=function(a){return za&&za.rooms&&za.rooms[a]?za.rooms[a]:void 0},this.getApplicationFields=function(){return za.application},this.getConnectionFields=function(){return za.connection},this.useThisSocketConnection=function(a){Aa=a},this.connect=function(a,b,c){return window.io||U.showError(U.errCodes.DEVELOPER_ERR,"Your HTML has not included the socket.io.js library"),!Aa&&U.webSocket?void U.showError(U.errCodes.DEVELOPER_ERR,"Attempt to connect when already connected to socket server"):(va={},ya=null,ga={},Ca={},U.applicationName=a,za={rooms:{},application:{},connection:{}},U.debugPrinter&&U.debugPrinter("attempt to connect to WebRTC signalling server with application name="+a),null===c&&(c=function(a,b){U.showError(a,b)}),void T(b,c))}};window.easyrtc=new Easyrtc,function(){function a(a,c){function d(a,b){var c;if(a&&!document.getElementById(a))return easyrtc.showError(easyrtc.errCodes.DEVELOPER_ERR,"The monitor video id passed to easyApp was bad, saw "+a),!1;for(c in b)if(b.hasOwnProperty(c)){var d=b[c];if(!document.getElementById(d))return easyrtc.showError(easyrtc.errCodes.DEVELOPER_ERR,"The caller video id '"+d+"' passed to easyApp was bad."),!1}return!0}function e(a){return m[a.id]}function f(a,b){m[a.id]=b}function g(a){var b=e(a);return""===b||null===b||void 0===b}function h(a){return k[a]?document.getElementById(k[a]):null}function i(a,b){easyrtc.setVideoObjectSrc(a,b),a.style.visibility&&(a.style.visibility="visible")}function j(a){easyrtc.setVideoObjectSrc(a,""),a.style.visibility="hidden"}var k=c||[],l=c.length,m={},n=null,o=null;if(!d(a,k))throw"bad video element id";a&&(document.getElementById(a).muted="muted"),easyrtc.addEventListener("roomOccupants",function(a,b){var c;for(c=0;c<l;c++){var d=h(c);g(d)||easyrtc.isPeerInAnyRoom(e(d))||(o&&o(e(d),c),f(d,null))}}),easyrtc.setOnCall=function(a){n=a},easyrtc.setOnHangup=function(a){o=a},easyrtc.getIthCaller=function(a){if(a<0||a>=k.length)return null;var b=h(a);return e(b)},easyrtc.getSlotOfCaller=function(a){var b;for(b=0;b<l;b++)if(easyrtc.getIthCaller(b)===a)return b;return-1},easyrtc.setOnStreamClosed(function(a){var b;for(b=0;b<l;b++){var c=h(b);e(c)===a&&(j(c),f(c,""),o&&o(a,b))}}),easyrtc.setAcceptChecker(function(a,b){var c;for(c=0;c<l;c++){var d=h(c);if(g(d))return void b(!0)}b(!1)}),easyrtc.setStreamAcceptor(function(a,b){var c;easyrtc.debugPrinter&&easyrtc.debugPrinter("stream acceptor called");var d;for(c=0;c<l;c++)if(d=h(c),e(d)===a)return i(d,b),void(n&&n(a,c));for(c=0;c<l;c++)if(d=h(c),g(d))return f(d,a),n&&n(a,c),void i(d,b);d=h(0),d&&(easyrtc.hangup(e(d)),i(d,b),n&&n(a,0)),f(d,a)});var p,q,r,s;if(b)for(p=function(a){q=a.parentNode,f(a,""),r=document.createElement("div"),r.className="easyrtc_closeButton",r.onclick=function(){e(a)&&(easyrtc.hangup(e(a)),j(a),f(a,""))},q.appendChild(r)},s=0;s<l;s++)p(h(s));var t=null;if(easyrtc.videoEnabled&&null!==a){if(t=document.getElementById(a),!t)return void console.error("Programmer error: no object called "+a);t.muted="muted",t.defaultMuted=!0}}var b=!0;easyrtc.dontAddCloseButtons=function(){b=!1},easyrtc.easyApp=function(b,c,d,e,f){function g(){j&&j(!0,""),e(easyrtc.myEasyrtcid)}function h(){function a(a,b){j?j(!1,b):f?f(easyrtc.errCodes.CONNECT_ERR,b):easyrtc.showError(easyrtc.errCodes.CONNECT_ERR,b)}i&&i(!0,null),null!==c&&easyrtc.setVideoObjectSrc(document.getElementById(c),easyrtc.getLocalStream()),easyrtc.connect(b,g,a)}var i=null,j=null;a(c,d),easyrtc.setGotMedia=function(a){i=a},easyrtc.setPeerClosedListener(function(a){setTimeout(function(){easyrtc.getSlotOfCaller(a)>=0&&easyrtc.isPeerInAnyRoom(a)&&easyrtc.call(a,function(){},function(){},function(){})},1e3)}),easyrtc.setGotConnection=function(a){j=a};var k=easyrtc.getLocalStream(null);k?h():easyrtc.initMediaSource(h,function(a,b){i?i(!1,b):f?f(easyrtc.errCodes.MEDIA_ERR,b):easyrtc.showError(easyrtc.errCodes.MEDIA_ERR,b)},null)}}();var easyrtc_constantStrings={unableToEnterRoom:"Unable to enter room {0} because {1}",resolutionWarning:"Requested video size of {0}x{1} but got size of {2}x{3}",badUserName:"Illegal username {0}",localMediaError:"Error getting local media stream: {0}",miscSignalError:"Miscellaneous error from signalling server. It may be ignorable.",noServer:"Unable to reach the EasyRTC signalling server.",badsocket:"Socket.io connect event fired with bad websocket.",icf:"Internal communications failure",statsNotSupported:"call statistics not supported by this browser, try Chrome.",noWebrtcSupport:"Your browser doesn't appear to support WebRTC.",gumFailed:"Failed to get access to local media. Error code was {0}.",requireAudioOrVideo:"At least one of audio and video must be provided"};
//# sourceMappingURL=sourcemap.map