function hex2b64(d){var b,e,a="";for(b=0;b+3<=d.length;b+=3)e=parseInt(d.substring(b,b+3),16),a+=b64map.charAt(e>>6)+b64map.charAt(63&e);if(b+1==d.length?(e=parseInt(d.substring(b,b+1),16),a+=b64map.charAt(e<<2)):b+2==d.length&&(e=parseInt(d.substring(b,b+2),16),a+=b64map.charAt(e>>2)+b64map.charAt((3&e)<<4)),b64pad)for(;(3&a.length)>0;)a+=b64pad;return a}function b64tohex(f){var e,c,a,d="",b=0;for(e=0;e<f.length&&f.charAt(e)!=b64pad;++e)a=b64map.indexOf(f.charAt(e)),a<0||(0==b?(d+=int2char(a>>2),c=3&a,b=1):1==b?(d+=int2char(c<<2|a>>4),c=15&a,b=2):2==b?(d+=int2char(c),d+=int2char(a>>2),c=3&a,b=3):(d+=int2char(c<<2|a>>4),d+=int2char(15&a),b=0));return 1==b&&(d+=int2char(c<<2)),d}function b64toBA(e){var c,d=b64tohex(e),b=new Array;for(c=0;2*c<d.length;++c)b[c]=parseInt(d.substring(2*c,2*c+2),16);return b}function BigInteger(e,d,f){null!=e&&("number"==typeof e?this.fromNumber(e,d,f):null==d&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,d))}function nbi(){return new BigInteger(null)}function am1(f,a,b,e,h,g){for(;--g>=0;){var d=a*this[f++]+b[e]+h;h=Math.floor(d/67108864),b[e++]=67108863&d}return h}function am2(f,q,r,e,o,a){for(var k=32767&q,p=q>>15;--a>=0;){var d=32767&this[f],g=this[f++]>>15,b=p*d+g*k;d=k*d+((32767&b)<<15)+r[e]+(1073741823&o),o=(d>>>30)+(b>>>15)+p*g+(o>>>30),r[e++]=1073741823&d}return o}function am3(f,q,r,e,o,a){for(var k=16383&q,p=q>>14;--a>=0;){var d=16383&this[f],g=this[f++]>>14,b=p*d+g*k;d=k*d+((16383&b)<<14)+r[e]+o,o=(d>>28)+(b>>14)+p*g,r[e++]=268435455&d}return o}function int2char(a){return BI_RM.charAt(a)}function intAt(b,a){var d=BI_RC[b.charCodeAt(a)];return null==d?-1:d}function bnpCopyTo(b){for(var a=this.t-1;a>=0;--a)b[a]=this[a];b.t=this.t,b.s=this.s}function bnpFromInt(a){this.t=1,this.s=a<0?-1:0,a>0?this[0]=a:a<-1?this[0]=a+this.DV:this.t=0}function nbv(a){var b=nbi();return b.fromInt(a),b}function bnpFromString(h,c){var e;if(16==c)e=4;else if(8==c)e=3;else if(256==c)e=8;else if(2==c)e=1;else if(32==c)e=5;else{if(4!=c)return void this.fromRadix(h,c);e=2}this.t=0,this.s=0;for(var g=h.length,d=!1,f=0;--g>=0;){var a=8==e?255&h[g]:intAt(h,g);a<0?"-"==h.charAt(g)&&(d=!0):(d=!1,0==f?this[this.t++]=a:f+e>this.DB?(this[this.t-1]|=(a&(1<<this.DB-f)-1)<<f,this[this.t++]=a>>this.DB-f):this[this.t-1]|=a<<f,f+=e,f>=this.DB&&(f-=this.DB))}8==e&&0!=(128&h[0])&&(this.s=-1,f>0&&(this[this.t-1]|=(1<<this.DB-f)-1<<f)),this.clamp(),d&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var a=this.s&this.DM;this.t>0&&this[this.t-1]==a;)--this.t}function bnToString(c){if(this.s<0)return"-"+this.negate().toString(c);var e;if(16==c)e=4;else if(8==c)e=3;else if(2==c)e=1;else if(32==c)e=5;else{if(4!=c)return this.toRadix(c);e=2}var l,g=(1<<e)-1,a=!1,h="",f=this.t,j=this.DB-f*this.DB%e;if(f-- >0)for(j<this.DB&&(l=this[f]>>j)>0&&(a=!0,h=int2char(l));f>=0;)j<e?(l=(this[f]&(1<<j)-1)<<e-j,l|=this[--f]>>(j+=this.DB-e)):(l=this[f]>>(j-=e)&g,j<=0&&(j+=this.DB,--f)),l>0&&(a=!0),a&&(h+=int2char(l));return a?h:"0"}function bnNegate(){var a=nbi();return BigInteger.ZERO.subTo(this,a),a}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(b){var d=this.s-b.s;if(0!=d)return d;var c=this.t;if(d=c-b.t,0!=d)return this.s<0?-d:d;for(;--c>=0;)if(0!=(d=this[c]-b[c]))return d;return 0}function nbits(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=(b=a>>1)&&(a=b,c+=1),c}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(c,b){var a;for(a=this.t-1;a>=0;--a)b[a+c]=this[a];for(a=c-1;a>=0;--a)b[a]=0;b.t=this.t+c,b.s=this.s}function bnpDRShiftTo(c,b){for(var a=c;a<this.t;++a)b[a-c]=this[a];b.t=Math.max(this.t-c,0),b.s=this.s}function bnpLShiftTo(j,e){var d,b=j%this.DB,a=this.DB-b,g=(1<<a)-1,f=Math.floor(j/this.DB),h=this.s<<b&this.DM;for(d=this.t-1;d>=0;--d)e[d+f+1]=this[d]>>a|h,h=(this[d]&g)<<b;for(d=f-1;d>=0;--d)e[d]=0;e[f]=h,e.t=this.t+f+1,e.s=this.s,e.clamp()}function bnpRShiftTo(g,d){d.s=this.s;var e=Math.floor(g/this.DB);if(e>=this.t)return void(d.t=0);var b=g%this.DB,a=this.DB-b,f=(1<<b)-1;d[0]=this[e]>>b;for(var c=e+1;c<this.t;++c)d[c-e-1]|=(this[c]&f)<<a,d[c-e]=this[c]>>b;b>0&&(d[this.t-e-1]|=(this.s&f)<<a),d.t=this.t-e,d.clamp()}function bnpSubTo(d,f){for(var e=0,g=0,b=Math.min(d.t,this.t);e<b;)g+=this[e]-d[e],f[e++]=g&this.DM,g>>=this.DB;if(d.t<this.t){for(g-=d.s;e<this.t;)g+=this[e],f[e++]=g&this.DM,g>>=this.DB;g+=this.s}else{for(g+=this.s;e<d.t;)g-=d[e],f[e++]=g&this.DM,g>>=this.DB;g-=d.s}f.s=g<0?-1:0,g<-1?f[e++]=this.DV+g:g>0&&(f[e++]=g),f.t=e,f.clamp()}function bnpMultiplyTo(c,e){var b=this.abs(),f=c.abs(),d=b.t;for(e.t=d+f.t;--d>=0;)e[d]=0;for(d=0;d<f.t;++d)e[d+b.t]=b.am(0,f[d],e,d,0,b.t);e.s=0,e.clamp(),this.s!=c.s&&BigInteger.ZERO.subTo(e,e)}function bnpSquareTo(d){for(var a=this.abs(),b=d.t=2*a.t;--b>=0;)d[b]=0;for(b=0;b<a.t-1;++b){var e=a.am(b,a[b],d,2*b,0,1);(d[b+a.t]+=a.am(b+1,2*a[b],d,2*b+1,e,a.t-b-1))>=a.DV&&(d[b+a.t]-=a.DV,d[b+a.t+1]=1)}d.t>0&&(d[d.t-1]+=a.am(b,a[b],d,2*b,0,1)),d.s=0,d.clamp()}function bnpDivRemTo(n,h,g){var w=n.abs();if(!(w.t<=0)){var k=this.abs();if(k.t<w.t)return null!=h&&h.fromInt(0),void(null!=g&&this.copyTo(g));null==g&&(g=nbi());var d=nbi(),a=this.s,l=n.s,v=this.DB-nbits(w[w.t-1]);v>0?(w.lShiftTo(v,d),k.lShiftTo(v,g)):(w.copyTo(d),k.copyTo(g));var p=d.t,b=d[p-1];if(0!=b){var o=b*(1<<this.F1)+(p>1?d[p-2]>>this.F2:0),A=this.FV/o,z=(1<<this.F1)/o,x=1<<this.F2,u=g.t,s=u-p,f=null==h?nbi():h;for(d.dlShiftTo(s,f),g.compareTo(f)>=0&&(g[g.t++]=1,g.subTo(f,g)),BigInteger.ONE.dlShiftTo(p,f),f.subTo(d,d);d.t<p;)d[d.t++]=0;for(;--s>=0;){var c=g[--u]==b?this.DM:Math.floor(g[u]*A+(g[u-1]+x)*z);if((g[u]+=d.am(0,c,g,s,0,p))<c)for(d.dlShiftTo(s,f),g.subTo(f,g);g[u]<--c;)g.subTo(f,g)}null!=h&&(g.drShiftTo(p,h),a!=l&&BigInteger.ZERO.subTo(h,h)),g.t=p,g.clamp(),v>0&&g.rShiftTo(v,g),a<0&&BigInteger.ZERO.subTo(g,g)}}}function bnMod(b){var c=nbi();return this.abs().divRemTo(b,null,c),this.s<0&&c.compareTo(BigInteger.ZERO)>0&&b.subTo(c,c),c}function Classic(a){this.m=a}function cConvert(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a}function cRevert(a){return a}function cReduce(a){a.divRemTo(this.m,null,a)}function cMulTo(a,c,b){a.multiplyTo(c,b),this.reduce(b)}function cSqrTo(a,b){a.squareTo(b),this.reduce(b)}function bnpInvDigit(){if(this.t<1)return 0;var a=this[0];if(0==(1&a))return 0;var b=3&a;return b=b*(2-(15&a)*b)&15,b=b*(2-(255&a)*b)&255,b=b*(2-((65535&a)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV,b>0?this.DV-b:-b}function Montgomery(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function montConvert(a){var b=nbi();return a.abs().dlShiftTo(this.m.t,b),b.divRemTo(this.m,null,b),a.s<0&&b.compareTo(BigInteger.ZERO)>0&&this.m.subTo(b,b),b}function montRevert(a){var b=nbi();return a.copyTo(b),this.reduce(b),b}function montReduce(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var c=0;c<this.m.t;++c){var b=32767&a[c],d=b*this.mpl+((b*this.mph+(a[c]>>15)*this.mpl&this.um)<<15)&a.DM;for(b=c+this.m.t,a[b]+=this.m.am(0,d,a,c,0,this.m.t);a[b]>=a.DV;)a[b]-=a.DV,a[++b]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)}function montSqrTo(a,b){a.squareTo(b),this.reduce(b)}function montMulTo(a,c,b){a.multiplyTo(c,b),this.reduce(b)}function bnpIsEven(){return 0==(this.t>0?1&this[0]:this.s)}function bnpExp(h,j){if(h>4294967295||h<1)return BigInteger.ONE;var f=nbi(),a=nbi(),d=j.convert(this),c=nbits(h)-1;for(d.copyTo(f);--c>=0;)if(j.sqrTo(f,a),(h&1<<c)>0)j.mulTo(a,d,f);else{var b=f;f=a,a=b}return j.revert(f)}function bnModPowInt(b,a){var c;return c=b<256||a.isEven()?new Classic(a):new Montgomery(a),this.exp(b,c)}function bnClone(){var a=nbi();return this.copyTo(a),a}function bnIntValue(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnByteValue(){return 0==this.t?this.s:this[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this[0]<<16>>16}function bnpChunkSize(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function bnSigNum(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function bnpToRadix(c){if(null==c&&(c=10),0==this.signum()||c<2||c>36)return"0";var f=this.chunkSize(c),e=Math.pow(c,f),i=nbv(e),j=nbi(),h=nbi(),g="";for(this.divRemTo(i,j,h);j.signum()>0;)g=(e+h.intValue()).toString(c).substr(1)+g,j.divRemTo(i,j,h);return h.intValue().toString(c)+g}function bnpFromRadix(m,h){this.fromInt(0),null==h&&(h=10);for(var f=this.chunkSize(h),g=Math.pow(h,f),e=!1,a=0,l=0,c=0;c<m.length;++c){var k=intAt(m,c);k<0?"-"==m.charAt(c)&&0==this.signum()&&(e=!0):(l=h*l+k,++a>=f&&(this.dMultiply(g),this.dAddOffset(l,0),a=0,l=0))}a>0&&(this.dMultiply(Math.pow(h,a)),this.dAddOffset(l,0)),e&&BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(f,e,h){if("number"==typeof e)if(f<2)this.fromInt(1);else for(this.fromNumber(f,h),this.testBit(f-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(f-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>f&&this.subTo(BigInteger.ONE.shiftLeft(f-1),this);else{var d=new Array,g=7&f;d.length=(f>>3)+1,e.nextBytes(d),g>0?d[0]&=(1<<g)-1:d[0]=0,this.fromString(d,256)}}function bnToByteArray(){var b=this.t,c=new Array;c[0]=this.s;var f,e=this.DB-b*this.DB%8,a=0;if(b-- >0)for(e<this.DB&&(f=this[b]>>e)!=(this.s&this.DM)>>e&&(c[a++]=f|this.s<<this.DB-e);b>=0;)e<8?(f=(this[b]&(1<<e)-1)<<8-e,f|=this[--b]>>(e+=this.DB-8)):(f=this[b]>>(e-=8)&255,e<=0&&(e+=this.DB,--b)),0!=(128&f)&&(f|=-256),0==a&&(128&this.s)!=(128&f)&&++a,(a>0||f!=this.s)&&(c[a++]=f);return c}function bnEquals(b){return 0==this.compareTo(b)}function bnMin(b){return this.compareTo(b)<0?this:b}function bnMax(b){return this.compareTo(b)>0?this:b}function bnpBitwiseTo(c,h,e){var d,g,b=Math.min(c.t,this.t);for(d=0;d<b;++d)e[d]=h(this[d],c[d]);if(c.t<this.t){for(g=c.s&this.DM,d=b;d<this.t;++d)e[d]=h(this[d],g);e.t=this.t}else{for(g=this.s&this.DM,d=b;d<c.t;++d)e[d]=h(g,c[d]);e.t=c.t}e.s=h(this.s,c.s),e.clamp()}function op_and(a,b){return a&b}function bnAnd(b){var c=nbi();return this.bitwiseTo(b,op_and,c),c}function op_or(a,b){return a|b}function bnOr(b){var c=nbi();return this.bitwiseTo(b,op_or,c),c}function op_xor(a,b){return a^b}function bnXor(b){var c=nbi();return this.bitwiseTo(b,op_xor,c),c}function op_andnot(a,b){return a&~b}function bnAndNot(b){var c=nbi();return this.bitwiseTo(b,op_andnot,c),c}function bnNot(){for(var b=nbi(),a=0;a<this.t;++a)b[a]=this.DM&~this[a];return b.t=this.t,b.s=~this.s,b}function bnShiftLeft(b){var a=nbi();return b<0?this.rShiftTo(-b,a):this.lShiftTo(b,a),a}function bnShiftRight(b){var a=nbi();return b<0?this.lShiftTo(-b,a):this.rShiftTo(b,a),a}function lbit(a){if(0==a)return-1;var b=0;return 0==(65535&a)&&(a>>=16,b+=16),0==(255&a)&&(a>>=8,b+=8),0==(15&a)&&(a>>=4,b+=4),0==(3&a)&&(a>>=2,b+=2),0==(1&a)&&++b,b}function bnGetLowestSetBit(){for(var a=0;a<this.t;++a)if(0!=this[a])return a*this.DB+lbit(this[a]);return this.s<0?this.t*this.DB:-1}function cbit(a){for(var b=0;0!=a;)a&=a-1,++b;return b}function bnBitCount(){for(var c=0,a=this.s&this.DM,b=0;b<this.t;++b)c+=cbit(this[b]^a);return c}function bnTestBit(b){var a=Math.floor(b/this.DB);return a>=this.t?0!=this.s:0!=(this[a]&1<<b%this.DB)}function bnpChangeBit(c,b){var a=BigInteger.ONE.shiftLeft(c);return this.bitwiseTo(a,b,a),a}function bnSetBit(a){return this.changeBit(a,op_or)}function bnClearBit(a){return this.changeBit(a,op_andnot)}function bnFlipBit(a){return this.changeBit(a,op_xor)}function bnpAddTo(d,f){for(var e=0,g=0,b=Math.min(d.t,this.t);e<b;)g+=this[e]+d[e],f[e++]=g&this.DM,g>>=this.DB;if(d.t<this.t){for(g+=d.s;e<this.t;)g+=this[e],f[e++]=g&this.DM,g>>=this.DB;g+=this.s}else{for(g+=this.s;e<d.t;)g+=d[e],f[e++]=g&this.DM,g>>=this.DB;g+=d.s}f.s=g<0?-1:0,g>0?f[e++]=g:g<-1&&(f[e++]=this.DV+g),f.t=e,f.clamp()}function bnAdd(b){var c=nbi();return this.addTo(b,c),c}function bnSubtract(b){var c=nbi();return this.subTo(b,c),c}function bnMultiply(b){var c=nbi();return this.multiplyTo(b,c),c}function bnSquare(){var a=nbi();return this.squareTo(a),a}function bnDivide(b){var c=nbi();return this.divRemTo(b,c,null),c}function bnRemainder(b){var c=nbi();return this.divRemTo(b,null,c),c}function bnDivideAndRemainder(b){var d=nbi(),c=nbi();return this.divRemTo(b,d,c),new Array(d,c)}function bnpDMultiply(a){this[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(b,a){if(0!=b){for(;this.t<=a;)this[this.t++]=0;for(this[a]+=b;this[a]>=this.DV;)this[a]-=this.DV,++a>=this.t&&(this[this.t++]=0),++this[a]}}function NullExp(){}function nNop(a){return a}function nMulTo(a,c,b){a.multiplyTo(c,b)}function nSqrTo(a,b){a.squareTo(b)}function bnPow(a){return this.exp(a,new NullExp)}function bnpMultiplyLowerTo(b,f,e){var d=Math.min(this.t+b.t,f);for(e.s=0,e.t=d;d>0;)e[--d]=0;var c;for(c=e.t-this.t;d<c;++d)e[d+this.t]=this.am(0,b[d],e,d,0,this.t);for(c=Math.min(b.t,f);d<c;++d)this.am(0,b[d],e,d,0,f-d);e.clamp()}function bnpMultiplyUpperTo(b,e,d){--e;var c=d.t=this.t+b.t-e;for(d.s=0;--c>=0;)d[c]=0;for(c=Math.max(e-this.t,0);c<b.t;++c)d[this.t+c-e]=this.am(e-c,b[c],d,0,0,this.t+c-e);d.clamp(),d.drShiftTo(1,d)}function Barrett(a){this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*a.t,this.r2),this.mu=this.r2.divide(a),this.m=a}function barrettConvert(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(a.compareTo(this.m)<0)return a;var b=nbi();return a.copyTo(b),this.reduce(b),b}function barrettRevert(a){return a}function barrettReduce(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);a.compareTo(this.r2)<0;)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)}function barrettSqrTo(a,b){a.squareTo(b),this.reduce(b)}function barrettMulTo(a,c,b){a.multiplyTo(c,b),this.reduce(b)}function bnModPow(q,f){var h,v,o=q.bitLength(),b=nbv(1);if(o<=0)return b;h=o<18?1:o<48?3:o<144?4:o<768?5:6,v=o<8?new Classic(f):f.isEven()?new Barrett(f):new Montgomery(f);var p=new Array,d=3,s=h-1,a=(1<<h)-1;if(p[1]=v.convert(this),h>1){var A=nbi();for(v.sqrTo(p[1],A);d<=a;)p[d]=nbi(),v.mulTo(A,p[d-2],p[d]),d+=2}var x,y,l=q.t-1,u=!0,c=nbi();for(o=nbits(q[l])-1;l>=0;){for(o>=s?x=q[l]>>o-s&a:(x=(q[l]&(1<<o+1)-1)<<s-o,l>0&&(x|=q[l-1]>>this.DB+o-s)),d=h;0==(1&x);)x>>=1,--d;if((o-=d)<0&&(o+=this.DB,--l),u)p[x].copyTo(b),u=!1;else{for(;d>1;)v.sqrTo(b,c),v.sqrTo(c,b),d-=2;d>0?v.sqrTo(b,c):(y=b,b=c,c=y),v.mulTo(c,p[x],b)}for(;l>=0&&0==(q[l]&1<<o);)v.sqrTo(b,c),y=b,b=c,c=y,--o<0&&(o=this.DB-1,--l)}return v.revert(b)}function bnGCD(c){var b=this.s<0?this.negate():this.clone(),h=c.s<0?c.negate():c.clone();if(b.compareTo(h)<0){var e=b;b=h,h=e}var d=b.getLowestSetBit(),f=h.getLowestSetBit();if(f<0)return b;for(d<f&&(f=d),f>0&&(b.rShiftTo(f,b),h.rShiftTo(f,h));b.signum()>0;)(d=b.getLowestSetBit())>0&&b.rShiftTo(d,b),(d=h.getLowestSetBit())>0&&h.rShiftTo(d,h),b.compareTo(h)>=0?(b.subTo(h,b),b.rShiftTo(1,b)):(h.subTo(b,h),h.rShiftTo(1,h));return f>0&&h.lShiftTo(f,h),h}function bnpModInt(e){if(e<=0)return 0;var c=this.DV%e,b=this.s<0?e-1:0;if(this.t>0)if(0==c)b=this[0]%e;else for(var a=this.t-1;a>=0;--a)b=(c*b+this[a])%e;return b}function bnModInverse(f){var j=f.isEven();if(this.isEven()&&j||0==f.signum())return BigInteger.ZERO;for(var i=f.clone(),h=this.clone(),g=nbv(1),e=nbv(0),l=nbv(0),k=nbv(1);0!=i.signum();){for(;i.isEven();)i.rShiftTo(1,i),j?(g.isEven()&&e.isEven()||(g.addTo(this,g),e.subTo(f,e)),g.rShiftTo(1,g)):e.isEven()||e.subTo(f,e),e.rShiftTo(1,e);for(;h.isEven();)h.rShiftTo(1,h),j?(l.isEven()&&k.isEven()||(l.addTo(this,l),k.subTo(f,k)),l.rShiftTo(1,l)):k.isEven()||k.subTo(f,k),k.rShiftTo(1,k);i.compareTo(h)>=0?(i.subTo(h,i),j&&g.subTo(l,g),e.subTo(k,e)):(h.subTo(i,h),j&&l.subTo(g,l),k.subTo(e,k))}return 0!=h.compareTo(BigInteger.ONE)?BigInteger.ZERO:k.compareTo(f)>=0?k.subtract(f):k.signum()<0?(k.addTo(f,k),k.signum()<0?k.add(f):k):k}function bnIsProbablePrime(e){var d,b=this.abs();if(1==b.t&&b[0]<=lowprimes[lowprimes.length-1]){for(d=0;d<lowprimes.length;++d)if(b[0]==lowprimes[d])return!0;return!1}if(b.isEven())return!1;for(d=1;d<lowprimes.length;){for(var a=lowprimes[d],c=d+1;c<lowprimes.length&&a<lplim;)a*=lowprimes[c++];for(a=b.modInt(a);d<c;)if(a%lowprimes[d++]==0)return!1}return b.millerRabin(e)}function bnpMillerRabin(f){var g=this.subtract(BigInteger.ONE),c=g.getLowestSetBit();if(c<=0)return!1;var h=g.shiftRight(c);f=f+1>>1,f>lowprimes.length&&(f=lowprimes.length);for(var b=nbi(),e=0;e<f;++e){b.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var l=b.modPow(h,this);if(0!=l.compareTo(BigInteger.ONE)&&0!=l.compareTo(g)){for(var d=1;d++<c&&0!=l.compareTo(g);)if(l=l.modPowInt(2,this),0==l.compareTo(BigInteger.ONE))return!1;if(0!=l.compareTo(g))return!1}}return!0}function Arcfour(){this.i=0,this.j=0,this.S=new Array}function ARC4init(d){var c,a,b;for(c=0;c<256;++c)this.S[c]=c;for(a=0,c=0;c<256;++c)a=a+this.S[c]+d[c%d.length]&255,b=this.S[c],this.S[c]=this.S[a],this.S[a]=b;this.i=0,this.j=0}function ARC4next(){var a;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,a=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=a,this.S[a+this.S[this.i]&255]}function prng_newstate(){return new Arcfour}function rng_seed_int(a){rng_pool[rng_pptr++]^=255&a,rng_pool[rng_pptr++]^=a>>8&255,rng_pool[rng_pptr++]^=a>>16&255,rng_pool[rng_pptr++]^=a>>24&255,rng_pptr>=rng_psize&&(rng_pptr-=rng_psize)}function rng_seed_time(){rng_seed_int((new Date).getTime())}function rng_get_byte(){if(null==rng_state){for(rng_seed_time(),rng_state=prng_newstate(),rng_state.init(rng_pool),rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr)rng_pool[rng_pptr]=0;rng_pptr=0}return rng_state.next()}function rng_get_bytes(b){var a;for(a=0;a<b.length;++a)b[a]=rng_get_byte()}function SecureRandom(){}function parseBigInt(b,a){return new BigInteger(b,a)}function linebrk(c,d){for(var a="",b=0;b+d<c.length;)a+=c.substring(b,b+d)+"\n",b+=d;return a+c.substring(b,c.length)}function byte2Hex(a){return a<16?"0"+a.toString(16):a.toString(16)}function pkcs1pad2(e,h){if(h<e.length+11)return alert("Message too long for RSA"),null;for(var g=new Array,d=e.length-1;d>=0&&h>0;){var f=e.charCodeAt(d--);f<128?g[--h]=f:f>127&&f<2048?(g[--h]=63&f|128,g[--h]=f>>6|192):(g[--h]=63&f|128,g[--h]=f>>6&63|128,g[--h]=f>>12|224)}g[--h]=0;for(var b=new SecureRandom,a=new Array;h>2;){for(a[0]=0;0==a[0];)b.nextBytes(a);g[--h]=a[0]}return g[--h]=2,g[--h]=0,new BigInteger(g)}function oaep_mgf1_arr(c,a,e){for(var b="",d=0;b.length<a;)b+=e(String.fromCharCode.apply(String,c.concat([(4278190080&d)>>24,(16711680&d)>>16,(65280&d)>>8,255&d]))),d+=1;return b}function oaep_pad(l,a,c){if(l.length+2*SHA1_SIZE+2>a)throw"Message too long for RSA";var d,h="";for(d=0;d<a-l.length-2*SHA1_SIZE-2;d+=1)h+="\0";var e=rstr_sha1("")+h+""+l,f=new Array(SHA1_SIZE);(new SecureRandom).nextBytes(f);var g=oaep_mgf1_arr(f,e.length,c||rstr_sha1),k=[];for(d=0;d<e.length;d+=1)k[d]=e.charCodeAt(d)^g.charCodeAt(d);var j=oaep_mgf1_arr(k,f.length,rstr_sha1),b=[0];for(d=0;d<f.length;d+=1)b[d+1]=f[d]^j.charCodeAt(d);return new BigInteger(b.concat(k))}function RSAKey(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function RSASetPublic(b,a){"string"!=typeof b?(this.n=b,this.e=a):null!=b&&null!=a&&b.length>0&&a.length>0?(this.n=parseBigInt(b,16),this.e=parseInt(a,16)):alert("Invalid RSA public key")}function RSADoPublic(a){return a.modPowInt(this.e,this.n)}function RSAEncrypt(d){var a=pkcs1pad2(d,this.n.bitLength()+7>>3);if(null==a)return null;var e=this.doPublic(a);if(null==e)return null;var b=e.toString(16);return 0==(1&b.length)?b:"0"+b}function RSAEncryptOAEP(e,d){var a=oaep_pad(e,this.n.bitLength()+7>>3,d);if(null==a)return null;var f=this.doPublic(a);if(null==f)return null;var b=f.toString(16);return 0==(1&b.length)?b:"0"+b}function pkcs1unpad2(g,j){for(var a=g.toByteArray(),f=0;f<a.length&&0==a[f];)++f;if(a.length-f!=j-1||2!=a[f])return null;for(++f;0!=a[f];)if(++f>=a.length)return null;for(var e="";++f<a.length;){var h=255&a[f];h<128?e+=String.fromCharCode(h):h>191&&h<224?(e+=String.fromCharCode((31&h)<<6|63&a[f+1]),++f):(e+=String.fromCharCode((15&h)<<12|(63&a[f+1])<<6|63&a[f+2]),f+=2)}return e}function oaep_mgf1_str(c,a,e){for(var b="",d=0;b.length<a;)b+=e(c+String.fromCharCode.apply(String,[(4278190080&d)>>24,(16711680&d)>>16,(65280&d)>>8,255&d])),d+=1;return b}function oaep_unpad(l,b,e){l=l.toByteArray();var f;for(f=0;f<l.length;f+=1)l[f]&=255;for(;l.length<b;)l.unshift(0);if(l=String.fromCharCode.apply(String,l),l.length<2*SHA1_SIZE+2)throw"Cipher too short";var f,c=l.substr(1,SHA1_SIZE),o=l.substr(SHA1_SIZE+1),m=oaep_mgf1_str(o,SHA1_SIZE,e||rstr_sha1),h=[];for(f=0;f<c.length;f+=1)h[f]=c.charCodeAt(f)^m.charCodeAt(f);var j=oaep_mgf1_str(String.fromCharCode.apply(String,h),l.length-SHA1_SIZE,rstr_sha1),g=[];for(f=0;f<o.length;f+=1)g[f]=o.charCodeAt(f)^j.charCodeAt(f);if(g=String.fromCharCode.apply(String,g),g.substr(0,SHA1_SIZE)!==rstr_sha1(""))throw"Hash mismatch";g=g.substr(SHA1_SIZE);var a=g.indexOf(""),k=a!=-1?g.substr(0,a).lastIndexOf("\0"):-1;if(k+1!=a)throw"Malformed data";return g.substr(a+1)}function RSASetPrivate(c,a,b){"string"!=typeof c?(this.n=c,this.e=a,this.d=b):null!=c&&null!=a&&c.length>0&&a.length>0?(this.n=parseBigInt(c,16),this.e=parseInt(a,16),this.d=parseBigInt(b,16)):alert("Invalid RSA private key")}function RSASetPrivateEx(g,d,e,c,b,a,h,f){if(null==g)throw"RSASetPrivateEx N == null";if(null==d)throw"RSASetPrivateEx E == null";if(0==g.length)throw"RSASetPrivateEx N.length == 0";if(0==d.length)throw"RSASetPrivateEx E.length == 0";null!=g&&null!=d&&g.length>0&&d.length>0?(this.n=parseBigInt(g,16),this.e=parseInt(d,16),this.d=parseBigInt(e,16),this.p=parseBigInt(c,16),this.q=parseBigInt(b,16),this.dmp1=parseBigInt(a,16),this.dmq1=parseBigInt(h,16),this.coeff=parseBigInt(f,16)):alert("Invalid RSA private key in RSASetPrivateEx")}function RSAGenerate(b,i){var a=new SecureRandom,f=b>>1;this.e=parseInt(i,16);for(var c=new BigInteger(i,16);;){for(;this.p=new BigInteger(b-f,1,a),0!=this.p.subtract(BigInteger.ONE).gcd(c).compareTo(BigInteger.ONE)||!this.p.isProbablePrime(10););for(;this.q=new BigInteger(f,1,a),0!=this.q.subtract(BigInteger.ONE).gcd(c).compareTo(BigInteger.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var h=this.p;this.p=this.q,this.q=h}var g=this.p.subtract(BigInteger.ONE),d=this.q.subtract(BigInteger.ONE),e=g.multiply(d);if(0==e.gcd(c).compareTo(BigInteger.ONE)){this.n=this.p.multiply(this.q),this.d=c.modInverse(e),this.dmp1=this.d.mod(g),this.dmq1=this.d.mod(d),this.coeff=this.q.modInverse(this.p);break}}}function RSADoPrivate(a){if(null==this.p||null==this.q)return a.modPow(this.d,this.n);for(var c=a.mod(this.p).modPow(this.dmp1,this.p),b=a.mod(this.q).modPow(this.dmq1,this.q);c.compareTo(b)<0;)c=c.add(this.p);return c.subtract(b).multiply(this.coeff).mod(this.p).multiply(this.q).add(b)}function RSADecrypt(b){var d=parseBigInt(b,16),a=this.doPrivate(d);return null==a?null:pkcs1unpad2(a,this.n.bitLength()+7>>3)}function RSADecryptOAEP(d,b){var e=parseBigInt(d,16),a=this.doPrivate(e);return null==a?null:oaep_unpad(a,this.n.bitLength()+7>>3,b)}function ECFieldElementFp(b,a){this.x=a,this.q=b}function feFpEquals(a){return a==this||this.q.equals(a.q)&&this.x.equals(a.x)}function feFpToBigInteger(){return this.x}function feFpNegate(){return new ECFieldElementFp(this.q,this.x.negate().mod(this.q))}function feFpAdd(a){return new ECFieldElementFp(this.q,this.x.add(a.toBigInteger()).mod(this.q))}function feFpSubtract(a){return new ECFieldElementFp(this.q,this.x.subtract(a.toBigInteger()).mod(this.q))}function feFpMultiply(a){return new ECFieldElementFp(this.q,this.x.multiply(a.toBigInteger()).mod(this.q))}function feFpSquare(){return new ECFieldElementFp(this.q,this.x.square().mod(this.q))}function feFpDivide(a){return new ECFieldElementFp(this.q,this.x.multiply(a.toBigInteger().modInverse(this.q)).mod(this.q))}function ECPointFp(c,a,d,b){this.curve=c,this.x=a,this.y=d,null==b?this.z=BigInteger.ONE:this.z=b,this.zinv=null}function pointFpGetX(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function pointFpGetY(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function pointFpEquals(a){if(a==this)return!0;if(this.isInfinity())return a.isInfinity();if(a.isInfinity())return this.isInfinity();var c,b;return c=a.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(a.z)).mod(this.curve.q),!!c.equals(BigInteger.ZERO)&&(b=a.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(a.z)).mod(this.curve.q),b.equals(BigInteger.ZERO))}function pointFpIsInfinity(){return null==this.x&&null==this.y||this.z.equals(BigInteger.ZERO)&&!this.y.toBigInteger().equals(BigInteger.ZERO)}function pointFpNegate(){return new ECPointFp(this.curve,this.x,this.y.negate(),this.z)}function pointFpAdd(l){if(this.isInfinity())return l;if(l.isInfinity())return this;var p=l.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(l.z)).mod(this.curve.q),o=l.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(l.z)).mod(this.curve.q);if(BigInteger.ZERO.equals(o))return BigInteger.ZERO.equals(p)?this.twice():this.curve.getInfinity();var j=new BigInteger("3"),e=this.x.toBigInteger(),n=this.y.toBigInteger(),m=(l.x.toBigInteger(),l.y.toBigInteger(),o.square()),i=m.multiply(o),d=e.multiply(m),g=p.square().multiply(this.z),a=g.subtract(d.shiftLeft(1)).multiply(l.z).subtract(i).multiply(o).mod(this.curve.q),h=d.multiply(j).multiply(p).subtract(n.multiply(i)).subtract(g.multiply(p)).multiply(l.z).add(p.multiply(i)).mod(this.curve.q),f=i.multiply(this.z).multiply(l.z).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(h),f)}function pointFpTwice(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var g=new BigInteger("3"),c=this.x.toBigInteger(),h=this.y.toBigInteger(),e=h.multiply(this.z),j=e.multiply(h).mod(this.curve.q),i=this.curve.a.toBigInteger(),k=c.square().multiply(g);BigInteger.ZERO.equals(i)||(k=k.add(this.z.square().multiply(i))),k=k.mod(this.curve.q);var b=k.square().subtract(c.shiftLeft(3).multiply(j)).shiftLeft(1).multiply(e).mod(this.curve.q),f=k.multiply(g).multiply(c).subtract(j.shiftLeft(1)).shiftLeft(2).multiply(j).subtract(k.square().multiply(k)).mod(this.curve.q),d=e.square().multiply(e).shiftLeft(3).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(b),this.curve.fromBigInteger(f),d)}function pointFpMultiply(b){if(this.isInfinity())return this;if(0==b.signum())return this.curve.getInfinity();var c,g=b,f=g.multiply(new BigInteger("3")),l=this.negate(),d=this;for(c=f.bitLength()-2;c>0;--c){d=d.twice();var a=f.testBit(c),j=g.testBit(c);a!=j&&(d=d.add(a?this:l))}return d}function pointFpMultiplyTwo(c,a,b){var d;d=c.bitLength()>b.bitLength()?c.bitLength()-1:b.bitLength()-1;for(var f=this.curve.getInfinity(),e=this.add(a);d>=0;)f=f.twice(),c.testBit(d)?f=b.testBit(d)?f.add(e):f.add(this):b.testBit(d)&&(f=f.add(a)),--d;return f}function ECCurveFp(e,d,c){this.q=e,this.a=this.fromBigInteger(d),this.b=this.fromBigInteger(c),this.infinity=new ECPointFp(this,null,null)}function curveFpGetQ(){return this.q}function curveFpGetA(){return this.a}function curveFpGetB(){return this.b}function curveFpEquals(a){return a==this||this.q.equals(a.q)&&this.a.equals(a.a)&&this.b.equals(a.b)}function curveFpGetInfinity(){return this.infinity}function curveFpFromBigInteger(a){return new ECFieldElementFp(this.q,a)}function curveFpDecodePointHex(d){switch(parseInt(d.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var a=(d.length-2)/2,c=d.substr(2,a),b=d.substr(a+2,a);return new ECPointFp(this,this.fromBigInteger(new BigInteger(c,16)),this.fromBigInteger(new BigInteger(b,16)));default:return null}}function Base64x(){}function stoBA(d){for(var b=new Array,c=0;c<d.length;c++)b[c]=d.charCodeAt(c);return b}function BAtos(b){for(var d="",c=0;c<b.length;c++)d+=String.fromCharCode(b[c]);return d}function BAtohex(b){for(var e="",d=0;d<b.length;d++){var c=b[d].toString(16);1==c.length&&(c="0"+c),e+=c}return e}function stohex(a){return BAtohex(stoBA(a))}function stob64(a){return hex2b64(stohex(a))}function stob64u(a){return b64tob64u(hex2b64(stohex(a)))}function b64utos(a){return BAtos(b64toBA(b64utob64(a)))}function b64tob64u(a){return a=a.replace(/\=/g,""),a=a.replace(/\+/g,"-"),a=a.replace(/\//g,"_")}function b64utob64(a){return a.length%4==2?a+="==":a.length%4==3&&(a+="="),a=a.replace(/-/g,"+"),a=a.replace(/_/g,"/")}function hextob64u(a){return b64tob64u(hex2b64(a))}function b64utohex(a){return b64tohex(b64utob64(a))}function utf8tob64(a){return hex2b64(uricmptohex(encodeURIComponentAll(a)))}function b64toutf8(a){return decodeURIComponent(hextouricmp(b64tohex(a)))}function utf8tohex(a){return uricmptohex(encodeURIComponentAll(a))}function hextoutf8(a){return decodeURIComponent(hextouricmp(a))}function hextorstr(c){for(var b="",a=0;a<c.length-1;a+=2)b+=String.fromCharCode(parseInt(c.substr(a,2),16));return b}function rstrtohex(c){for(var a="",b=0;b<c.length;b++)a+=("0"+c.charCodeAt(b).toString(16)).slice(-2);return a}function uricmptohex(a){return a.replace(/%/g,"")}function hextouricmp(a){return a.replace(/(..)/g,"%$1")}function encodeURIComponentAll(a){for(var d=encodeURIComponent(a),b="",c=0;c<d.length;c++)"%"==d[c]?(b+=d.substr(c,3),c+=2):b=b+"%"+stohex(d[c]);return b}function newline_toUnix(a){return a=a.replace(/\r\n/gm,"\n")}function newline_toDos(a){return a=a.replace(/\r\n/gm,"\n"),a=a.replace(/\n/gm,"\r\n")}function _rsapem_pemToBase64(b){var a=b;return a=a.replace("-----BEGIN RSA PRIVATE KEY-----",""),a=a.replace("-----END RSA PRIVATE KEY-----",""),a=a.replace(/[ \n]+/g,"")}function _rsapem_getPosArrayOfChildrenFromHex(d){var j=new Array,k=ASN1HEX.getStartPosOfV_AtObj(d,0),f=ASN1HEX.getPosOfNextSibling_AtObj(d,k),h=ASN1HEX.getPosOfNextSibling_AtObj(d,f),b=ASN1HEX.getPosOfNextSibling_AtObj(d,h),l=ASN1HEX.getPosOfNextSibling_AtObj(d,b),e=ASN1HEX.getPosOfNextSibling_AtObj(d,l),g=ASN1HEX.getPosOfNextSibling_AtObj(d,e),c=ASN1HEX.getPosOfNextSibling_AtObj(d,g),i=ASN1HEX.getPosOfNextSibling_AtObj(d,c);return j.push(k,f,h,b,l,e,g,c,i),j}function _rsapem_getHexValueArrayOfChildrenFromHex(i){var o=_rsapem_getPosArrayOfChildrenFromHex(i),r=ASN1HEX.getHexOfV_AtObj(i,o[0]),f=ASN1HEX.getHexOfV_AtObj(i,o[1]),j=ASN1HEX.getHexOfV_AtObj(i,o[2]),k=ASN1HEX.getHexOfV_AtObj(i,o[3]),c=ASN1HEX.getHexOfV_AtObj(i,o[4]),b=ASN1HEX.getHexOfV_AtObj(i,o[5]),h=ASN1HEX.getHexOfV_AtObj(i,o[6]),g=ASN1HEX.getHexOfV_AtObj(i,o[7]),l=ASN1HEX.getHexOfV_AtObj(i,o[8]),m=new Array;return m.push(r,f,j,k,c,b,h,g,l),m}function _rsapem_readPrivateKeyFromASN1HexString(c){var b=_rsapem_getHexValueArrayOfChildrenFromHex(c);this.setPrivateEx(b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8])}function _rsapem_readPrivateKeyFromPEMString(e){var c=_rsapem_pemToBase64(e),d=b64tohex(c),b=_rsapem_getHexValueArrayOfChildrenFromHex(d);this.setPrivateEx(b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8])}function _rsasign_getHexPaddedDigestInfoForString(d,e,a){var b=function(f){return KJUR.crypto.Util.hashString(f,a)},c=b(d);return KJUR.crypto.Util.getPaddedDigestInfoHex(c,a,e)}function _zeroPaddingOfSignature(e,d){for(var c="",a=d/4-e.length,b=0;b<a;b++)c+="0";return c+e}function _rsasign_signString(d,a){var b=function(e){return KJUR.crypto.Util.hashString(e,a)},c=b(d);return this.signWithMessageHash(c,a)}function _rsasign_signWithMessageHash(e,c){var f=KJUR.crypto.Util.getPaddedDigestInfoHex(e,c,this.n.bitLength()),b=parseBigInt(f,16),d=this.doPrivate(b),a=d.toString(16);
return _zeroPaddingOfSignature(a,this.n.bitLength())}function _rsasign_signStringWithSHA1(a){return _rsasign_signString.call(this,a,"sha1")}function _rsasign_signStringWithSHA256(a){return _rsasign_signString.call(this,a,"sha256")}function pss_mgf1_str(c,a,e){for(var b="",d=0;b.length<a;)b+=hextorstr(e(rstrtohex(c+String.fromCharCode.apply(String,[(4278190080&d)>>24,(16711680&d)>>16,(65280&d)>>8,255&d])))),d+=1;return b}function _rsasign_signStringPSS(e,a,d){var c=function(f){return KJUR.crypto.Util.hashHex(f,a)},b=c(rstrtohex(e));return void 0===d&&(d=-1),this.signWithMessageHashPSS(b,a,d)}function _rsasign_signWithMessageHashPSS(l,a,k){var d,b=hextorstr(l),g=b.length,m=this.n.bitLength()-1,c=Math.ceil(m/8),o=function(i){return KJUR.crypto.Util.hashHex(i,a)};if(k===-1||void 0===k)k=g;else if(k===-2)k=c-g-2;else if(k<-2)throw"invalid salt length";if(c<g+k+2)throw"data too long";var f="";k>0&&(f=new Array(k),(new SecureRandom).nextBytes(f),f=String.fromCharCode.apply(String,f));var n=hextorstr(o(rstrtohex("\0\0\0\0\0\0\0\0"+b+f))),j=[];for(d=0;d<c-k-g-2;d+=1)j[d]=0;var e=String.fromCharCode.apply(String,j)+""+f,h=pss_mgf1_str(n,e.length,o),q=[];for(d=0;d<e.length;d+=1)q[d]=e.charCodeAt(d)^h.charCodeAt(d);var p=65280>>8*c-m&255;for(q[0]&=~p,d=0;d<g;d++)q.push(n.charCodeAt(d));return q.push(188),_zeroPaddingOfSignature(this.doPrivate(new BigInteger(q)).toString(16),this.n.bitLength())}function _rsasign_getDecryptSignatureBI(a,d,c){var b=new RSAKey;b.setPublic(d,c);var e=b.doPublic(a);return e}function _rsasign_getHexDigestInfoFromSig(a,c,b){var e=_rsasign_getDecryptSignatureBI(a,c,b),d=e.toString(16).replace(/^1f+00/,"");return d}function _rsasign_getAlgNameAndHashFromHexDisgestInfo(f){for(var e in KJUR.crypto.Util.DIGESTINFOHEAD){var d=KJUR.crypto.Util.DIGESTINFOHEAD[e],b=d.length;if(f.substring(0,b)==d){var c=[e,f.substring(b)];return c}}return[]}function _rsasign_verifySignatureWithArgs(f,b,g,j){var e=_rsasign_getHexDigestInfoFromSig(b,g,j),h=_rsasign_getAlgNameAndHashFromHexDisgestInfo(e);if(0==h.length)return!1;var d=h[0],i=h[1],a=function(k){return KJUR.crypto.Util.hashString(k,d)},c=a(f);return i==c}function _rsasign_verifyHexSignatureForMessage(c,b){var d=parseBigInt(c,16),a=_rsasign_verifySignatureWithArgs(b,d,this.n.toString(16),this.e.toString(16));return a}function _rsasign_verifyString(f,j){j=j.replace(_RE_HEXDECONLY,""),j=j.replace(/[ \n]+/g,"");var b=parseBigInt(j,16);if(b.bitLength()>this.n.bitLength())return 0;var i=this.doPublic(b),e=i.toString(16).replace(/^1f+00/,""),g=_rsasign_getAlgNameAndHashFromHexDisgestInfo(e);if(0==g.length)return!1;var d=g[0],h=g[1],a=function(k){return KJUR.crypto.Util.hashString(k,d)},c=a(f);return h==c}function _rsasign_verifyWithMessageHash(e,a){a=a.replace(_RE_HEXDECONLY,""),a=a.replace(/[ \n]+/g,"");var b=parseBigInt(a,16);if(b.bitLength()>this.n.bitLength())return 0;var h=this.doPublic(b),g=h.toString(16).replace(/^1f+00/,""),c=_rsasign_getAlgNameAndHashFromHexDisgestInfo(g);if(0==c.length)return!1;var f=(c[0],c[1]);return f==e}function _rsasign_verifyStringPSS(c,b,a,f){var e=function(g){return KJUR.crypto.Util.hashHex(g,a)},d=e(rstrtohex(c));return void 0===f&&(f=-1),this.verifyWithMessageHashPSS(d,b,a,f)}function _rsasign_verifyWithMessageHashPSS(f,s,l,c){var k=new BigInteger(s,16);if(k.bitLength()>this.n.bitLength())return!1;var q,r=function(i){return KJUR.crypto.Util.hashHex(i,l)},j=hextorstr(f),h=j.length,g=this.n.bitLength()-1,m=Math.ceil(g/8);if(c===-1||void 0===c)c=h;else if(c===-2)c=m-h-2;else if(c<-2)throw"invalid salt length";if(m<h+c+2)throw"data too long";var a=this.doPublic(k).toByteArray();for(q=0;q<a.length;q+=1)a[q]&=255;for(;a.length<m;)a.unshift(0);if(188!==a[m-1])throw"encoded message does not end in 0xbc";a=String.fromCharCode.apply(String,a);var d=a.substr(0,m-h-1),e=a.substr(d.length,h),p=65280>>8*m-g&255;if(0!==(d.charCodeAt(0)&p))throw"bits beyond keysize not zero";var n=pss_mgf1_str(e,d.length,r),o=[];for(q=0;q<d.length;q+=1)o[q]=d.charCodeAt(q)^n.charCodeAt(q);o[0]&=~p;var b=m-h-c-2;for(q=0;q<b;q+=1)if(0!==o[q])throw"leftmost octets not zero";if(1!==o[b])throw"0x01 marker not found";return e===hextorstr(r(rstrtohex("\0\0\0\0\0\0\0\0"+j+String.fromCharCode.apply(String,o.slice(-c)))))}function X509(){this.subjectPublicKeyRSA=null,this.subjectPublicKeyRSA_hN=null,this.subjectPublicKeyRSA_hE=null,this.hex=null,this.getSerialNumberHex=function(){return ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,1])},this.getIssuerHex=function(){return ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,3])},this.getIssuerString=function(){return X509.hex2dn(ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,3]))},this.getSubjectHex=function(){return ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,5])},this.getSubjectString=function(){return X509.hex2dn(ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,5]))},this.getNotBefore=function(){var a=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,4,0]);return a=a.replace(/(..)/g,"%$1"),a=decodeURIComponent(a)},this.getNotAfter=function(){var a=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,4,1]);return a=a.replace(/(..)/g,"%$1"),a=decodeURIComponent(a)},this.readCertPEM=function(c){var e=X509.pemToHex(c),b=X509.getPublicKeyHexArrayFromCertHex(e),d=new RSAKey;d.setPublic(b[0],b[1]),this.subjectPublicKeyRSA=d,this.subjectPublicKeyRSA_hN=b[0],this.subjectPublicKeyRSA_hE=b[1],this.hex=e},this.readCertPEMWithoutRSAInit=function(c){var d=X509.pemToHex(c),b=X509.getPublicKeyHexArrayFromCertHex(d);this.subjectPublicKeyRSA.setPublic(b[0],b[1]),this.subjectPublicKeyRSA_hN=b[0],this.subjectPublicKeyRSA_hE=b[1],this.hex=d}}function trace(text){if("\n"===text[text.length-1]&&(text=text.substring(0,text.length-1)),window.performance){var now=(window.performance.now()/1e3).toFixed(3);webrtcUtils.log(now+": "+text)}else webrtcUtils.log(text)}function requestUserMedia(constraints){return new Promise(function(resolve,reject){getUserMedia(constraints,resolve,reject)})}function Config(){this.ipServerSockets="knet-chat.org",this.portServerSockets="443",this.MAX_HEIGHT_IMG=500,this.MAX_HEIGHT_IMG_PROFILE=320,this.MAX_LENGTH_TRUNCATED_SMS=20,this.MAX_SEND_OFFLINE_SMS=120,this.MAX_SMS_RETRIEVAL=36,this.MAX_WIDTH_IMG=500,this.MAX_WIDTH_IMG_PROFILE=220,this.MIN_WIDTH_IMG_PROFILE=170,this.MIN_HEIGHT_IMG_PROFILE=170,this.SW_VERSION="0.5.4",this.TIME_FADE_ACK=6e3,this.TIME_FADE_WRITING=2500,this.TIME_FADE_ONLINE_NOTICE=4500,this.TIME_SILENT_SCROLL=330,this.TIME_LOAD_EMOJI=3e3,this.TIME_LOAD_SPINNER=200,this.TIME_UNIX_2015=1420070401e3,this.TIME_UNIX_MONTH=2628e6,this.TIME_WAIT_DB=500,this.TIME_WAIT_HTTP_POST=7e3,this.TIME_WAIT_MAILBOX_POLLING=330,this.TIME_WAIT_WAKEUP=2e3,this.TIME_WAIT_PICKUP=6e4,this.pushOptions={android:{senderID:"442395718407",clearNotifications:!0,forceShow:!0,icon:"icon"},ios:{alert:"true",badge:"true",sound:"true"},windows:{}}}!function(){"use strict";function FastClick(layer,options){function bind(method,context){return function(){return method.apply(context,arguments)}}var oldOnClick;if(options=options||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=options.touchBoundary||10,this.layer=layer,this.tapDelay=options.tapDelay||200,this.tapTimeout=options.tapTimeout||700,!FastClick.notNeeded(layer)){for(var methods=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],context=this,i=0,l=methods.length;i<l;i++)context[methods[i]]=bind(context[methods[i]],context);deviceIsAndroid&&(layer.addEventListener("mouseover",this.onMouse,!0),layer.addEventListener("mousedown",this.onMouse,!0),layer.addEventListener("mouseup",this.onMouse,!0)),layer.addEventListener("click",this.onClick,!0),layer.addEventListener("touchstart",this.onTouchStart,!1),layer.addEventListener("touchmove",this.onTouchMove,!1),layer.addEventListener("touchend",this.onTouchEnd,!1),layer.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(layer.removeEventListener=function(type,callback,capture){var rmv=Node.prototype.removeEventListener;"click"===type?rmv.call(layer,type,callback.hijacked||callback,capture):rmv.call(layer,type,callback,capture)},layer.addEventListener=function(type,callback,capture){var adv=Node.prototype.addEventListener;"click"===type?adv.call(layer,type,callback.hijacked||(callback.hijacked=function(event){event.propagationStopped||callback(event)}),capture):adv.call(layer,type,callback,capture)}),"function"==typeof layer.onclick&&(oldOnClick=layer.onclick,layer.addEventListener("click",function(event){oldOnClick(event)},!1),layer.onclick=null)}}var deviceIsWindowsPhone=navigator.userAgent.indexOf("Windows Phone")>=0,deviceIsAndroid=navigator.userAgent.indexOf("Android")>0&&!deviceIsWindowsPhone,deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent)&&!deviceIsWindowsPhone,deviceIsIOS4=deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),deviceIsIOSWithBadTarget=deviceIsIOS&&/OS [6-7]_\d/.test(navigator.userAgent),deviceIsBlackBerry10=navigator.userAgent.indexOf("BB10")>0;FastClick.prototype.needsClick=function(target){switch(target.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(target.disabled)return!0;break;case"input":if(deviceIsIOS&&"file"===target.type||target.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(target.className)},FastClick.prototype.needsFocus=function(target){switch(target.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!deviceIsAndroid;case"input":switch(target.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!target.disabled&&!target.readOnly;default:return/\bneedsfocus\b/.test(target.className)}},FastClick.prototype.sendClick=function(targetElement,event){var clickEvent,touch;document.activeElement&&document.activeElement!==targetElement&&document.activeElement.blur(),touch=event.changedTouches[0],clickEvent=document.createEvent("MouseEvents"),clickEvent.initMouseEvent(this.determineEventType(targetElement),!0,!0,window,1,touch.screenX,touch.screenY,touch.clientX,touch.clientY,!1,!1,!1,!1,0,null),clickEvent.forwardedTouchEvent=!0,targetElement.dispatchEvent(clickEvent)},FastClick.prototype.determineEventType=function(targetElement){return deviceIsAndroid&&"select"===targetElement.tagName.toLowerCase()?"mousedown":"click"},FastClick.prototype.focus=function(targetElement){var length;deviceIsIOS&&targetElement.setSelectionRange&&0!==targetElement.type.indexOf("date")&&"time"!==targetElement.type&&"month"!==targetElement.type?(length=targetElement.value.length,targetElement.setSelectionRange(length,length)):targetElement.focus()},FastClick.prototype.updateScrollParent=function(targetElement){var scrollParent,parentElement;if(scrollParent=targetElement.fastClickScrollParent,!scrollParent||!scrollParent.contains(targetElement)){parentElement=targetElement;do{if(parentElement.scrollHeight>parentElement.offsetHeight){scrollParent=parentElement,targetElement.fastClickScrollParent=parentElement;break}parentElement=parentElement.parentElement}while(parentElement)}scrollParent&&(scrollParent.fastClickLastScrollTop=scrollParent.scrollTop)},FastClick.prototype.getTargetElementFromEventTarget=function(eventTarget){return eventTarget.nodeType===Node.TEXT_NODE?eventTarget.parentNode:eventTarget},FastClick.prototype.onTouchStart=function(event){var targetElement,touch,selection;if(event.targetTouches.length>1)return!0;if(targetElement=this.getTargetElementFromEventTarget(event.target),touch=event.targetTouches[0],deviceIsIOS){if(selection=window.getSelection(),selection.rangeCount&&!selection.isCollapsed)return!0;if(!deviceIsIOS4){if(touch.identifier&&touch.identifier===this.lastTouchIdentifier)return event.preventDefault(),!1;this.lastTouchIdentifier=touch.identifier,this.updateScrollParent(targetElement)}}return this.trackingClick=!0,this.trackingClickStart=event.timeStamp,this.targetElement=targetElement,this.touchStartX=touch.pageX,this.touchStartY=touch.pageY,event.timeStamp-this.lastClickTime<this.tapDelay&&event.preventDefault(),!0},FastClick.prototype.touchHasMoved=function(event){var touch=event.changedTouches[0],boundary=this.touchBoundary;return Math.abs(touch.pageX-this.touchStartX)>boundary||Math.abs(touch.pageY-this.touchStartY)>boundary},FastClick.prototype.onTouchMove=function(event){return!this.trackingClick||((this.targetElement!==this.getTargetElementFromEventTarget(event.target)||this.touchHasMoved(event))&&(this.trackingClick=!1,this.targetElement=null),!0)},FastClick.prototype.findControl=function(labelElement){return void 0!==labelElement.control?labelElement.control:labelElement.htmlFor?document.getElementById(labelElement.htmlFor):labelElement.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},FastClick.prototype.onTouchEnd=function(event){var forElement,trackingClickStart,targetTagName,scrollParent,touch,targetElement=this.targetElement;if(!this.trackingClick)return!0;if(event.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(event.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=event.timeStamp,trackingClickStart=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,deviceIsIOSWithBadTarget&&(touch=event.changedTouches[0],targetElement=document.elementFromPoint(touch.pageX-window.pageXOffset,touch.pageY-window.pageYOffset)||targetElement,targetElement.fastClickScrollParent=this.targetElement.fastClickScrollParent),targetTagName=targetElement.tagName.toLowerCase(),"label"===targetTagName){if(forElement=this.findControl(targetElement)){if(this.focus(targetElement),deviceIsAndroid)return!1;targetElement=forElement}}else if(this.needsFocus(targetElement))return event.timeStamp-trackingClickStart>100||deviceIsIOS&&window.top!==window&&"input"===targetTagName?(this.targetElement=null,!1):(this.focus(targetElement),this.sendClick(targetElement,event),deviceIsIOS&&"select"===targetTagName||(this.targetElement=null,event.preventDefault()),!1);return!(!deviceIsIOS||deviceIsIOS4||(scrollParent=targetElement.fastClickScrollParent,!scrollParent||scrollParent.fastClickLastScrollTop===scrollParent.scrollTop))||(this.needsClick(targetElement)||(event.preventDefault(),this.sendClick(targetElement,event)),!1)},FastClick.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},FastClick.prototype.onMouse=function(event){return!this.targetElement||(!!event.forwardedTouchEvent||(!event.cancelable||(!(!this.needsClick(this.targetElement)||this.cancelNextClick)||(event.stopImmediatePropagation?event.stopImmediatePropagation():event.propagationStopped=!0,event.stopPropagation(),event.preventDefault(),!1))))},FastClick.prototype.onClick=function(event){var permitted;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===event.target.type&&0===event.detail||(permitted=this.onMouse(event),permitted||(this.targetElement=null),permitted)},FastClick.prototype.destroy=function(){var layer=this.layer;deviceIsAndroid&&(layer.removeEventListener("mouseover",this.onMouse,!0),layer.removeEventListener("mousedown",this.onMouse,!0),layer.removeEventListener("mouseup",this.onMouse,!0)),layer.removeEventListener("click",this.onClick,!0),layer.removeEventListener("touchstart",this.onTouchStart,!1),layer.removeEventListener("touchmove",this.onTouchMove,!1),layer.removeEventListener("touchend",this.onTouchEnd,!1),layer.removeEventListener("touchcancel",this.onTouchCancel,!1)},FastClick.notNeeded=function(layer){var metaViewport,chromeVersion,blackberryVersion,firefoxVersion;if("undefined"==typeof window.ontouchstart)return!0;if(chromeVersion=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!deviceIsAndroid)return!0;if(metaViewport=document.querySelector("meta[name=viewport]")){if(metaViewport.content.indexOf("user-scalable=no")!==-1)return!0;if(chromeVersion>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(deviceIsBlackBerry10&&(blackberryVersion=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),blackberryVersion[1]>=10&&blackberryVersion[2]>=3&&(metaViewport=document.querySelector("meta[name=viewport]")))){if(metaViewport.content.indexOf("user-scalable=no")!==-1)return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===layer.style.msTouchAction||"manipulation"===layer.style.touchAction||(firefoxVersion=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1],!!(firefoxVersion>=27&&(metaViewport=document.querySelector("meta[name=viewport]"),metaViewport&&(metaViewport.content.indexOf("user-scalable=no")!==-1||document.documentElement.scrollWidth<=window.outerWidth)))||("none"===layer.style.touchAction||"manipulation"===layer.style.touchAction))},FastClick.attach=function(layer,options){return new FastClick(layer,options)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return FastClick}):"undefined"!=typeof module&&module.exports?(module.exports=FastClick.attach,module.exports.FastClick=FastClick):window.FastClick=FastClick}(),!function(e,t){function M(e){var t=e.length,n=x.type(e);return!x.isWindow(e)&&(!(1!==e.nodeType||!t)||"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e))}function F(e){var t=O[e]={};return x.each(e.match(T)||[],function(e,n){t[n]=!0}),t}function R(e,n,r,i){if(x.acceptData(e)){var o,a,s=x.expando,l=e.nodeType,u=l?x.cache:e,c=l?e[s]:e[s]&&s;if(c&&u[c]&&(i||u[c].data)||r!==t||"string"!=typeof n)return c||(c=l?e[s]=p.pop()||x.guid++:s),u[c]||(u[c]=l?{}:{toJSON:x.noop}),("object"==typeof n||"function"==typeof n)&&(i?u[c]=x.extend(u[c],n):u[c].data=x.extend(u[c].data,n)),a=u[c],i||(a.data||(a.data={}),a=a.data),r!==t&&(a[x.camelCase(n)]=r),"string"==typeof n?(o=a[n],null==o&&(o=a[x.camelCase(n)])):o=a,o}}function W(e,t,n){if(x.acceptData(e)){var r,i,o=e.nodeType,a=o?x.cache:e,s=o?e[x.expando]:x.expando;if(a[s]){if(t&&(r=n?a[s]:a[s].data)){x.isArray(t)?t=t.concat(x.map(t,x.camelCase)):t in r?t=[t]:(t=x.camelCase(t),t=t in r?[t]:t.split(" ")),i=t.length;for(;i--;)delete r[t[i]];if(n?!I(r):!x.isEmptyObject(r))return}(n||(delete a[s].data,I(a[s])))&&(o?x.cleanData([e],!0):x.support.deleteExpando||a!=a.window?delete a[s]:a[s]=null)}}}function $(e,n,r){if(r===t&&1===e.nodeType){var i="data-"+n.replace(P,"-$1").toLowerCase();if(r=e.getAttribute(i),"string"==typeof r){try{r="true"===r||"false"!==r&&("null"===r?null:+r+""===r?+r:B.test(r)?x.parseJSON(r):r)}catch(o){}x.data(e,n,r)}else r=t}return r}function I(e){var t;for(t in e)if(("data"!==t||!x.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function it(){return!0}function ot(){return!1}function at(){try{return a.activeElement}catch(e){}}function pt(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function ft(e,t,n){if(x.isFunction(t))return x.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return x.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(st.test(t))return x.filter(t,e,n);t=x.filter(t,e)}return x.grep(e,function(e){return x.inArray(e,t)>=0!==n})}function dt(e){var t=ht.split("|"),n=e.createDocumentFragment();if(n.createElement)for(;t.length;)n.createElement(t.pop());return n}function Lt(e,t){return x.nodeName(e,"table")&&x.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function Ht(e){return e.type=(null!==x.find.attr(e,"type"))+"/"+e.type,e}function qt(e){var t=Et.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function _t(e,t){for(var n,r=0;null!=(n=e[r]);r++)x._data(n,"globalEval",!t||x._data(t[r],"globalEval"))}function Mt(e,t){if(1===t.nodeType&&x.hasData(e)){var n,r,i,o=x._data(e),a=x._data(t,o),s=o.events;if(s){delete a.handle,a.events={};for(n in s)for(r=0,i=s[n].length;i>r;r++)x.event.add(t,n,s[n][r])}a.data&&(a.data=x.extend({},a.data))}}function Ot(e,t){var n,r,i;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!x.support.noCloneEvent&&t[x.expando]){i=x._data(t);for(r in i.events)x.removeEvent(t,r,i.handle);t.removeAttribute(x.expando)}"script"===n&&t.text!==e.text?(Ht(t).text=e.text,qt(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),x.support.html5Clone&&e.innerHTML&&!x.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&Ct.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}}function Ft(e,n){var r,o,a=0,s=typeof e.getElementsByTagName!==i?e.getElementsByTagName(n||"*"):typeof e.querySelectorAll!==i?e.querySelectorAll(n||"*"):t;if(!s)for(s=[],r=e.childNodes||e;null!=(o=r[a]);a++)!n||x.nodeName(o,n)?s.push(o):x.merge(s,Ft(o,n));return n===t||n&&x.nodeName(e,n)?x.merge([e],s):s}function Bt(e){Ct.test(e.type)&&(e.defaultChecked=e.checked)}function tn(e,t){if(t in e)return t;for(var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=en.length;i--;)if(t=en[i]+n,t in e)return t;return r}function nn(e,t){return e=t||e,"none"===x.css(e,"display")||!x.contains(e.ownerDocument,e)}function rn(e,t){for(var n,r,i,o=[],a=0,s=e.length;s>a;a++)r=e[a],r.style&&(o[a]=x._data(r,"olddisplay"),n=r.style.display,t?(o[a]||"none"!==n||(r.style.display=""),""===r.style.display&&nn(r)&&(o[a]=x._data(r,"olddisplay",ln(r.nodeName)))):o[a]||(i=nn(r),(n&&"none"!==n||!i)&&x._data(r,"olddisplay",i?n:x.css(r,"display"))));for(a=0;s>a;a++)r=e[a],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[a]||"":"none"));return e}function on(e,t,n){var r=Vt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function an(e,t,n,r,i){for(var o=n===(r?"border":"content")?4:"width"===t?1:0,a=0;4>o;o+=2)"margin"===n&&(a+=x.css(e,n+Zt[o],!0,i)),r?("content"===n&&(a-=x.css(e,"padding"+Zt[o],!0,i)),"margin"!==n&&(a-=x.css(e,"border"+Zt[o]+"Width",!0,i))):(a+=x.css(e,"padding"+Zt[o],!0,i),"padding"!==n&&(a+=x.css(e,"border"+Zt[o]+"Width",!0,i)));return a}function sn(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=Rt(e),a=x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,o);if(0>=i||null==i){if(i=Wt(e,t,o),(0>i||null==i)&&(i=e.style[t]),Yt.test(i))return i;r=a&&(x.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+an(e,t,n||(a?"border":"content"),r,o)+"px"}function ln(e){var t=a,n=Gt[e];return n||(n=un(e,t),"none"!==n&&n||(Pt=(Pt||x("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(Pt[0].contentWindow||Pt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=un(e,t),Pt.detach()),Gt[e]=n),n}function un(e,t){var n=x(t.createElement(e)).appendTo(t.body),r=x.css(n[0],"display");return n.remove(),r}function gn(e,t,n,r){var i;if(x.isArray(t))x.each(t,function(t,i){n||pn.test(e)?r(e,i):gn(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==x.type(t))r(e,t);else for(i in t)gn(e+"["+i+"]",t[i],n,r)}function Hn(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(T)||[];if(x.isFunction(n))for(;r=o[i++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function qn(e,n,r,i){function s(l){var u;return o[l]=!0,x.each(e[l]||[],function(e,l){var c=l(n,r,i);return"string"!=typeof c||a||o[c]?a?!(u=c):t:(n.dataTypes.unshift(c),s(c),!1)}),u}var o={},a=e===jn;return s(n.dataTypes[0])||!o["*"]&&s("*")}function _n(e,n){var r,i,o=x.ajaxSettings.flatOptions||{};for(i in n)n[i]!==t&&((o[i]?e:r||(r={}))[i]=n[i]);return r&&x.extend(!0,e,r),e}function Mn(e,n,r){for(var i,o,a,s,l=e.contents,u=e.dataTypes;"*"===u[0];)u.shift(),o===t&&(o=e.mimeType||n.getResponseHeader("Content-Type"));if(o)for(s in l)if(l[s]&&l[s].test(o)){u.unshift(s);break}if(u[0]in r)a=u[0];else{for(s in r){if(!u[0]||e.converters[s+" "+u[0]]){a=s;break}i||(i=s)}a=a||i}return a?(a!==u[0]&&u.unshift(a),r[a]):t}function On(e,t,n,r){var i,o,a,s,l,u={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)u[a.toLowerCase()]=e.converters[a];for(o=c.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!l&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=c.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(a=u[l+" "+o]||u["* "+o],!a)for(i in u)if(s=i.split(" "),s[1]===o&&(a=u[l+" "+s[0]]||u["* "+s[0]])){a===!0?a=u[i]:u[i]!==!0&&(o=s[0],c.unshift(s[1]));break}if(a!==!0)if(a&&e.throws)t=a(t);else try{t=a(t)}catch(p){return{state:"parsererror",error:a?p:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}function In(){try{return new e.XMLHttpRequest}catch(t){}}function zn(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function Kn(){return setTimeout(function(){Xn=t}),Xn=x.now()}function Zn(e,t,n){for(var r,i=(Qn[t]||[]).concat(Qn["*"]),o=0,a=i.length;a>o;o++)if(r=i[o].call(n,t,e))return r}function er(e,t,n){var r,i,o=0,a=Gn.length,s=x.Deferred().always(function(){delete l.elem}),l=function(){if(i)return!1;for(var t=Xn||Kn(),n=Math.max(0,u.startTime+u.duration-t),r=n/u.duration||0,o=1-r,a=0,l=u.tweens.length;l>a;a++)u.tweens[a].run(o);return s.notifyWith(e,[u,o,n]),1>o&&l?n:(s.resolveWith(e,[u]),!1)},u=s.promise({elem:e,props:x.extend({},t),opts:x.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Xn||Kn(),duration:n.duration,tweens:[],createTween:function(t,n){var r=x.Tween(e,u.opts,t,n,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(r),r},stop:function(t){var n=0,r=t?u.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)u.tweens[n].run(1);return t?s.resolveWith(e,[u,t]):s.rejectWith(e,[u,t]),this}}),c=u.props;for(tr(c,u.opts.specialEasing);a>o;o++)if(r=Gn[o].call(u,e,c,u.opts))return r;return x.map(c,Zn,u),x.isFunction(u.opts.start)&&u.opts.start.call(e,u),x.fx.timer(x.extend(l,{elem:e,anim:u,queue:u.opts.queue})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}function tr(e,t){var n,r,i,o,a;for(n in e)if(r=x.camelCase(n),i=t[r],o=e[n],x.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),a=x.cssHooks[r],a&&"expand"in a){o=a.expand(o),delete e[r];for(n in o)n in e||(e[n]=o[n],t[n]=i)}else t[r]=i}function nr(e,t,n){var r,i,o,a,s,l,u=this,c={},p=e.style,f=e.nodeType&&nn(e),d=x._data(e,"fxshow");n.queue||(s=x._queueHooks(e,"fx"),null==s.unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,u.always(function(){u.always(function(){s.unqueued--,x.queue(e,"fx").length||s.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===x.css(e,"display")&&"none"===x.css(e,"float")&&(x.support.inlineBlockNeedsLayout&&"inline"!==ln(e.nodeName)?p.zoom=1:p.display="inline-block")),n.overflow&&(p.overflow="hidden",x.support.shrinkWrapBlocks||u.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],Vn.exec(i)){if(delete t[r],o=o||"toggle"===i,i===(f?"hide":"show"))continue;c[r]=d&&d[r]||x.style(e,r)}if(!x.isEmptyObject(c)){d?"hidden"in d&&(f=d.hidden):d=x._data(e,"fxshow",{}),o&&(d.hidden=!f),f?x(e).show():u.done(function(){x(e).hide()}),u.done(function(){var t;x._removeData(e,"fxshow");for(t in c)x.style(e,t,c[t])});for(r in c)a=Zn(f?d[r]:0,r,u),r in d||(d[r]=a.start,f&&(a.end=a.start,a.start="width"===r||"height"===r?1:0))}}function rr(e,t,n,r,i){return new rr.prototype.init(e,t,n,r,i)}function ir(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=Zt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function or(e){return x.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}var n,r,i=typeof t,o=e.location,a=e.document,s=a.documentElement,l=e.jQuery,u=e.$,c={},p=[],f="1.10.2",d=p.concat,h=p.push,g=p.slice,m=p.indexOf,y=c.toString,v=c.hasOwnProperty,b=f.trim,x=function(e,t){return new x.fn.init(e,t,r)},w=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,T=/\S+/g,C=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,N=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,k=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,E=/^[\],:{}\s]*$/,S=/(?:^|:|,)(?:\s*\[)+/g,A=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,j=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,D=/^-ms-/,L=/-([\da-z])/gi,H=function(e,t){return t.toUpperCase()},q=function(e){(a.addEventListener||"load"===e.type||"complete"===a.readyState)&&(_(),x.ready())},_=function(){a.addEventListener?(a.removeEventListener("DOMContentLoaded",q,!1),e.removeEventListener("load",q,!1)):(a.detachEvent("onreadystatechange",q),e.detachEvent("onload",q))};x.fn=x.prototype={jquery:f,constructor:x,init:function(e,n,r){var i,o;if(!e)return this;if("string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:N.exec(e),!i||!i[1]&&n)return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e);if(i[1]){if(n=n instanceof x?n[0]:n,x.merge(this,x.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:a,!0)),k.test(i[1])&&x.isPlainObject(n))for(i in n)x.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i]);return this}if(o=a.getElementById(i[2]),o&&o.parentNode){if(o.id!==i[2])return r.find(e);this.length=1,this[0]=o}return this.context=a,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):x.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),x.makeArray(e,this))},selector:"",length:0,toArray:function(){return g.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=x.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return x.each(this,e,t)},ready:function(e){return x.ready.promise().done(e),this},slice:function(){return this.pushStack(g.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(x.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:h,sort:[].sort,splice:[].splice},x.fn.init.prototype=x.fn,x.extend=x.fn.extend=function(){var e,n,r,i,o,a,s=arguments[0]||{},l=1,u=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},l=2),"object"==typeof s||x.isFunction(s)||(s={}),u===l&&(s=this,--l);u>l;l++)if(null!=(o=arguments[l]))for(i in o)e=s[i],r=o[i],s!==r&&(c&&r&&(x.isPlainObject(r)||(n=x.isArray(r)))?(n?(n=!1,a=e&&x.isArray(e)?e:[]):a=e&&x.isPlainObject(e)?e:{},s[i]=x.extend(c,a,r)):r!==t&&(s[i]=r));return s},x.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===x&&(e.$=u),t&&e.jQuery===x&&(e.jQuery=l),x},isReady:!1,readyWait:1,holdReady:function(e){e?x.readyWait++:x.ready(!0)},ready:function(e){if(e===!0?!--x.readyWait:!x.isReady){if(!a.body)return setTimeout(x.ready);x.isReady=!0,e!==!0&&--x.readyWait>0||(n.resolveWith(a,[x]),x.fn.trigger&&x(a).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===x.type(e)},isArray:Array.isArray||function(e){return"array"===x.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?c[y.call(e)]||"object":typeof e},isPlainObject:function(e){var n;if(!e||"object"!==x.type(e)||e.nodeType||x.isWindow(e))return!1;try{if(e.constructor&&!v.call(e,"constructor")&&!v.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(r){return!1}if(x.support.ownLast)for(n in e)return v.call(e,n);for(n in e);return n===t||v.call(e,n)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){
if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||a;var r=k.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=x.buildFragment([e],t,i),i&&x(i).remove(),x.merge([],r.childNodes))},parseJSON:function(n){return e.JSON&&e.JSON.parse?e.JSON.parse(n):null===n?n:"string"==typeof n&&(n=x.trim(n),n&&E.test(n.replace(A,"@").replace(j,"]").replace(S,"")))?Function("return "+n)():(x.error("Invalid JSON: "+n),t)},parseXML:function(n){var r,i;if(!n||"string"!=typeof n)return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(o){r=t}return r&&r.documentElement&&!r.getElementsByTagName("parsererror").length||x.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&x.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(D,"ms-").replace(L,H)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,o=e.length,a=M(e);if(n){if(a)for(;o>i&&(r=t.apply(e[i],n),r!==!1);i++);else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(a)for(;o>i&&(r=t.call(e[i],i,e[i]),r!==!1);i++);else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:b&&!b.call("\ufeff ")?function(e){return null==e?"":b.call(e)}:function(e){return null==e?"":(e+"").replace(C,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(M(Object(e))?x.merge(n,"string"==typeof e?[e]:e):h.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(m)return m.call(t,e,n);for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,o=0;if("number"==typeof r)for(;r>o;o++)e[i++]=n[o];else for(;n[o]!==t;)e[i++]=n[o++];return e.length=i,e},grep:function(e,t,n){var r,i=[],o=0,a=e.length;for(n=!!n;a>o;o++)r=!!t(e[o],o),n!==r&&i.push(e[o]);return i},map:function(e,t,n){var r,i=0,o=e.length,a=M(e),s=[];if(a)for(;o>i;i++)r=t(e[i],i,n),null!=r&&(s[s.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(s[s.length]=r);return d.apply([],s)},guid:1,proxy:function(e,n){var r,i,o;return"string"==typeof n&&(o=e[n],n=e,e=o),x.isFunction(e)?(r=g.call(arguments,2),i=function(){return e.apply(n||this,r.concat(g.call(arguments)))},i.guid=e.guid=e.guid||x.guid++,i):t},access:function(e,n,r,i,o,a,s){var l=0,u=e.length,c=null==r;if("object"===x.type(r)){o=!0;for(l in r)x.access(e,n,l,r[l],!0,a,s)}else if(i!==t&&(o=!0,x.isFunction(i)||(s=!0),c&&(s?(n.call(e,i),n=null):(c=n,n=function(e,t,n){return c.call(x(e),n)})),n))for(;u>l;l++)n(e[l],r,s?i:i.call(e[l],l,n(e[l],r)));return o?e:c?n.call(e):u?n(e[0],r):a},now:function(){return(new Date).getTime()},swap:function(e,t,n,r){var i,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=a[o];return i}}),x.ready.promise=function(t){if(!n)if(n=x.Deferred(),"complete"===a.readyState)setTimeout(x.ready);else if(a.addEventListener)a.addEventListener("DOMContentLoaded",q,!1),e.addEventListener("load",q,!1);else{a.attachEvent("onreadystatechange",q),e.attachEvent("onload",q);var r=!1;try{r=null==e.frameElement&&a.documentElement}catch(i){}r&&r.doScroll&&function o(){if(!x.isReady){try{r.doScroll("left")}catch(e){return setTimeout(o,50)}_(),x.ready()}}()}return n.promise(t)},x.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){c["[object "+t+"]"]=t.toLowerCase()}),r=x(a),function(e,t){function at(e,t,n,i){var o,a,s,l,u,c,d,m,y,x;if((t?t.ownerDocument||t:w)!==f&&p(t),t=t||f,n=n||[],!e||"string"!=typeof e)return n;if(1!==(l=t.nodeType)&&9!==l)return[];if(h&&!i){if(o=Z.exec(e))if(s=o[1]){if(9===l){if(a=t.getElementById(s),!a||!a.parentNode)return n;if(a.id===s)return n.push(a),n}else if(t.ownerDocument&&(a=t.ownerDocument.getElementById(s))&&v(t,a)&&a.id===s)return n.push(a),n}else{if(o[2])return M.apply(n,t.getElementsByTagName(e)),n;if((s=o[3])&&r.getElementsByClassName&&t.getElementsByClassName)return M.apply(n,t.getElementsByClassName(s)),n}if(r.qsa&&(!g||!g.test(e))){if(m=d=b,y=t,x=9===l&&e,1===l&&"object"!==t.nodeName.toLowerCase()){for(c=mt(e),(d=t.getAttribute("id"))?m=d.replace(nt,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",u=c.length;u--;)c[u]=m+yt(c[u]);y=V.test(e)&&t.parentNode||t,x=c.join(",")}if(x)try{return M.apply(n,y.querySelectorAll(x)),n}catch(T){}finally{d||t.removeAttribute("id")}}}return kt(e.replace(z,"$1"),t,n,i)}function st(){function t(n,r){return e.push(n+=" ")>o.cacheLength&&delete t[e.shift()],t[n]=r}var e=[];return t}function lt(e){return e[b]=!0,e}function ut(e){var t=f.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ct(e,t){for(var n=e.split("|"),r=e.length;r--;)o.attrHandle[n[r]]=t}function pt(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||D)-(~e.sourceIndex||D);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function ft(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function dt(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ht(e){return lt(function(t){return t=+t,lt(function(n,r){for(var i,o=e([],n.length,t),a=o.length;a--;)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}function gt(){}function mt(e,t){var n,r,i,a,s,l,u,c=k[e+" "];if(c)return t?0:c.slice(0);for(s=e,l=[],u=o.preFilter;s;){(!n||(r=X.exec(s)))&&(r&&(s=s.slice(r[0].length)||s),l.push(i=[])),n=!1,(r=U.exec(s))&&(n=r.shift(),i.push({value:n,type:r[0].replace(z," ")}),s=s.slice(n.length));for(a in o.filter)!(r=Q[a].exec(s))||u[a]&&!(r=u[a](r))||(n=r.shift(),i.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return t?s.length:s?at.error(e):k(e,l).slice(0)}function yt(e){for(var t=0,n=e.length,r="";n>t;t++)r+=e[t].value;return r}function vt(e,t,n){var r=t.dir,o=n&&"parentNode"===r,a=C++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||o)return e(t,n,i)}:function(t,n,s){var l,u,c,p=T+" "+a;if(s){for(;t=t[r];)if((1===t.nodeType||o)&&e(t,n,s))return!0}else for(;t=t[r];)if(1===t.nodeType||o)if(c=t[b]||(t[b]={}),(u=c[r])&&u[0]===p){if((l=u[1])===!0||l===i)return l===!0}else if(u=c[r]=[p],u[1]=e(t,n,s)||i,u[1]===!0)return!0}}function bt(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function xt(e,t,n,r,i){for(var o,a=[],s=0,l=e.length,u=null!=t;l>s;s++)(o=e[s])&&(!n||n(o,r,i))&&(a.push(o),u&&t.push(s));return a}function wt(e,t,n,r,i,o){return r&&!r[b]&&(r=wt(r)),i&&!i[b]&&(i=wt(i,o)),lt(function(o,a,s,l){var u,c,p,f=[],d=[],h=a.length,g=o||Nt(t||"*",s.nodeType?[s]:s,[]),m=!e||!o&&t?g:xt(g,f,e,s,l),y=n?i||(o?e:h||r)?[]:a:m;if(n&&n(m,y,s,l),r)for(u=xt(y,d),r(u,[],s,l),c=u.length;c--;)(p=u[c])&&(y[d[c]]=!(m[d[c]]=p));if(o){if(i||e){if(i){for(u=[],c=y.length;c--;)(p=y[c])&&u.push(m[c]=p);i(null,y=[],u,l)}for(c=y.length;c--;)(p=y[c])&&(u=i?F.call(o,p):f[c])>-1&&(o[u]=!(a[u]=p))}}else y=xt(y===a?y.splice(h,y.length):y),i?i(null,a,y,l):M.apply(a,y)})}function Tt(e){for(var t,n,r,i=e.length,a=o.relative[e[0].type],s=a||o.relative[" "],l=a?1:0,c=vt(function(e){return e===t},s,!0),p=vt(function(e){return F.call(t,e)>-1},s,!0),f=[function(e,n,r){return!a&&(r||n!==u)||((t=n).nodeType?c(e,n,r):p(e,n,r))}];i>l;l++)if(n=o.relative[e[l].type])f=[vt(bt(f),n)];else{if(n=o.filter[e[l].type].apply(null,e[l].matches),n[b]){for(r=++l;i>r&&!o.relative[e[r].type];r++);return wt(l>1&&bt(f),l>1&&yt(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(z,"$1"),n,r>l&&Tt(e.slice(l,r)),i>r&&Tt(e=e.slice(r)),i>r&&yt(e))}f.push(n)}return bt(f)}function Ct(e,t){var n=0,r=t.length>0,a=e.length>0,s=function(s,l,c,p,d){var h,g,m,y=[],v=0,b="0",x=s&&[],w=null!=d,C=u,N=s||a&&o.find.TAG("*",d&&l.parentNode||l),k=T+=null==C?1:Math.random()||.1;for(w&&(u=l!==f&&l,i=n);null!=(h=N[b]);b++){if(a&&h){for(g=0;m=e[g++];)if(m(h,l,c)){p.push(h);break}w&&(T=k,i=++n)}r&&((h=!m&&h)&&v--,s&&x.push(h))}if(v+=b,r&&b!==v){for(g=0;m=t[g++];)m(x,y,l,c);if(s){if(v>0)for(;b--;)x[b]||y[b]||(y[b]=q.call(p));y=xt(y)}M.apply(p,y),w&&!s&&y.length>0&&v+t.length>1&&at.uniqueSort(p)}return w&&(T=k,u=C),x};return r?lt(s):s}function Nt(e,t,n){for(var r=0,i=t.length;i>r;r++)at(e,t[r],n);return n}function kt(e,t,n,i){var a,s,u,c,p,f=mt(e);if(!i&&1===f.length){if(s=f[0]=f[0].slice(0),s.length>2&&"ID"===(u=s[0]).type&&r.getById&&9===t.nodeType&&h&&o.relative[s[1].type]){if(t=(o.find.ID(u.matches[0].replace(rt,it),t)||[])[0],!t)return n;e=e.slice(s.shift().value.length)}for(a=Q.needsContext.test(e)?0:s.length;a--&&(u=s[a],!o.relative[c=u.type]);)if((p=o.find[c])&&(i=p(u.matches[0].replace(rt,it),V.test(s[0].type)&&t.parentNode||t))){if(s.splice(a,1),e=i.length&&yt(s),!e)return M.apply(n,i),n;break}}return l(e,f)(i,t,!h,n,V.test(e)),n}var n,r,i,o,a,s,l,u,c,p,f,d,h,g,m,y,v,b="sizzle"+-new Date,w=e.document,T=0,C=0,N=st(),k=st(),E=st(),S=!1,A=function(e,t){return e===t?(S=!0,0):0},j=typeof t,D=1<<31,L={}.hasOwnProperty,H=[],q=H.pop,_=H.push,M=H.push,O=H.slice,F=H.indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]===e)return t;return-1},B="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",P="[\\x20\\t\\r\\n\\f]",R="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",W=R.replace("w","w#"),$="\\["+P+"*("+R+")"+P+"*(?:([*^$|!~]?=)"+P+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+W+")|)|)"+P+"*\\]",I=":("+R+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+$.replace(3,8)+")*)|.*)\\)|)",z=RegExp("^"+P+"+|((?:^|[^\\\\])(?:\\\\.)*)"+P+"+$","g"),X=RegExp("^"+P+"*,"+P+"*"),U=RegExp("^"+P+"*([>+~]|"+P+")"+P+"*"),V=RegExp(P+"*[+~]"),Y=RegExp("="+P+"*([^\\]'\"]*)"+P+"*\\]","g"),J=RegExp(I),G=RegExp("^"+W+"$"),Q={ID:RegExp("^#("+R+")"),CLASS:RegExp("^\\.("+R+")"),TAG:RegExp("^("+R.replace("w","w*")+")"),ATTR:RegExp("^"+$),PSEUDO:RegExp("^"+I),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+P+"*(even|odd|(([+-]|)(\\d*)n|)"+P+"*(?:([+-]|)"+P+"*(\\d+)|))"+P+"*\\)|)","i"),bool:RegExp("^(?:"+B+")$","i"),needsContext:RegExp("^"+P+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+P+"*((?:-\\d)?\\d*)"+P+"*\\)|)(?=[^-]|$)","i")},K=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/^(?:input|select|textarea|button)$/i,tt=/^h\d$/i,nt=/'|\\/g,rt=RegExp("\\\\([\\da-f]{1,6}"+P+"?|("+P+")|.)","ig"),it=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(55296|r>>10,56320|1023&r)};try{M.apply(H=O.call(w.childNodes),w.childNodes),H[w.childNodes.length].nodeType}catch(ot){M={apply:H.length?function(e,t){_.apply(e,O.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}s=at.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},r=at.support={},p=at.setDocument=function(e){var n=e?e.ownerDocument||e:w,i=n.defaultView;return n!==f&&9===n.nodeType&&n.documentElement?(f=n,d=n.documentElement,h=!s(n),i&&i.attachEvent&&i!==i.top&&i.attachEvent("onbeforeunload",function(){p()}),r.attributes=ut(function(e){return e.className="i",!e.getAttribute("className")}),r.getElementsByTagName=ut(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),r.getElementsByClassName=ut(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),r.getById=ut(function(e){return d.appendChild(e).id=b,!n.getElementsByName||!n.getElementsByName(b).length}),r.getById?(o.find.ID=function(e,t){if(typeof t.getElementById!==j&&h){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},o.filter.ID=function(e){var t=e.replace(rt,it);return function(e){return e.getAttribute("id")===t}}):(delete o.find.ID,o.filter.ID=function(e){var t=e.replace(rt,it);return function(e){var n=typeof e.getAttributeNode!==j&&e.getAttributeNode("id");return n&&n.value===t}}),o.find.TAG=r.getElementsByTagName?function(e,n){return typeof n.getElementsByTagName!==j?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},o.find.CLASS=r.getElementsByClassName&&function(e,n){return typeof n.getElementsByClassName!==j&&h?n.getElementsByClassName(e):t},m=[],g=[],(r.qsa=K.test(n.querySelectorAll))&&(ut(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||g.push("\\["+P+"*(?:value|"+B+")"),e.querySelectorAll(":checked").length||g.push(":checked")}),ut(function(e){var t=n.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&g.push("[*^$]="+P+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||g.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),g.push(",.*:")})),(r.matchesSelector=K.test(y=d.webkitMatchesSelector||d.mozMatchesSelector||d.oMatchesSelector||d.msMatchesSelector))&&ut(function(e){r.disconnectedMatch=y.call(e,"div"),y.call(e,"[s!='']:x"),m.push("!=",I)}),g=g.length&&RegExp(g.join("|")),m=m.length&&RegExp(m.join("|")),v=K.test(d.contains)||d.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},A=d.compareDocumentPosition?function(e,t){if(e===t)return S=!0,0;var i=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);return i?1&i||!r.sortDetached&&t.compareDocumentPosition(e)===i?e===n||v(w,e)?-1:t===n||v(w,t)?1:c?F.call(c,e)-F.call(c,t):0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,o=e.parentNode,a=t.parentNode,s=[e],l=[t];if(e===t)return S=!0,0;if(!o||!a)return e===n?-1:t===n?1:o?-1:a?1:c?F.call(c,e)-F.call(c,t):0;if(o===a)return pt(e,t);for(r=e;r=r.parentNode;)s.unshift(r);for(r=t;r=r.parentNode;)l.unshift(r);for(;s[i]===l[i];)i++;return i?pt(s[i],l[i]):s[i]===w?-1:l[i]===w?1:0},n):f},at.matches=function(e,t){return at(e,null,null,t)},at.matchesSelector=function(e,t){if((e.ownerDocument||e)!==f&&p(e),t=t.replace(Y,"='$1']"),!(!r.matchesSelector||!h||m&&m.test(t)||g&&g.test(t)))try{var n=y.call(e,t);if(n||r.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(i){}return at(t,f,null,[e]).length>0},at.contains=function(e,t){return(e.ownerDocument||e)!==f&&p(e),v(e,t)},at.attr=function(e,n){(e.ownerDocument||e)!==f&&p(e);var i=o.attrHandle[n.toLowerCase()],a=i&&L.call(o.attrHandle,n.toLowerCase())?i(e,n,!h):t;return a===t?r.attributes||!h?e.getAttribute(n):(a=e.getAttributeNode(n))&&a.specified?a.value:null:a},at.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},at.uniqueSort=function(e){var t,n=[],i=0,o=0;if(S=!r.detectDuplicates,c=!r.sortStable&&e.slice(0),e.sort(A),S){for(;t=e[o++];)t===e[o]&&(i=n.push(o));for(;i--;)e.splice(n[i],1)}return e},a=at.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=a(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=a(t);return n},o=at.selectors={cacheLength:50,createPseudo:lt,match:Q,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(rt,it),e[3]=(e[4]||e[5]||"").replace(rt,it),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||at.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&at.error(e[0]),e},PSEUDO:function(e){var n,r=!e[5]&&e[2];return Q.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:r&&J.test(r)&&(n=mt(r,!0))&&(n=r.indexOf(")",r.length-n)-r.length)&&(e[0]=e[0].slice(0,n),e[2]=r.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(rt,it).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=N[e+" "];return t||(t=RegExp("(^|"+P+")"+e+"("+P+"|$)"))&&N(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==j&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=at.attr(r,e);return null==i?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,l){var u,c,p,f,d,h,g=o!==a?"nextSibling":"previousSibling",m=t.parentNode,y=s&&t.nodeName.toLowerCase(),v=!l&&!s;if(m){if(o){for(;g;){for(p=t;p=p[g];)if(s?p.nodeName.toLowerCase()===y:1===p.nodeType)return!1;h=g="only"===e&&!h&&"nextSibling"}return!0}if(h=[a?m.firstChild:m.lastChild],a&&v){for(c=m[b]||(m[b]={}),u=c[e]||[],d=u[0]===T&&u[1],f=u[0]===T&&u[2],p=d&&m.childNodes[d];p=++d&&p&&p[g]||(f=d=0)||h.pop();)if(1===p.nodeType&&++f&&p===t){c[e]=[T,d,f];break}}else if(v&&(u=(t[b]||(t[b]={}))[e])&&u[0]===T)f=u[1];else for(;(p=++d&&p&&p[g]||(f=d=0)||h.pop())&&((s?p.nodeName.toLowerCase()!==y:1!==p.nodeType)||!++f||(v&&((p[b]||(p[b]={}))[e]=[T,f]),p!==t)););return f-=i,f===r||0===f%r&&f/r>=0}}},PSEUDO:function(e,t){var n,r=o.pseudos[e]||o.setFilters[e.toLowerCase()]||at.error("unsupported pseudo: "+e);return r[b]?r(t):r.length>1?(n=[e,e,"",t],o.setFilters.hasOwnProperty(e.toLowerCase())?lt(function(e,n){for(var i,o=r(e,t),a=o.length;a--;)i=F.call(e,o[a]),e[i]=!(n[i]=o[a])}):function(e){return r(e,0,n)}):r}},pseudos:{not:lt(function(e){var t=[],n=[],r=l(e.replace(z,"$1"));return r[b]?lt(function(e,t,n,i){for(var o,a=r(e,null,i,[]),s=e.length;s--;)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()}}),has:lt(function(e){return function(t){return at(e,t).length>0}}),contains:lt(function(e){return function(t){return(t.textContent||t.innerText||a(t)).indexOf(e)>-1}}),lang:lt(function(e){return G.test(e||"")||at.error("unsupported lang: "+e),e=e.replace(rt,it).toLowerCase(),function(t){var n;do if(n=h?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===d},focus:function(e){return e===f.activeElement&&(!f.hasFocus||f.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!o.pseudos.empty(e)},header:function(e){return tt.test(e.nodeName)},input:function(e){return et.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:ht(function(){return[0]}),last:ht(function(e,t){return[t-1]}),eq:ht(function(e,t,n){return[0>n?n+t:n]}),even:ht(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:ht(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:ht(function(e,t,n){for(var r=0>n?n+t:n;--r>=0;)e.push(r);return e}),gt:ht(function(e,t,n){for(var r=0>n?n+t:n;t>++r;)e.push(r);return e})}},o.pseudos.nth=o.pseudos.eq;for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})o.pseudos[n]=ft(n);for(n in{submit:!0,reset:!0})o.pseudos[n]=dt(n);gt.prototype=o.filters=o.pseudos,o.setFilters=new gt,l=at.compile=function(e,t){var n,r=[],i=[],o=E[e+" "];if(!o){for(t||(t=mt(e)),n=t.length;n--;)o=Tt(t[n]),o[b]?r.push(o):i.push(o);o=E(e,Ct(i,r))}return o},r.sortStable=b.split("").sort(A).join("")===b,r.detectDuplicates=S,p(),r.sortDetached=ut(function(e){return 1&e.compareDocumentPosition(f.createElement("div"))}),ut(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||ct("type|href|height|width",function(e,n,r){return r?t:e.getAttribute(n,"type"===n.toLowerCase()?1:2)}),r.attributes&&ut(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||ct("value",function(e,n,r){return r||"input"!==e.nodeName.toLowerCase()?t:e.defaultValue}),ut(function(e){return null==e.getAttribute("disabled")})||ct(B,function(e,n,r){var i;return r?t:(i=e.getAttributeNode(n))&&i.specified?i.value:e[n]===!0?n.toLowerCase():null}),x.find=at,x.expr=at.selectors,x.expr[":"]=x.expr.pseudos,x.unique=at.uniqueSort,x.text=at.getText,x.isXMLDoc=at.isXML,x.contains=at.contains}(e);var O={};x.Callbacks=function(e){e="string"==typeof e?O[e]||F(e):x.extend({},e);var n,r,i,o,a,s,l=[],u=!e.once&&[],c=function(t){for(r=e.memory&&t,i=!0,a=s||0,s=0,o=l.length,n=!0;l&&o>a;a++)if(l[a].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}n=!1,l&&(u?u.length&&c(u.shift()):r?l=[]:p.disable())},p={add:function(){if(l){var t=l.length;!function i(t){x.each(t,function(t,n){var r=x.type(n);"function"===r?e.unique&&p.has(n)||l.push(n):n&&n.length&&"string"!==r&&i(n)})}(arguments),n?o=l.length:r&&(s=t,c(r))}return this},remove:function(){return l&&x.each(arguments,function(e,t){for(var r;(r=x.inArray(t,l,r))>-1;)l.splice(r,1),n&&(o>=r&&o--,a>=r&&a--)}),this},has:function(e){return e?x.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],o=0,this},disable:function(){return l=u=r=t,this},disabled:function(){return!l},lock:function(){return u=t,r||p.disable(),this},locked:function(){return!u},fireWith:function(e,t){return!l||i&&!u||(t=t||[],t=[e,t.slice?t.slice():t],n?u.push(t):c(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!i}};return p},x.extend({Deferred:function(e){var t=[["resolve","done",x.Callbacks("once memory"),"resolved"],["reject","fail",x.Callbacks("once memory"),"rejected"],["notify","progress",x.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return x.Deferred(function(n){x.each(t,function(t,o){var a=o[0],s=x.isFunction(e[t])&&e[t];i[o[1]](function(){var e=s&&s.apply(this,arguments);e&&x.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a+"With"](this===r?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?x.extend(e,r):r}},i={};return r.pipe=r.then,x.each(t,function(e,o){var a=o[2],s=o[3];r[o[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=a.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var s,l,u,t=0,n=g.call(arguments),r=n.length,i=1!==r||e&&x.isFunction(e.promise)?r:0,o=1===i?e:x.Deferred(),a=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?g.call(arguments):r,n===s?o.notifyWith(t,n):--i||o.resolveWith(t,n)}};if(r>1)for(s=Array(r),l=Array(r),u=Array(r);r>t;t++)n[t]&&x.isFunction(n[t].promise)?n[t].promise().done(a(t,u,n)).fail(o.reject).progress(a(t,l,s)):--i;return i||o.resolveWith(u,n),o.promise()}}),x.support=function(t){var n,r,o,s,l,u,c,p,f,d=a.createElement("div");if(d.setAttribute("className","t"),d.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=d.getElementsByTagName("*")||[],r=d.getElementsByTagName("a")[0],!r||!r.style||!n.length)return t;s=a.createElement("select"),u=s.appendChild(a.createElement("option")),o=d.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t.getSetAttribute="t"!==d.className,t.leadingWhitespace=3===d.firstChild.nodeType,t.tbody=!d.getElementsByTagName("tbody").length,t.htmlSerialize=!!d.getElementsByTagName("link").length,t.style=/top/.test(r.getAttribute("style")),t.hrefNormalized="/a"===r.getAttribute("href"),t.opacity=/^0.5/.test(r.style.opacity),t.cssFloat=!!r.style.cssFloat,t.checkOn=!!o.value,t.optSelected=u.selected,t.enctype=!!a.createElement("form").enctype,t.html5Clone="<:nav></:nav>"!==a.createElement("nav").cloneNode(!0).outerHTML,t.inlineBlockNeedsLayout=!1,t.shrinkWrapBlocks=!1,t.pixelPosition=!1,t.deleteExpando=!0,t.noCloneEvent=!0,t.reliableMarginRight=!0,t.boxSizingReliable=!0,o.checked=!0,t.noCloneChecked=o.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!u.disabled;try{delete d.test}catch(h){t.deleteExpando=!1}o=a.createElement("input"),o.setAttribute("value",""),t.input=""===o.getAttribute("value"),o.value="t",o.setAttribute("type","radio"),t.radioValue="t"===o.value,o.setAttribute("checked","t"),o.setAttribute("name","t"),l=a.createDocumentFragment(),l.appendChild(o),t.appendChecked=o.checked,t.checkClone=l.cloneNode(!0).cloneNode(!0).lastChild.checked,d.attachEvent&&(d.attachEvent("onclick",function(){t.noCloneEvent=!1}),d.cloneNode(!0).click());for(f in{submit:!0,change:!0,focusin:!0})d.setAttribute(c="on"+f,"t"),t[f+"Bubbles"]=c in e||d.attributes[c].expando===!1;d.style.backgroundClip="content-box",d.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===d.style.backgroundClip;for(f in x(t))break;return t.ownLast="0"!==f,x(function(){var n,r,o,s="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",l=a.getElementsByTagName("body")[0];l&&(n=a.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",l.appendChild(n).appendChild(d),d.innerHTML="<table><tr><td></td><td>t</td></tr></table>",o=d.getElementsByTagName("td"),o[0].style.cssText="padding:0;margin:0;border:0;display:none",p=0===o[0].offsetHeight,o[0].style.display="",o[1].style.display="none",t.reliableHiddenOffsets=p&&0===o[0].offsetHeight,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",x.swap(l,null!=l.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===d.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(d,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(d,null)||{width:"4px"}).width,r=d.appendChild(a.createElement("div")),r.style.cssText=d.style.cssText=s,r.style.marginRight=r.style.width="0",d.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),typeof d.style.zoom!==i&&(d.innerHTML="",d.style.cssText=s+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===d.offsetWidth,d.style.display="block",d.innerHTML="<div></div>",d.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==d.offsetWidth,t.inlineBlockNeedsLayout&&(l.style.zoom=1)),l.removeChild(n),n=d=o=r=null)}),n=s=l=u=r=o=null,t}({});var B=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,P=/([A-Z])/g;x.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?x.cache[e[x.expando]]:e[x.expando],!!e&&!I(e)},data:function(e,t,n){return R(e,t,n)},removeData:function(e,t){return W(e,t)},_data:function(e,t,n){return R(e,t,n,!0)},_removeData:function(e,t){return W(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&x.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),x.fn.extend({data:function(e,n){var r,i,o=null,a=0,s=this[0];if(e===t){if(this.length&&(o=x.data(s),1===s.nodeType&&!x._data(s,"parsedAttrs"))){for(r=s.attributes;r.length>a;a++)i=r[a].name,0===i.indexOf("data-")&&(i=x.camelCase(i.slice(5)),$(s,i,o[i]));x._data(s,"parsedAttrs",!0)}return o}return"object"==typeof e?this.each(function(){x.data(this,e)}):arguments.length>1?this.each(function(){x.data(this,e,n)}):s?$(s,e,x.data(s,e)):null},removeData:function(e){return this.each(function(){x.removeData(this,e)})}}),x.extend({queue:function(e,n,r){var i;return e?(n=(n||"fx")+"queue",i=x._data(e,n),r&&(!i||x.isArray(r)?i=x._data(e,n,x.makeArray(r)):i.push(r)),i||[]):t},dequeue:function(e,t){t=t||"fx";var n=x.queue(e,t),r=n.length,i=n.shift(),o=x._queueHooks(e,t),a=function(){x.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return x._data(e,n)||x._data(e,n,{empty:x.Callbacks("once memory").add(function(){x._removeData(e,t+"queue"),x._removeData(e,n)})})}}),x.fn.extend({queue:function(e,n){var r=2;return"string"!=typeof e&&(n=e,e="fx",r--),r>arguments.length?x.queue(this[0],e):n===t?this:this.each(function(){var t=x.queue(this,e,n);x._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&x.dequeue(this,e)})},dequeue:function(e){return this.each(function(){x.dequeue(this,e)})},delay:function(e,t){return e=x.fx?x.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,o=x.Deferred(),a=this,s=this.length,l=function(){--i||o.resolveWith(a,[a])};for("string"!=typeof e&&(n=e,e=t),e=e||"fx";s--;)r=x._data(a[s],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(l));return l(),o.promise(n)}});var z,X,U=/[\t\r\n\f]/g,V=/\r/g,Y=/^(?:input|select|textarea|button|object)$/i,J=/^(?:a|area)$/i,G=/^(?:checked|selected)$/i,Q=x.support.getSetAttribute,K=x.support.input;x.fn.extend({attr:function(e,t){return x.access(this,x.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){x.removeAttr(this,e)})},prop:function(e,t){return x.access(this,x.prop,e,t,arguments.length>1)},removeProp:function(e){return e=x.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,o,a=0,s=this.length,l="string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).addClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(T)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(U," "):" ")){for(o=0;i=t[o++];)0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=x.trim(r)}return this},removeClass:function(e){var t,n,r,i,o,a=0,s=this.length,l=0===arguments.length||"string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).removeClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(T)||[];s>a;a++)if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(U," "):"")){for(o=0;i=t[o++];)for(;r.indexOf(" "+i+" ")>=0;)r=r.replace(" "+i+" "," ");n.className=e?x.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):x.isFunction(e)?this.each(function(n){x(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n)for(var t,r=0,o=x(this),a=e.match(T)||[];t=a[r++];)o.hasClass(t)?o.removeClass(t):o.addClass(t);else(n===i||"boolean"===n)&&(this.className&&x._data(this,"__className__",this.className),this.className=this.className||e===!1?"":x._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,r=this.length;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(U," ").indexOf(t)>=0)return!0;
return!1},val:function(e){var n,r,i,o=this[0];return arguments.length?(i=x.isFunction(e),this.each(function(n){var o;1===this.nodeType&&(o=i?e.call(this,n,x(this).val()):e,null==o?o="":"number"==typeof o?o+="":x.isArray(o)&&(o=x.map(o,function(e){return null==e?"":e+""})),r=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()],r&&"set"in r&&r.set(this,o,"value")!==t||(this.value=o))})):o?(r=x.valHooks[o.type]||x.valHooks[o.nodeName.toLowerCase()],r&&"get"in r&&(n=r.get(o,"value"))!==t?n:(n=o.value,"string"==typeof n?n.replace(V,""):null==n?"":n)):void 0}}),x.extend({valHooks:{option:{get:function(e){var t=x.find.attr(e,"value");return null!=t?t:e.text}},select:{get:function(e){for(var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||0>i,a=o?null:[],s=o?i+1:r.length,l=0>i?s:o?i:0;s>l;l++)if(n=r[l],!(!n.selected&&l!==i||(x.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&x.nodeName(n.parentNode,"optgroup"))){if(t=x(n).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var n,r,i=e.options,o=x.makeArray(t),a=i.length;a--;)r=i[a],(r.selected=x.inArray(x(r).val(),o)>=0)&&(n=!0);return n||(e.selectedIndex=-1),o}}},attr:function(e,n,r){var o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return typeof e.getAttribute===i?x.prop(e,n,r):(1===s&&x.isXMLDoc(e)||(n=n.toLowerCase(),o=x.attrHooks[n]||(x.expr.match.bool.test(n)?X:z)),r===t?o&&"get"in o&&null!==(a=o.get(e,n))?a:(a=x.find.attr(e,n),null==a?t:a):null!==r?o&&"set"in o&&(a=o.set(e,r,n))!==t?a:(e.setAttribute(n,r+""),r):(x.removeAttr(e,n),t))},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(T);if(o&&1===e.nodeType)for(;n=o[i++];)r=x.propFix[n]||n,x.expr.match.bool.test(n)?K&&Q||!G.test(n)?e[r]=!1:e[x.camelCase("default-"+n)]=e[r]=!1:x.attr(e,n,""),e.removeAttribute(Q?n:r)},attrHooks:{type:{set:function(e,t){if(!x.support.radioValue&&"radio"===t&&x.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{for:"htmlFor",class:"className"},prop:function(e,n,r){var i,o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return a=1!==s||!x.isXMLDoc(e),a&&(n=x.propFix[n]||n,o=x.propHooks[n]),r!==t?o&&"set"in o&&(i=o.set(e,r,n))!==t?i:e[n]=r:o&&"get"in o&&null!==(i=o.get(e,n))?i:e[n]},propHooks:{tabIndex:{get:function(e){var t=x.find.attr(e,"tabindex");return t?parseInt(t,10):Y.test(e.nodeName)||J.test(e.nodeName)&&e.href?0:-1}}}}),X={set:function(e,t,n){return t===!1?x.removeAttr(e,n):K&&Q||!G.test(n)?e.setAttribute(!Q&&x.propFix[n]||n,n):e[x.camelCase("default-"+n)]=e[n]=!0,n}},x.each(x.expr.match.bool.source.match(/\w+/g),function(e,n){var r=x.expr.attrHandle[n]||x.find.attr;x.expr.attrHandle[n]=K&&Q||!G.test(n)?function(e,n,i){var o=x.expr.attrHandle[n],a=i?t:(x.expr.attrHandle[n]=t)!=r(e,n,i)?n.toLowerCase():null;return x.expr.attrHandle[n]=o,a}:function(e,n,r){return r?t:e[x.camelCase("default-"+n)]?n.toLowerCase():null}}),K&&Q||(x.attrHooks.value={set:function(e,n,r){return x.nodeName(e,"input")?(e.defaultValue=n,t):z&&z.set(e,n,r)}}),Q||(z={set:function(e,n,r){var i=e.getAttributeNode(r);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(r)),i.value=n+="","value"===r||n===e.getAttribute(r)?n:t}},x.expr.attrHandle.id=x.expr.attrHandle.name=x.expr.attrHandle.coords=function(e,n,r){var i;return r?t:(i=e.getAttributeNode(n))&&""!==i.value?i.value:null},x.valHooks.button={get:function(e,n){var r=e.getAttributeNode(n);return r&&r.specified?r.value:t},set:z.set},x.attrHooks.contenteditable={set:function(e,t,n){z.set(e,""!==t&&t,n)}},x.each(["width","height"],function(e,n){x.attrHooks[n]={set:function(e,r){return""===r?(e.setAttribute(n,"auto"),r):t}}})),x.support.hrefNormalized||x.each(["href","src"],function(e,t){x.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),x.support.style||(x.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),x.support.optSelected||(x.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){x.propFix[this.toLowerCase()]=this}),x.support.enctype||(x.propFix.enctype="encoding"),x.each(["radio","checkbox"],function(){x.valHooks[this]={set:function(e,n){return x.isArray(n)?e.checked=x.inArray(x(e).val(),n)>=0:t}},x.support.checkOn||(x.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Z=/^(?:input|select|textarea)$/i,et=/^key/,tt=/^(?:mouse|contextmenu)|click/,nt=/^(?:focusinfocus|focusoutblur)$/,rt=/^([^.]*)(?:\.(.+)|)$/;x.event={global:{},add:function(e,n,r,o,a){var s,l,u,c,p,f,d,h,g,m,y,v=x._data(e);if(v){for(r.handler&&(c=r,r=c.handler,a=c.selector),r.guid||(r.guid=x.guid++),(l=v.events)||(l=v.events={}),(f=v.handle)||(f=v.handle=function(e){return typeof x===i||e&&x.event.triggered===e.type?t:x.event.dispatch.apply(f.elem,arguments)},f.elem=e),n=(n||"").match(T)||[""],u=n.length;u--;)s=rt.exec(n[u])||[],g=y=s[1],m=(s[2]||"").split(".").sort(),g&&(p=x.event.special[g]||{},g=(a?p.delegateType:p.bindType)||g,p=x.event.special[g]||{},d=x.extend({type:g,origType:y,data:o,handler:r,guid:r.guid,selector:a,needsContext:a&&x.expr.match.needsContext.test(a),namespace:m.join(".")},c),(h=l[g])||(h=l[g]=[],h.delegateCount=0,p.setup&&p.setup.call(e,o,m,f)!==!1||(e.addEventListener?e.addEventListener(g,f,!1):e.attachEvent&&e.attachEvent("on"+g,f))),p.add&&(p.add.call(e,d),d.handler.guid||(d.handler.guid=r.guid)),a?h.splice(h.delegateCount++,0,d):h.push(d),x.event.global[g]=!0);e=null}},remove:function(e,t,n,r,i){var o,a,s,l,u,c,p,f,d,h,g,m=x.hasData(e)&&x._data(e);if(m&&(c=m.events)){for(t=(t||"").match(T)||[""],u=t.length;u--;)if(s=rt.exec(t[u])||[],d=g=s[1],h=(s[2]||"").split(".").sort(),d){for(p=x.event.special[d]||{},d=(r?p.delegateType:p.bindType)||d,f=c[d]||[],s=s[2]&&RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=f.length;o--;)a=f[o],!i&&g!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||r&&r!==a.selector&&("**"!==r||!a.selector)||(f.splice(o,1),a.selector&&f.delegateCount--,p.remove&&p.remove.call(e,a));l&&!f.length&&(p.teardown&&p.teardown.call(e,h,m.handle)!==!1||x.removeEvent(e,d,m.handle),delete c[d])}else for(d in c)x.event.remove(e,d+t[u],n,r,!0);x.isEmptyObject(c)&&(delete m.handle,x._removeData(e,"events"))}},trigger:function(n,r,i,o){var s,l,u,c,p,f,d,h=[i||a],g=v.call(n,"type")?n.type:n,m=v.call(n,"namespace")?n.namespace.split("."):[];if(u=f=i=i||a,3!==i.nodeType&&8!==i.nodeType&&!nt.test(g+x.event.triggered)&&(g.indexOf(".")>=0&&(m=g.split("."),g=m.shift(),m.sort()),l=0>g.indexOf(":")&&"on"+g,n=n[x.expando]?n:new x.Event(g,"object"==typeof n&&n),n.isTrigger=o?2:3,n.namespace=m.join("."),n.namespace_re=n.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=i),r=null==r?[n]:x.makeArray(r,[n]),p=x.event.special[g]||{},o||!p.trigger||p.trigger.apply(i,r)!==!1)){if(!o&&!p.noBubble&&!x.isWindow(i)){for(c=p.delegateType||g,nt.test(c+g)||(u=u.parentNode);u;u=u.parentNode)h.push(u),f=u;f===(i.ownerDocument||a)&&h.push(f.defaultView||f.parentWindow||e)}for(d=0;(u=h[d++])&&!n.isPropagationStopped();)n.type=d>1?c:p.bindType||g,s=(x._data(u,"events")||{})[n.type]&&x._data(u,"handle"),s&&s.apply(u,r),s=l&&u[l],s&&x.acceptData(u)&&s.apply&&s.apply(u,r)===!1&&n.preventDefault();if(n.type=g,!o&&!n.isDefaultPrevented()&&(!p._default||p._default.apply(h.pop(),r)===!1)&&x.acceptData(i)&&l&&i[g]&&!x.isWindow(i)){f=i[l],f&&(i[l]=null),x.event.triggered=g;try{i[g]()}catch(y){}x.event.triggered=t,f&&(i[l]=f)}return n.result}},dispatch:function(e){e=x.event.fix(e);var n,r,i,o,a,s=[],l=g.call(arguments),u=(x._data(this,"events")||{})[e.type]||[],c=x.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){for(s=x.event.handlers.call(this,e,u),n=0;(o=s[n++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,a=0;(i=o.handlers[a++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,r=((x.event.special[i.origType]||{}).handle||i.handler).apply(o.elem,l),r!==t&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,n){var r,i,o,a,s=[],l=n.delegateCount,u=e.target;if(l&&u.nodeType&&(!e.button||"click"!==e.type))for(;u!=this;u=u.parentNode||this)if(1===u.nodeType&&(u.disabled!==!0||"click"!==e.type)){for(o=[],a=0;l>a;a++)i=n[a],r=i.selector+" ",o[r]===t&&(o[r]=i.needsContext?x(r,this).index(u)>=0:x.find(r,this,null,[u]).length),o[r]&&o.push(i);o.length&&s.push({elem:u,handlers:o})}return n.length>l&&s.push({elem:this,handlers:n.slice(l)}),s},fix:function(e){if(e[x.expando])return e;var t,n,r,i=e.type,o=e,s=this.fixHooks[i];for(s||(this.fixHooks[i]=s=tt.test(i)?this.mouseHooks:et.test(i)?this.keyHooks:{}),r=s.props?this.props.concat(s.props):this.props,e=new x.Event(o),t=r.length;t--;)n=r[t],e[n]=o[n];return e.target||(e.target=o.srcElement||a),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,o):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,o,s=n.button,l=n.fromElement;return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||a,o=i.documentElement,r=i.body,e.pageX=n.clientX+(o&&o.scrollLeft||r&&r.scrollLeft||0)-(o&&o.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(o&&o.scrollTop||r&&r.scrollTop||0)-(o&&o.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&l&&(e.relatedTarget=l===e.target?n.toElement:l),e.which||s===t||(e.which=1&s?1:2&s?3:4&s?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==at()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===at()&&this.blur?(this.blur(),!1):t},delegateType:"focusout"},click:{trigger:function(){return x.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):t},_default:function(e){return x.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=x.extend(new x.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?x.event.trigger(i,null,t):x.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},x.removeEvent=a.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]===i&&(e[r]=null),e.detachEvent(r,n))},x.Event=function(e,n){return this instanceof x.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?it:ot):this.type=e,n&&x.extend(this,n),this.timeStamp=e&&e.timeStamp||x.now(),this[x.expando]=!0,t):new x.Event(e,n)},x.Event.prototype={isDefaultPrevented:ot,isPropagationStopped:ot,isImmediatePropagationStopped:ot,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=it,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=it,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=it,this.stopPropagation()}},x.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){x.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return(!i||i!==r&&!x.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),x.support.submitBubbles||(x.event.special.submit={setup:function(){return!x.nodeName(this,"form")&&(x.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=x.nodeName(n,"input")||x.nodeName(n,"button")?n.form:t;r&&!x._data(r,"submitBubbles")&&(x.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),x._data(r,"submitBubbles",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&x.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return!x.nodeName(this,"form")&&(x.event.remove(this,"._submit"),t)}}),x.support.changeBubbles||(x.event.special.change={setup:function(){return Z.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(x.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),x.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),x.event.simulate("change",this,e,!0)})),!1):(x.event.add(this,"beforeactivate._change",function(e){var t=e.target;Z.test(t.nodeName)&&!x._data(t,"changeBubbles")&&(x.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||x.event.simulate("change",this.parentNode,e,!0)}),x._data(t,"changeBubbles",!0))}),t)},handle:function(e){var n=e.target;return this!==n||e.isSimulated||e.isTrigger||"radio"!==n.type&&"checkbox"!==n.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return x.event.remove(this,"._change"),!Z.test(this.nodeName)}}),x.support.focusinBubbles||x.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){x.event.simulate(t,e.target,x.event.fix(e),!0)};x.event.special[t]={setup:function(){0===n++&&a.addEventListener(e,r,!0)},teardown:function(){0===--n&&a.removeEventListener(e,r,!0)}}}),x.fn.extend({on:function(e,n,r,i,o){var a,s;if("object"==typeof e){"string"!=typeof n&&(r=r||n,n=t);for(a in e)this.on(a,n,r,e[a],o);return this}if(null==r&&null==i?(i=n,r=n=t):null==i&&("string"==typeof n?(i=r,r=t):(i=r,r=n,n=t)),i===!1)i=ot;else if(!i)return this;return 1===o&&(s=i,i=function(e){return x().off(e),s.apply(this,arguments)},i.guid=s.guid||(s.guid=x.guid++)),this.each(function(){x.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,o;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,x(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(o in e)this.off(o,n,e[o]);return this}return(n===!1||"function"==typeof n)&&(r=n,n=t),r===!1&&(r=ot),this.each(function(){x.event.remove(this,e,r,n)})},trigger:function(e,t){return this.each(function(){x.event.trigger(e,t,this)})},triggerHandler:function(e,n){var r=this[0];return r?x.event.trigger(e,n,r,!0):t}});var st=/^.[^:#\[\.,]*$/,lt=/^(?:parents|prev(?:Until|All))/,ut=x.expr.match.needsContext,ct={children:!0,contents:!0,next:!0,prev:!0};x.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(x(e).filter(function(){for(t=0;i>t;t++)if(x.contains(r[t],this))return!0}));for(t=0;i>t;t++)x.find(e,r[t],n);return n=this.pushStack(i>1?x.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t,n=x(e,this),r=n.length;return this.filter(function(){for(t=0;r>t;t++)if(x.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ft(this,e||[],!0))},filter:function(e){return this.pushStack(ft(this,e||[],!1))},is:function(e){return!!ft(this,"string"==typeof e&&ut.test(e)?x(e):e||[],!1).length},closest:function(e,t){for(var n,r=0,i=this.length,o=[],a=ut.test(e)||"string"!=typeof e?x(e,t||this.context):0;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(11>n.nodeType&&(a?a.index(n)>-1:1===n.nodeType&&x.find.matchesSelector(n,e))){n=o.push(n);break}return this.pushStack(o.length>1?x.unique(o):o)},index:function(e){return e?"string"==typeof e?x.inArray(this[0],x(e)):x.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?x(e,t):x.makeArray(e&&e.nodeType?[e]:e),r=x.merge(this.get(),n);return this.pushStack(x.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),x.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return x.dir(e,"parentNode")},parentsUntil:function(e,t,n){return x.dir(e,"parentNode",n)},next:function(e){return pt(e,"nextSibling")},prev:function(e){return pt(e,"previousSibling")},nextAll:function(e){return x.dir(e,"nextSibling")},prevAll:function(e){return x.dir(e,"previousSibling")},nextUntil:function(e,t,n){return x.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return x.dir(e,"previousSibling",n)},siblings:function(e){return x.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return x.sibling(e.firstChild)},contents:function(e){return x.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:x.merge([],e.childNodes)}},function(e,t){x.fn[e]=function(n,r){var i=x.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=x.filter(r,i)),this.length>1&&(ct[e]||(i=x.unique(i)),lt.test(e)&&(i=i.reverse())),this.pushStack(i)}}),x.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?x.find.matchesSelector(r,e)?[r]:[]:x.find.matches(e,x.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,n,r){for(var i=[],o=e[n];o&&9!==o.nodeType&&(r===t||1!==o.nodeType||!x(o).is(r));)1===o.nodeType&&i.push(o),o=o[n];return i},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var ht="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",gt=/ jQuery\d+="(?:null|\d+)"/g,mt=RegExp("<(?:"+ht+")[\\s/>]","i"),yt=/^\s+/,vt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bt=/<([\w:]+)/,xt=/<tbody/i,wt=/<|&#?\w+;/,Tt=/<(?:script|style|link)/i,Ct=/^(?:checkbox|radio)$/i,Nt=/checked\s*(?:[^=]|=\s*.checked.)/i,kt=/^$|\/(?:java|ecma)script/i,Et=/^true\/(.*)/,St=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,At={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:x.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},jt=dt(a),Dt=jt.appendChild(a.createElement("div"));At.optgroup=At.option,At.tbody=At.tfoot=At.colgroup=At.caption=At.thead,At.th=At.td,x.fn.extend({text:function(e){return x.access(this,function(e){return e===t?x.text(this):this.empty().append((this[0]&&this[0].ownerDocument||a).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Lt(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Lt(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,r=e?x.filter(e,this):this,i=0;null!=(n=r[i]);i++)t||1!==n.nodeType||x.cleanData(Ft(n)),n.parentNode&&(t&&x.contains(n.ownerDocument,n)&&_t(Ft(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&x.cleanData(Ft(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&x.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return x.clone(this,e,t)})},html:function(e){return x.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(gt,""):t;if(!("string"!=typeof e||Tt.test(e)||!x.support.htmlSerialize&&mt.test(e)||!x.support.leadingWhitespace&&yt.test(e)||At[(bt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(vt,"<$1></$2>");try{for(;i>r;r++)n=this[r]||{},1===n.nodeType&&(x.cleanData(Ft(n,!1)),n.innerHTML=e);n=0}catch(o){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=x.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),x(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=d.apply([],e);var r,i,o,a,s,l,u=0,c=this.length,p=this,f=c-1,h=e[0],g=x.isFunction(h);if(g||!(1>=c||"string"!=typeof h||x.support.checkClone)&&Nt.test(h))return this.each(function(r){var i=p.eq(r);g&&(e[0]=h.call(this,r,i.html())),i.domManip(e,t,n)});if(c&&(l=x.buildFragment(e,this[0].ownerDocument,!1,!n&&this),r=l.firstChild,1===l.childNodes.length&&(l=r),r)){for(a=x.map(Ft(l,"script"),Ht),o=a.length;c>u;u++)i=l,u!==f&&(i=x.clone(i,!0,!0),o&&x.merge(a,Ft(i,"script"))),t.call(this[u],i,u);if(o)for(s=a[a.length-1].ownerDocument,x.map(a,qt),u=0;o>u;u++)i=a[u],kt.test(i.type||"")&&!x._data(i,"globalEval")&&x.contains(s,i)&&(i.src?x._evalUrl(i.src):x.globalEval((i.text||i.textContent||i.innerHTML||"").replace(St,"")));l=r=null}return this}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){x.fn[e]=function(e){for(var n,r=0,i=[],o=x(e),a=o.length-1;a>=r;r++)n=r===a?this:this.clone(!0),x(o[r])[t](n),h.apply(i,n.get());return this.pushStack(i)}}),x.extend({clone:function(e,t,n){var r,i,o,a,s,l=x.contains(e.ownerDocument,e);if(x.support.html5Clone||x.isXMLDoc(e)||!mt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(Dt.innerHTML=e.outerHTML,Dt.removeChild(o=Dt.firstChild)),!(x.support.noCloneEvent&&x.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e)))for(r=Ft(o),s=Ft(e),a=0;null!=(i=s[a]);++a)r[a]&&Ot(i,r[a]);if(t)if(n)for(s=s||Ft(e),r=r||Ft(o),a=0;null!=(i=s[a]);a++)Mt(i,r[a]);else Mt(e,o);return r=Ft(o,"script"),r.length>0&&_t(r,!l&&Ft(e,"script")),r=s=i=null,o},buildFragment:function(e,t,n,r){for(var i,o,a,s,l,u,c,p=e.length,f=dt(t),d=[],h=0;p>h;h++)if(o=e[h],o||0===o)if("object"===x.type(o))x.merge(d,o.nodeType?[o]:o);else if(wt.test(o)){for(s=s||f.appendChild(t.createElement("div")),l=(bt.exec(o)||["",""])[1].toLowerCase(),c=At[l]||At._default,s.innerHTML=c[1]+o.replace(vt,"<$1></$2>")+c[2],i=c[0];i--;)s=s.lastChild;if(!x.support.leadingWhitespace&&yt.test(o)&&d.push(t.createTextNode(yt.exec(o)[0])),!x.support.tbody)for(o="table"!==l||xt.test(o)?"<table>"!==c[1]||xt.test(o)?0:s:s.firstChild,i=o&&o.childNodes.length;i--;)x.nodeName(u=o.childNodes[i],"tbody")&&!u.childNodes.length&&o.removeChild(u);for(x.merge(d,s.childNodes),s.textContent="";s.firstChild;)s.removeChild(s.firstChild);s=f.lastChild}else d.push(t.createTextNode(o));for(s&&f.removeChild(s),x.support.appendChecked||x.grep(Ft(d,"input"),Bt),h=0;o=d[h++];)if((!r||-1===x.inArray(o,r))&&(a=x.contains(o.ownerDocument,o),s=Ft(f.appendChild(o),"script"),a&&_t(s),n))for(i=0;o=s[i++];)kt.test(o.type||"")&&n.push(o);return s=null,f},cleanData:function(e,t){for(var n,r,o,a,s=0,l=x.expando,u=x.cache,c=x.support.deleteExpando,f=x.event.special;null!=(n=e[s]);s++)if((t||x.acceptData(n))&&(o=n[l],a=o&&u[o])){if(a.events)for(r in a.events)f[r]?x.event.remove(n,r):x.removeEvent(n,r,a.handle);u[o]&&(delete u[o],c?delete n[l]:typeof n.removeAttribute!==i?n.removeAttribute(l):n[l]=null,p.push(o))}},_evalUrl:function(e){return x.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})}}),x.fn.extend({wrapAll:function(e){if(x.isFunction(e))return this.each(function(t){x(this).wrapAll(e.call(this,t))});if(this[0]){var t=x(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return x.isFunction(e)?this.each(function(t){x(this).wrapInner(e.call(this,t))}):this.each(function(){var t=x(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=x.isFunction(e);return this.each(function(n){x(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){x.nodeName(this,"body")||x(this).replaceWith(this.childNodes)}).end()}});var Pt,Rt,Wt,$t=/alpha\([^)]*\)/i,It=/opacity\s*=\s*([^)]*)/,zt=/^(top|right|bottom|left)$/,Xt=/^(none|table(?!-c[ea]).+)/,Ut=/^margin/,Vt=RegExp("^("+w+")(.*)$","i"),Yt=RegExp("^("+w+")(?!px)[a-z%]+$","i"),Jt=RegExp("^([+-])=("+w+")","i"),Gt={BODY:"block"},Qt={position:"absolute",visibility:"hidden",display:"block"},Kt={letterSpacing:0,fontWeight:400},Zt=["Top","Right","Bottom","Left"],en=["Webkit","O","Moz","ms"];x.fn.extend({css:function(e,n){return x.access(this,function(e,n,r){var i,o,a={},s=0;if(x.isArray(n)){for(o=Rt(e),i=n.length;i>s;s++)a[n[s]]=x.css(e,n[s],!1,o);return a}return r!==t?x.style(e,n,r):x.css(e,n)},e,n,arguments.length>1)},show:function(){return rn(this,!0)},hide:function(){return rn(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){nn(this)?x(this).show():x(this).hide()})}}),x.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Wt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:x.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,l=x.camelCase(n),u=e.style;if(n=x.cssProps[l]||(x.cssProps[l]=tn(u,l)),s=x.cssHooks[n]||x.cssHooks[l],r===t)return s&&"get"in s&&(o=s.get(e,!1,i))!==t?o:u[n];if(a=typeof r,"string"===a&&(o=Jt.exec(r))&&(r=(o[1]+1)*o[2]+parseFloat(x.css(e,n)),a="number"),!(null==r||"number"===a&&isNaN(r)||("number"!==a||x.cssNumber[l]||(r+="px"),x.support.clearCloneStyle||""!==r||0!==n.indexOf("background")||(u[n]="inherit"),s&&"set"in s&&(r=s.set(e,r,i))===t)))try{u[n]=r}catch(c){}}},css:function(e,n,r,i){var o,a,s,l=x.camelCase(n);return n=x.cssProps[l]||(x.cssProps[l]=tn(e.style,l)),s=x.cssHooks[n]||x.cssHooks[l],s&&"get"in s&&(a=s.get(e,!0,r)),a===t&&(a=Wt(e,n,i)),"normal"===a&&n in Kt&&(a=Kt[n]),""===r||r?(o=parseFloat(a),r===!0||x.isNumeric(o)?o||0:a):a}}),e.getComputedStyle?(Rt=function(t){return e.getComputedStyle(t,null)},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),l=s?s.getPropertyValue(n)||s[n]:t,u=e.style;return s&&(""!==l||x.contains(e.ownerDocument,e)||(l=x.style(e,n)),Yt.test(l)&&Ut.test(n)&&(i=u.width,o=u.minWidth,a=u.maxWidth,u.minWidth=u.maxWidth=u.width=l,l=s.width,u.width=i,u.minWidth=o,u.maxWidth=a)),l}):a.documentElement.currentStyle&&(Rt=function(e){return e.currentStyle},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),l=s?s[n]:t,u=e.style;return null==l&&u&&u[n]&&(l=u[n]),Yt.test(l)&&!zt.test(n)&&(i=u.left,o=e.runtimeStyle,a=o&&o.left,a&&(o.left=e.currentStyle.left),u.left="fontSize"===n?"1em":l,l=u.pixelLeft+"px",u.left=i,a&&(o.left=a)),""===l?"auto":l}),x.each(["height","width"],function(e,n){x.cssHooks[n]={get:function(e,r,i){return r?0===e.offsetWidth&&Xt.test(x.css(e,"display"))?x.swap(e,Qt,function(){return sn(e,n,i)}):sn(e,n,i):t},set:function(e,t,r){var i=r&&Rt(e);return on(e,t,r?an(e,n,r,x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,i),i):0)}}}),x.support.opacity||(x.cssHooks.opacity={get:function(e,t){return It.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=x.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=r&&r.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===x.trim(o.replace($t,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||r&&!r.filter)||(n.filter=$t.test(o)?o.replace($t,i):o+" "+i)}}),x(function(){x.support.reliableMarginRight||(x.cssHooks.marginRight={get:function(e,n){return n?x.swap(e,{display:"inline-block"},Wt,[e,"marginRight"]):t}}),!x.support.pixelPosition&&x.fn.position&&x.each(["top","left"],function(e,n){x.cssHooks[n]={get:function(e,r){return r?(r=Wt(e,n),Yt.test(r)?x(e).position()[n]+"px":r):t}}})}),x.expr&&x.expr.filters&&(x.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!x.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||x.css(e,"display"))},x.expr.filters.visible=function(e){return!x.expr.filters.hidden(e)}),x.each({margin:"",padding:"",border:"Width"},function(e,t){x.cssHooks[e+t]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];4>r;r++)i[e+Zt[r]+t]=o[r]||o[r-2]||o[0];return i}},Ut.test(e)||(x.cssHooks[e+t].set=on)});var cn=/%20/g,pn=/\[\]$/,fn=/\r?\n/g,dn=/^(?:submit|button|image|reset|file)$/i,hn=/^(?:input|select|textarea|keygen)/i;x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=x.prop(this,"elements");return e?x.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!x(this).is(":disabled")&&hn.test(this.nodeName)&&!dn.test(e)&&(this.checked||!Ct.test(e))}).map(function(e,t){var n=x(this).val();return null==n?null:x.isArray(n)?x.map(n,function(e){return{name:t.name,value:e.replace(fn,"\r\n")}}):{name:t.name,value:n.replace(fn,"\r\n")}}).get()}}),x.param=function(e,n){var r,i=[],o=function(e,t){t=x.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=x.ajaxSettings&&x.ajaxSettings.traditional),x.isArray(e)||e.jquery&&!x.isPlainObject(e))x.each(e,function(){o(this.name,this.value)});else for(r in e)gn(r,e[r],n,o);return i.join("&").replace(cn,"+")},x.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){x.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),x.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var mn,yn,vn=x.now(),bn=/\?/,xn=/#.*$/,wn=/([?&])_=[^&]*/,Tn=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Cn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Nn=/^(?:GET|HEAD)$/,kn=/^\/\//,En=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Sn=x.fn.load,An={},jn={},Dn="*/".concat("*");try{yn=o.href}catch(Ln){yn=a.createElement("a"),yn.href="",yn=yn.href}mn=En.exec(yn.toLowerCase())||[],x.fn.load=function(e,n,r){if("string"!=typeof e&&Sn)return Sn.apply(this,arguments);var i,o,a,s=this,l=e.indexOf(" ");return l>=0&&(i=e.slice(l,e.length),e=e.slice(0,l)),x.isFunction(n)?(r=n,n=t):n&&"object"==typeof n&&(a="POST"),s.length>0&&x.ajax({url:e,type:a,dataType:"html",data:n}).done(function(e){o=arguments,s.html(i?x("<div>").append(x.parseHTML(e)).find(i):e)}).complete(r&&function(e,t){s.each(r,o||[e.responseText,t,e])}),this},x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){x.fn[t]=function(e){return this.on(t,e)}}),x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:yn,type:"GET",isLocal:Cn.test(mn[1]),
global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Dn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":x.parseJSON,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?_n(_n(e,x.ajaxSettings),t):_n(x.ajaxSettings,e)},ajaxPrefilter:Hn(An),ajaxTransport:Hn(jn),ajax:function(e,n){function k(e,n,r,i){var c,y,v,w,T,N=n;2!==b&&(b=2,s&&clearTimeout(s),u=t,a=i||"",C.readyState=e>0?4:0,c=e>=200&&300>e||304===e,r&&(w=Mn(p,C,r)),w=On(p,w,C,c),c?(p.ifModified&&(T=C.getResponseHeader("Last-Modified"),T&&(x.lastModified[o]=T),T=C.getResponseHeader("etag"),T&&(x.etag[o]=T)),204===e||"HEAD"===p.type?N="nocontent":304===e?N="notmodified":(N=w.state,y=w.data,v=w.error,c=!v)):(v=N,(e||!N)&&(N="error",0>e&&(e=0))),C.status=e,C.statusText=(n||N)+"",c?h.resolveWith(f,[y,N,C]):h.rejectWith(f,[C,N,v]),C.statusCode(m),m=t,l&&d.trigger(c?"ajaxSuccess":"ajaxError",[C,p,c?y:v]),g.fireWith(f,[C,N]),l&&(d.trigger("ajaxComplete",[C,p]),--x.active||x.event.trigger("ajaxStop")))}"object"==typeof e&&(n=e,e=t),n=n||{};var r,i,o,a,s,l,u,c,p=x.ajaxSetup({},n),f=p.context||p,d=p.context&&(f.nodeType||f.jquery)?x(f):x.event,h=x.Deferred(),g=x.Callbacks("once memory"),m=p.statusCode||{},y={},v={},b=0,w="canceled",C={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!c)for(c={};t=Tn.exec(a);)c[t[1].toLowerCase()]=t[2];t=c[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?a:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return b||(e=v[n]=v[n]||e,y[e]=t),this},overrideMimeType:function(e){return b||(p.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>b)for(t in e)m[t]=[m[t],e[t]];else C.always(e[C.status]);return this},abort:function(e){var t=e||w;return u&&u.abort(t),k(0,t),this}};if(h.promise(C).complete=g.add,C.success=C.done,C.error=C.fail,p.url=((e||p.url||yn)+"").replace(xn,"").replace(kn,mn[1]+"//"),p.type=n.method||n.type||p.method||p.type,p.dataTypes=x.trim(p.dataType||"*").toLowerCase().match(T)||[""],null==p.crossDomain&&(r=En.exec(p.url.toLowerCase()),p.crossDomain=!(!r||r[1]===mn[1]&&r[2]===mn[2]&&(r[3]||("http:"===r[1]?"80":"443"))===(mn[3]||("http:"===mn[1]?"80":"443")))),p.data&&p.processData&&"string"!=typeof p.data&&(p.data=x.param(p.data,p.traditional)),qn(An,p,n,C),2===b)return C;l=p.global,l&&0===x.active++&&x.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Nn.test(p.type),o=p.url,p.hasContent||(p.data&&(o=p.url+=(bn.test(o)?"&":"?")+p.data,delete p.data),p.cache===!1&&(p.url=wn.test(o)?o.replace(wn,"$1_="+vn++):o+(bn.test(o)?"&":"?")+"_="+vn++)),p.ifModified&&(x.lastModified[o]&&C.setRequestHeader("If-Modified-Since",x.lastModified[o]),x.etag[o]&&C.setRequestHeader("If-None-Match",x.etag[o])),(p.data&&p.hasContent&&p.contentType!==!1||n.contentType)&&C.setRequestHeader("Content-Type",p.contentType),C.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Dn+"; q=0.01":""):p.accepts["*"]);for(i in p.headers)C.setRequestHeader(i,p.headers[i]);if(p.beforeSend&&(p.beforeSend.call(f,C,p)===!1||2===b))return C.abort();w="abort";for(i in{success:1,error:1,complete:1})C[i](p[i]);if(u=qn(jn,p,n,C)){C.readyState=1,l&&d.trigger("ajaxSend",[C,p]),p.async&&p.timeout>0&&(s=setTimeout(function(){C.abort("timeout")},p.timeout));try{b=1,u.send(y,k)}catch(N){if(!(2>b))throw N;k(-1,N)}}else k(-1,"No Transport");return C},getJSON:function(e,t,n){return x.get(e,t,n,"json")},getScript:function(e,n){return x.get(e,t,n,"script")}}),x.each(["get","post"],function(e,n){x[n]=function(e,r,i,o){return x.isFunction(r)&&(o=o||i,i=r,r=t),x.ajax({url:e,type:n,dataType:o,data:r,success:i})}}),x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return x.globalEval(e),e}}}),x.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),x.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=a.head||x("head")[0]||a.documentElement;return{send:function(t,i){n=a.createElement("script"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,"success"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var Fn=[],Bn=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Fn.pop()||x.expando+"_"+vn++;return this[e]=!0,e}}),x.ajaxPrefilter("json jsonp",function(n,r,i){var o,a,s,l=n.jsonp!==!1&&(Bn.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Bn.test(n.data)&&"data");return l||"jsonp"===n.dataTypes[0]?(o=n.jsonpCallback=x.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,l?n[l]=n[l].replace(Bn,"$1"+o):n.jsonp!==!1&&(n.url+=(bn.test(n.url)?"&":"?")+n.jsonp+"="+o),n.converters["script json"]=function(){return s||x.error(o+" was not called"),s[0]},n.dataTypes[0]="json",a=e[o],e[o]=function(){s=arguments},i.always(function(){e[o]=a,n[o]&&(n.jsonpCallback=r.jsonpCallback,Fn.push(o)),s&&x.isFunction(a)&&a(s[0]),s=a=t}),"script"):t});var Pn,Rn,Wn=0,$n=e.ActiveXObject&&function(){var e;for(e in Pn)Pn[e](t,!0)};x.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&In()||zn()}:In,Rn=x.ajaxSettings.xhr(),x.support.cors=!!Rn&&"withCredentials"in Rn,Rn=x.support.ajax=!!Rn,Rn&&x.ajaxTransport(function(n){if(!n.crossDomain||x.support.cors){var r;return{send:function(i,o){var a,s,l=n.xhr();if(n.username?l.open(n.type,n.url,n.async,n.username,n.password):l.open(n.type,n.url,n.async),n.xhrFields)for(s in n.xhrFields)l[s]=n.xhrFields[s];n.mimeType&&l.overrideMimeType&&l.overrideMimeType(n.mimeType),n.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");try{for(s in i)l.setRequestHeader(s,i[s])}catch(u){}l.send(n.hasContent&&n.data||null),r=function(e,i){var s,u,c,p;try{if(r&&(i||4===l.readyState))if(r=t,a&&(l.onreadystatechange=x.noop,$n&&delete Pn[a]),i)4!==l.readyState&&l.abort();else{p={},s=l.status,u=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(p.text=l.responseText);try{c=l.statusText}catch(f){c=""}s||!n.isLocal||n.crossDomain?1223===s&&(s=204):s=p.text?200:404}}catch(d){i||o(-1,d)}p&&o(s,c,p,u)},n.async?4===l.readyState?setTimeout(r):(a=++Wn,$n&&(Pn||(Pn={},x(e).unload($n)),Pn[a]=r),l.onreadystatechange=r):r()},abort:function(){r&&r(t,!0)}}}});var Xn,Un,Vn=/^(?:toggle|show|hide)$/,Yn=RegExp("^(?:([+-])=|)("+w+")([a-z%]*)$","i"),Jn=/queueHooks$/,Gn=[nr],Qn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Yn.exec(t),o=i&&i[3]||(x.cssNumber[e]?"":"px"),a=(x.cssNumber[e]||"px"!==o&&+r)&&Yn.exec(x.css(n.elem,e)),s=1,l=20;if(a&&a[3]!==o){o=o||a[3],i=i||[],a=+r||1;do s=s||".5",a/=s,x.style(n.elem,e,a+o);while(s!==(s=n.cur()/r)&&1!==s&&--l)}return i&&(a=n.start=+a||+r||0,n.unit=o,n.end=i[1]?a+(i[1]+1)*i[2]:+i[2]),n}]};x.Animation=x.extend(er,{tweener:function(e,t){x.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,r=0,i=e.length;i>r;r++)n=e[r],Qn[n]=Qn[n]||[],Qn[n].unshift(t)},prefilter:function(e,t){t?Gn.unshift(e):Gn.push(e)}}),x.Tween=rr,rr.prototype={constructor:rr,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(x.cssNumber[n]?"":"px")},cur:function(){var e=rr.propHooks[this.prop];return e&&e.get?e.get(this):rr.propHooks._default.get(this)},run:function(e){var t,n=rr.propHooks[this.prop];return this.pos=t=this.options.duration?x.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):rr.propHooks._default.set(this),this}},rr.prototype.init.prototype=rr.prototype,rr.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=x.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){x.fx.step[e.prop]?x.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[x.cssProps[e.prop]]||x.cssHooks[e.prop])?x.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},rr.propHooks.scrollTop=rr.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},x.each(["toggle","show","hide"],function(e,t){var n=x.fn[t];x.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ir(t,!0),e,r,i)}}),x.fn.extend({fadeTo:function(e,t,n,r){return this.filter(nn).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=x.isEmptyObject(e),o=x.speed(t,n,r),a=function(){var t=er(this,x.extend({},e),o);(i||x._data(this,"finish"))&&t.stop(!0)};return a.finish=a,i||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",o=x.timers,a=x._data(this);if(n)a[n]&&a[n].stop&&i(a[n]);else for(n in a)a[n]&&a[n].stop&&Jn.test(n)&&i(a[n]);for(n=o.length;n--;)o[n].elem!==this||null!=e&&o[n].queue!==e||(o[n].anim.stop(r),t=!1,o.splice(n,1));(t||!r)&&x.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=x._data(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=x.timers,a=r?r.length:0;for(n.finish=!0,x.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;a>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),x.each({slideDown:ir("show"),slideUp:ir("hide"),slideToggle:ir("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){x.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),x.speed=function(e,t,n){var r=e&&"object"==typeof e?x.extend({},e):{complete:n||!n&&t||x.isFunction(e)&&e,duration:e,easing:n&&t||t&&!x.isFunction(t)&&t};return r.duration=x.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in x.fx.speeds?x.fx.speeds[r.duration]:x.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){x.isFunction(r.old)&&r.old.call(this),r.queue&&x.dequeue(this,r.queue)},r},x.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},x.timers=[],x.fx=rr.prototype.init,x.fx.tick=function(){var e,n=x.timers,r=0;for(Xn=x.now();n.length>r;r++)e=n[r],e()||n[r]!==e||n.splice(r--,1);n.length||x.fx.stop(),Xn=t},x.fx.timer=function(e){e()&&x.timers.push(e)&&x.fx.start()},x.fx.interval=13,x.fx.start=function(){Un||(Un=setInterval(x.fx.tick,x.fx.interval))},x.fx.stop=function(){clearInterval(Un),Un=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fx.step={},x.expr&&x.expr.filters&&(x.expr.filters.animated=function(e){return x.grep(x.timers,function(t){return e===t.elem}).length}),x.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){x.offset.setOffset(this,e,t)});var n,r,o={top:0,left:0},a=this[0],s=a&&a.ownerDocument;return s?(n=s.documentElement,x.contains(n,a)?(typeof a.getBoundingClientRect!==i&&(o=a.getBoundingClientRect()),r=or(s),{top:o.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:o.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):o):void 0},x.offset={setOffset:function(e,t,n){var r=x.css(e,"position");"static"===r&&(e.style.position="relative");var p,f,i=x(e),o=i.offset(),a=x.css(e,"top"),s=x.css(e,"left"),l=("absolute"===r||"fixed"===r)&&x.inArray("auto",[a,s])>-1,u={},c={};l?(c=i.position(),p=c.top,f=c.left):(p=parseFloat(a)||0,f=parseFloat(s)||0),x.isFunction(t)&&(t=t.call(e,n,o)),null!=t.top&&(u.top=t.top-o.top+p),null!=t.left&&(u.left=t.left-o.left+f),"using"in t?t.using.call(e,u):i.css(u)}},x.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];return"fixed"===x.css(r,"position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),x.nodeName(e[0],"html")||(n=e.offset()),n.top+=x.css(e[0],"borderTopWidth",!0),n.left+=x.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-x.css(r,"marginTop",!0),left:t.left-n.left-x.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||s;e&&!x.nodeName(e,"html")&&"static"===x.css(e,"position");)e=e.offsetParent;return e||s})}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);x.fn[e]=function(i){return x.access(this,function(e,i,o){var a=or(e);return o===t?a?n in a?a[n]:a.document.documentElement[i]:e[i]:(a?a.scrollTo(r?x(a).scrollLeft():o,r?o:x(a).scrollTop()):e[i]=o,t)},e,i,arguments.length,null)}}),x.each({Height:"height",Width:"width"},function(e,n){x.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){x.fn[i]=function(i,o){var a=arguments.length&&(r||"boolean"!=typeof i),s=r||(i===!0||o===!0?"margin":"border");return x.access(this,function(n,r,i){var o;return x.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(o=n.documentElement,Math.max(n.body["scroll"+e],o["scroll"+e],n.body["offset"+e],o["offset"+e],o["client"+e])):i===t?x.css(n,r,s):x.style(n,r,i,s)},n,a?i:t,a,null)}})}),x.fn.size=function(){return this.length},x.fn.andSelf=x.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=x:(e.jQuery=e.$=x,"function"==typeof define&&define.amd&&define("jquery",[],function(){return x}))}(window),$(document).on("mobileinit",function(){$.mobile.defaultPageTransition="none",$.mobile.linkBindingEnabled=!1,$.mobile.allowCrossDomainPages=!0,$.mobile.pushStateEnabled=!1,$.mobile.hashListeningEnabled=!1}),!function(a,b,c){"function"==typeof define&&define.amd?define(["jquery"],function(d){return c(d,a,b),d.mobile}):c(a.jQuery,a,b)}(this,document,function(a,b,c){!function(a){a.mobile={}}(a),function(a,b){function d(b,c){var d,f,g,h=b.nodeName.toLowerCase();return"area"===h?(d=b.parentNode,f=d.name,!(!b.href||!f||"map"!==d.nodeName.toLowerCase())&&(g=a("img[usemap=#"+f+"]")[0],!!g&&e(g))):(/input|select|textarea|button|object/.test(h)?!b.disabled:"a"===h?b.href||c:c)&&e(b)}function e(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}var f=0,g=/^ui-id-\d+$/;a.ui=a.ui||{},a.extend(a.ui,{version:"c0ab71056b936627e8a7821f03c044aec6280a40",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({focus:function(b){return function(c,d){return"number"==typeof c?this.each(function(){var b=this;setTimeout(function(){a(b).focus(),d&&d.call(b)},c)}):b.apply(this,arguments)}}(a.fn.focus),scrollParent:function(){var b;return b=a.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.css(this,"position"))&&/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(this[0].ownerDocument||c):b},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++f)})},removeUniqueId:function(){return this.each(function(){g.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return d(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var c=a.attr(b,"tabindex"),e=isNaN(c);return(e||c>=0)&&d(b,!e)}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),e&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var f="Width"===d?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return"number"!=typeof b?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),a.support.selectstart="onselectstart"in c.createElement("div"),a.fn.extend({disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(d){if(d!==b)return this.css("zIndex",d);if(this.length)for(var e,f,g=a(this[0]);g.length&&g[0]!==c;){if(e=g.css("position"),("absolute"===e||"relative"===e||"fixed"===e)&&(f=parseInt(g.css("zIndex"),10),!isNaN(f)&&0!==f))return f;g=g.parent()}return 0}}),a.ui.plugin={add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c,d){var e,f=a.plugins[b];if(f&&(d||a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType))for(e=0;e<f.length;e++)a.options[f[e][0]]&&f[e][1].apply(a.element,c)}}}(a),function(a,b){var d=function(b,c){var d=b.parent(),e=[],f=function(){var b=a(this),c=a.mobile.toolbar&&b.data("mobile-toolbar")?b.toolbar("option"):{position:b.attr("data-"+a.mobile.ns+"position"),updatePagePadding:b.attr("data-"+a.mobile.ns+"update-page-padding")!==!1};return!("fixed"===c.position&&c.updatePagePadding===!0)},g=d.children(":jqmData(role='header')").filter(f),h=b.children(":jqmData(role='header')"),i=d.children(":jqmData(role='footer')").filter(f),j=b.children(":jqmData(role='footer')");return 0===h.length&&g.length>0&&(e=e.concat(g.toArray())),0===j.length&&i.length>0&&(e=e.concat(i.toArray())),a.each(e,function(b,d){c-=a(d).outerHeight()}),Math.max(0,c)};a.extend(a.mobile,{window:a(b),document:a(c),keyCode:a.ui.keyCode,behaviors:{},silentScroll:function(c){"number"!==a.type(c)&&(c=a.mobile.defaultHomeScroll),a.event.special.scrollstart.enabled=!1,setTimeout(function(){b.scrollTo(0,c),a.mobile.document.trigger("silentscroll",{x:0,y:c})},20),setTimeout(function(){a.event.special.scrollstart.enabled=!0},150)},getClosestBaseUrl:function(b){var c=a(b).closest(".ui-page").jqmData("url"),d=a.mobile.path.documentBase.hrefNoHash;return a.mobile.dynamicBaseEnabled&&c&&a.mobile.path.isPath(c)||(c=d),a.mobile.path.makeUrlAbsolute(c,d)},removeActiveLinkClass:function(b){!a.mobile.activeClickedLink||a.mobile.activeClickedLink.closest("."+a.mobile.activePageClass).length&&!b||a.mobile.activeClickedLink.removeClass(a.mobile.activeBtnClass),a.mobile.activeClickedLink=null},getInheritedTheme:function(a,b){for(var c,d,e=a[0],f="",g=/ui-(bar|body|overlay)-([a-z])\b/;e&&(c=e.className||"",!(c&&(d=g.exec(c))&&(f=d[2])));)e=e.parentNode;return f||b||"a"},enhanceable:function(a){return this.haveParents(a,"enhance")},hijackable:function(a){return this.haveParents(a,"ajax")},haveParents:function(b,c){if(!a.mobile.ignoreContentEnabled)return b;var d,e,f,g,h,i=b.length,j=a();for(g=0;i>g;g++){for(e=b.eq(g),f=!1,d=b[g];d;){if(h=d.getAttribute?d.getAttribute("data-"+a.mobile.ns+c):"","false"===h){f=!0;break}d=d.parentNode}f||(j=j.add(e))}return j},getScreenHeight:function(){return b.innerHeight||a.mobile.window.height()},resetActivePageHeight:function(b){var c=a("."+a.mobile.activePageClass),e=c.height(),f=c.outerHeight(!0);b=d(c,"number"==typeof b?b:a.mobile.getScreenHeight()),c.css("min-height",""),c.height()<b&&c.css("min-height",b-(f-e))},loading:function(){var b=this.loading._widget||a(a.mobile.loader.prototype.defaultHtml).loader(),c=b.loader.apply(b,arguments);return this.loading._widget=b,c}}),a.addDependents=function(b,c){var d=a(b),e=d.jqmData("dependents")||a();d.jqmData("dependents",a(e).add(c))},a.fn.extend({removeWithDependents:function(){a.removeWithDependents(this)},enhanceWithin:function(){var b,c={},d=a.mobile.page.prototype.keepNativeSelector(),e=this;a.mobile.nojs&&a.mobile.nojs(this),a.mobile.links&&a.mobile.links(this),a.mobile.degradeInputsWithin&&a.mobile.degradeInputsWithin(this),a.fn.buttonMarkup&&this.find(a.fn.buttonMarkup.initSelector).not(d).jqmEnhanceable().buttonMarkup(),a.fn.fieldcontain&&this.find(":jqmData(role='fieldcontain')").not(d).jqmEnhanceable().fieldcontain(),a.each(a.mobile.widgets,function(b,f){if(f.initSelector){var g=a.mobile.enhanceable(e.find(f.initSelector));g.length>0&&(g=g.not(d)),g.length>0&&(c[f.prototype.widgetName]=g)}});for(b in c)c[b][b]();return this},addDependents:function(b){a.addDependents(this,b)},getEncodedText:function(){return a("<a>").text(this.text()).html()},jqmEnhanceable:function(){return a.mobile.enhanceable(this)},jqmHijackable:function(){return a.mobile.hijackable(this)}}),a.removeWithDependents=function(b){var c=a(b);(c.jqmData("dependents")||a()).remove(),c.remove()},a.addDependents=function(b,c){var d=a(b),e=d.jqmData("dependents")||a();d.jqmData("dependents",a(e).add(c))},a.find.matches=function(b,c){return a.find(b,null,null,c)},a.find.matchesSelector=function(b,c){return a.find(c,null,null,[b]).length>0}}(a,this),function(a){a.extend(a.mobile,{version:"1.4.5",subPageUrlKey:"ui-page",hideUrlBar:!0,keepNative:":jqmData(role='none'), :jqmData(role='nojs')",activePageClass:"ui-page-active",activeBtnClass:"ui-btn-active",focusClass:"ui-focus",ajaxEnabled:!0,hashListeningEnabled:!0,linkBindingEnabled:!0,defaultPageTransition:"fade",maxTransitionWidth:!1,minScrollBack:0,defaultDialogTransition:"pop",pageLoadErrorMessage:"Error Loading Page",pageLoadErrorMessageTheme:"a",phonegapNavigationEnabled:!1,autoInitializePage:!0,pushStateEnabled:!0,ignoreContentEnabled:!1,buttonMarkup:{hoverDelay:200},dynamicBaseEnabled:!0,pageContainer:a(),allowCrossDomainPages:!1,dialogHashKey:"&ui-state=dialog"})}(a,this),function(a,b){var c=0,d=Array.prototype.slice,e=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(f){}e(b)},a.widget=function(b,c,d){var e,f,g,h,i={},j=b.split(".")[0];return b=b.split(".")[1],e=j+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][e.toLowerCase()]=function(b){return!!a.data(b,e)},a[j]=a[j]||{},f=a[j][b],g=a[j][b]=function(a,b){return this._createWidget?void(arguments.length&&this._createWidget(a,b)):new g(a,b)},a.extend(g,f,{version:d.version,_proto:a.extend({},d),_childConstructors:[]}),h=new c,h.options=a.widget.extend({},h.options),a.each(d,function(b,d){return a.isFunction(d)?void(i[b]=function(){var a=function(){return c.prototype[b].apply(this,arguments)},e=function(a){return c.prototype[b].apply(this,a)};return function(){var b,c=this._super,f=this._superApply;return this._super=a,this._superApply=e,b=d.apply(this,arguments),this._super=c,this._superApply=f,b}}()):void(i[b]=d)}),g.prototype=a.widget.extend(h,{widgetEventPrefix:f?h.widgetEventPrefix||b:b},i,{constructor:g,namespace:j,widgetName:b,widgetFullName:e}),f?(a.each(f._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,g,c._proto)}),delete f._childConstructors):c._childConstructors.push(g),a.widget.bridge(b,g),g},a.widget.extend=function(c){for(var e,f,g=d.call(arguments,1),h=0,i=g.length;i>h;h++)for(e in g[h])f=g[h][e],g[h].hasOwnProperty(e)&&f!==b&&(c[e]=a.isPlainObject(f)?a.isPlainObject(c[e])?a.widget.extend({},c[e],f):a.widget.extend({},f):f);return c},a.widget.bridge=function(c,e){var f=e.prototype.widgetFullName||c;a.fn[c]=function(g){var h="string"==typeof g,i=d.call(arguments,1),j=this;return g=!h&&i.length?a.widget.extend.apply(null,[g].concat(i)):g,this.each(h?function(){var d,e=a.data(this,f);return"instance"===g?(j=e,!1):e?a.isFunction(e[g])&&"_"!==g.charAt(0)?(d=e[g].apply(e,i),d!==e&&d!==b?(j=d&&d.jquery?j.pushStack(d.get()):d,!1):void 0):a.error("no such method '"+g+"' for "+c+" widget instance"):a.error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+g+"'")}:function(){var b=a.data(this,f);b?b.option(g||{})._init():a.data(this,f,new e(g,this))}),j}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e,f,g,h=c;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof c)if(h={},e=c.split("."),c=e.shift(),e.length){for(f=h[c]=a.widget.extend({},this.options[c]),g=0;g<e.length-1;g++)f[e[g]]=f[e[g]]||{},f=f[e[g]];if(c=e.pop(),d===b)return f[c]===b?null:f[c];f[c]=d}else{if(d===b)return this.options[c]===b?null:this.options[c];h[c]=d}return this._setOptions(h),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(b,c,d){var e,f=this;"boolean"!=typeof b&&(d=c,c=b,b=!1),d?(c=e=a(c),this.bindings=this.bindings.add(c)):(d=c,c=this.element,e=this.widget()),a.each(d,function(d,g){function h(){return b||f.options.disabled!==!0&&!a(this).hasClass("ui-state-disabled")?("string"==typeof g?f[g]:g).apply(f,arguments):void 0}"string"!=typeof g&&(h.guid=g.guid=g.guid||h.guid||a.guid++);var i=d.match(/^(\w+)\s*(.*)$/),j=i[1]+f.eventNamespace,k=i[2];k?e.delegate(k,j,h):c.bind(j,h)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.unbind(b).undelegate(b)},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.apply(this.element[0],[c].concat(d))===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?e===!0||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}})}(a),function(a,b,c){var d={},e=a.find,f=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,g=/:jqmData\(([^)]*)\)/g;a.extend(a.mobile,{ns:"",getAttribute:function(b,c){var d;b=b.jquery?b[0]:b,b&&b.getAttribute&&(d=b.getAttribute("data-"+a.mobile.ns+c));try{d="true"===d||"false"!==d&&("null"===d?null:+d+""===d?+d:f.test(d)?JSON.parse(d):d)}catch(e){}return d},nsNormalizeDict:d,nsNormalize:function(b){return d[b]||(d[b]=a.camelCase(a.mobile.ns+b))},closestPageData:function(a){return a.closest(":jqmData(role='page'), :jqmData(role='dialog')").data("mobile-page")}}),a.fn.jqmData=function(b,d){var e;return"undefined"!=typeof b&&(b&&(b=a.mobile.nsNormalize(b)),e=arguments.length<2||d===c?this.data(b):this.data(b,d)),e},a.jqmData=function(b,c,d){var e;return"undefined"!=typeof c&&(e=a.data(b,c?a.mobile.nsNormalize(c):c,d)),e},a.fn.jqmRemoveData=function(b){return this.removeData(a.mobile.nsNormalize(b))},a.jqmRemoveData=function(b,c){return a.removeData(b,a.mobile.nsNormalize(c))},a.find=function(b,c,d,f){return b.indexOf(":jqmData")>-1&&(b=b.replace(g,"[data-"+(a.mobile.ns||"")+"$1]")),e.call(this,b,c,d,f)},a.extend(a.find,e)}(a,this),function(a){var b=/[A-Z]/g,c=function(a){return"-"+a.toLowerCase()};a.extend(a.Widget.prototype,{_getCreateOptions:function(){var d,e,f=this.element[0],g={};if(!a.mobile.getAttribute(f,"defaults"))for(d in this.options)e=a.mobile.getAttribute(f,d.replace(b,c)),null!=e&&(g[d]=e);return g}}),a.mobile.widget=a.Widget}(a),function(a){var b="ui-loader",c=a("html");a.widget("mobile.loader",{options:{theme:"a",textVisible:!1,html:"",text:"loading"},defaultHtml:"<div class='"+b+"'><span class='ui-icon-loading'></span><h1></h1></div>",fakeFixLoader:function(){var b=a("."+a.mobile.activeBtnClass).first();this.element.css({top:a.support.scrollTop&&this.window.scrollTop()+this.window.height()/2||b.length&&b.offset().top||100})},checkLoaderPosition:function(){var b=this.element.offset(),c=this.window.scrollTop(),d=a.mobile.getScreenHeight();(b.top<c||b.top-c>d)&&(this.element.addClass("ui-loader-fakefix"),this.fakeFixLoader(),this.window.unbind("scroll",this.checkLoaderPosition).bind("scroll",a.proxy(this.fakeFixLoader,this)))},resetHtml:function(){this.element.html(a(this.defaultHtml).html())},show:function(d,e,f){var g,h,i;this.resetHtml(),"object"===a.type(d)?(i=a.extend({},this.options,d),d=i.theme):(i=this.options,d=d||i.theme),h=e||(i.text===!1?"":i.text),c.addClass("ui-loading"),g=i.textVisible,this.element.attr("class",b+" ui-corner-all ui-body-"+d+" ui-loader-"+(g||e||d.text?"verbose":"default")+(i.textonly||f?" ui-loader-textonly":"")),i.html?this.element.html(i.html):this.element.find("h1").text(h),this.element.appendTo(a(a.mobile.pagecontainer?":mobile-pagecontainer":"body")),
this.checkLoaderPosition(),this.window.bind("scroll",a.proxy(this.checkLoaderPosition,this))},hide:function(){c.removeClass("ui-loading"),this.options.text&&this.element.removeClass("ui-loader-fakefix"),this.window.unbind("scroll",this.fakeFixLoader),this.window.unbind("scroll",this.checkLoaderPosition)}})}(a,this),function(a,b,d){"$:nomunge";function e(a){return a=a||location.href,"#"+a.replace(/^[^#]*#?(.*)$/,"$1")}var f,g="hashchange",h=c,i=a.event.special,j=h.documentMode,k="on"+g in b&&(j===d||j>7);a.fn[g]=function(a){return a?this.bind(g,a):this.trigger(g)},a.fn[g].delay=50,i[g]=a.extend(i[g],{setup:function(){return!k&&void a(f.start)},teardown:function(){return!k&&void a(f.stop)}}),f=function(){function c(){var d=e(),h=n(j);d!==j?(m(j=d,h),a(b).trigger(g)):h!==j&&(location.href=location.href.replace(/#.*/,"")+h),f=setTimeout(c,a.fn[g].delay)}var f,i={},j=e(),l=function(a){return a},m=l,n=l;return i.start=function(){f||c()},i.stop=function(){f&&clearTimeout(f),f=d},b.attachEvent&&!b.addEventListener&&!k&&function(){var b,d;i.start=function(){b||(d=a.fn[g].src,d=d&&d+e(),b=a('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){d||m(e()),c()}).attr("src",d||"javascript:0").insertAfter("body")[0].contentWindow,h.onpropertychange=function(){try{"title"===event.propertyName&&(b.document.title=h.title)}catch(a){}})},i.stop=l,n=function(){return e(b.location.href)},m=function(c,d){var e=b.document,f=a.fn[g].domain;c!==d&&(e.title=h.title,e.open(),f&&e.write('<script>document.domain="'+f+'"</script>'),e.close(),b.location.hash=c)}}(),i}()}(a,this),function(a){b.matchMedia=b.matchMedia||function(a){var b,c=a.documentElement,d=c.firstElementChild||c.firstChild,e=a.createElement("body"),f=a.createElement("div");return f.id="mq-test-1",f.style.cssText="position:absolute;top:-100em",e.style.background="none",e.appendChild(f),function(a){return f.innerHTML='&shy;<style media="'+a+'"> #mq-test-1 { width: 42px; }</style>',c.insertBefore(e,d),b=42===f.offsetWidth,c.removeChild(e),{matches:b,media:a}}}(c),a.mobile.media=function(a){return b.matchMedia(a).matches}}(a),function(a){var b={touch:"ontouchend"in c};a.mobile.support=a.mobile.support||{},a.extend(a.support,b),a.extend(a.mobile.support,b)}(a),function(a){a.extend(a.support,{orientation:"orientation"in b&&"onorientationchange"in b})}(a),function(a,d){function e(a){var b,c=a.charAt(0).toUpperCase()+a.substr(1),e=(a+" "+o.join(c+" ")+c).split(" ");for(b in e)if(n[e[b]]!==d)return!0}function f(){var c=b,d=!(!c.document.createElementNS||!c.document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect||c.opera&&-1===navigator.userAgent.indexOf("Chrome")),e=function(b){b&&d||a("html").addClass("ui-nosvg")},f=new c.Image;f.onerror=function(){e(!1)},f.onload=function(){e(1===f.width&&1===f.height)},f.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="}function g(){var e,f,g,h="transform-3d",i=a.mobile.media("(-"+o.join("-"+h+"),(-")+"-"+h+"),("+h+")");if(i)return!!i;e=c.createElement("div"),f={MozTransform:"-moz-transform",transform:"transform"},m.append(e);for(g in f)e.style[g]!==d&&(e.style[g]="translate3d( 100px, 1px, 1px )",i=b.getComputedStyle(e).getPropertyValue(f[g]));return!!i&&"none"!==i}function h(){var b,c,d=location.protocol+"//"+location.host+location.pathname+"ui-dir/",e=a("head base"),f=null,g="";return e.length?g=e.attr("href"):e=f=a("<base>",{href:d}).appendTo("head"),b=a("<a href='testurl' />").prependTo(m),c=b[0].href,e[0].href=g||location.pathname,f&&f.remove(),0===c.indexOf(d)}function i(){var a,d=c.createElement("x"),e=c.documentElement,f=b.getComputedStyle;return"pointerEvents"in d.style&&(d.style.pointerEvents="auto",d.style.pointerEvents="x",e.appendChild(d),a=f&&"auto"===f(d,"").pointerEvents,e.removeChild(d),!!a)}function j(){var a=c.createElement("div");return"undefined"!=typeof a.getBoundingClientRect}function k(){var a=b,c=navigator.userAgent,d=navigator.platform,e=c.match(/AppleWebKit\/([0-9]+)/),f=!!e&&e[1],g=c.match(/Fennec\/([0-9]+)/),h=!!g&&g[1],i=c.match(/Opera Mobi\/([0-9]+)/),j=!!i&&i[1];return!((d.indexOf("iPhone")>-1||d.indexOf("iPad")>-1||d.indexOf("iPod")>-1)&&f&&534>f||a.operamini&&"[object OperaMini]"==={}.toString.call(a.operamini)||i&&7458>j||c.indexOf("Android")>-1&&f&&533>f||h&&6>h||"palmGetResource"in b&&f&&534>f||c.indexOf("MeeGo")>-1&&c.indexOf("NokiaBrowser/8.5.0")>-1)}var l,m=a("<body>").prependTo("html"),n=m[0].style,o=["Webkit","Moz","O"],p="palmGetResource"in b,q=b.operamini&&"[object OperaMini]"==={}.toString.call(b.operamini),r=b.blackberry&&!e("-webkit-transform");a.extend(a.mobile,{browser:{}}),a.mobile.browser.oldIE=function(){var a=3,b=c.createElement("div"),d=b.all||[];do b.innerHTML="<!--[if gt IE "+ ++a+"]><br><![endif]-->";while(d[0]);return a>4?a:!a}(),a.extend(a.support,{pushState:"pushState"in history&&"replaceState"in history&&!(b.navigator.userAgent.indexOf("Firefox")>=0&&b.top!==b)&&-1===b.navigator.userAgent.search(/CriOS/),mediaquery:a.mobile.media("only all"),cssPseudoElement:!!e("content"),touchOverflow:!!e("overflowScrolling"),cssTransform3d:g(),boxShadow:!!e("boxShadow")&&!r,fixedPosition:k(),scrollTop:("pageXOffset"in b||"scrollTop"in c.documentElement||"scrollTop"in m[0])&&!p&&!q,dynamicBaseTag:h(),cssPointerEvents:i(),boundingRect:j(),inlineSVG:f}),m.remove(),l=function(){var a=b.navigator.userAgent;return a.indexOf("Nokia")>-1&&(a.indexOf("Symbian/3")>-1||a.indexOf("Series60/5")>-1)&&a.indexOf("AppleWebKit")>-1&&a.match(/(BrowserNG|NokiaBrowser)\/7\.[0-3]/)}(),a.mobile.gradeA=function(){return(a.support.mediaquery&&a.support.cssPseudoElement||a.mobile.browser.oldIE&&a.mobile.browser.oldIE>=8)&&(a.support.boundingRect||null!==a.fn.jquery.match(/1\.[0-7+]\.[0-9+]?/))},a.mobile.ajaxBlacklist=b.blackberry&&!b.WebKitPoint||q||l,l&&a(function(){a("head link[rel='stylesheet']").attr("rel","alternate stylesheet").attr("rel","stylesheet")}),a.support.boxShadow||a("html").addClass("ui-noboxshadow")}(a),function(a,b){var c,d=a.mobile.window,e=function(){};a.event.special.beforenavigate={setup:function(){d.on("navigate",e)},teardown:function(){d.off("navigate",e)}},a.event.special.navigate=c={bound:!1,pushStateEnabled:!0,originalEventName:b,isPushStateEnabled:function(){return a.support.pushState&&a.mobile.pushStateEnabled===!0&&this.isHashChangeEnabled()},isHashChangeEnabled:function(){return a.mobile.hashListeningEnabled===!0},popstate:function(b){var c=new a.Event("navigate"),e=new a.Event("beforenavigate"),f=b.originalEvent.state||{};e.originalEvent=b,d.trigger(e),e.isDefaultPrevented()||(b.historyState&&a.extend(f,b.historyState),c.originalEvent=b,setTimeout(function(){d.trigger(c,{state:f})},0))},hashchange:function(b){var c=new a.Event("navigate"),e=new a.Event("beforenavigate");e.originalEvent=b,d.trigger(e),e.isDefaultPrevented()||(c.originalEvent=b,d.trigger(c,{state:b.hashchangeState||{}}))},setup:function(){c.bound||(c.bound=!0,c.isPushStateEnabled()?(c.originalEventName="popstate",d.bind("popstate.navigate",c.popstate)):c.isHashChangeEnabled()&&(c.originalEventName="hashchange",d.bind("hashchange.navigate",c.hashchange)))}}}(a),function(a,c){var d,e,f="&ui-state=dialog";a.mobile.path=d={uiStateKey:"&ui-state",urlParseRE:/^\s*(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,getLocation:function(a){var b=this.parseUrl(a||location.href),c=a?b:location,d=b.hash;return d="#"===d?"":d,c.protocol+b.doubleSlash+c.host+(""!==c.protocol&&"/"!==c.pathname.substring(0,1)?"/":"")+c.pathname+c.search+d},getDocumentUrl:function(b){return b?a.extend({},d.documentUrl):d.documentUrl.href},parseLocation:function(){return this.parseUrl(this.getLocation())},parseUrl:function(b){if("object"===a.type(b))return b;var c=d.urlParseRE.exec(b||"")||[];return{href:c[0]||"",hrefNoHash:c[1]||"",hrefNoSearch:c[2]||"",domain:c[3]||"",protocol:c[4]||"",doubleSlash:c[5]||"",authority:c[6]||"",username:c[8]||"",password:c[9]||"",host:c[10]||"",hostname:c[11]||"",port:c[12]||"",pathname:c[13]||"",directory:c[14]||"",filename:c[15]||"",search:c[16]||"",hash:c[17]||""}},makePathAbsolute:function(a,b){var c,d,e,f;if(a&&"/"===a.charAt(0))return a;for(a=a||"",b=b?b.replace(/^\/|(\/[^\/]*|[^\/]+)$/g,""):"",c=b?b.split("/"):[],d=a.split("/"),e=0;e<d.length;e++)switch(f=d[e]){case".":break;case"..":c.length&&c.pop();break;default:c.push(f)}return"/"+c.join("/")},isSameDomain:function(a,b){return d.parseUrl(a).domain.toLowerCase()===d.parseUrl(b).domain.toLowerCase()},isRelativeUrl:function(a){return""===d.parseUrl(a).protocol},isAbsoluteUrl:function(a){return""!==d.parseUrl(a).protocol},makeUrlAbsolute:function(a,b){if(!d.isRelativeUrl(a))return a;b===c&&(b=this.documentBase);var e=d.parseUrl(a),f=d.parseUrl(b),g=e.protocol||f.protocol,h=e.protocol?e.doubleSlash:e.doubleSlash||f.doubleSlash,i=e.authority||f.authority,j=""!==e.pathname,k=d.makePathAbsolute(e.pathname||f.filename,f.pathname),l=e.search||!j&&f.search||"",m=e.hash;return g+h+i+k+l+m},addSearchParams:function(b,c){var e=d.parseUrl(b),f="object"==typeof c?a.param(c):c,g=e.search||"?";return e.hrefNoSearch+g+("?"!==g.charAt(g.length-1)?"&":"")+f+(e.hash||"")},convertUrlToDataUrl:function(a){var c=a,e=d.parseUrl(a);return d.isEmbeddedPage(e)?c=e.hash.split(f)[0].replace(/^#/,"").replace(/\?.*$/,""):d.isSameDomain(e,this.documentBase)&&(c=e.hrefNoHash.replace(this.documentBase.domain,"").split(f)[0]),b.decodeURIComponent(c)},get:function(a){return a===c&&(a=d.parseLocation().hash),d.stripHash(a).replace(/[^\/]*\.[^\/*]+$/,"")},set:function(a){location.hash=a},isPath:function(a){return/\//.test(a)},clean:function(a){return a.replace(this.documentBase.domain,"")},stripHash:function(a){return a.replace(/^#/,"")},stripQueryParams:function(a){return a.replace(/\?.*$/,"")},cleanHash:function(a){return d.stripHash(a.replace(/\?.*$/,"").replace(f,""))},isHashValid:function(a){return/^#[^#]+$/.test(a)},isExternal:function(a){var b=d.parseUrl(a);return!(!b.protocol||b.domain.toLowerCase()===this.documentUrl.domain.toLowerCase())},hasProtocol:function(a){return/^(:?\w+:)/.test(a)},isEmbeddedPage:function(a){var b=d.parseUrl(a);return""!==b.protocol?!this.isPath(b.hash)&&b.hash&&(b.hrefNoHash===this.documentUrl.hrefNoHash||this.documentBaseDiffers&&b.hrefNoHash===this.documentBase.hrefNoHash):/^#/.test(b.href)},squash:function(a,b){var c,e,f,g,h,i=this.isPath(a),j=this.parseUrl(a),k=j.hash,l="";return b||(i?b=d.getLocation():(h=d.getDocumentUrl(!0),b=d.isPath(h.hash)?d.squash(h.href):h.href)),e=i?d.stripHash(a):a,e=d.isPath(j.hash)?d.stripHash(j.hash):e,g=e.indexOf(this.uiStateKey),g>-1&&(l=e.slice(g),e=e.slice(0,g)),c=d.makeUrlAbsolute(e,b),f=this.parseUrl(c).search,i?((d.isPath(k)||0===k.replace("#","").indexOf(this.uiStateKey))&&(k=""),l&&-1===k.indexOf(this.uiStateKey)&&(k+=l),-1===k.indexOf("#")&&""!==k&&(k="#"+k),c=d.parseUrl(c),c=c.protocol+c.doubleSlash+c.host+c.pathname+f+k):c+=c.indexOf("#")>-1?l:"#"+l,c},isPreservableHash:function(a){return 0===a.replace("#","").indexOf(this.uiStateKey)},hashToSelector:function(a){var b="#"===a.substring(0,1);return b&&(a=a.substring(1)),(b?"#":"")+a.replace(/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g,"\\$1")},getFilePath:function(a){return a&&a.split(f)[0]},isFirstPageUrl:function(b){var e=d.parseUrl(d.makeUrlAbsolute(b,this.documentBase)),f=e.hrefNoHash===this.documentUrl.hrefNoHash||this.documentBaseDiffers&&e.hrefNoHash===this.documentBase.hrefNoHash,g=a.mobile.firstPage,h=g&&g[0]?g[0].id:c;return f&&(!e.hash||"#"===e.hash||h&&e.hash.replace(/^#/,"")===h)},isPermittedCrossDomainRequest:function(b,c){return a.mobile.allowCrossDomainPages&&("file:"===b.protocol||"content:"===b.protocol)&&-1!==c.search(/^https?:/)}},d.documentUrl=d.parseLocation(),e=a("head").find("base"),d.documentBase=e.length?d.parseUrl(d.makeUrlAbsolute(e.attr("href"),d.documentUrl.href)):d.documentUrl,d.documentBaseDiffers=d.documentUrl.hrefNoHash!==d.documentBase.hrefNoHash,d.getDocumentBase=function(b){return b?a.extend({},d.documentBase):d.documentBase.href},a.extend(a.mobile,{getDocumentUrl:d.getDocumentUrl,getDocumentBase:d.getDocumentBase})}(a),function(a,b){a.mobile.History=function(a,b){this.stack=a||[],this.activeIndex=b||0},a.extend(a.mobile.History.prototype,{getActive:function(){return this.stack[this.activeIndex]},getLast:function(){return this.stack[this.previousIndex]},getNext:function(){return this.stack[this.activeIndex+1]},getPrev:function(){return this.stack[this.activeIndex-1]},add:function(a,b){b=b||{},this.getNext()&&this.clearForward(),b.hash&&-1===b.hash.indexOf("#")&&(b.hash="#"+b.hash),b.url=a,this.stack.push(b),this.activeIndex=this.stack.length-1},clearForward:function(){this.stack=this.stack.slice(0,this.activeIndex+1)},find:function(a,b,c){b=b||this.stack;var d,e,f,g=b.length;for(e=0;g>e;e++)if(d=b[e],(decodeURIComponent(a)===decodeURIComponent(d.url)||decodeURIComponent(a)===decodeURIComponent(d.hash))&&(f=e,c))return f;return f},closest:function(a){var c,d=this.activeIndex;return c=this.find(a,this.stack.slice(0,d)),c===b&&(c=this.find(a,this.stack.slice(d),!0),c=c===b?c:c+d),c},direct:function(c){var d=this.closest(c.url),e=this.activeIndex;d!==b&&(this.activeIndex=d,this.previousIndex=e),e>d?(c.present||c.back||a.noop)(this.getActive(),"back"):d>e?(c.present||c.forward||a.noop)(this.getActive(),"forward"):d===b&&c.missing&&c.missing(this.getActive())}})}(a),function(a){var d=a.mobile.path,e=location.href;a.mobile.Navigator=function(b){this.history=b,this.ignoreInitialHashChange=!0,a.mobile.window.bind({"popstate.history":a.proxy(this.popstate,this),"hashchange.history":a.proxy(this.hashchange,this)})},a.extend(a.mobile.Navigator.prototype,{squash:function(e,f){var g,h,i=d.isPath(e)?d.stripHash(e):e;return h=d.squash(e),g=a.extend({hash:i,url:h},f),b.history.replaceState(g,g.title||c.title,h),g},hash:function(a,b){var c,e,f,g;return c=d.parseUrl(a),e=d.parseLocation(),e.pathname+e.search===c.pathname+c.search?f=c.hash?c.hash:c.pathname+c.search:d.isPath(a)?(g=d.parseUrl(b),f=g.pathname+g.search+(d.isPreservableHash(g.hash)?g.hash.replace("#",""):"")):f=a,f},go:function(e,f,g){var h,i,j,k,l=a.event.special.navigate.isPushStateEnabled();i=d.squash(e),j=this.hash(e,i),g&&j!==d.stripHash(d.parseLocation().hash)&&(this.preventNextHashChange=g),this.preventHashAssignPopState=!0,b.location.hash=j,this.preventHashAssignPopState=!1,h=a.extend({url:i,hash:j,title:c.title},f),l&&(k=new a.Event("popstate"),k.originalEvent={type:"popstate",state:null},this.squash(e,h),g||(this.ignorePopState=!0,a.mobile.window.trigger(k))),this.history.add(h.url,h)},popstate:function(b){var c,f;if(a.event.special.navigate.isPushStateEnabled())return this.preventHashAssignPopState?(this.preventHashAssignPopState=!1,void b.stopImmediatePropagation()):this.ignorePopState?void(this.ignorePopState=!1):!b.originalEvent.state&&1===this.history.stack.length&&this.ignoreInitialHashChange&&(this.ignoreInitialHashChange=!1,location.href===e)?void b.preventDefault():(c=d.parseLocation().hash,!b.originalEvent.state&&c?(f=this.squash(c),this.history.add(f.url,f),void(b.historyState=f)):void this.history.direct({url:(b.originalEvent.state||{}).url||c,present:function(c,d){b.historyState=a.extend({},c),b.historyState.direction=d}}))},hashchange:function(b){var e,f;if(a.event.special.navigate.isHashChangeEnabled()&&!a.event.special.navigate.isPushStateEnabled()){if(this.preventNextHashChange)return this.preventNextHashChange=!1,void b.stopImmediatePropagation();e=this.history,f=d.parseLocation().hash,this.history.direct({url:f,present:function(c,d){b.hashchangeState=a.extend({},c),b.hashchangeState.direction=d},missing:function(){e.add(f,{hash:f,title:c.title})}})}}})}(a),function(a){a.mobile.navigate=function(b,c,d){a.mobile.navigate.navigator.go(b,c,d)},a.mobile.navigate.history=new a.mobile.History,a.mobile.navigate.navigator=new a.mobile.Navigator(a.mobile.navigate.history);var b=a.mobile.path.parseLocation();a.mobile.navigate.history.add(b.href,{hash:b.hash})}(a),function(a,b){var d={animation:{},transition:{}},e=c.createElement("a"),f=["","webkit-","moz-","o-"];a.each(["animation","transition"],function(c,g){var h=0===c?g+"-name":g;a.each(f,function(c,f){return e.style[a.camelCase(f+h)]!==b?(d[g].prefix=f,!1):void 0}),d[g].duration=a.camelCase(d[g].prefix+g+"-duration"),d[g].event=a.camelCase(d[g].prefix+g+"-end"),""===d[g].prefix&&(d[g].event=d[g].event.toLowerCase())}),a.support.cssTransitions=d.transition.prefix!==b,a.support.cssAnimations=d.animation.prefix!==b,a(e).remove(),a.fn.animationComplete=function(e,f,g){var h,i,j=this,k=function(){clearTimeout(h),e.apply(this,arguments)},l=f&&"animation"!==f?"transition":"animation";return a.support.cssTransitions&&"transition"===l||a.support.cssAnimations&&"animation"===l?(g===b&&(a(this).context!==c&&(i=3e3*parseFloat(a(this).css(d[l].duration))),(0===i||i===b||isNaN(i))&&(i=a.fn.animationComplete.defaultDuration)),h=setTimeout(function(){a(j).off(d[l].event,k),e.apply(j)},i),a(this).one(d[l].event,k)):(setTimeout(a.proxy(e,this),0),a(this))},a.fn.animationComplete.defaultDuration=1e3}(a),function(a,b,c,d){function e(a){for(;a&&"undefined"!=typeof a.originalEvent;)a=a.originalEvent;return a}function f(b,c){var f,g,h,i,j,k,l,m,n,o=b.type;if(b=a.Event(b),b.type=c,f=b.originalEvent,g=a.event.props,o.search(/^(mouse|click)/)>-1&&(g=E),f)for(l=g.length,i;l;)i=g[--l],b[i]=f[i];if(o.search(/mouse(down|up)|click/)>-1&&!b.which&&(b.which=1),-1!==o.search(/^touch/)&&(h=e(f),o=h.touches,j=h.changedTouches,k=o&&o.length?o[0]:j&&j.length?j[0]:d))for(m=0,n=C.length;n>m;m++)i=C[m],b[i]=k[i];return b}function g(b){for(var c,d,e={};b;){c=a.data(b,z);for(d in c)c[d]&&(e[d]=e.hasVirtualBinding=!0);b=b.parentNode}return e}function h(b,c){for(var d;b;){if(d=a.data(b,z),d&&(!c||d[c]))return b;b=b.parentNode}return null}function i(){M=!1}function j(){M=!0}function k(){Q=0,K.length=0,L=!1,j()}function l(){i()}function m(){n(),G=setTimeout(function(){G=0,k()},a.vmouse.resetTimerDuration)}function n(){G&&(clearTimeout(G),G=0)}function o(b,c,d){var e;return(d&&d[b]||!d&&h(c.target,b))&&(e=f(c,b),a(c.target).trigger(e)),e}function p(b){var c,d=a.data(b.target,A);L||Q&&Q===d||(c=o("v"+b.type,b),c&&(c.isDefaultPrevented()&&b.preventDefault(),c.isPropagationStopped()&&b.stopPropagation(),c.isImmediatePropagationStopped()&&b.stopImmediatePropagation()))}function q(b){var c,d,f,h=e(b).touches;h&&1===h.length&&(c=b.target,d=g(c),d.hasVirtualBinding&&(Q=P++,a.data(c,A,Q),n(),l(),J=!1,f=e(b).touches[0],H=f.pageX,I=f.pageY,o("vmouseover",b,d),o("vmousedown",b,d)))}function r(a){M||(J||o("vmousecancel",a,g(a.target)),J=!0,m())}function s(b){if(!M){var c=e(b).touches[0],d=J,f=a.vmouse.moveDistanceThreshold,h=g(b.target);J=J||Math.abs(c.pageX-H)>f||Math.abs(c.pageY-I)>f,J&&!d&&o("vmousecancel",b,h),o("vmousemove",b,h),m()}}function t(a){if(!M){j();var b,c,d=g(a.target);o("vmouseup",a,d),J||(b=o("vclick",a,d),b&&b.isDefaultPrevented()&&(c=e(a).changedTouches[0],K.push({touchID:Q,x:c.clientX,y:c.clientY}),L=!0)),o("vmouseout",a,d),J=!1,m()}}function u(b){var c,d=a.data(b,z);if(d)for(c in d)if(d[c])return!0;return!1}function v(){}function w(b){var c=b.substr(1);return{setup:function(){u(this)||a.data(this,z,{});var d=a.data(this,z);d[b]=!0,F[b]=(F[b]||0)+1,1===F[b]&&O.bind(c,p),a(this).bind(c,v),N&&(F.touchstart=(F.touchstart||0)+1,1===F.touchstart&&O.bind("touchstart",q).bind("touchend",t).bind("touchmove",s).bind("scroll",r))},teardown:function(){--F[b],F[b]||O.unbind(c,p),N&&(--F.touchstart,F.touchstart||O.unbind("touchstart",q).unbind("touchmove",s).unbind("touchend",t).unbind("scroll",r));var d=a(this),e=a.data(this,z);e&&(e[b]=!1),d.unbind(c,v),u(this)||d.removeData(z)}}}var x,y,z="virtualMouseBindings",A="virtualTouchID",B="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),C="clientX clientY pageX pageY screenX screenY".split(" "),D=a.event.mouseHooks?a.event.mouseHooks.props:[],E=a.event.props.concat(D),F={},G=0,H=0,I=0,J=!1,K=[],L=!1,M=!1,N="addEventListener"in c,O=a(c),P=1,Q=0;for(a.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500},y=0;y<B.length;y++)a.event.special[B[y]]=w(B[y]);N&&c.addEventListener("click",function(b){var c,d,e,f,g,h,i=K.length,j=b.target;if(i)for(c=b.clientX,d=b.clientY,x=a.vmouse.clickDistanceThreshold,e=j;e;){for(f=0;i>f;f++)if(g=K[f],h=0,e===j&&Math.abs(g.x-c)<x&&Math.abs(g.y-d)<x||a.data(e,A)===g.touchID)return b.preventDefault(),void b.stopPropagation();e=e.parentNode}},!0)}(a,b,c),function(a,b,d){function e(b,c,e,f){var g=e.type;e.type=c,f?a.event.trigger(e,d,b):a.event.dispatch.call(b,e),e.type=g}var f=a(c),g=a.mobile.support.touch,h="touchmove scroll",i=g?"touchstart":"mousedown",j=g?"touchend":"mouseup",k=g?"touchmove":"mousemove";a.each("touchstart touchmove touchend tap taphold swipe swipeleft swiperight scrollstart scrollstop".split(" "),function(b,c){a.fn[c]=function(a){return a?this.bind(c,a):this.trigger(c)},a.attrFn&&(a.attrFn[c]=!0)}),a.event.special.scrollstart={enabled:!0,setup:function(){function b(a,b){c=b,e(f,c?"scrollstart":"scrollstop",a)}var c,d,f=this,g=a(f);g.bind(h,function(e){a.event.special.scrollstart.enabled&&(c||b(e,!0),clearTimeout(d),d=setTimeout(function(){b(e,!1)},50))})},teardown:function(){a(this).unbind(h)}},a.event.special.tap={tapholdThreshold:750,emitTapOnTaphold:!0,setup:function(){var b=this,c=a(b),d=!1;c.bind("vmousedown",function(g){function h(){clearTimeout(k)}function i(){h(),c.unbind("vclick",j).unbind("vmouseup",h),f.unbind("vmousecancel",i)}function j(a){i(),d||l!==a.target?d&&a.preventDefault():e(b,"tap",a)}if(d=!1,g.which&&1!==g.which)return!1;var k,l=g.target;c.bind("vmouseup",h).bind("vclick",j),f.bind("vmousecancel",i),k=setTimeout(function(){a.event.special.tap.emitTapOnTaphold||(d=!0),e(b,"taphold",a.Event("taphold",{target:l}))},a.event.special.tap.tapholdThreshold)})},teardown:function(){a(this).unbind("vmousedown").unbind("vclick").unbind("vmouseup"),f.unbind("vmousecancel")}},a.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1e3,horizontalDistanceThreshold:30,verticalDistanceThreshold:30,getLocation:function(a){var c=b.pageXOffset,d=b.pageYOffset,e=a.clientX,f=a.clientY;return 0===a.pageY&&Math.floor(f)>Math.floor(a.pageY)||0===a.pageX&&Math.floor(e)>Math.floor(a.pageX)?(e-=c,f-=d):(f<a.pageY-d||e<a.pageX-c)&&(e=a.pageX-c,f=a.pageY-d),{x:e,y:f}},start:function(b){var c=b.originalEvent.touches?b.originalEvent.touches[0]:b,d=a.event.special.swipe.getLocation(c);return{time:(new Date).getTime(),coords:[d.x,d.y],origin:a(b.target)}},stop:function(b){var c=b.originalEvent.touches?b.originalEvent.touches[0]:b,d=a.event.special.swipe.getLocation(c);return{time:(new Date).getTime(),coords:[d.x,d.y]}},handleSwipe:function(b,c,d,f){if(c.time-b.time<a.event.special.swipe.durationThreshold&&Math.abs(b.coords[0]-c.coords[0])>a.event.special.swipe.horizontalDistanceThreshold&&Math.abs(b.coords[1]-c.coords[1])<a.event.special.swipe.verticalDistanceThreshold){var g=b.coords[0]>c.coords[0]?"swipeleft":"swiperight";return e(d,"swipe",a.Event("swipe",{target:f,swipestart:b,swipestop:c}),!0),e(d,g,a.Event(g,{target:f,swipestart:b,swipestop:c}),!0),!0}return!1},eventInProgress:!1,setup:function(){var b,c=this,d=a(c),e={};b=a.data(this,"mobile-events"),b||(b={length:0},a.data(this,"mobile-events",b)),b.length++,b.swipe=e,e.start=function(b){if(!a.event.special.swipe.eventInProgress){a.event.special.swipe.eventInProgress=!0;var d,g=a.event.special.swipe.start(b),h=b.target,i=!1;e.move=function(b){g&&!b.isDefaultPrevented()&&(d=a.event.special.swipe.stop(b),i||(i=a.event.special.swipe.handleSwipe(g,d,c,h),i&&(a.event.special.swipe.eventInProgress=!1)),Math.abs(g.coords[0]-d.coords[0])>a.event.special.swipe.scrollSupressionThreshold&&b.preventDefault())},e.stop=function(){i=!0,a.event.special.swipe.eventInProgress=!1,f.off(k,e.move),e.move=null},f.on(k,e.move).one(j,e.stop)}},d.on(i,e.start)},teardown:function(){var b,c;b=a.data(this,"mobile-events"),b&&(c=b.swipe,delete b.swipe,b.length--,0===b.length&&a.removeData(this,"mobile-events")),c&&(c.start&&a(this).off(i,c.start),c.move&&f.off(k,c.move),c.stop&&f.off(j,c.stop))}},a.each({scrollstop:"scrollstart",taphold:"tap",swipeleft:"swipe.left",swiperight:"swipe.right"},function(b,c){a.event.special[b]={setup:function(){a(this).bind(c,a.noop)},teardown:function(){a(this).unbind(c)}}})}(a,this),function(a){a.event.special.throttledresize={setup:function(){a(this).bind("resize",f)},teardown:function(){a(this).unbind("resize",f)}};var b,c,d,e=250,f=function(){c=(new Date).getTime(),d=c-g,d>=e?(g=c,a(this).trigger("throttledresize")):(b&&clearTimeout(b),b=setTimeout(f,e-d))},g=0}(a),function(a,b){function d(){var a=e();a!==f&&(f=a,l.trigger(m))}var e,f,g,h,i,j,k,l=a(b),m="orientationchange",n={0:!0,180:!0};a.support.orientation&&(i=b.innerWidth||l.width(),j=b.innerHeight||l.height(),k=50,g=i>j&&i-j>k,h=n[b.orientation],(g&&h||!g&&!h)&&(n={"-90":!0,90:!0})),a.event.special.orientationchange=a.extend({},a.event.special.orientationchange,{setup:function(){return!(a.support.orientation&&!a.event.special.orientationchange.disabled)&&(f=e(),void l.bind("throttledresize",d))},teardown:function(){return!(a.support.orientation&&!a.event.special.orientationchange.disabled)&&void l.unbind("throttledresize",d)},add:function(a){var b=a.handler;a.handler=function(a){return a.orientation=e(),b.apply(this,arguments)}}}),a.event.special.orientationchange.orientation=e=function(){var d=!0,e=c.documentElement;return d=a.support.orientation?n[b.orientation]:e&&e.clientWidth/e.clientHeight<1.1,d?"portrait":"landscape"},a.fn[m]=function(a){return a?this.bind(m,a):this.trigger(m)},a.attrFn&&(a.attrFn[m]=!0)}(a,this),function(a){var b=a("head").children("base"),c={element:b.length?b:a("<base>",{href:a.mobile.path.documentBase.hrefNoHash}).prependTo(a("head")),linkSelector:"[src], link[href], a[rel='external'], :jqmData(ajax='false'), a[target]",set:function(b){a.mobile.dynamicBaseEnabled&&a.support.dynamicBaseTag&&c.element.attr("href",a.mobile.path.makeUrlAbsolute(b,a.mobile.path.documentBase))},rewrite:function(b,d){var e=a.mobile.path.get(b);d.find(c.linkSelector).each(function(b,c){var d=a(c).is("[href]")?"href":a(c).is("[src]")?"src":"action",f=a.mobile.path.parseLocation(),g=a(c).attr(d);g=g.replace(f.protocol+f.doubleSlash+f.host+f.pathname,""),/^(\w+:|#|\/)/.test(g)||a(c).attr(d,e+g)})},reset:function(){c.element.attr("href",a.mobile.path.documentBase.hrefNoSearch)}};a.mobile.base=c}(a),function(a,b){a.mobile.widgets={};var c=a.widget,d=a.mobile.keepNative;a.widget=function(c){return function(){var d=c.apply(this,arguments),e=d.prototype.widgetName;return d.initSelector=d.prototype.initSelector!==b?d.prototype.initSelector:":jqmData(role='"+e+"')",a.mobile.widgets[e]=d,d}}(a.widget),a.extend(a.widget,c),a.mobile.document.on("create",function(b){a(b.target).enhanceWithin()}),a.widget("mobile.page",{options:{theme:"a",domCache:!1,keepNativeDefault:a.mobile.keepNative,contentTheme:null,enhanced:!1},_createWidget:function(){a.Widget.prototype._createWidget.apply(this,arguments),this._trigger("init")},_create:function(){return this._trigger("beforecreate")!==!1&&(this.options.enhanced||this._enhance(),this._on(this.element,{pagebeforehide:"removeContainerBackground",pagebeforeshow:"_handlePageBeforeShow"}),this.element.enhanceWithin(),void("dialog"===a.mobile.getAttribute(this.element[0],"role")&&a.mobile.dialog&&this.element.dialog()))},_enhance:function(){var c="data-"+a.mobile.ns,d=this;this.options.role&&this.element.attr("data-"+a.mobile.ns+"role",this.options.role),this.element.attr("tabindex","0").addClass("ui-page ui-page-theme-"+this.options.theme),this.element.find("["+c+"role='content']").each(function(){var e=a(this),f=this.getAttribute(c+"theme")||b;d.options.contentTheme=f||d.options.contentTheme||d.options.dialog&&d.options.theme||"dialog"===d.element.jqmData("role")&&d.options.theme,e.addClass("ui-content"),d.options.contentTheme&&e.addClass("ui-body-"+d.options.contentTheme),e.attr("role","main").addClass("ui-content")})},bindRemove:function(b){var c=this.element;!c.data("mobile-page").options.domCache&&c.is(":jqmData(external-page='true')")&&c.bind("pagehide.remove",b||function(b,c){if(!c.samePage){var d=a(this),e=new a.Event("pageremove");d.trigger(e),e.isDefaultPrevented()||d.removeWithDependents()}})},_setOptions:function(c){c.theme!==b&&this.element.removeClass("ui-page-theme-"+this.options.theme).addClass("ui-page-theme-"+c.theme),c.contentTheme!==b&&this.element.find("[data-"+a.mobile.ns+"='content']").removeClass("ui-body-"+this.options.contentTheme).addClass("ui-body-"+c.contentTheme)},_handlePageBeforeShow:function(){this.setContainerBackground()},removeContainerBackground:function(){this.element.closest(":mobile-pagecontainer").pagecontainer({theme:"none"})},setContainerBackground:function(a){this.element.parent().pagecontainer({theme:a||this.options.theme})},keepNativeSelector:function(){var b=this.options,c=a.trim(b.keepNative||""),e=a.trim(a.mobile.keepNative),f=a.trim(b.keepNativeDefault),g=d===e?"":e,h=""===g?f:"";return(c?[c]:[]).concat(g?[g]:[]).concat(h?[h]:[]).join(", ")}})}(a),function(a,d){a.widget("mobile.pagecontainer",{options:{theme:"a"},initSelector:!1,_create:function(){this._trigger("beforecreate"),this.setLastScrollEnabled=!0,this._on(this.window,{navigate:"_disableRecordScroll",scrollstop:"_delayedRecordScroll"}),this._on(this.window,{navigate:"_filterNavigateEvents"}),this._on({pagechange:"_afterContentChange"}),this.window.one("navigate",a.proxy(function(){this.setLastScrollEnabled=!0},this))},_setOptions:function(a){a.theme!==d&&"none"!==a.theme?this.element.removeClass("ui-overlay-"+this.options.theme).addClass("ui-overlay-"+a.theme):a.theme!==d&&this.element.removeClass("ui-overlay-"+this.options.theme),this._super(a)},_disableRecordScroll:function(){this.setLastScrollEnabled=!1},_enableRecordScroll:function(){this.setLastScrollEnabled=!0},_afterContentChange:function(){this.setLastScrollEnabled=!0,this._off(this.window,"scrollstop"),this._on(this.window,{scrollstop:"_delayedRecordScroll"})},_recordScroll:function(){if(this.setLastScrollEnabled){var a,b,c,d=this._getActiveHistory();d&&(a=this._getScroll(),b=this._getMinScroll(),c=this._getDefaultScroll(),d.lastScroll=b>a?c:a)}},_delayedRecordScroll:function(){setTimeout(a.proxy(this,"_recordScroll"),100)},_getScroll:function(){return this.window.scrollTop()},_getMinScroll:function(){return a.mobile.minScrollBack},_getDefaultScroll:function(){return a.mobile.defaultHomeScroll},_filterNavigateEvents:function(b,c){var d;b.originalEvent&&b.originalEvent.isDefaultPrevented()||(d=b.originalEvent.type.indexOf("hashchange")>-1?c.state.hash:c.state.url,d||(d=this._getHash()),d&&"#"!==d&&0!==d.indexOf("#"+a.mobile.path.uiStateKey)||(d=location.href),this._handleNavigate(d,c.state))},_getHash:function(){return a.mobile.path.parseLocation().hash},getActivePage:function(){return this.activePage},_getInitialContent:function(){return a.mobile.firstPage},_getHistory:function(){return a.mobile.navigate.history},_getActiveHistory:function(){return this._getHistory().getActive()},_getDocumentBase:function(){return a.mobile.path.documentBase},back:function(){this.go(-1)},forward:function(){this.go(1)},go:function(c){if(a.mobile.hashListeningEnabled)b.history.go(c);else{var d=a.mobile.navigate.history.activeIndex,e=d+parseInt(c,10),f=a.mobile.navigate.history.stack[e].url,g=c>=1?"forward":"back";a.mobile.navigate.history.activeIndex=e,a.mobile.navigate.history.previousIndex=d,this.change(f,{direction:g,changeHash:!1,fromHashChange:!0})}},_handleDestination:function(b){var c;return"string"===a.type(b)&&(b=a.mobile.path.stripHash(b)),b&&(c=this._getHistory(),b=a.mobile.path.isPath(b)?b:a.mobile.path.makeUrlAbsolute("#"+b,this._getDocumentBase())),b||this._getInitialContent()},_transitionFromHistory:function(a,b){
var c=this._getHistory(),d="back"===a?c.getLast():c.getActive();return d&&d.transition||b},_handleDialog:function(b,c){var d,e,f=this.getActivePage();return f&&!f.data("mobile-dialog")?("back"===c.direction?this.back():this.forward(),!1):(d=c.pageUrl,e=this._getActiveHistory(),a.extend(b,{role:e.role,transition:this._transitionFromHistory(c.direction,b.transition),reverse:"back"===c.direction}),d)},_handleNavigate:function(b,c){var d=a.mobile.path.stripHash(b),e=this._getHistory(),f=0===e.stack.length?"none":this._transitionFromHistory(c.direction),g={changeHash:!1,fromHashChange:!0,reverse:"back"===c.direction};a.extend(g,c,{transition:f}),e.activeIndex>0&&d.indexOf(a.mobile.dialogHashKey)>-1&&(d=this._handleDialog(g,c),d===!1)||this._changeContent(this._handleDestination(d),g)},_changeContent:function(b,c){a.mobile.changePage(b,c)},_getBase:function(){return a.mobile.base},_getNs:function(){return a.mobile.ns},_enhance:function(a,b){return a.page({role:b})},_include:function(a,b){a.appendTo(this.element),this._enhance(a,b.role),a.page("bindRemove")},_find:function(b){var c,d=this._createFileUrl(b),e=this._createDataUrl(b),f=this._getInitialContent();return c=this.element.children("[data-"+this._getNs()+"url='"+a.mobile.path.hashToSelector(e)+"']"),0===c.length&&e&&!a.mobile.path.isPath(e)&&(c=this.element.children(a.mobile.path.hashToSelector("#"+e)).attr("data-"+this._getNs()+"url",e).jqmData("url",e)),0===c.length&&a.mobile.path.isFirstPageUrl(d)&&f&&f.parent().length&&(c=a(f)),c},_getLoader:function(){return a.mobile.loading()},_showLoading:function(b,c,d,e){this._loadMsg||(this._loadMsg=setTimeout(a.proxy(function(){this._getLoader().loader("show",c,d,e),this._loadMsg=0},this),b))},_hideLoading:function(){clearTimeout(this._loadMsg),this._loadMsg=0,this._getLoader().loader("hide")},_showError:function(){this._hideLoading(),this._showLoading(0,a.mobile.pageLoadErrorMessageTheme,a.mobile.pageLoadErrorMessage,!0),setTimeout(a.proxy(this,"_hideLoading"),1500)},_parse:function(b,c){var d,e=a("<div></div>");return e.get(0).innerHTML=b,d=e.find(":jqmData(role='page'), :jqmData(role='dialog')").first(),d.length||(d=a("<div data-"+this._getNs()+"role='page'>"+(b.split(/<\/?body[^>]*>/gim)[1]||"")+"</div>")),d.attr("data-"+this._getNs()+"url",this._createDataUrl(c)).attr("data-"+this._getNs()+"external-page",!0),d},_setLoadedTitle:function(b,c){var d=c.match(/<title[^>]*>([^<]*)/)&&RegExp.$1;d&&!b.jqmData("title")&&(d=a("<div>"+d+"</div>").text(),b.jqmData("title",d))},_isRewritableBaseTag:function(){return a.mobile.dynamicBaseEnabled&&!a.support.dynamicBaseTag},_createDataUrl:function(b){return a.mobile.path.convertUrlToDataUrl(b)},_createFileUrl:function(b){return a.mobile.path.getFilePath(b)},_triggerWithDeprecated:function(b,c,d){var e=a.Event("page"+b),f=a.Event(this.widgetName+b);return(d||this.element).trigger(e,c),this._trigger(b,f,c),{deprecatedEvent:e,event:f}},_loadSuccess:function(b,c,e,f){var g=this._createFileUrl(b);return a.proxy(function(h,i,j){var k,l=new RegExp("(<[^>]+\\bdata-"+this._getNs()+"role=[\"']?page[\"']?[^>]*>)"),m=new RegExp("\\bdata-"+this._getNs()+"url=[\"']?([^\"'>]*)[\"']?");l.test(h)&&RegExp.$1&&m.test(RegExp.$1)&&RegExp.$1&&(g=a.mobile.path.getFilePath(a("<div>"+RegExp.$1+"</div>").text()),g=this.window[0].encodeURIComponent(g)),e.prefetch===d&&this._getBase().set(g),k=this._parse(h,g),this._setLoadedTitle(k,h),c.xhr=j,c.textStatus=i,c.page=k,c.content=k,c.toPage=k,this._triggerWithDeprecated("load",c).event.isDefaultPrevented()||(this._isRewritableBaseTag()&&k&&this._getBase().rewrite(g,k),this._include(k,e),e.showLoadMsg&&this._hideLoading(),f.resolve(b,e,k))},this)},_loadDefaults:{type:"get",data:d,reloadPage:!1,reload:!1,role:d,showLoadMsg:!1,loadMsgDelay:50},load:function(b,c){var e,f,g,h,i=c&&c.deferred||a.Deferred(),j=c&&c.reload===d&&c.reloadPage!==d?{reload:c.reloadPage}:{},k=a.extend({},this._loadDefaults,c,j),l=null,m=a.mobile.path.makeUrlAbsolute(b,this._findBaseWithDefault());return k.data&&"get"===k.type&&(m=a.mobile.path.addSearchParams(m,k.data),k.data=d),k.data&&"post"===k.type&&(k.reload=!0),e=this._createFileUrl(m),f=this._createDataUrl(m),l=this._find(m),0===l.length&&a.mobile.path.isEmbeddedPage(e)&&!a.mobile.path.isFirstPageUrl(e)?(i.reject(m,k),i.promise()):(this._getBase().reset(),l.length&&!k.reload?(this._enhance(l,k.role),i.resolve(m,k,l),k.prefetch||this._getBase().set(b),i.promise()):(h={url:b,absUrl:m,toPage:b,prevPage:c?c.fromPage:d,dataUrl:f,deferred:i,options:k},g=this._triggerWithDeprecated("beforeload",h),g.deprecatedEvent.isDefaultPrevented()||g.event.isDefaultPrevented()?i.promise():(k.showLoadMsg&&this._showLoading(k.loadMsgDelay),k.prefetch===d&&this._getBase().reset(),a.mobile.allowCrossDomainPages||a.mobile.path.isSameDomain(a.mobile.path.documentUrl,m)?(a.ajax({url:e,type:k.type,data:k.data,contentType:k.contentType,dataType:"html",success:this._loadSuccess(m,h,k,i),error:this._loadError(m,h,k,i)}),i.promise()):(i.reject(m,k),i.promise()))))},_loadError:function(b,c,d,e){return a.proxy(function(f,g,h){this._getBase().set(a.mobile.path.get()),c.xhr=f,c.textStatus=g,c.errorThrown=h;var i=this._triggerWithDeprecated("loadfailed",c);i.deprecatedEvent.isDefaultPrevented()||i.event.isDefaultPrevented()||(d.showLoadMsg&&this._showError(),e.reject(b,d))},this)},_getTransitionHandler:function(b){return b=a.mobile._maybeDegradeTransition(b),a.mobile.transitionHandlers[b]||a.mobile.defaultTransitionHandler},_triggerCssTransitionEvents:function(b,c,d){var e=!1;d=d||"",c&&(b[0]===c[0]&&(e=!0),this._triggerWithDeprecated(d+"hide",{nextPage:b,toPage:b,prevPage:c,samePage:e},c)),this._triggerWithDeprecated(d+"show",{prevPage:c||a(""),toPage:b},b)},_cssTransition:function(b,c,d){var e,f,g=d.transition,h=d.reverse,i=d.deferred;this._triggerCssTransitionEvents(b,c,"before"),this._hideLoading(),e=this._getTransitionHandler(g),f=new e(g,h,b,c).transition(),f.done(a.proxy(function(){this._triggerCssTransitionEvents(b,c)},this)),f.done(function(){i.resolve.apply(i,arguments)})},_releaseTransitionLock:function(){f=!1,e.length>0&&a.mobile.changePage.apply(null,e.pop())},_removeActiveLinkClass:function(b){a.mobile.removeActiveLinkClass(b)},_loadUrl:function(b,c,d){d.target=b,d.deferred=a.Deferred(),this.load(b,d),d.deferred.done(a.proxy(function(a,b,d){f=!1,b.absUrl=c.absUrl,this.transition(d,c,b)},this)),d.deferred.fail(a.proxy(function(){this._removeActiveLinkClass(!0),this._releaseTransitionLock(),this._triggerWithDeprecated("changefailed",c)},this))},_triggerPageBeforeChange:function(b,c,d){var e;return c.prevPage=this.activePage,a.extend(c,{toPage:b,options:d}),c.absUrl="string"===a.type(b)?a.mobile.path.makeUrlAbsolute(b,this._findBaseWithDefault()):d.absUrl,e=this._triggerWithDeprecated("beforechange",c),!e.event.isDefaultPrevented()&&!e.deprecatedEvent.isDefaultPrevented()},change:function(b,c){if(f)return void e.unshift(arguments);var d=a.extend({},a.mobile.changePage.defaults,c),g={};d.fromPage=d.fromPage||this.activePage,this._triggerPageBeforeChange(b,g,d)&&(b=g.toPage,"string"===a.type(b)?(f=!0,this._loadUrl(b,g,d)):this.transition(b,g,d))},transition:function(b,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v;if(f)return void e.unshift([b,h]);if(this._triggerPageBeforeChange(b,g,h)&&(g.prevPage=h.fromPage,v=this._triggerWithDeprecated("beforetransition",g),!v.deprecatedEvent.isDefaultPrevented()&&!v.event.isDefaultPrevented())){if(f=!0,b[0]!==a.mobile.firstPage[0]||h.dataUrl||(h.dataUrl=a.mobile.path.documentUrl.hrefNoHash),i=h.fromPage,j=h.dataUrl&&a.mobile.path.convertUrlToDataUrl(h.dataUrl)||b.jqmData("url"),k=j,l=a.mobile.path.getFilePath(j),m=a.mobile.navigate.history.getActive(),n=0===a.mobile.navigate.history.activeIndex,o=0,p=c.title,q=("dialog"===h.role||"dialog"===b.jqmData("role"))&&b.jqmData("dialog")!==!0,i&&i[0]===b[0]&&!h.allowSamePageTransition)return f=!1,this._triggerWithDeprecated("transition",g),this._triggerWithDeprecated("change",g),void(h.fromHashChange&&a.mobile.navigate.history.direct({url:j}));b.page({role:h.role}),h.fromHashChange&&(o="back"===h.direction?-1:1);try{c.activeElement&&"body"!==c.activeElement.nodeName.toLowerCase()?a(c.activeElement).blur():a("input:focus, textarea:focus, select:focus").blur()}catch(w){}r=!1,q&&m&&(m.url&&m.url.indexOf(a.mobile.dialogHashKey)>-1&&this.activePage&&!this.activePage.hasClass("ui-dialog")&&a.mobile.navigate.history.activeIndex>0&&(h.changeHash=!1,r=!0),j=m.url||"",j+=!r&&j.indexOf("#")>-1?a.mobile.dialogHashKey:"#"+a.mobile.dialogHashKey),s=m?b.jqmData("title")||b.children(":jqmData(role='header')").find(".ui-title").text():p,s&&p===c.title&&(p=s),b.jqmData("title")||b.jqmData("title",p),h.transition=h.transition||(o&&!n?m.transition:d)||(q?a.mobile.defaultDialogTransition:a.mobile.defaultPageTransition),!o&&r&&(a.mobile.navigate.history.getActive().pageUrl=k),j&&!h.fromHashChange&&(!a.mobile.path.isPath(j)&&j.indexOf("#")<0&&(j="#"+j),t={transition:h.transition,title:p,pageUrl:k,role:h.role},h.changeHash!==!1&&a.mobile.hashListeningEnabled?a.mobile.navigate(this.window[0].encodeURI(j),t,!0):b[0]!==a.mobile.firstPage[0]&&a.mobile.navigate.history.add(j,t)),c.title=p,a.mobile.activePage=b,this.activePage=b,h.reverse=h.reverse||0>o,u=a.Deferred(),this._cssTransition(b,i,{transition:h.transition,reverse:h.reverse,deferred:u}),u.done(a.proxy(function(c,d,e,f,i){a.mobile.removeActiveLinkClass(),h.duplicateCachedPage&&h.duplicateCachedPage.remove(),i||a.mobile.focusPage(b),this._releaseTransitionLock(),this._triggerWithDeprecated("transition",g),this._triggerWithDeprecated("change",g)},this))}},_findBaseWithDefault:function(){var b=this.activePage&&a.mobile.getClosestBaseUrl(this.activePage);return b||a.mobile.path.documentBase.hrefNoHash}}),a.mobile.navreadyDeferred=a.Deferred();var e=[],f=!1}(a),function(a,d){function e(a){for(;a&&("string"!=typeof a.nodeName||"a"!==a.nodeName.toLowerCase());)a=a.parentNode;return a}var f=a.Deferred(),g=a.Deferred(),h=function(){g.resolve(),g=null},i=a.mobile.path.documentUrl,j=null;a.mobile.loadPage=function(b,c){var d;return c=c||{},d=c.pageContainer||a.mobile.pageContainer,c.deferred=a.Deferred(),d.pagecontainer("load",b,c),c.deferred.promise()},a.mobile.back=function(){var c=b.navigator;this.phonegapNavigationEnabled&&c&&c.app&&c.app.backHistory?c.app.backHistory():a.mobile.pageContainer.pagecontainer("back")},a.mobile.focusPage=function(a){var b=a.find("[autofocus]"),c=a.find(".ui-title:eq(0)");return b.length?void b.focus():void(c.length?c.focus():a.focus())},a.mobile._maybeDegradeTransition=a.mobile._maybeDegradeTransition||function(a){return a},a.mobile.changePage=function(b,c){a.mobile.pageContainer.pagecontainer("change",b,c)},a.mobile.changePage.defaults={transition:d,reverse:!1,changeHash:!0,fromHashChange:!1,role:d,duplicateCachedPage:d,pageContainer:d,showLoadMsg:!0,dataUrl:d,fromPage:d,allowSamePageTransition:!1},a.mobile._registerInternalEvents=function(){var c=function(b,c){var d,e,f,g,h=!0;return!(!a.mobile.ajaxEnabled||b.is(":jqmData(ajax='false')")||!b.jqmHijackable().length||b.attr("target"))&&(d=j&&j.attr("formaction")||b.attr("action"),g=(b.attr("method")||"get").toLowerCase(),d||(d=a.mobile.getClosestBaseUrl(b),"get"===g&&(d=a.mobile.path.parseUrl(d).hrefNoSearch),d===a.mobile.path.documentBase.hrefNoHash&&(d=i.hrefNoSearch)),d=a.mobile.path.makeUrlAbsolute(d,a.mobile.getClosestBaseUrl(b)),!(a.mobile.path.isExternal(d)&&!a.mobile.path.isPermittedCrossDomainRequest(i,d))&&(c||(e=b.serializeArray(),j&&j[0].form===b[0]&&(f=j.attr("name"),f&&(a.each(e,function(a,b){return b.name===f?(f="",!1):void 0}),f&&e.push({name:f,value:j.attr("value")}))),h={url:d,options:{type:g,data:a.param(e),transition:b.jqmData("transition"),reverse:"reverse"===b.jqmData("direction"),reloadPage:!0}}),h))};a.mobile.document.delegate("form","submit",function(b){var d;b.isDefaultPrevented()||(d=c(a(this)),d&&(a.mobile.changePage(d.url,d.options),b.preventDefault()))}),a.mobile.document.bind("vclick",function(b){var d,f,g=b.target,h=!1;if(!(b.which>1)&&a.mobile.linkBindingEnabled){if(j=a(g),a.data(g,"mobile-button")){if(!c(a(g).closest("form"),!0))return;g.parentNode&&(g=g.parentNode)}else{if(g=e(g),!g||"#"===a.mobile.path.parseUrl(g.getAttribute("href")||"#").hash)return;if(!a(g).jqmHijackable().length)return}~g.className.indexOf("ui-link-inherit")?g.parentNode&&(f=a.data(g.parentNode,"buttonElements")):f=a.data(g,"buttonElements"),f?g=f.outer:h=!0,d=a(g),h&&(d=d.closest(".ui-btn")),d.length>0&&!d.hasClass("ui-state-disabled")&&(a.mobile.removeActiveLinkClass(!0),a.mobile.activeClickedLink=d,a.mobile.activeClickedLink.addClass(a.mobile.activeBtnClass))}}),a.mobile.document.bind("click",function(c){if(a.mobile.linkBindingEnabled&&!c.isDefaultPrevented()){var f,g,h,j,k,l,m,n=e(c.target),o=a(n),p=function(){b.setTimeout(function(){a.mobile.removeActiveLinkClass(!0)},200)};if(a.mobile.activeClickedLink&&a.mobile.activeClickedLink[0]===c.target.parentNode&&p(),n&&!(c.which>1)&&o.jqmHijackable().length){if(o.is(":jqmData(rel='back')"))return a.mobile.back(),!1;if(f=a.mobile.getClosestBaseUrl(o),g=a.mobile.path.makeUrlAbsolute(o.attr("href")||"#",f),!a.mobile.ajaxEnabled&&!a.mobile.path.isEmbeddedPage(g))return void p();if(!(-1===g.search("#")||a.mobile.path.isExternal(g)&&a.mobile.path.isAbsoluteUrl(g))){if(g=g.replace(/[^#]*#/,""),!g)return void c.preventDefault();g=a.mobile.path.isPath(g)?a.mobile.path.makeUrlAbsolute(g,f):a.mobile.path.makeUrlAbsolute("#"+g,i.hrefNoHash)}if(h=o.is("[rel='external']")||o.is(":jqmData(ajax='false')")||o.is("[target]"),j=h||a.mobile.path.isExternal(g)&&!a.mobile.path.isPermittedCrossDomainRequest(i,g))return void p();k=o.jqmData("transition"),l="reverse"===o.jqmData("direction")||o.jqmData("back"),m=o.attr("data-"+a.mobile.ns+"rel")||d,a.mobile.changePage(g,{transition:k,reverse:l,role:m,link:o}),c.preventDefault()}}}),a.mobile.document.delegate(".ui-page","pageshow.prefetch",function(){var b=[];a(this).find("a:jqmData(prefetch)").each(function(){var c=a(this),d=c.attr("href");d&&-1===a.inArray(d,b)&&(b.push(d),a.mobile.loadPage(d,{role:c.attr("data-"+a.mobile.ns+"rel"),prefetch:!0}))})}),a.mobile.pageContainer.pagecontainer(),a.mobile.document.bind("pageshow",function(){g?g.done(a.mobile.resetActivePageHeight):a.mobile.resetActivePageHeight()}),a.mobile.window.bind("throttledresize",a.mobile.resetActivePageHeight)},a(function(){f.resolve()}),"complete"===c.readyState?h():a.mobile.window.load(h),a.when(f,a.mobile.navreadyDeferred).done(function(){a.mobile._registerInternalEvents()})}(a),function(a,b){a.mobile.Transition=function(){this.init.apply(this,arguments)},a.extend(a.mobile.Transition.prototype,{toPreClass:" ui-page-pre-in",init:function(b,c,d,e){a.extend(this,{name:b,reverse:c,$to:d,$from:e,deferred:new a.Deferred})},cleanFrom:function(){this.$from.removeClass(a.mobile.activePageClass+" out in reverse "+this.name).height("")},beforeDoneIn:function(){},beforeDoneOut:function(){},beforeStartOut:function(){},doneIn:function(){this.beforeDoneIn(),this.$to.removeClass("out in reverse "+this.name).height(""),this.toggleViewportClass(),a.mobile.window.scrollTop()!==this.toScroll&&this.scrollPage(),this.sequential||this.$to.addClass(a.mobile.activePageClass),this.deferred.resolve(this.name,this.reverse,this.$to,this.$from,!0)},doneOut:function(a,b,c,d){this.beforeDoneOut(),this.startIn(a,b,c,d)},hideIn:function(a){this.$to.css("z-index",-10),a.call(this),this.$to.css("z-index","")},scrollPage:function(){a.event.special.scrollstart.enabled=!1,(a.mobile.hideUrlBar||this.toScroll!==a.mobile.defaultHomeScroll)&&b.scrollTo(0,this.toScroll),setTimeout(function(){a.event.special.scrollstart.enabled=!0},150)},startIn:function(b,c,d,e){this.hideIn(function(){this.$to.addClass(a.mobile.activePageClass+this.toPreClass),e||a.mobile.focusPage(this.$to),this.$to.height(b+this.toScroll),d||this.scrollPage()}),this.$to.removeClass(this.toPreClass).addClass(this.name+" in "+c),d?this.doneIn():this.$to.animationComplete(a.proxy(function(){this.doneIn()},this))},startOut:function(b,c,d){this.beforeStartOut(b,c,d),this.$from.height(b+a.mobile.window.scrollTop()).addClass(this.name+" out"+c)},toggleViewportClass:function(){a.mobile.pageContainer.toggleClass("ui-mobile-viewport-transitioning viewport-"+this.name)},transition:function(){var b,c=this.reverse?" reverse":"",d=a.mobile.getScreenHeight(),e=a.mobile.maxTransitionWidth!==!1&&a.mobile.window.width()>a.mobile.maxTransitionWidth;return this.toScroll=a.mobile.navigate.history.getActive().lastScroll||a.mobile.defaultHomeScroll,b=!a.support.cssTransitions||!a.support.cssAnimations||e||!this.name||"none"===this.name||Math.max(a.mobile.window.scrollTop(),this.toScroll)>a.mobile.getMaxScrollForTransition(),this.toggleViewportClass(),this.$from&&!b?this.startOut(d,c,b):this.doneOut(d,c,b,!0),this.deferred.promise()}})}(a,this),function(a){a.mobile.SerialTransition=function(){this.init.apply(this,arguments)},a.extend(a.mobile.SerialTransition.prototype,a.mobile.Transition.prototype,{sequential:!0,beforeDoneOut:function(){this.$from&&this.cleanFrom()},beforeStartOut:function(b,c,d){this.$from.animationComplete(a.proxy(function(){this.doneOut(b,c,d)},this))}})}(a),function(a){a.mobile.ConcurrentTransition=function(){this.init.apply(this,arguments)},a.extend(a.mobile.ConcurrentTransition.prototype,a.mobile.Transition.prototype,{sequential:!1,beforeDoneIn:function(){this.$from&&this.cleanFrom()},beforeStartOut:function(a,b,c){this.doneOut(a,b,c)}})}(a),function(a){var b=function(){return 3*a.mobile.getScreenHeight()};a.mobile.transitionHandlers={sequential:a.mobile.SerialTransition,simultaneous:a.mobile.ConcurrentTransition},a.mobile.defaultTransitionHandler=a.mobile.transitionHandlers.sequential,a.mobile.transitionFallbacks={},a.mobile._maybeDegradeTransition=function(b){return b&&!a.support.cssTransform3d&&a.mobile.transitionFallbacks[b]&&(b=a.mobile.transitionFallbacks[b]),b},a.mobile.getMaxScrollForTransition=a.mobile.getMaxScrollForTransition||b}(a),function(a){a.mobile.transitionFallbacks.flip="fade"}(a,this),function(a){a.mobile.transitionFallbacks.flow="fade"}(a,this),function(a){a.mobile.transitionFallbacks.pop="fade"}(a,this),function(a){a.mobile.transitionHandlers.slide=a.mobile.transitionHandlers.simultaneous,a.mobile.transitionFallbacks.slide="fade"}(a,this),function(a){a.mobile.transitionFallbacks.slidedown="fade"}(a,this),function(a){a.mobile.transitionFallbacks.slidefade="fade"}(a,this),function(a){a.mobile.transitionFallbacks.slideup="fade"}(a,this),function(a){a.mobile.transitionFallbacks.turn="fade"}(a,this),function(a){a.mobile.degradeInputs={color:!1,date:!1,datetime:!1,"datetime-local":!1,email:!1,month:!1,number:!1,range:"number",search:"text",tel:!1,time:!1,url:!1,week:!1},a.mobile.page.prototype.options.degradeInputs=a.mobile.degradeInputs,a.mobile.degradeInputsWithin=function(b){b=a(b),b.find("input").not(a.mobile.page.prototype.keepNativeSelector()).each(function(){var b,c,d,e,f=a(this),g=this.getAttribute("type"),h=a.mobile.degradeInputs[g]||"text";a.mobile.degradeInputs[g]&&(b=a("<div>").html(f.clone()).html(),c=b.indexOf(" type=")>-1,d=c?/\s+type=["']?\w+['"]?/:/\/?>/,e=' type="'+h+'" data-'+a.mobile.ns+'type="'+g+'"'+(c?"":">"),f.replaceWith(b.replace(d,e)))})}}(a),function(a,b,c){a.widget("mobile.page",a.mobile.page,{options:{closeBtn:"left",closeBtnText:"Close",overlayTheme:"a",corners:!0,dialog:!1},_create:function(){this._super(),this.options.dialog&&(a.extend(this,{_inner:this.element.children(),_headerCloseButton:null}),this.options.enhanced||this._setCloseBtn(this.options.closeBtn))},_enhance:function(){this._super(),this.options.dialog&&this.element.addClass("ui-dialog").wrapInner(a("<div/>",{role:"dialog",class:"ui-dialog-contain ui-overlay-shadow"+(this.options.corners?" ui-corner-all":"")}))},_setOptions:function(b){var d,e,f=this.options;b.corners!==c&&this._inner.toggleClass("ui-corner-all",!!b.corners),b.overlayTheme!==c&&a.mobile.activePage[0]===this.element[0]&&(f.overlayTheme=b.overlayTheme,this._handlePageBeforeShow()),b.closeBtnText!==c&&(d=f.closeBtn,e=b.closeBtnText),b.closeBtn!==c&&(d=b.closeBtn),d&&this._setCloseBtn(d,e),this._super(b)},_handlePageBeforeShow:function(){this.options.overlayTheme&&this.options.dialog?(this.removeContainerBackground(),this.setContainerBackground(this.options.overlayTheme)):this._super()},_setCloseBtn:function(b,c){var d,e=this._headerCloseButton;b="left"===b?"left":"right"===b?"right":"none","none"===b?e&&(e.remove(),e=null):e?(e.removeClass("ui-btn-left ui-btn-right").addClass("ui-btn-"+b),c&&e.text(c)):(d=this._inner.find(":jqmData(role='header')").first(),e=a("<a></a>",{href:"#",class:"ui-btn ui-corner-all ui-icon-delete ui-btn-icon-notext ui-btn-"+b}).attr("data-"+a.mobile.ns+"rel","back").text(c||this.options.closeBtnText||"").prependTo(d)),this._headerCloseButton=e}})}(a,this),function(a,b,c){a.widget("mobile.dialog",{options:{closeBtn:"left",closeBtnText:"Close",overlayTheme:"a",corners:!0},_handlePageBeforeShow:function(){this._isCloseable=!0,this.options.overlayTheme&&this.element.page("removeContainerBackground").page("setContainerBackground",this.options.overlayTheme)},_handlePageBeforeHide:function(){this._isCloseable=!1},_handleVClickSubmit:function(b){var c,d=a(b.target).closest("vclick"===b.type?"a":"form");d.length&&!d.jqmData("transition")&&(c={},c["data-"+a.mobile.ns+"transition"]=(a.mobile.navigate.history.getActive()||{}).transition||a.mobile.defaultDialogTransition,c["data-"+a.mobile.ns+"direction"]="reverse",d.attr(c))},_create:function(){var b=this.element,c=this.options;b.addClass("ui-dialog").wrapInner(a("<div/>",{role:"dialog",class:"ui-dialog-contain ui-overlay-shadow"+(c.corners?" ui-corner-all":"")})),a.extend(this,{_isCloseable:!1,_inner:b.children(),_headerCloseButton:null}),this._on(b,{vclick:"_handleVClickSubmit",submit:"_handleVClickSubmit",pagebeforeshow:"_handlePageBeforeShow",pagebeforehide:"_handlePageBeforeHide"}),this._setCloseBtn(c.closeBtn)},_setOptions:function(b){var d,e,f=this.options;b.corners!==c&&this._inner.toggleClass("ui-corner-all",!!b.corners),b.overlayTheme!==c&&a.mobile.activePage[0]===this.element[0]&&(f.overlayTheme=b.overlayTheme,this._handlePageBeforeShow()),b.closeBtnText!==c&&(d=f.closeBtn,e=b.closeBtnText),b.closeBtn!==c&&(d=b.closeBtn),d&&this._setCloseBtn(d,e),this._super(b)},_setCloseBtn:function(b,c){var d,e=this._headerCloseButton;b="left"===b?"left":"right"===b?"right":"none","none"===b?e&&(e.remove(),e=null):e?(e.removeClass("ui-btn-left ui-btn-right").addClass("ui-btn-"+b),c&&e.text(c)):(d=this._inner.find(":jqmData(role='header')").first(),e=a("<a></a>",{role:"button",href:"#",class:"ui-btn ui-corner-all ui-icon-delete ui-btn-icon-notext ui-btn-"+b}).text(c||this.options.closeBtnText||"").prependTo(d),this._on(e,{click:"close"})),this._headerCloseButton=e},close:function(){var b=a.mobile.navigate.history;this._isCloseable&&(this._isCloseable=!1,a.mobile.hashListeningEnabled&&b.activeIndex>0?a.mobile.back():a.mobile.pageContainer.pagecontainer("back"))}})}(a,this),function(a,b){var c=/([A-Z])/g,d=function(a){return"ui-btn-icon-"+(null===a?"left":a)};a.widget("mobile.collapsible",{options:{enhanced:!1,expandCueText:null,collapseCueText:null,collapsed:!0,heading:"h1,h2,h3,h4,h5,h6,legend",collapsedIcon:null,expandedIcon:null,iconpos:null,theme:null,contentTheme:null,inset:null,corners:null,mini:null},_create:function(){var b=this.element,c={accordion:b.closest(":jqmData(role='collapsible-set'),:jqmData(role='collapsibleset')"+(a.mobile.collapsibleset?", :mobile-collapsibleset":"")).addClass("ui-collapsible-set")};this._ui=c,this._renderedOptions=this._getOptions(this.options),this.options.enhanced?(c.heading=this.element.children(".ui-collapsible-heading"),c.content=c.heading.next(),c.anchor=c.heading.children(),c.status=c.anchor.children(".ui-collapsible-heading-status")):this._enhance(b,c),this._on(c.heading,{tap:function(){c.heading.find("a").first().addClass(a.mobile.activeBtnClass)},click:function(a){this._handleExpandCollapse(!c.heading.hasClass("ui-collapsible-heading-collapsed")),a.preventDefault(),a.stopPropagation()}})},_getOptions:function(b){var d,e=this._ui.accordion,f=this._ui.accordionWidget;b=a.extend({},b),e.length&&!f&&(this._ui.accordionWidget=f=e.data("mobile-collapsibleset"));for(d in b)b[d]=null!=b[d]?b[d]:f?f.options[d]:e.length?a.mobile.getAttribute(e[0],d.replace(c,"-$1").toLowerCase()):null,null==b[d]&&(b[d]=a.mobile.collapsible.defaults[d]);return b},_themeClassFromOption:function(a,b){return b?"none"===b?"":a+b:""},_enhance:function(b,c){var e,f=this._renderedOptions,g=this._themeClassFromOption("ui-body-",f.contentTheme);return b.addClass("ui-collapsible "+(f.inset?"ui-collapsible-inset ":"")+(f.inset&&f.corners?"ui-corner-all ":"")+(g?"ui-collapsible-themed-content ":"")),c.originalHeading=b.children(this.options.heading).first(),c.content=b.wrapInner("<div class='ui-collapsible-content "+g+"'></div>").children(".ui-collapsible-content"),c.heading=c.originalHeading,c.heading.is("legend")&&(c.heading=a("<div role='heading'>"+c.heading.html()+"</div>"),c.placeholder=a("<div><!-- placeholder for legend --></div>").insertBefore(c.originalHeading),c.originalHeading.remove()),e=f.collapsed?f.collapsedIcon?"ui-icon-"+f.collapsedIcon:"":f.expandedIcon?"ui-icon-"+f.expandedIcon:"",c.status=a("<span class='ui-collapsible-heading-status'></span>"),c.anchor=c.heading.detach().addClass("ui-collapsible-heading").append(c.status).wrapInner("<a href='#' class='ui-collapsible-heading-toggle'></a>").find("a").first().addClass("ui-btn "+(e?e+" ":"")+(e?d(f.iconpos)+" ":"")+this._themeClassFromOption("ui-btn-",f.theme)+" "+(f.mini?"ui-mini ":"")),c.heading.insertBefore(c.content),this._handleExpandCollapse(this.options.collapsed),c},refresh:function(){this._applyOptions(this.options),this._renderedOptions=this._getOptions(this.options)},_applyOptions:function(a){var c,e,f,g,h,i=this.element,j=this._renderedOptions,k=this._ui,l=k.anchor,m=k.status,n=this._getOptions(a);a.collapsed!==b&&this._handleExpandCollapse(a.collapsed),c=i.hasClass("ui-collapsible-collapsed"),c?n.expandCueText!==b&&m.text(n.expandCueText):n.collapseCueText!==b&&m.text(n.collapseCueText),h=n.collapsedIcon!==b?n.collapsedIcon!==!1:j.collapsedIcon!==!1,(n.iconpos!==b||n.collapsedIcon!==b||n.expandedIcon!==b)&&(l.removeClass([d(j.iconpos)].concat(j.expandedIcon?["ui-icon-"+j.expandedIcon]:[]).concat(j.collapsedIcon?["ui-icon-"+j.collapsedIcon]:[]).join(" ")),h&&l.addClass([d(n.iconpos!==b?n.iconpos:j.iconpos)].concat(c?["ui-icon-"+(n.collapsedIcon!==b?n.collapsedIcon:j.collapsedIcon)]:["ui-icon-"+(n.expandedIcon!==b?n.expandedIcon:j.expandedIcon)]).join(" "))),n.theme!==b&&(f=this._themeClassFromOption("ui-btn-",j.theme),e=this._themeClassFromOption("ui-btn-",n.theme),l.removeClass(f).addClass(e)),n.contentTheme!==b&&(f=this._themeClassFromOption("ui-body-",j.contentTheme),e=this._themeClassFromOption("ui-body-",n.contentTheme),k.content.removeClass(f).addClass(e)),n.inset!==b&&(i.toggleClass("ui-collapsible-inset",n.inset),g=!(!n.inset||!n.corners&&!j.corners)),n.corners!==b&&(g=!(!n.corners||!n.inset&&!j.inset)),g!==b&&i.toggleClass("ui-corner-all",g),n.mini!==b&&l.toggleClass("ui-mini",n.mini)},_setOptions:function(a){this._applyOptions(a),this._super(a),this._renderedOptions=this._getOptions(this.options)},_handleExpandCollapse:function(b){var c=this._renderedOptions,d=this._ui;d.status.text(b?c.expandCueText:c.collapseCueText),d.heading.toggleClass("ui-collapsible-heading-collapsed",b).find("a").first().toggleClass("ui-icon-"+c.expandedIcon,!b).toggleClass("ui-icon-"+c.collapsedIcon,b||c.expandedIcon===c.collapsedIcon).removeClass(a.mobile.activeBtnClass),this.element.toggleClass("ui-collapsible-collapsed",b),d.content.toggleClass("ui-collapsible-content-collapsed",b).attr("aria-hidden",b).trigger("updatelayout"),this.options.collapsed=b,this._trigger(b?"collapse":"expand")},expand:function(){this._handleExpandCollapse(!1)},collapse:function(){this._handleExpandCollapse(!0)},_destroy:function(){var a=this._ui,b=this.options;b.enhanced||(a.placeholder?(a.originalHeading.insertBefore(a.placeholder),a.placeholder.remove(),a.heading.remove()):(a.status.remove(),a.heading.removeClass("ui-collapsible-heading ui-collapsible-heading-collapsed").children().contents().unwrap()),a.anchor.contents().unwrap(),a.content.contents().unwrap(),this.element.removeClass("ui-collapsible ui-collapsible-collapsed ui-collapsible-themed-content ui-collapsible-inset ui-corner-all"))}}),a.mobile.collapsible.defaults={expandCueText:" click to expand contents",collapseCueText:" click to collapse contents",collapsedIcon:"plus",contentTheme:"inherit",expandedIcon:"minus",iconpos:"left",inset:!0,corners:!0,theme:"inherit",mini:!1}}(a),function(a){function b(b){var d,e=b.length,f=[];for(d=0;e>d;d++)b[d].className.match(c)||f.push(b[d]);return a(f)}var c=/\bui-screen-hidden\b/;a.mobile.behaviors.addFirstLastClasses={_getVisibles:function(a,c){var d;return c?d=b(a):(d=a.filter(":visible"),0===d.length&&(d=b(a))),d},_addFirstLastClasses:function(a,b,c){a.removeClass("ui-first-child ui-last-child"),b.eq(0).addClass("ui-first-child").end().last().addClass("ui-last-child"),c||this.element.trigger("updatelayout")},_removeFirstLastClasses:function(a){a.removeClass("ui-first-child ui-last-child")}}}(a),function(a,b){var c=":mobile-collapsible, "+a.mobile.collapsible.initSelector;a.widget("mobile.collapsibleset",a.extend({initSelector:":jqmData(role='collapsible-set'),:jqmData(role='collapsibleset')",options:a.extend({enhanced:!1},a.mobile.collapsible.defaults),_handleCollapsibleExpand:function(b){var c=a(b.target).closest(".ui-collapsible");c.parent().is(":mobile-collapsibleset, :jqmData(role='collapsible-set')")&&c.siblings(".ui-collapsible:not(.ui-collapsible-collapsed)").collapsible("collapse")},_create:function(){var b=this.element,c=this.options;a.extend(this,{_classes:""}),c.enhanced||(b.addClass("ui-collapsible-set "+this._themeClassFromOption("ui-group-theme-",c.theme)+" "+(c.corners&&c.inset?"ui-corner-all ":"")),this.element.find(a.mobile.collapsible.initSelector).collapsible()),this._on(b,{collapsibleexpand:"_handleCollapsibleExpand"})},_themeClassFromOption:function(a,b){return b?"none"===b?"":a+b:""},_init:function(){this._refresh(!0),this.element.children(c).filter(":jqmData(collapsed='false')").collapsible("expand")},_setOptions:function(a){var c,d,e=this.element,f=this._themeClassFromOption("ui-group-theme-",a.theme);return f&&e.removeClass(this._themeClassFromOption("ui-group-theme-",this.options.theme)).addClass(f),a.inset!==b&&(d=!(!a.inset||!a.corners&&!this.options.corners)),a.corners!==b&&(d=!(!a.corners||!a.inset&&!this.options.inset)),d!==b&&e.toggleClass("ui-corner-all",d),c=this._super(a),this.element.children(":mobile-collapsible").collapsible("refresh"),c},_destroy:function(){var a=this.element;this._removeFirstLastClasses(a.children(c)),a.removeClass("ui-collapsible-set ui-corner-all "+this._themeClassFromOption("ui-group-theme-",this.options.theme)).children(":mobile-collapsible").collapsible("destroy")},_refresh:function(b){var d=this.element.children(c);this.element.find(a.mobile.collapsible.initSelector).not(".ui-collapsible").collapsible(),this._addFirstLastClasses(d,this._getVisibles(d,b),b)},refresh:function(){this._refresh(!1)}},a.mobile.behaviors.addFirstLastClasses))}(a),function(a){a.fn.fieldcontain=function(){return this.addClass("ui-field-contain")}}(a),function(a){a.fn.grid=function(b){return this.each(function(){var c,d,e=a(this),f=a.extend({grid:null},b),g=e.children(),h={solo:1,a:2,b:3,c:4,d:5},i=f.grid;if(!i)if(g.length<=5)for(d in h)h[d]===g.length&&(i=d);else i="a",e.addClass("ui-grid-duo");c=h[i],e.addClass("ui-grid-"+i),g.filter(":nth-child("+c+"n+1)").addClass("ui-block-a"),c>1&&g.filter(":nth-child("+c+"n+2)").addClass("ui-block-b"),c>2&&g.filter(":nth-child("+c+"n+3)").addClass("ui-block-c"),c>3&&g.filter(":nth-child("+c+"n+4)").addClass("ui-block-d"),
c>4&&g.filter(":nth-child("+c+"n+5)").addClass("ui-block-e")})}}(a),function(a,b){a.widget("mobile.navbar",{options:{iconpos:"top",grid:null},_create:function(){var d=this.element,e=d.find("a, button"),f=e.filter(":jqmData(icon)").length?this.options.iconpos:b;d.addClass("ui-navbar").attr("role","navigation").find("ul").jqmEnhanceable().grid({grid:this.options.grid}),e.each(function(){var b=a.mobile.getAttribute(this,"icon"),c=a.mobile.getAttribute(this,"theme"),d="ui-btn";c&&(d+=" ui-btn-"+c),b&&(d+=" ui-icon-"+b+" ui-btn-icon-"+f),a(this).addClass(d)}),d.delegate("a","vclick",function(){var b=a(this);b.hasClass("ui-state-disabled")||b.hasClass("ui-disabled")||b.hasClass(a.mobile.activeBtnClass)||(e.removeClass(a.mobile.activeBtnClass),b.addClass(a.mobile.activeBtnClass),a(c).one("pagehide",function(){b.removeClass(a.mobile.activeBtnClass)}))}),d.closest(".ui-page").bind("pagebeforeshow",function(){e.filter(".ui-state-persist").addClass(a.mobile.activeBtnClass)})}})}(a),function(a){var b=a.mobile.getAttribute;a.widget("mobile.listview",a.extend({options:{theme:null,countTheme:null,dividerTheme:null,icon:"carat-r",splitIcon:"carat-r",splitTheme:null,corners:!0,shadow:!0,inset:!1},_create:function(){var a=this,b="";b+=a.options.inset?" ui-listview-inset":"",a.options.inset&&(b+=a.options.corners?" ui-corner-all":"",b+=a.options.shadow?" ui-shadow":""),a.element.addClass(" ui-listview"+b),a.refresh(!0)},_findFirstElementByTagName:function(a,b,c,d){var e={};for(e[c]=e[d]=!0;a;){if(e[a.nodeName])return a;a=a[b]}return null},_addThumbClasses:function(b){var c,d,e=b.length;for(c=0;e>c;c++)d=a(this._findFirstElementByTagName(b[c].firstChild,"nextSibling","img","IMG")),d.length&&a(this._findFirstElementByTagName(d[0].parentNode,"parentNode","li","LI")).addClass(d.hasClass("ui-li-icon")?"ui-li-has-icon":"ui-li-has-thumb")},_getChildrenByTagName:function(b,c,d){var e=[],f={};for(f[c]=f[d]=!0,b=b.firstChild;b;)f[b.nodeName]&&e.push(b),b=b.nextSibling;return a(e)},_beforeListviewRefresh:a.noop,_afterListviewRefresh:a.noop,refresh:function(c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=this.options,y=this.element,z=!!a.nodeName(y[0],"ol"),A=y.attr("start"),B={},C=y.find(".ui-li-count"),D=b(y[0],"counttheme")||this.options.countTheme,E=D?"ui-body-"+D:"ui-body-inherit";for(x.theme&&y.addClass("ui-group-theme-"+x.theme),z&&(A||0===A)&&(n=parseInt(A,10)-1,y.css("counter-reset","listnumbering "+n)),this._beforeListviewRefresh(),w=this._getChildrenByTagName(y[0],"li","LI"),e=0,f=w.length;f>e;e++)g=w.eq(e),h="",(c||g[0].className.search(/\bui-li-static\b|\bui-li-divider\b/)<0)&&(l=this._getChildrenByTagName(g[0],"a","A"),m="list-divider"===b(g[0],"role"),p=g.attr("value"),i=b(g[0],"theme"),l.length&&l[0].className.search(/\bui-btn\b/)<0&&!m?(j=b(g[0],"icon"),k=j!==!1&&(j||x.icon),l.removeClass("ui-link"),d="ui-btn",i&&(d+=" ui-btn-"+i),l.length>1?(h="ui-li-has-alt",q=l.last(),r=b(q[0],"theme")||x.splitTheme||b(g[0],"theme",!0),s=r?" ui-btn-"+r:"",t=b(q[0],"icon")||b(g[0],"icon")||x.splitIcon,u="ui-btn ui-btn-icon-notext ui-icon-"+t+s,q.attr("title",a.trim(q.getEncodedText())).addClass(u).empty(),l=l.first()):k&&(d+=" ui-btn-icon-right ui-icon-"+k),l.addClass(d)):m?(v=b(g[0],"theme")||x.dividerTheme||x.theme,h="ui-li-divider ui-bar-"+(v?v:"inherit"),g.attr("role","heading")):l.length<=0&&(h="ui-li-static ui-body-"+(i?i:"inherit")),z&&p&&(o=parseInt(p,10)-1,g.css("counter-reset","listnumbering "+o))),B[h]||(B[h]=[]),B[h].push(g[0]);for(h in B)a(B[h]).addClass(h);C.each(function(){a(this).closest("li").addClass("ui-li-has-count")}),E&&C.not("[class*='ui-body-']").addClass(E),this._addThumbClasses(w),this._addThumbClasses(w.find(".ui-btn")),this._afterListviewRefresh(),this._addFirstLastClasses(w,this._getVisibles(w,c),c)}},a.mobile.behaviors.addFirstLastClasses))}(a),function(a){function b(b){var c=a.trim(b.text())||null;return c?c=c.slice(0,1).toUpperCase():null}a.widget("mobile.listview",a.mobile.listview,{options:{autodividers:!1,autodividersSelector:b},_beforeListviewRefresh:function(){this.options.autodividers&&(this._replaceDividers(),this._superApply(arguments))},_replaceDividers:function(){var b,d,e,f,g,h=null,i=this.element;for(i.children("li:jqmData(role='list-divider')").remove(),d=i.children("li"),b=0;b<d.length;b++)e=d[b],f=this.options.autodividersSelector(a(e)),f&&h!==f&&(g=c.createElement("li"),g.appendChild(c.createTextNode(f)),g.setAttribute("data-"+a.mobile.ns+"role","list-divider"),e.parentNode.insertBefore(g,e)),h=f}})}(a),function(a){var b=/(^|\s)ui-li-divider($|\s)/,c=/(^|\s)ui-screen-hidden($|\s)/;a.widget("mobile.listview",a.mobile.listview,{options:{hideDividers:!1},_afterListviewRefresh:function(){var a,d,e,f=!0;if(this._superApply(arguments),this.options.hideDividers)for(a=this._getChildrenByTagName(this.element[0],"li","LI"),d=a.length-1;d>-1;d--)e=a[d],e.className.match(b)?(f&&(e.className=e.className+" ui-screen-hidden"),f=!0):e.className.match(c)||(f=!1)}})}(a),function(a){a.mobile.nojs=function(b){a(":jqmData(role='nojs')",b).addClass("ui-nojs")}}(a),function(a){a.mobile.behaviors.formReset={_handleFormReset:function(){this._on(this.element.closest("form"),{reset:function(){this._delay("_reset")}})}}}(a),function(a,b){var c=a.mobile.path.hashToSelector;a.widget("mobile.checkboxradio",a.extend({initSelector:"input:not( :jqmData(role='flipswitch' ) )[type='checkbox'],input[type='radio']:not( :jqmData(role='flipswitch' ))",options:{theme:"inherit",mini:!1,wrapperClass:null,enhanced:!1,iconpos:"left"},_create:function(){var b=this.element,c=this.options,d=function(a,b){return a.jqmData(b)||a.closest("form, fieldset").jqmData(b)},e=this.options.enhanced?{element:this.element.siblings("label"),isParent:!1}:this._findLabel(),f=b[0].type,g="ui-"+f+"-on",h="ui-"+f+"-off";("checkbox"===f||"radio"===f)&&(this.element[0].disabled&&(this.options.disabled=!0),c.iconpos=d(b,"iconpos")||e.element.attr("data-"+a.mobile.ns+"iconpos")||c.iconpos,c.mini=d(b,"mini")||c.mini,a.extend(this,{input:b,label:e.element,labelIsParent:e.isParent,inputtype:f,checkedClass:g,uncheckedClass:h}),this.options.enhanced||this._enhance(),this._on(e.element,{vmouseover:"_handleLabelVMouseOver",vclick:"_handleLabelVClick"}),this._on(b,{vmousedown:"_cacheVals",vclick:"_handleInputVClick",focus:"_handleInputFocus",blur:"_handleInputBlur"}),this._handleFormReset(),this.refresh())},_findLabel:function(){var b,d,e,f=this.element,g=f[0].labels;return g&&g.length>0?(d=a(g[0]),e=a.contains(d[0],f[0])):(b=f.closest("label"),e=b.length>0,d=e?b:a(this.document[0].getElementsByTagName("label")).filter("[for='"+c(f[0].id)+"']").first()),{element:d,isParent:e}},_enhance:function(){this.label.addClass("ui-btn ui-corner-all"),this.labelIsParent?this.input.add(this.label).wrapAll(this._wrapper()):(this.element.wrap(this._wrapper()),this.element.parent().prepend(this.label)),this._setOptions({theme:this.options.theme,iconpos:this.options.iconpos,mini:this.options.mini})},_wrapper:function(){return a("<div class='"+(this.options.wrapperClass?this.options.wrapperClass:"")+" ui-"+this.inputtype+(this.options.disabled?" ui-state-disabled":"")+"' ></div>")},_handleInputFocus:function(){this.label.addClass(a.mobile.focusClass)},_handleInputBlur:function(){this.label.removeClass(a.mobile.focusClass)},_handleInputVClick:function(){this.element.prop("checked",this.element.is(":checked")),this._getInputSet().not(this.element).prop("checked",!1),this._updateAll(!0)},_handleLabelVMouseOver:function(a){this.label.parent().hasClass("ui-state-disabled")&&a.stopPropagation()},_handleLabelVClick:function(a){var b=this.element;return b.is(":disabled")?void a.preventDefault():(this._cacheVals(),b.prop("checked","radio"===this.inputtype&&!0||!b.prop("checked")),b.triggerHandler("click"),this._getInputSet().not(b).prop("checked",!1),this._updateAll(),!1)},_cacheVals:function(){this._getInputSet().each(function(){a(this).attr("data-"+a.mobile.ns+"cacheVal",this.checked)})},_getInputSet:function(){var b,d,e=this.element[0],f=e.name,g=e.form,h=this.element.parents().last().get(0),i=this.element;return f&&"radio"===this.inputtype&&h&&(b="input[type='radio'][name='"+c(f)+"']",g?(d=g.getAttribute("id"),d&&(i=a(b+"[form='"+c(d)+"']",h)),i=a(g).find(b).filter(function(){return this.form===g}).add(i)):i=a(b,h).filter(function(){return!this.form})),i},_updateAll:function(b){var c=this;this._getInputSet().each(function(){var d=a(this);!this.checked&&"checkbox"!==c.inputtype||b||d.trigger("change")}).checkboxradio("refresh")},_reset:function(){this.refresh()},_hasIcon:function(){var b,c,d=a.mobile.controlgroup;return!(d&&(b=this.element.closest(":mobile-controlgroup,"+d.prototype.initSelector),b.length>0))||(c=a.data(b[0],"mobile-controlgroup"),"horizontal"!==(c?c.options.type:b.attr("data-"+a.mobile.ns+"type")))},refresh:function(){var b=this.element[0].checked,c=a.mobile.activeBtnClass,d="ui-btn-icon-"+this.options.iconpos,e=[],f=[];this._hasIcon()?(f.push(c),e.push(d)):(f.push(d),(b?e:f).push(c)),b?(e.push(this.checkedClass),f.push(this.uncheckedClass)):(e.push(this.uncheckedClass),f.push(this.checkedClass)),this.widget().toggleClass("ui-state-disabled",this.element.prop("disabled")),this.label.addClass(e.join(" ")).removeClass(f.join(" "))},widget:function(){return this.label.parent()},_setOptions:function(a){var c=this.label,d=this.options,e=this.widget(),f=this._hasIcon();a.disabled!==b&&(this.input.prop("disabled",!!a.disabled),e.toggleClass("ui-state-disabled",!!a.disabled)),a.mini!==b&&e.toggleClass("ui-mini",!!a.mini),a.theme!==b&&c.removeClass("ui-btn-"+d.theme).addClass("ui-btn-"+a.theme),a.wrapperClass!==b&&e.removeClass(d.wrapperClass).addClass(a.wrapperClass),a.iconpos!==b&&f?c.removeClass("ui-btn-icon-"+d.iconpos).addClass("ui-btn-icon-"+a.iconpos):f||c.removeClass("ui-btn-icon-"+d.iconpos),this._super(a)}},a.mobile.behaviors.formReset))}(a),function(a,b){a.widget("mobile.button",{initSelector:"input[type='button'], input[type='submit'], input[type='reset']",options:{theme:null,icon:null,iconpos:"left",iconshadow:!1,corners:!0,shadow:!0,inline:null,mini:null,wrapperClass:null,enhanced:!1},_create:function(){this.element.is(":disabled")&&(this.options.disabled=!0),this.options.enhanced||this._enhance(),a.extend(this,{wrapper:this.element.parent()}),this._on({focus:function(){this.widget().addClass(a.mobile.focusClass)},blur:function(){this.widget().removeClass(a.mobile.focusClass)}}),this.refresh(!0)},_enhance:function(){this.element.wrap(this._button())},_button:function(){var b=this.options,c=this._getIconClasses(this.options);return a("<div class='ui-btn ui-input-btn"+(b.wrapperClass?" "+b.wrapperClass:"")+(b.theme?" ui-btn-"+b.theme:"")+(b.corners?" ui-corner-all":"")+(b.shadow?" ui-shadow":"")+(b.inline?" ui-btn-inline":"")+(b.mini?" ui-mini":"")+(b.disabled?" ui-state-disabled":"")+(c?" "+c:"")+"' >"+this.element.val()+"</div>")},widget:function(){return this.wrapper},_destroy:function(){this.element.insertBefore(this.wrapper),this.wrapper.remove()},_getIconClasses:function(a){return a.icon?"ui-icon-"+a.icon+(a.iconshadow?" ui-shadow-icon":"")+" ui-btn-icon-"+a.iconpos:""},_setOptions:function(c){var d=this.widget();c.theme!==b&&d.removeClass(this.options.theme).addClass("ui-btn-"+c.theme),c.corners!==b&&d.toggleClass("ui-corner-all",c.corners),c.shadow!==b&&d.toggleClass("ui-shadow",c.shadow),c.inline!==b&&d.toggleClass("ui-btn-inline",c.inline),c.mini!==b&&d.toggleClass("ui-mini",c.mini),c.disabled!==b&&(this.element.prop("disabled",c.disabled),d.toggleClass("ui-state-disabled",c.disabled)),(c.icon!==b||c.iconshadow!==b||c.iconpos!==b)&&d.removeClass(this._getIconClasses(this.options)).addClass(this._getIconClasses(a.extend({},this.options,c))),this._super(c)},refresh:function(b){var c,d=this.element.prop("disabled");this.options.icon&&"notext"===this.options.iconpos&&this.element.attr("title")&&this.element.attr("title",this.element.val()),b||(c=this.element.detach(),a(this.wrapper).text(this.element.val()).append(c)),this.options.disabled!==d&&this._setOptions({disabled:d})}})}(a),function(a){var b=a("meta[name=viewport]"),c=b.attr("content"),d=c+",maximum-scale=1, user-scalable=no",e=c+",maximum-scale=10, user-scalable=yes",f=/(user-scalable[\s]*=[\s]*no)|(maximum-scale[\s]*=[\s]*1)[$,\s]/.test(c);a.mobile.zoom=a.extend({},{enabled:!f,locked:!1,disable:function(c){f||a.mobile.zoom.locked||(b.attr("content",d),a.mobile.zoom.enabled=!1,a.mobile.zoom.locked=c||!1)},enable:function(c){f||a.mobile.zoom.locked&&c!==!0||(b.attr("content",e),a.mobile.zoom.enabled=!0,a.mobile.zoom.locked=!1)},restore:function(){f||(b.attr("content",c),a.mobile.zoom.enabled=!0)}})}(a),function(a,b){a.widget("mobile.textinput",{initSelector:"input[type='text'],input[type='search'],:jqmData(type='search'),input[type='number'],:jqmData(type='number'),input[type='password'],input[type='email'],input[type='url'],input[type='tel'],textarea,input[type='time'],input[type='date'],input[type='month'],input[type='week'],input[type='datetime'],input[type='datetime-local'],input[type='color'],input:not([type]),input[type='file']",options:{theme:null,corners:!0,mini:!1,preventFocusZoom:/iPhone|iPad|iPod/.test(navigator.platform)&&navigator.userAgent.indexOf("AppleWebKit")>-1,wrapperClass:"",enhanced:!1},_create:function(){var b=this.options,c=this.element.is("[type='search'], :jqmData(type='search')"),d="TEXTAREA"===this.element[0].tagName,e=this.element.is("[data-"+(a.mobile.ns||"")+"type='range']"),f=(this.element.is("input")||this.element.is("[data-"+(a.mobile.ns||"")+"type='search']"))&&!e;this.element.prop("disabled")&&(b.disabled=!0),a.extend(this,{classes:this._classesFromOptions(),isSearch:c,isTextarea:d,isRange:e,inputNeedsWrap:f}),this._autoCorrect(),b.enhanced||this._enhance(),this._on({focus:"_handleFocus",blur:"_handleBlur"})},refresh:function(){this.setOptions({disabled:this.element.is(":disabled")})},_enhance:function(){var a=[];this.isTextarea&&a.push("ui-input-text"),(this.isTextarea||this.isRange)&&a.push("ui-shadow-inset"),this.inputNeedsWrap?this.element.wrap(this._wrap()):a=a.concat(this.classes),this.element.addClass(a.join(" "))},widget:function(){return this.inputNeedsWrap?this.element.parent():this.element},_classesFromOptions:function(){var a=this.options,b=[];return b.push("ui-body-"+(null===a.theme?"inherit":a.theme)),a.corners&&b.push("ui-corner-all"),a.mini&&b.push("ui-mini"),a.disabled&&b.push("ui-state-disabled"),a.wrapperClass&&b.push(a.wrapperClass),b},_wrap:function(){return a("<div class='"+(this.isSearch?"ui-input-search ":"ui-input-text ")+this.classes.join(" ")+" ui-shadow-inset'></div>")},_autoCorrect:function(){"undefined"==typeof this.element[0].autocorrect||a.support.touchOverflow||(this.element[0].setAttribute("autocorrect","off"),this.element[0].setAttribute("autocomplete","off"))},_handleBlur:function(){this.widget().removeClass(a.mobile.focusClass),this.options.preventFocusZoom&&a.mobile.zoom.enable(!0)},_handleFocus:function(){this.options.preventFocusZoom&&a.mobile.zoom.disable(!0),this.widget().addClass(a.mobile.focusClass)},_setOptions:function(a){var c=this.widget();this._super(a),(a.disabled!==b||a.mini!==b||a.corners!==b||a.theme!==b||a.wrapperClass!==b)&&(c.removeClass(this.classes.join(" ")),this.classes=this._classesFromOptions(),c.addClass(this.classes.join(" "))),a.disabled!==b&&this.element.prop("disabled",!!a.disabled)},_destroy:function(){this.options.enhanced||(this.inputNeedsWrap&&this.element.unwrap(),this.element.removeClass("ui-input-text "+this.classes.join(" ")))}})}(a),function(a,d){a.widget("mobile.slider",a.extend({initSelector:"input[type='range'], :jqmData(type='range'), :jqmData(role='slider')",widgetEventPrefix:"slide",options:{theme:null,trackTheme:null,corners:!0,mini:!1,highlight:!1},_create:function(){var e,f,g,h,i,j,k,l,m,n,o=this,p=this.element,q=this.options.trackTheme||a.mobile.getAttribute(p[0],"theme"),r=q?" ui-bar-"+q:" ui-bar-inherit",s=this.options.corners||p.jqmData("corners")?" ui-corner-all":"",t=this.options.mini||p.jqmData("mini")?" ui-mini":"",u=p[0].nodeName.toLowerCase(),v="select"===u,w=p.parent().is(":jqmData(role='rangeslider')"),x=v?"ui-slider-switch":"",y=p.attr("id"),z=a("[for='"+y+"']"),A=z.attr("id")||y+"-label",B=v?0:parseFloat(p.attr("min")),C=v?p.find("option").length-1:parseFloat(p.attr("max")),D=b.parseFloat(p.attr("step")||1),E=c.createElement("a"),F=a(E),G=c.createElement("div"),H=a(G),I=!(!this.options.highlight||v)&&function(){var b=c.createElement("div");return b.className="ui-slider-bg "+a.mobile.activeBtnClass,a(b).prependTo(H)}();if(z.attr("id",A),this.isToggleSwitch=v,E.setAttribute("href","#"),G.setAttribute("role","application"),G.className=[this.isToggleSwitch?"ui-slider ui-slider-track ui-shadow-inset ":"ui-slider-track ui-shadow-inset ",x,r,s,t].join(""),E.className="ui-slider-handle",G.appendChild(E),F.attr({role:"slider","aria-valuemin":B,"aria-valuemax":C,"aria-valuenow":this._value(),"aria-valuetext":this._value(),title:this._value(),"aria-labelledby":A}),a.extend(this,{slider:H,handle:F,control:p,type:u,step:D,max:C,min:B,valuebg:I,isRangeslider:w,dragging:!1,beforeStart:null,userModified:!1,mouseMoved:!1}),v){for(k=p.attr("tabindex"),k&&F.attr("tabindex",k),p.attr("tabindex","-1").focus(function(){a(this).blur(),F.focus()}),f=c.createElement("div"),f.className="ui-slider-inneroffset",g=0,h=G.childNodes.length;h>g;g++)f.appendChild(G.childNodes[g]);for(G.appendChild(f),F.addClass("ui-slider-handle-snapping"),e=p.find("option"),i=0,j=e.length;j>i;i++)l=i?"a":"b",m=i?" "+a.mobile.activeBtnClass:"",n=c.createElement("span"),n.className=["ui-slider-label ui-slider-label-",l,m].join(""),n.setAttribute("role","img"),n.appendChild(c.createTextNode(e[i].innerHTML)),a(n).prependTo(H);o._labels=a(".ui-slider-label",H)}p.addClass(v?"ui-slider-switch":"ui-slider-input"),this._on(p,{change:"_controlChange",keyup:"_controlKeyup",blur:"_controlBlur",vmouseup:"_controlVMouseUp"}),H.bind("vmousedown",a.proxy(this._sliderVMouseDown,this)).bind("vclick",!1),this._on(c,{vmousemove:"_preventDocumentDrag"}),this._on(H.add(c),{vmouseup:"_sliderVMouseUp"}),H.insertAfter(p),v||w||(f=this.options.mini?"<div class='ui-slider ui-mini'>":"<div class='ui-slider'>",p.add(H).wrapAll(f)),this._on(this.handle,{vmousedown:"_handleVMouseDown",keydown:"_handleKeydown",keyup:"_handleKeyup"}),this.handle.bind("vclick",!1),this._handleFormReset(),this.refresh(d,d,!0)},_setOptions:function(a){a.theme!==d&&this._setTheme(a.theme),a.trackTheme!==d&&this._setTrackTheme(a.trackTheme),a.corners!==d&&this._setCorners(a.corners),a.mini!==d&&this._setMini(a.mini),a.highlight!==d&&this._setHighlight(a.highlight),a.disabled!==d&&this._setDisabled(a.disabled),this._super(a)},_controlChange:function(a){return this._trigger("controlchange",a)!==!1&&void(this.mouseMoved||this.refresh(this._value(),!0))},_controlKeyup:function(){this.refresh(this._value(),!0,!0)},_controlBlur:function(){this.refresh(this._value(),!0)},_controlVMouseUp:function(){this._checkedRefresh()},_handleVMouseDown:function(){this.handle.focus()},_handleKeydown:function(b){var c=this._value();if(!this.options.disabled){switch(b.keyCode){case a.mobile.keyCode.HOME:case a.mobile.keyCode.END:case a.mobile.keyCode.PAGE_UP:case a.mobile.keyCode.PAGE_DOWN:case a.mobile.keyCode.UP:case a.mobile.keyCode.RIGHT:case a.mobile.keyCode.DOWN:case a.mobile.keyCode.LEFT:b.preventDefault(),this._keySliding||(this._keySliding=!0,this.handle.addClass("ui-state-active"))}switch(b.keyCode){case a.mobile.keyCode.HOME:this.refresh(this.min);break;case a.mobile.keyCode.END:this.refresh(this.max);break;case a.mobile.keyCode.PAGE_UP:case a.mobile.keyCode.UP:case a.mobile.keyCode.RIGHT:this.refresh(c+this.step);break;case a.mobile.keyCode.PAGE_DOWN:case a.mobile.keyCode.DOWN:case a.mobile.keyCode.LEFT:this.refresh(c-this.step)}}},_handleKeyup:function(){this._keySliding&&(this._keySliding=!1,this.handle.removeClass("ui-state-active"))},_sliderVMouseDown:function(a){return!(this.options.disabled||1!==a.which&&0!==a.which&&a.which!==d||this._trigger("beforestart",a)===!1||(this.dragging=!0,this.userModified=!1,this.mouseMoved=!1,this.isToggleSwitch&&(this.beforeStart=this.element[0].selectedIndex),this.refresh(a),this._trigger("start"),1))},_sliderVMouseUp:function(){return this.dragging?(this.dragging=!1,this.isToggleSwitch&&(this.handle.addClass("ui-slider-handle-snapping"),this.refresh(this.mouseMoved?this.userModified?0===this.beforeStart?1:0:this.beforeStart:0===this.beforeStart?1:0)),this.mouseMoved=!1,this._trigger("stop"),!1):void 0},_preventDocumentDrag:function(a){return this._trigger("drag",a)!==!1&&(this.dragging&&!this.options.disabled?(this.mouseMoved=!0,this.isToggleSwitch&&this.handle.removeClass("ui-slider-handle-snapping"),this.refresh(a),this.userModified=this.beforeStart!==this.element[0].selectedIndex,!1):void 0)},_checkedRefresh:function(){this.value!==this._value()&&this.refresh(this._value())},_value:function(){return this.isToggleSwitch?this.element[0].selectedIndex:parseFloat(this.element.val())},_reset:function(){this.refresh(d,!1,!0)},refresh:function(b,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=this,A=a.mobile.getAttribute(this.element[0],"theme"),B=this.options.theme||A,C=B?" ui-btn-"+B:"",D=this.options.trackTheme||A,E=D?" ui-bar-"+D:" ui-bar-inherit",F=this.options.corners?" ui-corner-all":"",G=this.options.mini?" ui-mini":"";if(z.slider[0].className=[this.isToggleSwitch?"ui-slider ui-slider-switch ui-slider-track ui-shadow-inset":"ui-slider-track ui-shadow-inset",E,F,G].join(""),(this.options.disabled||this.element.prop("disabled"))&&this.disable(),this.value=this._value(),this.options.highlight&&!this.isToggleSwitch&&0===this.slider.find(".ui-slider-bg").length&&(this.valuebg=function(){var b=c.createElement("div");return b.className="ui-slider-bg "+a.mobile.activeBtnClass,a(b).prependTo(z.slider)}()),this.handle.addClass("ui-btn"+C+" ui-shadow"),l=this.element,m=!this.isToggleSwitch,n=m?[]:l.find("option"),o=m?parseFloat(l.attr("min")):0,p=m?parseFloat(l.attr("max")):n.length-1,q=m&&parseFloat(l.attr("step"))>0?parseFloat(l.attr("step")):1,"object"==typeof b){if(h=b,i=8,f=this.slider.offset().left,g=this.slider.width(),j=g/((p-o)/q),!this.dragging||h.pageX<f-i||h.pageX>f+g+i)return;k=j>1?(h.pageX-f)/g*100:Math.round((h.pageX-f)/g*100)}else null==b&&(b=m?parseFloat(l.val()||0):l[0].selectedIndex),k=(parseFloat(b)-o)/(p-o)*100;if(!isNaN(k)&&(r=k/100*(p-o)+o,s=(r-o)%q,t=r-s,2*Math.abs(s)>=q&&(t+=s>0?q:-q),u=100/((p-o)/q),r=parseFloat(t.toFixed(5)),"undefined"==typeof j&&(j=g/((p-o)/q)),j>1&&m&&(k=(r-o)*u*(1/q)),0>k&&(k=0),k>100&&(k=100),o>r&&(r=o),r>p&&(r=p),this.handle.css("left",k+"%"),this.handle[0].setAttribute("aria-valuenow",m?r:n.eq(r).attr("value")),this.handle[0].setAttribute("aria-valuetext",m?r:n.eq(r).getEncodedText()),this.handle[0].setAttribute("title",m?r:n.eq(r).getEncodedText()),this.valuebg&&this.valuebg.css("width",k+"%"),this._labels&&(v=this.handle.width()/this.slider.width()*100,w=k&&v+(100-v)*k/100,x=100===k?0:Math.min(v+100-w,100),this._labels.each(function(){var b=a(this).hasClass("ui-slider-label-a");a(this).width((b?w:x)+"%")})),!e)){if(y=!1,m?(y=parseFloat(l.val())!==r,l.val(r)):(y=l[0].selectedIndex!==r,l[0].selectedIndex=r),this._trigger("beforechange",b)===!1)return!1;!d&&y&&l.trigger("change")}},_setHighlight:function(a){a=!!a,a?(this.options.highlight=!!a,this.refresh()):this.valuebg&&(this.valuebg.remove(),this.valuebg=!1)},_setTheme:function(a){this.handle.removeClass("ui-btn-"+this.options.theme).addClass("ui-btn-"+a);var b=this.options.theme?this.options.theme:"inherit",c=a?a:"inherit";this.control.removeClass("ui-body-"+b).addClass("ui-body-"+c)},_setTrackTheme:function(a){var b=this.options.trackTheme?this.options.trackTheme:"inherit",c=a?a:"inherit";this.slider.removeClass("ui-body-"+b).addClass("ui-body-"+c)},_setMini:function(a){a=!!a,this.isToggleSwitch||this.isRangeslider||(this.slider.parent().toggleClass("ui-mini",a),this.element.toggleClass("ui-mini",a)),this.slider.toggleClass("ui-mini",a)},_setCorners:function(a){this.slider.toggleClass("ui-corner-all",a),this.isToggleSwitch||this.control.toggleClass("ui-corner-all",a)},_setDisabled:function(a){a=!!a,this.element.prop("disabled",a),this.slider.toggleClass("ui-state-disabled",a).attr("aria-disabled",a),this.element.toggleClass("ui-state-disabled",a)}},a.mobile.behaviors.formReset))}(a),function(a){function b(){return c||(c=a("<div></div>",{class:"ui-slider-popup ui-shadow ui-corner-all"})),c.clone()}var c;a.widget("mobile.slider",a.mobile.slider,{options:{popupEnabled:!1,showValue:!1},_create:function(){this._super(),a.extend(this,{_currentValue:null,_popup:null,_popupVisible:!1}),this._setOption("popupEnabled",this.options.popupEnabled),this._on(this.handle,{vmousedown:"_showPopup"}),this._on(this.slider.add(this.document),{vmouseup:"_hidePopup"}),this._refresh()},_positionPopup:function(){var a=this.handle.offset();this._popup.offset({left:a.left+(this.handle.width()-this._popup.width())/2,top:a.top-this._popup.outerHeight()-5})},_setOption:function(a,c){this._super(a,c),"showValue"===a?this.handle.html(c&&!this.options.mini?this._value():""):"popupEnabled"===a&&c&&!this._popup&&(this._popup=b().addClass("ui-body-"+(this.options.theme||"a")).hide().insertBefore(this.element))},refresh:function(){this._super.apply(this,arguments),this._refresh()},_refresh:function(){var a,b=this.options;b.popupEnabled&&this.handle.removeAttr("title"),a=this._value(),a!==this._currentValue&&(this._currentValue=a,b.popupEnabled&&this._popup&&(this._positionPopup(),this._popup.html(a)),b.showValue&&!this.options.mini&&this.handle.html(a))},_showPopup:function(){this.options.popupEnabled&&!this._popupVisible&&(this.handle.html(""),this._popup.show(),this._positionPopup(),this._popupVisible=!0)},_hidePopup:function(){var a=this.options;a.popupEnabled&&this._popupVisible&&(a.showValue&&!a.mini&&this.handle.html(this._value()),this._popup.hide(),this._popupVisible=!1)}})}(a),function(a,b){a.widget("mobile.flipswitch",a.extend({options:{onText:"On",offText:"Off",theme:null,enhanced:!1,wrapperClass:null,corners:!0,mini:!1},_create:function(){this.options.enhanced?a.extend(this,{flipswitch:this.element.parent(),on:this.element.find(".ui-flipswitch-on").eq(0),off:this.element.find(".ui-flipswitch-off").eq(0),type:this.element.get(0).tagName}):this._enhance(),this._handleFormReset(),this._originalTabIndex=this.element.attr("tabindex"),null!=this._originalTabIndex&&this.on.attr("tabindex",this._originalTabIndex),this.element.attr("tabindex","-1"),this._on({focus:"_handleInputFocus"}),this.element.is(":disabled")&&this._setOptions({disabled:!0}),this._on(this.flipswitch,{click:"_toggle",swipeleft:"_left",swiperight:"_right"}),this._on(this.on,{keydown:"_keydown"}),this._on({change:"refresh"})},_handleInputFocus:function(){this.on.focus()},widget:function(){return this.flipswitch},_left:function(){this.flipswitch.removeClass("ui-flipswitch-active"),"SELECT"===this.type?this.element.get(0).selectedIndex=0:this.element.prop("checked",!1),this.element.trigger("change")},_right:function(){this.flipswitch.addClass("ui-flipswitch-active"),"SELECT"===this.type?this.element.get(0).selectedIndex=1:this.element.prop("checked",!0),this.element.trigger("change")},_enhance:function(){var b=a("<div>"),c=this.options,d=this.element,e=c.theme?c.theme:"inherit",f=a("<a></a>",{href:"#"}),g=a("<span></span>"),h=d.get(0).tagName,i="INPUT"===h?c.onText:d.find("option").eq(1).text(),j="INPUT"===h?c.offText:d.find("option").eq(0).text();f.addClass("ui-flipswitch-on ui-btn ui-shadow ui-btn-inherit").text(i),g.addClass("ui-flipswitch-off").text(j),b.addClass("ui-flipswitch ui-shadow-inset ui-bar-"+e+" "+(c.wrapperClass?c.wrapperClass:"")+" "+(d.is(":checked")||d.find("option").eq(1).is(":selected")?"ui-flipswitch-active":"")+(d.is(":disabled")?" ui-state-disabled":"")+(c.corners?" ui-corner-all":"")+(c.mini?" ui-mini":"")).append(f,g),d.addClass("ui-flipswitch-input").after(b).appendTo(b),a.extend(this,{flipswitch:b,on:f,off:g,type:h})},_reset:function(){this.refresh()},refresh:function(){var a,b=this.flipswitch.hasClass("ui-flipswitch-active")?"_right":"_left";a="SELECT"===this.type?this.element.get(0).selectedIndex>0?"_right":"_left":this.element.prop("checked")?"_right":"_left",a!==b&&this[a]()},_toggle:function(){var a=this.flipswitch.hasClass("ui-flipswitch-active")?"_left":"_right";this[a]()},_keydown:function(b){b.which===a.mobile.keyCode.LEFT?this._left():b.which===a.mobile.keyCode.RIGHT?this._right():b.which===a.mobile.keyCode.SPACE&&(this._toggle(),b.preventDefault())},_setOptions:function(a){if(a.theme!==b){var c=a.theme?a.theme:"inherit",d=a.theme?a.theme:"inherit";this.widget().removeClass("ui-bar-"+c).addClass("ui-bar-"+d)}a.onText!==b&&this.on.text(a.onText),a.offText!==b&&this.off.text(a.offText),a.disabled!==b&&this.widget().toggleClass("ui-state-disabled",a.disabled),a.mini!==b&&this.widget().toggleClass("ui-mini",a.mini),a.corners!==b&&this.widget().toggleClass("ui-corner-all",a.corners),this._super(a)},_destroy:function(){this.options.enhanced||(null!=this._originalTabIndex?this.element.attr("tabindex",this._originalTabIndex):this.element.removeAttr("tabindex"),this.on.remove(),this.off.remove(),this.element.unwrap(),this.flipswitch.remove(),this.removeClass("ui-flipswitch-input"))}},a.mobile.behaviors.formReset))}(a),function(a,b){a.widget("mobile.rangeslider",a.extend({options:{theme:null,trackTheme:null,corners:!0,mini:!1,highlight:!0},_create:function(){var b=this.element,c=this.options.mini?"ui-rangeslider ui-mini":"ui-rangeslider",d=b.find("input").first(),e=b.find("input").last(),f=b.find("label").first(),g=a.data(d.get(0),"mobile-slider")||a.data(d.slider().get(0),"mobile-slider"),h=a.data(e.get(0),"mobile-slider")||a.data(e.slider().get(0),"mobile-slider"),i=g.slider,j=h.slider,k=g.handle,l=a("<div class='ui-rangeslider-sliders' />").appendTo(b);d.addClass("ui-rangeslider-first"),e.addClass("ui-rangeslider-last"),b.addClass(c),i.appendTo(l),j.appendTo(l),f.insertBefore(b),k.prependTo(j),a.extend(this,{_inputFirst:d,_inputLast:e,_sliderFirst:i,_sliderLast:j,_label:f,_targetVal:null,_sliderTarget:!1,_sliders:l,_proxy:!1}),this.refresh(),this._on(this.element.find("input.ui-slider-input"),{slidebeforestart:"_slidebeforestart",slidestop:"_slidestop",slidedrag:"_slidedrag",slidebeforechange:"_change",blur:"_change",keyup:"_change"}),this._on({mousedown:"_change"}),this._on(this.element.closest("form"),{reset:"_handleReset"}),this._on(k,{vmousedown:"_dragFirstHandle"})},_handleReset:function(){var a=this;setTimeout(function(){a._updateHighlight()},0)},_dragFirstHandle:function(b){return a.data(this._inputFirst.get(0),"mobile-slider").dragging=!0,a.data(this._inputFirst.get(0),"mobile-slider").refresh(b),a.data(this._inputFirst.get(0),"mobile-slider")._trigger("start"),!1},_slidedrag:function(b){var c=a(b.target).is(this._inputFirst),d=c?this._inputLast:this._inputFirst;return this._sliderTarget=!1,"first"===this._proxy&&c||"last"===this._proxy&&!c?(a.data(d.get(0),"mobile-slider").dragging=!0,a.data(d.get(0),"mobile-slider").refresh(b),!1):void 0},_slidestop:function(b){var c=a(b.target).is(this._inputFirst);this._proxy=!1,this.element.find("input").trigger("vmouseup"),this._sliderFirst.css("z-index",c?1:"")},_slidebeforestart:function(b){this._sliderTarget=!1,a(b.originalEvent.target).hasClass("ui-slider-track")&&(this._sliderTarget=!0,this._targetVal=a(b.target).val())},_setOptions:function(a){a.theme!==b&&this._setTheme(a.theme),a.trackTheme!==b&&this._setTrackTheme(a.trackTheme),a.mini!==b&&this._setMini(a.mini),a.highlight!==b&&this._setHighlight(a.highlight),a.disabled!==b&&this._setDisabled(a.disabled),this._super(a),this.refresh()},refresh:function(){var a=this.element,b=this.options;(this._inputFirst.is(":disabled")||this._inputLast.is(":disabled"))&&(this.options.disabled=!0),a.find("input").slider({theme:b.theme,trackTheme:b.trackTheme,disabled:b.disabled,
corners:b.corners,mini:b.mini,highlight:b.highlight}).slider("refresh"),this._updateHighlight()},_change:function(b){if("keyup"===b.type)return this._updateHighlight(),!1;var c=this,d=parseFloat(this._inputFirst.val(),10),e=parseFloat(this._inputLast.val(),10),f=a(b.target).hasClass("ui-rangeslider-first"),g=f?this._inputFirst:this._inputLast,h=f?this._inputLast:this._inputFirst;if(this._inputFirst.val()>this._inputLast.val()&&"mousedown"===b.type&&!a(b.target).hasClass("ui-slider-handle"))g.blur();else if("mousedown"===b.type)return;return d>e&&!this._sliderTarget?(g.val(f?e:d).slider("refresh"),this._trigger("normalize")):d>e&&(g.val(this._targetVal).slider("refresh"),setTimeout(function(){h.val(f?d:e).slider("refresh"),a.data(h.get(0),"mobile-slider").handle.focus(),c._sliderFirst.css("z-index",f?"":1),c._trigger("normalize")},0),this._proxy=f?"first":"last"),d===e?(a.data(g.get(0),"mobile-slider").handle.css("z-index",1),a.data(h.get(0),"mobile-slider").handle.css("z-index",0)):(a.data(h.get(0),"mobile-slider").handle.css("z-index",""),a.data(g.get(0),"mobile-slider").handle.css("z-index","")),this._updateHighlight(),!(d>=e)&&void 0},_updateHighlight:function(){var b=parseInt(a.data(this._inputFirst.get(0),"mobile-slider").handle.get(0).style.left,10),c=parseInt(a.data(this._inputLast.get(0),"mobile-slider").handle.get(0).style.left,10),d=c-b;this.element.find(".ui-slider-bg").css({"margin-left":b+"%",width:d+"%"})},_setTheme:function(a){this._inputFirst.slider("option","theme",a),this._inputLast.slider("option","theme",a)},_setTrackTheme:function(a){this._inputFirst.slider("option","trackTheme",a),this._inputLast.slider("option","trackTheme",a)},_setMini:function(a){this._inputFirst.slider("option","mini",a),this._inputLast.slider("option","mini",a),this.element.toggleClass("ui-mini",!!a)},_setHighlight:function(a){this._inputFirst.slider("option","highlight",a),this._inputLast.slider("option","highlight",a)},_setDisabled:function(a){this._inputFirst.prop("disabled",a),this._inputLast.prop("disabled",a)},_destroy:function(){this._label.prependTo(this.element),this.element.removeClass("ui-rangeslider ui-mini"),this._inputFirst.after(this._sliderFirst),this._inputLast.after(this._sliderLast),this._sliders.remove(),this.element.find("input").removeClass("ui-rangeslider-first ui-rangeslider-last").slider("destroy")}},a.mobile.behaviors.formReset))}(a),function(a,b){a.widget("mobile.textinput",a.mobile.textinput,{options:{clearBtn:!1,clearBtnText:"Clear text"},_create:function(){this._super(),this.isSearch&&(this.options.clearBtn=!0),this.options.clearBtn&&this.inputNeedsWrap&&this._addClearBtn()},clearButton:function(){return a("<a href='#' tabindex='-1' aria-hidden='true' class='ui-input-clear ui-btn ui-icon-delete ui-btn-icon-notext ui-corner-all'></a>").attr("title",this.options.clearBtnText).text(this.options.clearBtnText)},_clearBtnClick:function(a){this.element.val("").focus().trigger("change"),this._clearBtn.addClass("ui-input-clear-hidden"),a.preventDefault()},_addClearBtn:function(){this.options.enhanced||this._enhanceClear(),a.extend(this,{_clearBtn:this.widget().find("a.ui-input-clear")}),this._bindClearEvents(),this._toggleClear()},_enhanceClear:function(){this.clearButton().appendTo(this.widget()),this.widget().addClass("ui-input-has-clear")},_bindClearEvents:function(){this._on(this._clearBtn,{click:"_clearBtnClick"}),this._on({keyup:"_toggleClear",change:"_toggleClear",input:"_toggleClear",focus:"_toggleClear",blur:"_toggleClear",cut:"_toggleClear",paste:"_toggleClear"})},_unbindClear:function(){this._off(this._clearBtn,"click"),this._off(this.element,"keyup change input focus blur cut paste")},_setOptions:function(a){this._super(a),a.clearBtn===b||this.element.is("textarea, :jqmData(type='range')")||(a.clearBtn?this._addClearBtn():this._destroyClear()),a.clearBtnText!==b&&this._clearBtn!==b&&this._clearBtn.text(a.clearBtnText).attr("title",a.clearBtnText)},_toggleClear:function(){this._delay("_toggleClearClass",0)},_toggleClearClass:function(){this._clearBtn.toggleClass("ui-input-clear-hidden",!this.element.val())},_destroyClear:function(){this.widget().removeClass("ui-input-has-clear"),this._unbindClear(),this._clearBtn.remove()},_destroy:function(){this._super(),this.options.clearBtn&&this._destroyClear()}})}(a),function(a,b){a.widget("mobile.textinput",a.mobile.textinput,{options:{autogrow:!0,keyupTimeoutBuffer:100},_create:function(){this._super(),this.options.autogrow&&this.isTextarea&&this._autogrow()},_autogrow:function(){this.element.addClass("ui-textinput-autogrow"),this._on({keyup:"_timeout",change:"_timeout",input:"_timeout",paste:"_timeout"}),this._on(!0,this.document,{pageshow:"_handleShow",popupbeforeposition:"_handleShow",updatelayout:"_handleShow",panelopen:"_handleShow"})},_handleShow:function(b){a.contains(b.target,this.element[0])&&this.element.is(":visible")&&("popupbeforeposition"!==b.type&&this.element.addClass("ui-textinput-autogrow-resize").animationComplete(a.proxy(function(){this.element.removeClass("ui-textinput-autogrow-resize")},this),"transition"),this._prepareHeightUpdate())},_unbindAutogrow:function(){this.element.removeClass("ui-textinput-autogrow"),this._off(this.element,"keyup change input paste"),this._off(this.document,"pageshow popupbeforeposition updatelayout panelopen")},keyupTimeout:null,_prepareHeightUpdate:function(a){this.keyupTimeout&&clearTimeout(this.keyupTimeout),a===b?this._updateHeight():this.keyupTimeout=this._delay("_updateHeight",a)},_timeout:function(){this._prepareHeightUpdate(this.options.keyupTimeoutBuffer)},_updateHeight:function(){var a,b,c,d,e,f,g,h,i,j=this.window.scrollTop();this.keyupTimeout=0,"onpage"in this.element[0]||this.element.css({height:0,"min-height":0,"max-height":0}),d=this.element[0].scrollHeight,e=this.element[0].clientHeight,f=parseFloat(this.element.css("border-top-width")),g=parseFloat(this.element.css("border-bottom-width")),h=f+g,i=d+h+15,0===e&&(a=parseFloat(this.element.css("padding-top")),b=parseFloat(this.element.css("padding-bottom")),c=a+b,i+=c),this.element.css({height:i,"min-height":"","max-height":""}),this.window.scrollTop(j)},refresh:function(){this.options.autogrow&&this.isTextarea&&this._updateHeight()},_setOptions:function(a){this._super(a),a.autogrow!==b&&this.isTextarea&&(a.autogrow?this._autogrow():this._unbindAutogrow())}})}(a),function(a){a.widget("mobile.selectmenu",a.extend({initSelector:"select:not( :jqmData(role='slider')):not( :jqmData(role='flipswitch') )",options:{theme:null,icon:"carat-d",iconpos:"right",inline:!1,corners:!0,shadow:!0,iconshadow:!1,overlayTheme:null,dividerTheme:null,hidePlaceholderMenuItems:!0,closeText:"Close",nativeMenu:!0,preventFocusZoom:/iPhone|iPad|iPod/.test(navigator.platform)&&navigator.userAgent.indexOf("AppleWebKit")>-1,mini:!1},_button:function(){return a("<div/>")},_setDisabled:function(a){return this.element.attr("disabled",a),this.button.attr("aria-disabled",a),this._setOption("disabled",a)},_focusButton:function(){var a=this;setTimeout(function(){a.button.focus()},40)},_selectOptions:function(){return this.select.find("option")},_preExtension:function(){var b=this.options.inline||this.element.jqmData("inline"),c=this.options.mini||this.element.jqmData("mini"),d="";~this.element[0].className.indexOf("ui-btn-left")&&(d=" ui-btn-left"),~this.element[0].className.indexOf("ui-btn-right")&&(d=" ui-btn-right"),b&&(d+=" ui-btn-inline"),c&&(d+=" ui-mini"),this.select=this.element.removeClass("ui-btn-left ui-btn-right").wrap("<div class='ui-select"+d+"'>"),this.selectId=this.select.attr("id")||"select-"+this.uuid,this.buttonId=this.selectId+"-button",this.label=a("label[for='"+this.selectId+"']"),this.isMultiple=this.select[0].multiple},_destroy:function(){var a=this.element.parents(".ui-select");a.length>0&&(a.is(".ui-btn-left, .ui-btn-right")&&this.element.addClass(a.hasClass("ui-btn-left")?"ui-btn-left":"ui-btn-right"),this.element.insertAfter(a),a.remove())},_create:function(){this._preExtension(),this.button=this._button();var c=this,d=this.options,e=!!d.icon&&(d.iconpos||this.select.jqmData("iconpos")),f=this.button.insertBefore(this.select).attr("id",this.buttonId).addClass("ui-btn"+(d.icon?" ui-icon-"+d.icon+" ui-btn-icon-"+e+(d.iconshadow?" ui-shadow-icon":""):"")+(d.theme?" ui-btn-"+d.theme:"")+(d.corners?" ui-corner-all":"")+(d.shadow?" ui-shadow":""));this.setButtonText(),d.nativeMenu&&b.opera&&b.opera.version&&f.addClass("ui-select-nativeonly"),this.isMultiple&&(this.buttonCount=a("<span>").addClass("ui-li-count ui-body-inherit").hide().appendTo(f.addClass("ui-li-has-count"))),(d.disabled||this.element.attr("disabled"))&&this.disable(),this.select.change(function(){c.refresh(),d.nativeMenu&&c._delay(function(){c.select.blur()})}),this._handleFormReset(),this._on(this.button,{keydown:"_handleKeydown"}),this.build()},build:function(){var b=this;this.select.appendTo(b.button).bind("vmousedown",function(){b.button.addClass(a.mobile.activeBtnClass)}).bind("focus",function(){b.button.addClass(a.mobile.focusClass)}).bind("blur",function(){b.button.removeClass(a.mobile.focusClass)}).bind("focus vmouseover",function(){b.button.trigger("vmouseover")}).bind("vmousemove",function(){b.button.removeClass(a.mobile.activeBtnClass)}).bind("change blur vmouseout",function(){b.button.trigger("vmouseout").removeClass(a.mobile.activeBtnClass)}),b.button.bind("vmousedown",function(){b.options.preventFocusZoom&&a.mobile.zoom.disable(!0)}),b.label.bind("click focus",function(){b.options.preventFocusZoom&&a.mobile.zoom.disable(!0)}),b.select.bind("focus",function(){b.options.preventFocusZoom&&a.mobile.zoom.disable(!0)}),b.button.bind("mouseup",function(){b.options.preventFocusZoom&&setTimeout(function(){a.mobile.zoom.enable(!0)},0)}),b.select.bind("blur",function(){b.options.preventFocusZoom&&a.mobile.zoom.enable(!0)})},selected:function(){return this._selectOptions().filter(":selected")},selectedIndices:function(){var a=this;return this.selected().map(function(){return a._selectOptions().index(this)}).get()},setButtonText:function(){var b=this,d=this.selected(),e=this.placeholder,f=a(c.createElement("span"));this.button.children("span").not(".ui-li-count").remove().end().end().prepend(function(){return e=d.length?d.map(function(){return a(this).text()}).get().join(", "):b.placeholder,e?f.text(e):f.html("&#160;"),f.addClass(b.select.attr("class")).addClass(d.attr("class")).removeClass("ui-screen-hidden")}())},setButtonCount:function(){var a=this.selected();this.isMultiple&&this.buttonCount[a.length>1?"show":"hide"]().text(a.length)},_handleKeydown:function(){this._delay("_refreshButton")},_reset:function(){this.refresh()},_refreshButton:function(){this.setButtonText(),this.setButtonCount()},refresh:function(){this._refreshButton()},open:a.noop,close:a.noop,disable:function(){this._setDisabled(!0),this.button.addClass("ui-state-disabled")},enable:function(){this._setDisabled(!1),this.button.removeClass("ui-state-disabled")}},a.mobile.behaviors.formReset))}(a),function(a){a.mobile.links=function(b){a(b).find("a").jqmEnhanceable().filter(":jqmData(rel='popup')[href][href!='']").each(function(){var a=this,b=a.getAttribute("href").substring(1);b&&(a.setAttribute("aria-haspopup",!0),a.setAttribute("aria-owns",b),a.setAttribute("aria-expanded",!1))}).end().not(".ui-btn, :jqmData(role='none'), :jqmData(role='nojs')").addClass("ui-link")}}(a),function(a,c){function d(a,b,c,d){var e=d;return e=b>a?c+(a-b)/2:Math.min(Math.max(c,d-b/2),c+a-b)}function e(a){return{x:a.scrollLeft(),y:a.scrollTop(),cx:a[0].innerWidth||a.width(),cy:a[0].innerHeight||a.height()}}a.widget("mobile.popup",{options:{wrapperClass:null,theme:null,overlayTheme:null,shadow:!0,corners:!0,transition:"none",positionTo:"origin",tolerance:null,closeLinkSelector:"a:jqmData(rel='back')",closeLinkEvents:"click.popup",navigateEvents:"navigate.popup",closeEvents:"navigate.popup pagebeforechange.popup",dismissible:!0,enhanced:!1,history:!a.mobile.browser.oldIE},_handleDocumentVmousedown:function(b){this._isOpen&&a.contains(this._ui.container[0],b.target)&&this._ignoreResizeEvents()},_create:function(){var b=this.element,c=b.attr("id"),d=this.options;d.history=d.history&&a.mobile.ajaxEnabled&&a.mobile.hashListeningEnabled,this._on(this.document,{vmousedown:"_handleDocumentVmousedown"}),a.extend(this,{_scrollTop:0,_page:b.closest(".ui-page"),_ui:null,_fallbackTransition:"",_currentTransition:!1,_prerequisites:null,_isOpen:!1,_tolerance:null,_resizeData:null,_ignoreResizeTo:0,_orientationchangeInProgress:!1}),0===this._page.length&&(this._page=a("body")),d.enhanced?this._ui={container:b.parent(),screen:b.parent().prev(),placeholder:a(this.document[0].getElementById(c+"-placeholder"))}:(this._ui=this._enhance(b,c),this._applyTransition(d.transition)),this._setTolerance(d.tolerance)._ui.focusElement=this._ui.container,this._on(this._ui.screen,{vclick:"_eatEventAndClose"}),this._on(this.window,{orientationchange:a.proxy(this,"_handleWindowOrientationchange"),resize:a.proxy(this,"_handleWindowResize"),keyup:a.proxy(this,"_handleWindowKeyUp")}),this._on(this.document,{focusin:"_handleDocumentFocusIn"})},_enhance:function(b,c){var d=this.options,e=d.wrapperClass,f={screen:a("<div class='ui-screen-hidden ui-popup-screen "+this._themeClassFromOption("ui-overlay-",d.overlayTheme)+"'></div>"),placeholder:a("<div style='display: none;'><!-- placeholder --></div>"),container:a("<div class='ui-popup-container ui-popup-hidden ui-popup-truncate"+(e?" "+e:"")+"'></div>")},g=this.document[0].createDocumentFragment();return g.appendChild(f.screen[0]),g.appendChild(f.container[0]),c&&(f.screen.attr("id",c+"-screen"),f.container.attr("id",c+"-popup"),f.placeholder.attr("id",c+"-placeholder").html("<!-- placeholder for "+c+" -->")),this._page[0].appendChild(g),f.placeholder.insertAfter(b),b.detach().addClass("ui-popup "+this._themeClassFromOption("ui-body-",d.theme)+" "+(d.shadow?"ui-overlay-shadow ":"")+(d.corners?"ui-corner-all ":"")).appendTo(f.container),f},_eatEventAndClose:function(a){return a.preventDefault(),a.stopImmediatePropagation(),this.options.dismissible&&this.close(),!1},_resizeScreen:function(){var a=this._ui.screen,b=this._ui.container.outerHeight(!0),c=a.removeAttr("style").height(),d=this.document.height()-1;d>c?a.height(d):b>c&&a.height(b)},_handleWindowKeyUp:function(b){return this._isOpen&&b.keyCode===a.mobile.keyCode.ESCAPE?this._eatEventAndClose(b):void 0},_expectResizeEvent:function(){var a=e(this.window);if(this._resizeData){if(a.x===this._resizeData.windowCoordinates.x&&a.y===this._resizeData.windowCoordinates.y&&a.cx===this._resizeData.windowCoordinates.cx&&a.cy===this._resizeData.windowCoordinates.cy)return!1;clearTimeout(this._resizeData.timeoutId)}return this._resizeData={timeoutId:this._delay("_resizeTimeout",200),windowCoordinates:a},!0},_resizeTimeout:function(){this._isOpen?this._expectResizeEvent()||(this._ui.container.hasClass("ui-popup-hidden")&&(this._ui.container.removeClass("ui-popup-hidden ui-popup-truncate"),this.reposition({positionTo:"window"}),this._ignoreResizeEvents()),this._resizeScreen(),this._resizeData=null,this._orientationchangeInProgress=!1):(this._resizeData=null,this._orientationchangeInProgress=!1)},_stopIgnoringResizeEvents:function(){this._ignoreResizeTo=0},_ignoreResizeEvents:function(){this._ignoreResizeTo&&clearTimeout(this._ignoreResizeTo),this._ignoreResizeTo=this._delay("_stopIgnoringResizeEvents",1e3)},_handleWindowResize:function(){this._isOpen&&0===this._ignoreResizeTo&&(!this._expectResizeEvent()&&!this._orientationchangeInProgress||this._ui.container.hasClass("ui-popup-hidden")||this._ui.container.addClass("ui-popup-hidden ui-popup-truncate").removeAttr("style"))},_handleWindowOrientationchange:function(){!this._orientationchangeInProgress&&this._isOpen&&0===this._ignoreResizeTo&&(this._expectResizeEvent(),this._orientationchangeInProgress=!0)},_handleDocumentFocusIn:function(b){var c,d=b.target,e=this._ui;if(this._isOpen){if(d!==e.container[0]){if(c=a(d),!a.contains(e.container[0],d))return a(this.document[0].activeElement).one("focus",a.proxy(function(){this._safelyBlur(d)},this)),e.focusElement.focus(),b.preventDefault(),b.stopImmediatePropagation(),!1;e.focusElement[0]===e.container[0]&&(e.focusElement=c)}this._ignoreResizeEvents()}},_themeClassFromOption:function(a,b){return b?"none"===b?"":a+b:a+"inherit"},_applyTransition:function(b){return b&&(this._ui.container.removeClass(this._fallbackTransition),"none"!==b&&(this._fallbackTransition=a.mobile._maybeDegradeTransition(b),"none"===this._fallbackTransition&&(this._fallbackTransition=""),this._ui.container.addClass(this._fallbackTransition))),this},_setOptions:function(a){var b=this.options,d=this.element,e=this._ui.screen;return a.wrapperClass!==c&&this._ui.container.removeClass(b.wrapperClass).addClass(a.wrapperClass),a.theme!==c&&d.removeClass(this._themeClassFromOption("ui-body-",b.theme)).addClass(this._themeClassFromOption("ui-body-",a.theme)),a.overlayTheme!==c&&(e.removeClass(this._themeClassFromOption("ui-overlay-",b.overlayTheme)).addClass(this._themeClassFromOption("ui-overlay-",a.overlayTheme)),this._isOpen&&e.addClass("in")),a.shadow!==c&&d.toggleClass("ui-overlay-shadow",a.shadow),a.corners!==c&&d.toggleClass("ui-corner-all",a.corners),a.transition!==c&&(this._currentTransition||this._applyTransition(a.transition)),a.tolerance!==c&&this._setTolerance(a.tolerance),a.disabled!==c&&a.disabled&&this.close(),this._super(a)},_setTolerance:function(b){var d,e={t:30,r:15,b:30,l:15};if(b!==c)switch(d=String(b).split(","),a.each(d,function(a,b){d[a]=parseInt(b,10)}),d.length){case 1:isNaN(d[0])||(e.t=e.r=e.b=e.l=d[0]);break;case 2:isNaN(d[0])||(e.t=e.b=d[0]),isNaN(d[1])||(e.l=e.r=d[1]);break;case 4:isNaN(d[0])||(e.t=d[0]),isNaN(d[1])||(e.r=d[1]),isNaN(d[2])||(e.b=d[2]),isNaN(d[3])||(e.l=d[3])}return this._tolerance=e,this},_clampPopupWidth:function(a){var b,c=e(this.window),d={x:this._tolerance.l,y:c.y+this._tolerance.t,cx:c.cx-this._tolerance.l-this._tolerance.r,cy:c.cy-this._tolerance.t-this._tolerance.b};return a||this._ui.container.css("max-width",d.cx),b={cx:this._ui.container.outerWidth(!0),cy:this._ui.container.outerHeight(!0)},{rc:d,menuSize:b}},_calculateFinalLocation:function(a,b){var c,e=b.rc,f=b.menuSize;return c={left:d(e.cx,f.cx,e.x,a.x),top:d(e.cy,f.cy,e.y,a.y)},c.top=Math.max(0,c.top),c.top-=Math.min(c.top,Math.max(0,c.top+f.cy-this.document.height())),c},_placementCoords:function(a){return this._calculateFinalLocation(a,this._clampPopupWidth())},_createPrerequisites:function(b,c,d){var e,f=this;e={screen:a.Deferred(),container:a.Deferred()},e.screen.then(function(){e===f._prerequisites&&b()}),e.container.then(function(){e===f._prerequisites&&c()}),a.when(e.screen,e.container).done(function(){e===f._prerequisites&&(f._prerequisites=null,d())}),f._prerequisites=e},_animate:function(b){return this._ui.screen.removeClass(b.classToRemove).addClass(b.screenClassToAdd),b.prerequisites.screen.resolve(),b.transition&&"none"!==b.transition&&(b.applyTransition&&this._applyTransition(b.transition),this._fallbackTransition)?void this._ui.container.addClass(b.containerClassToAdd).removeClass(b.classToRemove).animationComplete(a.proxy(b.prerequisites.container,"resolve")):(this._ui.container.removeClass(b.classToRemove),void b.prerequisites.container.resolve())},_desiredCoords:function(b){var c,d=null,f=e(this.window),g=b.x,h=b.y,i=b.positionTo;if(i&&"origin"!==i)if("window"===i)g=f.cx/2+f.x,h=f.cy/2+f.y;else{try{d=a(i)}catch(j){d=null}d&&(d.filter(":visible"),0===d.length&&(d=null))}return d&&(c=d.offset(),g=c.left+d.outerWidth()/2,h=c.top+d.outerHeight()/2),("number"!==a.type(g)||isNaN(g))&&(g=f.cx/2+f.x),("number"!==a.type(h)||isNaN(h))&&(h=f.cy/2+f.y),{x:g,y:h}},_reposition:function(a){a={x:a.x,y:a.y,positionTo:a.positionTo},this._trigger("beforeposition",c,a),this._ui.container.offset(this._placementCoords(this._desiredCoords(a)))},reposition:function(a){this._isOpen&&this._reposition(a)},_safelyBlur:function(b){b!==this.window[0]&&"body"!==b.nodeName.toLowerCase()&&a(b).blur()},_openPrerequisitesComplete:function(){var b=this.element.attr("id"),c=this._ui.container.find(":focusable").first();this._ui.container.addClass("ui-popup-active"),this._isOpen=!0,this._resizeScreen(),a.contains(this._ui.container[0],this.document[0].activeElement)||this._safelyBlur(this.document[0].activeElement),c.length>0&&(this._ui.focusElement=c),this._ignoreResizeEvents(),b&&this.document.find("[aria-haspopup='true'][aria-owns='"+b+"']").attr("aria-expanded",!0),this._trigger("afteropen")},_open:function(b){var c=a.extend({},this.options,b),d=function(){var a=navigator.userAgent,b=a.match(/AppleWebKit\/([0-9\.]+)/),c=!!b&&b[1],d=a.match(/Android (\d+(?:\.\d+))/),e=!!d&&d[1],f=a.indexOf("Chrome")>-1;return!(!(null!==d&&"4.0"===e&&c&&c>534.13)||f)}();this._createPrerequisites(a.noop,a.noop,a.proxy(this,"_openPrerequisitesComplete")),this._currentTransition=c.transition,this._applyTransition(c.transition),this._ui.screen.removeClass("ui-screen-hidden"),this._ui.container.removeClass("ui-popup-truncate"),this._reposition(c),this._ui.container.removeClass("ui-popup-hidden"),this.options.overlayTheme&&d&&this.element.closest(".ui-page").addClass("ui-popup-open"),this._animate({additionalCondition:!0,transition:c.transition,classToRemove:"",screenClassToAdd:"in",containerClassToAdd:"in",applyTransition:!1,prerequisites:this._prerequisites})},_closePrerequisiteScreen:function(){this._ui.screen.removeClass("out").addClass("ui-screen-hidden")},_closePrerequisiteContainer:function(){this._ui.container.removeClass("reverse out").addClass("ui-popup-hidden ui-popup-truncate").removeAttr("style")},_closePrerequisitesDone:function(){var b=this._ui.container,d=this.element.attr("id");a.mobile.popup.active=c,a(":focus",b[0]).add(b[0]).blur(),d&&this.document.find("[aria-haspopup='true'][aria-owns='"+d+"']").attr("aria-expanded",!1),this._trigger("afterclose")},_close:function(b){this._ui.container.removeClass("ui-popup-active"),this._page.removeClass("ui-popup-open"),this._isOpen=!1,this._createPrerequisites(a.proxy(this,"_closePrerequisiteScreen"),a.proxy(this,"_closePrerequisiteContainer"),a.proxy(this,"_closePrerequisitesDone")),this._animate({additionalCondition:this._ui.screen.hasClass("in"),transition:b?"none":this._currentTransition,classToRemove:"in",screenClassToAdd:"out",containerClassToAdd:"reverse out",applyTransition:!0,prerequisites:this._prerequisites})},_unenhance:function(){this.options.enhanced||(this._setOptions({theme:a.mobile.popup.prototype.options.theme}),this.element.detach().insertAfter(this._ui.placeholder).removeClass("ui-popup ui-overlay-shadow ui-corner-all ui-body-inherit"),this._ui.screen.remove(),this._ui.container.remove(),this._ui.placeholder.remove())},_destroy:function(){return a.mobile.popup.active===this?(this.element.one("popupafterclose",a.proxy(this,"_unenhance")),this.close()):this._unenhance(),this},_closePopup:function(c,d){var e,f,g=this.options,h=!1;c&&c.isDefaultPrevented()||a.mobile.popup.active!==this||(b.scrollTo(0,this._scrollTop),c&&"pagebeforechange"===c.type&&d&&(e="string"==typeof d.toPage?d.toPage:d.toPage.jqmData("url"),e=a.mobile.path.parseUrl(e),f=e.pathname+e.search+e.hash,this._myUrl!==a.mobile.path.makeUrlAbsolute(f)?h=!0:c.preventDefault()),this.window.off(g.closeEvents),this.element.undelegate(g.closeLinkSelector,g.closeLinkEvents),this._close(h))},_bindContainerClose:function(){this.window.on(this.options.closeEvents,a.proxy(this,"_closePopup"))},widget:function(){return this._ui.container},open:function(b){var c,d,e,f,g,h,i=this,j=this.options;return a.mobile.popup.active||j.disabled?this:(a.mobile.popup.active=this,this._scrollTop=this.window.scrollTop(),j.history?(h=a.mobile.navigate.history,d=a.mobile.dialogHashKey,e=a.mobile.activePage,f=!!e&&e.hasClass("ui-dialog"),this._myUrl=c=h.getActive().url,(g=c.indexOf(d)>-1&&!f&&h.activeIndex>0)?(i._open(b),i._bindContainerClose(),this):(-1!==c.indexOf(d)||f?c=a.mobile.path.parseLocation().hash+d:c+=c.indexOf("#")>-1?d:"#"+d,this.window.one("beforenavigate",function(a){a.preventDefault(),i._open(b),i._bindContainerClose()}),this.urlAltered=!0,a.mobile.navigate(c,{role:"dialog"}),this)):(i._open(b),i._bindContainerClose(),i.element.delegate(j.closeLinkSelector,j.closeLinkEvents,function(a){i.close(),a.preventDefault()}),this))},close:function(){return a.mobile.popup.active!==this?this:(this._scrollTop=this.window.scrollTop(),this.options.history&&this.urlAltered?(a.mobile.back(),this.urlAltered=!1):this._closePopup(),this)}}),a.mobile.popup.handleLink=function(b){var c,d=a.mobile.path,e=a(d.hashToSelector(d.parseUrl(b.attr("href")).hash)).first();e.length>0&&e.data("mobile-popup")&&(c=b.offset(),e.popup("open",{x:c.left+b.outerWidth()/2,y:c.top+b.outerHeight()/2,transition:b.jqmData("transition"),positionTo:b.jqmData("position-to")})),setTimeout(function(){b.removeClass(a.mobile.activeBtnClass)},300)},a.mobile.document.on("pagebeforechange",function(b,c){"popup"===c.options.role&&(a.mobile.popup.handleLink(c.options.link),b.preventDefault())})}(a),function(a,b){var d=".ui-disabled,.ui-state-disabled,.ui-li-divider,.ui-screen-hidden,:jqmData(role='placeholder')",e=function(a,b,c){var e=a[c+"All"]().not(d).first();e.length&&(b.blur().attr("tabindex","-1"),e.find("a").first().focus())};a.widget("mobile.selectmenu",a.mobile.selectmenu,{_create:function(){var a=this.options;return a.nativeMenu=a.nativeMenu||this.element.parents(":jqmData(role='popup'),:mobile-popup").length>0,this._super()},_handleSelectFocus:function(){this.element.blur(),this.button.focus()},_handleKeydown:function(a){this._super(a),this._handleButtonVclickKeydown(a)},_handleButtonVclickKeydown:function(b){this.options.disabled||this.isOpen||this.options.nativeMenu||("vclick"===b.type||b.keyCode&&(b.keyCode===a.mobile.keyCode.ENTER||b.keyCode===a.mobile.keyCode.SPACE))&&(this._decideFormat(),"overlay"===this.menuType?this.button.attr("href","#"+this.popupId).attr("data-"+(a.mobile.ns||"")+"rel","popup"):this.button.attr("href","#"+this.dialogId).attr("data-"+(a.mobile.ns||"")+"rel","dialog"),this.isOpen=!0)},_handleListFocus:function(b){var c="focusin"===b.type?{tabindex:"0",event:"vmouseover"}:{tabindex:"-1",event:"vmouseout"};a(b.target).attr("tabindex",c.tabindex).trigger(c.event)},_handleListKeydown:function(b){var c=a(b.target),d=c.closest("li");switch(b.keyCode){case 38:return e(d,c,"prev"),!1;case 40:return e(d,c,"next"),!1;case 13:case 32:return c.trigger("click"),!1}},_handleMenuPageHide:function(){this._delayedTrigger(),this.thisPage.page("bindRemove")},_handleHeaderCloseClick:function(){return"overlay"===this.menuType?(this.close(),!1):void 0},_handleListItemClick:function(b){var c=a(b.target).closest("li"),d=this.select[0].selectedIndex,e=a.mobile.getAttribute(c,"option-index"),f=this._selectOptions().eq(e)[0];f.selected=!this.isMultiple||!f.selected,this.isMultiple&&c.find("a").toggleClass("ui-checkbox-on",f.selected).toggleClass("ui-checkbox-off",!f.selected),this.isMultiple||d===e||(this._triggerChange=!0),this.isMultiple?(this.select.trigger("change"),this.list.find("li:not(.ui-li-divider)").eq(e).find("a").first().focus()):this.close(),b.preventDefault()},build:function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=this.options;return v.nativeMenu?this._super():(c=this.selectId,d=c+"-listbox",e=c+"-dialog",f=this.label,g=this.element.closest(".ui-page"),h=this.element[0].multiple,i=c+"-menu",j=v.theme?" data-"+a.mobile.ns+"theme='"+v.theme+"'":"",k=v.overlayTheme||v.theme||null,l=k?" data-"+a.mobile.ns+"overlay-theme='"+k+"'":"",m=v.dividerTheme&&h?" data-"+a.mobile.ns+"divider-theme='"+v.dividerTheme+"'":"",n=a("<div data-"+a.mobile.ns+"role='dialog' class='ui-selectmenu' id='"+e+"'"+j+l+"><div data-"+a.mobile.ns+"role='header'><div class='ui-title'></div></div><div data-"+a.mobile.ns+"role='content'></div></div>"),o=a("<div"+j+l+" id='"+d+"' class='ui-selectmenu'></div>").insertAfter(this.select).popup(),p=a("<ul class='ui-selectmenu-list' id='"+i+"' role='listbox' aria-labelledby='"+this.buttonId+"'"+j+m+"></ul>").appendTo(o),q=a("<div class='ui-header ui-bar-"+(v.theme?v.theme:"inherit")+"'></div>").prependTo(o),r=a("<h1 class='ui-title'></h1>").appendTo(q),this.isMultiple&&(u=a("<a>",{role:"button",text:v.closeText,href:"#",class:"ui-btn ui-corner-all ui-btn-left ui-btn-icon-notext ui-icon-delete"}).appendTo(q)),a.extend(this,{selectId:c,menuId:i,popupId:d,dialogId:e,thisPage:g,menuPage:n,label:f,isMultiple:h,theme:v.theme,listbox:o,list:p,header:q,headerTitle:r,headerClose:u,menuPageContent:s,menuPageClose:t,placeholder:""}),this.refresh(),this._origTabIndex===b&&(this._origTabIndex=null!==this.select[0].getAttribute("tabindex")&&this.select.attr("tabindex")),this.select.attr("tabindex","-1"),this._on(this.select,{focus:"_handleSelectFocus"}),this._on(this.button,{vclick:"_handleButtonVclickKeydown"}),this.list.attr("role","listbox"),this._on(this.list,{focusin:"_handleListFocus",focusout:"_handleListFocus",keydown:"_handleListKeydown","click li:not(.ui-disabled,.ui-state-disabled,.ui-li-divider)":"_handleListItemClick"}),this._on(this.menuPage,{pagehide:"_handleMenuPageHide"}),this._on(this.listbox,{popupafterclose:"_popupClosed"}),this.isMultiple&&this._on(this.headerClose,{click:"_handleHeaderCloseClick"}),this)},_popupClosed:function(){this.close(),this._delayedTrigger()},_delayedTrigger:function(){this._triggerChange&&this.element.trigger("change"),this._triggerChange=!1},_isRebuildRequired:function(){var a=this.list.find("li"),b=this._selectOptions().not(".ui-screen-hidden");return b.text()!==a.text()},selected:function(){return this._selectOptions().filter(":selected:not( :jqmData(placeholder='true') )")},refresh:function(b){var c,d;return this.options.nativeMenu?this._super(b):(c=this,(b||this._isRebuildRequired())&&c._buildList(),d=this.selectedIndices(),c.setButtonText(),c.setButtonCount(),void c.list.find("li:not(.ui-li-divider)").find("a").removeClass(a.mobile.activeBtnClass).end().attr("aria-selected",!1).each(function(b){var e=a(this);a.inArray(b,d)>-1?(e.attr("aria-selected",!0),c.isMultiple?e.find("a").removeClass("ui-checkbox-off").addClass("ui-checkbox-on"):e.hasClass("ui-screen-hidden")?e.next().find("a").addClass(a.mobile.activeBtnClass):e.find("a").addClass(a.mobile.activeBtnClass)):c.isMultiple&&e.find("a").removeClass("ui-checkbox-on").addClass("ui-checkbox-off")}))},close:function(){if(!this.options.disabled&&this.isOpen){var a=this;"page"===a.menuType?(a.menuPage.dialog("close"),a.list.appendTo(a.listbox)):a.listbox.popup("close"),a._focusButton(),a.isOpen=!1}},open:function(){this.button.click()},_focusMenuItem:function(){var b=this.list.find("a."+a.mobile.activeBtnClass);0===b.length&&(b=this.list.find("li:not("+d+") a.ui-btn")),b.first().focus()},_decideFormat:function(){var b=this,c=this.window,d=b.list.parent(),e=d.outerHeight(),f=c.scrollTop(),g=b.button.offset().top,h=c.height();e>h-80||!a.support.scrollTop?(b.menuPage.appendTo(a.mobile.pageContainer).page(),b.menuPageContent=b.menuPage.find(".ui-content"),b.menuPageClose=b.menuPage.find(".ui-header a"),b.thisPage.unbind("pagehide.remove"),0===f&&g>h&&b.thisPage.one("pagehide",function(){a(this).jqmData("lastScroll",g)}),b.menuPage.one({pageshow:a.proxy(this,"_focusMenuItem"),pagehide:a.proxy(this,"close")}),b.menuType="page",b.menuPageContent.append(b.list),b.menuPage.find("div .ui-title").text(b.label.getEncodedText()||b.placeholder)):(b.menuType="overlay",b.listbox.one({popupafteropen:a.proxy(this,"_focusMenuItem")}))},_buildList:function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q=this,r=this.options,s=this.placeholder,t=!0,u="false",v="data-"+a.mobile.ns,w=v+"option-index",x=v+"icon",y=v+"role",z=v+"placeholder",A=c.createDocumentFragment(),B=!1;for(q.list.empty().filter(".ui-listview").listview("destroy"),b=this._selectOptions(),d=b.length,e=this.select[0],g=0;d>g;g++,B=!1)h=b[g],i=a(h),i.hasClass("ui-screen-hidden")||(j=h.parentNode,m=[],k=i.text(),
l=c.createElement("a"),l.setAttribute("href","#"),l.appendChild(c.createTextNode(k)),j!==e&&"optgroup"===j.nodeName.toLowerCase()&&(n=j.getAttribute("label"),n!==f&&(o=c.createElement("li"),o.setAttribute(y,"list-divider"),o.setAttribute("role","option"),o.setAttribute("tabindex","-1"),o.appendChild(c.createTextNode(n)),A.appendChild(o),f=n)),!t||h.getAttribute("value")&&0!==k.length&&!i.jqmData("placeholder")||(t=!1,B=!0,null===h.getAttribute(z)&&(this._removePlaceholderAttr=!0),h.setAttribute(z,!0),r.hidePlaceholderMenuItems&&m.push("ui-screen-hidden"),s!==k&&(s=q.placeholder=k)),p=c.createElement("li"),h.disabled&&(m.push("ui-state-disabled"),p.setAttribute("aria-disabled",!0)),p.setAttribute(w,g),p.setAttribute(x,u),B&&p.setAttribute(z,!0),p.className=m.join(" "),p.setAttribute("role","option"),l.setAttribute("tabindex","-1"),this.isMultiple&&a(l).addClass("ui-btn ui-checkbox-off ui-btn-icon-right"),p.appendChild(l),A.appendChild(p));q.list[0].appendChild(A),this.isMultiple||s.length?this.headerTitle.text(this.placeholder):this.header.addClass("ui-screen-hidden"),q.list.listview()},_button:function(){return this.options.nativeMenu?this._super():a("<a>",{href:"#",role:"button",id:this.buttonId,"aria-haspopup":"true","aria-owns":this.menuId})},_destroy:function(){this.options.nativeMenu||(this.close(),this._origTabIndex!==b&&(this._origTabIndex!==!1?this.select.attr("tabindex",this._origTabIndex):this.select.removeAttr("tabindex")),this._removePlaceholderAttr&&this._selectOptions().removeAttr("data-"+a.mobile.ns+"placeholder"),this.listbox.remove(),this.menuPage.remove()),this._super()}})}(a),function(a,b){function c(a,b){var c=b?b:[];return c.push("ui-btn"),a.theme&&c.push("ui-btn-"+a.theme),a.icon&&(c=c.concat(["ui-icon-"+a.icon,"ui-btn-icon-"+a.iconpos]),a.iconshadow&&c.push("ui-shadow-icon")),a.inline&&c.push("ui-btn-inline"),a.shadow&&c.push("ui-shadow"),a.corners&&c.push("ui-corner-all"),a.mini&&c.push("ui-mini"),c}function d(a){var c,d,e,g=!1,h=!0,i={icon:"",inline:!1,shadow:!1,corners:!1,iconshadow:!1,mini:!1},j=[];for(a=a.split(" "),c=0;c<a.length;c++)e=!0,d=f[a[c]],d!==b?(e=!1,i[d]=!0):0===a[c].indexOf("ui-btn-icon-")?(e=!1,h=!1,i.iconpos=a[c].substring(12)):0===a[c].indexOf("ui-icon-")?(e=!1,i.icon=a[c].substring(8)):0===a[c].indexOf("ui-btn-")&&8===a[c].length?(e=!1,i.theme=a[c].substring(7)):"ui-btn"===a[c]&&(e=!1,g=!0),e&&j.push(a[c]);return h&&(i.icon=""),{options:i,unknownClasses:j,alreadyEnhanced:g}}function e(a){return"-"+a.toLowerCase()}var f={"ui-shadow":"shadow","ui-corner-all":"corners","ui-btn-inline":"inline","ui-shadow-icon":"iconshadow","ui-mini":"mini"},g=function(){var c=a.mobile.getAttribute.apply(this,arguments);return null==c?b:c},h=/[A-Z]/g;a.fn.buttonMarkup=function(f,i){var j,k,l,m,n,o=a.fn.buttonMarkup.defaults;for(j=0;j<this.length;j++){if(l=this[j],k=i?{alreadyEnhanced:!1,unknownClasses:[]}:d(l.className),m=a.extend({},k.alreadyEnhanced?k.options:{},f),!k.alreadyEnhanced)for(n in o)m[n]===b&&(m[n]=g(l,n.replace(h,e)));l.className=c(a.extend({},o,m),k.unknownClasses).join(" "),"button"!==l.tagName.toLowerCase()&&l.setAttribute("role","button")}return this},a.fn.buttonMarkup.defaults={icon:"",iconpos:"left",theme:null,inline:!1,shadow:!0,corners:!0,iconshadow:!1,mini:!1},a.extend(a.fn.buttonMarkup,{initSelector:"a:jqmData(role='button'), .ui-bar > a, .ui-bar > :jqmData(role='controlgroup') > a, button:not(:jqmData(role='navbar') button)"})}(a),function(a,b){a.widget("mobile.controlgroup",a.extend({options:{enhanced:!1,theme:null,shadow:!1,corners:!0,excludeInvisible:!0,type:"vertical",mini:!1},_create:function(){var b=this.element,c=this.options,d=a.mobile.page.prototype.keepNativeSelector();a.fn.buttonMarkup&&this.element.find(a.fn.buttonMarkup.initSelector).not(d).buttonMarkup(),a.each(this._childWidgets,a.proxy(function(b,c){a.mobile[c]&&this.element.find(a.mobile[c].initSelector).not(d)[c]()},this)),a.extend(this,{_ui:null,_initialRefresh:!0}),this._ui=c.enhanced?{groupLegend:b.children(".ui-controlgroup-label").children(),childWrapper:b.children(".ui-controlgroup-controls")}:this._enhance()},_childWidgets:["checkboxradio","selectmenu","button"],_themeClassFromOption:function(a){return a?"none"===a?"":"ui-group-theme-"+a:""},_enhance:function(){var b=this.element,c=this.options,d={groupLegend:b.children("legend"),childWrapper:b.addClass("ui-controlgroup ui-controlgroup-"+("horizontal"===c.type?"horizontal":"vertical")+" "+this._themeClassFromOption(c.theme)+" "+(c.corners?"ui-corner-all ":"")+(c.mini?"ui-mini ":"")).wrapInner("<div class='ui-controlgroup-controls "+(c.shadow===!0?"ui-shadow":"")+"'></div>").children()};return d.groupLegend.length>0&&a("<div role='heading' class='ui-controlgroup-label'></div>").append(d.groupLegend).prependTo(b),d},_init:function(){this.refresh()},_setOptions:function(a){var c,d,e=this.element;return a.type!==b&&(e.removeClass("ui-controlgroup-horizontal ui-controlgroup-vertical").addClass("ui-controlgroup-"+("horizontal"===a.type?"horizontal":"vertical")),c=!0),a.theme!==b&&e.removeClass(this._themeClassFromOption(this.options.theme)).addClass(this._themeClassFromOption(a.theme)),a.corners!==b&&e.toggleClass("ui-corner-all",a.corners),a.mini!==b&&e.toggleClass("ui-mini",a.mini),a.shadow!==b&&this._ui.childWrapper.toggleClass("ui-shadow",a.shadow),a.excludeInvisible!==b&&(this.options.excludeInvisible=a.excludeInvisible,c=!0),d=this._super(a),c&&this.refresh(),d},container:function(){return this._ui.childWrapper},refresh:function(){var b=this.container(),c=b.find(".ui-btn").not(".ui-slider-handle"),d=this._initialRefresh;a.mobile.checkboxradio&&b.find(":mobile-checkboxradio").checkboxradio("refresh"),this._addFirstLastClasses(c,this.options.excludeInvisible?this._getVisibles(c,d):c,d),this._initialRefresh=!1},_destroy:function(){var a,b,c=this.options;return c.enhanced?this:(a=this._ui,b=this.element.removeClass("ui-controlgroup ui-controlgroup-horizontal ui-controlgroup-vertical ui-corner-all ui-mini "+this._themeClassFromOption(c.theme)).find(".ui-btn").not(".ui-slider-handle"),this._removeFirstLastClasses(b),a.groupLegend.unwrap(),void a.childWrapper.children().unwrap())}},a.mobile.behaviors.addFirstLastClasses))}(a),function(a,b){a.widget("mobile.toolbar",{initSelector:":jqmData(role='footer'), :jqmData(role='header')",options:{theme:null,addBackBtn:!1,backBtnTheme:null,backBtnText:"Back"},_create:function(){var b,c,d=this.element.is(":jqmData(role='header')")?"header":"footer",e=this.element.closest(".ui-page");0===e.length&&(e=!1,this._on(this.document,{pageshow:"refresh"})),a.extend(this,{role:d,page:e,leftbtn:b,rightbtn:c}),this.element.attr("role","header"===d?"banner":"contentinfo").addClass("ui-"+d),this.refresh(),this._setOptions(this.options)},_setOptions:function(a){if(a.addBackBtn!==b&&this._updateBackButton(),null!=a.backBtnTheme&&this.element.find(".ui-toolbar-back-btn").addClass("ui-btn ui-btn-"+a.backBtnTheme),a.backBtnText!==b&&this.element.find(".ui-toolbar-back-btn .ui-btn-text").text(a.backBtnText),a.theme!==b){var c=this.options.theme?this.options.theme:"inherit",d=a.theme?a.theme:"inherit";this.element.removeClass("ui-bar-"+c).addClass("ui-bar-"+d)}this._super(a)},refresh:function(){"header"===this.role&&this._addHeaderButtonClasses(),this.page||(this._setRelative(),"footer"===this.role?this.element.appendTo("body"):"header"===this.role&&this._updateBackButton()),this._addHeadingClasses(),this._btnMarkup()},_setRelative:function(){a("[data-"+a.mobile.ns+"role='page']").css({position:"relative"})},_btnMarkup:function(){this.element.children("a").filter(":not([data-"+a.mobile.ns+"role='none'])").attr("data-"+a.mobile.ns+"role","button"),this.element.trigger("create")},_addHeaderButtonClasses:function(){var a=this.element.children("a, button");this.leftbtn=a.hasClass("ui-btn-left")&&!a.hasClass("ui-toolbar-back-btn"),this.rightbtn=a.hasClass("ui-btn-right"),this.leftbtn=this.leftbtn||a.eq(0).not(".ui-btn-right,.ui-toolbar-back-btn").addClass("ui-btn-left").length,this.rightbtn=this.rightbtn||a.eq(1).addClass("ui-btn-right").length},_updateBackButton:function(){var b,c=this.options,d=c.backBtnTheme||c.theme;b=this._backButton=this._backButton||{},this.options.addBackBtn&&"header"===this.role&&a(".ui-page").length>1&&(this.page?this.page[0].getAttribute("data-"+a.mobile.ns+"url")!==a.mobile.path.stripHash(location.hash):a.mobile.navigate&&a.mobile.navigate.history&&a.mobile.navigate.history.activeIndex>0)&&!this.leftbtn?b.attached||(this.backButton=b.element=(b.element||a("<a role='button' href='javascript:void(0);' class='ui-btn ui-corner-all ui-shadow ui-btn-left "+(d?"ui-btn-"+d+" ":"")+"ui-toolbar-back-btn ui-icon-carat-l ui-btn-icon-left' data-"+a.mobile.ns+"rel='back'>"+c.backBtnText+"</a>")).prependTo(this.element),b.attached=!0):b.element&&(b.element.detach(),b.attached=!1)},_addHeadingClasses:function(){this.element.children("h1, h2, h3, h4, h5, h6").addClass("ui-title").attr({role:"heading","aria-level":"1"})},_destroy:function(){var a;this.element.children("h1, h2, h3, h4, h5, h6").removeClass("ui-title").removeAttr("role").removeAttr("aria-level"),"header"===this.role&&(this.element.children("a, button").removeClass("ui-btn-left ui-btn-right ui-btn ui-shadow ui-corner-all"),this.backButton&&this.backButton.remove()),a=this.options.theme?this.options.theme:"inherit",this.element.removeClass("ui-bar-"+a),this.element.removeClass("ui-"+this.role).removeAttr("role")}})}(a),function(a,b){a.widget("mobile.toolbar",a.mobile.toolbar,{options:{position:null,visibleOnPageShow:!0,disablePageZoom:!0,transition:"slide",fullscreen:!1,tapToggle:!0,tapToggleBlacklist:"a, button, input, select, textarea, .ui-header-fixed, .ui-footer-fixed, .ui-flipswitch, .ui-popup, .ui-panel, .ui-panel-dismiss-open",hideDuringFocus:"input, textarea, select",updatePagePadding:!0,trackPersistentToolbars:!0,supportBlacklist:function(){return!a.support.fixedPosition}},_create:function(){this._super(),this.pagecontainer=a(":mobile-pagecontainer"),"fixed"!==this.options.position||this.options.supportBlacklist()||this._makeFixed()},_makeFixed:function(){this.element.addClass("ui-"+this.role+"-fixed"),this.updatePagePadding(),this._addTransitionClass(),this._bindPageEvents(),this._bindToggleHandlers()},_setOptions:function(c){if("fixed"===c.position&&"fixed"!==this.options.position&&this._makeFixed(),"fixed"===this.options.position&&!this.options.supportBlacklist()){var d=this.page?this.page:a(".ui-page-active").length>0?a(".ui-page-active"):a(".ui-page").eq(0);c.fullscreen!==b&&(c.fullscreen?(this.element.addClass("ui-"+this.role+"-fullscreen"),d.addClass("ui-page-"+this.role+"-fullscreen")):(this.element.removeClass("ui-"+this.role+"-fullscreen"),d.removeClass("ui-page-"+this.role+"-fullscreen").addClass("ui-page-"+this.role+"-fixed")))}this._super(c)},_addTransitionClass:function(){var a=this.options.transition;a&&"none"!==a&&("slide"===a&&(a=this.element.hasClass("ui-header")?"slidedown":"slideup"),this.element.addClass(a))},_bindPageEvents:function(){var a=this.page?this.element.closest(".ui-page"):this.document;this._on(a,{pagebeforeshow:"_handlePageBeforeShow",webkitAnimationStart:"_handleAnimationStart",animationstart:"_handleAnimationStart",updatelayout:"_handleAnimationStart",pageshow:"_handlePageShow",pagebeforehide:"_handlePageBeforeHide"})},_handlePageBeforeShow:function(){var b=this.options;b.disablePageZoom&&a.mobile.zoom.disable(!0),b.visibleOnPageShow||this.hide(!0)},_handleAnimationStart:function(){this.options.updatePagePadding&&this.updatePagePadding(this.page?this.page:".ui-page-active")},_handlePageShow:function(){this.updatePagePadding(this.page?this.page:".ui-page-active"),this.options.updatePagePadding&&this._on(this.window,{throttledresize:"updatePagePadding"})},_handlePageBeforeHide:function(b,c){var d,e,f,g,h=this.options;h.disablePageZoom&&a.mobile.zoom.enable(!0),h.updatePagePadding&&this._off(this.window,"throttledresize"),h.trackPersistentToolbars&&(d=a(".ui-footer-fixed:jqmData(id)",this.page),e=a(".ui-header-fixed:jqmData(id)",this.page),f=d.length&&c.nextPage&&a(".ui-footer-fixed:jqmData(id='"+d.jqmData("id")+"')",c.nextPage)||a(),g=e.length&&c.nextPage&&a(".ui-header-fixed:jqmData(id='"+e.jqmData("id")+"')",c.nextPage)||a(),(f.length||g.length)&&(f.add(g).appendTo(a.mobile.pageContainer),c.nextPage.one("pageshow",function(){g.prependTo(this),f.appendTo(this)})))},_visible:!0,updatePagePadding:function(c){var d=this.element,e="header"===this.role,f=parseFloat(d.css(e?"top":"bottom"));this.options.fullscreen||(c=c&&c.type===b&&c||this.page||d.closest(".ui-page"),c=this.page?this.page:".ui-page-active",a(c).css("padding-"+(e?"top":"bottom"),d.outerHeight()+f))},_useTransition:function(b){var c=this.window,d=this.element,e=c.scrollTop(),f=d.height(),g=this.page?d.closest(".ui-page").height():a(".ui-page-active").height(),h=a.mobile.getScreenHeight();return!b&&(this.options.transition&&"none"!==this.options.transition&&("header"===this.role&&!this.options.fullscreen&&e>f||"footer"===this.role&&!this.options.fullscreen&&g-f>e+h)||this.options.fullscreen)},show:function(a){var b="ui-fixed-hidden",c=this.element;this._useTransition(a)?c.removeClass("out "+b).addClass("in").animationComplete(function(){c.removeClass("in")}):c.removeClass(b),this._visible=!0},hide:function(a){var b="ui-fixed-hidden",c=this.element,d="out"+("slide"===this.options.transition?" reverse":"");this._useTransition(a)?c.addClass(d).removeClass("in").animationComplete(function(){c.addClass(b).removeClass(d)}):c.addClass(b).removeClass(d),this._visible=!1},toggle:function(){this[this._visible?"hide":"show"]()},_bindToggleHandlers:function(){var b,c,d=this,e=d.options,f=!0,g=this.page?this.page:a(".ui-page");g.bind("vclick",function(b){e.tapToggle&&!a(b.target).closest(e.tapToggleBlacklist).length&&d.toggle()}).bind("focusin focusout",function(g){screen.width<1025&&a(g.target).is(e.hideDuringFocus)&&!a(g.target).closest(".ui-header-fixed, .ui-footer-fixed").length&&("focusout"!==g.type||f?"focusin"===g.type&&f&&(clearTimeout(b),f=!1,c=setTimeout(function(){d.hide()},0)):(f=!0,clearTimeout(c),b=setTimeout(function(){d.show()},0)))})},_setRelative:function(){"fixed"!==this.options.position&&a("[data-"+a.mobile.ns+"role='page']").css({position:"relative"})},_destroy:function(){var b,c,d,e,f,g=this.pagecontainer.pagecontainer("getActivePage");this._super(),"fixed"===this.options.position&&(d=a("body>.ui-"+this.role+"-fixed").add(g.find(".ui-"+this.options.role+"-fixed")).not(this.element).length>0,f=a("body>.ui-"+this.role+"-fixed").add(g.find(".ui-"+this.options.role+"-fullscreen")).not(this.element).length>0,c="ui-header-fixed ui-footer-fixed ui-header-fullscreen in out ui-footer-fullscreen fade slidedown slideup ui-fixed-hidden",this.element.removeClass(c),f||(b="ui-page-"+this.role+"-fullscreen"),d||(e="header"===this.role,b+=" ui-page-"+this.role+"-fixed",g.css("padding-"+(e?"top":"bottom"),"")),g.removeClass(b))}})}(a),function(a){a.widget("mobile.toolbar",a.mobile.toolbar,{_makeFixed:function(){this._super(),this._workarounds()},_workarounds:function(){var a=navigator.userAgent,b=navigator.platform,c=a.match(/AppleWebKit\/([0-9]+)/),d=!!c&&c[1],e=null,f=this;if(b.indexOf("iPhone")>-1||b.indexOf("iPad")>-1||b.indexOf("iPod")>-1)e="ios";else{if(!(a.indexOf("Android")>-1))return;e="android"}if("ios"===e)f._bindScrollWorkaround();else{if(!("android"===e&&d&&534>d))return;f._bindScrollWorkaround(),f._bindListThumbWorkaround()}},_viewportOffset:function(){var a=this.element,b=a.hasClass("ui-header"),c=Math.abs(a.offset().top-this.window.scrollTop());return b||(c=Math.round(c-this.window.height()+a.outerHeight())-60),c},_bindScrollWorkaround:function(){var a=this;this._on(this.window,{scrollstop:function(){var b=a._viewportOffset();b>2&&a._visible&&a._triggerRedraw()}})},_bindListThumbWorkaround:function(){this.element.closest(".ui-page").addClass("ui-android-2x-fixed")},_triggerRedraw:function(){var b=parseFloat(a(".ui-page-active").css("padding-bottom"));a(".ui-page-active").css("padding-bottom",b+1+"px"),setTimeout(function(){a(".ui-page-active").css("padding-bottom",b+"px")},0)},destroy:function(){this._super(),this.element.closest(".ui-page-active").removeClass("ui-android-2x-fix")}})}(a),function(a,b){function c(){var a=e.clone(),b=a.eq(0),c=a.eq(1),d=c.children();return{arEls:c.add(b),gd:b,ct:c,ar:d}}var d=a.mobile.browser.oldIE&&a.mobile.browser.oldIE<=8,e=a("<div class='ui-popup-arrow-guide'></div><div class='ui-popup-arrow-container"+(d?" ie":"")+"'><div class='ui-popup-arrow'></div></div>");a.widget("mobile.popup",a.mobile.popup,{options:{arrow:""},_create:function(){var a,b=this._super();return this.options.arrow&&(this._ui.arrow=a=this._addArrow()),b},_addArrow:function(){var a,b=this.options,d=c();return a=this._themeClassFromOption("ui-body-",b.theme),d.ar.addClass(a+(b.shadow?" ui-overlay-shadow":"")),d.arEls.hide().appendTo(this.element),d},_unenhance:function(){var a=this._ui.arrow;return a&&a.arEls.remove(),this._super()},_tryAnArrow:function(a,b,c,d,e){var f,g,h,i={},j={};return d.arFull[a.dimKey]>d.guideDims[a.dimKey]?e:(i[a.fst]=c[a.fst]+(d.arHalf[a.oDimKey]+d.menuHalf[a.oDimKey])*a.offsetFactor-d.contentBox[a.fst]+(d.clampInfo.menuSize[a.oDimKey]-d.contentBox[a.oDimKey])*a.arrowOffsetFactor,i[a.snd]=c[a.snd],f=d.result||this._calculateFinalLocation(i,d.clampInfo),g={x:f.left,y:f.top},j[a.fst]=g[a.fst]+d.contentBox[a.fst]+a.tipOffset,j[a.snd]=Math.max(f[a.prop]+d.guideOffset[a.prop]+d.arHalf[a.dimKey],Math.min(f[a.prop]+d.guideOffset[a.prop]+d.guideDims[a.dimKey]-d.arHalf[a.dimKey],c[a.snd])),h=Math.abs(c.x-j.x)+Math.abs(c.y-j.y),(!e||h<e.diff)&&(j[a.snd]-=d.arHalf[a.dimKey]+f[a.prop]+d.contentBox[a.snd],e={dir:b,diff:h,result:f,posProp:a.prop,posVal:j[a.snd]}),e)},_getPlacementState:function(a){var b,c,d=this._ui.arrow,e={clampInfo:this._clampPopupWidth(!a),arFull:{cx:d.ct.width(),cy:d.ct.height()},guideDims:{cx:d.gd.width(),cy:d.gd.height()},guideOffset:d.gd.offset()};return b=this.element.offset(),d.gd.css({left:0,top:0,right:0,bottom:0}),c=d.gd.offset(),e.contentBox={x:c.left-b.left,y:c.top-b.top,cx:d.gd.width(),cy:d.gd.height()},d.gd.removeAttr("style"),e.guideOffset={left:e.guideOffset.left-b.left,top:e.guideOffset.top-b.top},e.arHalf={cx:e.arFull.cx/2,cy:e.arFull.cy/2},e.menuHalf={cx:e.clampInfo.menuSize.cx/2,cy:e.clampInfo.menuSize.cy/2},e},_placementCoords:function(b){var c,e,f,g,h,i=this.options.arrow,j=this._ui.arrow;return j?(j.arEls.show(),h={},c=this._getPlacementState(!0),f={l:{fst:"x",snd:"y",prop:"top",dimKey:"cy",oDimKey:"cx",offsetFactor:1,tipOffset:-c.arHalf.cx,arrowOffsetFactor:0},r:{fst:"x",snd:"y",prop:"top",dimKey:"cy",oDimKey:"cx",offsetFactor:-1,tipOffset:c.arHalf.cx+c.contentBox.cx,arrowOffsetFactor:1},b:{fst:"y",snd:"x",prop:"left",dimKey:"cx",oDimKey:"cy",offsetFactor:-1,tipOffset:c.arHalf.cy+c.contentBox.cy,arrowOffsetFactor:1},t:{fst:"y",snd:"x",prop:"left",dimKey:"cx",oDimKey:"cy",offsetFactor:1,tipOffset:-c.arHalf.cy,arrowOffsetFactor:0}},a.each((i===!0?"l,t,r,b":i).split(","),a.proxy(function(a,d){e=this._tryAnArrow(f[d],d,b,c,e)},this)),e?(j.ct.removeClass("ui-popup-arrow-l ui-popup-arrow-t ui-popup-arrow-r ui-popup-arrow-b").addClass("ui-popup-arrow-"+e.dir).removeAttr("style").css(e.posProp,e.posVal).show(),d||(g=this.element.offset(),h[f[e.dir].fst]=j.ct.offset(),h[f[e.dir].snd]={left:g.left+c.contentBox.x,top:g.top+c.contentBox.y}),e.result):(j.arEls.hide(),this._super(b))):this._super(b)},_setOptions:function(a){var c,d=this.options.theme,e=this._ui.arrow,f=this._super(a);if(a.arrow!==b){if(!e&&a.arrow)return void(this._ui.arrow=this._addArrow());e&&!a.arrow&&(e.arEls.remove(),this._ui.arrow=null)}return e=this._ui.arrow,e&&(a.theme!==b&&(d=this._themeClassFromOption("ui-body-",d),c=this._themeClassFromOption("ui-body-",a.theme),e.ar.removeClass(d).addClass(c)),a.shadow!==b&&e.ar.toggleClass("ui-overlay-shadow",a.shadow)),f},_destroy:function(){var a=this._ui.arrow;return a&&a.arEls.remove(),this._super()}})}(a),function(a,c){a.widget("mobile.panel",{options:{classes:{panel:"ui-panel",panelOpen:"ui-panel-open",panelClosed:"ui-panel-closed",panelFixed:"ui-panel-fixed",panelInner:"ui-panel-inner",modal:"ui-panel-dismiss",modalOpen:"ui-panel-dismiss-open",pageContainer:"ui-panel-page-container",pageWrapper:"ui-panel-wrapper",pageFixedToolbar:"ui-panel-fixed-toolbar",pageContentPrefix:"ui-panel-page-content",animate:"ui-panel-animate"},animate:!0,theme:null,position:"left",dismissible:!0,display:"reveal",swipeClose:!0,positionFixed:!1},_closeLink:null,_parentPage:null,_page:null,_modal:null,_panelInner:null,_wrapper:null,_fixedToolbars:null,_create:function(){var b=this.element,c=b.closest(".ui-page, :jqmData(role='page')");a.extend(this,{_closeLink:b.find(":jqmData(rel='close')"),_parentPage:c.length>0&&c,_openedPage:null,_page:this._getPage,_panelInner:this._getPanelInner(),_fixedToolbars:this._getFixedToolbars}),"overlay"!==this.options.display&&this._getWrapper(),this._addPanelClasses(),a.support.cssTransform3d&&this.options.animate&&this.element.addClass(this.options.classes.animate),this._bindUpdateLayout(),this._bindCloseEvents(),this._bindLinkListeners(),this._bindPageEvents(),this.options.dismissible&&this._createModal(),this._bindSwipeEvents()},_getPanelInner:function(){var a=this.element.find("."+this.options.classes.panelInner);return 0===a.length&&(a=this.element.children().wrapAll("<div class='"+this.options.classes.panelInner+"' />").parent()),a},_createModal:function(){var b=this,c=b._parentPage?b._parentPage.parent():b.element.parent();b._modal=a("<div class='"+b.options.classes.modal+"'></div>").on("mousedown",function(){b.close()}).appendTo(c)},_getPage:function(){var b=this._openedPage||this._parentPage||a("."+a.mobile.activePageClass);return b},_getWrapper:function(){var a=this._page().find("."+this.options.classes.pageWrapper);0===a.length&&(a=this._page().children(".ui-header:not(.ui-header-fixed), .ui-content:not(.ui-popup), .ui-footer:not(.ui-footer-fixed)").wrapAll("<div class='"+this.options.classes.pageWrapper+"'></div>").parent()),this._wrapper=a},_getFixedToolbars:function(){var b=a("body").children(".ui-header-fixed, .ui-footer-fixed"),c=this._page().find(".ui-header-fixed, .ui-footer-fixed"),d=b.add(c).addClass(this.options.classes.pageFixedToolbar);return d},_getPosDisplayClasses:function(a){return a+"-position-"+this.options.position+" "+a+"-display-"+this.options.display},_getPanelClasses:function(){var a=this.options.classes.panel+" "+this._getPosDisplayClasses(this.options.classes.panel)+" "+this.options.classes.panelClosed+" ui-body-"+(this.options.theme?this.options.theme:"inherit");return this.options.positionFixed&&(a+=" "+this.options.classes.panelFixed),a},_addPanelClasses:function(){this.element.addClass(this._getPanelClasses())},_handleCloseClick:function(a){a.isDefaultPrevented()||this.close()},_bindCloseEvents:function(){this._on(this._closeLink,{click:"_handleCloseClick"}),this._on({"click a:jqmData(ajax='false')":"_handleCloseClick"})},_positionPanel:function(b){var c=this,d=c._panelInner.outerHeight(),e=d>a.mobile.getScreenHeight();e||!c.options.positionFixed?(e&&(c._unfixPanel(),a.mobile.resetActivePageHeight(d)),b&&this.window[0].scrollTo(0,a.mobile.defaultHomeScroll)):c._fixPanel()},_bindFixListener:function(){this._on(a(b),{throttledresize:"_positionPanel"})},_unbindFixListener:function(){this._off(a(b),"throttledresize")},_unfixPanel:function(){this.options.positionFixed&&a.support.fixedPosition&&this.element.removeClass(this.options.classes.panelFixed)},_fixPanel:function(){this.options.positionFixed&&a.support.fixedPosition&&this.element.addClass(this.options.classes.panelFixed)},_bindUpdateLayout:function(){var a=this;a.element.on("updatelayout",function(){a._open&&a._positionPanel()})},_bindLinkListeners:function(){this._on("body",{"click a":"_handleClick"})},_handleClick:function(b){var d,e=this.element.attr("id");b.currentTarget.href.split("#")[1]===e&&e!==c&&(b.preventDefault(),d=a(b.target),d.hasClass("ui-btn")&&(d.addClass(a.mobile.activeBtnClass),this.element.one("panelopen panelclose",function(){d.removeClass(a.mobile.activeBtnClass)})),this.toggle())},_bindSwipeEvents:function(){var a=this,b=a._modal?a.element.add(a._modal):a.element;a.options.swipeClose&&("left"===a.options.position?b.on("swipeleft.panel",function(){a.close()}):b.on("swiperight.panel",function(){a.close()}))},_bindPageEvents:function(){var a=this;this.document.on("panelbeforeopen",function(b){a._open&&b.target!==a.element[0]&&a.close()}).on("keyup.panel",function(b){27===b.keyCode&&a._open&&a.close()}),this._parentPage||"overlay"===this.options.display||this._on(this.document,{pageshow:function(){this._openedPage=null,this._getWrapper()}}),a._parentPage?this.document.on("pagehide",":jqmData(role='page')",function(){a._open&&a.close(!0)}):this.document.on("pagebeforehide",function(){a._open&&a.close(!0)})},_open:!1,_pageContentOpenClasses:null,_modalOpenClasses:null,open:function(b){if(!this._open){var c=this,d=c.options,e=function(){c._off(c.document,"panelclose"),c._page().jqmData("panel","open"),a.support.cssTransform3d&&d.animate&&"overlay"!==d.display&&(c._wrapper.addClass(d.classes.animate),c._fixedToolbars().addClass(d.classes.animate)),!b&&a.support.cssTransform3d&&d.animate?(c._wrapper||c.element).animationComplete(f,"transition"):setTimeout(f,0),d.theme&&"overlay"!==d.display&&c._page().parent().addClass(d.classes.pageContainer+"-themed "+d.classes.pageContainer+"-"+d.theme),c.element.removeClass(d.classes.panelClosed).addClass(d.classes.panelOpen),c._positionPanel(!0),c._pageContentOpenClasses=c._getPosDisplayClasses(d.classes.pageContentPrefix),"overlay"!==d.display&&(c._page().parent().addClass(d.classes.pageContainer),c._wrapper.addClass(c._pageContentOpenClasses),c._fixedToolbars().addClass(c._pageContentOpenClasses)),c._modalOpenClasses=c._getPosDisplayClasses(d.classes.modal)+" "+d.classes.modalOpen,c._modal&&c._modal.addClass(c._modalOpenClasses).height(Math.max(c._modal.height(),c.document.height()))},f=function(){c._open&&("overlay"!==d.display&&(c._wrapper.addClass(d.classes.pageContentPrefix+"-open"),c._fixedToolbars().addClass(d.classes.pageContentPrefix+"-open")),c._bindFixListener(),c._trigger("open"),c._openedPage=c._page())};c._trigger("beforeopen"),"open"===c._page().jqmData("panel")?c._on(c.document,{panelclose:e}):e(),c._open=!0}},close:function(b){if(this._open){var c=this,d=this.options,e=function(){c.element.removeClass(d.classes.panelOpen),"overlay"!==d.display&&(c._wrapper.removeClass(c._pageContentOpenClasses),c._fixedToolbars().removeClass(c._pageContentOpenClasses)),!b&&a.support.cssTransform3d&&d.animate?(c._wrapper||c.element).animationComplete(f,"transition"):setTimeout(f,0),c._modal&&c._modal.removeClass(c._modalOpenClasses).height("")},f=function(){d.theme&&"overlay"!==d.display&&c._page().parent().removeClass(d.classes.pageContainer+"-themed "+d.classes.pageContainer+"-"+d.theme),c.element.addClass(d.classes.panelClosed),"overlay"!==d.display&&(c._page().parent().removeClass(d.classes.pageContainer),c._wrapper.removeClass(d.classes.pageContentPrefix+"-open"),c._fixedToolbars().removeClass(d.classes.pageContentPrefix+"-open")),a.support.cssTransform3d&&d.animate&&"overlay"!==d.display&&(c._wrapper.removeClass(d.classes.animate),c._fixedToolbars().removeClass(d.classes.animate)),c._fixPanel(),c._unbindFixListener(),a.mobile.resetActivePageHeight(),c._page().jqmRemoveData("panel"),c._trigger("close"),c._openedPage=null};c._trigger("beforeclose"),e(),c._open=!1}},toggle:function(){this[this._open?"close":"open"]()},_destroy:function(){var b,c=this.options,d=a("body > :mobile-panel").length+a.mobile.activePage.find(":mobile-panel").length>1;"overlay"!==c.display&&(b=a("body > :mobile-panel").add(a.mobile.activePage.find(":mobile-panel")),0===b.not(".ui-panel-display-overlay").not(this.element).length&&this._wrapper.children().unwrap(),this._open&&(this._fixedToolbars().removeClass(c.classes.pageContentPrefix+"-open"),a.support.cssTransform3d&&c.animate&&this._fixedToolbars().removeClass(c.classes.animate),this._page().parent().removeClass(c.classes.pageContainer),c.theme&&this._page().parent().removeClass(c.classes.pageContainer+"-themed "+c.classes.pageContainer+"-"+c.theme))),d||this.document.off("panelopen panelclose"),this._open&&this._page().jqmRemoveData("panel"),this._panelInner.children().unwrap(),this.element.removeClass([this._getPanelClasses(),c.classes.panelOpen,c.classes.animate].join(" ")).off("swipeleft.panel swiperight.panel").off("panelbeforeopen").off("panelhide").off("keyup.panel").off("updatelayout"),this._modal&&this._modal.remove()}})}(a),function(a,b){a.widget("mobile.table",{options:{classes:{table:"ui-table"},enhanced:!1},_create:function(){this.options.enhanced||this.element.addClass(this.options.classes.table),a.extend(this,{headers:b,allHeaders:b}),this._refresh(!0)},_setHeaders:function(){var a=this.element.find("thead tr");this.headers=this.element.find("tr:eq(0)").children(),this.allHeaders=this.headers.add(a.children())},refresh:function(){this._refresh()},rebuild:a.noop,_refresh:function(){var b=this.element,c=b.find("thead tr");this._setHeaders(),c.each(function(){var d=0;a(this).children().each(function(){var e,f=parseInt(this.getAttribute("colspan"),10),g=":nth-child("+(d+1)+")";if(this.setAttribute("data-"+a.mobile.ns+"colstart",d+1),f)for(e=0;f-1>e;e++)d++,g+=", :nth-child("+(d+1)+")";a(this).jqmData("cells",b.find("tr").not(c.eq(0)).not(this).children(g)),d++})})}})}(a),function(a){a.widget("mobile.table",a.mobile.table,{options:{mode:"columntoggle",columnBtnTheme:null,columnPopupTheme:null,columnBtnText:"Columns...",classes:a.extend(a.mobile.table.prototype.options.classes,{popup:"ui-table-columntoggle-popup",columnBtn:"ui-table-columntoggle-btn",priorityPrefix:"ui-table-priority-",columnToggleTable:"ui-table-columntoggle"})},_create:function(){this._super(),"columntoggle"===this.options.mode&&(a.extend(this,{_menu:null}),this.options.enhanced?(this._menu=a(this.document[0].getElementById(this._id()+"-popup")).children().first(),this._addToggles(this._menu,!0)):(this._menu=this._enhanceColToggle(),this.element.addClass(this.options.classes.columnToggleTable)),this._setupEvents(),this._setToggleState())},_id:function(){return this.element.attr("id")||this.widgetName+this.uuid},_setupEvents:function(){this._on(this.window,{throttledresize:"_setToggleState"}),this._on(this._menu,{"change input":"_menuInputChange"})},_addToggles:function(b,c){var d,e=0,f=this.options,g=b.controlgroup("container");c?d=b.find("input"):g.empty(),this.headers.not("td").each(function(){var b,h,i=a(this),j=a.mobile.getAttribute(this,"priority");j&&(h=i.add(i.jqmData("cells")),h.addClass(f.classes.priorityPrefix+j),b=(c?d.eq(e++):a("<label><input type='checkbox' checked />"+(i.children("abbr").first().attr("title")||i.text())+"</label>").appendTo(g).children(0).checkboxradio({theme:f.columnPopupTheme})).jqmData("header",i).jqmData("cells",h),i.jqmData("input",b))}),c||b.controlgroup("refresh")},_menuInputChange:function(b){var c=a(b.target),d=c[0].checked;c.jqmData("cells").toggleClass("ui-table-cell-hidden",!d).toggleClass("ui-table-cell-visible",d)},_unlockCells:function(a){a.removeClass("ui-table-cell-hidden ui-table-cell-visible")},_enhanceColToggle:function(){var b,c,d,e,f=this.element,g=this.options,h=a.mobile.ns,i=this.document[0].createDocumentFragment();return b=this._id()+"-popup",c=a("<a href='#"+b+"' class='"+g.classes.columnBtn+" ui-btn ui-btn-"+(g.columnBtnTheme||"a")+" ui-corner-all ui-shadow ui-mini' data-"+h+"rel='popup'>"+g.columnBtnText+"</a>"),d=a("<div class='"+g.classes.popup+"' id='"+b+"'></div>"),e=a("<fieldset></fieldset>").controlgroup(),this._addToggles(e,!1),e.appendTo(d),i.appendChild(d[0]),i.appendChild(c[0]),f.before(i),d.popup(),e},rebuild:function(){this._super(),"columntoggle"===this.options.mode&&this._refresh(!1)},_refresh:function(b){var c,d,e;if(this._super(b),
!b&&"columntoggle"===this.options.mode)for(c=this.headers,d=[],this._menu.find("input").each(function(){var b=a(this),e=b.jqmData("header"),f=c.index(e[0]);f>-1&&!b.prop("checked")&&d.push(f)}),this._unlockCells(this.element.find(".ui-table-cell-hidden, .ui-table-cell-visible")),this._addToggles(this._menu,b),e=d.length-1;e>-1;e--)c.eq(d[e]).jqmData("input").prop("checked",!1).checkboxradio("refresh").trigger("change")},_setToggleState:function(){this._menu.find("input").each(function(){var b=a(this);this.checked="table-cell"===b.jqmData("cells").eq(0).css("display"),b.checkboxradio("refresh")})},_destroy:function(){this._super()}})}(a),function(a){a.widget("mobile.table",a.mobile.table,{options:{mode:"reflow",classes:a.extend(a.mobile.table.prototype.options.classes,{reflowTable:"ui-table-reflow",cellLabels:"ui-table-cell-label"})},_create:function(){this._super(),"reflow"===this.options.mode&&(this.options.enhanced||(this.element.addClass(this.options.classes.reflowTable),this._updateReflow()))},rebuild:function(){this._super(),"reflow"===this.options.mode&&this._refresh(!1)},_refresh:function(a){this._super(a),a||"reflow"!==this.options.mode||this._updateReflow()},_updateReflow:function(){var b=this,c=this.options;a(b.allHeaders.get().reverse()).each(function(){var d,e,f=a(this).jqmData("cells"),g=a.mobile.getAttribute(this,"colstart"),h=f.not(this).filter("thead th").length&&" ui-table-cell-label-top",i=a(this).clone().contents();i.length>0&&(h?(d=parseInt(this.getAttribute("colspan"),10),e="",d&&(e="td:nth-child("+d+"n + "+g+")"),b._addLabels(f.filter(e),c.classes.cellLabels+h,i)):b._addLabels(f,c.classes.cellLabels,i))})},_addLabels:function(b,c,d){1===d.length&&"abbr"===d[0].nodeName.toLowerCase()&&(d=d.eq(0).attr("title")),b.not(":has(b."+c+")").prepend(a("<b class='"+c+"'></b>").append(d))}})}(a),function(a,c){var d=function(b,c){return-1===(""+(a.mobile.getAttribute(this,"filtertext")||a(this).text())).toLowerCase().indexOf(c)};a.widget("mobile.filterable",{initSelector:":jqmData(filter='true')",options:{filterReveal:!1,filterCallback:d,enhanced:!1,input:null,children:"> li, > option, > optgroup option, > tbody tr, > .ui-controlgroup-controls > .ui-btn, > .ui-controlgroup-controls > .ui-checkbox, > .ui-controlgroup-controls > .ui-radio"},_create:function(){var b=this.options;a.extend(this,{_search:null,_timer:0}),this._setInput(b.input),b.enhanced||this._filterItems((this._search&&this._search.val()||"").toLowerCase())},_onKeyUp:function(){var c,d,e=this._search;if(e){if(c=e.val().toLowerCase(),d=a.mobile.getAttribute(e[0],"lastval")+"",d&&d===c)return;this._timer&&(b.clearTimeout(this._timer),this._timer=0),this._timer=this._delay(function(){return this._trigger("beforefilter",null,{input:e})!==!1&&(e[0].setAttribute("data-"+a.mobile.ns+"lastval",c),this._filterItems(c),void(this._timer=0))},250)}},_getFilterableItems:function(){var b=this.element,c=this.options.children,d=c?a.isFunction(c)?c():c.nodeName?a(c):c.jquery?c:this.element.find(c):{length:0};return 0===d.length&&(d=b.children()),d},_filterItems:function(b){var c,e,f,g,h=[],i=[],j=this.options,k=this._getFilterableItems();if(null!=b)for(e=j.filterCallback||d,f=k.length,c=0;f>c;c++)g=e.call(k[c],c,b)?i:h,g.push(k[c]);0===i.length?k[j.filterReveal&&0===b.length?"addClass":"removeClass"]("ui-screen-hidden"):(a(i).addClass("ui-screen-hidden"),a(h).removeClass("ui-screen-hidden")),this._refreshChildWidget(),this._trigger("filter",null,{items:k})},_refreshChildWidget:function(){var b,c,d=["collapsibleset","selectmenu","controlgroup","listview"];for(c=d.length-1;c>-1;c--)b=d[c],a.mobile[b]&&(b=this.element.data("mobile-"+b),b&&a.isFunction(b.refresh)&&b.refresh())},_setInput:function(c){var d=this._search;this._timer&&(b.clearTimeout(this._timer),this._timer=0),d&&(this._off(d,"keyup change input"),d=null),c&&(d=c.jquery?c:c.nodeName?a(c):this.document.find(c),this._on(d,{keydown:"_onKeyDown",keypress:"_onKeyPress",keyup:"_onKeyUp",change:"_onKeyUp",input:"_onKeyUp"})),this._search=d},_onKeyDown:function(b){b.keyCode===a.ui.keyCode.ENTER&&(b.preventDefault(),this._preventKeyPress=!0)},_onKeyPress:function(a){this._preventKeyPress&&(a.preventDefault(),this._preventKeyPress=!1)},_setOptions:function(a){var b=!(a.filterReveal===c&&a.filterCallback===c&&a.children===c);this._super(a),a.input!==c&&(this._setInput(a.input),b=!0),b&&this.refresh()},_destroy:function(){var a=this.options,b=this._getFilterableItems();a.enhanced?b.toggleClass("ui-screen-hidden",a.filterReveal):b.removeClass("ui-screen-hidden")},refresh:function(){this._timer&&(b.clearTimeout(this._timer),this._timer=0),this._filterItems((this._search&&this._search.val()||"").toLowerCase())}})}(a),function(a,b){var c=function(a,b){return function(c){b.call(this,c),a._syncTextInputOptions(c)}},d=/(^|\s)ui-li-divider(\s|$)/,e=a.mobile.filterable.prototype.options.filterCallback;a.mobile.filterable.prototype.options.filterCallback=function(a,b){return!this.className.match(d)&&e.call(this,a,b)},a.widget("mobile.filterable",a.mobile.filterable,{options:{filterPlaceholder:"Filter items...",filterTheme:null},_create:function(){var b,c,d=this.element,e=["collapsibleset","selectmenu","controlgroup","listview"],f={};for(this._super(),a.extend(this,{_widget:null}),b=e.length-1;b>-1;b--)if(c=e[b],a.mobile[c]){if(this._setWidget(d.data("mobile-"+c)))break;f[c+"create"]="_handleCreate"}this._widget||this._on(d,f)},_handleCreate:function(a){this._setWidget(this.element.data("mobile-"+a.type.substring(0,a.type.length-6)))},_trigger:function(a,b,c){return this._widget&&"mobile-listview"===this._widget.widgetFullName&&"beforefilter"===a&&this._widget._trigger("beforefilter",b,c),this._super(a,b,c)},_setWidget:function(a){return!this._widget&&a&&(this._widget=a,this._widget._setOptions=c(this,this._widget._setOptions)),this._widget&&(this._syncTextInputOptions(this._widget.options),"listview"===this._widget.widgetName&&(this._widget.options.hideDividers=!0,this._widget.element.listview("refresh"))),!!this._widget},_isSearchInternal:function(){return this._search&&this._search.jqmData("ui-filterable-"+this.uuid+"-internal")},_setInput:function(b){var c=this.options,d=!0,e={};if(!b){if(this._isSearchInternal())return;d=!1,b=a("<input data-"+a.mobile.ns+"type='search' placeholder='"+c.filterPlaceholder+"'></input>").jqmData("ui-filterable-"+this.uuid+"-internal",!0),a("<form class='ui-filterable'></form>").append(b).submit(function(a){a.preventDefault(),b.blur()}).insertBefore(this.element),a.mobile.textinput&&(null!=this.options.filterTheme&&(e.theme=c.filterTheme),b.textinput(e))}this._super(b),this._isSearchInternal()&&d&&this._search.attr("placeholder",this.options.filterPlaceholder)},_setOptions:function(c){var d=this._super(c);return c.filterPlaceholder!==b&&this._isSearchInternal()&&this._search.attr("placeholder",c.filterPlaceholder),c.filterTheme!==b&&this._search&&a.mobile.textinput&&this._search.textinput("option","theme",c.filterTheme),d},_refreshChildWidget:function(){this._refreshingChildWidget=!0,this._superApply(arguments),this._refreshingChildWidget=!1},refresh:function(){this._refreshingChildWidget||this._superApply(arguments)},_destroy:function(){this._isSearchInternal()&&this._search.remove(),this._super()},_syncTextInputOptions:function(c){var d,e={};if(this._isSearchInternal()&&a.mobile.textinput){for(d in a.mobile.textinput.prototype.options)c[d]!==b&&(e[d]="theme"===d&&null!=this.options.filterTheme?this.options.filterTheme:c[d]);this._search.textinput("option",e)}}}),a.widget("mobile.listview",a.mobile.listview,{options:{filter:!1},_create:function(){return this.options.filter!==!0||this.element.data("mobile-filterable")||this.element.filterable(),this._super()},refresh:function(){var a;this._superApply(arguments),this.options.filter===!0&&(a=this.element.data("mobile-filterable"),a&&a.refresh())}})}(a),function(a,b){function c(){return++e}function d(a){return a.hash.length>1&&decodeURIComponent(a.href.replace(f,""))===decodeURIComponent(location.href.replace(f,""))}var e=0,f=/#.*$/;a.widget("ui.tabs",{version:"fadf2b312a05040436451c64bbfaf4814bc62c56",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var b=this,c=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",c.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(b){a(this).is(".ui-state-disabled")&&b.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){a(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),c.active=this._initialActive(),a.isArray(c.disabled)&&(c.disabled=a.unique(c.disabled.concat(a.map(this.tabs.filter(".ui-state-disabled"),function(a){return b.tabs.index(a)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(c.active):a(),this._refresh(),this.active.length&&this.load(c.active)},_initialActive:function(){var b=this.options.active,c=this.options.collapsible,d=location.hash.substring(1);return null===b&&(d&&this.tabs.each(function(c,e){return a(e).attr("aria-controls")===d?(b=c,!1):void 0}),null===b&&(b=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===b||-1===b)&&(b=!!this.tabs.length&&0)),b!==!1&&(b=this.tabs.index(this.tabs.eq(b)),-1===b&&(b=!c&&0)),!c&&b===!1&&this.anchors.length&&(b=0),b},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):a()}},_tabKeydown:function(b){var c=a(this.document[0].activeElement).closest("li"),d=this.tabs.index(c),e=!0;if(!this._handlePageNav(b)){switch(b.keyCode){case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:d++;break;case a.ui.keyCode.UP:case a.ui.keyCode.LEFT:e=!1,d--;break;case a.ui.keyCode.END:d=this.anchors.length-1;break;case a.ui.keyCode.HOME:d=0;break;case a.ui.keyCode.SPACE:return b.preventDefault(),clearTimeout(this.activating),void this._activate(d);case a.ui.keyCode.ENTER:return b.preventDefault(),clearTimeout(this.activating),void this._activate(d!==this.options.active&&d);default:return}b.preventDefault(),clearTimeout(this.activating),d=this._focusNextTab(d,e),b.ctrlKey||(c.attr("aria-selected","false"),this.tabs.eq(d).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",d)},this.delay))}},_panelKeydown:function(b){this._handlePageNav(b)||b.ctrlKey&&b.keyCode===a.ui.keyCode.UP&&(b.preventDefault(),this.active.focus())},_handlePageNav:function(b){return b.altKey&&b.keyCode===a.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):b.altKey&&b.keyCode===a.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(b,c){function d(){return b>e&&(b=0),0>b&&(b=e),b}for(var e=this.tabs.length-1;-1!==a.inArray(d(),this.options.disabled);)b=c?b+1:b-1;return b},_focusNextTab:function(a,b){return a=this._findNextTab(a,b),this.tabs.eq(a).focus(),a},_setOption:function(a,b){return"active"===a?void this._activate(b):"disabled"===a?void this._setupDisabled(b):(this._super(a,b),"collapsible"===a&&(this.element.toggleClass("ui-tabs-collapsible",b),b||this.options.active!==!1||this._activate(0)),"event"===a&&this._setupEvents(b),void("heightStyle"===a&&this._setupHeightStyle(b)))},_tabId:function(a){return a.attr("aria-controls")||"ui-tabs-"+c()},_sanitizeSelector:function(a){return a?a.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var b=this.options,c=this.tablist.children(":has(a[href])");b.disabled=a.map(c.filter(".ui-state-disabled"),function(a){return c.index(a)}),this._processTabs(),b.active!==!1&&this.anchors.length?this.active.length&&!a.contains(this.tablist[0],this.active[0])?this.tabs.length===b.disabled.length?(b.active=!1,this.active=a()):this._activate(this._findNextTab(Math.max(0,b.active-1),!1)):b.active=this.tabs.index(this.active):(b.active=!1,this.active=a()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var b=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return a("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=a(),this.anchors.each(function(c,e){var f,g,h,i=a(e).uniqueId().attr("id"),j=a(e).closest("li"),k=j.attr("aria-controls");d(e)?(f=e.hash,g=b.element.find(b._sanitizeSelector(f))):(h=b._tabId(j),f="#"+h,g=b.element.find(f),g.length||(g=b._createPanel(h),g.insertAfter(b.panels[c-1]||b.tablist)),g.attr("aria-live","polite")),g.length&&(b.panels=b.panels.add(g)),k&&j.data("ui-tabs-aria-controls",k),j.attr({"aria-controls":f.substring(1),"aria-labelledby":i}),g.attr("aria-labelledby",i)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(b){return a("<div>").attr("id",b).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(b){a.isArray(b)&&(b.length?b.length===this.anchors.length&&(b=!0):b=!1);for(var c,d=0;c=this.tabs[d];d++)b===!0||-1!==a.inArray(d,b)?a(c).addClass("ui-state-disabled").attr("aria-disabled","true"):a(c).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=b},_setupEvents:function(b){var c={click:function(a){a.preventDefault()}};b&&a.each(b.split(" "),function(a,b){c[b]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,c),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(b){var c,d=this.element.parent();"fill"===b?(c=d.height(),c-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var b=a(this),d=b.css("position");"absolute"!==d&&"fixed"!==d&&(c-=b.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){c-=a(this).outerHeight(!0)}),this.panels.each(function(){a(this).height(Math.max(0,c-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")):"auto"===b&&(c=0,this.panels.each(function(){c=Math.max(c,a(this).height("").height())}).height(c))},_eventHandler:function(b){var c=this.options,d=this.active,e=a(b.currentTarget),f=e.closest("li"),g=f[0]===d[0],h=g&&c.collapsible,i=h?a():this._getPanelForTab(f),j=d.length?this._getPanelForTab(d):a(),k={oldTab:d,oldPanel:j,newTab:h?a():f,newPanel:i};b.preventDefault(),f.hasClass("ui-state-disabled")||f.hasClass("ui-tabs-loading")||this.running||g&&!c.collapsible||this._trigger("beforeActivate",b,k)===!1||(c.active=!h&&this.tabs.index(f),this.active=g?a():f,this.xhr&&this.xhr.abort(),j.length||i.length||a.error("jQuery UI Tabs: Mismatching fragment identifier."),i.length&&this.load(this.tabs.index(f),b),this._toggle(b,k))},_toggle:function(b,c){function d(){f.running=!1,f._trigger("activate",b,c)}function e(){c.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),g.length&&f.options.show?f._show(g,f.options.show,d):(g.show(),d())}var f=this,g=c.newPanel,h=c.oldPanel;this.running=!0,h.length&&this.options.hide?this._hide(h,this.options.hide,function(){c.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),e()}):(c.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),h.hide(),e()),h.attr({"aria-expanded":"false","aria-hidden":"true"}),c.oldTab.attr("aria-selected","false"),g.length&&h.length?c.oldTab.attr("tabIndex",-1):g.length&&this.tabs.filter(function(){return 0===a(this).attr("tabIndex")}).attr("tabIndex",-1),g.attr({"aria-expanded":"true","aria-hidden":"false"}),c.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(b){var c,d=this._findActive(b);d[0]!==this.active[0]&&(d.length||(d=this.active),c=d.find(".ui-tabs-anchor")[0],this._eventHandler({target:c,currentTarget:c,preventDefault:a.noop}))},_findActive:function(b){return b===!1?a():this.tabs.eq(b)},_getIndex:function(a){return"string"==typeof a&&(a=this.anchors.index(this.anchors.filter("[href$='"+a+"']"))),a},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){a.data(this,"ui-tabs-destroy")?a(this).remove():a(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var b=a(this),c=b.data("ui-tabs-aria-controls");c?b.attr("aria-controls",c).removeData("ui-tabs-aria-controls"):b.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(c){var d=this.options.disabled;d!==!1&&(c===b?d=!1:(c=this._getIndex(c),d=a.isArray(d)?a.map(d,function(a){return a!==c?a:null}):a.map(this.tabs,function(a,b){return b!==c?b:null})),this._setupDisabled(d))},disable:function(c){var d=this.options.disabled;if(d!==!0){if(c===b)d=!0;else{if(c=this._getIndex(c),-1!==a.inArray(c,d))return;d=a.isArray(d)?a.merge([c],d).sort():[c]}this._setupDisabled(d)}},load:function(b,c){b=this._getIndex(b);var e=this,f=this.tabs.eq(b),g=f.find(".ui-tabs-anchor"),h=this._getPanelForTab(f),i={tab:f,panel:h};d(g[0])||(this.xhr=a.ajax(this._ajaxSettings(g,c,i)),this.xhr&&"canceled"!==this.xhr.statusText&&(f.addClass("ui-tabs-loading"),h.attr("aria-busy","true"),this.xhr.success(function(a){setTimeout(function(){h.html(a),e._trigger("load",c,i)},1)}).complete(function(a,b){setTimeout(function(){"abort"===b&&e.panels.stop(!1,!0),f.removeClass("ui-tabs-loading"),h.removeAttr("aria-busy"),a===e.xhr&&delete e.xhr},1)})))},_ajaxSettings:function(b,c,d){var e=this;return{url:b.attr("href"),beforeSend:function(b,f){return e._trigger("beforeLoad",c,a.extend({jqXHR:b,ajaxSettings:f},d))}}},_getPanelForTab:function(b){var c=a(b).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+c))}})}(a),function(){}(a),function(a,b){function c(a){e=a.originalEvent,i=e.accelerationIncludingGravity,f=Math.abs(i.x),g=Math.abs(i.y),h=Math.abs(i.z),!b.orientation&&(f>7||(h>6&&8>g||8>h&&g>6)&&f>5)?d.enabled&&d.disable():d.enabled||d.enable()}a.mobile.iosorientationfixEnabled=!0;var d,e,f,g,h,i,j=navigator.userAgent;return/iPhone|iPad|iPod/.test(navigator.platform)&&/OS [1-5]_[0-9_]* like Mac OS X/i.test(j)&&j.indexOf("AppleWebKit")>-1?(d=a.mobile.zoom,void a.mobile.document.on("mobileinit",function(){a.mobile.iosorientationfixEnabled&&a.mobile.window.bind("orientationchange.iosorientationfix",d.enable).bind("devicemotion.iosorientationfix",c)})):void(a.mobile.iosorientationfixEnabled=!1)}(a,this),function(a,b,d){function e(){f.removeClass("ui-mobile-rendering")}var f=a("html"),g=a.mobile.window;a(b.document).trigger("mobileinit"),a.mobile.gradeA()&&(a.mobile.ajaxBlacklist&&(a.mobile.ajaxEnabled=!1),f.addClass("ui-mobile ui-mobile-rendering"),setTimeout(e,5e3),a.extend(a.mobile,{initializePage:function(){var b=a.mobile.path,f=a(":jqmData(role='page'), :jqmData(role='dialog')"),h=b.stripHash(b.stripQueryParams(b.parseLocation().hash)),i=a.mobile.path.parseLocation(),j=h?c.getElementById(h):d;f.length||(f=a("body").wrapInner("<div data-"+a.mobile.ns+"role='page'></div>").children(0)),f.each(function(){var c=a(this);c[0].getAttribute("data-"+a.mobile.ns+"url")||c.attr("data-"+a.mobile.ns+"url",c.attr("id")||b.convertUrlToDataUrl(i.pathname+i.search))}),a.mobile.firstPage=f.first(),a.mobile.pageContainer=a.mobile.firstPage.parent().addClass("ui-mobile-viewport").pagecontainer(),a.mobile.navreadyDeferred.resolve(),g.trigger("pagecontainercreate"),a.mobile.loading("show"),e(),a.mobile.hashListeningEnabled&&a.mobile.path.isHashValid(location.hash)&&(a(j).is(":jqmData(role='page')")||a.mobile.path.isPath(h)||h===a.mobile.dialogHashKey)?a.event.special.navigate.isPushStateEnabled()?(a.mobile.navigate.history.stack=[],a.mobile.navigate(a.mobile.path.isPath(location.hash)?location.hash:location.href)):g.trigger("hashchange",[!0]):(a.event.special.navigate.isPushStateEnabled()&&a.mobile.navigate.navigator.squash(b.parseLocation().href),a.mobile.changePage(a.mobile.firstPage,{transition:"none",reverse:!0,changeHash:!1,fromHashChange:!0}))}}),a(function(){a.support.inlineSVG(),a.mobile.hideUrlBar&&b.scrollTo(0,1),a.mobile.defaultHomeScroll=a.support.scrollTop&&1!==a.mobile.window.scrollTop()?1:0,a.mobile.autoInitializePage&&a.mobile.initializePage(),a.mobile.hideUrlBar&&g.load(a.mobile.silentScroll),a.support.cssPointerEvents||a.mobile.document.delegate(".ui-state-disabled,.ui-disabled","vclick",function(a){a.preventDefault(),a.stopImmediatePropagation()})}))}(a,this)}),!function(a){"function"==typeof define&&define.amd?define(["jquery"],function(b){return a(b)}):"object"==typeof module&&"object"==typeof module.exports?module.exports=a(require("jquery")):a(window.jQuery)}(function(a){"use strict";function b(a){void 0===a&&(a=window.navigator.userAgent),a=a.toLowerCase();var b=/(edge)\/([\w.]+)/.exec(a)||/(opr)[\/]([\w.]+)/.exec(a)||/(chrome)[ \/]([\w.]+)/.exec(a)||/(iemobile)[\/]([\w.]+)/.exec(a)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[],c=/(ipad)/.exec(a)||/(ipod)/.exec(a)||/(windows phone)/.exec(a)||/(iphone)/.exec(a)||/(kindle)/.exec(a)||/(silk)/.exec(a)||/(android)/.exec(a)||/(win)/.exec(a)||/(mac)/.exec(a)||/(linux)/.exec(a)||/(cros)/.exec(a)||/(playbook)/.exec(a)||/(bb)/.exec(a)||/(blackberry)/.exec(a)||[],d={},e={browser:b[5]||b[3]||b[1]||"",version:b[2]||b[4]||"0",versionNumber:b[4]||b[2]||"0",platform:c[0]||""};if(e.browser&&(d[e.browser]=!0,d.version=e.version,d.versionNumber=parseInt(e.versionNumber,10)),e.platform&&(d[e.platform]=!0),(d.android||d.bb||d.blackberry||d.ipad||d.iphone||d.ipod||d.kindle||d.playbook||d.silk||d["windows phone"])&&(d.mobile=!0),(d.cros||d.mac||d.linux||d.win)&&(d.desktop=!0),(d.chrome||d.opr||d.safari)&&(d.webkit=!0),d.rv||d.iemobile){var f="msie";e.browser=f,d[f]=!0}if(d.edge){delete d.edge;var g="msedge";e.browser=g,d[g]=!0}if(d.safari&&d.blackberry){var h="blackberry";e.browser=h,d[h]=!0}if(d.safari&&d.playbook){var i="playbook";e.browser=i,d[i]=!0}if(d.bb){var j="blackberry";e.browser=j,d[j]=!0}if(d.opr){var k="opera";e.browser=k,d[k]=!0}if(d.safari&&d.android){var l="android";e.browser=l,d[l]=!0}if(d.safari&&d.kindle){var m="kindle";e.browser=m,d[m]=!0}if(d.safari&&d.silk){var n="silk";e.browser=n,d[n]=!0}return d.name=e.browser,d.platform=e.platform,d}return window.jQBrowser=b(window.navigator.userAgent),window.jQBrowser.uaMatch=b,a&&(a.browser=window.jQBrowser),window.jQBrowser}),function($,window,document,undefined){"use strict";function Plugin(element,options){this.inputelement=element,this.element=element,this.options=$.extend({},defaults,options),this._defaults=defaults,this._name=pluginName,this._image=!1,this._filename="",this._variables={},this._template(this.options.navToolsEnabled)}var pluginName="picEdit",defaults={imageUpdated:function(img){},formSubmitted:function(res){},redirectUrl:!1,maxWidth:"auto",maxHeight:"auto",minWidth:"auto",minHeight:"auto",displayWidth:"auto",displayHeight:"auto",aspectRatio:!0,defaultImage:function(){},navToolsEnabled:!0,onImageCreation:function(){},onNativeCameraInit:function(sourceType,callback){},isMobile:!1};Plugin.prototype={init:function(){function build_img_from_file(files){if(files||files.length){var file=files[0];_this._filename||(_this._filename=file.name);var reader=new FileReader;reader.onload=function(e){_this._create_image_with_datasrc(e.target.result,!1,file)},reader.readAsDataURL(file)}}var _this=this,type=$(this.inputelement).prop("type");if("file"==type?this._fileinput=$(this.inputelement):($(this.inputelement).after('<input type="file" style="display:none" accept="image/*;capture=camera">'),this._fileinput=$(this.inputelement).next("input")),!this.check_browser_capabilities())return"file"!=type&&($(this.inputelement).prop("type","file"),$(this._fileinput).remove()),$(this.inputelement).show(),void $(this.element).remove();if(this._canvas=$(this.element).find(".picedit_canvas > canvas")[0],this._ctx=this._canvas.getContext("2d"),this._videobox=$(this.element).find(".picedit_video"),this._painter=$(this.element).find(".picedit_painter"),this._painter_canvas=this._painter.children("canvas")[0],this._painter_ctx=this._painter_canvas.getContext("2d"),this._painter_painting=!1,this._messagebox=$(this.element).find(".picedit_message"),this._messagetimeout=!1,this._mainbuttons=$(this.element).find(".picedit_action_btns"),this._viewport={width:0,height:0},this._cropping={is_dragging:!1,is_resizing:!1,left:0,top:0,width:0,height:0,cropbox:$(this.element).find(".picedit_drag_resize"),cropframe:$(this.element).find(".picedit_drag_resize_box")},$(this.element).find(".picedit_canvas_box").on("drop",function(event){event.preventDefault(),$(this).removeClass("dragging");var files=(event.dataTransfer||event.originalEvent.dataTransfer).files;build_img_from_file(files)}).on("dragover",function(event){event.preventDefault(),$(this).addClass("dragging")}).on("dragleave",function(event){event.preventDefault(),$(this).removeClass("dragging")}),$(this._fileinput).on("change",function(){build_img_from_file(this.files)}),!window.Clipboard){var pasteCatcher=$(document.createElement("div"));pasteCatcher.prop("contenteditable","true").css({position:"absolute",left:-999,width:0,height:0,overflow:"hidden",outline:0,opacity:0}),$(document.body).prepend(pasteCatcher)}$(document).on("paste",function(event){var blob,items=(event.clipboardData||event.originalEvent.clipboardData).items;if(items){for(var i=0;i<items.length;i++)0===items[i].type.indexOf("image")&&(blob=items[i].getAsFile());if(blob){var reader=new FileReader;reader.onload=function(e){_this._create_image_with_datasrc(e.target.result)},reader.readAsDataURL(blob)}}else pasteCatcher.get(0).focus(),pasteCatcher.on("DOMSubtreeModified",function(){var child=pasteCatcher.children().last().get(0);pasteCatcher.html(""),child&&("IMG"===child.tagName&&"data:"==child.src.substr(0,5)?_this._create_image_with_datasrc(child.src):"IMG"===child.tagName&&"http"==child.src.substr(0,4)&&_this._create_image_with_datasrc(child.src,!1,!1,!0))})}),this._theformdata=!1,this._bindControlButtons(),this._bindInputVariables(),this._bindSelectionDrag(),this._variables.pen_color="black",this._variables.pen_size=!1,this._variables.prev_pos=!1,this.options.defaultImage&&_this.set_default_image(this.options.defaultImage),"auto"!=this.options.displayWidth&&$(this.element).css({width:this.options.displayWidth,height:this.options.displayHeight})},check_browser_capabilities:function(){return 0!=!!window.CanvasRenderingContext2D&&!!window.FileReader},set_default_image:function(datasrc){var _this=this,img=document.createElement("img");img.setAttribute("crossOrigin","anonymous"),img.src=datasrc,img.onload=function(){var imageAux=null,canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");canvas.width=img.width,canvas.height=img.height,ctx.drawImage(img,0,0,canvas.width,canvas.height),imageAux=document.createElement("img"),imageAux.src=canvas.toDataURL("image/jpg"),_this._image=imageAux,_this._resizeViewport(),_this._paintCanvas(),$(_this.element).find(".picedit_nav_box").addClass("active")}},hide_messagebox:function(){var msgbox=this._messagebox;msgbox.removeClass("active no_close_button"),setTimeout(function(){msgbox.children("div").html("")},200)},set_loading:function(message){return message&&1==message?this.set_messagebox("Working...",!1,!1):this.set_messagebox("Please Wait...",!1,!1)},set_messagebox:function(text,autohide,closebutton){autohide="undefined"!=typeof autohide?autohide:3e3,closebutton="undefined"==typeof closebutton||closebutton;var classes="active";if(closebutton||(classes+=" no_close_button"),autohide){clearTimeout(this._messagetimeout);var _this=this;this._messagetimeout=setTimeout(function(){_this.hide_messagebox()},autohide)}return this._messagebox.addClass(classes).children("div").html(text)},toggle_button:function(elem){if($(elem).hasClass("active")){var value=!1;$(elem).removeClass("active")}else{var value=!0;$(elem).siblings().removeClass("active"),$(elem).addClass("active")}var variable=$(elem).data("variable");if(variable){var optional_value=$(elem).data("value");optional_value||(optional_value=$(elem).val()),optional_value&&value&&(value=optional_value),this._setVariable(variable,value)}this._variables.pen_color&&this._variables.pen_size?this.pen_tool_open():this.pen_tool_close()},load_image:function(){var _this=this;this.options.isMobile?this.options.onNativeCameraInit("PHOTOLIBRARY",function(datasrc){_this._create_image_with_datasrc(datasrc,!1,!0),console.log("DEBUG ::: load_image ::: "+datasrc)}):this._fileinput.click()},pen_tool_open:function(){return this._image?(this.pen_tool_params_set(),this._painter.addClass("active"),void this._hideAllNav()):this._hideAllNav(1)},pen_tool_params_set:function(){this._painter_canvas.width=0,this._painter_canvas.width=this._canvas.width,this._painter_canvas.height=this._canvas.height,this._painter_ctx.lineJoin="round",this._painter_ctx.lineCap="round",this._painter_ctx.strokeStyle=this._variables.pen_color,this._painter_ctx.lineWidth=this._variables.pen_size},pen_tool_close:function(){this._painter.removeClass("active")},rotate_ccw:function(){if(!this._image)return this._hideAllNav(1);var _this=this;this.set_loading(1).delay(200).promise().done(function(){_this._doRotation(-90),_this._resizeViewport(),_this.hide_messagebox()}),this._hideAllNav()},rotate_cw:function(){if(!this._image)return this._hideAllNav(1);var _this=this;this.set_loading(1).delay(200).promise().done(function(){_this._doRotation(90),_this._resizeViewport(),_this.hide_messagebox()}),this._hideAllNav()},resize_image:function(){if(!this._image)return this._hideAllNav(1);var _this=this;this.set_loading(1);var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");canvas.width=_this._viewport.width,canvas.height=_this._viewport.height,ctx.drawImage(_this._image,0,0,canvas.width,canvas.height),"image/png"==_this._getImageFormat(_this._image)?_this._create_image_with_datasrc(canvas.toDataURL("image/png"),_this.hide_messagebox(),!1,!1,!0):_this._create_image_with_datasrc(canvas.toDataURL("image/jpeg"),_this.hide_messagebox(),!1,!1,!0),
this._hideAllNav()},camera_open:function(){var _this=this;if(this.options.isMobile)this.options.onNativeCameraInit("CAMERA",function(datasrc){_this._create_image_with_datasrc(datasrc,!1,!0)});else{var getUserMedia,browserUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;if(!browserUserMedia)return this.set_messagebox("Sorry, your browser doesn't support WebRTC!");getUserMedia=browserUserMedia.bind(navigator),getUserMedia({audio:!1,video:!0},function(stream){var videoElement=_this._videobox.find("video")[0];videoElement.src=URL.createObjectURL(stream),videoElement.onloadedmetadata=function(){videoElement.videoWidth&&videoElement.videoHeight&&(_this._image||(_this._image={}),_this._image.width=videoElement.videoWidth,_this._image.height=videoElement.videoHeight,_this._resizeViewport())},_this._videobox.addClass("active")},function(err){return _this.set_messagebox("No video source detected! Please allow camera access!")})}},camera_close:function(){this.options.isMobile||this._videobox.removeClass("active")},take_photo:function(){if(!this.options.isMobile){var _this=this,live=this._videobox.find("video")[0],canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");canvas.width=live.clientWidth,canvas.height=live.clientHeight,ctx.drawImage(live,0,0,canvas.width,canvas.height),_this._videobox.removeClass("active"),this._create_image_with_datasrc(canvas.toDataURL("image/jpeg"),function(){_this._videobox.removeClass("active")})}},crop_image:function(){var crop=this._calculateCropWindow(),_this=this;this.set_loading(1).delay(200).promise().done(function(){var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");canvas.width=_this._image.width,canvas.height=_this._image.height,ctx.drawImage(_this._image,crop.left,crop.top,crop.width,crop.height,0,0,_this._image.width,_this._image.height),_this._create_image_with_datasrc(canvas.toDataURL("image/jpeg"),function(){_this.hide_messagebox()})}),this.crop_close()},crop_open:function(){return this._image?(this._cropping.cropbox.addClass("active"),this._hideAllNav(),void this._mainbuttons.removeClass("active")):this._hideAllNav(1)},crop_close:function(){this._cropping.cropbox.removeClass("active")},_create_image_with_datasrc:function(datasrc,callback,file,dataurl,withoutcall2resize){this.options.onImageCreation&&this.options.onImageCreation();var _this=this,img=document.createElement("img");dataurl&&img.setAttribute("crossOrigin","anonymous"),file&&(img.file=file),img.src=datasrc,img.onload=function(){var imageAux=null;if("undefined"!=typeof img.file&&"image/gif"==img.file.type&&(dataurl=!1,withoutcall2resize=!0),dataurl){var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");canvas.width=img.width,canvas.height=img.height,ctx.drawImage(img,0,0,canvas.width,canvas.height),imageAux=document.createElement("img"),"image/png"==_this._getImageFormat(img)?imageAux.src=canvas.toDataURL("image/png"):imageAux.src=canvas.toDataURL("image/jpg")}_this._image=null!=imageAux?imageAux:img,_this._resizeViewport(),withoutcall2resize?(_this._paintCanvas(),_this.options.imageUpdated(_this._image),_this._mainbuttons.addClass("active"),$(_this.element).find(".picedit_nav_box").addClass("active"),callback&&"function"==typeof callback&&callback()):(_this.resize_image(),callback&&"function"==typeof callback&&callback())}},_getImageFormat:function(img){var format="image/jpg";return"undefined"!=typeof img.file&&("image/gif"==img.file.type&&(format="image/gif"),"image/png"==img.file.type&&(format="image/png")),"undefined"!=typeof img.src&&("data:image/gif"==img.src.substr(0,14)&&(format="image/gif"),"data:image/png"==img.src.substr(0,14)&&(format="image/png")),format},_bindSelectionDrag:function(){var _this=this,eventbox=this._cropping.cropframe,painter=this._painter,resizer=this._cropping.cropbox.find(".picedit_drag_resize_box_corner_wrap");$(window).on("mousedown touchstart",function(e){var evtpos=e.clientX?e:e.originalEvent.touches[0];_this._cropping.x=evtpos.clientX,_this._cropping.y=evtpos.clientY,_this._cropping.w=eventbox[0].clientWidth,_this._cropping.h=eventbox[0].clientHeight,eventbox.on("mousemove touchmove",function(event){event.stopPropagation(),event.preventDefault(),_this._cropping.is_dragging=!0,_this._cropping.is_resizing||_this._selection_drag_movement(event)}),resizer.on("mousemove touchmove",function(event){event.stopPropagation(),event.preventDefault(),_this._cropping.is_resizing=!0,_this._selection_resize_movement(event)}),painter.on("mousemove touchmove",function(event){event.stopPropagation(),event.preventDefault(),_this._painter_painting=!0,_this._painter_movement(event)})}).on("mouseup touchend",function(){_this._painter_painting&&_this._painter_merge_drawing(),_this._cropping.is_dragging=!1,_this._cropping.is_resizing=!1,_this._painter_painting=!1,_this._variables.prev_pos=!1,eventbox.off("mousemove touchmove"),resizer.off("mousemove touchmove"),painter.off("mousemove touchmove")})},_selection_resize_movement:function(e){var cropframe=this._cropping.cropframe[0],evtpos=e.clientX?e:e.originalEvent.touches[0];cropframe.style.width=this._cropping.w+evtpos.clientX-this._cropping.x+"px",cropframe.style.height=this._cropping.h+evtpos.clientY-this._cropping.y+"px"},_selection_drag_movement:function(e){var cropframe=this._cropping.cropframe[0],evtpos=e.pageX?e:e.originalEvent.touches[0];this._cropping.cropframe.offset({top:evtpos.pageY-parseInt(cropframe.clientHeight/2,10),left:evtpos.pageX-parseInt(cropframe.clientWidth/2,10)})},_painter_movement:function(e){var pos={},target=e.target||e.srcElement,rect=target.getBoundingClientRect(),evtpos=e.clientX?e:e.originalEvent.touches[0];return pos.x=evtpos.clientX-rect.left,pos.y=evtpos.clientY-rect.top,this._variables.prev_pos?(this._painter_ctx.beginPath(),this._painter_ctx.moveTo(this._variables.prev_pos.x,this._variables.prev_pos.y),this._painter_ctx.lineTo(pos.x,pos.y),this._painter_ctx.stroke(),void(this._variables.prev_pos=pos)):this._variables.prev_pos=pos},_painter_merge_drawing:function(){var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d"),_this=this;canvas.width=this._image.width,canvas.height=this._image.height,ctx.drawImage(this._image,0,0,canvas.width,canvas.height),ctx.drawImage(this._painter_canvas,0,0,canvas.width,canvas.height),canvas.width>1280&&canvas.height>800?this.set_loading().delay(200).promise().done(function(){_this._create_image_with_datasrc(canvas.toDataURL("image/jpeg"),function(){_this.pen_tool_params_set(),_this.hide_messagebox()})}):this._create_image_with_datasrc(canvas.toDataURL("image/jpeg"),function(){_this.pen_tool_params_set()})},_hideAllNav:function(message){message&&1==message&&this.set_messagebox("Open an image or use your camera to make a photo!"),$(this.element).find(".picedit_nav_box").removeClass("active").find(".picedit_element").removeClass("active")},_paintCanvas:function(){this._canvas.width=this._viewport.width,this._canvas.height=this._viewport.height,this._ctx.drawImage(this._image,0,0,this._viewport.width,this._viewport.height),$(this.element).find(".picedit_canvas").css("display","block")},_calculateCropWindow:function(){var view=this._viewport,cropframe=this._cropping.cropframe[0],real={width:this._image.width,height:this._image.height},crop={width:cropframe.clientWidth,height:cropframe.clientHeight,top:cropframe.offsetTop>0?cropframe.offsetTop:.1,left:cropframe.offsetLeft>0?cropframe.offsetLeft:.1};crop.width+crop.left>view.width&&(crop.width=view.width-crop.left),crop.height+crop.top>view.height&&(crop.height=view.height-crop.top);var width_percent=crop.width/view.width,height_percent=crop.height/view.height,area={width:parseInt(real.width*width_percent,10),height:parseInt(real.height*height_percent,10)},top_percent=crop.top/view.height,left_percent=crop.left/view.width;return area.top=parseInt(real.height*top_percent,10),area.left=parseInt(real.width*left_percent,10),area},_doRotation:function(degrees){var newWidth,newHeight,rads=degrees*Math.PI/180,c=Math.cos(rads),s=Math.sin(rads);s<0&&(s=-s),c<0&&(c=-c),newWidth=this._image.height*s+this._image.width*c,newHeight=this._image.height*c+this._image.width*s;var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");canvas.width=parseInt(newWidth,10),canvas.height=parseInt(newHeight,10);var cx=canvas.width/2,cy=canvas.height/2;ctx.clearRect(0,0,canvas.width,canvas.height),ctx.translate(cx,cy),ctx.rotate(rads),ctx.drawImage(this._image,-this._image.width/2,-this._image.height/2),this._image.src=canvas.toDataURL("image/jpeg"),this._paintCanvas(),this.options.imageUpdated(this._image)},_resizeViewport:function(){var img=this._image,viewport={width:img.width,height:img.height};if("auto"!=this.options.maxWidth&&img.width>this.options.maxWidth&&(viewport.width=this.options.maxWidth),"auto"!=this.options.maxHeight&&img.height>this.options.maxHeight&&(viewport.height=this.options.maxHeight),"auto"!=this.options.minWidth&&img.width<this.options.minWidth&&(viewport.width=this.options.minWidth),"auto"!=this.options.minHeight&&img.height<this.options.minHeight&&(viewport.height=this.options.minHeight),this.options.aspectRatio){var resizeWidth=img.width,resizeHeight=img.height,aspect=resizeWidth/resizeHeight;resizeWidth>viewport.width&&(viewport.width=parseInt(viewport.width,10),viewport.height=parseInt(viewport.width/aspect,10)),resizeHeight>viewport.height&&(aspect=resizeWidth/resizeHeight,viewport.height=parseInt(viewport.height,10),viewport.width=parseInt(viewport.height*aspect,10))}$(this.element).css({width:viewport.width,height:viewport.height}),this._viewport=viewport,this._setVariable("resize_width",img.width),this._setVariable("resize_height",img.height)},_bindControlButtons:function(){var _this=this;$(this.element).find(".picedit_control").bind("click",function(){var action=$(this).data("action");action?_this[action](this):$(this).hasClass("picedit_action")&&($(this).parent(".picedit_element").toggleClass("active").siblings(".picedit_element").removeClass("active"),$(this).parent(".picedit_element").hasClass("active")?$(this).closest(".picedit_nav_box").addClass("active"):$(this).closest(".picedit_nav_box").removeClass("active"))})},_bindInputVariables:function(){var _this=this;$(this.element).find(".picedit_input").bind("change keypress paste input",function(){var variable=$(this).data("variable");if(variable){var value=$(this).val();_this._variables[variable]=value}if(("resize_width"==variable||"resize_height"==variable)&&_this._variables.resize_proportions){var aspect=_this._image.width/_this._image.height;"resize_width"==variable?_this._setVariable("resize_height",parseInt(value/aspect,10)):_this._setVariable("resize_width",parseInt(value*aspect,10))}})},_setVariable:function(variable,value){this._variables[variable]=value,$(this.element).find('[data-variable="'+variable+'"]').val(value)},_formsubmit:function(){},_template:function(navToolsEnabled){var template;template=navToolsEnabled?'<div class="picedit_box"> <div class="picedit_message"> <span class="picedit_control ico-picedit-close" data-action="hide_messagebox"></span> <div> </div></div> <div class="picedit_nav_box picedit_gray_gradient"> <div class="picedit_pos_elements"> </div> <div class="picedit_nav_elements"> <div class="picedit_element"> <span class="picedit_control picedit_action ico-picedit-pencil" title="Pen Tool"></span> <div class="picedit_control_menu"> <div class="picedit_control_menu_container picedit_tooltip picedit_elm_3"> <label class="picedit_colors"> <span title="Black" class="picedit_control picedit_action picedit_black active" data-action="toggle_button" data-variable="pen_color" data-value="black"></span> <span title="Red" class="picedit_control picedit_action picedit_red" data-action="toggle_button" data-variable="pen_color" data-value="red"></span> <span title="Green" class="picedit_control picedit_action picedit_green" data-action="toggle_button" data-variable="pen_color" data-value="green"></span> </label> <label> <span class="picedit_separator"></span> </label> <label class="picedit_sizes"> <span title="Large" class="picedit_control picedit_action picedit_large" data-action="toggle_button" data-variable="pen_size" data-value="16"></span> <span title="Medium" class="picedit_control picedit_action picedit_medium" data-action="toggle_button" data-variable="pen_size" data-value="8"></span> <span title="Small" class="picedit_control picedit_action picedit_small" data-action="toggle_button" data-variable="pen_size" data-value="3"></span> </label> </div></div></div> <div class="picedit_element"> <span class="picedit_control picedit_action ico-picedit-insertpicture" title="Crop" data-action="crop_open"></span> </div> <div class="picedit_element"> <span class="picedit_control picedit_action ico-picedit-redo" title="Rotate"></span> <div class="picedit_control_menu"> <div class="picedit_control_menu_container picedit_tooltip picedit_elm_1"> <label> <span>90° </span> <span class="picedit_control picedit_action ico-picedit-redo" data-action="rotate_cw"></span> </label>  </div></div></div> </div> </div> <div class="picedit_canvas_box"> <div class="picedit_painter"> <canvas></canvas> </div> <div class="picedit_canvas"> <canvas></canvas> </div> <div class="picedit_action_btns active"> <div class="picedit_control ico-picedit-picture" data-action="load_image"> </div> <div class="picedit_control ico-picedit-camera" data-action="camera_open"> </div> <div class="center">'+dictionary.Literals.label_14+'</div> </div> </div> <div class="picedit_video"> <video autoplay></video> <div class="picedit_video_controls"> <span class="picedit_control picedit_action ico-picedit-checkmark" data-action="take_photo"></span><span class="picedit_control picedit_action ico-picedit-close" data-action="camera_close"></span></div></div> <div class="picedit_drag_resize"> <div class="picedit_drag_resize_canvas"></div> <div class="picedit_drag_resize_box"> <div class="picedit_drag_resize_box_corner_wrap"> <div class="picedit_drag_resize_box_corner"></div> </div> <div class="picedit_drag_resize_box_elements"><span class="picedit_control picedit_action ico-picedit-checkmark" data-action="crop_image"></span><span class="picedit_control picedit_action ico-picedit-close" data-action="crop_close"></span></div></div></div> </div>':'<div class="picedit_box"> <div class="picedit_message"> <span class="picedit_control ico-picedit-close" data-action="hide_messagebox"></span> <div> </div></div> <div class="picedit_nav_box picedit_gray_gradient"> <div class="picedit_pos_elements"> </div> <div class="picedit_nav_elements"> <div class="picedit_element"> </div> <div class="picedit_element"> </div> <div class="picedit_element"> </div> </div> </div> <div class="picedit_canvas_box"> <div class="picedit_painter"> <canvas></canvas> </div> <div class="picedit_canvas"> <canvas></canvas> </div> <div class="picedit_action_btns active"> <div class="picedit_control ico-picedit-picture" data-action="load_image"> </div> <div class="picedit_control ico-picedit-camera" data-action="camera_open"> </div> <div class="center">'+dictionary.Literals.label_14+'</div> </div> </div> <div class="picedit_video"> <video autoplay></video> <div class="picedit_video_controls"> <span class="picedit_control picedit_action ico-picedit-checkmark" data-action="take_photo"></span><span class="picedit_control picedit_action ico-picedit-close" data-action="camera_close"></span></div></div> <div class="picedit_drag_resize"> <div class="picedit_drag_resize_canvas"></div> <div class="picedit_drag_resize_box"> <div class="picedit_drag_resize_box_corner_wrap"> <div class="picedit_drag_resize_box_corner"></div> </div> <div class="picedit_drag_resize_box_elements"><span class="picedit_control picedit_action ico-picedit-checkmark" data-action="crop_image"></span><span class="picedit_control picedit_action ico-picedit-close" data-action="crop_close"></span></div></div></div> </div>';var _this=this;$(this.inputelement).hide().after(template).each(function(){_this.element=$(_this.inputelement).next(".picedit_box"),_this.init()})}},$.fn[pluginName]=function(options){var args=arguments;if(options===undefined||"object"==typeof options)return this.each(function(){$.data(this,"plugin_"+pluginName)||$.data(this,"plugin_"+pluginName,new Plugin(this,options))});if("string"==typeof options&&"_"!==options[0]&&"init"!==options){var returns;return this.each(function(){var instance=$.data(this,"plugin_"+pluginName);instance instanceof Plugin&&"function"==typeof instance[options]&&(returns=instance[options].apply(instance,Array.prototype.slice.call(args,1))),"destroy"===options&&$.data(this,"plugin_"+pluginName,null)}),returns!==undefined?returns:this}}}(jQuery,window,document),function($){function Plugin(element,options){this.element=element,this.$el=$(element),this.settings=$.extend({},defaults,options),this.$container=$(this.settings.container),this.settings.width=parseInt(this.settings.width),this.settings.height=parseInt(this.settings.height),this.settings.width>=MAX_WIDTH?this.settings.width=MAX_WIDTH:this.settings.width<MIN_WIDTH&&(this.settings.width=MIN_WIDTH),this.settings.height>=MAX_HEIGHT?this.settings.height=MAX_HEIGHT:this.settings.height<MIN_HEIGHT&&(this.settings.height=MIN_HEIGHT),this.init()}function getPickerHTML(){var nodes=[],categories=[{name:"emotion",symbol:"grinning"},{name:"animal",symbol:"whale"},{name:"food",symbol:"hamburger"},{name:"folderol",symbol:"sunny"},{name:"thing",symbol:"kiss"},{name:"travel",symbol:"rocket"}],aliases={people:"emotion",symbol:"thing",undefined:"thing"},items={};$.each($.fn.emojiPicker.emojis,function(i,emoji){var category=aliases[emoji.category]||emoji.category;items[category]=items[category]||[],items[category].push(emoji)}),nodes.push('<div class="emojiPicker">'),nodes.push("<nav>");for(var i in categories)nodes.push('<div class="tab'+(0==i?" active":"")+'" data-tab="'+categories[i].name+'"><div class="emoji emoji-'+categories[i].symbol+'"></div></div>');nodes.push("</nav>");for(var i in categories){nodes.push('<section class="'+categories[i].name+(0==i?"":" hidden")+'">');for(var j in items[categories[i].name]){var emoji=items[categories[i].name][j];nodes.push('<div class="emoji emoji-'+emoji.shortcode+'"></div>')}nodes.push("</section>")}return nodes.push("</div>"),nodes.join("\n")}function findEmoji(emojiShortcode){for(var emojis=$.fn.emojiPicker.emojis,i=0;i<emojis.length;i++)if(emojis[i].shortcode==emojiShortcode)return emojis[i]}function insertAtCaret(inputField,myValue){if(document.selection){inputField.focus();var sel=document.selection.createRange();sel.text=myValue,inputField.focus()}else if(inputField.selectionStart||"0"==inputField.selectionStart){var startPos=inputField.selectionStart,endPos=inputField.selectionEnd,scrollTop=inputField.scrollTop;inputField.value=inputField.value.substring(0,startPos)+myValue+inputField.value.substring(endPos,inputField.value.length),inputField.focus(),inputField.selectionStart=startPos+myValue.length,inputField.selectionEnd=startPos+myValue.length,inputField.scrollTop=scrollTop}else inputField.focus(),inputField.value+=myValue}function toUnicode(code){var codes=code.split("-").map(function(value,index){return parseInt(value,16)});return String.fromCodePoint.apply(null,codes)}var pluginName="emojiPicker",defaults={width:"200",height:"350",position:"top",fadeTime:10,iconColor:"black",iconBackgroundColor:"#eee",container:"body",button:!0},MIN_WIDTH=200,MAX_WIDTH=$(window).width(),MIN_HEIGHT=100,MAX_HEIGHT=$(window).height(),MAX_ICON_HEIGHT=200;$.extend(Plugin.prototype,{init:function(){this.active=!1,this.addPickerIcon(),this.createPicker(),this.listen()},addPickerIcon:function(){var elementHeight=this.$el.outerHeight(),iconHeight=elementHeight>MAX_ICON_HEIGHT?MAX_ICON_HEIGHT:elementHeight,objectWidth=this.$el.width();this.$el.width(objectWidth),this.$wrapper=this.$el.wrap("<div class='emojiPickerIconWrap'></div>").parent(),this.settings.button&&(this.$icon=$('<div class="emojiPickerIcon"></div>').height(iconHeight).width(iconHeight).addClass(this.settings.iconColor).css("backgroundColor",this.settings.iconBackgroundColor),this.$wrapper.append(this.$icon))},createPicker:function(){this.$picker=$(getPickerHTML()).appendTo(this.$container).width(this.settings.width).height(this.settings.height).css("z-index",1e4),this.$picker.find("section").height(parseInt(this.settings.height)-40),this.settings.width<240&&this.$picker.find(".emoji").css({width:"2em",height:"2em"})},listen:function(){this.$wrapper.find(".emojiPickerIcon").click($.proxy(this.iconClicked,this)),this.$picker.find("section div").click($.proxy(this.emojiClicked,this)),this.$picker.find("nav .tab").click($.proxy(this.emojiCategoryClicked,this)),this.$picker.click($.proxy(this.pickerClicked,this)),$(document.body).click($.proxy(this.clickOutside,this))},updatePosition:function(){var top,left;return top=0,left=0,this.$picker.css({top:top,left:left}),this},hide:function(){this.$picker.hide(this.settings.fadeTime,"linear",function(){this.active=!1}.bind(this))},show:function(){this.updatePosition(),this.$picker.show(this.settings.fadeTime,"linear",function(){this.active=!0}.bind(this))},iconClicked:function(e){this.$picker.is(":hidden")?this.show():this.hide()},reset:function(){this.$picker.width($(window).width()),this.$picker.height($(window).height())},emojiClicked:function(e){var emojiShortcode=$(e.target).attr("class").split("emoji-")[1],emojiUnicode=toUnicode(findEmoji(emojiShortcode).unicode);insertAtCaret(this.element,emojiUnicode),$("body").pagecontainer("change","#chat-page"),this.hide()},emojiCategoryClicked:function(e){var section="";this.$picker.find("nav .tab").removeClass("active"),$(e.target).parent().hasClass("tab")?(section=$(e.target).parent().attr("data-tab"),$(e.target).parent(".tab").addClass("active")):(section=$(e.target).attr("data-tab"),$(e.target).addClass("active")),this.$picker.find("section").hide(),this.$picker.find("section."+section).show()},pickerClicked:function(e){e.stopPropagation()},clickOutside:function(e){this.active&&this.hide()}}),$.fn[pluginName]=function(options){return"string"==typeof options?(this.each(function(){var plugin=$.data(this,pluginName);switch(options){case"toggle":plugin.iconClicked();break;case"reset":plugin.reset();break;case"hide":plugin.clickOutside()}}),this):(this.each(function(){$.data(this,pluginName)?($.data(this,pluginName,{}),$.data(this,pluginName,new Plugin(this,options))):$.data(this,pluginName,new Plugin(this,options))}),this)},String.fromCodePoint||(String.fromCodePoint=function(){var point,offset,units,i,chars=[];for(i=0;i<arguments.length;++i)point=arguments[i],offset=point-65536,units=point>65535?[55296+(offset>>10),56320+(1023&offset)]:[point],chars.push(String.fromCharCode.apply(null,units));return chars.join("")})}(jQuery),$(function(){$.fn.emojiPicker.emojis=[{name:"bangbang",unicode:"203C",shortcode:"bangbang",description:"DOUBLE EXCLAMATION MARK",category:"symbol"},{name:"interrobang",unicode:"2049",shortcode:"interrobang",description:"EXCLAMATION QUESTION MARK",category:"folderol"},{name:"tm",unicode:"2122",shortcode:"tm",description:"TRADE MARK SIGN",category:"folderol"},{name:"information_source",unicode:"2139",shortcode:"information_source",description:"INFORMATION SOURCE",category:"folderol"},{name:"left_right_arrow",unicode:"2194",shortcode:"left_right_arrow",description:"LEFT RIGHT ARROW",category:"folderol"},{name:"arrow_up_down",unicode:"2195",shortcode:"arrow_up_down",description:"UP DOWN ARROW",category:"folderol"},{name:"arrow_upper_left",unicode:"2196",shortcode:"arrow_upper_left",description:"NORTH WEST ARROW",category:"folderol"},{name:"arrow_upper_right",unicode:"2197",shortcode:"arrow_upper_right",description:"NORTH EAST ARROW",category:"folderol"},{name:"arrow_lower_right",unicode:"2198",shortcode:"arrow_lower_right",description:"SOUTH EAST ARROW",category:"folderol"},{name:"arrow_lower_left",unicode:"2199",shortcode:"arrow_lower_left",description:"SOUTH WEST ARROW",category:"folderol"},{name:"leftwards_arrow_with_hook",unicode:"21A9",shortcode:"leftwards_arrow_with_hook",description:"LEFTWARDS ARROW WITH HOOK",category:"folderol"},{name:"arrow_right_hook",unicode:"21AA",shortcode:"arrow_right_hook",description:"RIGHTWARDS ARROW WITH HOOK",category:"folderol"},{name:"watch",unicode:"231A",shortcode:"watch",description:"WATCH",category:"thing"},{name:"hourglass",unicode:"231B",shortcode:"hourglass",description:"HOURGLASS",category:"thing"},{name:"fast_forward",unicode:"23E9",shortcode:"fast_forward",description:"BLACK RIGHT-POINTING DOUBLE TRIANGLE"},{name:"rewind",unicode:"23EA",shortcode:"rewind",description:"BLACK LEFT-POINTING DOUBLE TRIANGLE",category:"thing"},{name:"arrow_double_up",unicode:"23EB",shortcode:"arrow_double_up",description:"BLACK UP-POINTING DOUBLE TRIANGLE",category:"folderol"},{name:"arrow_double_down",unicode:"23EC",shortcode:"arrow_double_down",description:"BLACK DOWN-POINTING DOUBLE TRIANGLE",category:"folderol"},{name:"alarm_clock",unicode:"23F0",shortcode:"alarm_clock",description:"ALARM CLOCK",category:"thing"},{name:"hourglass_flowing_sand",unicode:"23F3",shortcode:"hourglass_flowing_sand",description:"HOURGLASS WITH FLOWING SAND",category:"thing"},{name:"m",unicode:"24C2",shortcode:"m",description:"CIRCLED LATIN CAPITAL LETTER M",category:"folderol"},{name:"black_small_square",unicode:"25AA",shortcode:"black_small_square",description:"BLACK SMALL SQUARE",category:"folderol"},{name:"white_small_square",unicode:"25AB",shortcode:"white_small_square",description:"WHITE SMALL SQUARE",category:"folderol"},{name:"arrow_forward",unicode:"25B6",shortcode:"arrow_forward",description:"BLACK RIGHT-POINTING TRIANGLE",category:"folderol"},{name:"arrow_backward",unicode:"25C0",shortcode:"arrow_backward",description:"BLACK LEFT-POINTING TRIANGLE",category:"folderol"},{name:"white_medium_square",unicode:"25FB",shortcode:"white_medium_square",description:"WHITE MEDIUM SQUARE",category:"folderol"},{name:"black_medium_square",unicode:"25FC",shortcode:"black_medium_square",description:"BLACK MEDIUM SQUARE",category:"folderol"},{name:"white_medium_small_square",unicode:"25FD",shortcode:"white_medium_small_square",description:"WHITE MEDIUM SMALL SQUARE",category:"folderol"},{name:"black_medium_small_square",unicode:"25FE",shortcode:"black_medium_small_square",description:"BLACK MEDIUM SMALL SQUARE",category:"folderol"},{name:"sunny",unicode:"2600",shortcode:"sunny",description:"BLACK SUN WITH RAYS",category:"thing"},{name:"cloud",unicode:"2601",shortcode:"cloud",description:"CLOUD",category:"thing"},{name:"phone",unicode:"260E",shortcode:"phone",description:"BLACK TELEPHONE",category:"thing"},{name:"ballot_box_with_check",unicode:"2611",shortcode:"ballot_box_with_check",description:"BALLOT BOX WITH CHECK",category:"thing"},{name:"umbrella",unicode:"2614",shortcode:"umbrella",description:"UMBRELLA WITH RAIN DROPS",category:"thing"},{name:"coffee",unicode:"2615",shortcode:"coffee",description:"HOT BEVERAGE",category:"thing"},{name:"point_up",unicode:"261D",shortcode:"point_up",description:"WHITE UP POINTING INDEX",category:"people"},{name:"relaxed",unicode:"263A",shortcode:"relaxed",description:"WHITE SMILING FACE",category:"emotion"},{name:"aries",unicode:"2648",shortcode:"aries",description:"ARIES",category:"folderol"},{name:"taurus",unicode:"2649",shortcode:"taurus",description:"TAURUS",category:"folderol"},{name:"gemini",unicode:"264A",shortcode:"gemini",description:"GEMINI",category:"folderol"},{name:"cancer",unicode:"264B",shortcode:"cancer",description:"CANCER",category:"folderol"},{name:"leo",unicode:"264C",shortcode:"leo",description:"LEO",category:"folderol"},{name:"virgo",unicode:"264D",shortcode:"virgo",description:"VIRGO",category:"folderol"},{name:"libra",unicode:"264E",shortcode:"libra",description:"LIBRA",category:"folderol"},{name:"scorpius",unicode:"264F",shortcode:"scorpius",description:"SCORPIUS",category:"folderol"},{name:"sagittarius",unicode:"2650",shortcode:"sagittarius",description:"SAGITTARIUS",category:"folderol"},{name:"capricorn",unicode:"2651",shortcode:"capricorn",description:"CAPRICORN",category:"folderol"},{name:"aquarius",unicode:"2652",shortcode:"aquarius",description:"AQUARIUS",category:"folderol"},{name:"pisces",unicode:"2653",shortcode:"pisces",description:"PISCES",category:"folderol"},{name:"spades",unicode:"2660",shortcode:"spades",description:"BLACK SPADE SUIT",category:"folderol"},{name:"clubs",unicode:"2663",shortcode:"clubs",description:"BLACK CLUB SUIT",category:"folderol"},{name:"hearts",unicode:"2665",shortcode:"hearts",description:"BLACK HEART SUIT",category:"folderol"},{name:"diamonds",unicode:"2666",shortcode:"diamonds",description:"BLACK DIAMOND SUIT",category:"folderol"},{name:"hotsprings",unicode:"2668",shortcode:"hotsprings",description:"HOT SPRINGS",category:"thing"},{name:"recycle",unicode:"267B",shortcode:"recycle",description:"BLACK UNIVERSAL RECYCLING SYMBOL",category:"folderol"},{name:"wheelchair",unicode:"267F",shortcode:"wheelchair",description:"WHEELCHAIR SYMBOL",category:"thing"},{name:"anchor",unicode:"2693",shortcode:"anchor",description:"ANCHOR",category:"thing"},{name:"warning",unicode:"26A0",shortcode:"warning",description:"WARNING SIGN",category:"thing"},{name:"zap",unicode:"26A1",shortcode:"zap",description:"HIGH VOLTAGE SIGN",category:"thing"},{name:"white_circle",unicode:"26AA",shortcode:"white_circle",description:"MEDIUM WHITE CIRCLE",category:"folderol"},{name:"black_circle",unicode:"26AB",shortcode:"black_circle",description:"MEDIUM BLACK CIRCLE",category:"folderol"},{name:"soccer",unicode:"26BD",shortcode:"soccer",description:"SOCCER BALL",category:"thing"},{name:"baseball",unicode:"26BE",shortcode:"baseball",description:"BASEBALL",category:"thing"},{name:"snowman",unicode:"26C4",shortcode:"snowman",description:"SNOWMAN WITHOUT SNOW",category:"thing"},{name:"partly_sunny",unicode:"26C5",shortcode:"partly_sunny",description:"SUN BEHIND CLOUD",category:"thing"},{name:"ophiuchus",unicode:"26CE",shortcode:"ophiuchus",description:"OPHIUCHUS",category:"folderol"},{name:"no_entry",unicode:"26D4",shortcode:"no_entry",description:"NO ENTRY",category:"folderol"},{name:"church",unicode:"26EA",shortcode:"church",description:"CHURCH",category:"travel"},{name:"fountain",unicode:"26F2",shortcode:"fountain",description:"FOUNTAIN",category:"travel"},{name:"golf",unicode:"26F3",shortcode:"golf",description:"FLAG IN HOLE",category:"travel"},{name:"boat",unicode:"26F5",shortcode:"boat",description:"SAILBOAT",category:"travel"},{name:"tent",unicode:"26FA",shortcode:"tent",description:"TENT",category:"travel"},{name:"fuelpump",unicode:"26FD",shortcode:"fuelpump",description:"FUEL PUMP",category:"travel"},{name:"scissors",unicode:"2702",shortcode:"scissors",description:"BLACK SCISSORS",category:"thing"},{name:"white_check_mark",unicode:"2705",shortcode:"white_check_mark",description:"WHITE HEAVY CHECK MARK",category:"folderol"},{name:"airplane",unicode:"2708",shortcode:"airplane",description:"AIRPLANE",category:"thing"},{name:"email",unicode:"2709",shortcode:"email",description:"ENVELOPE",category:"thing"},{name:"fist",unicode:"270A",shortcode:"fist",description:"RAISED FIST",category:"people"},{name:"hand",unicode:"270B",shortcode:"hand",description:"RAISED HAND",category:"people"},{name:"v",unicode:"270C",shortcode:"v",description:"VICTORY HAND",category:"folderol"},{name:"pencil2",unicode:"270F",shortcode:"pencil2",description:"PENCIL",category:"thing"},{name:"black_nib",unicode:"2712",shortcode:"black_nib",description:"BLACK NIB",category:"folderol"},{name:"heavy_check_mark",unicode:"2714",shortcode:"heavy_check_mark",description:"HEAVY CHECK MARK",category:"folderol"},{name:"heavy_multiplication_x",unicode:"2716",shortcode:"heavy_multiplication_x",description:"HEAVY MULTIPLICATION X",category:"folderol"},{name:"sparkles",unicode:"2728",shortcode:"sparkles",description:"SPARKLES",category:"folderol"
},{name:"eight_spoked_asterisk",unicode:"2733",shortcode:"eight_spoked_asterisk",description:"EIGHT SPOKED ASTERISK",category:"folderol"},{name:"eight_pointed_black_star",unicode:"2734",shortcode:"eight_pointed_black_star",description:"EIGHT POINTED BLACK STAR",category:"folderol"},{name:"snowflake",unicode:"2744",shortcode:"snowflake",description:"SNOWFLAKE",category:"thing"},{name:"sparkle",unicode:"2747",shortcode:"sparkle",description:"SPARKLE",category:"thing"},{name:"x",unicode:"274C",shortcode:"x",description:"CROSS MARK",category:"folderol"},{name:"negative_squared_cross_mark",unicode:"274E",shortcode:"negative_squared_cross_mark",description:"NEGATIVE SQUARED CROSS MARK",category:"folderol"},{name:"question",unicode:"2753",shortcode:"question",description:"BLACK QUESTION MARK ORNAMENT",category:"folderol"},{name:"grey_question",unicode:"2754",shortcode:"grey_question",description:"WHITE QUESTION MARK ORNAMENT",category:"folderol"},{name:"grey_exclamation",unicode:"2755",shortcode:"grey_exclamation",description:"WHITE EXCLAMATION MARK ORNAMENT",category:"folderol"},{name:"exclamation",unicode:"2757",shortcode:"exclamation",description:"HEAVY EXCLAMATION MARK SYMBOL",category:"folderol"},{name:"heart",unicode:"2764",shortcode:"heart",description:"HEAVY BLACK HEART",category:"folderol"},{name:"heavy_plus_sign",unicode:"2795",shortcode:"heavy_plus_sign",description:"HEAVY PLUS SIGN",category:"folderol"},{name:"heavy_minus_sign",unicode:"2796",shortcode:"heavy_minus_sign",description:"HEAVY MINUS SIGN",category:"folderol"},{name:"heavy_division_sign",unicode:"2797",shortcode:"heavy_division_sign",description:"HEAVY DIVISION SIGN",category:"folderol"},{name:"arrow_right",unicode:"27A1",shortcode:"arrow_right",description:"BLACK RIGHTWARDS ARROW",category:"folderol"},{name:"curly_loop",unicode:"27B0",shortcode:"curly_loop",description:"CURLY LOOP",category:"folderol"},{name:"loop",unicode:"27BF",shortcode:"loop",description:"DOUBLE CURLY LOOP",category:"folderol"},{name:"arrow_heading_up",unicode:"2934",shortcode:"arrow_heading_up",description:"ARROW POINTING RIGHTWARDS THEN CURVING UPWARDS",category:"folderol"},{name:"arrow_heading_down",unicode:"2935",shortcode:"arrow_heading_down",description:"ARROW POINTING RIGHTWARDS THEN CURVING DOWNWARDS",category:"folderol"},{name:"arrow_left",unicode:"2B05",shortcode:"arrow_left",description:"LEFTWARDS BLACK ARROW",category:"folderol"},{name:"arrow_up",unicode:"2B06",shortcode:"arrow_up",description:"UPWARDS BLACK ARROW",category:"folderol"},{name:"arrow_down",unicode:"2B07",shortcode:"arrow_down",description:"DOWNWARDS BLACK ARROW",category:"folderol"},{name:"black_large_square",unicode:"2B1B",shortcode:"black_large_square",description:"BLACK LARGE SQUARE",category:"folderol"},{name:"white_large_square",unicode:"2B1C",shortcode:"white_large_square",description:"WHITE LARGE SQUARE",category:"folderol"},{name:"star",unicode:"2B50",shortcode:"star",description:"WHITE MEDIUM STAR",category:"thing"},{name:"o",unicode:"2B55",shortcode:"o",description:"HEAVY LARGE CIRCLE",category:"folderol"},{name:"wavy_dash",unicode:"3030",shortcode:"wavy_dash",description:"WAVY DASH",category:"folderol"},{name:"part_alternation_mark",unicode:"303D",shortcode:"part_alternation_mark",description:"PART ALTERNATION MARK",category:"folderol"},{name:"congratulations",unicode:"3297",shortcode:"congratulations",description:"CIRCLED IDEOGRAPH CONGRATULATION",category:"folderol"},{name:"secret",unicode:"3299",shortcode:"secret",description:"CIRCLED IDEOGRAPH SECRET",category:"folderol"},{name:"mahjong",unicode:"1F004",shortcode:"mahjong",description:"MAHJONG TILE RED DRAGON",category:"folderol"},{name:"black_joker",unicode:"1F0CF",shortcode:"black_joker",description:"PLAYING CARD BLACK JOKER",category:"folderol"},{name:"a",unicode:"1F170",shortcode:"a",description:"NEGATIVE SQUARED LATIN CAPITAL LETTER A",category:"folderol"},{name:"b",unicode:"1F171",shortcode:"b",description:"NEGATIVE SQUARED LATIN CAPITAL LETTER B",category:"folderol"},{name:"o2",unicode:"1F17E",shortcode:"o2",description:"NEGATIVE SQUARED LATIN CAPITAL LETTER O",category:"folderol"},{name:"parking",unicode:"1F17F",shortcode:"parking",description:"NEGATIVE SQUARED LATIN CAPITAL LETTER P",category:"folderol"},{name:"ab",unicode:"1F18E",shortcode:"ab",description:"NEGATIVE SQUARED AB",category:"folderol"},{name:"cl",unicode:"1F191",shortcode:"cl",description:"SQUARED CL",category:"folderol"},{name:"cool",unicode:"1F192",shortcode:"cool",description:"SQUARED COOL",category:"folderol"},{name:"free",unicode:"1F193",shortcode:"free",description:"SQUARED FREE",category:"folderol"},{name:"id",unicode:"1F194",shortcode:"id",description:"SQUARED ID",category:"folderol"},{name:"new",unicode:"1F195",shortcode:"new",description:"SQUARED NEW",category:"folderol"},{name:"ng",unicode:"1F196",shortcode:"ng",description:"SQUARED NG",category:"folderol"},{name:"ok",unicode:"1F197",shortcode:"ok",description:"SQUARED OK",category:"folderol"},{name:"sos",unicode:"1F198",shortcode:"sos",description:"SQUARED SOS",category:"folderol"},{name:"up",unicode:"1F199",shortcode:"up",description:"SQUARED UP WITH EXCLAMATION MARK",category:"folderol"},{name:"vs",unicode:"1F19A",shortcode:"vs",description:"SQUARED VS",category:"folderol"},{name:"koko",unicode:"1F201",shortcode:"koko",description:"SQUARED KATAKANA KOKO",category:"folderol"},{name:"sa",unicode:"1F202",shortcode:"sa",description:"SQUARED KATAKANA SA",category:"folderol"},{name:"u7121",unicode:"1F21A",shortcode:"u7121",description:"SQUARED CJK UNIFIED IDEOGRAPH-7121",category:"folderol"},{name:"u6307",unicode:"1F22F",shortcode:"u6307",description:"SQUARED CJK UNIFIED IDEOGRAPH-6307",category:"folderol"},{name:"u7981",unicode:"1F232",shortcode:"u7981",description:"SQUARED CJK UNIFIED IDEOGRAPH-7981",category:"folderol"},{name:"u7a7a",unicode:"1F233",shortcode:"u7a7a",description:"SQUARED CJK UNIFIED IDEOGRAPH-7A7A",category:"folderol"},{name:"u5408",unicode:"1F234",shortcode:"u5408",description:"SQUARED CJK UNIFIED IDEOGRAPH-5408",category:"folderol"},{name:"u6e80",unicode:"1F235",shortcode:"u6e80",description:"SQUARED CJK UNIFIED IDEOGRAPH-6E80",category:"folderol"},{name:"u6709",unicode:"1F236",shortcode:"u6709",description:"SQUARED CJK UNIFIED IDEOGRAPH-6709",category:"folderol"},{name:"u6708",unicode:"1F237",shortcode:"u6708",description:"SQUARED CJK UNIFIED IDEOGRAPH-6708",category:"folderol"},{name:"u7533",unicode:"1F238",shortcode:"u7533",description:"SQUARED CJK UNIFIED IDEOGRAPH-7533",category:"folderol"},{name:"u5272",unicode:"1F239",shortcode:"u5272",description:"SQUARED CJK UNIFIED IDEOGRAPH-5272",category:"folderol"},{name:"u55b6",unicode:"1F23A",shortcode:"u55b6",description:"SQUARED CJK UNIFIED IDEOGRAPH-55B6",category:"folderol"},{name:"ideograph_advantage",unicode:"1F250",shortcode:"ideograph_advantage",description:"CIRCLED IDEOGRAPH ADVANTAGE",category:"folderol"},{name:"accept",unicode:"1F251",shortcode:"accept",description:"CIRCLED IDEOGRAPH ACCEPT",category:"folderol"},{name:"cyclone",unicode:"1F300",shortcode:"cyclone",description:"CYCLONE",category:"thing"},{name:"foggy",unicode:"1F301",shortcode:"foggy",description:"FOGGY",category:"thing"},{name:"closed_umbrella",unicode:"1F302",shortcode:"closed_umbrella",description:"CLOSED UMBRELLA",category:"thing"},{name:"night_with_stars",unicode:"1F303",shortcode:"night_with_stars",description:"NIGHT WITH STARS",category:"thing"},{name:"sunrise_over_mountains",unicode:"1F304",shortcode:"sunrise_over_mountains",description:"SUNRISE OVER MOUNTAINS",category:"thing"},{name:"sunrise",unicode:"1F305",shortcode:"sunrise",description:"SUNRISE",category:"thing"},{name:"city_sunset",unicode:"1F306",shortcode:"city_sunset",description:"CITYSCAPE AT DUSK",category:"thing"},{name:"city_sunrise",unicode:"1F307",shortcode:"city_sunrise",description:"SUNSET OVER BUILDINGS",category:"thing"},{name:"rainbow",unicode:"1F308",shortcode:"rainbow",description:"RAINBOW",category:"thing"},{name:"bridge_at_night",unicode:"1F309",shortcode:"bridge_at_night",description:"BRIDGE AT NIGHT",category:"thing"},{name:"ocean",unicode:"1F30A",shortcode:"ocean",description:"WATER WAVE",category:"thing"},{name:"volcano",unicode:"1F30B",shortcode:"volcano",description:"VOLCANO",category:"thing"},{name:"milky_way",unicode:"1F30C",shortcode:"milky_way",description:"MILKY WAY",category:"thing"},{name:"earth_africa",unicode:"1F30D",shortcode:"earth_africa",description:"EARTH GLOBE EUROPE-AFRICA",category:"thing"},{name:"earth_americas",unicode:"1F30E",shortcode:"earth_americas",description:"EARTH GLOBE AMERICAS",category:"thing"},{name:"earth_asia",unicode:"1F30F",shortcode:"earth_asia",description:"EARTH GLOBE ASIA-AUSTRALIA",category:"thing"},{name:"globe_with_meridians",unicode:"1F310",shortcode:"globe_with_meridians",description:"GLOBE WITH MERIDIANS",category:"thing"},{name:"new_moon",unicode:"1F311",shortcode:"new_moon",description:"NEW MOON SYMBOL",category:"thing"},{name:"waxing_crescent_moon",unicode:"1F312",shortcode:"waxing_crescent_moon",description:"WAXING CRESCENT MOON SYMBOL",category:"thing"},{name:"first_quarter_moon",unicode:"1F313",shortcode:"first_quarter_moon",description:"FIRST QUARTER MOON SYMBOL",category:"thing"},{name:"moon",unicode:"1F314",shortcode:"moon",description:"WAXING GIBBOUS MOON SYMBOL",category:"thing"},{name:"full_moon",unicode:"1F315",shortcode:"full_moon",description:"FULL MOON SYMBOL",category:"thing"},{name:"waning_gibbous_moon",unicode:"1F316",shortcode:"waning_gibbous_moon",description:"WANING GIBBOUS MOON SYMBOL",category:"thing"},{name:"last_quarter_moon",unicode:"1F317",shortcode:"last_quarter_moon",description:"LAST QUARTER MOON SYMBOL",category:"thing"},{name:"waning_crescent_moon",unicode:"1F318",shortcode:"waning_crescent_moon",description:"WANING CRESCENT MOON SYMBOL",category:"thing"},{name:"crescent_moon",unicode:"1F319",shortcode:"crescent_moon",description:"CRESCENT MOON",category:"thing"},{name:"new_moon_with_face",unicode:"1F31A",shortcode:"new_moon_with_face",description:"NEW MOON WITH FACE",category:"thing"},{name:"first_quarter_moon_with_face",unicode:"1F31B",shortcode:"first_quarter_moon_with_face",description:"FIRST QUARTER MOON WITH FACE",category:"thing"},{name:"last_quarter_moon_with_face",unicode:"1F31C",shortcode:"last_quarter_moon_with_face",description:"LAST QUARTER MOON WITH FACE",category:"thing"},{name:"full_moon_with_face",unicode:"1F31D",shortcode:"full_moon_with_face",description:"FULL MOON WITH FACE",category:"thing"},{name:"sun_with_face",unicode:"1F31E",shortcode:"sun_with_face",description:"SUN WITH FACE",category:"thing"},{name:"star2",unicode:"1F31F",shortcode:"star2",description:"GLOWING STAR",category:"thing"},{name:"stars",unicode:"1F320",shortcode:"stars",description:"SHOOTING STAR",category:"thing"},{name:"chestnut",unicode:"1F330",shortcode:"chestnut",description:"CHESTNUT",category:"thing"},{name:"seedling",unicode:"1F331",shortcode:"seedling",description:"SEEDLING",category:"thing"},{name:"evergreen_tree",unicode:"1F332",shortcode:"evergreen_tree",description:"EVERGREEN TREE",category:"thing"},{name:"deciduous_tree",unicode:"1F333",shortcode:"deciduous_tree",description:"DECIDUOUS TREE",category:"thing"},{name:"palm_tree",unicode:"1F334",shortcode:"palm_tree",description:"PALM TREE",category:"thing"},{name:"cactus",unicode:"1F335",shortcode:"cactus",description:"CACTUS",category:"thing"},{name:"tulip",unicode:"1F337",shortcode:"tulip",description:"TULIP",category:"thing"},{name:"cherry_blossom",unicode:"1F338",shortcode:"cherry_blossom",description:"CHERRY BLOSSOM",category:"thing"},{name:"rose",unicode:"1F339",shortcode:"rose",description:"ROSE",category:"thing"},{name:"hibiscus",unicode:"1F33A",shortcode:"hibiscus",description:"HIBISCUS",category:"thing"},{name:"sunflower",unicode:"1F33B",shortcode:"sunflower",description:"SUNFLOWER",category:"thing"},{name:"blossom",unicode:"1F33C",shortcode:"blossom",description:"BLOSSOM",category:"thing"},{name:"corn",unicode:"1F33D",shortcode:"corn",description:"EAR OF MAIZE",category:"thing"},{name:"ear_of_rice",unicode:"1F33E",shortcode:"ear_of_rice",description:"EAR OF RICE",category:"thing"},{name:"herb",unicode:"1F33F",shortcode:"herb",description:"HERB",category:"thing"},{name:"four_leaf_clover",unicode:"1F340",shortcode:"four_leaf_clover",description:"FOUR LEAF CLOVER",category:"thing"},{name:"maple_leaf",unicode:"1F341",shortcode:"maple_leaf",description:"MAPLE LEAF",category:"thing"},{name:"fallen_leaf",unicode:"1F342",shortcode:"fallen_leaf",description:"FALLEN LEAF",category:"thing"},{name:"leaves",unicode:"1F343",shortcode:"leaves",description:"LEAF FLUTTERING IN WIND",category:"thing"},{name:"mushroom",unicode:"1F344",shortcode:"mushroom",description:"MUSHROOM",category:"food"},{name:"tomato",unicode:"1F345",shortcode:"tomato",description:"TOMATO",category:"food"},{name:"eggplant",unicode:"1F346",shortcode:"eggplant",description:"AUBERGINE",category:"food"},{name:"grapes",unicode:"1F347",shortcode:"grapes",description:"GRAPES",category:"food"},{name:"melon",unicode:"1F348",shortcode:"melon",description:"MELON",category:"food"},{name:"watermelon",unicode:"1F349",shortcode:"watermelon",description:"WATERMELON",category:"food"},{name:"tangerine",unicode:"1F34A",shortcode:"tangerine",description:"TANGERINE",category:"food"},{name:"lemon",unicode:"1F34B",shortcode:"lemon",description:"LEMON",category:"food"},{name:"banana",unicode:"1F34C",shortcode:"banana",description:"BANANA",category:"food"},{name:"pineapple",unicode:"1F34D",shortcode:"pineapple",description:"PINEAPPLE",category:"food"},{name:"apple",unicode:"1F34E",shortcode:"apple",description:"RED APPLE",category:"food"},{name:"green_apple",unicode:"1F34F",shortcode:"green_apple",description:"GREEN APPLE",category:"food"},{name:"pear",unicode:"1F350",shortcode:"pear",description:"PEAR",category:"food"},{name:"peach",unicode:"1F351",shortcode:"peach",description:"PEACH",category:"food"},{name:"cherries",unicode:"1F352",shortcode:"cherries",description:"CHERRIES",category:"food"},{name:"strawberry",unicode:"1F353",shortcode:"strawberry",description:"STRAWBERRY",category:"food"},{name:"hamburger",unicode:"1F354",shortcode:"hamburger",description:"HAMBURGER",category:"food"},{name:"pizza",unicode:"1F355",shortcode:"pizza",description:"SLICE OF PIZZA",category:"food"},{name:"meat_on_bone",unicode:"1F356",shortcode:"meat_on_bone",description:"MEAT ON BONE",category:"food"},{name:"poultry_leg",unicode:"1F357",shortcode:"poultry_leg",description:"POULTRY LEG",category:"food"},{name:"rice_cracker",unicode:"1F358",shortcode:"rice_cracker",description:"RICE CRACKER",category:"food"},{name:"rice_ball",unicode:"1F359",shortcode:"rice_ball",description:"RICE BALL",category:"food"},{name:"rice",unicode:"1F35A",shortcode:"rice",description:"COOKED RICE",category:"food"},{name:"curry",unicode:"1F35B",shortcode:"curry",description:"CURRY AND RICE",category:"food"},{name:"ramen",unicode:"1F35C",shortcode:"ramen",description:"STEAMING BOWL",category:"food"},{name:"spaghetti",unicode:"1F35D",shortcode:"spaghetti",description:"SPAGHETTI",category:"food"},{name:"bread",unicode:"1F35E",shortcode:"bread",description:"BREAD",category:"food"},{name:"fries",unicode:"1F35F",shortcode:"fries",description:"FRENCH FRIES",category:"food"},{name:"sweet_potato",unicode:"1F360",shortcode:"sweet_potato",description:"ROASTED SWEET POTATO",category:"food"},{name:"dango",unicode:"1F361",shortcode:"dango",description:"DANGO",category:"food"},{name:"oden",unicode:"1F362",shortcode:"oden",description:"ODEN",category:"food"},{name:"sushi",unicode:"1F363",shortcode:"sushi",description:"SUSHI",category:"food"},{name:"fried_shrimp",unicode:"1F364",shortcode:"fried_shrimp",description:"FRIED SHRIMP",category:"food"},{name:"fish_cake",unicode:"1F365",shortcode:"fish_cake",description:"FISH CAKE WITH SWIRL DESIGN",category:"food"},{name:"icecream",unicode:"1F366",shortcode:"icecream",description:"SOFT ICE CREAM",category:"food"},{name:"shaved_ice",unicode:"1F367",shortcode:"shaved_ice",description:"SHAVED ICE",category:"food"},{name:"ice_cream",unicode:"1F368",shortcode:"ice_cream",description:"ICE CREAM",category:"food"},{name:"doughnut",unicode:"1F369",shortcode:"doughnut",description:"DOUGHNUT",category:"food"},{name:"cookie",unicode:"1F36A",shortcode:"cookie",description:"COOKIE",category:"food"},{name:"chocolate_bar",unicode:"1F36B",shortcode:"chocolate_bar",description:"CHOCOLATE BAR",category:"food"},{name:"candy",unicode:"1F36C",shortcode:"candy",description:"CANDY",category:"food"},{name:"lollipop",unicode:"1F36D",shortcode:"lollipop",description:"LOLLIPOP",category:"food"},{name:"custard",unicode:"1F36E",shortcode:"custard",description:"CUSTARD",category:"food"},{name:"honey_pot",unicode:"1F36F",shortcode:"honey_pot",description:"HONEY POT",category:"food"},{name:"cake",unicode:"1F370",shortcode:"cake",description:"SHORTCAKE",category:"food"},{name:"bento",unicode:"1F371",shortcode:"bento",description:"BENTO BOX",category:"food"},{name:"stew",unicode:"1F372",shortcode:"stew",description:"POT OF FOOD",category:"food"},{name:"egg",unicode:"1F373",shortcode:"egg",description:"COOKING",category:"food"},{name:"fork_and_knife",unicode:"1F374",shortcode:"fork_and_knife",description:"FORK AND KNIFE",category:"food"},{name:"tea",unicode:"1F375",shortcode:"tea",description:"TEACUP WITHOUT HANDLE",category:"food"},{name:"sake",unicode:"1F376",shortcode:"sake",description:"SAKE BOTTLE AND CUP",category:"food"},{name:"wine_glass",unicode:"1F377",shortcode:"wine_glass",description:"WINE GLASS",category:"food"},{name:"cocktail",unicode:"1F378",shortcode:"cocktail",description:"COCKTAIL GLASS",category:"food"},{name:"tropical_drink",unicode:"1F379",shortcode:"tropical_drink",description:"TROPICAL DRINK",category:"food"},{name:"beer",unicode:"1F37A",shortcode:"beer",description:"BEER MUG",category:"food"},{name:"beers",unicode:"1F37B",shortcode:"beers",description:"CLINKING BEER MUGS",category:"food"},{name:"baby_bottle",unicode:"1F37C",shortcode:"baby_bottle",description:"BABY BOTTLE",category:"food"},{name:"ribbon",unicode:"1F380",shortcode:"ribbon",description:"RIBBON",category:"thing"},{name:"gift",unicode:"1F381",shortcode:"gift",description:"WRAPPED PRESENT",category:"thing"},{name:"birthday",unicode:"1F382",shortcode:"birthday",description:"BIRTHDAY CAKE",category:"thing"},{name:"jack_o_lantern",unicode:"1F383",shortcode:"jack_o_lantern",description:"JACK-O-LANTERN",category:"thing"},{name:"christmas_tree",unicode:"1F384",shortcode:"christmas_tree",description:"CHRISTMAS TREE",category:"thing"},{name:"santa",unicode:"1F385",shortcode:"santa",description:"FATHER CHRISTMAS",category:"thing"},{name:"fireworks",unicode:"1F386",shortcode:"fireworks",description:"FIREWORKS",category:"thing"},{name:"sparkler",unicode:"1F387",shortcode:"sparkler",description:"FIREWORK SPARKLER",category:"thing"},{name:"balloon",unicode:"1F388",shortcode:"balloon",description:"BALLOON",category:"thing"},{name:"tada",unicode:"1F389",shortcode:"tada",description:"PARTY POPPER",category:"thing"},{name:"confetti_ball",unicode:"1F38A",shortcode:"confetti_ball",description:"CONFETTI BALL",category:"thing"},{name:"tanabata_tree",unicode:"1F38B",shortcode:"tanabata_tree",description:"TANABATA TREE",category:"thing"},{name:"crossed_flags",unicode:"1F38C",shortcode:"crossed_flags",description:"CROSSED FLAGS",category:"thing"},{name:"bamboo",unicode:"1F38D",shortcode:"bamboo",description:"PINE DECORATION",category:"thing"},{name:"dolls",unicode:"1F38E",shortcode:"dolls",description:"JAPANESE DOLLS",category:"thing"},{name:"flags",unicode:"1F38F",shortcode:"flags",description:"CARP STREAMER",category:"thing"},{name:"wind_chime",unicode:"1F390",shortcode:"wind_chime",description:"WIND CHIME",category:"thing"},{name:"rice_scene",unicode:"1F391",shortcode:"rice_scene",description:"MOON VIEWING CEREMONY",category:"thing"},{name:"school_satchel",unicode:"1F392",shortcode:"school_satchel",description:"SCHOOL SATCHEL",category:"thing"},{name:"mortar_board",unicode:"1F393",shortcode:"mortar_board",description:"GRADUATION CAP",category:"thing"},{name:"carousel_horse",unicode:"1F3A0",shortcode:"carousel_horse",description:"CAROUSEL HORSE",category:"thing"},{name:"ferris_wheel",unicode:"1F3A1",shortcode:"ferris_wheel",description:"FERRIS WHEEL",category:"thing"},{name:"roller_coaster",unicode:"1F3A2",shortcode:"roller_coaster",description:"ROLLER COASTER",category:"thing"},{name:"fishing_pole_and_fish",unicode:"1F3A3",shortcode:"fishing_pole_and_fish",description:"FISHING POLE AND FISH",category:"thing"},{name:"microphone",unicode:"1F3A4",shortcode:"microphone",description:"MICROPHONE",category:"thing"},{name:"movie_camera",unicode:"1F3A5",shortcode:"movie_camera",description:"MOVIE CAMERA",category:"thing"},{name:"cinema",unicode:"1F3A6",shortcode:"cinema",description:"CINEMA",category:"thing"},{name:"headphones",unicode:"1F3A7",shortcode:"headphones",description:"HEADPHONE",category:"thing"},{name:"art",unicode:"1F3A8",shortcode:"art",description:"ARTIST PALETTE",category:"thing"},{name:"tophat",unicode:"1F3A9",shortcode:"tophat",description:"TOP HAT",category:"thing"},{name:"circus_tent",unicode:"1F3AA",shortcode:"circus_tent",description:"CIRCUS TENT",category:"thing"},{name:"ticket",unicode:"1F3AB",shortcode:"ticket",description:"TICKET",category:"thing"},{name:"clapper",unicode:"1F3AC",shortcode:"clapper",description:"CLAPPER BOARD",category:"thing"},{name:"performing_arts",unicode:"1F3AD",shortcode:"performing_arts",description:"PERFORMING ARTS",category:"thing"},{name:"video_game",unicode:"1F3AE",shortcode:"video_game",description:"VIDEO GAME",category:"thing"},{name:"dart",unicode:"1F3AF",shortcode:"dart",description:"DIRECT HIT",category:"thing"},{name:"slot_machine",unicode:"1F3B0",shortcode:"slot_machine",description:"SLOT MACHINE",category:"thing"},{name:"8ball",unicode:"1F3B1",shortcode:"8ball",description:"BILLIARDS",category:"thing"},{name:"game_die",unicode:"1F3B2",shortcode:"game_die",description:"GAME DIE",category:"thing"},{name:"bowling",unicode:"1F3B3",shortcode:"bowling",description:"BOWLING",category:"thing"},{name:"flower_playing_cards",unicode:"1F3B4",shortcode:"flower_playing_cards",description:"FLOWER PLAYING CARDS",category:"thing"},{name:"musical_note",unicode:"1F3B5",shortcode:"musical_note",description:"MUSICAL NOTE",category:"thing"},{name:"notes",unicode:"1F3B6",shortcode:"notes",description:"MULTIPLE MUSICAL NOTES",category:"thing"},{name:"saxophone",unicode:"1F3B7",shortcode:"saxophone",description:"SAXOPHONE",category:"thing"},{name:"guitar",unicode:"1F3B8",shortcode:"guitar",description:"GUITAR",category:"thing"},{name:"musical_keyboard",unicode:"1F3B9",shortcode:"musical_keyboard",description:"MUSICAL KEYBOARD",category:"thing"},{name:"trumpet",unicode:"1F3BA",shortcode:"trumpet",description:"TRUMPET",category:"thing"},{name:"violin",unicode:"1F3BB",shortcode:"violin",description:"VIOLIN",category:"thing"},{name:"musical_score",unicode:"1F3BC",shortcode:"musical_score",description:"MUSICAL SCORE",category:"thing"},{name:"running_shirt_with_sash",unicode:"1F3BD",shortcode:"running_shirt_with_sash",description:"RUNNING SHIRT WITH SASH",category:"thing"},{name:"tennis",unicode:"1F3BE",shortcode:"tennis",description:"TENNIS RACQUET AND BALL",category:"thing"},{name:"ski",unicode:"1F3BF",shortcode:"ski",description:"SKI AND SKI BOOT",category:"thing"},{name:"basketball",unicode:"1F3C0",shortcode:"basketball",description:"BASKETBALL AND HOOP",category:"thing"},{name:"checkered_flag",unicode:"1F3C1",shortcode:"checkered_flag",description:"CHEQUERED FLAG",category:"thing"},{name:"snowboarder",unicode:"1F3C2",shortcode:"snowboarder",description:"SNOWBOARDER",category:"people"},{name:"runner",unicode:"1F3C3",shortcode:"runner",description:"RUNNER",category:"people"},{name:"surfer",unicode:"1F3C4",shortcode:"surfer",description:"SURFER",category:"people"},{name:"trophy",unicode:"1F3C6",shortcode:"trophy",description:"TROPHY",category:"people"},{name:"horse_racing",unicode:"1F3C7",shortcode:"horse_racing",description:"HORSE RACING",category:"people"},{name:"football",unicode:"1F3C8",shortcode:"football",description:"AMERICAN FOOTBALL",category:"people"},{name:"rugby_football",unicode:"1F3C9",shortcode:"rugby_football",description:"RUGBY FOOTBALL",category:"people"},{name:"swimmer",unicode:"1F3CA",shortcode:"swimmer",description:"SWIMMER",category:"people"},{name:"house",unicode:"1F3E0",shortcode:"house",description:"HOUSE BUILDING",category:"travel"},{name:"house_with_garden",unicode:"1F3E1",shortcode:"house_with_garden",description:"HOUSE WITH GARDEN",category:"travel"},{name:"office",unicode:"1F3E2",shortcode:"office",description:"OFFICE BUILDING",category:"travel"},{name:"post_office",unicode:"1F3E3",shortcode:"post_office",description:"JAPANESE POST OFFICE",category:"travel"},{name:"european_post_office",unicode:"1F3E4",shortcode:"european_post_office",description:"EUROPEAN POST OFFICE",category:"travel"},{name:"hospital",unicode:"1F3E5",shortcode:"hospital",description:"HOSPITAL",category:"travel"},{name:"bank",unicode:"1F3E6",shortcode:"bank",description:"BANK",category:"travel"},{name:"atm",unicode:"1F3E7",shortcode:"atm",description:"AUTOMATED TELLER MACHINE",category:"travel"},{name:"hotel",unicode:"1F3E8",shortcode:"hotel",description:"HOTEL",category:"travel"},{name:"love_hotel",unicode:"1F3E9",shortcode:"love_hotel",description:"LOVE HOTEL",category:"travel"},{name:"convenience_store",unicode:"1F3EA",shortcode:"convenience_store",description:"CONVENIENCE STORE",category:"travel"},{name:"school",unicode:"1F3EB",shortcode:"school",description:"SCHOOL",category:"travel"},{name:"department_store",unicode:"1F3EC",shortcode:"department_store",description:"DEPARTMENT STORE",category:"travel"},{name:"factory",unicode:"1F3ED",shortcode:"factory",description:"FACTORY",category:"travel"},{name:"izakaya_lantern",unicode:"1F3EE",shortcode:"izakaya_lantern",description:"IZAKAYA LANTERN",category:"travel"},{name:"japanese_castle",unicode:"1F3EF",shortcode:"japanese_castle",description:"JAPANESE CASTLE",category:"travel"},{name:"european_castle",unicode:"1F3F0",shortcode:"european_castle",description:"EUROPEAN CASTLE",category:"travel"},{name:"rat",unicode:"1F400",shortcode:"rat",description:"RAT",category:"animal"},{name:"mouse2",unicode:"1F401",shortcode:"mouse2",description:"MOUSE",category:"animal"},{name:"ox",unicode:"1F402",shortcode:"ox",description:"OX",category:"animal"},{name:"water_buffalo",unicode:"1F403",shortcode:"water_buffalo",description:"WATER BUFFALO",category:"animal"},{name:"cow2",unicode:"1F404",shortcode:"cow2",description:"COW",category:"animal"},{name:"tiger2",unicode:"1F405",shortcode:"tiger2",description:"TIGER",category:"animal"},{name:"leopard",unicode:"1F406",shortcode:"leopard",description:"LEOPARD",category:"animal"},{name:"rabbit2",unicode:"1F407",shortcode:"rabbit2",description:"RABBIT",category:"animal"},{name:"cat2",unicode:"1F408",shortcode:"cat2",description:"CAT",category:"animal"},{name:"dragon",unicode:"1F409",shortcode:"dragon",description:"DRAGON",category:"animal"},{name:"crocodile",unicode:"1F40A",shortcode:"crocodile",description:"CROCODILE",category:"animal"},{name:"whale2",unicode:"1F40B",shortcode:"whale2",description:"WHALE",category:"animal"},{name:"snail",unicode:"1F40C",shortcode:"snail",description:"SNAIL",category:"animal"},{name:"snake",unicode:"1F40D",shortcode:"snake",description:"SNAKE",category:"animal"},{name:"racehorse",unicode:"1F40E",shortcode:"racehorse",description:"HORSE",category:"animal"},{name:"ram",unicode:"1F40F",shortcode:"ram",description:"RAM",category:"animal"},{name:"goat",unicode:"1F410",shortcode:"goat",description:"GOAT",category:"animal"},{name:"sheep",unicode:"1F411",shortcode:"sheep",description:"SHEEP",category:"animal"},{name:"monkey",unicode:"1F412",shortcode:"monkey",description:"MONKEY",category:"animal"},{name:"rooster",unicode:"1F413",shortcode:"rooster",description:"ROOSTER",category:"animal"},{name:"chicken",unicode:"1F414",shortcode:"chicken",description:"CHICKEN",category:"animal"},{name:"dog2",unicode:"1F415",shortcode:"dog2",description:"DOG",category:"animal"},{name:"pig2",unicode:"1F416",shortcode:"pig2",description:"PIG",category:"animal"},{name:"boar",unicode:"1F417",shortcode:"boar",description:"BOAR",category:"animal"},{name:"elephant",unicode:"1F418",shortcode:"elephant",description:"ELEPHANT",category:"animal"},{name:"octopus",unicode:"1F419",shortcode:"octopus",description:"OCTOPUS",category:"animal"},{name:"shell",unicode:"1F41A",shortcode:"shell",description:"SPIRAL SHELL",category:"animal"},{name:"bug",unicode:"1F41B",shortcode:"bug",description:"BUG",category:"animal"},{name:"ant",unicode:"1F41C",shortcode:"ant",description:"ANT",category:"animal"},{name:"bee",unicode:"1F41D",shortcode:"bee",description:"HONEYBEE",category:"animal"},{name:"beetle",unicode:"1F41E",shortcode:"beetle",description:"LADY BEETLE",category:"animal"},{name:"fish",unicode:"1F41F",shortcode:"fish",description:"FISH",category:"animal"},{name:"tropical_fish",unicode:"1F420",shortcode:"tropical_fish",description:"TROPICAL FISH",category:"animal"},{name:"blowfish",unicode:"1F421",shortcode:"blowfish",description:"BLOWFISH",category:"animal"},{name:"turtle",unicode:"1F422",shortcode:"turtle",description:"TURTLE",category:"animal"},{name:"hatching_chick",unicode:"1F423",shortcode:"hatching_chick",description:"HATCHING CHICK",category:"animal"},{name:"baby_chick",unicode:"1F424",shortcode:"baby_chick",description:"BABY CHICK",category:"animal"},{name:"hatched_chick",unicode:"1F425",shortcode:"hatched_chick",description:"FRONT-FACING BABY CHICK",category:"animal"},{name:"bird",unicode:"1F426",shortcode:"bird",description:"BIRD",category:"animal"},{name:"penguin",unicode:"1F427",shortcode:"penguin",description:"PENGUIN",category:"animal"},{name:"koala",unicode:"1F428",shortcode:"koala",description:"KOALA",category:"animal"},{name:"poodle",unicode:"1F429",shortcode:"poodle",description:"POODLE",category:"animal"},{name:"dromedary_camel",unicode:"1F42A",shortcode:"dromedary_camel",description:"DROMEDARY CAMEL",category:"animal"},{name:"camel",unicode:"1F42B",shortcode:"camel",description:"BACTRIAN CAMEL",category:"animal"},{name:"dolphin",unicode:"1F42C",shortcode:"dolphin",description:"DOLPHIN",category:"animal"},{name:"mouse",unicode:"1F42D",shortcode:"mouse",description:"MOUSE FACE",category:"animal"},{name:"cow",unicode:"1F42E",shortcode:"cow",description:"COW FACE",category:"animal"},{name:"tiger",unicode:"1F42F",shortcode:"tiger",description:"TIGER FACE",category:"animal"},{name:"rabbit",unicode:"1F430",shortcode:"rabbit",description:"RABBIT FACE",category:"animal"},{name:"cat",unicode:"1F431",shortcode:"cat",description:"CAT FACE",category:"animal"},{name:"dragon_face",unicode:"1F432",shortcode:"dragon_face",description:"DRAGON FACE",category:"animal"},{name:"whale",unicode:"1F433",shortcode:"whale",description:"SPOUTING WHALE",category:"animal"},{name:"horse",unicode:"1F434",shortcode:"horse",description:"HORSE FACE",category:"animal"},{name:"monkey_face",unicode:"1F435",shortcode:"monkey_face",description:"MONKEY FACE",category:"animal"},{name:"dog",unicode:"1F436",shortcode:"dog",description:"DOG FACE",category:"animal"},{name:"pig",unicode:"1F437",shortcode:"pig",description:"PIG FACE",category:"animal"},{name:"frog",unicode:"1F438",shortcode:"frog",description:"FROG FACE",category:"animal"},{name:"hamster",unicode:"1F439",shortcode:"hamster",description:"HAMSTER FACE",category:"animal"},{name:"wolf",unicode:"1F43A",shortcode:"wolf",description:"WOLF FACE",category:"animal"},{name:"bear",unicode:"1F43B",shortcode:"bear",description:"BEAR FACE",category:"animal"},{name:"panda_face",unicode:"1F43C",shortcode:"panda_face",description:"PANDA FACE",category:"animal"},{name:"pig_nose",unicode:"1F43D",shortcode:"pig_nose",description:"PIG NOSE",category:"animal"
},{name:"feet",unicode:"1F43E",shortcode:"feet",description:"PAW PRINTS",category:"people"},{name:"eyes",unicode:"1F440",shortcode:"eyes",description:"EYES",category:"people"},{name:"ear",unicode:"1F442",shortcode:"ear",description:"EAR",category:"people"},{name:"nose",unicode:"1F443",shortcode:"nose",description:"NOSE",category:"people"},{name:"lips",unicode:"1F444",shortcode:"lips",description:"MOUTH",category:"people"},{name:"tongue",unicode:"1F445",shortcode:"tongue",description:"TONGUE",category:"people"},{name:"point_up_2",unicode:"1F446",shortcode:"point_up_2",description:"WHITE UP POINTING BACKHAND INDEX",category:"people"},{name:"point_down",unicode:"1F447",shortcode:"point_down",description:"WHITE DOWN POINTING BACKHAND INDEX",category:"people"},{name:"point_left",unicode:"1F448",shortcode:"point_left",description:"WHITE LEFT POINTING BACKHAND INDEX",category:"people"},{name:"point_right",unicode:"1F449",shortcode:"point_right",description:"WHITE RIGHT POINTING BACKHAND INDEX",category:"people"},{name:"facepunch",unicode:"1F44A",shortcode:"facepunch",description:"FISTED HAND SIGN",category:"people"},{name:"wave",unicode:"1F44B",shortcode:"wave",description:"WAVING HAND SIGN",category:"people"},{name:"ok_hand",unicode:"1F44C",shortcode:"ok_hand",description:"OK HAND SIGN",category:"people"},{name:"+1",unicode:"1F44D",shortcode:"plus1",description:"THUMBS UP SIGN",category:"people"},{name:"-1",unicode:"1F44E",shortcode:"-1",description:"THUMBS DOWN SIGN",category:"people"},{name:"clap",unicode:"1F44F",shortcode:"clap",description:"CLAPPING HANDS SIGN",category:"people"},{name:"open_hands",unicode:"1F450",shortcode:"open_hands",description:"OPEN HANDS SIGN",category:"people"},{name:"crown",unicode:"1F451",shortcode:"crown",description:"CROWN",category:"people"},{name:"womans_hat",unicode:"1F452",shortcode:"womans_hat",description:"WOMANS HAT",category:"people"},{name:"eyeglasses",unicode:"1F453",shortcode:"eyeglasses",description:"EYEGLASSES",category:"people"},{name:"necktie",unicode:"1F454",shortcode:"necktie",description:"NECKTIE",category:"people"},{name:"shirt",unicode:"1F455",shortcode:"shirt",description:"T-SHIRT",category:"people"},{name:"jeans",unicode:"1F456",shortcode:"jeans",description:"JEANS",category:"people"},{name:"dress",unicode:"1F457",shortcode:"dress",description:"DRESS",category:"people"},{name:"kimono",unicode:"1F458",shortcode:"kimono",description:"KIMONO",category:"people"},{name:"bikini",unicode:"1F459",shortcode:"bikini",description:"BIKINI",category:"people"},{name:"womans_clothes",unicode:"1F45A",shortcode:"womans_clothes",description:"WOMANS CLOTHES",category:"people"},{name:"purse",unicode:"1F45B",shortcode:"purse",description:"PURSE",category:"people"},{name:"handbag",unicode:"1F45C",shortcode:"handbag",description:"HANDBAG",category:"people"},{name:"pouch",unicode:"1F45D",shortcode:"pouch",description:"POUCH",category:"people"},{name:"mans_shoe",unicode:"1F45E",shortcode:"mans_shoe",description:"MANS SHOE",category:"people"},{name:"athletic_shoe",unicode:"1F45F",shortcode:"athletic_shoe",description:"ATHLETIC SHOE",category:"people"},{name:"high_heel",unicode:"1F460",shortcode:"high_heel",description:"HIGH-HEELED SHOE",category:"people"},{name:"sandal",unicode:"1F461",shortcode:"sandal",description:"WOMANS SANDAL",category:"people"},{name:"boot",unicode:"1F462",shortcode:"boot",description:"WOMANS BOOTS",category:"people"},{name:"footprints",unicode:"1F463",shortcode:"footprints",description:"FOOTPRINTS",category:"people"},{name:"bust_in_silhouette",unicode:"1F464",shortcode:"bust_in_silhouette",description:"BUST IN SILHOUETTE",category:"people"},{name:"busts_in_silhouette",unicode:"1F465",shortcode:"busts_in_silhouette",description:"BUSTS IN SILHOUETTE",category:"people"},{name:"boy",unicode:"1F466",shortcode:"boy",description:"BOY",category:"people"},{name:"girl",unicode:"1F467",shortcode:"girl",description:"GIRL",category:"people"},{name:"man",unicode:"1F468",shortcode:"man",description:"MAN",category:"people"},{name:"woman",unicode:"1F469",shortcode:"woman",description:"WOMAN",category:"people"},{name:"family",unicode:"1F46A",shortcode:"family",description:"FAMILY",category:"people"},{name:"couple",unicode:"1F46B",shortcode:"couple",description:"MAN AND WOMAN HOLDING HANDS",category:"people"},{name:"two_men_holding_hands",unicode:"1F46C",shortcode:"two_men_holding_hands",description:"TWO MEN HOLDING HANDS",category:"people"},{name:"two_women_holding_hands",unicode:"1F46D",shortcode:"two_women_holding_hands",description:"TWO WOMEN HOLDING HANDS",category:"people"},{name:"cop",unicode:"1F46E",shortcode:"cop",description:"POLICE OFFICER",category:"people"},{name:"dancers",unicode:"1F46F",shortcode:"dancers",description:"WOMAN WITH BUNNY EARS",category:"people"},{name:"bride_with_veil",unicode:"1F470",shortcode:"bride_with_veil",description:"BRIDE WITH VEIL",category:"people"},{name:"person_with_blond_hair",unicode:"1F471",shortcode:"person_with_blond_hair",description:"PERSON WITH BLOND HAIR",category:"people"},{name:"man_with_gua_pi_mao",unicode:"1F472",shortcode:"man_with_gua_pi_mao",description:"MAN WITH GUA PI MAO",category:"people"},{name:"man_with_turban",unicode:"1F473",shortcode:"man_with_turban",description:"MAN WITH TURBAN",category:"people"},{name:"older_man",unicode:"1F474",shortcode:"older_man",description:"OLDER MAN",category:"people"},{name:"older_woman",unicode:"1F475",shortcode:"older_woman",description:"OLDER WOMAN",category:"people"},{name:"baby",unicode:"1F476",shortcode:"baby",description:"BABY",category:"people"},{name:"construction_worker",unicode:"1F477",shortcode:"construction_worker",description:"CONSTRUCTION WORKER",category:"people"},{name:"princess",unicode:"1F478",shortcode:"princess",description:"PRINCESS",category:"people"},{name:"japanese_ogre",unicode:"1F479",shortcode:"japanese_ogre",description:"JAPANESE OGRE",category:"people"},{name:"japanese_goblin",unicode:"1F47A",shortcode:"japanese_goblin",description:"JAPANESE GOBLIN",category:"people"},{name:"ghost",unicode:"1F47B",shortcode:"ghost",description:"GHOST",category:"people"},{name:"angel",unicode:"1F47C",shortcode:"angel",description:"BABY ANGEL",category:"people"},{name:"alien",unicode:"1F47D",shortcode:"alien",description:"EXTRATERRESTRIAL ALIEN",category:"people"},{name:"space_invader",unicode:"1F47E",shortcode:"space_invader",description:"ALIEN MONSTER",category:"people"},{name:"imp",unicode:"1F47F",shortcode:"imp",description:"IMP",category:"people"},{name:"skull",unicode:"1F480",shortcode:"skull",description:"SKULL",category:"people"},{name:"information_desk_person",unicode:"1F481",shortcode:"information_desk_person",description:"INFORMATION DESK PERSON",category:"people"},{name:"guardsman",unicode:"1F482",shortcode:"guardsman",description:"GUARDSMAN",category:"people"},{name:"dancer",unicode:"1F483",shortcode:"dancer",description:"DANCER",category:"people"},{name:"lipstick",unicode:"1F484",shortcode:"lipstick",description:"LIPSTICK",category:"people"},{name:"nail_care",unicode:"1F485",shortcode:"nail_care",description:"NAIL POLISH",category:"people"},{name:"massage",unicode:"1F486",shortcode:"massage",description:"FACE MASSAGE",category:"people"},{name:"haircut",unicode:"1F487",shortcode:"haircut",description:"HAIRCUT",category:"people"},{name:"barber",unicode:"1F488",shortcode:"barber",description:"BARBER POLE",category:"people"},{name:"syringe",unicode:"1F489",shortcode:"syringe",description:"SYRINGE",category:"emotion"},{name:"pill",unicode:"1F48A",shortcode:"pill",description:"PILL",category:"emotion"},{name:"kiss",unicode:"1F48B",shortcode:"kiss",description:"KISS MARK",category:"emotion"},{name:"love_letter",unicode:"1F48C",shortcode:"love_letter",description:"LOVE LETTER",category:"emotion"},{name:"ring",unicode:"1F48D",shortcode:"ring",description:"RING",category:"emotion"},{name:"gem",unicode:"1F48E",shortcode:"gem",description:"GEM STONE",category:"emotion"},{name:"couplekiss",unicode:"1F48F",shortcode:"couplekiss",description:"KISS",category:"emotion"},{name:"bouquet",unicode:"1F490",shortcode:"bouquet",description:"BOUQUET",category:"emotion"},{name:"couple_with_heart",unicode:"1F491",shortcode:"couple_with_heart",description:"COUPLE WITH HEART",category:"emotion"},{name:"wedding",unicode:"1F492",shortcode:"wedding",description:"WEDDING",category:"emotion"},{name:"heartbeat",unicode:"1F493",shortcode:"heartbeat",description:"BEATING HEART",category:"emotion"},{name:"broken_heart",unicode:"1F494",shortcode:"broken_heart",description:"BROKEN HEART",category:"emotion"},{name:"two_hearts",unicode:"1F495",shortcode:"two_hearts",description:"TWO HEARTS",category:"emotion"},{name:"sparkling_heart",unicode:"1F496",shortcode:"sparkling_heart",description:"SPARKLING HEART",category:"emotion"},{name:"heartpulse",unicode:"1F497",shortcode:"heartpulse",description:"GROWING HEART",category:"emotion"},{name:"cupid",unicode:"1F498",shortcode:"cupid",description:"HEART WITH ARROW",category:"emotion"},{name:"blue_heart",unicode:"1F499",shortcode:"blue_heart",description:"BLUE HEART",category:"emotion"},{name:"green_heart",unicode:"1F49A",shortcode:"green_heart",description:"GREEN HEART",category:"emotion"},{name:"yellow_heart",unicode:"1F49B",shortcode:"yellow_heart",description:"YELLOW HEART",category:"emotion"},{name:"purple_heart",unicode:"1F49C",shortcode:"purple_heart",description:"PURPLE HEART",category:"emotion"},{name:"gift_heart",unicode:"1F49D",shortcode:"gift_heart",description:"HEART WITH RIBBON",category:"emotion"},{name:"revolving_hearts",unicode:"1F49E",shortcode:"revolving_hearts",description:"REVOLVING HEARTS",category:"emotion"},{name:"heart_decoration",unicode:"1F49F",shortcode:"heart_decoration",description:"HEART DECORATION",category:"emotion"},{name:"diamond_shape_with_a_dot_inside",unicode:"1F4A0",shortcode:"diamond_shape_with_a_dot_inside",description:"DIAMOND SHAPE WITH A DOT INSIDE",category:"emotion"},{name:"bulb",unicode:"1F4A1",shortcode:"bulb",description:"ELECTRIC LIGHT BULB",category:"emotion"},{name:"anger",unicode:"1F4A2",shortcode:"anger",description:"ANGER SYMBOL",category:"emotion"},{name:"bomb",unicode:"1F4A3",shortcode:"bomb",description:"BOMB",category:"emotion"},{name:"zzz",unicode:"1F4A4",shortcode:"zzz",description:"SLEEPING SYMBOL",category:"emotion"},{name:"boom",unicode:"1F4A5",shortcode:"boom",description:"COLLISION SYMBOL",category:"emotion"},{name:"sweat_drops",unicode:"1F4A6",shortcode:"sweat_drops",description:"SPLASHING SWEAT SYMBOL",category:"emotion"},{name:"droplet",unicode:"1F4A7",shortcode:"droplet",description:"DROPLET",category:"emotion"},{name:"dash",unicode:"1F4A8",shortcode:"dash",description:"DASH SYMBOL",category:"emotion"},{name:"hankey",unicode:"1F4A9",shortcode:"hankey",description:"PILE OF POO",category:"emotion"},{name:"muscle",unicode:"1F4AA",shortcode:"muscle",description:"FLEXED BICEPS",category:"emotion"},{name:"dizzy",unicode:"1F4AB",shortcode:"dizzy",description:"DIZZY SYMBOL",category:"emotion"},{name:"speech_balloon",unicode:"1F4AC",shortcode:"speech_balloon",description:"SPEECH BALLOON",category:"emotion"},{name:"thought_balloon",unicode:"1F4AD",shortcode:"thought_balloon",description:"THOUGHT BALLOON",category:"emotion"},{name:"white_flower",unicode:"1F4AE",shortcode:"white_flower",description:"WHITE FLOWER",category:"emotion"},{name:"100",unicode:"1F4AF",shortcode:"100",description:"HUNDRED POINTS SYMBOL",category:"emotion"},{name:"moneybag",unicode:"1F4B0",shortcode:"moneybag",description:"MONEY BAG",category:"emotion"},{name:"currency_exchange",unicode:"1F4B1",shortcode:"currency_exchange",description:"CURRENCY EXCHANGE",category:"emotion"},{name:"heavy_dollar_sign",unicode:"1F4B2",shortcode:"heavy_dollar_sign",description:"HEAVY DOLLAR SIGN",category:"emotion"},{name:"credit_card",unicode:"1F4B3",shortcode:"credit_card",description:"CREDIT CARD",category:"emotion"},{name:"yen",unicode:"1F4B4",shortcode:"yen",description:"BANKNOTE WITH YEN SIGN",category:"emotion"},{name:"dollar",unicode:"1F4B5",shortcode:"dollar",description:"BANKNOTE WITH DOLLAR SIGN",category:"emotion"},{name:"euro",unicode:"1F4B6",shortcode:"euro",description:"BANKNOTE WITH EURO SIGN",category:"emotion"},{name:"pound",unicode:"1F4B7",shortcode:"pound",description:"BANKNOTE WITH POUND SIGN",category:"emotion"},{name:"money_with_wings",unicode:"1F4B8",shortcode:"money_with_wings",description:"MONEY WITH WINGS",category:"emotion"},{name:"chart",unicode:"1F4B9",shortcode:"chart",description:"CHART WITH UPWARDS TREND AND YEN SIGN",category:"thing"},{name:"seat",unicode:"1F4BA",shortcode:"seat",description:"SEAT",category:"thing"},{name:"computer",unicode:"1F4BB",shortcode:"computer",description:"PERSONAL COMPUTER",category:"thing"},{name:"briefcase",unicode:"1F4BC",shortcode:"briefcase",description:"BRIEFCASE",category:"thing"},{name:"minidisc",unicode:"1F4BD",shortcode:"minidisc",description:"MINIDISC",category:"thing"},{name:"floppy_disk",unicode:"1F4BE",shortcode:"floppy_disk",description:"FLOPPY DISK",category:"thing"},{name:"cd",unicode:"1F4BF",shortcode:"cd",description:"OPTICAL DISC",category:"thing"},{name:"dvd",unicode:"1F4C0",shortcode:"dvd",description:"DVD",category:"thing"},{name:"file_folder",unicode:"1F4C1",shortcode:"file_folder",description:"FILE FOLDER",category:"thing"},{name:"open_file_folder",unicode:"1F4C2",shortcode:"open_file_folder",description:"OPEN FILE FOLDER",category:"thing"},{name:"page_with_curl",unicode:"1F4C3",shortcode:"page_with_curl",description:"PAGE WITH CURL",category:"thing"},{name:"page_facing_up",unicode:"1F4C4",shortcode:"page_facing_up",description:"PAGE FACING UP",category:"thing"},{name:"date",unicode:"1F4C5",shortcode:"date",description:"CALENDAR",category:"thing"},{name:"calendar",unicode:"1F4C6",shortcode:"calendar",description:"TEAR-OFF CALENDAR",category:"thing"},{name:"card_index",unicode:"1F4C7",shortcode:"card_index",description:"CARD INDEX",category:"thing"},{name:"chart_with_upwards_trend",unicode:"1F4C8",shortcode:"chart_with_upwards_trend",description:"CHART WITH UPWARDS TREND",category:"thing"},{name:"chart_with_downwards_trend",unicode:"1F4C9",shortcode:"chart_with_downwards_trend",description:"CHART WITH DOWNWARDS TREND",category:"thing"},{name:"bar_chart",unicode:"1F4CA",shortcode:"bar_chart",description:"BAR CHART",category:"thing"},{name:"clipboard",unicode:"1F4CB",shortcode:"clipboard",description:"CLIPBOARD",category:"thing"},{name:"pushpin",unicode:"1F4CC",shortcode:"pushpin",description:"PUSHPIN",category:"thing"},{name:"round_pushpin",unicode:"1F4CD",shortcode:"round_pushpin",description:"ROUND PUSHPIN",category:"thing"},{name:"paperclip",unicode:"1F4CE",shortcode:"paperclip",description:"PAPERCLIP",category:"thing"},{name:"straight_ruler",unicode:"1F4CF",shortcode:"straight_ruler",description:"STRAIGHT RULER",category:"thing"},{name:"triangular_ruler",unicode:"1F4D0",shortcode:"triangular_ruler",description:"TRIANGULAR RULER",category:"thing"},{name:"bookmark_tabs",unicode:"1F4D1",shortcode:"bookmark_tabs",description:"BOOKMARK TABS",category:"thing"},{name:"ledger",unicode:"1F4D2",shortcode:"ledger",description:"LEDGER",category:"thing"},{name:"notebook",unicode:"1F4D3",shortcode:"notebook",description:"NOTEBOOK",category:"thing"},{name:"notebook_with_decorative_cover",unicode:"1F4D4",shortcode:"notebook_with_decorative_cover",description:"NOTEBOOK WITH DECORATIVE COVER",category:"thing"},{name:"closed_book",unicode:"1F4D5",shortcode:"closed_book",description:"CLOSED BOOK",category:"thing"},{name:"book",unicode:"1F4D6",shortcode:"book",description:"OPEN BOOK",category:"thing"},{name:"green_book",unicode:"1F4D7",shortcode:"green_book",description:"GREEN BOOK",category:"thing"},{name:"blue_book",unicode:"1F4D8",shortcode:"blue_book",description:"BLUE BOOK",category:"thing"},{name:"orange_book",unicode:"1F4D9",shortcode:"orange_book",description:"ORANGE BOOK",category:"thing"},{name:"books",unicode:"1F4DA",shortcode:"books",description:"BOOKS",category:"thing"},{name:"name_badge",unicode:"1F4DB",shortcode:"name_badge",description:"NAME BADGE",category:"thing"},{name:"scroll",unicode:"1F4DC",shortcode:"scroll",description:"SCROLL",category:"thing"},{name:"memo",unicode:"1F4DD",shortcode:"memo",description:"MEMO",category:"thing"},{name:"telephone_receiver",unicode:"1F4DE",shortcode:"telephone_receiver",description:"TELEPHONE RECEIVER",category:"thing"},{name:"pager",unicode:"1F4DF",shortcode:"pager",description:"PAGER",category:"thing"},{name:"fax",unicode:"1F4E0",shortcode:"fax",description:"FAX MACHINE",category:"thing"},{name:"satellite",unicode:"1F4E1",shortcode:"satellite",description:"SATELLITE ANTENNA",category:"thing"},{name:"loudspeaker",unicode:"1F4E2",shortcode:"loudspeaker",description:"PUBLIC ADDRESS LOUDSPEAKER",category:"thing"},{name:"mega",unicode:"1F4E3",shortcode:"mega",description:"CHEERING MEGAPHONE",category:"thing"},{name:"outbox_tray",unicode:"1F4E4",shortcode:"outbox_tray",description:"OUTBOX TRAY",category:"thing"},{name:"inbox_tray",unicode:"1F4E5",shortcode:"inbox_tray",description:"INBOX TRAY",category:"thing"},{name:"package",unicode:"1F4E6",shortcode:"package",description:"PACKAGE",category:"thing"},{name:"e-mail",unicode:"1F4E7",shortcode:"e-mail",description:"E-MAIL SYMBOL",category:"thing"},{name:"incoming_envelope",unicode:"1F4E8",shortcode:"incoming_envelope",description:"INCOMING ENVELOPE",category:"thing"},{name:"envelope_with_arrow",unicode:"1F4E9",shortcode:"envelope_with_arrow",description:"ENVELOPE WITH DOWNWARDS ARROW ABOVE",category:"thing"},{name:"mailbox_closed",unicode:"1F4EA",shortcode:"mailbox_closed",description:"CLOSED MAILBOX WITH LOWERED FLAG",category:"thing"},{name:"mailbox",unicode:"1F4EB",shortcode:"mailbox",description:"CLOSED MAILBOX WITH RAISED FLAG",category:"thing"},{name:"mailbox_with_mail",unicode:"1F4EC",shortcode:"mailbox_with_mail",description:"OPEN MAILBOX WITH RAISED FLAG",category:"thing"},{name:"mailbox_with_no_mail",unicode:"1F4ED",shortcode:"mailbox_with_no_mail",description:"OPEN MAILBOX WITH LOWERED FLAG",category:"thing"},{name:"postbox",unicode:"1F4EE",shortcode:"postbox",description:"POSTBOX",category:"thing"},{name:"postal_horn",unicode:"1F4EF",shortcode:"postal_horn",description:"POSTAL HORN",category:"thing"},{name:"newspaper",unicode:"1F4F0",shortcode:"newspaper",description:"NEWSPAPER",category:"thing"},{name:"iphone",unicode:"1F4F1",shortcode:"iphone",description:"MOBILE PHONE",category:"thing"},{name:"calling",unicode:"1F4F2",shortcode:"calling",description:"MOBILE PHONE WITH RIGHTWARDS ARROW AT LEFT",category:"thing"},{name:"vibration_mode",unicode:"1F4F3",shortcode:"vibration_mode",description:"VIBRATION MODE",category:"thing"},{name:"mobile_phone_off",unicode:"1F4F4",shortcode:"mobile_phone_off",description:"MOBILE PHONE OFF",category:"thing"},{name:"no_mobile_phones",unicode:"1F4F5",shortcode:"no_mobile_phones",description:"NO MOBILE PHONES",category:"thing"},{name:"signal_strength",unicode:"1F4F6",shortcode:"signal_strength",description:"ANTENNA WITH BARS",category:"thing"},{name:"camera",unicode:"1F4F7",shortcode:"camera",description:"CAMERA",category:"thing"},{name:"video_camera",unicode:"1F4F9",shortcode:"video_camera",description:"VIDEO CAMERA",category:"thing"},{name:"tv",unicode:"1F4FA",shortcode:"tv",description:"TELEVISION",category:"thing"},{name:"radio",unicode:"1F4FB",shortcode:"radio",description:"RADIO",category:"thing"},{name:"vhs",unicode:"1F4FC",shortcode:"vhs",description:"VIDEOCASSETTE",category:"thing"},{name:"twisted_rightwards_arrows",unicode:"1F500",shortcode:"twisted_rightwards_arrows",description:"TWISTED RIGHTWARDS ARROWS",category:"thing"},{name:"repeat",unicode:"1F501",shortcode:"repeat",description:"CLOCKWISE RIGHTWARDS AND LEFTWARDS OPEN CIRCLE ARROWS",category:"thing"},{name:"repeat_one",unicode:"1F502",shortcode:"repeat_one",description:"CLOCKWISE RIGHTWARDS AND LEFTWARDS OPEN CIRCLE ARROWS WITH CIRCLED ONE OVERLAY",category:"thing"},{name:"arrows_clockwise",unicode:"1F503",shortcode:"arrows_clockwise",description:"CLOCKWISE DOWNWARDS AND UPWARDS OPEN CIRCLE ARROWS",category:"thing"},{name:"arrows_counterclockwise",unicode:"1F504",shortcode:"arrows_counterclockwise",description:"ANTICLOCKWISE DOWNWARDS AND UPWARDS OPEN CIRCLE ARROWS",category:"thing"},{name:"low_brightness",unicode:"1F505",shortcode:"low_brightness",description:"LOW BRIGHTNESS SYMBOL",category:"thing"},{name:"high_brightness",unicode:"1F506",shortcode:"high_brightness",description:"HIGH BRIGHTNESS SYMBOL",category:"thing"},{name:"mute",unicode:"1F507",shortcode:"mute",description:"SPEAKER WITH CANCELLATION STROKE",category:"thing"},{name:"speaker",unicode:"1F508",shortcode:"speaker",description:"SPEAKER",category:"thing"},{name:"sound",unicode:"1F509",shortcode:"sound",description:"SPEAKER WITH ONE SOUND WAVE",category:"thing"},{name:"loud_sound",unicode:"1F50A",shortcode:"loud_sound",description:"SPEAKER WITH THREE SOUND WAVES",category:"thing"},{name:"battery",unicode:"1F50B",shortcode:"battery",description:"BATTERY",category:"thing"},{name:"electric_plug",unicode:"1F50C",shortcode:"electric_plug",description:"ELECTRIC PLUG",category:"thing"},{name:"mag",unicode:"1F50D",shortcode:"mag",description:"LEFT-POINTING MAGNIFYING GLASS",category:"thing"},{name:"mag_right",unicode:"1F50E",shortcode:"mag_right",description:"RIGHT-POINTING MAGNIFYING GLASS",category:"thing"},{name:"lock_with_ink_pen",unicode:"1F50F",shortcode:"lock_with_ink_pen",description:"LOCK WITH INK PEN",category:"thing"},{name:"closed_lock_with_key",unicode:"1F510",shortcode:"closed_lock_with_key",description:"CLOSED LOCK WITH KEY",category:"thing"},{name:"key",unicode:"1F511",shortcode:"key",description:"KEY",category:"thing"},{name:"lock",unicode:"1F512",shortcode:"lock",description:"LOCK",category:"thing"},{name:"unlock",unicode:"1F513",shortcode:"unlock",description:"OPEN LOCK",category:"thing"},{name:"bell",unicode:"1F514",shortcode:"bell",description:"BELL",category:"thing"},{name:"no_bell",unicode:"1F515",shortcode:"no_bell",description:"BELL WITH CANCELLATION STROKE",category:"thing"},{name:"bookmark",unicode:"1F516",shortcode:"bookmark",description:"BOOKMARK",category:"folderol"},{name:"link",unicode:"1F517",shortcode:"link",description:"LINK SYMBOL",category:"folderol"},{name:"radio_button",unicode:"1F518",shortcode:"radio_button",description:"RADIO BUTTON",category:"folderol"},{name:"back",unicode:"1F519",shortcode:"back",description:"BACK WITH LEFTWARDS ARROW ABOVE",category:"folderol"},{name:"end",unicode:"1F51A",shortcode:"end",description:"END WITH LEFTWARDS ARROW ABOVE",category:"folderol"},{name:"on",unicode:"1F51B",shortcode:"on",description:"ON WITH EXCLAMATION MARK WITH LEFT RIGHT ARROW ABOVE",category:"folderol"},{name:"soon",unicode:"1F51C",shortcode:"soon",description:"SOON WITH RIGHTWARDS ARROW ABOVE",category:"folderol"},{name:"top",unicode:"1F51D",shortcode:"top",description:"TOP WITH UPWARDS ARROW ABOVE",category:"folderol"},{name:"underage",unicode:"1F51E",shortcode:"underage",description:"NO ONE UNDER EIGHTEEN SYMBOL",category:"folderol"},{name:"keycap_ten",unicode:"1F51F",shortcode:"keycap_ten",description:"KEYCAP TEN",category:"folderol"},{name:"capital_abcd",unicode:"1F520",shortcode:"capital_abcd",description:"INPUT SYMBOL FOR LATIN CAPITAL LETTERS",category:"folderol"},{name:"abcd",unicode:"1F521",shortcode:"abcd",description:"INPUT SYMBOL FOR LATIN SMALL LETTERS",category:"folderol"},{name:"1234",unicode:"1F522",shortcode:"1234",description:"INPUT SYMBOL FOR NUMBERS",category:"folderol"},{name:"symbols",unicode:"1F523",shortcode:"symbols",description:"INPUT SYMBOL FOR SYMBOLS",category:"folderol"},{name:"abc",unicode:"1F524",shortcode:"abc",description:"INPUT SYMBOL FOR LATIN LETTERS",category:"folderol"},{name:"fire",unicode:"1F525",shortcode:"fire",description:"FIRE",category:"thing"},{name:"flashlight",unicode:"1F526",shortcode:"flashlight",description:"ELECTRIC TORCH",category:"thing"},{name:"wrench",unicode:"1F527",shortcode:"wrench",description:"WRENCH",category:"thing"},{name:"hammer",unicode:"1F528",shortcode:"hammer",description:"HAMMER",category:"thing"},{name:"nut_and_bolt",unicode:"1F529",shortcode:"nut_and_bolt",description:"NUT AND BOLT",category:"thing"},{name:"hocho",unicode:"1F52A",shortcode:"hocho",description:"HOCHO",category:"thing"},{name:"gun",unicode:"1F52B",shortcode:"gun",description:"PISTOL",category:"thing"},{name:"microscope",unicode:"1F52C",shortcode:"microscope",description:"MICROSCOPE",category:"thing"},{name:"telescope",unicode:"1F52D",shortcode:"telescope",description:"TELESCOPE",category:"thing"},{name:"crystal_ball",unicode:"1F52E",shortcode:"crystal_ball",description:"CRYSTAL BALL",category:"thing"},{name:"six_pointed_star",unicode:"1F52F",shortcode:"six_pointed_star",description:"SIX POINTED STAR WITH MIDDLE DOT",category:"thing"},{name:"beginner",unicode:"1F530",shortcode:"beginner",description:"JAPANESE SYMBOL FOR BEGINNER",category:"thing"},{name:"trident",unicode:"1F531",shortcode:"trident",description:"TRIDENT EMBLEM",category:"thing"},{name:"black_square_button",unicode:"1F532",shortcode:"black_square_button",description:"BLACK SQUARE BUTTON",category:"folderol"},{name:"white_square_button",unicode:"1F533",shortcode:"white_square_button",description:"WHITE SQUARE BUTTON",category:"folderol"},{name:"red_circle",unicode:"1F534",shortcode:"red_circle",description:"LARGE RED CIRCLE",category:"folderol"},{name:"large_blue_circle",unicode:"1F535",shortcode:"large_blue_circle",description:"LARGE BLUE CIRCLE",category:"folderol"},{name:"large_orange_diamond",unicode:"1F536",shortcode:"large_orange_diamond",description:"LARGE ORANGE DIAMOND",category:"folderol"},{name:"large_blue_diamond",unicode:"1F537",shortcode:"large_blue_diamond",description:"LARGE BLUE DIAMOND",category:"folderol"},{name:"small_orange_diamond",unicode:"1F538",shortcode:"small_orange_diamond",description:"SMALL ORANGE DIAMOND",category:"folderol"},{name:"small_blue_diamond",unicode:"1F539",shortcode:"small_blue_diamond",description:"SMALL BLUE DIAMOND",category:"folderol"},{name:"small_red_triangle",unicode:"1F53A",shortcode:"small_red_triangle",description:"UP-POINTING RED TRIANGLE",category:"folderol"},{name:"small_red_triangle_down",unicode:"1F53B",shortcode:"small_red_triangle_down",description:"DOWN-POINTING RED TRIANGLE",category:"folderol"},{name:"arrow_up_small",unicode:"1F53C",shortcode:"arrow_up_small",description:"UP-POINTING SMALL RED TRIANGLE",category:"folderol"},{name:"arrow_down_small",unicode:"1F53D",shortcode:"arrow_down_small",description:"DOWN-POINTING SMALL RED TRIANGLE",category:"folderol"},{name:"clock1",unicode:"1F550",shortcode:"clock1",description:"CLOCK FACE ONE OCLOCK",category:"folderol"},{name:"clock2",unicode:"1F551",shortcode:"clock2",description:"CLOCK FACE TWO OCLOCK",category:"folderol"},{name:"clock3",unicode:"1F552",shortcode:"clock3",description:"CLOCK FACE THREE OCLOCK",category:"folderol"},{name:"clock4",unicode:"1F553",shortcode:"clock4",description:"CLOCK FACE FOUR OCLOCK",category:"folderol"},{name:"clock5",unicode:"1F554",shortcode:"clock5",description:"CLOCK FACE FIVE OCLOCK",category:"folderol"},{name:"clock6",unicode:"1F555",shortcode:"clock6",description:"CLOCK FACE SIX OCLOCK",category:"folderol"},{name:"clock7",unicode:"1F556",shortcode:"clock7",description:"CLOCK FACE SEVEN OCLOCK",category:"folderol"},{name:"clock8",unicode:"1F557",shortcode:"clock8",description:"CLOCK FACE EIGHT OCLOCK",category:"folderol"},{name:"clock9",unicode:"1F558",shortcode:"clock9",description:"CLOCK FACE NINE OCLOCK",category:"folderol"},{name:"clock10",unicode:"1F559",shortcode:"clock10",description:"CLOCK FACE TEN OCLOCK",category:"folderol"},{name:"clock11",unicode:"1F55A",shortcode:"clock11",description:"CLOCK FACE ELEVEN OCLOCK",category:"folderol"},{name:"clock12",unicode:"1F55B",shortcode:"clock12",description:"CLOCK FACE TWELVE OCLOCK",category:"folderol"},{name:"clock130",unicode:"1F55C",shortcode:"clock130",description:"CLOCK FACE ONE-THIRTY",category:"folderol"},{name:"clock230",unicode:"1F55D",shortcode:"clock230",description:"CLOCK FACE TWO-THIRTY",category:"folderol"},{name:"clock330",unicode:"1F55E",shortcode:"clock330",description:"CLOCK FACE THREE-THIRTY",category:"folderol"},{name:"clock430",unicode:"1F55F",shortcode:"clock430",description:"CLOCK FACE FOUR-THIRTY",category:"folderol"},{name:"clock530",unicode:"1F560",shortcode:"clock530",description:"CLOCK FACE FIVE-THIRTY",category:"folderol"},{name:"clock630",unicode:"1F561",shortcode:"clock630",description:"CLOCK FACE SIX-THIRTY",category:"folderol"},{name:"clock730",unicode:"1F562",shortcode:"clock730",description:"CLOCK FACE SEVEN-THIRTY",category:"folderol"},{name:"clock830",unicode:"1F563",shortcode:"clock830",description:"CLOCK FACE EIGHT-THIRTY",category:"folderol"},{name:"clock930",unicode:"1F564",shortcode:"clock930",description:"CLOCK FACE NINE-THIRTY",category:"folderol"},{name:"clock1030",unicode:"1F565",shortcode:"clock1030",description:"CLOCK FACE TEN-THIRTY",category:"folderol"},{name:"clock1130",unicode:"1F566",shortcode:"clock1130",description:"CLOCK FACE ELEVEN-THIRTY",category:"folderol"},{name:"clock1230",unicode:"1F567",shortcode:"clock1230",description:"CLOCK FACE TWELVE-THIRTY",category:"folderol"},{name:"mount_fuji",unicode:"1F5FB",shortcode:"mount_fuji",description:"MOUNT FUJI",category:"travel"},{name:"tokyo_tower",unicode:"1F5FC",shortcode:"tokyo_tower",description:"TOKYO TOWER",category:"travel"},{name:"statue_of_liberty",unicode:"1F5FD",shortcode:"statue_of_liberty",description:"STATUE OF LIBERTY",category:"travel"},{name:"japan",unicode:"1F5FE",shortcode:"japan",description:"SILHOUETTE OF JAPAN",category:"travel"},{name:"moyai",unicode:"1F5FF",shortcode:"moyai",description:"MOYAI",category:"travel"},{name:"grinning",unicode:"1F600",shortcode:"grinning",description:"GRINNING FACE",category:"people"},{name:"grin",unicode:"1F601",shortcode:"grin",description:"GRINNING FACE WITH SMILING EYES",category:"people"},{name:"joy",unicode:"1F602",shortcode:"joy",description:"FACE WITH TEARS OF JOY",category:"people"},{name:"smiley",unicode:"1F603",shortcode:"smiley",description:"SMILING FACE WITH OPEN MOUTH",category:"people"},{name:"smile",unicode:"1F604",shortcode:"smile",description:"SMILING FACE WITH OPEN MOUTH AND SMILING EYES",category:"people"},{name:"sweat_smile",unicode:"1F605",shortcode:"sweat_smile",description:"SMILING FACE WITH OPEN MOUTH AND COLD SWEAT",category:"people"},{name:"laughing",unicode:"1F606",shortcode:"laughing",description:"SMILING FACE WITH OPEN MOUTH AND TIGHTLY-CLOSED EYES",category:"people"},{name:"innocent",unicode:"1F607",shortcode:"innocent",description:"SMILING FACE WITH HALO",category:"people"},{name:"smiling_imp",unicode:"1F608",shortcode:"smiling_imp",description:"SMILING FACE WITH HORNS",category:"people"},{name:"wink",unicode:"1F609",shortcode:"wink",description:"WINKING FACE",category:"people"},{name:"blush",unicode:"1F60A",shortcode:"blush",description:"SMILING FACE WITH SMILING EYES",category:"people"},{name:"yum",unicode:"1F60B",shortcode:"yum",description:"FACE SAVOURING DELICIOUS FOOD",category:"people"},{name:"relieved",unicode:"1F60C",shortcode:"relieved",description:"RELIEVED FACE",category:"people"},{name:"heart_eyes",unicode:"1F60D",shortcode:"heart_eyes",description:"SMILING FACE WITH HEART-SHAPED EYES",category:"people"},{name:"sunglasses",unicode:"1F60E",shortcode:"sunglasses",description:"SMILING FACE WITH SUNGLASSES",category:"people"},{name:"smirk",unicode:"1F60F",shortcode:"smirk",description:"SMIRKING FACE",category:"people"},{name:"neutral_face",unicode:"1F610",shortcode:"neutral_face",description:"NEUTRAL FACE",category:"people"},{name:"expressionless",unicode:"1F611",shortcode:"expressionless",description:"EXPRESSIONLESS FACE",category:"people"},{name:"unamused",unicode:"1F612",shortcode:"unamused",description:"UNAMUSED FACE",category:"people"},{name:"sweat",unicode:"1F613",
shortcode:"sweat",description:"FACE WITH COLD SWEAT",category:"people"},{name:"pensive",unicode:"1F614",shortcode:"pensive",description:"PENSIVE FACE",category:"people"},{name:"confused",unicode:"1F615",shortcode:"confused",description:"CONFUSED FACE",category:"people"},{name:"confounded",unicode:"1F616",shortcode:"confounded",description:"CONFOUNDED FACE",category:"people"},{name:"kissing",unicode:"1F617",shortcode:"kissing",description:"KISSING FACE",category:"people"},{name:"kissing_heart",unicode:"1F618",shortcode:"kissing_heart",description:"FACE THROWING A KISS",category:"people"},{name:"kissing_smiling_eyes",unicode:"1F619",shortcode:"kissing_smiling_eyes",description:"KISSING FACE WITH SMILING EYES",category:"people"},{name:"kissing_closed_eyes",unicode:"1F61A",shortcode:"kissing_closed_eyes",description:"KISSING FACE WITH CLOSED EYES",category:"people"},{name:"stuck_out_tongue",unicode:"1F61B",shortcode:"stuck_out_tongue",description:"FACE WITH STUCK-OUT TONGUE",category:"people"},{name:"stuck_out_tongue_winking_eye",unicode:"1F61C",shortcode:"stuck_out_tongue_winking_eye",description:"FACE WITH STUCK-OUT TONGUE AND WINKING EYE",category:"people"},{name:"stuck_out_tongue_closed_eyes",unicode:"1F61D",shortcode:"stuck_out_tongue_closed_eyes",description:"FACE WITH STUCK-OUT TONGUE AND TIGHTLY-CLOSED EYES",category:"people"},{name:"disappointed",unicode:"1F61E",shortcode:"disappointed",description:"DISAPPOINTED FACE",category:"people"},{name:"worried",unicode:"1F61F",shortcode:"worried",description:"WORRIED FACE",category:"people"},{name:"angry",unicode:"1F620",shortcode:"angry",description:"ANGRY FACE",category:"people"},{name:"rage",unicode:"1F621",shortcode:"rage",description:"POUTING FACE",category:"people"},{name:"cry",unicode:"1F622",shortcode:"cry",description:"CRYING FACE",category:"people"},{name:"persevere",unicode:"1F623",shortcode:"persevere",description:"PERSEVERING FACE",category:"people"},{name:"triumph",unicode:"1F624",shortcode:"triumph",description:"FACE WITH LOOK OF TRIUMPH",category:"people"},{name:"disappointed_relieved",unicode:"1F625",shortcode:"disappointed_relieved",description:"DISAPPOINTED BUT RELIEVED FACE",category:"people"},{name:"frowning",unicode:"1F626",shortcode:"frowning",description:"FROWNING FACE WITH OPEN MOUTH",category:"people"},{name:"anguished",unicode:"1F627",shortcode:"anguished",description:"ANGUISHED FACE",category:"people"},{name:"fearful",unicode:"1F628",shortcode:"fearful",description:"FEARFUL FACE",category:"people"},{name:"weary",unicode:"1F629",shortcode:"weary",description:"WEARY FACE",category:"people"},{name:"sleepy",unicode:"1F62A",shortcode:"sleepy",description:"SLEEPY FACE",category:"people"},{name:"tired_face",unicode:"1F62B",shortcode:"tired_face",description:"TIRED FACE",category:"people"},{name:"grimacing",unicode:"1F62C",shortcode:"grimacing",description:"GRIMACING FACE",category:"people"},{name:"sob",unicode:"1F62D",shortcode:"sob",description:"LOUDLY CRYING FACE",category:"people"},{name:"open_mouth",unicode:"1F62E",shortcode:"open_mouth",description:"FACE WITH OPEN MOUTH",category:"people"},{name:"hushed",unicode:"1F62F",shortcode:"hushed",description:"HUSHED FACE",category:"people"},{name:"cold_sweat",unicode:"1F630",shortcode:"cold_sweat",description:"FACE WITH OPEN MOUTH AND COLD SWEAT",category:"people"},{name:"scream",unicode:"1F631",shortcode:"scream",description:"FACE SCREAMING IN FEAR",category:"people"},{name:"astonished",unicode:"1F632",shortcode:"astonished",description:"ASTONISHED FACE",category:"people"},{name:"flushed",unicode:"1F633",shortcode:"flushed",description:"FLUSHED FACE",category:"people"},{name:"sleeping",unicode:"1F634",shortcode:"sleeping",description:"SLEEPING FACE",category:"people"},{name:"dizzy_face",unicode:"1F635",shortcode:"dizzy_face",description:"DIZZY FACE",category:"people"},{name:"no_mouth",unicode:"1F636",shortcode:"no_mouth",description:"FACE WITHOUT MOUTH",category:"people"},{name:"mask",unicode:"1F637",shortcode:"mask",description:"FACE WITH MEDICAL MASK",category:"people"},{name:"smile_cat",unicode:"1F638",shortcode:"smile_cat",description:"GRINNING CAT FACE WITH SMILING EYES",category:"people"},{name:"joy_cat",unicode:"1F639",shortcode:"joy_cat",description:"CAT FACE WITH TEARS OF JOY",category:"people"},{name:"smiley_cat",unicode:"1F63A",shortcode:"smiley_cat",description:"SMILING CAT FACE WITH OPEN MOUTH",category:"people"},{name:"heart_eyes_cat",unicode:"1F63B",shortcode:"heart_eyes_cat",description:"SMILING CAT FACE WITH HEART-SHAPED EYES",category:"people"},{name:"smirk_cat",unicode:"1F63C",shortcode:"smirk_cat",description:"CAT FACE WITH WRY SMILE",category:"people"},{name:"kissing_cat",unicode:"1F63D",shortcode:"kissing_cat",description:"KISSING CAT FACE WITH CLOSED EYES",category:"people"},{name:"pouting_cat",unicode:"1F63E",shortcode:"pouting_cat",description:"POUTING CAT FACE",category:"people"},{name:"crying_cat_face",unicode:"1F63F",shortcode:"crying_cat_face",description:"CRYING CAT FACE",category:"people"},{name:"scream_cat",unicode:"1F640",shortcode:"scream_cat",description:"WEARY CAT FACE",category:"people"},{name:"no_good",unicode:"1F645",shortcode:"no_good",description:"FACE WITH NO GOOD GESTURE",category:"people"},{name:"ok_woman",unicode:"1F646",shortcode:"ok_woman",description:"FACE WITH OK GESTURE",category:"people"},{name:"bow",unicode:"1F647",shortcode:"bow",description:"PERSON BOWING DEEPLY",category:"people"},{name:"see_no_evil",unicode:"1F648",shortcode:"see_no_evil",description:"SEE-NO-EVIL MONKEY",category:"people"},{name:"hear_no_evil",unicode:"1F649",shortcode:"hear_no_evil",description:"HEAR-NO-EVIL MONKEY",category:"people"},{name:"speak_no_evil",unicode:"1F64A",shortcode:"speak_no_evil",description:"SPEAK-NO-EVIL MONKEY",category:"people"},{name:"raising_hand",unicode:"1F64B",shortcode:"raising_hand",description:"HAPPY PERSON RAISING ONE HAND",category:"people"},{name:"raised_hands",unicode:"1F64C",shortcode:"raised_hands",description:"PERSON RAISING BOTH HANDS IN CELEBRATION",category:"people"},{name:"person_frowning",unicode:"1F64D",shortcode:"person_frowning",description:"PERSON FROWNING",category:"people"},{name:"person_with_pouting_face",unicode:"1F64E",shortcode:"person_with_pouting_face",description:"PERSON WITH POUTING FACE",category:"people"},{name:"pray",unicode:"1F64F",shortcode:"pray",description:"PERSON WITH FOLDED HANDS",category:"people"},{name:"rocket",unicode:"1F680",shortcode:"rocket",description:"ROCKET",category:"travel"},{name:"helicopter",unicode:"1F681",shortcode:"helicopter",description:"HELICOPTER",category:"travel"},{name:"steam_locomotive",unicode:"1F682",shortcode:"steam_locomotive",description:"STEAM LOCOMOTIVE",category:"travel"},{name:"railway_car",unicode:"1F683",shortcode:"railway_car",description:"RAILWAY CAR",category:"travel"},{name:"bullettrain_side",unicode:"1F684",shortcode:"bullettrain_side",description:"HIGH-SPEED TRAIN",category:"travel"},{name:"bullettrain_front",unicode:"1F685",shortcode:"bullettrain_front",description:"HIGH-SPEED TRAIN WITH BULLET NOSE",category:"travel"},{name:"train2",unicode:"1F686",shortcode:"train2",description:"TRAIN",category:"travel"},{name:"metro",unicode:"1F687",shortcode:"metro",description:"METRO",category:"travel"},{name:"light_rail",unicode:"1F688",shortcode:"light_rail",description:"LIGHT RAIL",category:"travel"},{name:"station",unicode:"1F689",shortcode:"station",description:"STATION",category:"travel"},{name:"tram",unicode:"1F68A",shortcode:"tram",description:"TRAM",category:"travel"},{name:"train",unicode:"1F68B",shortcode:"train",description:"TRAM CAR",category:"travel"},{name:"bus",unicode:"1F68C",shortcode:"bus",description:"BUS",category:"travel"},{name:"oncoming_bus",unicode:"1F68D",shortcode:"oncoming_bus",description:"ONCOMING BUS",category:"travel"},{name:"trolleybus",unicode:"1F68E",shortcode:"trolleybus",description:"TROLLEYBUS",category:"travel"},{name:"busstop",unicode:"1F68F",shortcode:"busstop",description:"BUS STOP",category:"travel"},{name:"minibus",unicode:"1F690",shortcode:"minibus",description:"MINIBUS",category:"travel"},{name:"ambulance",unicode:"1F691",shortcode:"ambulance",description:"AMBULANCE",category:"travel"},{name:"fire_engine",unicode:"1F692",shortcode:"fire_engine",description:"FIRE ENGINE",category:"travel"},{name:"police_car",unicode:"1F693",shortcode:"police_car",description:"POLICE CAR",category:"travel"},{name:"oncoming_police_car",unicode:"1F694",shortcode:"oncoming_police_car",description:"ONCOMING POLICE CAR",category:"travel"},{name:"taxi",unicode:"1F695",shortcode:"taxi",description:"TAXI",category:"travel"},{name:"oncoming_taxi",unicode:"1F696",shortcode:"oncoming_taxi",description:"ONCOMING TAXI",category:"travel"},{name:"car",unicode:"1F697",shortcode:"car",description:"AUTOMOBILE",category:"travel"},{name:"oncoming_automobile",unicode:"1F698",shortcode:"oncoming_automobile",description:"ONCOMING AUTOMOBILE",category:"travel"},{name:"blue_car",unicode:"1F699",shortcode:"blue_car",description:"RECREATIONAL VEHICLE",category:"travel"},{name:"truck",unicode:"1F69A",shortcode:"truck",description:"DELIVERY TRUCK",category:"travel"},{name:"articulated_lorry",unicode:"1F69B",shortcode:"articulated_lorry",description:"ARTICULATED LORRY",category:"travel"},{name:"tractor",unicode:"1F69C",shortcode:"tractor",description:"TRACTOR",category:"travel"},{name:"monorail",unicode:"1F69D",shortcode:"monorail",description:"MONORAIL",category:"travel"},{name:"mountain_railway",unicode:"1F69E",shortcode:"mountain_railway",description:"MOUNTAIN RAILWAY",category:"travel"},{name:"suspension_railway",unicode:"1F69F",shortcode:"suspension_railway",description:"SUSPENSION RAILWAY",category:"travel"},{name:"mountain_cableway",unicode:"1F6A0",shortcode:"mountain_cableway",description:"MOUNTAIN CABLEWAY",category:"travel"},{name:"aerial_tramway",unicode:"1F6A1",shortcode:"aerial_tramway",description:"AERIAL TRAMWAY",category:"travel"},{name:"ship",unicode:"1F6A2",shortcode:"ship",description:"SHIP",category:"travel"},{name:"rowboat",unicode:"1F6A3",shortcode:"rowboat",description:"ROWBOAT",category:"travel"},{name:"speedboat",unicode:"1F6A4",shortcode:"speedboat",description:"SPEEDBOAT",category:"travel"},{name:"traffic_light",unicode:"1F6A5",shortcode:"traffic_light",description:"HORIZONTAL TRAFFIC LIGHT",category:"travel"},{name:"vertical_traffic_light",unicode:"1F6A6",shortcode:"vertical_traffic_light",description:"VERTICAL TRAFFIC LIGHT",category:"travel"},{name:"construction",unicode:"1F6A7",shortcode:"construction",description:"CONSTRUCTION SIGN",category:"travel"},{name:"rotating_light",unicode:"1F6A8",shortcode:"rotating_light",description:"POLICE CARS REVOLVING LIGHT",category:"travel"},{name:"triangular_flag_on_post",unicode:"1F6A9",shortcode:"triangular_flag_on_post",description:"TRIANGULAR FLAG ON POST",category:"travel"},{name:"door",unicode:"1F6AA",shortcode:"door",description:"DOOR",category:"travel"},{name:"no_entry_sign",unicode:"1F6AB",shortcode:"no_entry_sign",description:"NO ENTRY SIGN",category:"travel"},{name:"smoking",unicode:"1F6AC",shortcode:"smoking",description:"SMOKING SYMBOL",category:"travel"},{name:"no_smoking",unicode:"1F6AD",shortcode:"no_smoking",description:"NO SMOKING SYMBOL",category:"travel"},{name:"put_litter_in_its_place",unicode:"1F6AE",shortcode:"put_litter_in_its_place",description:"PUT LITTER IN ITS PLACE SYMBOL",category:"travel"},{name:"do_not_litter",unicode:"1F6AF",shortcode:"do_not_litter",description:"DO NOT LITTER SYMBOL",category:"travel"},{name:"potable_water",unicode:"1F6B0",shortcode:"potable_water",description:"POTABLE WATER SYMBOL",category:"travel"},{name:"non-potable_water",unicode:"1F6B1",shortcode:"non-potable_water",description:"NON-POTABLE WATER SYMBOL",category:"travel"},{name:"bike",unicode:"1F6B2",shortcode:"bike",description:"BICYCLE",category:"travel"},{name:"no_bicycles",unicode:"1F6B3",shortcode:"no_bicycles",description:"NO BICYCLES",category:"travel"},{name:"bicyclist",unicode:"1F6B4",shortcode:"bicyclist",description:"BICYCLIST",category:"travel"},{name:"mountain_bicyclist",unicode:"1F6B5",shortcode:"mountain_bicyclist",description:"MOUNTAIN BICYCLIST",category:"travel"},{name:"walking",unicode:"1F6B6",shortcode:"walking",description:"PEDESTRIAN",category:"travel"},{name:"no_pedestrians",unicode:"1F6B7",shortcode:"no_pedestrians",description:"NO PEDESTRIANS",category:"travel"},{name:"children_crossing",unicode:"1F6B8",shortcode:"children_crossing",description:"CHILDREN CROSSING",category:"travel"},{name:"mens",unicode:"1F6B9",shortcode:"mens",description:"MENS SYMBOL",category:"travel"},{name:"womens",unicode:"1F6BA",shortcode:"womens",description:"WOMENS SYMBOL",category:"travel"},{name:"restroom",unicode:"1F6BB",shortcode:"restroom",description:"RESTROOM",category:"travel"},{name:"baby_symbol",unicode:"1F6BC",shortcode:"baby_symbol",description:"BABY SYMBOL",category:"travel"},{name:"toilet",unicode:"1F6BD",shortcode:"toilet",description:"TOILET",category:"travel"},{name:"wc",unicode:"1F6BE",shortcode:"wc",description:"WATER CLOSET",category:"travel"},{name:"shower",unicode:"1F6BF",shortcode:"shower",description:"SHOWER",category:"travel"},{name:"bath",unicode:"1F6C0",shortcode:"bath",description:"BATH",category:"travel"},{name:"bathtub",unicode:"1F6C1",shortcode:"bathtub",description:"BATHTUB",category:"travel"},{name:"passport_control",unicode:"1F6C2",shortcode:"passport_control",description:"PASSPORT CONTROL",category:"travel"},{name:"customs",unicode:"1F6C3",shortcode:"customs",description:"CUSTOMS",category:"travel"},{name:"baggage_claim",unicode:"1F6C4",shortcode:"baggage_claim",description:"BAGGAGE CLAIM",category:"travel"},{name:"left_luggage",unicode:"1F6C5",shortcode:"left_luggage",description:"LEFT LUGGAGE",category:"travel"},{name:"hash",unicode:"0023-20E3",shortcode:"hash",description:"HASH KEY",category:"folderol"},{name:"zero",unicode:"0030-20E3",shortcode:"zero",description:"KEYCAP 0",category:"folderol"},{name:"one",unicode:"0031-20E3",shortcode:"one",description:"KEYCAP 1",category:"folderol"},{name:"two",unicode:"0032-20E3",shortcode:"two",description:"KEYCAP 2",category:"folderol"},{name:"three",unicode:"0033-20E3",shortcode:"three",description:"KEYCAP 3",category:"folderol"},{name:"four",unicode:"0034-20E3",shortcode:"four",description:"KEYCAP 4",category:"folderol"},{name:"five",unicode:"0035-20E3",shortcode:"five",description:"KEYCAP 5",category:"folderol"},{name:"six",unicode:"0036-20E3",shortcode:"six",description:"KEYCAP 6",category:"folderol"},{name:"seven",unicode:"0037-20E3",shortcode:"seven",description:"KEYCAP 7",category:"folderol"},{name:"eight",unicode:"0038-20E3",shortcode:"eight",description:"KEYCAP 8",category:"folderol"},{name:"nine",unicode:"0039-20E3",shortcode:"nine",description:"KEYCAP 9",category:"folderol"},{name:"flag-cn",unicode:"1F1E8-1F1F3",shortcode:"flag-cn",description:"REGIONAL INDICATOR SYMBOL LETTERS CN",category:"folderol"},{name:"flag-de",unicode:"1F1E9-1F1EA",shortcode:"flag-de",description:"REGIONAL INDICATOR SYMBOL LETTERS DE",category:"folderol"},{name:"flag-es",unicode:"1F1EA-1F1F8",shortcode:"flag-es",description:"REGIONAL INDICATOR SYMBOL LETTERS ES",category:"folderol"},{name:"flag-fr",unicode:"1F1EB-1F1F7",shortcode:"flag-fr",description:"REGIONAL INDICATOR SYMBOL LETTERS FR",category:"folderol"},{name:"flag-gb",unicode:"1F1EC-1F1E7",shortcode:"flag-gb",description:"REGIONAL INDICATOR SYMBOL LETTERS GB",category:"folderol"},{name:"flag-it",unicode:"1F1EE-1F1F9",shortcode:"flag-it",description:"REGIONAL INDICATOR SYMBOL LETTERS IT",category:"folderol"},{name:"flag-jp",unicode:"1F1EF-1F1F5",shortcode:"flag-jp",description:"REGIONAL INDICATOR SYMBOL LETTERS JP",category:"folderol"},{name:"flag-kr",unicode:"1F1F0-1F1F7",shortcode:"flag-kr",description:"REGIONAL INDICATOR SYMBOL LETTERS KR",category:"folderol"},{name:"flag-ru",unicode:"1F1F7-1F1FA",shortcode:"flag-ru",description:"REGIONAL INDICATOR SYMBOL LETTERS RU",category:"folderol"},{name:"flag-us",unicode:"1F1FA-1F1F8",shortcode:"flag-us",description:"REGIONAL INDICATOR SYMBOL LETTERS US",category:"folderol"}]}),function($){var $special,resizeTimeout,$event=$.event;$special=$event.special.debouncedresize={setup:function(){$(this).on("resize",$special.handler)},teardown:function(){$(this).off("resize",$special.handler)},handler:function(event,execAsap){var context=this,args=arguments,dispatch=function(){event.type="debouncedresize",$event.dispatch.apply(context,args)};resizeTimeout&&clearTimeout(resizeTimeout),execAsap?dispatch():resizeTimeout=setTimeout(dispatch,$special.threshold)},threshold:150}}(jQuery);var twemoji=function(){"use strict";function createText(text){return document.createTextNode(text)}function escapeHTML(s){return s.replace(rescaper,replacer)}function defaultImageSrcGenerator(icon,options){return"".concat(options.base,options.size,"/",icon,options.ext)}function grabAllTextNodes(node,allText){for(var subnode,nodeType,childNodes=node.childNodes,length=childNodes.length;length--;)subnode=childNodes[length],nodeType=subnode.nodeType,3===nodeType?allText.push(subnode):1!==nodeType||shouldntBeParsed.test(subnode.nodeName)||grabAllTextNodes(subnode,allText);return allText}function grabTheRightIcon(icon,variant){return toCodePoint("️"===variant?icon.slice(0,-1):3===icon.length&&"️"===icon.charAt(1)?icon.charAt(0)+icon.charAt(2):icon)}function parseNode(node,options){for(var attrib,attrname,modified,fragment,subnode,text,match,i,index,img,alt,icon,variant,src,allText=grabAllTextNodes(node,[]),length=allText.length;length--;){for(modified=!1,fragment=document.createDocumentFragment(),subnode=allText[length],text=subnode.nodeValue,i=0;match=re.exec(text);){if(index=match.index,index!==i&&fragment.appendChild(createText(text.slice(i,index))),alt=match[0],icon=match[1],variant=match[2],i=index+alt.length,"︎"!==variant&&(src=options.callback(grabTheRightIcon(icon,variant),options,variant))){img=new Image,img.onerror=twemoji.onerror,img.setAttribute("draggable","false"),attrib=options.attributes(icon,variant);for(attrname in attrib)attrib.hasOwnProperty(attrname)&&0!==attrname.indexOf("on")&&!img.hasAttribute(attrname)&&img.setAttribute(attrname,attrib[attrname]);img.className=options.className,img.alt=alt,img.src=src,modified=!0,fragment.appendChild(img)}img||fragment.appendChild(createText(alt)),img=null}modified&&(i<text.length&&fragment.appendChild(createText(text.slice(i))),subnode.parentNode.replaceChild(fragment,subnode))}return node}function parseString(str,options){return replace(str,function(match,icon,variant){var attrib,attrname,src,ret=match;if("︎"!==variant&&(src=options.callback(grabTheRightIcon(icon,variant),options,variant))){ret="<img ".concat('class="',options.className,'" ','draggable="false" ','alt="',match,'"',' src="',src,'"'),attrib=options.attributes(icon,variant);for(attrname in attrib)attrib.hasOwnProperty(attrname)&&0!==attrname.indexOf("on")&&ret.indexOf(" "+attrname+"=")===-1&&(ret=ret.concat(" ",attrname,'="',escapeHTML(attrib[attrname]),'"'));ret=ret.concat(">")}return ret})}function replacer(m){return escaper[m]}function returnNull(){return null}function toSizeSquaredAsset(value){return"number"==typeof value?value+"x"+value:value}function fromCodePoint(codepoint){var code="string"==typeof codepoint?parseInt(codepoint,16):codepoint;return code<65536?fromCharCode(code):(code-=65536,fromCharCode(55296+(code>>10),56320+(1023&code)))}function parse(what,how){return how&&"function"!=typeof how||(how={callback:how}),("string"==typeof what?parseString:parseNode)(what,{callback:how.callback||defaultImageSrcGenerator,attributes:"function"==typeof how.attributes?how.attributes:returnNull,base:"string"==typeof how.base?how.base:twemoji.base,ext:how.ext||twemoji.ext,size:how.folder||toSizeSquaredAsset(how.size||twemoji.size),className:how.className||twemoji.className})}function replace(text,callback){return String(text).replace(re,callback)}function test(text){re.lastIndex=0;var result=re.test(text);return re.lastIndex=0,result}function toCodePoint(unicodeSurrogates,sep){for(var r=[],c=0,p=0,i=0;i<unicodeSurrogates.length;)c=unicodeSurrogates.charCodeAt(i++),p?(r.push((65536+(p-55296<<10)+(c-56320)).toString(16)),p=0):55296<=c&&c<=56319?p=c:r.push(c.toString(16));return r.join(sep||"-")}var twemoji={base:("https:"===location.protocol?"https:":"http:")+"//twemoji.maxcdn.com/",ext:".png",size:"36x36",className:"emoji",convert:{fromCodePoint:fromCodePoint,toCodePoint:toCodePoint},onerror:function(){this.parentNode&&this.parentNode.replaceChild(createText(this.alt),this)},parse:parse,replace:replace,test:test},escaper={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},re=/((?:\ud83c\udde8\ud83c\uddf3|\ud83c\uddfa\ud83c\uddf8|\ud83c\uddf7\ud83c\uddfa|\ud83c\uddf0\ud83c\uddf7|\ud83c\uddef\ud83c\uddf5|\ud83c\uddee\ud83c\uddf9|\ud83c\uddec\ud83c\udde7|\ud83c\uddeb\ud83c\uddf7|\ud83c\uddea\ud83c\uddf8|\ud83c\udde9\ud83c\uddea|\u0039\ufe0f?\u20e3|\u0038\ufe0f?\u20e3|\u0037\ufe0f?\u20e3|\u0036\ufe0f?\u20e3|\u0035\ufe0f?\u20e3|\u0034\ufe0f?\u20e3|\u0033\ufe0f?\u20e3|\u0032\ufe0f?\u20e3|\u0031\ufe0f?\u20e3|\u0030\ufe0f?\u20e3|\u0023\ufe0f?\u20e3|\ud83d\udeb3|\ud83d\udeb1|\ud83d\udeb0|\ud83d\udeaf|\ud83d\udeae|\ud83d\udea6|\ud83d\udea3|\ud83d\udea1|\ud83d\udea0|\ud83d\ude9f|\ud83d\ude9e|\ud83d\ude9d|\ud83d\ude9c|\ud83d\ude9b|\ud83d\ude98|\ud83d\ude96|\ud83d\ude94|\ud83d\ude90|\ud83d\ude8e|\ud83d\ude8d|\ud83d\ude8b|\ud83d\ude8a|\ud83d\ude88|\ud83d\ude86|\ud83d\ude82|\ud83d\ude81|\ud83d\ude36|\ud83d\ude34|\ud83d\ude2f|\ud83d\ude2e|\ud83d\ude2c|\ud83d\ude27|\ud83d\ude26|\ud83d\ude1f|\ud83d\ude1b|\ud83d\ude19|\ud83d\ude17|\ud83d\ude15|\ud83d\ude11|\ud83d\ude10|\ud83d\ude0e|\ud83d\ude08|\ud83d\ude07|\ud83d\ude00|\ud83d\udd67|\ud83d\udd66|\ud83d\udd65|\ud83d\udd64|\ud83d\udd63|\ud83d\udd62|\ud83d\udd61|\ud83d\udd60|\ud83d\udd5f|\ud83d\udd5e|\ud83d\udd5d|\ud83d\udd5c|\ud83d\udd2d|\ud83d\udd2c|\ud83d\udd15|\ud83d\udd09|\ud83d\udd08|\ud83d\udd07|\ud83d\udd06|\ud83d\udd05|\ud83d\udd04|\ud83d\udd02|\ud83d\udd01|\ud83d\udd00|\ud83d\udcf5|\ud83d\udcef|\ud83d\udced|\ud83d\udcec|\ud83d\udcb7|\ud83d\udcb6|\ud83d\udcad|\ud83d\udc6d|\ud83d\udc6c|\ud83d\udc65|\ud83d\udc2a|\ud83d\udc16|\ud83d\udc15|\ud83d\udc13|\ud83d\udc10|\ud83d\udc0f|\ud83d\udc0b|\ud83d\udc0a|\ud83d\udc09|\ud83d\udc08|\ud83d\udc07|\ud83d\udc06|\ud83d\udc05|\ud83d\udc04|\ud83d\udc03|\ud83d\udc02|\ud83d\udc01|\ud83d\udc00|\ud83c\udfe4|\ud83c\udfc9|\ud83c\udfc7|\ud83c\udf7c|\ud83c\udf50|\ud83c\udf4b|\ud83c\udf33|\ud83c\udf32|\ud83c\udf1e|\ud83c\udf1d|\ud83c\udf1c|\ud83c\udf1a|\ud83c\udf18|\ud83c\udccf|\ud83c\udd70|\ud83c\udd71|\ud83c\udd7e|\ud83c\udd8e|\ud83c\udd91|\ud83c\udd92|\ud83c\udd93|\ud83c\udd94|\ud83c\udd95|\ud83c\udd96|\ud83c\udd97|\ud83c\udd98|\ud83c\udd99|\ud83c\udd9a|\ud83d\udc77|\ud83d\udec5|\ud83d\udec4|\ud83d\udec3|\ud83d\udec2|\ud83d\udec1|\ud83d\udebf|\ud83d\udeb8|\ud83d\udeb7|\ud83d\udeb5|\ud83c\ude01|\ud83c\ude02|\ud83c\ude32|\ud83c\ude33|\ud83c\ude34|\ud83c\ude35|\ud83c\ude36|\ud83c\ude37|\ud83c\ude38|\ud83c\ude39|\ud83c\ude3a|\ud83c\ude50|\ud83c\ude51|\ud83c\udf00|\ud83c\udf01|\ud83c\udf02|\ud83c\udf03|\ud83c\udf04|\ud83c\udf05|\ud83c\udf06|\ud83c\udf07|\ud83c\udf08|\ud83c\udf09|\ud83c\udf0a|\ud83c\udf0b|\ud83c\udf0c|\ud83c\udf0f|\ud83c\udf11|\ud83c\udf13|\ud83c\udf14|\ud83c\udf15|\ud83c\udf19|\ud83c\udf1b|\ud83c\udf1f|\ud83c\udf20|\ud83c\udf30|\ud83c\udf31|\ud83c\udf34|\ud83c\udf35|\ud83c\udf37|\ud83c\udf38|\ud83c\udf39|\ud83c\udf3a|\ud83c\udf3b|\ud83c\udf3c|\ud83c\udf3d|\ud83c\udf3e|\ud83c\udf3f|\ud83c\udf40|\ud83c\udf41|\ud83c\udf42|\ud83c\udf43|\ud83c\udf44|\ud83c\udf45|\ud83c\udf46|\ud83c\udf47|\ud83c\udf48|\ud83c\udf49|\ud83c\udf4a|\ud83c\udf4c|\ud83c\udf4d|\ud83c\udf4e|\ud83c\udf4f|\ud83c\udf51|\ud83c\udf52|\ud83c\udf53|\ud83c\udf54|\ud83c\udf55|\ud83c\udf56|\ud83c\udf57|\ud83c\udf58|\ud83c\udf59|\ud83c\udf5a|\ud83c\udf5b|\ud83c\udf5c|\ud83c\udf5d|\ud83c\udf5e|\ud83c\udf5f|\ud83c\udf60|\ud83c\udf61|\ud83c\udf62|\ud83c\udf63|\ud83c\udf64|\ud83c\udf65|\ud83c\udf66|\ud83c\udf67|\ud83c\udf68|\ud83c\udf69|\ud83c\udf6a|\ud83c\udf6b|\ud83c\udf6c|\ud83c\udf6d|\ud83c\udf6e|\ud83c\udf6f|\ud83c\udf70|\ud83c\udf71|\ud83c\udf72|\ud83c\udf73|\ud83c\udf74|\ud83c\udf75|\ud83c\udf76|\ud83c\udf77|\ud83c\udf78|\ud83c\udf79|\ud83c\udf7a|\ud83c\udf7b|\ud83c\udf80|\ud83c\udf81|\ud83c\udf82|\ud83c\udf83|\ud83c\udf84|\ud83c\udf85|\ud83c\udf86|\ud83c\udf87|\ud83c\udf88|\ud83c\udf89|\ud83c\udf8a|\ud83c\udf8b|\ud83c\udf8c|\ud83c\udf8d|\ud83c\udf8e|\ud83c\udf8f|\ud83c\udf90|\ud83c\udf91|\ud83c\udf92|\ud83c\udf93|\ud83c\udfa0|\ud83c\udfa1|\ud83c\udfa2|\ud83c\udfa3|\ud83c\udfa4|\ud83c\udfa5|\ud83c\udfa6|\ud83c\udfa7|\ud83c\udfa8|\ud83c\udfa9|\ud83c\udfaa|\ud83c\udfab|\ud83c\udfac|\ud83c\udfad|\ud83c\udfae|\ud83c\udfaf|\ud83c\udfb0|\ud83c\udfb1|\ud83c\udfb2|\ud83c\udfb3|\ud83c\udfb4|\ud83c\udfb5|\ud83c\udfb6|\ud83c\udfb7|\ud83c\udfb8|\ud83c\udfb9|\ud83c\udfba|\ud83c\udfbb|\ud83c\udfbc|\ud83c\udfbd|\ud83c\udfbe|\ud83c\udfbf|\ud83c\udfc0|\ud83c\udfc1|\ud83c\udfc2|\ud83c\udfc3|\ud83c\udfc4|\ud83c\udfc6|\ud83c\udfc8|\ud83c\udfca|\ud83c\udfe0|\ud83c\udfe1|\ud83c\udfe2|\ud83c\udfe3|\ud83c\udfe5|\ud83c\udfe6|\ud83c\udfe7|\ud83c\udfe8|\ud83c\udfe9|\ud83c\udfea|\ud83c\udfeb|\ud83c\udfec|\ud83c\udfed|\ud83c\udfee|\ud83c\udfef|\ud83c\udff0|\ud83d\udc0c|\ud83d\udc0d|\ud83d\udc0e|\ud83d\udc11|\ud83d\udc12|\ud83d\udc14|\ud83d\udc17|\ud83d\udc18|\ud83d\udc19|\ud83d\udc1a|\ud83d\udc1b|\ud83d\udc1c|\ud83d\udc1d|\ud83d\udc1e|\ud83d\udc1f|\ud83d\udc20|\ud83d\udc21|\ud83d\udc22|\ud83d\udc23|\ud83d\udc24|\ud83d\udc25|\ud83d\udc26|\ud83d\udc27|\ud83d\udc28|\ud83d\udc29|\ud83d\udc2b|\ud83d\udc2c|\ud83d\udc2d|\ud83d\udc2e|\ud83d\udc2f|\ud83d\udc30|\ud83d\udc31|\ud83d\udc32|\ud83d\udc33|\ud83d\udc34|\ud83d\udc35|\ud83d\udc36|\ud83d\udc37|\ud83d\udc38|\ud83d\udc39|\ud83d\udc3a|\ud83d\udc3b|\ud83d\udc3c|\ud83d\udc3d|\ud83d\udc3e|\ud83d\udc40|\ud83d\udc42|\ud83d\udc43|\ud83d\udc44|\ud83d\udc45|\ud83d\udc46|\ud83d\udc47|\ud83d\udc48|\ud83d\udc49|\ud83d\udc4a|\ud83d\udc4b|\ud83d\udc4c|\ud83d\udc4d|\ud83d\udc4e|\ud83d\udc4f|\ud83d\udc50|\ud83d\udc51|\ud83d\udc52|\ud83d\udc53|\ud83d\udc54|\ud83d\udc55|\ud83d\udc56|\ud83d\udc57|\ud83d\udc58|\ud83d\udc59|\ud83d\udc5a|\ud83d\udc5b|\ud83d\udc5c|\ud83d\udc5d|\ud83d\udc5e|\ud83d\udc5f|\ud83d\udc60|\ud83d\udc61|\ud83d\udc62|\ud83d\udc63|\ud83d\udc64|\ud83d\udc66|\ud83d\udc67|\ud83d\udc68|\ud83d\udc69|\ud83d\udc6a|\ud83d\udc6b|\ud83d\udc6e|\ud83d\udc6f|\ud83d\udc70|\ud83d\udc71|\ud83d\udc72|\ud83d\udc73|\ud83d\udc74|\ud83d\udc75|\ud83d\udc76|\ud83d\udeb4|\ud83d\udc78|\ud83d\udc79|\ud83d\udc7a|\ud83d\udc7b|\ud83d\udc7c|\ud83d\udc7d|\ud83d\udc7e|\ud83d\udc7f|\ud83d\udc80|\ud83d\udc81|\ud83d\udc82|\ud83d\udc83|\ud83d\udc84|\ud83d\udc85|\ud83d\udc86|\ud83d\udc87|\ud83d\udc88|\ud83d\udc89|\ud83d\udc8a|\ud83d\udc8b|\ud83d\udc8c|\ud83d\udc8d|\ud83d\udc8e|\ud83d\udc8f|\ud83d\udc90|\ud83d\udc91|\ud83d\udc92|\ud83d\udc93|\ud83d\udc94|\ud83d\udc95|\ud83d\udc96|\ud83d\udc97|\ud83d\udc98|\ud83d\udc99|\ud83d\udc9a|\ud83d\udc9b|\ud83d\udc9c|\ud83d\udc9d|\ud83d\udc9e|\ud83d\udc9f|\ud83d\udca0|\ud83d\udca1|\ud83d\udca2|\ud83d\udca3|\ud83d\udca4|\ud83d\udca5|\ud83d\udca6|\ud83d\udca7|\ud83d\udca8|\ud83d\udca9|\ud83d\udcaa|\ud83d\udcab|\ud83d\udcac|\ud83d\udcae|\ud83d\udcaf|\ud83d\udcb0|\ud83d\udcb1|\ud83d\udcb2|\ud83d\udcb3|\ud83d\udcb4|\ud83d\udcb5|\ud83d\udcb8|\ud83d\udcb9|\ud83d\udcba|\ud83d\udcbb|\ud83d\udcbc|\ud83d\udcbd|\ud83d\udcbe|\ud83d\udcbf|\ud83d\udcc0|\ud83d\udcc1|\ud83d\udcc2|\ud83d\udcc3|\ud83d\udcc4|\ud83d\udcc5|\ud83d\udcc6|\ud83d\udcc7|\ud83d\udcc8|\ud83d\udcc9|\ud83d\udcca|\ud83d\udccb|\ud83d\udccc|\ud83d\udccd|\ud83d\udcce|\ud83d\udccf|\ud83d\udcd0|\ud83d\udcd1|\ud83d\udcd2|\ud83d\udcd3|\ud83d\udcd4|\ud83d\udcd5|\ud83d\udcd6|\ud83d\udcd7|\ud83d\udcd8|\ud83d\udcd9|\ud83d\udcda|\ud83d\udcdb|\ud83d\udcdc|\ud83d\udcdd|\ud83d\udcde|\ud83d\udcdf|\ud83d\udce0|\ud83d\udce1|\ud83d\udce2|\ud83d\udce3|\ud83d\udce4|\ud83d\udce5|\ud83d\udce6|\ud83d\udce7|\ud83d\udce8|\ud83d\udce9|\ud83d\udcea|\ud83d\udceb|\ud83d\udcee|\ud83d\udcf0|\ud83d\udcf1|\ud83d\udcf2|\ud83d\udcf3|\ud83d\udcf4|\ud83d\udcf6|\ud83d\udcf7|\ud83d\udcf9|\ud83d\udcfa|\ud83d\udcfb|\ud83d\udcfc|\ud83d\udd03|\ud83d\udd0a|\ud83d\udd0b|\ud83d\udd0c|\ud83d\udd0d|\ud83d\udd0e|\ud83d\udd0f|\ud83d\udd10|\ud83d\udd11|\ud83d\udd12|\ud83d\udd13|\ud83d\udd14|\ud83d\udd16|\ud83d\udd17|\ud83d\udd18|\ud83d\udd19|\ud83d\udd1a|\ud83d\udd1b|\ud83d\udd1c|\ud83d\udd1d|\ud83d\udd1e|\ud83d\udd1f|\ud83d\udd20|\ud83d\udd21|\ud83d\udd22|\ud83d\udd23|\ud83d\udd24|\ud83d\udd25|\ud83d\udd26|\ud83d\udd27|\ud83d\udd28|\ud83d\udd29|\ud83d\udd2a|\ud83d\udd2b|\ud83d\udd2e|\ud83d\udd2f|\ud83d\udd30|\ud83d\udd31|\ud83d\udd32|\ud83d\udd33|\ud83d\udd34|\ud83d\udd35|\ud83d\udd36|\ud83d\udd37|\ud83d\udd38|\ud83d\udd39|\ud83d\udd3a|\ud83d\udd3b|\ud83d\udd3c|\ud83d\udd3d|\ud83d\udd50|\ud83d\udd51|\ud83d\udd52|\ud83d\udd53|\ud83d\udd54|\ud83d\udd55|\ud83d\udd56|\ud83d\udd57|\ud83d\udd58|\ud83d\udd59|\ud83d\udd5a|\ud83d\udd5b|\ud83d\uddfb|\ud83d\uddfc|\ud83d\uddfd|\ud83d\uddfe|\ud83d\uddff|\ud83d\ude01|\ud83d\ude02|\ud83d\ude03|\ud83d\ude04|\ud83d\ude05|\ud83d\ude06|\ud83d\ude09|\ud83d\ude0a|\ud83d\ude0b|\ud83d\ude0c|\ud83d\ude0d|\ud83d\ude0f|\ud83d\ude12|\ud83d\ude13|\ud83d\ude14|\ud83d\ude16|\ud83d\ude18|\ud83d\ude1a|\ud83d\ude1c|\ud83d\ude1d|\ud83d\ude1e|\ud83d\ude20|\ud83d\ude21|\ud83d\ude22|\ud83d\ude23|\ud83d\ude24|\ud83d\ude25|\ud83d\ude28|\ud83d\ude29|\ud83d\ude2a|\ud83d\ude2b|\ud83d\ude2d|\ud83d\ude30|\ud83d\ude31|\ud83d\ude32|\ud83d\ude33|\ud83d\ude35|\ud83d\ude37|\ud83d\ude38|\ud83d\ude39|\ud83d\ude3a|\ud83d\ude3b|\ud83d\ude3c|\ud83d\ude3d|\ud83d\ude3e|\ud83d\ude3f|\ud83d\ude40|\ud83d\ude45|\ud83d\ude46|\ud83d\ude47|\ud83d\ude48|\ud83d\ude49|\ud83d\ude4a|\ud83d\ude4b|\ud83d\ude4c|\ud83d\ude4d|\ud83d\ude4e|\ud83d\ude4f|\ud83d\ude80|\ud83d\ude83|\ud83d\ude84|\ud83d\ude85|\ud83d\ude87|\ud83d\ude89|\ud83d\ude8c|\ud83d\ude8f|\ud83d\ude91|\ud83d\ude92|\ud83d\ude93|\ud83d\ude95|\ud83d\ude97|\ud83d\ude99|\ud83d\ude9a|\ud83d\udea2|\ud83d\udea4|\ud83d\udea5|\ud83d\udea7|\ud83d\udea8|\ud83d\udea9|\ud83d\udeaa|\ud83d\udeab|\ud83d\udeac|\ud83d\udead|\ud83d\udeb2|\ud83d\udeb6|\ud83d\udeb9|\ud83d\udeba|\ud83d\udebb|\ud83d\udebc|\ud83d\udebd|\ud83d\udebe|\ud83d\udec0|\ud83c\udde6|\ud83c\udde7|\ud83c\udde8|\ud83c\udde9|\ud83c\uddea|\ud83c\uddeb|\ud83c\uddec|\ud83c\udded|\ud83c\uddee|\ud83c\uddef|\ud83c\uddf0|\ud83c\uddf1|\ud83c\uddf2|\ud83c\uddf3|\ud83c\uddf4|\ud83c\uddf5|\ud83c\uddf6|\ud83c\uddf7|\ud83c\uddf8|\ud83c\uddf9|\ud83c\uddfa|\ud83c\uddfb|\ud83c\uddfc|\ud83c\uddfd|\ud83c\uddfe|\ud83c\uddff|\ud83c\udf0d|\ud83c\udf0e|\ud83c\udf10|\ud83c\udf12|\ud83c\udf16|\ud83c\udf17|\ue50a|\u3030|\u27b0|\u2797|\u2796|\u2795|\u2755|\u2754|\u2753|\u274e|\u274c|\u2728|\u270b|\u270a|\u2705|\u26ce|\u23f3|\u23f0|\u23ec|\u23eb|\u23ea|\u23e9|\u2122|\u27bf|\u00a9|\u00ae)|(?:(?:\ud83c\udc04|\ud83c\udd7f|\ud83c\ude1a|\ud83c\ude2f|\u3299|\u303d|\u2b55|\u2b50|\u2b1c|\u2b1b|\u2b07|\u2b06|\u2b05|\u2935|\u2934|\u27a1|\u2764|\u2757|\u2747|\u2744|\u2734|\u2733|\u2716|\u2714|\u2712|\u270f|\u270c|\u2709|\u2708|\u2702|\u26fd|\u26fa|\u26f5|\u26f3|\u26f2|\u26ea|\u26d4|\u26c5|\u26c4|\u26be|\u26bd|\u26ab|\u26aa|\u26a1|\u26a0|\u2693|\u267f|\u267b|\u3297|\u2666|\u2665|\u2663|\u2660|\u2653|\u2652|\u2651|\u2650|\u264f|\u264e|\u264d|\u264c|\u264b|\u264a|\u2649|\u2648|\u263a|\u261d|\u2615|\u2614|\u2611|\u260e|\u2601|\u2600|\u25fe|\u25fd|\u25fc|\u25fb|\u25c0|\u25b6|\u25ab|\u25aa|\u24c2|\u231b|\u231a|\u21aa|\u21a9|\u2199|\u2198|\u2197|\u2196|\u2195|\u2194|\u2139|\u2049|\u203c|\u2668)([\uFE0E\uFE0F]?)))/g,rescaper=/[&<>'"]/g,shouldntBeParsed=/IFRAME|NOFRAMES|NOSCRIPT|SCRIPT|SELECT|STYLE|TEXTAREA/,fromCharCode=String.fromCharCode;return twemoji}();if(function(factory,root){"function"==typeof define&&define.amd?define(factory):"undefined"!=typeof module&&"object"==typeof exports?module.exports=factory():root.log4javascript=factory()}(function(){function isUndefined(obj){return"undefined"==typeof obj}function EventSupport(){}
function Log4JavaScript(){}function toStr(obj){return obj&&obj.toString?obj.toString():String(obj)}function getExceptionMessage(ex){return ex.message?ex.message:ex.description?ex.description:toStr(ex)}function getUrlFileName(url){var lastSlashIndex=Math.max(url.lastIndexOf("/"),url.lastIndexOf("\\"));return url.substr(lastSlashIndex+1)}function getExceptionStringRep(ex){if(ex){var exStr="Exception: "+getExceptionMessage(ex);try{ex.lineNumber&&(exStr+=" on line number "+ex.lineNumber),ex.fileName&&(exStr+=" in file "+getUrlFileName(ex.fileName))}catch(localEx){logLog.warn("Unable to obtain file and line information for error")}return showStackTraces&&ex.stack&&(exStr+=newLine+"Stack trace:"+newLine+ex.stack),exStr}return null}function bool(obj){return Boolean(obj)}function trim(str){return str.replace(/^\s+/,"").replace(/\s+$/,"")}function splitIntoLines(text){var text2=text.replace(/\r\n/g,"\n").replace(/\r/g,"\n");return text2.split("\n")}function array_remove(arr,val){for(var index=-1,i=0,len=arr.length;i<len;i++)if(arr[i]===val){index=i;break}return index>=0&&(arr.splice(index,1),!0)}function array_contains(arr,val){for(var i=0,len=arr.length;i<len;i++)if(arr[i]==val)return!0;return!1}function extractBooleanFromParam(param,defaultValue){return isUndefined(param)?defaultValue:bool(param)}function extractStringFromParam(param,defaultValue){return isUndefined(param)?defaultValue:String(param)}function extractIntFromParam(param,defaultValue){if(isUndefined(param))return defaultValue;try{var value=parseInt(param,10);return isNaN(value)?defaultValue:value}catch(ex){return logLog.warn("Invalid int param "+param,ex),defaultValue}}function extractFunctionFromParam(param,defaultValue){return"function"==typeof param?param:defaultValue}function isError(err){return err instanceof Error}function handleError(message,exception){logLog.error(message,exception),log4javascript.dispatchEvent("error",{message:message,exception:exception})}function Timer(name,level){this.name=name,this.level=isUndefined(level)?Level.INFO:level,this.start=new Date}function Logger(name){this.name=name,this.parent=null,this.children=[];var appenders=[],loggerLevel=null,isRoot=this.name===rootLoggerName,isNull=this.name===nullLoggerName,appenderCache=null,appenderCacheInvalidated=!1;this.addChild=function(childLogger){this.children.push(childLogger),childLogger.parent=this,childLogger.invalidateAppenderCache()};var additive=!0;this.getAdditivity=function(){return additive},this.setAdditivity=function(additivity){var valueChanged=additive!=additivity;additive=additivity,valueChanged&&this.invalidateAppenderCache()},this.addAppender=function(appender){isNull?handleError("Logger.addAppender: you may not add an appender to the null logger"):appender instanceof log4javascript.Appender?array_contains(appenders,appender)||(appenders.push(appender),appender.setAddedToLogger(this),this.invalidateAppenderCache()):handleError("Logger.addAppender: appender supplied ('"+toStr(appender)+"') is not a subclass of Appender")},this.removeAppender=function(appender){array_remove(appenders,appender),appender.setRemovedFromLogger(this),this.invalidateAppenderCache()},this.removeAllAppenders=function(){var appenderCount=appenders.length;if(appenderCount>0){for(var i=0;i<appenderCount;i++)appenders[i].setRemovedFromLogger(this);appenders.length=0,this.invalidateAppenderCache()}},this.getEffectiveAppenders=function(){if(null===appenderCache||appenderCacheInvalidated){var parentEffectiveAppenders=isRoot||!this.getAdditivity()?[]:this.parent.getEffectiveAppenders();appenderCache=parentEffectiveAppenders.concat(appenders),appenderCacheInvalidated=!1}return appenderCache},this.invalidateAppenderCache=function(){appenderCacheInvalidated=!0;for(var i=0,len=this.children.length;i<len;i++)this.children[i].invalidateAppenderCache()},this.log=function(level,params){if(enabled&&level.isGreaterOrEqual(this.getEffectiveLevel())){var exception,finalParamIndex=params.length-1,lastParam=params[finalParamIndex];params.length>1&&isError(lastParam)&&(exception=lastParam,finalParamIndex--);for(var messages=[],i=0;i<=finalParamIndex;i++)messages[i]=params[i];var loggingEvent=new LoggingEvent(this,new Date,level,messages,exception);this.callAppenders(loggingEvent)}},this.callAppenders=function(loggingEvent){for(var effectiveAppenders=this.getEffectiveAppenders(),i=0,len=effectiveAppenders.length;i<len;i++)effectiveAppenders[i].doAppend(loggingEvent)},this.setLevel=function(level){isRoot&&null===level?handleError("Logger.setLevel: you cannot set the level of the root logger to null"):level instanceof Level?loggerLevel=level:handleError("Logger.setLevel: level supplied to logger "+this.name+" is not an instance of log4javascript.Level")},this.getLevel=function(){return loggerLevel},this.getEffectiveLevel=function(){for(var logger=this;null!==logger;logger=logger.parent){var level=logger.getLevel();if(null!==level)return level}},this.group=function(name,initiallyExpanded){if(enabled)for(var effectiveAppenders=this.getEffectiveAppenders(),i=0,len=effectiveAppenders.length;i<len;i++)effectiveAppenders[i].group(name,initiallyExpanded)},this.groupEnd=function(){if(enabled)for(var effectiveAppenders=this.getEffectiveAppenders(),i=0,len=effectiveAppenders.length;i<len;i++)effectiveAppenders[i].groupEnd()};var timers={};this.time=function(name,level){enabled&&(isUndefined(name)?handleError("Logger.time: a name for the timer must be supplied"):!level||level instanceof Level?timers[name]=new Timer(name,level):handleError("Logger.time: level supplied to timer "+name+" is not an instance of log4javascript.Level"))},this.timeEnd=function(name){if(enabled)if(isUndefined(name))handleError("Logger.timeEnd: a name for the timer must be supplied");else if(timers[name]){var timer=timers[name],milliseconds=timer.getElapsedTime();this.log(timer.level,["Timer "+toStr(name)+" completed in "+milliseconds+"ms"]),delete timers[name]}else logLog.warn("Logger.timeEnd: no timer found with name "+name)},this.assert=function(expr){if(enabled&&!expr){for(var args=[],i=1,len=arguments.length;i<len;i++)args.push(arguments[i]);args=args.length>0?args:["Assertion Failure"],args.push(newLine),args.push(expr),this.log(Level.ERROR,args)}},this.toString=function(){return"Logger["+this.name+"]"}}function SimpleLayout(){this.customFields=[]}function NullLayout(){this.customFields=[]}function XmlLayout(combineMessages){this.combineMessages=extractBooleanFromParam(combineMessages,!0),this.customFields=[]}function escapeNewLines(str){return str.replace(/\r\n|\r|\n/g,"\\r\\n")}function JsonLayout(readable,combineMessages){this.readable=extractBooleanFromParam(readable,!1),this.combineMessages=extractBooleanFromParam(combineMessages,!0),this.batchHeader=this.readable?"["+newLine:"[",this.batchFooter=this.readable?"]"+newLine:"]",this.batchSeparator=this.readable?","+newLine:",",this.setKeys(),this.colon=this.readable?": ":":",this.tab=this.readable?"\t":"",this.lineBreak=this.readable?newLine:"",this.customFields=[]}function HttpPostDataLayout(){this.setKeys(),this.customFields=[],this.returnsPostData=!0}function formatObjectExpansion(obj,depth,indentation){function doFormat(obj,depth,indentation){function formatString(text){for(var lines=splitIntoLines(text),j=1,jLen=lines.length;j<jLen;j++)lines[j]=indentation+lines[j];return lines.join(newLine)}var i,len,childDepth,childIndentation,childLines,expansion,childExpansion;if(indentation||(indentation=""),null===obj)return"null";if("undefined"==typeof obj)return"undefined";if("string"==typeof obj)return formatString(obj);if("object"==typeof obj&&array_contains(objectsExpanded,obj)){try{expansion=toStr(obj)}catch(ex){expansion="Error formatting property. Details: "+getExceptionStringRep(ex)}return expansion+" [already expanded]"}if(obj instanceof Array&&depth>0){for(objectsExpanded.push(obj),expansion="["+newLine,childDepth=depth-1,childIndentation=indentation+"  ",childLines=[],i=0,len=obj.length;i<len;i++)try{childExpansion=doFormat(obj[i],childDepth,childIndentation),childLines.push(childIndentation+childExpansion)}catch(ex){childLines.push(childIndentation+"Error formatting array member. Details: "+getExceptionStringRep(ex))}return expansion+=childLines.join(","+newLine)+newLine+indentation+"]"}if("[object Date]"==Object.prototype.toString.call(obj))return obj.toString();if("object"==typeof obj&&depth>0){objectsExpanded.push(obj),expansion="{"+newLine,childDepth=depth-1,childIndentation=indentation+"  ",childLines=[];for(i in obj)try{childExpansion=doFormat(obj[i],childDepth,childIndentation),childLines.push(childIndentation+i+": "+childExpansion)}catch(ex){childLines.push(childIndentation+i+": Error formatting property. Details: "+getExceptionStringRep(ex))}return expansion+=childLines.join(","+newLine)+newLine+indentation+"}"}return formatString(toStr(obj))}var objectsExpanded=[];return doFormat(obj,depth,indentation)}function PatternLayout(pattern){pattern?this.pattern=pattern:this.pattern=PatternLayout.DEFAULT_CONVERSION_PATTERN,this.customFields=[]}function AlertAppender(){}function BrowserConsoleAppender(){}function isHttpRequestSuccessful(xmlHttp){return isUndefined(xmlHttp.status)||0===xmlHttp.status||xmlHttp.status>=200&&xmlHttp.status<300||1223==xmlHttp.status}function AjaxAppender(url,withCredentials){function checkCanConfigure(configOptionName){return!initialized||(handleError("AjaxAppender: configuration option '"+configOptionName+"' may not be set after the appender has been initialized"),!1)}function sendAll(){if(isSupported&&enabled){sending=!0;var currentRequestBatch;if(waitForResponse)queuedRequests.length>0?(currentRequestBatch=queuedRequests.shift(),sendRequest(preparePostData(currentRequestBatch),sendAll)):(sending=!1,timed&&scheduleSending());else{for(;currentRequestBatch=queuedRequests.shift();)sendRequest(preparePostData(currentRequestBatch));sending=!1,timed&&scheduleSending()}}}function sendAllRemaining(){var sendingAnything=!1;if(isSupported&&enabled){for(var currentLoggingEvent,actualBatchSize=appender.getLayout().allowBatching()?batchSize:1,batchedLoggingEvents=[];currentLoggingEvent=queuedLoggingEvents.shift();)batchedLoggingEvents.push(currentLoggingEvent),queuedLoggingEvents.length>=actualBatchSize&&(queuedRequests.push(batchedLoggingEvents),batchedLoggingEvents=[]);batchedLoggingEvents.length>0&&queuedRequests.push(batchedLoggingEvents),sendingAnything=queuedRequests.length>0,waitForResponse=!1,timed=!1,sendAll()}return sendingAnything}function preparePostData(batchedLoggingEvents){for(var currentLoggingEvent,formattedMessages=[],postData="";currentLoggingEvent=batchedLoggingEvents.shift();)formattedMessages.push(appender.getLayout().formatWithException(currentLoggingEvent));return postData=1==batchedLoggingEvents.length?formattedMessages.join(""):appender.getLayout().batchHeader+formattedMessages.join(appender.getLayout().batchSeparator)+appender.getLayout().batchFooter,contentType==appender.defaults.contentType&&(postData=appender.getLayout().returnsPostData?postData:urlEncode(postVarName)+"="+urlEncode(postData),postData.length>0&&(postData+="&"),postData+="layout="+urlEncode(appender.getLayout().toString())),postData}function scheduleSending(){window.setTimeout(sendAll,timerInterval)}function xmlHttpErrorHandler(){var msg="AjaxAppender: could not create XMLHttpRequest object. AjaxAppender disabled";handleError(msg),isSupported=!1,failCallback&&failCallback(msg)}function sendRequest(postData,successCallback){try{var xmlHttp=getXmlHttp(xmlHttpErrorHandler);if(isSupported){xmlHttp.onreadystatechange=function(){if(4==xmlHttp.readyState){if(isHttpRequestSuccessful(xmlHttp))requestSuccessCallback&&requestSuccessCallback(xmlHttp),successCallback&&successCallback(xmlHttp);else{var msg="AjaxAppender.append: XMLHttpRequest request to URL "+url+" returned status code "+xmlHttp.status;handleError(msg),failCallback&&failCallback(msg)}xmlHttp.onreadystatechange=emptyFunction,xmlHttp=null}},xmlHttp.open("POST",url,!0),withCredentials&&withCredentialsSupported&&(xmlHttp.withCredentials=!0);try{for(var header,i=0;header=headers[i++];)xmlHttp.setRequestHeader(header.name,header.value);xmlHttp.setRequestHeader("Content-Type",contentType)}catch(headerEx){var msg="AjaxAppender.append: your browser's XMLHttpRequest implementation does not support setRequestHeader, therefore cannot post data. AjaxAppender disabled";return handleError(msg),isSupported=!1,void(failCallback&&failCallback(msg))}xmlHttp.send(postData)}}catch(ex){var errMsg="AjaxAppender.append: error sending log message to "+url;handleError(errMsg,ex),isSupported=!1,failCallback&&failCallback(errMsg+". Details: "+getExceptionStringRep(ex))}}function init(){if(initialized=!0,sendAllOnUnload){var oldBeforeUnload=window.onbeforeunload;window.onbeforeunload=function(){oldBeforeUnload&&oldBeforeUnload(),sendAllRemaining()}}timed&&scheduleSending()}var appender=this,isSupported=!0;url||(handleError("AjaxAppender: URL must be specified in constructor"),isSupported=!1);var timed=this.defaults.timed,waitForResponse=this.defaults.waitForResponse,batchSize=this.defaults.batchSize,timerInterval=this.defaults.timerInterval,requestSuccessCallback=this.defaults.requestSuccessCallback,failCallback=this.defaults.failCallback,postVarName=this.defaults.postVarName,sendAllOnUnload=this.defaults.sendAllOnUnload,contentType=this.defaults.contentType,sessionId=null,queuedLoggingEvents=[],queuedRequests=[],headers=[],sending=!1,initialized=!1;this.getSessionId=function(){return sessionId},this.setSessionId=function(sessionIdParam){sessionId=extractStringFromParam(sessionIdParam,null),this.layout.setCustomField("sessionid",sessionId)},this.setLayout=function(layoutParam){checkCanConfigure("layout")&&(this.layout=layoutParam,null!==sessionId&&this.setSessionId(sessionId))},this.isTimed=function(){return timed},this.setTimed=function(timedParam){checkCanConfigure("timed")&&(timed=bool(timedParam))},this.getTimerInterval=function(){return timerInterval},this.setTimerInterval=function(timerIntervalParam){checkCanConfigure("timerInterval")&&(timerInterval=extractIntFromParam(timerIntervalParam,timerInterval))},this.isWaitForResponse=function(){return waitForResponse},this.setWaitForResponse=function(waitForResponseParam){checkCanConfigure("waitForResponse")&&(waitForResponse=bool(waitForResponseParam))},this.getBatchSize=function(){return batchSize},this.setBatchSize=function(batchSizeParam){checkCanConfigure("batchSize")&&(batchSize=extractIntFromParam(batchSizeParam,batchSize))},this.isSendAllOnUnload=function(){return sendAllOnUnload},this.setSendAllOnUnload=function(sendAllOnUnloadParam){checkCanConfigure("sendAllOnUnload")&&(sendAllOnUnload=extractBooleanFromParam(sendAllOnUnloadParam,sendAllOnUnload))},this.setRequestSuccessCallback=function(requestSuccessCallbackParam){requestSuccessCallback=extractFunctionFromParam(requestSuccessCallbackParam,requestSuccessCallback)},this.setFailCallback=function(failCallbackParam){failCallback=extractFunctionFromParam(failCallbackParam,failCallback)},this.getPostVarName=function(){return postVarName},this.setPostVarName=function(postVarNameParam){checkCanConfigure("postVarName")&&(postVarName=extractStringFromParam(postVarNameParam,postVarName))},this.getHeaders=function(){return headers},this.addHeader=function(name,value){"content-type"==name.toLowerCase()?contentType=value:headers.push({name:name,value:value})},this.sendAll=sendAll,this.sendAllRemaining=sendAllRemaining,this.append=function(loggingEvent){if(isSupported){initialized||init(),queuedLoggingEvents.push(loggingEvent);var actualBatchSize=this.getLayout().allowBatching()?batchSize:1;if(queuedLoggingEvents.length>=actualBatchSize){for(var currentLoggingEvent,batchedLoggingEvents=[];currentLoggingEvent=queuedLoggingEvents.shift();)batchedLoggingEvents.push(currentLoggingEvent);queuedRequests.push(batchedLoggingEvents),timed||waitForResponse&&(!waitForResponse||sending)||sendAll()}}}}function setCookie(name,value,days,path){var expires;if(path=path?"; path="+path:"",days){var date=new Date;date.setTime(date.getTime()+24*days*60*60*1e3),expires="; expires="+date.toGMTString()}else expires="";document.cookie=escape(name)+"="+escape(value)+expires+path}function getCookie(name){for(var nameEquals=escape(name)+"=",ca=document.cookie.split(";"),i=0,len=ca.length;i<len;i++){for(var c=ca[i];" "===c.charAt(0);)c=c.substring(1,c.length);if(0===c.indexOf(nameEquals))return unescape(c.substring(nameEquals.length,c.length))}return null}function getBaseUrl(){for(var scripts=document.getElementsByTagName("script"),i=0,len=scripts.length;i<len;++i)if(scripts[i].src.indexOf("log4javascript")!=-1){var lastSlash=scripts[i].src.lastIndexOf("/");return lastSlash==-1?"":scripts[i].src.substr(0,lastSlash+1)}return null}function isLoaded(win){try{return bool(win.loaded)}catch(ex){return!1}}function padWithSpaces(str,len){if(str.length<len){for(var spaces=[],numberOfSpaces=Math.max(0,len-str.length),i=0;i<numberOfSpaces;i++)spaces[i]=" ";str+=spaces.join("")}return str}function createDefaultLogger(){var logger=log4javascript.getLogger(defaultLoggerName),a=new log4javascript.PopUpAppender;return logger.addAppender(a),logger}Array.prototype.push||(Array.prototype.push=function(){for(var i=0,len=arguments.length;i<len;i++)this[this.length]=arguments[i];return this.length}),Array.prototype.shift||(Array.prototype.shift=function(){if(this.length>0){for(var firstItem=this[0],i=0,len=this.length-1;i<len;i++)this[i]=this[i+1];return this.length=this.length-1,firstItem}}),Array.prototype.splice||(Array.prototype.splice=function(startIndex,deleteCount){var itemsAfterDeleted=this.slice(startIndex+deleteCount),itemsDeleted=this.slice(startIndex,startIndex+deleteCount);this.length=startIndex;for(var argumentsArray=[],i=0,len=arguments.length;i<len;i++)argumentsArray[i]=arguments[i];var itemsToAppend=argumentsArray.length>2?itemsAfterDeleted=argumentsArray.slice(2).concat(itemsAfterDeleted):itemsAfterDeleted;for(i=0,len=itemsToAppend.length;i<len;i++)this.push(itemsToAppend[i]);return itemsDeleted}),EventSupport.prototype={eventTypes:[],eventListeners:{},setEventTypes:function(eventTypesParam){if(eventTypesParam instanceof Array){this.eventTypes=eventTypesParam,this.eventListeners={};for(var i=0,len=this.eventTypes.length;i<len;i++)this.eventListeners[this.eventTypes[i]]=[]}else handleError("log4javascript.EventSupport ["+this+"]: setEventTypes: eventTypes parameter must be an Array")},addEventListener:function(eventType,listener){"function"==typeof listener?(array_contains(this.eventTypes,eventType)||handleError("log4javascript.EventSupport ["+this+"]: addEventListener: no event called '"+eventType+"'"),this.eventListeners[eventType].push(listener)):handleError("log4javascript.EventSupport ["+this+"]: addEventListener: listener must be a function")},removeEventListener:function(eventType,listener){"function"==typeof listener?(array_contains(this.eventTypes,eventType)||handleError("log4javascript.EventSupport ["+this+"]: removeEventListener: no event called '"+eventType+"'"),array_remove(this.eventListeners[eventType],listener)):handleError("log4javascript.EventSupport ["+this+"]: removeEventListener: listener must be a function")},dispatchEvent:function(eventType,eventArgs){if(array_contains(this.eventTypes,eventType))for(var listeners=this.eventListeners[eventType],i=0,len=listeners.length;i<len;i++)listeners[i](this,eventType,eventArgs);else handleError("log4javascript.EventSupport ["+this+"]: dispatchEvent: no event called '"+eventType+"'")}};var applicationStartDate=new Date,uniqueId="log4javascript_"+applicationStartDate.getTime()+"_"+Math.floor(1e8*Math.random()),emptyFunction=function(){},newLine="\r\n",pageLoaded=!1;Log4JavaScript.prototype=new EventSupport;var log4javascript=new Log4JavaScript;log4javascript.version="1.4.13",log4javascript.edition="log4javascript";var urlEncode="undefined"!=typeof window.encodeURIComponent?function(str){return encodeURIComponent(str)}:function(str){return escape(str).replace(/\+/g,"%2B").replace(/"/g,"%22").replace(/'/g,"%27").replace(/\//g,"%2F").replace(/=/g,"%3D")};Function.prototype.apply||(Function.prototype.apply=function(obj,args){var methodName="__apply__";"undefined"!=typeof obj[methodName]&&(methodName+=String(Math.random()).substr(2)),obj[methodName]=this;for(var argsStrings=[],i=0,len=args.length;i<len;i++)argsStrings[i]="args["+i+"]";var script="obj."+methodName+"("+argsStrings.join(",")+")",returnValue=eval(script);return delete obj[methodName],returnValue}),Function.prototype.call||(Function.prototype.call=function(obj){for(var args=[],i=1,len=arguments.length;i<len;i++)args[i-1]=arguments[i];return this.apply(obj,args)});var logLog={quietMode:!1,debugMessages:[],setQuietMode:function(quietMode){this.quietMode=bool(quietMode)},numberOfErrors:0,alertAllErrors:!1,setAlertAllErrors:function(alertAllErrors){this.alertAllErrors=alertAllErrors},debug:function(message){this.debugMessages.push(message)},displayDebug:function(){alert(this.debugMessages.join(newLine))},warn:function(message,exception){},error:function(message,exception){if((1==++this.numberOfErrors||this.alertAllErrors)&&!this.quietMode){var alertMessage="log4javascript error: "+message;exception&&(alertMessage+=newLine+newLine+"Original error: "+getExceptionStringRep(exception)),alert(alertMessage)}}};log4javascript.logLog=logLog,log4javascript.setEventTypes(["load","error"]),log4javascript.handleError=handleError;var enabled=!("undefined"!=typeof log4javascript_disabled&&log4javascript_disabled);log4javascript.setEnabled=function(enable){enabled=bool(enable)},log4javascript.isEnabled=function(){return enabled};var useTimeStampsInMilliseconds=!0;log4javascript.setTimeStampsInMilliseconds=function(timeStampsInMilliseconds){useTimeStampsInMilliseconds=bool(timeStampsInMilliseconds)},log4javascript.isTimeStampsInMilliseconds=function(){return useTimeStampsInMilliseconds},log4javascript.evalInScope=function(expr){return eval(expr)};var showStackTraces=!1;log4javascript.setShowStackTraces=function(show){showStackTraces=bool(show)};var Level=function(level,name){this.level=level,this.name=name};Level.prototype={toString:function(){return this.name},equals:function(level){return this.level==level.level},isGreaterOrEqual:function(level){return this.level>=level.level}},Level.ALL=new Level(Number.MIN_VALUE,"ALL"),Level.TRACE=new Level(1e4,"TRACE"),Level.DEBUG=new Level(2e4,"DEBUG"),Level.INFO=new Level(3e4,"INFO"),Level.WARN=new Level(4e4,"WARN"),Level.ERROR=new Level(5e4,"ERROR"),Level.FATAL=new Level(6e4,"FATAL"),Level.OFF=new Level(Number.MAX_VALUE,"OFF"),log4javascript.Level=Level,Timer.prototype.getElapsedTime=function(){return(new Date).getTime()-this.start.getTime()};var anonymousLoggerName="[anonymous]",defaultLoggerName="[default]",nullLoggerName="[null]",rootLoggerName="root";Logger.prototype={trace:function(){this.log(Level.TRACE,arguments)},debug:function(){this.log(Level.DEBUG,arguments)},info:function(){this.log(Level.INFO,arguments)},warn:function(){this.log(Level.WARN,arguments)},error:function(){this.log(Level.ERROR,arguments)},fatal:function(){this.log(Level.FATAL,arguments)},isEnabledFor:function(level){return level.isGreaterOrEqual(this.getEffectiveLevel())},isTraceEnabled:function(){return this.isEnabledFor(Level.TRACE)},isDebugEnabled:function(){return this.isEnabledFor(Level.DEBUG)},isInfoEnabled:function(){return this.isEnabledFor(Level.INFO)},isWarnEnabled:function(){return this.isEnabledFor(Level.WARN)},isErrorEnabled:function(){return this.isEnabledFor(Level.ERROR)},isFatalEnabled:function(){return this.isEnabledFor(Level.FATAL)}},Logger.prototype.trace.isEntryPoint=!0,Logger.prototype.debug.isEntryPoint=!0,Logger.prototype.info.isEntryPoint=!0,Logger.prototype.warn.isEntryPoint=!0,Logger.prototype.error.isEntryPoint=!0,Logger.prototype.fatal.isEntryPoint=!0;var loggers={},loggerNames=[],ROOT_LOGGER_DEFAULT_LEVEL=Level.DEBUG,rootLogger=new Logger(rootLoggerName);rootLogger.setLevel(ROOT_LOGGER_DEFAULT_LEVEL),log4javascript.getRootLogger=function(){return rootLogger},log4javascript.getLogger=function(loggerName){if("string"!=typeof loggerName&&(loggerName=anonymousLoggerName,logLog.warn("log4javascript.getLogger: non-string logger name "+toStr(loggerName)+" supplied, returning anonymous logger")),loggerName==rootLoggerName&&handleError("log4javascript.getLogger: root logger may not be obtained by name"),!loggers[loggerName]){var logger=new Logger(loggerName);loggers[loggerName]=logger,loggerNames.push(loggerName);var parentLogger,lastDotIndex=loggerName.lastIndexOf(".");if(lastDotIndex>-1){var parentLoggerName=loggerName.substring(0,lastDotIndex);parentLogger=log4javascript.getLogger(parentLoggerName)}else parentLogger=rootLogger;parentLogger.addChild(logger)}return loggers[loggerName]};var defaultLogger=null;log4javascript.getDefaultLogger=function(){return defaultLogger||(defaultLogger=createDefaultLogger()),defaultLogger};var nullLogger=null;log4javascript.getNullLogger=function(){return nullLogger||(nullLogger=new Logger(nullLoggerName),nullLogger.setLevel(Level.OFF)),nullLogger},log4javascript.resetConfiguration=function(){rootLogger.setLevel(ROOT_LOGGER_DEFAULT_LEVEL),loggers={}};var LoggingEvent=function(logger,timeStamp,level,messages,exception){this.logger=logger,this.timeStamp=timeStamp,this.timeStampInMilliseconds=timeStamp.getTime(),this.timeStampInSeconds=Math.floor(this.timeStampInMilliseconds/1e3),this.milliseconds=this.timeStamp.getMilliseconds(),this.level=level,this.messages=messages,this.exception=exception};LoggingEvent.prototype={getThrowableStrRep:function(){return this.exception?getExceptionStringRep(this.exception):""},getCombinedMessages:function(){return 1==this.messages.length?this.messages[0]:this.messages.join(newLine)},toString:function(){return"LoggingEvent["+this.level+"]"}},log4javascript.LoggingEvent=LoggingEvent;var Layout=function(){};Layout.prototype={defaults:{loggerKey:"logger",timeStampKey:"timestamp",millisecondsKey:"milliseconds",levelKey:"level",messageKey:"message",exceptionKey:"exception",urlKey:"url"},loggerKey:"logger",timeStampKey:"timestamp",millisecondsKey:"milliseconds",levelKey:"level",messageKey:"message",exceptionKey:"exception",urlKey:"url",batchHeader:"",batchFooter:"",batchSeparator:"",returnsPostData:!1,overrideTimeStampsSetting:!1,useTimeStampsInMilliseconds:null,format:function(){handleError("Layout.format: layout supplied has no format() method")},ignoresThrowable:function(){handleError("Layout.ignoresThrowable: layout supplied has no ignoresThrowable() method")},getContentType:function(){return"text/plain"},allowBatching:function(){return!0},setTimeStampsInMilliseconds:function(timeStampsInMilliseconds){this.overrideTimeStampsSetting=!0,this.useTimeStampsInMilliseconds=bool(timeStampsInMilliseconds)},isTimeStampsInMilliseconds:function(){return this.overrideTimeStampsSetting?this.useTimeStampsInMilliseconds:useTimeStampsInMilliseconds},getTimeStampValue:function(loggingEvent){return this.isTimeStampsInMilliseconds()?loggingEvent.timeStampInMilliseconds:loggingEvent.timeStampInSeconds},getDataValues:function(loggingEvent,combineMessages){var dataValues=[[this.loggerKey,loggingEvent.logger.name],[this.timeStampKey,this.getTimeStampValue(loggingEvent)],[this.levelKey,loggingEvent.level.name],[this.urlKey,window.location.href],[this.messageKey,combineMessages?loggingEvent.getCombinedMessages():loggingEvent.messages]];if(this.isTimeStampsInMilliseconds()||dataValues.push([this.millisecondsKey,loggingEvent.milliseconds]),loggingEvent.exception&&dataValues.push([this.exceptionKey,getExceptionStringRep(loggingEvent.exception)]),this.hasCustomFields())for(var i=0,len=this.customFields.length;i<len;i++){var val=this.customFields[i].value;"function"==typeof val&&(val=val(this,loggingEvent)),dataValues.push([this.customFields[i].name,val])}return dataValues},setKeys:function(loggerKey,timeStampKey,levelKey,messageKey,exceptionKey,urlKey,millisecondsKey){this.loggerKey=extractStringFromParam(loggerKey,this.defaults.loggerKey),this.timeStampKey=extractStringFromParam(timeStampKey,this.defaults.timeStampKey),this.levelKey=extractStringFromParam(levelKey,this.defaults.levelKey),this.messageKey=extractStringFromParam(messageKey,this.defaults.messageKey),this.exceptionKey=extractStringFromParam(exceptionKey,this.defaults.exceptionKey),this.urlKey=extractStringFromParam(urlKey,this.defaults.urlKey),this.millisecondsKey=extractStringFromParam(millisecondsKey,this.defaults.millisecondsKey)},setCustomField:function(name,value){for(var fieldUpdated=!1,i=0,len=this.customFields.length;i<len;i++)this.customFields[i].name===name&&(this.customFields[i].value=value,fieldUpdated=!0);fieldUpdated||this.customFields.push({name:name,value:value})},hasCustomFields:function(){return this.customFields.length>0},formatWithException:function(loggingEvent){var formatted=this.format(loggingEvent);return loggingEvent.exception&&this.ignoresThrowable()&&(formatted+=loggingEvent.getThrowableStrRep()),formatted},toString:function(){handleError("Layout.toString: all layouts must override this method")}},log4javascript.Layout=Layout;var Appender=function(){};Appender.prototype=new EventSupport,Appender.prototype.layout=new PatternLayout,Appender.prototype.threshold=Level.ALL,Appender.prototype.loggers=[],Appender.prototype.doAppend=function(loggingEvent){enabled&&loggingEvent.level.level>=this.threshold.level&&this.append(loggingEvent)},Appender.prototype.append=function(loggingEvent){},Appender.prototype.setLayout=function(layout){layout instanceof Layout?this.layout=layout:handleError("Appender.setLayout: layout supplied to "+this.toString()+" is not a subclass of Layout")},Appender.prototype.getLayout=function(){return this.layout},Appender.prototype.setThreshold=function(threshold){threshold instanceof Level?this.threshold=threshold:handleError("Appender.setThreshold: threshold supplied to "+this.toString()+" is not a subclass of Level")},Appender.prototype.getThreshold=function(){return this.threshold},Appender.prototype.setAddedToLogger=function(logger){this.loggers.push(logger)},Appender.prototype.setRemovedFromLogger=function(logger){array_remove(this.loggers,logger)},Appender.prototype.group=emptyFunction,Appender.prototype.groupEnd=emptyFunction,Appender.prototype.toString=function(){handleError("Appender.toString: all appenders must override this method")},log4javascript.Appender=Appender,SimpleLayout.prototype=new Layout,SimpleLayout.prototype.format=function(loggingEvent){return loggingEvent.level.name+" - "+loggingEvent.getCombinedMessages()},SimpleLayout.prototype.ignoresThrowable=function(){return!0},SimpleLayout.prototype.toString=function(){return"SimpleLayout"},log4javascript.SimpleLayout=SimpleLayout,NullLayout.prototype=new Layout,NullLayout.prototype.format=function(loggingEvent){return loggingEvent.messages},NullLayout.prototype.ignoresThrowable=function(){return!0},NullLayout.prototype.formatWithException=function(loggingEvent){var messages=loggingEvent.messages,ex=loggingEvent.exception;return ex?messages.concat([ex]):messages},NullLayout.prototype.toString=function(){return"NullLayout"},log4javascript.NullLayout=NullLayout,XmlLayout.prototype=new Layout,XmlLayout.prototype.isCombinedMessages=function(){return this.combineMessages},XmlLayout.prototype.getContentType=function(){return"text/xml"},XmlLayout.prototype.escapeCdata=function(str){return str.replace(/\]\]>/,"]]>]]&gt;<![CDATA[")},XmlLayout.prototype.format=function(loggingEvent){function formatMessage(message){return message="string"==typeof message?message:toStr(message),"<log4javascript:message><![CDATA["+layout.escapeCdata(message)+"]]></log4javascript:message>"}var i,len,layout=this,str='<log4javascript:event logger="'+loggingEvent.logger.name+'" timestamp="'+this.getTimeStampValue(loggingEvent)+'"';if(this.isTimeStampsInMilliseconds()||(str+=' milliseconds="'+loggingEvent.milliseconds+'"'),str+=' level="'+loggingEvent.level.name+'">'+newLine,
this.combineMessages)str+=formatMessage(loggingEvent.getCombinedMessages());else{for(str+="<log4javascript:messages>"+newLine,i=0,len=loggingEvent.messages.length;i<len;i++)str+=formatMessage(loggingEvent.messages[i])+newLine;str+="</log4javascript:messages>"+newLine}if(this.hasCustomFields())for(i=0,len=this.customFields.length;i<len;i++)str+='<log4javascript:customfield name="'+this.customFields[i].name+'"><![CDATA['+this.customFields[i].value.toString()+"]]></log4javascript:customfield>"+newLine;return loggingEvent.exception&&(str+="<log4javascript:exception><![CDATA["+getExceptionStringRep(loggingEvent.exception)+"]]></log4javascript:exception>"+newLine),str+="</log4javascript:event>"+newLine+newLine},XmlLayout.prototype.ignoresThrowable=function(){return!1},XmlLayout.prototype.toString=function(){return"XmlLayout"},log4javascript.XmlLayout=XmlLayout,JsonLayout.prototype=new Layout,JsonLayout.prototype.isReadable=function(){return this.readable},JsonLayout.prototype.isCombinedMessages=function(){return this.combineMessages},JsonLayout.prototype.format=function(loggingEvent){function formatValue(val,prefix,expand){var formattedValue,valType=typeof val;if(val instanceof Date)formattedValue=String(val.getTime());else if(expand&&val instanceof Array){formattedValue="["+layout.lineBreak;for(var i=0,len=val.length;i<len;i++){var childPrefix=prefix+layout.tab;formattedValue+=childPrefix+formatValue(val[i],childPrefix,!1),i<val.length-1&&(formattedValue+=","),formattedValue+=layout.lineBreak}formattedValue+=prefix+"]"}else formattedValue="number"!==valType&&"boolean"!==valType?'"'+escapeNewLines(toStr(val).replace(/\"/g,'\\"'))+'"':val;return formattedValue}var i,len,layout=this,dataValues=this.getDataValues(loggingEvent,this.combineMessages),str="{"+this.lineBreak;for(i=0,len=dataValues.length-1;i<=len;i++)str+=this.tab+'"'+dataValues[i][0]+'"'+this.colon+formatValue(dataValues[i][1],this.tab,!0),i<len&&(str+=","),str+=this.lineBreak;return str+="}"+this.lineBreak},JsonLayout.prototype.ignoresThrowable=function(){return!1},JsonLayout.prototype.toString=function(){return"JsonLayout"},JsonLayout.prototype.getContentType=function(){return"application/json"},log4javascript.JsonLayout=JsonLayout,HttpPostDataLayout.prototype=new Layout,HttpPostDataLayout.prototype.allowBatching=function(){return!1},HttpPostDataLayout.prototype.format=function(loggingEvent){for(var dataValues=this.getDataValues(loggingEvent),queryBits=[],i=0,len=dataValues.length;i<len;i++){var val=dataValues[i][1]instanceof Date?String(dataValues[i][1].getTime()):dataValues[i][1];queryBits.push(urlEncode(dataValues[i][0])+"="+urlEncode(val))}return queryBits.join("&")},HttpPostDataLayout.prototype.ignoresThrowable=function(loggingEvent){return!1},HttpPostDataLayout.prototype.toString=function(){return"HttpPostDataLayout"},log4javascript.HttpPostDataLayout=HttpPostDataLayout;var SimpleDateFormat;!function(){var regex=/('[^']*')|(G+|y+|M+|w+|W+|D+|d+|F+|E+|a+|H+|k+|K+|h+|m+|s+|S+|Z+)|([a-zA-Z]+)|([^a-zA-Z']+)/,monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],TEXT2=0,TEXT3=1,NUMBER=2,YEAR=3,MONTH=4,TIMEZONE=5,types={G:TEXT2,y:YEAR,M:MONTH,w:NUMBER,W:NUMBER,D:NUMBER,d:NUMBER,F:NUMBER,E:TEXT3,a:TEXT2,H:NUMBER,k:NUMBER,K:NUMBER,h:NUMBER,m:NUMBER,s:NUMBER,S:NUMBER,Z:TIMEZONE},ONE_DAY=864e5,ONE_WEEK=7*ONE_DAY,DEFAULT_MINIMAL_DAYS_IN_FIRST_WEEK=1,newDateAtMidnight=function(year,month,day){var d=new Date(year,month,day,0,0,0);return d.setMilliseconds(0),d};Date.prototype.getDifference=function(date){return this.getTime()-date.getTime()},Date.prototype.isBefore=function(d){return this.getTime()<d.getTime()},Date.prototype.getUTCTime=function(){return Date.UTC(this.getFullYear(),this.getMonth(),this.getDate(),this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds())},Date.prototype.getTimeSince=function(d){return this.getUTCTime()-d.getUTCTime()},Date.prototype.getPreviousSunday=function(){var midday=new Date(this.getFullYear(),this.getMonth(),this.getDate(),12,0,0),previousSunday=new Date(midday.getTime()-this.getDay()*ONE_DAY);return newDateAtMidnight(previousSunday.getFullYear(),previousSunday.getMonth(),previousSunday.getDate())},Date.prototype.getWeekInYear=function(minimalDaysInFirstWeek){isUndefined(this.minimalDaysInFirstWeek)&&(minimalDaysInFirstWeek=DEFAULT_MINIMAL_DAYS_IN_FIRST_WEEK);var previousSunday=this.getPreviousSunday(),startOfYear=newDateAtMidnight(this.getFullYear(),0,1),numberOfSundays=previousSunday.isBefore(startOfYear)?0:1+Math.floor(previousSunday.getTimeSince(startOfYear)/ONE_WEEK),numberOfDaysInFirstWeek=7-startOfYear.getDay(),weekInYear=numberOfSundays;return numberOfDaysInFirstWeek<minimalDaysInFirstWeek&&weekInYear--,weekInYear},Date.prototype.getWeekInMonth=function(minimalDaysInFirstWeek){isUndefined(this.minimalDaysInFirstWeek)&&(minimalDaysInFirstWeek=DEFAULT_MINIMAL_DAYS_IN_FIRST_WEEK);var previousSunday=this.getPreviousSunday(),startOfMonth=newDateAtMidnight(this.getFullYear(),this.getMonth(),1),numberOfSundays=previousSunday.isBefore(startOfMonth)?0:1+Math.floor(previousSunday.getTimeSince(startOfMonth)/ONE_WEEK),numberOfDaysInFirstWeek=7-startOfMonth.getDay(),weekInMonth=numberOfSundays;return numberOfDaysInFirstWeek>=minimalDaysInFirstWeek&&weekInMonth++,weekInMonth},Date.prototype.getDayInYear=function(){var startOfYear=newDateAtMidnight(this.getFullYear(),0,1);return 1+Math.floor(this.getTimeSince(startOfYear)/ONE_DAY)},SimpleDateFormat=function(formatString){this.formatString=formatString},SimpleDateFormat.prototype.setMinimalDaysInFirstWeek=function(days){this.minimalDaysInFirstWeek=days},SimpleDateFormat.prototype.getMinimalDaysInFirstWeek=function(){return isUndefined(this.minimalDaysInFirstWeek)?DEFAULT_MINIMAL_DAYS_IN_FIRST_WEEK:this.minimalDaysInFirstWeek};var padWithZeroes=function(str,len){for(;str.length<len;)str="0"+str;return str},formatText=function(data,numberOfLetters,minLength){return numberOfLetters>=4?data:data.substr(0,Math.max(minLength,numberOfLetters))},formatNumber=function(data,numberOfLetters){var dataString=""+data;return padWithZeroes(dataString,numberOfLetters)};SimpleDateFormat.prototype.format=function(date){for(var result,formattedString="",searchString=this.formatString;result=regex.exec(searchString);){var quotedString=result[1],patternLetters=result[2],otherLetters=result[3],otherCharacters=result[4];if(quotedString)formattedString+="''"==quotedString?"'":quotedString.substring(1,quotedString.length-1);else if(otherLetters);else if(otherCharacters)formattedString+=otherCharacters;else if(patternLetters){var patternLetter=patternLetters.charAt(0),numberOfLetters=patternLetters.length,rawData="";switch(patternLetter){case"G":rawData="AD";break;case"y":rawData=date.getFullYear();break;case"M":rawData=date.getMonth();break;case"w":rawData=date.getWeekInYear(this.getMinimalDaysInFirstWeek());break;case"W":rawData=date.getWeekInMonth(this.getMinimalDaysInFirstWeek());break;case"D":rawData=date.getDayInYear();break;case"d":rawData=date.getDate();break;case"F":rawData=1+Math.floor((date.getDate()-1)/7);break;case"E":rawData=dayNames[date.getDay()];break;case"a":rawData=date.getHours()>=12?"PM":"AM";break;case"H":rawData=date.getHours();break;case"k":rawData=date.getHours()||24;break;case"K":rawData=date.getHours()%12;break;case"h":rawData=date.getHours()%12||12;break;case"m":rawData=date.getMinutes();break;case"s":rawData=date.getSeconds();break;case"S":rawData=date.getMilliseconds();break;case"Z":rawData=date.getTimezoneOffset()}switch(types[patternLetter]){case TEXT2:formattedString+=formatText(rawData,numberOfLetters,2);break;case TEXT3:formattedString+=formatText(rawData,numberOfLetters,3);break;case NUMBER:formattedString+=formatNumber(rawData,numberOfLetters);break;case YEAR:if(numberOfLetters<=3){var dataString=""+rawData;formattedString+=dataString.substr(2,2)}else formattedString+=formatNumber(rawData,numberOfLetters);break;case MONTH:formattedString+=numberOfLetters>=3?formatText(monthNames[rawData],numberOfLetters,numberOfLetters):formatNumber(rawData+1,numberOfLetters);break;case TIMEZONE:var isPositive=rawData>0,prefix=isPositive?"-":"+",absData=Math.abs(rawData),hours=""+Math.floor(absData/60);hours=padWithZeroes(hours,2);var minutes=""+absData%60;minutes=padWithZeroes(minutes,2),formattedString+=prefix+hours+minutes}}searchString=searchString.substr(result.index+result[0].length)}return formattedString}}(),log4javascript.SimpleDateFormat=SimpleDateFormat,PatternLayout.TTCC_CONVERSION_PATTERN="%r %p %c - %m%n",PatternLayout.DEFAULT_CONVERSION_PATTERN="%m%n",PatternLayout.ISO8601_DATEFORMAT="yyyy-MM-dd HH:mm:ss,SSS",PatternLayout.DATETIME_DATEFORMAT="dd MMM yyyy HH:mm:ss,SSS",PatternLayout.ABSOLUTETIME_DATEFORMAT="HH:mm:ss,SSS",PatternLayout.prototype=new Layout,PatternLayout.prototype.format=function(loggingEvent){for(var result,regex=/%(-?[0-9]+)?(\.?[0-9]+)?([acdfmMnpr%])(\{([^\}]+)\})?|([^%]+)/,formattedString="",searchString=this.pattern;result=regex.exec(searchString);){var matchedString=result[0],padding=result[1],truncation=result[2],conversionCharacter=result[3],specifier=result[5],text=result[6];if(text)formattedString+=""+text;else{var replacement="";switch(conversionCharacter){case"a":case"m":var depth=0;specifier&&(depth=parseInt(specifier,10),isNaN(depth)&&(handleError("PatternLayout.format: invalid specifier '"+specifier+"' for conversion character '"+conversionCharacter+"' - should be a number"),depth=0));for(var messages="a"===conversionCharacter?loggingEvent.messages[0]:loggingEvent.messages,i=0,len=messages.length;i<len;i++)i>0&&" "!==replacement.charAt(replacement.length-1)&&(replacement+=" "),replacement+=0===depth?messages[i]:formatObjectExpansion(messages[i],depth);break;case"c":var loggerName=loggingEvent.logger.name;if(specifier){var precision=parseInt(specifier,10),loggerNameBits=loggingEvent.logger.name.split(".");replacement=precision>=loggerNameBits.length?loggerName:loggerNameBits.slice(loggerNameBits.length-precision).join(".")}else replacement=loggerName;break;case"d":var dateFormat=PatternLayout.ISO8601_DATEFORMAT;specifier&&(dateFormat=specifier,"ISO8601"==dateFormat?dateFormat=PatternLayout.ISO8601_DATEFORMAT:"ABSOLUTE"==dateFormat?dateFormat=PatternLayout.ABSOLUTETIME_DATEFORMAT:"DATE"==dateFormat&&(dateFormat=PatternLayout.DATETIME_DATEFORMAT)),replacement=new SimpleDateFormat(dateFormat).format(loggingEvent.timeStamp);break;case"f":if(this.hasCustomFields()){var fieldIndex=0;specifier&&(fieldIndex=parseInt(specifier,10),isNaN(fieldIndex)?handleError("PatternLayout.format: invalid specifier '"+specifier+"' for conversion character 'f' - should be a number"):0===fieldIndex?handleError("PatternLayout.format: invalid specifier '"+specifier+"' for conversion character 'f' - must be greater than zero"):fieldIndex>this.customFields.length?handleError("PatternLayout.format: invalid specifier '"+specifier+"' for conversion character 'f' - there aren't that many custom fields"):fieldIndex-=1);var val=this.customFields[fieldIndex].value;"function"==typeof val&&(val=val(this,loggingEvent)),replacement=val}break;case"n":replacement=newLine;break;case"p":replacement=loggingEvent.level.name;break;case"r":replacement=""+loggingEvent.timeStamp.getDifference(applicationStartDate);break;case"%":replacement="%";break;default:replacement=matchedString}var l;if(truncation){l=parseInt(truncation.substr(1),10);var strLen=replacement.length;l<strLen&&(replacement=replacement.substring(strLen-l,strLen))}if(padding)if("-"==padding.charAt(0))for(l=parseInt(padding.substr(1),10);replacement.length<l;)replacement+=" ";else for(l=parseInt(padding,10);replacement.length<l;)replacement=" "+replacement;formattedString+=replacement}searchString=searchString.substr(result.index+result[0].length)}return formattedString},PatternLayout.prototype.ignoresThrowable=function(){return!0},PatternLayout.prototype.toString=function(){return"PatternLayout"},log4javascript.PatternLayout=PatternLayout,AlertAppender.prototype=new Appender,AlertAppender.prototype.layout=new SimpleLayout,AlertAppender.prototype.append=function(loggingEvent){alert(this.getLayout().formatWithException(loggingEvent))},AlertAppender.prototype.toString=function(){return"AlertAppender"},log4javascript.AlertAppender=AlertAppender,BrowserConsoleAppender.prototype=new log4javascript.Appender,BrowserConsoleAppender.prototype.layout=new NullLayout,BrowserConsoleAppender.prototype.threshold=Level.DEBUG,BrowserConsoleAppender.prototype.append=function(loggingEvent){var appender=this,getFormattedMessage=function(concatenate){var formattedMessage=appender.getLayout().formatWithException(loggingEvent);return"string"==typeof formattedMessage?concatenate?formattedMessage:[formattedMessage]:concatenate?formattedMessage.join(" "):formattedMessage},console=window.console;if(console&&console.log){var consoleMethodName;consoleMethodName=console.debug&&Level.DEBUG.isGreaterOrEqual(loggingEvent.level)?"debug":console.info&&Level.INFO.equals(loggingEvent.level)?"info":console.warn&&Level.WARN.equals(loggingEvent.level)?"warn":console.error&&loggingEvent.level.isGreaterOrEqual(Level.ERROR)?"error":"log","function"==typeof console[consoleMethodName].apply?console[consoleMethodName].apply(console,getFormattedMessage(!1)):console[consoleMethodName](getFormattedMessage(!0))}else"undefined"!=typeof opera&&opera.postError&&opera.postError(getFormattedMessage(!0))},BrowserConsoleAppender.prototype.group=function(name){window.console&&window.console.group&&window.console.group(name)},BrowserConsoleAppender.prototype.groupEnd=function(){window.console&&window.console.groupEnd&&window.console.groupEnd()},BrowserConsoleAppender.prototype.toString=function(){return"BrowserConsoleAppender"},log4javascript.BrowserConsoleAppender=BrowserConsoleAppender;var xhrFactory=function(){return new XMLHttpRequest},xmlHttpFactories=[xhrFactory,function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],withCredentialsSupported=!1,getXmlHttp=function(errorHandler){for(var factory,xmlHttp=null,i=0,len=xmlHttpFactories.length;i<len;i++){factory=xmlHttpFactories[i];try{return xmlHttp=factory(),withCredentialsSupported=factory==xhrFactory&&"withCredentials"in xmlHttp,getXmlHttp=factory,xmlHttp}catch(e){}}errorHandler?errorHandler():handleError("getXmlHttp: unable to obtain XMLHttpRequest object")};AjaxAppender.prototype=new Appender,AjaxAppender.prototype.defaults={waitForResponse:!1,timed:!1,timerInterval:1e3,batchSize:1,sendAllOnUnload:!1,requestSuccessCallback:null,failCallback:null,postVarName:"data",contentType:"application/x-www-form-urlencoded"},AjaxAppender.prototype.layout=new HttpPostDataLayout,AjaxAppender.prototype.toString=function(){return"AjaxAppender"},log4javascript.AjaxAppender=AjaxAppender;var ConsoleAppender;if(function(){function PopUpAppender(lazyInit,initiallyMinimized,useDocumentWrite,width,height){this.create(!1,null,lazyInit,initiallyMinimized,useDocumentWrite,width,height,this.defaults.focusPopUp)}function InPageAppender(container,lazyInit,initiallyMinimized,useDocumentWrite,width,height){this.create(!0,container,lazyInit,initiallyMinimized,useDocumentWrite,width,height,!1)}var getConsoleHtmlLines=function(){return['<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">','<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">',"<head>","<title>log4javascript</title>",'<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />',"<!-- Make IE8 behave like IE7, having gone to all the trouble of making IE work -->",'<meta http-equiv="X-UA-Compatible" content="IE=7" />','<script type="text/javascript">var isIe = false, isIePre7 = false;</script>','<!--[if IE]><script type="text/javascript">isIe = true</script><![endif]-->','<!--[if lt IE 7]><script type="text/javascript">isIePre7 = true</script><![endif]-->','<script type="text/javascript">',"//<![CDATA[","var loggingEnabled=true;var logQueuedEventsTimer=null;var logEntries=[];var logEntriesAndSeparators=[];var logItems=[];var renderDelay=100;var unrenderedLogItemsExist=false;var rootGroup,currentGroup=null;var loaded=false;var currentLogItem=null;var logMainContainer;function copyProperties(obj,props){for(var i in props){obj[i]=props[i];}}","function LogItem(){}","LogItem.prototype={mainContainer:null,wrappedContainer:null,unwrappedContainer:null,group:null,appendToLog:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].appendToLog();}","this.group.update();},doRemove:function(doUpdate,removeFromGroup){if(this.rendered){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].remove();}","this.unwrappedElementContainer=null;this.wrappedElementContainer=null;this.mainElementContainer=null;}","if(this.group&&removeFromGroup){this.group.removeChild(this,doUpdate);}","if(this===currentLogItem){currentLogItem=null;}},remove:function(doUpdate,removeFromGroup){this.doRemove(doUpdate,removeFromGroup);},render:function(){},accept:function(visitor){visitor.visit(this);},getUnwrappedDomContainer:function(){return this.group.unwrappedElementContainer.contentDiv;},getWrappedDomContainer:function(){return this.group.wrappedElementContainer.contentDiv;},getMainDomContainer:function(){return this.group.mainElementContainer.contentDiv;}};LogItem.serializedItemKeys={LOG_ENTRY:0,GROUP_START:1,GROUP_END:2};function LogItemContainerElement(){}",'LogItemContainerElement.prototype={appendToLog:function(){var insertBeforeFirst=(newestAtTop&&this.containerDomNode.hasChildNodes());if(insertBeforeFirst){this.containerDomNode.insertBefore(this.mainDiv,this.containerDomNode.firstChild);}else{this.containerDomNode.appendChild(this.mainDiv);}}};function SeparatorElementContainer(containerDomNode){this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="separator";this.mainDiv.innerHTML="&nbsp;";}',"SeparatorElementContainer.prototype=new LogItemContainerElement();SeparatorElementContainer.prototype.remove=function(){this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;};function Separator(){this.rendered=false;}","Separator.prototype=new LogItem();copyProperties(Separator.prototype,{render:function(){var containerDomNode=this.group.contentDiv;if(isIe){this.unwrappedElementContainer=new SeparatorElementContainer(this.getUnwrappedDomContainer());this.wrappedElementContainer=new SeparatorElementContainer(this.getWrappedDomContainer());this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{this.mainElementContainer=new SeparatorElementContainer(this.getMainDomContainer());this.elementContainers=[this.mainElementContainer];}",'this.content=this.formattedMessage;this.rendered=true;}});function GroupElementContainer(group,containerDomNode,isRoot,isWrapped){this.group=group;this.containerDomNode=containerDomNode;this.isRoot=isRoot;this.isWrapped=isWrapped;this.expandable=false;if(this.isRoot){if(isIe){this.contentDiv=logMainContainer.appendChild(document.createElement("div"));this.contentDiv.id=this.isWrapped?"log_wrapped":"log_unwrapped";}else{this.contentDiv=logMainContainer;}}else{var groupElementContainer=this;this.mainDiv=document.createElement("div");this.mainDiv.className="group";this.headingDiv=this.mainDiv.appendChild(document.createElement("div"));this.headingDiv.className="groupheading";this.expander=this.headingDiv.appendChild(document.createElement("span"));this.expander.className="expander unselectable greyedout";this.expander.unselectable=true;var expanderText=this.group.expanded?"-":"+";this.expanderTextNode=this.expander.appendChild(document.createTextNode(expanderText));this.headingDiv.appendChild(document.createTextNode(" "+this.group.name));this.contentDiv=this.mainDiv.appendChild(document.createElement("div"));var contentCssClass=this.group.expanded?"expanded":"collapsed";this.contentDiv.className="groupcontent "+contentCssClass;this.expander.onclick=function(){if(groupElementContainer.group.expandable){groupElementContainer.group.toggleExpanded();}};}}','GroupElementContainer.prototype=new LogItemContainerElement();copyProperties(GroupElementContainer.prototype,{toggleExpanded:function(){if(!this.isRoot){var oldCssClass,newCssClass,expanderText;if(this.group.expanded){newCssClass="expanded";oldCssClass="collapsed";expanderText="-";}else{newCssClass="collapsed";oldCssClass="expanded";expanderText="+";}',"replaceClass(this.contentDiv,newCssClass,oldCssClass);this.expanderTextNode.nodeValue=expanderText;}},remove:function(){if(!this.isRoot){this.headingDiv=null;this.expander.onclick=null;this.expander=null;this.expanderTextNode=null;this.contentDiv=null;this.containerDomNode=null;this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;}},reverseChildren:function(){var node=null;var childDomNodes=[];while((node=this.contentDiv.firstChild)){this.contentDiv.removeChild(node);childDomNodes.push(node);}",'while((node=childDomNodes.pop())){this.contentDiv.appendChild(node);}},update:function(){if(!this.isRoot){if(this.group.expandable){removeClass(this.expander,"greyedout");}else{addClass(this.expander,"greyedout");}}},clear:function(){if(this.isRoot){this.contentDiv.innerHTML="";}}});function Group(name,isRoot,initiallyExpanded){this.name=name;this.group=null;this.isRoot=isRoot;this.initiallyExpanded=initiallyExpanded;this.elementContainers=[];this.children=[];this.expanded=initiallyExpanded;this.rendered=false;this.expandable=false;}',"Group.prototype=new LogItem();copyProperties(Group.prototype,{addChild:function(logItem){this.children.push(logItem);logItem.group=this;},render:function(){if(isIe){var unwrappedDomContainer,wrappedDomContainer;if(this.isRoot){unwrappedDomContainer=logMainContainer;wrappedDomContainer=logMainContainer;}else{unwrappedDomContainer=this.getUnwrappedDomContainer();wrappedDomContainer=this.getWrappedDomContainer();}","this.unwrappedElementContainer=new GroupElementContainer(this,unwrappedDomContainer,this.isRoot,false);this.wrappedElementContainer=new GroupElementContainer(this,wrappedDomContainer,this.isRoot,true);this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{var mainDomContainer=this.isRoot?logMainContainer:this.getMainDomContainer();this.mainElementContainer=new GroupElementContainer(this,mainDomContainer,this.isRoot,false);this.elementContainers=[this.mainElementContainer];}","this.rendered=true;},toggleExpanded:function(){this.expanded=!this.expanded;for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].toggleExpanded();}},expand:function(){if(!this.expanded){this.toggleExpanded();}},accept:function(visitor){visitor.visitGroup(this);},reverseChildren:function(){if(this.rendered){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].reverseChildren();}}},update:function(){var previouslyExpandable=this.expandable;this.expandable=(this.children.length!==0);if(this.expandable!==previouslyExpandable){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].update();}}},flatten:function(){var visitor=new GroupFlattener();this.accept(visitor);return visitor.logEntriesAndSeparators;},removeChild:function(child,doUpdate){array_remove(this.children,child);child.group=null;if(doUpdate){this.update();}},remove:function(doUpdate,removeFromGroup){for(var i=0,len=this.children.length;i<len;i++){this.children[i].remove(false,false);}","this.children=[];this.update();if(this===currentGroup){currentGroup=this.group;}","this.doRemove(doUpdate,removeFromGroup);},serialize:function(items){items.push([LogItem.serializedItemKeys.GROUP_START,this.name]);for(var i=0,len=this.children.length;i<len;i++){this.children[i].serialize(items);}","if(this!==currentGroup){items.push([LogItem.serializedItemKeys.GROUP_END]);}},clear:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].clear();}}});function LogEntryElementContainer(){}",'LogEntryElementContainer.prototype=new LogItemContainerElement();copyProperties(LogEntryElementContainer.prototype,{remove:function(){this.doRemove();},doRemove:function(){this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;this.contentElement=null;this.containerDomNode=null;},setContent:function(content,wrappedContent){if(content===this.formattedMessage){this.contentElement.innerHTML="";this.contentElement.appendChild(document.createTextNode(this.formattedMessage));}else{this.contentElement.innerHTML=content;}},setSearchMatch:function(isMatch){var oldCssClass=isMatch?"searchnonmatch":"searchmatch";var newCssClass=isMatch?"searchmatch":"searchnonmatch";replaceClass(this.mainDiv,newCssClass,oldCssClass);},clearSearch:function(){removeClass(this.mainDiv,"searchmatch");removeClass(this.mainDiv,"searchnonmatch");}});function LogEntryWrappedElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.appendChild(document.createTextNode(this.logEntry.formattedMessage));this.mainDiv.className="logentry wrapped "+this.logEntry.level;this.contentElement=this.mainDiv;}','LogEntryWrappedElementContainer.prototype=new LogEntryElementContainer();LogEntryWrappedElementContainer.prototype.setContent=function(content,wrappedContent){if(content===this.formattedMessage){this.contentElement.innerHTML="";this.contentElement.appendChild(document.createTextNode(this.formattedMessage));}else{this.contentElement.innerHTML=wrappedContent;}};function LogEntryUnwrappedElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="logentry unwrapped "+this.logEntry.level;this.pre=this.mainDiv.appendChild(document.createElement("pre"));this.pre.appendChild(document.createTextNode(this.logEntry.formattedMessage));this.pre.className="unwrapped";this.contentElement=this.pre;}','LogEntryUnwrappedElementContainer.prototype=new LogEntryElementContainer();LogEntryUnwrappedElementContainer.prototype.remove=function(){this.doRemove();this.pre=null;};function LogEntryMainElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="logentry nonielogentry "+this.logEntry.level;this.contentElement=this.mainDiv.appendChild(document.createElement("span"));this.contentElement.appendChild(document.createTextNode(this.logEntry.formattedMessage));}',"LogEntryMainElementContainer.prototype=new LogEntryElementContainer();function LogEntry(level,formattedMessage){this.level=level;this.formattedMessage=formattedMessage;this.rendered=false;}",'LogEntry.prototype=new LogItem();copyProperties(LogEntry.prototype,{render:function(){var logEntry=this;var containerDomNode=this.group.contentDiv;if(isIe){this.formattedMessage=this.formattedMessage.replace(/\\r\\n/g,"\\r");this.unwrappedElementContainer=new LogEntryUnwrappedElementContainer(this,this.getUnwrappedDomContainer());this.wrappedElementContainer=new LogEntryWrappedElementContainer(this,this.getWrappedDomContainer());this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{this.mainElementContainer=new LogEntryMainElementContainer(this,this.getMainDomContainer());this.elementContainers=[this.mainElementContainer];}','this.content=this.formattedMessage;this.rendered=true;},setContent:function(content,wrappedContent){if(content!=this.content){if(isIe&&(content!==this.formattedMessage)){content=content.replace(/\\r\\n/g,"\\r");}',"for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].setContent(content,wrappedContent);}",'this.content=content;}},getSearchMatches:function(){var matches=[];var i,len;if(isIe){var unwrappedEls=getElementsByClass(this.unwrappedElementContainer.mainDiv,"searchterm","span");var wrappedEls=getElementsByClass(this.wrappedElementContainer.mainDiv,"searchterm","span");for(i=0,len=unwrappedEls.length;i<len;i++){matches[i]=new Match(this.level,null,unwrappedEls[i],wrappedEls[i]);}}else{var els=getElementsByClass(this.mainElementContainer.mainDiv,"searchterm","span");for(i=0,len=els.length;i<len;i++){matches[i]=new Match(this.level,els[i]);}}',"return matches;},setSearchMatch:function(isMatch){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].setSearchMatch(isMatch);}},clearSearch:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].clearSearch();}},accept:function(visitor){visitor.visitLogEntry(this);},serialize:function(items){items.push([LogItem.serializedItemKeys.LOG_ENTRY,this.level,this.formattedMessage]);}});function LogItemVisitor(){}","LogItemVisitor.prototype={visit:function(logItem){},visitParent:function(logItem){if(logItem.group){logItem.group.accept(this);}},visitChildren:function(logItem){for(var i=0,len=logItem.children.length;i<len;i++){logItem.children[i].accept(this);}},visitLogEntry:function(logEntry){this.visit(logEntry);},visitSeparator:function(separator){this.visit(separator);},visitGroup:function(group){this.visit(group);}};function GroupFlattener(){this.logEntriesAndSeparators=[];}",'GroupFlattener.prototype=new LogItemVisitor();GroupFlattener.prototype.visitGroup=function(group){this.visitChildren(group);};GroupFlattener.prototype.visitLogEntry=function(logEntry){this.logEntriesAndSeparators.push(logEntry);};GroupFlattener.prototype.visitSeparator=function(separator){this.logEntriesAndSeparators.push(separator);};window.onload=function(){if(location.search){var queryBits=unescape(location.search).substr(1).split("&"),nameValueBits;for(var i=0,len=queryBits.length;i<len;i++){nameValueBits=queryBits[i].split("=");if(nameValueBits[0]=="log4javascript_domain"){document.domain=nameValueBits[1];break;}}}','logMainContainer=$("log");if(isIePre7){addClass(logMainContainer,"oldIe");}','rootGroup=new Group("root",true);rootGroup.render();currentGroup=rootGroup;setCommandInputWidth();setLogContainerHeight();toggleLoggingEnabled();toggleSearchEnabled();toggleSearchFilter();toggleSearchHighlight();applyFilters();checkAllLevels();toggleWrap();toggleNewestAtTop();toggleScrollToLatest();renderQueuedLogItems();loaded=true;$("command").value="";$("command").autocomplete="off";$("command").onkeydown=function(evt){evt=getEvent(evt);if(evt.keyCode==10||evt.keyCode==13){evalCommandLine();stopPropagation(evt);}else if(evt.keyCode==27){this.value="";this.focus();}else if(evt.keyCode==38&&commandHistory.length>0){currentCommandIndex=Math.max(0,currentCommandIndex-1);this.value=commandHistory[currentCommandIndex];moveCaretToEnd(this);}else if(evt.keyCode==40&&commandHistory.length>0){currentCommandIndex=Math.min(commandHistory.length-1,currentCommandIndex+1);this.value=commandHistory[currentCommandIndex];moveCaretToEnd(this);}};$("command").onkeypress=function(evt){evt=getEvent(evt);if(evt.keyCode==38&&commandHistory.length>0&&evt.preventDefault){evt.preventDefault();}};$("command").onkeyup=function(evt){evt=getEvent(evt);if(evt.keyCode==27&&evt.preventDefault){evt.preventDefault();this.focus();}};document.onkeydown=function keyEventHandler(evt){evt=getEvent(evt);switch(evt.keyCode){case 69:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){evalLastCommand();cancelKeyEvent(evt);return false;}',"break;case 75:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){focusSearch();cancelKeyEvent(evt);return false;}","break;case 40:case 76:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){focusCommandLine();cancelKeyEvent(evt);return false;}","break;}};setTimeout(setLogContainerHeight,20);setShowCommandLine(showCommandLine);doSearch();};window.onunload=function(){if(mainWindowExists()){appender.unload();}",'appender=null;};function toggleLoggingEnabled(){setLoggingEnabled($("enableLogging").checked);}',"function setLoggingEnabled(enable){loggingEnabled=enable;}","var appender=null;function setAppender(appenderParam){appender=appenderParam;}",'function setShowCloseButton(showCloseButton){$("closeButton").style.display=showCloseButton?"inline":"none";}','function setShowHideButton(showHideButton){$("hideButton").style.display=showHideButton?"inline":"none";}',"var newestAtTop=false;function LogItemContentReverser(){}","LogItemContentReverser.prototype=new LogItemVisitor();LogItemContentReverser.prototype.visitGroup=function(group){group.reverseChildren();this.visitChildren(group);};function setNewestAtTop(isNewestAtTop){var oldNewestAtTop=newestAtTop;var i,iLen,j,jLen;newestAtTop=Boolean(isNewestAtTop);if(oldNewestAtTop!=newestAtTop){var visitor=new LogItemContentReverser();rootGroup.accept(visitor);if(currentSearch){var currentMatch=currentSearch.matches[currentMatchIndex];var matchIndex=0;var matches=[];var actOnLogEntry=function(logEntry){var logEntryMatches=logEntry.getSearchMatches();for(j=0,jLen=logEntryMatches.length;j<jLen;j++){matches[matchIndex]=logEntryMatches[j];if(currentMatch&&logEntryMatches[j].equals(currentMatch)){currentMatchIndex=matchIndex;}","matchIndex++;}};if(newestAtTop){for(i=logEntries.length-1;i>=0;i--){actOnLogEntry(logEntries[i]);}}else{for(i=0,iLen=logEntries.length;i<iLen;i++){actOnLogEntry(logEntries[i]);}}","currentSearch.matches=matches;if(currentMatch){currentMatch.setCurrent();}}else if(scrollToLatest){doScrollToLatest();}}",'$("newestAtTop").checked=isNewestAtTop;}','function toggleNewestAtTop(){var isNewestAtTop=$("newestAtTop").checked;setNewestAtTop(isNewestAtTop);}',"var scrollToLatest=true;function setScrollToLatest(isScrollToLatest){scrollToLatest=isScrollToLatest;if(scrollToLatest){doScrollToLatest();}",'$("scrollToLatest").checked=isScrollToLatest;}','function toggleScrollToLatest(){var isScrollToLatest=$("scrollToLatest").checked;setScrollToLatest(isScrollToLatest);}','function doScrollToLatest(){var l=logMainContainer;if(typeof l.scrollTop!="undefined"){if(newestAtTop){l.scrollTop=0;}else{var latestLogEntry=l.lastChild;if(latestLogEntry){l.scrollTop=l.scrollHeight;}}}}',"var closeIfOpenerCloses=true;function setCloseIfOpenerCloses(isCloseIfOpenerCloses){closeIfOpenerCloses=isCloseIfOpenerCloses;}","var maxMessages=null;function setMaxMessages(max){maxMessages=max;pruneLogEntries();}",'var showCommandLine=false;function setShowCommandLine(isShowCommandLine){showCommandLine=isShowCommandLine;if(loaded){$("commandLine").style.display=showCommandLine?"block":"none";setCommandInputWidth();setLogContainerHeight();}}','function focusCommandLine(){if(loaded){$("command").focus();}}','function focusSearch(){if(loaded){$("searchBox").focus();}}',"function getLogItems(){var items=[];for(var i=0,len=logItems.length;i<len;i++){logItems[i].serialize(items);}","return items;}","function setLogItems(items){var loggingReallyEnabled=loggingEnabled;loggingEnabled=true;for(var i=0,len=items.length;i<len;i++){switch(items[i][0]){case LogItem.serializedItemKeys.LOG_ENTRY:log(items[i][1],items[i][2]);break;case LogItem.serializedItemKeys.GROUP_START:group(items[i][1]);break;case LogItem.serializedItemKeys.GROUP_END:groupEnd();break;}}","loggingEnabled=loggingReallyEnabled;}","function log(logLevel,formattedMessage){if(loggingEnabled){var logEntry=new LogEntry(logLevel,formattedMessage);logEntries.push(logEntry);logEntriesAndSeparators.push(logEntry);logItems.push(logEntry);currentGroup.addChild(logEntry);if(loaded){if(logQueuedEventsTimer!==null){clearTimeout(logQueuedEventsTimer);}","logQueuedEventsTimer=setTimeout(renderQueuedLogItems,renderDelay);unrenderedLogItemsExist=true;}}}","function renderQueuedLogItems(){logQueuedEventsTimer=null;var pruned=pruneLogEntries();var initiallyHasMatches=currentSearch?currentSearch.hasMatches():false;for(var i=0,len=logItems.length;i<len;i++){if(!logItems[i].rendered){logItems[i].render();logItems[i].appendToLog();if(currentSearch&&(logItems[i]instanceof LogEntry)){currentSearch.applyTo(logItems[i]);}}}","if(currentSearch){if(pruned){if(currentSearch.hasVisibleMatches()){if(currentMatchIndex===null){setCurrentMatchIndex(0);}","displayMatches();}else{displayNoMatches();}}else if(!initiallyHasMatches&&currentSearch.hasVisibleMatches()){setCurrentMatchIndex(0);displayMatches();}}","if(scrollToLatest){doScrollToLatest();}","unrenderedLogItemsExist=false;}","function pruneLogEntries(){if((maxMessages!==null)&&(logEntriesAndSeparators.length>maxMessages)){var numberToDelete=logEntriesAndSeparators.length-maxMessages;var prunedLogEntries=logEntriesAndSeparators.slice(0,numberToDelete);if(currentSearch){currentSearch.removeMatches(prunedLogEntries);}","var group;for(var i=0;i<numberToDelete;i++){group=logEntriesAndSeparators[i].group;array_remove(logItems,logEntriesAndSeparators[i]);array_remove(logEntries,logEntriesAndSeparators[i]);logEntriesAndSeparators[i].remove(true,true);if(group.children.length===0&&group!==currentGroup&&group!==rootGroup){array_remove(logItems,group);group.remove(true,true);}}","logEntriesAndSeparators=array_removeFromStart(logEntriesAndSeparators,numberToDelete);return true;}","return false;}",'function group(name,startExpanded){if(loggingEnabled){initiallyExpanded=(typeof startExpanded==="undefined")?true:Boolean(startExpanded);var newGroup=new Group(name,false,initiallyExpanded);currentGroup.addChild(newGroup);currentGroup=newGroup;logItems.push(newGroup);if(loaded){if(logQueuedEventsTimer!==null){clearTimeout(logQueuedEventsTimer);}',"logQueuedEventsTimer=setTimeout(renderQueuedLogItems,renderDelay);unrenderedLogItemsExist=true;}}}","function groupEnd(){currentGroup=(currentGroup===rootGroup)?rootGroup:currentGroup.group;}","function mainPageReloaded(){currentGroup=rootGroup;var separator=new Separator();logEntriesAndSeparators.push(separator);logItems.push(separator);currentGroup.addChild(separator);}","function closeWindow(){if(appender&&mainWindowExists()){appender.close(true);}else{window.close();}}","function hide(){if(appender&&mainWindowExists()){appender.hide();}}",'var mainWindow=window;var windowId="log4javascriptConsoleWindow_"+new Date().getTime()+"_"+(""+Math.random()).substr(2);function setMainWindow(win){mainWindow=win;mainWindow[windowId]=window;if(opener&&closeIfOpenerCloses){pollOpener();}}',"function pollOpener(){if(closeIfOpenerCloses){if(mainWindowExists()){setTimeout(pollOpener,500);}else{closeWindow();}}}","function mainWindowExists(){try{return(mainWindow&&!mainWindow.closed&&mainWindow[windowId]==window);}catch(ex){}","return false;}",'var logLevels=["TRACE","DEBUG","INFO","WARN","ERROR","FATAL"];function getCheckBox(logLevel){return $("switch_"+logLevel);}','function getIeWrappedLogContainer(){return $("log_wrapped");}','function getIeUnwrappedLogContainer(){return $("log_unwrapped");}',"function applyFilters(){for(var i=0;i<logLevels.length;i++){if(getCheckBox(logLevels[i]).checked){addClass(logMainContainer,logLevels[i]);}else{removeClass(logMainContainer,logLevels[i]);}}","updateSearchFromFilters();}",'function toggleAllLevels(){var turnOn=$("switch_ALL").checked;for(var i=0;i<logLevels.length;i++){getCheckBox(logLevels[i]).checked=turnOn;if(turnOn){addClass(logMainContainer,logLevels[i]);}else{removeClass(logMainContainer,logLevels[i]);}}}','function checkAllLevels(){for(var i=0;i<logLevels.length;i++){if(!getCheckBox(logLevels[i]).checked){getCheckBox("ALL").checked=false;return;}}','getCheckBox("ALL").checked=true;}',"function clearLog(){rootGroup.clear();currentGroup=rootGroup;logEntries=[];logItems=[];logEntriesAndSeparators=[];doSearch();}",'function toggleWrap(){var enable=$("wrap").checked;if(enable){addClass(logMainContainer,"wrap");}else{removeClass(logMainContainer,"wrap");}',"refreshCurrentMatch();}","var searchTimer=null;function scheduleSearch(){try{clearTimeout(searchTimer);}catch(ex){}","searchTimer=setTimeout(doSearch,500);}","function Search(searchTerm,isRegex,searchRegex,isCaseSensitive){this.searchTerm=searchTerm;this.isRegex=isRegex;this.searchRegex=searchRegex;this.isCaseSensitive=isCaseSensitive;this.matches=[];}","Search.prototype={hasMatches:function(){return this.matches.length>0;},hasVisibleMatches:function(){if(this.hasMatches()){for(var i=0;i<this.matches.length;i++){if(this.matches[i].isVisible()){return true;}}}","return false;},match:function(logEntry){var entryText=String(logEntry.formattedMessage);var matchesSearch=false;if(this.isRegex){matchesSearch=this.searchRegex.test(entryText);}else if(this.isCaseSensitive){matchesSearch=(entryText.indexOf(this.searchTerm)>-1);}else{matchesSearch=(entryText.toLowerCase().indexOf(this.searchTerm.toLowerCase())>-1);}","return matchesSearch;},getNextVisibleMatchIndex:function(){for(var i=currentMatchIndex+1;i<this.matches.length;i++){if(this.matches[i].isVisible()){return i;}}","for(i=0;i<=currentMatchIndex;i++){if(this.matches[i].isVisible()){return i;}}","return-1;},getPreviousVisibleMatchIndex:function(){for(var i=currentMatchIndex-1;i>=0;i--){if(this.matches[i].isVisible()){return i;}}","for(var i=this.matches.length-1;i>=currentMatchIndex;i--){if(this.matches[i].isVisible()){return i;}}",'return-1;},applyTo:function(logEntry){var doesMatch=this.match(logEntry);if(doesMatch){logEntry.group.expand();logEntry.setSearchMatch(true);var logEntryContent;var wrappedLogEntryContent;var searchTermReplacementStartTag="<span class=\\"searchterm\\">";var searchTermReplacementEndTag="<"+"/span>";var preTagName=isIe?"pre":"span";var preStartTag="<"+preTagName+" class=\\"pre\\">";var preEndTag="<"+"/"+preTagName+">";var startIndex=0;var searchIndex,matchedText,textBeforeMatch;if(this.isRegex){var flags=this.isCaseSensitive?"g":"gi";var capturingRegex=new RegExp("("+this.searchRegex.source+")",flags);var rnd=(""+Math.random()).substr(2);var startToken="%%s"+rnd+"%%";var endToken="%%e"+rnd+"%%";logEntryContent=logEntry.formattedMessage.replace(capturingRegex,startToken+"$1"+endToken);logEntryContent=escapeHtml(logEntryContent);var result;var searchString=logEntryContent;logEntryContent="";wrappedLogEntryContent="";while((searchIndex=searchString.indexOf(startToken,startIndex))>-1){var endTokenIndex=searchString.indexOf(endToken,searchIndex);matchedText=searchString.substring(searchIndex+startToken.length,endTokenIndex);textBeforeMatch=searchString.substring(startIndex,searchIndex);logEntryContent+=preStartTag+textBeforeMatch+preEndTag;logEntryContent+=searchTermReplacementStartTag+preStartTag+matchedText+',"preEndTag+searchTermReplacementEndTag;if(isIe){wrappedLogEntryContent+=textBeforeMatch+searchTermReplacementStartTag+","matchedText+searchTermReplacementEndTag;}","startIndex=endTokenIndex+endToken.length;}",'logEntryContent+=preStartTag+searchString.substr(startIndex)+preEndTag;if(isIe){wrappedLogEntryContent+=searchString.substr(startIndex);}}else{logEntryContent="";wrappedLogEntryContent="";var searchTermReplacementLength=searchTermReplacementStartTag.length+',"this.searchTerm.length+searchTermReplacementEndTag.length;var searchTermLength=this.searchTerm.length;var searchTermLowerCase=this.searchTerm.toLowerCase();var logTextLowerCase=logEntry.formattedMessage.toLowerCase();while((searchIndex=logTextLowerCase.indexOf(searchTermLowerCase,startIndex))>-1){matchedText=escapeHtml(logEntry.formattedMessage.substr(searchIndex,this.searchTerm.length));textBeforeMatch=escapeHtml(logEntry.formattedMessage.substring(startIndex,searchIndex));var searchTermReplacement=searchTermReplacementStartTag+","preStartTag+matchedText+preEndTag+searchTermReplacementEndTag;logEntryContent+=preStartTag+textBeforeMatch+preEndTag+searchTermReplacement;if(isIe){wrappedLogEntryContent+=textBeforeMatch+searchTermReplacementStartTag+","matchedText+searchTermReplacementEndTag;}","startIndex=searchIndex+searchTermLength;}","var textAfterLastMatch=escapeHtml(logEntry.formattedMessage.substr(startIndex));logEntryContent+=preStartTag+textAfterLastMatch+preEndTag;if(isIe){wrappedLogEntryContent+=textAfterLastMatch;}}","logEntry.setContent(logEntryContent,wrappedLogEntryContent);var logEntryMatches=logEntry.getSearchMatches();this.matches=this.matches.concat(logEntryMatches);}else{logEntry.setSearchMatch(false);logEntry.setContent(logEntry.formattedMessage,logEntry.formattedMessage);}","return doesMatch;},removeMatches:function(logEntries){var matchesToRemoveCount=0;var currentMatchRemoved=false;var matchesToRemove=[];var i,iLen,j,jLen;for(i=0,iLen=this.matches.length;i<iLen;i++){for(j=0,jLen=logEntries.length;j<jLen;j++){if(this.matches[i].belongsTo(logEntries[j])){matchesToRemove.push(this.matches[i]);if(i===currentMatchIndex){currentMatchRemoved=true;}}}}","var newMatch=currentMatchRemoved?null:this.matches[currentMatchIndex];if(currentMatchRemoved){for(i=currentMatchIndex,iLen=this.matches.length;i<iLen;i++){if(this.matches[i].isVisible()&&!array_contains(matchesToRemove,this.matches[i])){newMatch=this.matches[i];break;}}}","for(i=0,iLen=matchesToRemove.length;i<iLen;i++){array_remove(this.matches,matchesToRemove[i]);matchesToRemove[i].remove();}","if(this.hasVisibleMatches()){if(newMatch===null){setCurrentMatchIndex(0);}else{var newMatchIndex=0;for(i=0,iLen=this.matches.length;i<iLen;i++){if(newMatch===this.matches[i]){newMatchIndex=i;break;}}","setCurrentMatchIndex(newMatchIndex);}}else{currentMatchIndex=null;displayNoMatches();}}};function getPageOffsetTop(el,container){var currentEl=el;var y=0;while(currentEl&&currentEl!=container){y+=currentEl.offsetTop;currentEl=currentEl.offsetParent;}","return y;}",'function scrollIntoView(el){var logContainer=logMainContainer;if(!$("wrap").checked){var logContainerLeft=logContainer.scrollLeft;var logContainerRight=logContainerLeft+logContainer.offsetWidth;var elLeft=el.offsetLeft;var elRight=elLeft+el.offsetWidth;if(elLeft<logContainerLeft||elRight>logContainerRight){logContainer.scrollLeft=elLeft-(logContainer.offsetWidth-el.offsetWidth)/2;}}',"var logContainerTop=logContainer.scrollTop;var logContainerBottom=logContainerTop+logContainer.offsetHeight;var elTop=getPageOffsetTop(el)-getToolBarsHeight();var elBottom=elTop+el.offsetHeight;if(elTop<logContainerTop||elBottom>logContainerBottom){logContainer.scrollTop=elTop-(logContainer.offsetHeight-el.offsetHeight)/2;}}","function Match(logEntryLevel,spanInMainDiv,spanInUnwrappedPre,spanInWrappedDiv){this.logEntryLevel=logEntryLevel;this.spanInMainDiv=spanInMainDiv;if(isIe){this.spanInUnwrappedPre=spanInUnwrappedPre;this.spanInWrappedDiv=spanInWrappedDiv;}","this.mainSpan=isIe?spanInUnwrappedPre:spanInMainDiv;}",'Match.prototype={equals:function(match){return this.mainSpan===match.mainSpan;},setCurrent:function(){if(isIe){addClass(this.spanInUnwrappedPre,"currentmatch");addClass(this.spanInWrappedDiv,"currentmatch");var elementToScroll=$("wrap").checked?this.spanInWrappedDiv:this.spanInUnwrappedPre;scrollIntoView(elementToScroll);}else{addClass(this.spanInMainDiv,"currentmatch");scrollIntoView(this.spanInMainDiv);}},belongsTo:function(logEntry){if(isIe){return isDescendant(this.spanInUnwrappedPre,logEntry.unwrappedPre);}else{return isDescendant(this.spanInMainDiv,logEntry.mainDiv);}},setNotCurrent:function(){if(isIe){removeClass(this.spanInUnwrappedPre,"currentmatch");removeClass(this.spanInWrappedDiv,"currentmatch");}else{removeClass(this.spanInMainDiv,"currentmatch");}},isOrphan:function(){return isOrphan(this.mainSpan);},isVisible:function(){return getCheckBox(this.logEntryLevel).checked;},remove:function(){if(isIe){this.spanInUnwrappedPre=null;this.spanInWrappedDiv=null;}else{this.spanInMainDiv=null;}}};var currentSearch=null;var currentMatchIndex=null;function doSearch(){var searchBox=$("searchBox");var searchTerm=searchBox.value;var isRegex=$("searchRegex").checked;var isCaseSensitive=$("searchCaseSensitive").checked;var i;if(searchTerm===""){$("searchReset").disabled=true;$("searchNav").style.display="none";removeClass(document.body,"searching");removeClass(searchBox,"hasmatches");removeClass(searchBox,"nomatches");for(i=0;i<logEntries.length;i++){logEntries[i].clearSearch();logEntries[i].setContent(logEntries[i].formattedMessage,logEntries[i].formattedMessage);}','currentSearch=null;setLogContainerHeight();}else{$("searchReset").disabled=false;$("searchNav").style.display="block";var searchRegex;var regexValid;if(isRegex){try{searchRegex=isCaseSensitive?new RegExp(searchTerm,"g"):new RegExp(searchTerm,"gi");regexValid=true;replaceClass(searchBox,"validregex","invalidregex");searchBox.title="Valid regex";}catch(ex){regexValid=false;replaceClass(searchBox,"invalidregex","validregex");searchBox.title="Invalid regex: "+(ex.message?ex.message:(ex.description?ex.description:"unknown error"));return;}}else{searchBox.title="";removeClass(searchBox,"validregex");removeClass(searchBox,"invalidregex");}','addClass(document.body,"searching");currentSearch=new Search(searchTerm,isRegex,searchRegex,isCaseSensitive);for(i=0;i<logEntries.length;i++){currentSearch.applyTo(logEntries[i]);}',"setLogContainerHeight();if(currentSearch.hasVisibleMatches()){setCurrentMatchIndex(0);displayMatches();}else{displayNoMatches();}}}","function updateSearchFromFilters(){if(currentSearch){if(currentSearch.hasMatches()){if(currentMatchIndex===null){currentMatchIndex=0;}","var currentMatch=currentSearch.matches[currentMatchIndex];if(currentMatch.isVisible()){displayMatches();setCurrentMatchIndex(currentMatchIndex);}else{currentMatch.setNotCurrent();var nextVisibleMatchIndex=currentSearch.getNextVisibleMatchIndex();if(nextVisibleMatchIndex>-1){setCurrentMatchIndex(nextVisibleMatchIndex);displayMatches();}else{displayNoMatches();}}}else{displayNoMatches();}}}","function refreshCurrentMatch(){if(currentSearch&&currentSearch.hasVisibleMatches()){setCurrentMatchIndex(currentMatchIndex);}}",'function displayMatches(){replaceClass($("searchBox"),"hasmatches","nomatches");$("searchBox").title=""+currentSearch.matches.length+" matches found";$("searchNav").style.display="block";setLogContainerHeight();}','function displayNoMatches(){replaceClass($("searchBox"),"nomatches","hasmatches");$("searchBox").title="No matches found";$("searchNav").style.display="none";setLogContainerHeight();}','function toggleSearchEnabled(enable){enable=(typeof enable=="undefined")?!$("searchDisable").checked:enable;$("searchBox").disabled=!enable;$("searchReset").disabled=!enable;$("searchRegex").disabled=!enable;$("searchNext").disabled=!enable;$("searchPrevious").disabled=!enable;$("searchCaseSensitive").disabled=!enable;$("searchNav").style.display=(enable&&($("searchBox").value!=="")&&currentSearch&&currentSearch.hasVisibleMatches())?"block":"none";if(enable){removeClass($("search"),"greyedout");addClass(document.body,"searching");if($("searchHighlight").checked){addClass(logMainContainer,"searchhighlight");}else{removeClass(logMainContainer,"searchhighlight");}','if($("searchFilter").checked){addClass(logMainContainer,"searchfilter");}else{removeClass(logMainContainer,"searchfilter");}','$("searchDisable").checked=!enable;}else{addClass($("search"),"greyedout");removeClass(document.body,"searching");removeClass(logMainContainer,"searchhighlight");removeClass(logMainContainer,"searchfilter");}',"setLogContainerHeight();}",'function toggleSearchFilter(){var enable=$("searchFilter").checked;if(enable){addClass(logMainContainer,"searchfilter");}else{removeClass(logMainContainer,"searchfilter");}',"refreshCurrentMatch();}",'function toggleSearchHighlight(){var enable=$("searchHighlight").checked;if(enable){addClass(logMainContainer,"searchhighlight");}else{removeClass(logMainContainer,"searchhighlight");}}','function clearSearch(){$("searchBox").value="";doSearch();}','function searchNext(){if(currentSearch!==null&&currentMatchIndex!==null){currentSearch.matches[currentMatchIndex].setNotCurrent();var nextMatchIndex=currentSearch.getNextVisibleMatchIndex();if(nextMatchIndex>currentMatchIndex||confirm("Reached the end of the page. Start from the top?")){setCurrentMatchIndex(nextMatchIndex);}}}','function searchPrevious(){if(currentSearch!==null&&currentMatchIndex!==null){currentSearch.matches[currentMatchIndex].setNotCurrent();var previousMatchIndex=currentSearch.getPreviousVisibleMatchIndex();if(previousMatchIndex<currentMatchIndex||confirm("Reached the start of the page. Continue from the bottom?")){setCurrentMatchIndex(previousMatchIndex);}}}',"function setCurrentMatchIndex(index){currentMatchIndex=index;currentSearch.matches[currentMatchIndex].setCurrent();}",'function addClass(el,cssClass){if(!hasClass(el,cssClass)){if(el.className){el.className+=" "+cssClass;}else{el.className=cssClass;}}}','function hasClass(el,cssClass){if(el.className){var classNames=el.className.split(" ");return array_contains(classNames,cssClass);}',"return false;}",'function removeClass(el,cssClass){if(hasClass(el,cssClass)){var existingClasses=el.className.split(" ");var newClasses=[];for(var i=0,len=existingClasses.length;i<len;i++){if(existingClasses[i]!=cssClass){newClasses[newClasses.length]=existingClasses[i];}}','el.className=newClasses.join(" ");}}',"function replaceClass(el,newCssClass,oldCssClass){removeClass(el,oldCssClass);addClass(el,newCssClass);}","function getElementsByClass(el,cssClass,tagName){var elements=el.getElementsByTagName(tagName);var matches=[];for(var i=0,len=elements.length;i<len;i++){if(hasClass(elements[i],cssClass)){matches.push(elements[i]);}}","return matches;}","function $(id){return document.getElementById(id);}","function isDescendant(node,ancestorNode){while(node!=null){if(node===ancestorNode){return true;}","node=node.parentNode;}","return false;}","function isOrphan(node){var currentNode=node;while(currentNode){if(currentNode==document.body){return false;}","currentNode=currentNode.parentNode;}","return true;}",'function escapeHtml(str){return str.replace(/&/g,"&amp;").replace(/[<]/g,"&lt;").replace(/>/g,"&gt;");}',"function getWindowWidth(){if(window.innerWidth){return window.innerWidth;}else if(document.documentElement&&document.documentElement.clientWidth){return document.documentElement.clientWidth;}else if(document.body){return document.body.clientWidth;}","return 0;}","function getWindowHeight(){if(window.innerHeight){return window.innerHeight;}else if(document.documentElement&&document.documentElement.clientHeight){return document.documentElement.clientHeight;}else if(document.body){return document.body.clientHeight;}","return 0;}",'function getToolBarsHeight(){return $("switches").offsetHeight;}','function getChromeHeight(){var height=getToolBarsHeight();if(showCommandLine){height+=$("commandLine").offsetHeight;}',"return height;}",'function setLogContainerHeight(){if(logMainContainer){var windowHeight=getWindowHeight();$("body").style.height=getWindowHeight()+"px";logMainContainer.style.height=""+','Math.max(0,windowHeight-getChromeHeight())+"px";}}','function setCommandInputWidth(){if(showCommandLine){$("command").style.width=""+Math.max(0,$("commandLineContainer").offsetWidth-','($("evaluateButton").offsetWidth+13))+"px";}}',"window.onresize=function(){setCommandInputWidth();setLogContainerHeight();};if(!Array.prototype.push){Array.prototype.push=function(){for(var i=0,len=arguments.length;i<len;i++){this[this.length]=arguments[i];}","return this.length;};}","if(!Array.prototype.pop){Array.prototype.pop=function(){if(this.length>0){var val=this[this.length-1];this.length=this.length-1;return val;}};}","if(!Array.prototype.shift){Array.prototype.shift=function(){if(this.length>0){var firstItem=this[0];for(var i=0,len=this.length-1;i<len;i++){this[i]=this[i+1];}","this.length=this.length-1;return firstItem;}};}","if(!Array.prototype.splice){Array.prototype.splice=function(startIndex,deleteCount){var itemsAfterDeleted=this.slice(startIndex+deleteCount);var itemsDeleted=this.slice(startIndex,startIndex+deleteCount);this.length=startIndex;var argumentsArray=[];for(var i=0,len=arguments.length;i<len;i++){argumentsArray[i]=arguments[i];}","var itemsToAppend=(argumentsArray.length>2)?itemsAfterDeleted=argumentsArray.slice(2).concat(itemsAfterDeleted):itemsAfterDeleted;for(i=0,len=itemsToAppend.length;i<len;i++){this.push(itemsToAppend[i]);}","return itemsDeleted;};}","function array_remove(arr,val){var index=-1;for(var i=0,len=arr.length;i<len;i++){if(arr[i]===val){index=i;break;}}","if(index>=0){arr.splice(index,1);return index;}else{return false;}}","function array_removeFromStart(array,numberToRemove){if(Array.prototype.splice){array.splice(0,numberToRemove);}else{for(var i=numberToRemove,len=array.length;i<len;i++){array[i-numberToRemove]=array[i];}","array.length=array.length-numberToRemove;}","return array;}","function array_contains(arr,val){for(var i=0,len=arr.length;i<len;i++){if(arr[i]==val){return true;}}","return false;}","function getErrorMessage(ex){if(ex.message){return ex.message;}else if(ex.description){return ex.description;}",'return""+ex;}',"function moveCaretToEnd(input){if(input.setSelectionRange){input.focus();var length=input.value.length;input.setSelectionRange(length,length);}else if(input.createTextRange){var range=input.createTextRange();range.collapse(false);range.select();}","input.focus();}",'function stopPropagation(evt){if(evt.stopPropagation){evt.stopPropagation();}else if(typeof evt.cancelBubble!="undefined"){evt.cancelBubble=true;}}',"function getEvent(evt){return evt?evt:event;}","function getTarget(evt){return evt.target?evt.target:evt.srcElement;}",'function getRelatedTarget(evt){if(evt.relatedTarget){return evt.relatedTarget;}else if(evt.srcElement){switch(evt.type){case"mouseover":return evt.fromElement;case"mouseout":return evt.toElement;default:return evt.srcElement;}}}',"function cancelKeyEvent(evt){evt.returnValue=false;stopPropagation(evt);}",'function evalCommandLine(){var expr=$("command").value;evalCommand(expr);$("command").value="";}',"function evalLastCommand(){if(lastCommand!=null){evalCommand(lastCommand);}}",'var lastCommand=null;var commandHistory=[];var currentCommandIndex=0;function evalCommand(expr){if(appender){appender.evalCommandAndAppend(expr);}else{var prefix=">>> "+expr+"\\r\\n";try{log("INFO",prefix+eval(expr));}catch(ex){log("ERROR",prefix+"Error: "+getErrorMessage(ex));}}',"if(expr!=commandHistory[commandHistory.length-1]){commandHistory.push(expr);if(appender){appender.storeCommandHistory(commandHistory);}}","currentCommandIndex=(expr==commandHistory[currentCommandIndex])?currentCommandIndex+1:commandHistory.length;lastCommand=expr;}","//]]>","</script>",'<style type="text/css">',"body{background-color:white;color:black;padding:0;margin:0;font-family:tahoma,verdana,arial,helvetica,sans-serif;overflow:hidden}div#switchesContainer input{margin-bottom:0}div.toolbar{border-top:solid #ffffff 1px;border-bottom:solid #aca899 1px;background-color:#f1efe7;padding:3px 5px;font-size:68.75%}div.toolbar,div#search input{font-family:tahoma,verdana,arial,helvetica,sans-serif}div.toolbar input.button{padding:0 5px;font-size:100%}div.toolbar input.hidden{display:none}div#switches input#clearButton{margin-left:20px}div#levels label{font-weight:bold}div#levels label,div#options label{margin-right:5px}div#levels label#wrapLabel{font-weight:normal}div#search label{margin-right:10px}div#search label.searchboxlabel{margin-right:0}div#search input{font-size:100%}div#search input.validregex{color:green}div#search input.invalidregex{color:red}div#search input.nomatches{color:white;background-color:#ff6666}div#search input.nomatches{color:white;background-color:#ff6666}div#searchNav{display:none}div#commandLine{display:none}div#commandLine input#command{font-size:100%;font-family:Courier New,Courier}div#commandLine input#evaluateButton{}*.greyedout{color:gray !important;border-color:gray !important}*.greyedout *.alwaysenabled{color:black}*.unselectable{-khtml-user-select:none;-moz-user-select:none;user-select:none}div#log{font-family:Courier New,Courier;font-size:75%;width:100%;overflow:auto;clear:both;position:relative}div.group{border-color:#cccccc;border-style:solid;border-width:1px 0 1px 1px;overflow:visible}div.oldIe div.group,div.oldIe div.group *,div.oldIe *.logentry{height:1%}div.group div.groupheading span.expander{border:solid black 1px;font-family:Courier New,Courier;font-size:0.833em;background-color:#eeeeee;position:relative;top:-1px;color:black;padding:0 2px;cursor:pointer;cursor:hand;height:1%}div.group div.groupcontent{margin-left:10px;padding-bottom:2px;overflow:visible}div.group div.expanded{display:block}div.group div.collapsed{display:none}*.logentry{overflow:visible;display:none;white-space:pre}span.pre{white-space:pre}pre.unwrapped{display:inline !important}pre.unwrapped pre.pre,div.wrapped pre.pre{display:inline}div.wrapped pre.pre{white-space:normal}div.wrapped{display:none}body.searching *.logentry span.currentmatch{color:white !important;background-color:green !important}body.searching div.searchhighlight *.logentry span.searchterm{color:black;background-color:yellow}div.wrap *.logentry{white-space:normal !important;border-width:0 0 1px 0;border-color:#dddddd;border-style:dotted}div.wrap #log_wrapped,#log_unwrapped{display:block}div.wrap #log_unwrapped,#log_wrapped{display:none}div.wrap *.logentry span.pre{overflow:visible;white-space:normal}div.wrap *.logentry pre.unwrapped{display:none}div.wrap *.logentry span.wrapped{display:inline}div.searchfilter *.searchnonmatch{display:none !important}div#log *.TRACE,label#label_TRACE{color:#666666}div#log *.DEBUG,label#label_DEBUG{color:green}div#log *.INFO,label#label_INFO{color:#000099}div#log *.WARN,label#label_WARN{color:#999900}div#log *.ERROR,label#label_ERROR{color:red}div#log *.FATAL,label#label_FATAL{color:#660066}div.TRACE#log *.TRACE,div.DEBUG#log *.DEBUG,div.INFO#log *.INFO,div.WARN#log *.WARN,div.ERROR#log *.ERROR,div.FATAL#log *.FATAL{display:block}div#log div.separator{background-color:#cccccc;margin:5px 0;line-height:1px}","</style>","</head>",'<body id="body">','<div id="switchesContainer">','<div id="switches">','<div id="levels" class="toolbar">',"Filters:",'<input type="checkbox" id="switch_TRACE" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide trace messages" /><label for="switch_TRACE" id="label_TRACE">trace</label>','<input type="checkbox" id="switch_DEBUG" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide debug messages" /><label for="switch_DEBUG" id="label_DEBUG">debug</label>','<input type="checkbox" id="switch_INFO" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide info messages" /><label for="switch_INFO" id="label_INFO">info</label>','<input type="checkbox" id="switch_WARN" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide warn messages" /><label for="switch_WARN" id="label_WARN">warn</label>','<input type="checkbox" id="switch_ERROR" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide error messages" /><label for="switch_ERROR" id="label_ERROR">error</label>','<input type="checkbox" id="switch_FATAL" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide fatal messages" /><label for="switch_FATAL" id="label_FATAL">fatal</label>','<input type="checkbox" id="switch_ALL" onclick="toggleAllLevels(); applyFilters()" checked="checked" title="Show/hide all messages" /><label for="switch_ALL" id="label_ALL">all</label>',"</div>",'<div id="search" class="toolbar">','<label for="searchBox" class="searchboxlabel">Search:</label> <input type="text" id="searchBox" onclick="toggleSearchEnabled(true)" onkeyup="scheduleSearch()" size="20" />','<input type="button" id="searchReset" disabled="disabled" value="Reset" onclick="clearSearch()" class="button" title="Reset the search" />','<input type="checkbox" id="searchRegex" onclick="doSearch()" title="If checked, search is treated as a regular expression" /><label for="searchRegex">Regex</label>','<input type="checkbox" id="searchCaseSensitive" onclick="doSearch()" title="If checked, search is case sensitive" /><label for="searchCaseSensitive">Match case</label>','<input type="checkbox" id="searchDisable" onclick="toggleSearchEnabled()" title="Enable/disable search" /><label for="searchDisable" class="alwaysenabled">Disable</label>','<div id="searchNav">','<input type="button" id="searchNext" disabled="disabled" value="Next" onclick="searchNext()" class="button" title="Go to the next matching log entry" />','<input type="button" id="searchPrevious" disabled="disabled" value="Previous" onclick="searchPrevious()" class="button" title="Go to the previous matching log entry" />','<input type="checkbox" id="searchFilter" onclick="toggleSearchFilter()" title="If checked, non-matching log entries are filtered out" /><label for="searchFilter">Filter</label>','<input type="checkbox" id="searchHighlight" onclick="toggleSearchHighlight()" title="Highlight matched search terms" /><label for="searchHighlight" class="alwaysenabled">Highlight all</label>',"</div>","</div>",'<div id="options" class="toolbar">',"Options:",'<input type="checkbox" id="enableLogging" onclick="toggleLoggingEnabled()" checked="checked" title="Enable/disable logging" /><label for="enableLogging" id="enableLoggingLabel">Log</label>','<input type="checkbox" id="wrap" onclick="toggleWrap()" title="Enable / disable word wrap" /><label for="wrap" id="wrapLabel">Wrap</label>','<input type="checkbox" id="newestAtTop" onclick="toggleNewestAtTop()" title="If checked, causes newest messages to appear at the top" /><label for="newestAtTop" id="newestAtTopLabel">Newest at the top</label>','<input type="checkbox" id="scrollToLatest" onclick="toggleScrollToLatest()" checked="checked" title="If checked, window automatically scrolls to a new message when it is added" /><label for="scrollToLatest" id="scrollToLatestLabel">Scroll to latest</label>','<input type="button" id="clearButton" value="Clear" onclick="clearLog()" class="button" title="Clear all log messages"  />','<input type="button" id="hideButton" value="Hide" onclick="hide()" class="hidden button" title="Hide the console" />','<input type="button" id="closeButton" value="Close" onclick="closeWindow()" class="hidden button" title="Close the window" />',"</div>","</div>","</div>",'<div id="log" class="TRACE DEBUG INFO WARN ERROR FATAL"></div>','<div id="commandLine" class="toolbar">','<div id="commandLineContainer">','<input type="text" id="command" title="Enter a JavaScript command here and hit return or press \'Evaluate\'" />','<input type="button" id="evaluateButton" value="Evaluate" class="button" title="Evaluate the command" onclick="evalCommandLine()" />',"</div>","</div>","</body>","</html>",""];
},defaultCommandLineFunctions=[];ConsoleAppender=function(){};var consoleAppenderIdCounter=1;ConsoleAppender.prototype=new Appender,ConsoleAppender.prototype.create=function(inPage,container,lazyInit,initiallyMinimized,useDocumentWrite,width,height,focusConsoleWindow){function QueuedLoggingEvent(loggingEvent,formattedMessage){this.loggingEvent=loggingEvent,this.levelName=loggingEvent.level.name,this.formattedMessage=formattedMessage}function QueuedGroup(name,initiallyExpanded){this.name=name,this.initiallyExpanded=initiallyExpanded}function QueuedGroupEnd(){}var appender=this,initialized=!1,consoleWindowCreated=!1,consoleWindowLoaded=!1,consoleClosed=!1,queuedLoggingEvents=[],isSupported=!0,consoleAppenderId=consoleAppenderIdCounter++;initiallyMinimized=extractBooleanFromParam(initiallyMinimized,this.defaults.initiallyMinimized),lazyInit=extractBooleanFromParam(lazyInit,this.defaults.lazyInit),useDocumentWrite=extractBooleanFromParam(useDocumentWrite,this.defaults.useDocumentWrite);var newestMessageAtTop=this.defaults.newestMessageAtTop,scrollToLatestMessage=this.defaults.scrollToLatestMessage;width=width?width:this.defaults.width,height=height?height:this.defaults.height;var maxMessages=this.defaults.maxMessages,showCommandLine=this.defaults.showCommandLine,commandLineObjectExpansionDepth=this.defaults.commandLineObjectExpansionDepth,showHideButton=this.defaults.showHideButton,showCloseButton=this.defaults.showCloseButton;this.setLayout(this.defaults.layout);var init,createWindow,safeToAppend,getConsoleWindow,open,appenderName=inPage?"InPageAppender":"PopUpAppender",checkCanConfigure=function(configOptionName){return!consoleWindowCreated||(handleError(appenderName+": configuration option '"+configOptionName+"' may not be set after the appender has been initialized"),!1)},consoleWindowExists=function(){return consoleWindowLoaded&&isSupported&&!consoleClosed};this.isNewestMessageAtTop=function(){return newestMessageAtTop},this.setNewestMessageAtTop=function(newestMessageAtTopParam){newestMessageAtTop=bool(newestMessageAtTopParam),consoleWindowExists()&&getConsoleWindow().setNewestAtTop(newestMessageAtTop)},this.isScrollToLatestMessage=function(){return scrollToLatestMessage},this.setScrollToLatestMessage=function(scrollToLatestMessageParam){scrollToLatestMessage=bool(scrollToLatestMessageParam),consoleWindowExists()&&getConsoleWindow().setScrollToLatest(scrollToLatestMessage)},this.getWidth=function(){return width},this.setWidth=function(widthParam){checkCanConfigure("width")&&(width=extractStringFromParam(widthParam,width))},this.getHeight=function(){return height},this.setHeight=function(heightParam){checkCanConfigure("height")&&(height=extractStringFromParam(heightParam,height))},this.getMaxMessages=function(){return maxMessages},this.setMaxMessages=function(maxMessagesParam){maxMessages=extractIntFromParam(maxMessagesParam,maxMessages),consoleWindowExists()&&getConsoleWindow().setMaxMessages(maxMessages)},this.isShowCommandLine=function(){return showCommandLine},this.setShowCommandLine=function(showCommandLineParam){showCommandLine=bool(showCommandLineParam),consoleWindowExists()&&getConsoleWindow().setShowCommandLine(showCommandLine)},this.isShowHideButton=function(){return showHideButton},this.setShowHideButton=function(showHideButtonParam){showHideButton=bool(showHideButtonParam),consoleWindowExists()&&getConsoleWindow().setShowHideButton(showHideButton)},this.isShowCloseButton=function(){return showCloseButton},this.setShowCloseButton=function(showCloseButtonParam){showCloseButton=bool(showCloseButtonParam),consoleWindowExists()&&getConsoleWindow().setShowCloseButton(showCloseButton)},this.getCommandLineObjectExpansionDepth=function(){return commandLineObjectExpansionDepth},this.setCommandLineObjectExpansionDepth=function(commandLineObjectExpansionDepthParam){commandLineObjectExpansionDepth=extractIntFromParam(commandLineObjectExpansionDepthParam,commandLineObjectExpansionDepth)};var minimized=initiallyMinimized;this.isInitiallyMinimized=function(){return initiallyMinimized},this.setInitiallyMinimized=function(initiallyMinimizedParam){checkCanConfigure("initiallyMinimized")&&(initiallyMinimized=bool(initiallyMinimizedParam),minimized=initiallyMinimized)},this.isUseDocumentWrite=function(){return useDocumentWrite},this.setUseDocumentWrite=function(useDocumentWriteParam){checkCanConfigure("useDocumentWrite")&&(useDocumentWrite=bool(useDocumentWriteParam))},QueuedLoggingEvent.prototype.append=function(){getConsoleWindow().log(this.levelName,this.formattedMessage)},QueuedGroup.prototype.append=function(){getConsoleWindow().group(this.name,this.initiallyExpanded)},QueuedGroupEnd.prototype.append=function(){getConsoleWindow().groupEnd()};var checkAndAppend=function(){safeToAppend(),initialized?consoleClosed&&reopenWhenClosed&&createWindow():init(),safeToAppend()&&appendQueuedLoggingEvents()};this.append=function(loggingEvent){if(isSupported){var formattedMessage=appender.getLayout().formatWithException(loggingEvent);queuedLoggingEvents.push(new QueuedLoggingEvent(loggingEvent,formattedMessage)),checkAndAppend()}},this.group=function(name,initiallyExpanded){isSupported&&(queuedLoggingEvents.push(new QueuedGroup(name,initiallyExpanded)),checkAndAppend())},this.groupEnd=function(){isSupported&&(queuedLoggingEvents.push(new QueuedGroupEnd),checkAndAppend())};var appendQueuedLoggingEvents=function(){for(;queuedLoggingEvents.length>0;)queuedLoggingEvents.shift().append();focusConsoleWindow&&getConsoleWindow().focus()};this.setAddedToLogger=function(logger){this.loggers.push(logger),enabled&&!lazyInit&&init()},this.clear=function(){consoleWindowExists()&&getConsoleWindow().clearLog(),queuedLoggingEvents.length=0},this.focus=function(){consoleWindowExists()&&getConsoleWindow().focus()},this.focusCommandLine=function(){consoleWindowExists()&&getConsoleWindow().focusCommandLine()},this.focusSearch=function(){consoleWindowExists()&&getConsoleWindow().focusSearch()};var commandWindow=window;this.getCommandWindow=function(){return commandWindow},this.setCommandWindow=function(commandWindowParam){commandWindow=commandWindowParam},this.executeLastCommand=function(){consoleWindowExists()&&getConsoleWindow().evalLastCommand()};var commandLayout=new PatternLayout("%m");this.getCommandLayout=function(){return commandLayout},this.setCommandLayout=function(commandLayoutParam){commandLayout=commandLayoutParam},this.evalCommandAndAppend=function(expr){var commandReturnValue={appendResult:!0,isError:!1},commandOutput="";try{var result,i;!commandWindow.eval&&commandWindow.execScript&&commandWindow.execScript("null");var commandLineFunctionsHash={};for(i=0,len=commandLineFunctions.length;i<len;i++)commandLineFunctionsHash[commandLineFunctions[i][0]]=commandLineFunctions[i][1];var objectsToRestore=[],addObjectToRestore=function(name){objectsToRestore.push([name,commandWindow[name]])};addObjectToRestore("appender"),commandWindow.appender=appender,addObjectToRestore("commandReturnValue"),commandWindow.commandReturnValue=commandReturnValue,addObjectToRestore("commandLineFunctionsHash"),commandWindow.commandLineFunctionsHash=commandLineFunctionsHash;var addFunctionToWindow=function(name){addObjectToRestore(name),commandWindow[name]=function(){return this.commandLineFunctionsHash[name](appender,arguments,commandReturnValue)}};for(i=0,len=commandLineFunctions.length;i<len;i++)addFunctionToWindow(commandLineFunctions[i][0]);for(commandWindow===window&&commandWindow.execScript?(addObjectToRestore("evalExpr"),addObjectToRestore("result"),window.evalExpr=expr,commandWindow.execScript("window.result=eval(window.evalExpr);"),result=window.result):result=commandWindow.eval(expr),commandOutput=isUndefined(result)?result:formatObjectExpansion(result,commandLineObjectExpansionDepth),i=0,len=objectsToRestore.length;i<len;i++)commandWindow[objectsToRestore[i][0]]=objectsToRestore[i][1]}catch(ex){commandOutput="Error evaluating command: "+getExceptionStringRep(ex),commandReturnValue.isError=!0}if(commandReturnValue.appendResult){var message=">>> "+expr;isUndefined(commandOutput)||(message+=newLine+commandOutput);var level=commandReturnValue.isError?Level.ERROR:Level.INFO,loggingEvent=new LoggingEvent(null,new Date,level,[message],null),mainLayout=this.getLayout();this.setLayout(commandLayout),this.append(loggingEvent),this.setLayout(mainLayout)}};var commandLineFunctions=defaultCommandLineFunctions.concat([]);this.addCommandLineFunction=function(functionName,commandLineFunction){commandLineFunctions.push([functionName,commandLineFunction])};var commandHistoryCookieName="log4javascriptCommandHistory";this.storeCommandHistory=function(commandHistory){setCookie(commandHistoryCookieName,commandHistory.join(","))};var writeHtml=function(doc){var lines=getConsoleHtmlLines();doc.open();for(var i=0,len=lines.length;i<len;i++)doc.writeln(lines[i]);doc.close()};this.setEventTypes(["load","unload"]);var consoleWindowLoadHandler=function(){var win=getConsoleWindow();win.setAppender(appender),win.setNewestAtTop(newestMessageAtTop),win.setScrollToLatest(scrollToLatestMessage),win.setMaxMessages(maxMessages),win.setShowCommandLine(showCommandLine),win.setShowHideButton(showHideButton),win.setShowCloseButton(showCloseButton),win.setMainWindow(window);var storedValue=getCookie(commandHistoryCookieName);storedValue&&(win.commandHistory=storedValue.split(","),win.currentCommandIndex=win.commandHistory.length),appender.dispatchEvent("load",{win:win})};this.unload=function(){logLog.debug("unload "+this+", caller: "+this.unload.caller),consoleClosed||(logLog.debug("really doing unload "+this),consoleClosed=!0,consoleWindowLoaded=!1,consoleWindowCreated=!1,appender.dispatchEvent("unload",{}))};var pollConsoleWindow=function(windowTest,interval,successCallback,errorMessage){function doPoll(){try{consoleClosed&&clearInterval(poll),windowTest(getConsoleWindow())&&(clearInterval(poll),successCallback())}catch(ex){clearInterval(poll),isSupported=!1,handleError(errorMessage,ex)}}var poll=setInterval(doPoll,interval)},getConsoleUrl=function(){var documentDomainSet=document.domain!=location.hostname;return useDocumentWrite?"":getBaseUrl()+"console.html"+(documentDomainSet?"?log4javascript_domain="+escape(document.domain):"")};if(inPage){var containerElement=null,cssProperties=[];this.addCssProperty=function(name,value){checkCanConfigure("cssProperties")&&cssProperties.push([name,value])};var iframeContainerDiv,windowCreationStarted=!1,iframeId=uniqueId+"_InPageAppender_"+consoleAppenderId;this.hide=function(){initialized&&consoleWindowCreated&&(consoleWindowExists()&&getConsoleWindow().$("command").blur(),iframeContainerDiv.style.display="none",minimized=!0)},this.show=function(){initialized&&(consoleWindowCreated?(iframeContainerDiv.style.display="block",this.setShowCommandLine(showCommandLine),minimized=!1):windowCreationStarted||createWindow(!0))},this.isVisible=function(){return!minimized&&!consoleClosed},this.close=function(fromButton){consoleClosed||fromButton&&!confirm("This will permanently remove the console from the page. No more messages will be logged. Do you wish to continue?")||(iframeContainerDiv.parentNode.removeChild(iframeContainerDiv),this.unload())},open=function(){function finalInit(){try{initiallyMinimized||appender.show(),consoleWindowLoadHandler(),consoleWindowLoaded=!0,appendQueuedLoggingEvents()}catch(ex){isSupported=!1,handleError(initErrorMessage,ex)}}function writeToDocument(){try{var windowTest=function(win){return isLoaded(win)};useDocumentWrite&&writeHtml(getConsoleWindow().document),windowTest(getConsoleWindow())?finalInit():pollConsoleWindow(windowTest,100,finalInit,initErrorMessage)}catch(ex){isSupported=!1,handleError(initErrorMessage,ex)}}var initErrorMessage="InPageAppender.open: unable to create console iframe";minimized=!1,iframeContainerDiv=containerElement.appendChild(document.createElement("div")),iframeContainerDiv.style.width=width,iframeContainerDiv.style.height=height,iframeContainerDiv.style.border="solid gray 1px";for(var i=0,len=cssProperties.length;i<len;i++)iframeContainerDiv.style[cssProperties[i][0]]=cssProperties[i][1];var iframeSrc=useDocumentWrite?"":" src='"+getConsoleUrl()+"'";iframeContainerDiv.innerHTML="<iframe id='"+iframeId+"' name='"+iframeId+"' width='100%' height='100%' frameborder='0'"+iframeSrc+" scrolling='no'></iframe>",consoleClosed=!1;var iframeDocumentExistsTest=function(win){try{return bool(win)&&bool(win.document)}catch(ex){return!1}};iframeDocumentExistsTest(getConsoleWindow())?writeToDocument():pollConsoleWindow(iframeDocumentExistsTest,100,writeToDocument,initErrorMessage),consoleWindowCreated=!0},createWindow=function(show){if(show||!initiallyMinimized){var pageLoadHandler=function(){if(container)try{var el=document.getElementById(container);1==el.nodeType&&(containerElement=el),open()}catch(ex){handleError("InPageAppender.init: invalid container element '"+container+"' supplied",ex)}else containerElement=document.createElement("div"),containerElement.style.position="fixed",containerElement.style.left="0",containerElement.style.right="0",containerElement.style.bottom="0",document.body.appendChild(containerElement),appender.addCssProperty("borderWidth","1px 0 0 0"),appender.addCssProperty("zIndex",1e6),open()};pageLoaded&&container&&container.appendChild?(containerElement=container,open()):pageLoaded?pageLoadHandler():log4javascript.addEventListener("load",pageLoadHandler),windowCreationStarted=!0}},init=function(){createWindow(),initialized=!0},getConsoleWindow=function(){var iframe=window.frames[iframeId];if(iframe)return iframe},safeToAppend=function(){return!(!isSupported||consoleClosed)&&(consoleWindowCreated&&!consoleWindowLoaded&&getConsoleWindow()&&isLoaded(getConsoleWindow())&&(consoleWindowLoaded=!0),consoleWindowLoaded)}}else{var useOldPopUp=appender.defaults.useOldPopUp,complainAboutPopUpBlocking=appender.defaults.complainAboutPopUpBlocking,reopenWhenClosed=this.defaults.reopenWhenClosed;this.isUseOldPopUp=function(){return useOldPopUp},this.setUseOldPopUp=function(useOldPopUpParam){checkCanConfigure("useOldPopUp")&&(useOldPopUp=bool(useOldPopUpParam))},this.isComplainAboutPopUpBlocking=function(){return complainAboutPopUpBlocking},this.setComplainAboutPopUpBlocking=function(complainAboutPopUpBlockingParam){checkCanConfigure("complainAboutPopUpBlocking")&&(complainAboutPopUpBlocking=bool(complainAboutPopUpBlockingParam))},this.isFocusPopUp=function(){return focusConsoleWindow},this.setFocusPopUp=function(focusPopUpParam){focusConsoleWindow=bool(focusPopUpParam)},this.isReopenWhenClosed=function(){return reopenWhenClosed},this.setReopenWhenClosed=function(reopenWhenClosedParam){reopenWhenClosed=bool(reopenWhenClosedParam)},this.close=function(){logLog.debug("close "+this);try{popUp.close(),this.unload()}catch(ex){}},this.hide=function(){logLog.debug("hide "+this),consoleWindowExists()&&this.close()},this.show=function(){logLog.debug("show "+this),consoleWindowCreated||open()},this.isVisible=function(){return safeToAppend()};var popUp;open=function(){function finalInit(){getConsoleWindow().setCloseIfOpenerCloses(!useOldPopUp||!useDocumentWrite),consoleWindowLoadHandler(),consoleWindowLoaded=!0,appendQueuedLoggingEvents(),pollConsoleWindow(checkPopUpClosed,500,popUpClosedCallback,"PopUpAppender.checkPopUpClosed: error checking pop-up window")}var windowProperties="width="+width+",height="+height+",status,resizable",frameInfo="";try{var frameEl=window.frameElement;frameEl&&(frameInfo="_"+frameEl.tagName+"_"+(frameEl.name||frameEl.id||""))}catch(e){frameInfo="_inaccessibleParentFrame"}var windowName="PopUp_"+location.host.replace(/[^a-z0-9]/gi,"_")+"_"+consoleAppenderId+frameInfo;useOldPopUp&&useDocumentWrite||(windowName=windowName+"_"+uniqueId);var checkPopUpClosed=function(win){if(consoleClosed)return!0;try{return bool(win)&&win.closed}catch(ex){}return!1},popUpClosedCallback=function(){consoleClosed||appender.unload()};try{if(popUp=window.open(getConsoleUrl(),windowName,windowProperties),consoleClosed=!1,consoleWindowCreated=!0,popUp&&popUp.document)if(useDocumentWrite&&useOldPopUp&&isLoaded(popUp))popUp.mainPageReloaded(),finalInit();else{useDocumentWrite&&writeHtml(popUp.document);var popUpLoadedTest=function(win){return bool(win)&&isLoaded(win)};isLoaded(popUp)?finalInit():pollConsoleWindow(popUpLoadedTest,100,finalInit,"PopUpAppender.init: unable to create console window")}else isSupported=!1,logLog.warn("PopUpAppender.init: pop-ups blocked, please unblock to use PopUpAppender"),complainAboutPopUpBlocking&&handleError("log4javascript: pop-up windows appear to be blocked. Please unblock them to use pop-up logging.")}catch(ex){handleError("PopUpAppender.init: error creating pop-up",ex)}},createWindow=function(){initiallyMinimized||open()},init=function(){createWindow(),initialized=!0},getConsoleWindow=function(){return popUp},safeToAppend=function(){if(isSupported&&!isUndefined(popUp)&&!consoleClosed){if(popUp.closed||consoleWindowLoaded&&isUndefined(popUp.closed))return appender.unload(),logLog.debug("PopUpAppender: pop-up closed"),!1;!consoleWindowLoaded&&isLoaded(popUp)&&(consoleWindowLoaded=!0)}return isSupported&&consoleWindowLoaded&&!consoleClosed}}this.getConsoleWindow=getConsoleWindow},ConsoleAppender.addGlobalCommandLineFunction=function(functionName,commandLineFunction){defaultCommandLineFunctions.push([functionName,commandLineFunction])},PopUpAppender.prototype=new ConsoleAppender,PopUpAppender.prototype.defaults={layout:new PatternLayout("%d{HH:mm:ss} %-5p - %m{1}%n"),initiallyMinimized:!1,focusPopUp:!1,lazyInit:!0,useOldPopUp:!0,complainAboutPopUpBlocking:!0,newestMessageAtTop:!1,scrollToLatestMessage:!0,width:"600",height:"400",reopenWhenClosed:!1,maxMessages:null,showCommandLine:!0,commandLineObjectExpansionDepth:1,showHideButton:!1,showCloseButton:!0,useDocumentWrite:!0},PopUpAppender.prototype.toString=function(){return"PopUpAppender"},log4javascript.PopUpAppender=PopUpAppender,InPageAppender.prototype=new ConsoleAppender,InPageAppender.prototype.defaults={layout:new PatternLayout("%d{HH:mm:ss} %-5p - %m{1}%n"),initiallyMinimized:!1,lazyInit:!0,newestMessageAtTop:!1,scrollToLatestMessage:!0,width:"100%",height:"220px",maxMessages:null,showCommandLine:!0,commandLineObjectExpansionDepth:1,showHideButton:!1,showCloseButton:!1,showLogEntryDeleteButtons:!0,useDocumentWrite:!0},InPageAppender.prototype.toString=function(){return"InPageAppender"},log4javascript.InPageAppender=InPageAppender,log4javascript.InlineAppender=InPageAppender}(),function(){function dir(obj){var maxLen=0;for(var p in obj)maxLen=Math.max(toStr(p).length,maxLen);var propList=[];for(p in obj){var propVal,propNameStr="  "+padWithSpaces(toStr(p),maxLen+2);try{propVal=splitIntoLines(toStr(obj[p])).join(padWithSpaces(newLine,maxLen+6))}catch(ex){propVal="[Error obtaining property. Details: "+getExceptionMessage(ex)+"]"}propList.push(propNameStr+propVal)}return propList.join(newLine)}function getXhtml(rootNode,includeRootNode,indentation,startNewLine,preformatted){function isWhitespace(node){return node.nodeType==nodeTypes.TEXT_NODE&&/^[ \t\r\n]*$/.test(node.nodeValue)}function fixAttributeValue(attrValue){return attrValue.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;")}function getStyleAttributeValue(el){for(var stylePairs=el.style.cssText.split(";"),styleValue="",j=0,len=stylePairs.length;j<len;j++){var nameValueBits=stylePairs[j].split(":"),props=[];/^\s*$/.test(nameValueBits[0])||props.push(trim(nameValueBits[0]).toLowerCase()+":"+trim(nameValueBits[1])),styleValue=props.join(";")}return styleValue}function getNamespace(el){if(el.prefix)return el.prefix;if(el.outerHTML){var regex=new RegExp("<([^:]+):"+el.tagName+"[^>]*>","i");if(regex.test(el.outerHTML))return RegExp.$1.toLowerCase()}return""}includeRootNode="undefined"==typeof includeRootNode||!!includeRootNode,"string"!=typeof indentation&&(indentation=""),startNewLine=!!startNewLine,preformatted=!!preformatted;var xhtml,i,len,lt="<",gt=">";if(!includeRootNode||rootNode.nodeType==nodeTypes.DOCUMENT_FRAGMENT_NODE){for(xhtml="",i=0,len=rootNode.childNodes.length;i<len;i++)xhtml+=getXhtml(rootNode.childNodes[i],!0,indentation+indentationUnit);return xhtml}switch(rootNode.nodeType){case nodeTypes.ELEMENT_NODE:var tagName=rootNode.tagName.toLowerCase();xhtml=startNewLine?newLine+indentation:"",xhtml+=lt;var prefix=getNamespace(rootNode),hasPrefix=!!prefix;for(hasPrefix&&(xhtml+=prefix+":"),xhtml+=tagName,i=0,len=rootNode.attributes.length;i<len;i++){var currentAttr=rootNode.attributes[i];currentAttr.specified&&null!==currentAttr.nodeValue&&"style"!==currentAttr.nodeName.toLowerCase()&&"string"==typeof currentAttr.nodeValue&&0!==currentAttr.nodeName.indexOf("_moz")&&(xhtml+=" "+currentAttr.nodeName.toLowerCase()+'="',xhtml+=fixAttributeValue(currentAttr.nodeValue),xhtml+='"')}if(rootNode.style.cssText){var styleValue=getStyleAttributeValue(rootNode);""!==styleValue&&(xhtml+=' style="'+getStyleAttributeValue(rootNode)+'"')}if(array_contains(emptyElements,tagName)||hasPrefix&&!rootNode.hasChildNodes())xhtml+="/"+gt;else{xhtml+=gt;var childStartNewLine=!(1===rootNode.childNodes.length&&rootNode.childNodes[0].nodeType===nodeTypes.TEXT_NODE),childPreformatted=array_contains(preFormattedElements,tagName);for(i=0,len=rootNode.childNodes.length;i<len;i++)xhtml+=getXhtml(rootNode.childNodes[i],!0,indentation+indentationUnit,childStartNewLine,childPreformatted);var endTag=lt+"/"+tagName+gt;xhtml+=childStartNewLine?newLine+indentation+endTag:endTag}return xhtml;case nodeTypes.TEXT_NODE:if(isWhitespace(rootNode))xhtml="";else{if(preformatted)xhtml=rootNode.nodeValue;else{var lines=splitIntoLines(trim(rootNode.nodeValue)),trimmedLines=[];for(i=0,len=lines.length;i<len;i++)trimmedLines[i]=trim(lines[i]);xhtml=trimmedLines.join(newLine+indentation)}startNewLine&&(xhtml=newLine+indentation+xhtml)}return xhtml;case nodeTypes.CDATA_SECTION_NODE:return"<![CDATA["+rootNode.nodeValue+"]]>"+newLine;case nodeTypes.DOCUMENT_NODE:for(xhtml="",i=0,len=rootNode.childNodes.length;i<len;i++)xhtml+=getXhtml(rootNode.childNodes[i],!0,indentation);return xhtml;default:return""}}function createCommandLineFunctions(){ConsoleAppender.addGlobalCommandLineFunction("$",function(appender,args,returnValue){return document.getElementById(args[0])}),ConsoleAppender.addGlobalCommandLineFunction("dir",function(appender,args,returnValue){for(var lines=[],i=0,len=args.length;i<len;i++)lines[i]=dir(args[i]);return lines.join(newLine+newLine)}),ConsoleAppender.addGlobalCommandLineFunction("dirxml",function(appender,args,returnValue){for(var lines=[],i=0,len=args.length;i<len;i++)lines[i]=getXhtml(args[i]);return lines.join(newLine+newLine)}),ConsoleAppender.addGlobalCommandLineFunction("cd",function(appender,args,returnValue){var win,message;return 0===args.length||""===args[0]?(win=window,message="Command line set to run in main window"):args[0].window==args[0]?(win=args[0],message="Command line set to run in frame '"+args[0].name+"'"):(win=window.frames[args[0]],win?message="Command line set to run in frame '"+args[0]+"'":(returnValue.isError=!0,message="Frame '"+args[0]+"' does not exist",win=appender.getCommandWindow())),appender.setCommandWindow(win),message}),ConsoleAppender.addGlobalCommandLineFunction("clear",function(appender,args,returnValue){returnValue.appendResult=!1,appender.clear()}),ConsoleAppender.addGlobalCommandLineFunction("keys",function(appender,args,returnValue){var keys=[];for(var k in args[0])keys.push(k);return keys}),ConsoleAppender.addGlobalCommandLineFunction("values",function(appender,args,returnValue){var values=[];for(var k in args[0])try{values.push(args[0][k])}catch(ex){logLog.warn("values(): Unable to obtain value for key "+k+". Details: "+getExceptionMessage(ex))}return values}),ConsoleAppender.addGlobalCommandLineFunction("expansionDepth",function(appender,args,returnValue){var expansionDepth=parseInt(args[0],10);return isNaN(expansionDepth)||expansionDepth<0?(returnValue.isError=!0,""+args[0]+" is not a valid expansion depth"):(appender.setCommandLineObjectExpansionDepth(expansionDepth),"Object expansion depth set to "+expansionDepth)})}function init(){createCommandLineFunctions()}var nodeTypes={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},preFormattedElements=["script","pre"],emptyElements=["br","img","hr","param","link","area","input","col","base","meta"],indentationUnit="  ";init()}(),log4javascript.setDocumentReady=function(){pageLoaded=!0,log4javascript.dispatchEvent("load",{})},window.addEventListener)window.addEventListener("load",log4javascript.setDocumentReady,!1);else if(window.attachEvent)window.attachEvent("onload",log4javascript.setDocumentReady);else{var oldOnload=window.onload;"function"!=typeof window.onload?window.onload=log4javascript.setDocumentReady:window.onload=function(evt){oldOnload&&oldOnload(evt),log4javascript.setDocumentReady()}}return log4javascript},this),!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.PhotoSwipe=b()}(this,function(){"use strict";var a=function(a,b,c,d){var e={features:null,bind:function(a,b,c,d){var e=(d?"remove":"add")+"EventListener";b=b.split(" ");for(var f=0;f<b.length;f++)b[f]&&a[e](b[f],c,!1)},isArray:function(a){return a instanceof Array},createEl:function(a,b){var c=document.createElement(b||"div");return a&&(c.className=a),c},getScrollY:function(){var a=window.pageYOffset;return void 0!==a?a:document.documentElement.scrollTop},unbind:function(a,b,c){e.bind(a,b,c,!0)},removeClass:function(a,b){var c=new RegExp("(\\s|^)"+b+"(\\s|$)");a.className=a.className.replace(c," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")},addClass:function(a,b){e.hasClass(a,b)||(a.className+=(a.className?" ":"")+b)},hasClass:function(a,b){return a.className&&new RegExp("(^|\\s)"+b+"(\\s|$)").test(a.className)},getChildByClass:function(a,b){for(var c=a.firstChild;c;){if(e.hasClass(c,b))return c;c=c.nextSibling}},arraySearch:function(a,b,c){for(var d=a.length;d--;)if(a[d][c]===b)return d;return-1},extend:function(a,b,c){for(var d in b)if(b.hasOwnProperty(d)){if(c&&a.hasOwnProperty(d))continue;a[d]=b[d]}},easing:{sine:{out:function(a){return Math.sin(a*(Math.PI/2))},inOut:function(a){return-(Math.cos(Math.PI*a)-1)/2}},cubic:{out:function(a){return--a*a*a+1}}},detectFeatures:function(){if(e.features)return e.features;var a=e.createEl(),b=a.style,c="",d={};if(d.oldIE=document.all&&!document.addEventListener,d.touch="ontouchstart"in window,window.requestAnimationFrame&&(d.raf=window.requestAnimationFrame,d.caf=window.cancelAnimationFrame),d.pointerEvent=navigator.pointerEnabled||navigator.msPointerEnabled,!d.pointerEvent){var f=navigator.userAgent;if(/iP(hone|od)/.test(navigator.platform)){var g=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);g&&g.length>0&&(g=parseInt(g[1],10),g>=1&&8>g&&(d.isOldIOSPhone=!0))}var h=f.match(/Android\s([0-9\.]*)/),i=h?h[1]:0;i=parseFloat(i),i>=1&&(4.4>i&&(d.isOldAndroid=!0),d.androidVersion=i),d.isMobileOpera=/opera mini|opera mobi/i.test(f)}for(var j,k,l=["transform","perspective","animationName"],m=["","webkit","Moz","ms","O"],n=0;4>n;n++){c=m[n];for(var o=0;3>o;o++)j=l[o],k=c+(c?j.charAt(0).toUpperCase()+j.slice(1):j),!d[j]&&k in b&&(d[j]=k);c&&!d.raf&&(c=c.toLowerCase(),d.raf=window[c+"RequestAnimationFrame"],d.raf&&(d.caf=window[c+"CancelAnimationFrame"]||window[c+"CancelRequestAnimationFrame"]))}if(!d.raf){var p=0;d.raf=function(a){var b=(new Date).getTime(),c=Math.max(0,16-(b-p)),d=window.setTimeout(function(){a(b+c)},c);return p=b+c,d},d.caf=function(a){clearTimeout(a)}}return d.svg=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,e.features=d,d}};e.detectFeatures(),e.features.oldIE&&(e.bind=function(a,b,c,d){b=b.split(" ");for(var e,f=(d?"detach":"attach")+"Event",g=function(){c.handleEvent.call(c)},h=0;h<b.length;h++)if(e=b[h])if("object"==typeof c&&c.handleEvent){if(d){if(!c["oldIE"+e])return!1}else c["oldIE"+e]=g;a[f]("on"+e,c["oldIE"+e])}else a[f]("on"+e,c)});var f=this,g=25,h=3,i={allowPanToNext:!0,spacing:.12,bgOpacity:1,mouseUsed:!1,loop:!0,pinchToClose:!0,closeOnScroll:!0,closeOnVerticalDrag:!0,verticalDragRange:.75,hideAnimationDuration:333,showAnimationDuration:333,showHideOpacity:!1,focus:!0,escKey:!0,arrowKeys:!0,mainScrollEndFriction:.35,panEndFriction:.35,isClickableElement:function(a){return"A"===a.tagName},getDoubleTapZoom:function(a,b){return a?1:b.initialZoomLevel<.7?1:1.33},maxSpreadZoom:1.33,modal:!0,scaleMode:"fit",alwaysFadeIn:!1};e.extend(i,d);var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la=function(){return{x:0,y:0}},ma=la(),na=la(),oa=la(),pa={},qa=0,ra={},sa=la(),ta=0,ua=!0,va=[],wa={},xa=!1,ya=function(a,b){e.extend(f,b.publicMethods),va.push(a)},za=function(a){var b=_b();return a>b-1?a-b:0>a?b+a:a},Aa={},Ba=function(a,b){return Aa[a]||(Aa[a]=[]),Aa[a].push(b)},Ca=function(a){var b=Aa[a];if(b){var c=Array.prototype.slice.call(arguments);c.shift();for(var d=0;d<b.length;d++)b[d].apply(f,c)}},Da=function(){return(new Date).getTime()},Ea=function(a){ia=a,f.bg.style.opacity=a*i.bgOpacity},Fa=function(a,b,c,d,e){(!xa||e&&e!==f.currItem)&&(d/=e?e.fitRatio:f.currItem.fitRatio),a[E]=u+b+"px, "+c+"px"+v+" scale("+d+")"},Ga=function(a){da&&(a&&(s>f.currItem.fitRatio?xa||(lc(f.currItem,!1,!0),xa=!0):xa&&(lc(f.currItem),xa=!1)),Fa(da,oa.x,oa.y,s))},Ha=function(a){a.container&&Fa(a.container.style,a.initialPosition.x,a.initialPosition.y,a.initialZoomLevel,a)},Ia=function(a,b){b[E]=u+a+"px, 0px"+v},Ja=function(a,b){if(!i.loop&&b){var c=m+(sa.x*qa-a)/sa.x,d=Math.round(a-sb.x);(0>c&&d>0||c>=_b()-1&&0>d)&&(a=sb.x+d*i.mainScrollEndFriction)}sb.x=a,Ia(a,n)},Ka=function(a,b){var c=tb[a]-ra[a];return na[a]+ma[a]+c-c*(b/t)},La=function(a,b){a.x=b.x,a.y=b.y,b.id&&(a.id=b.id)},Ma=function(a){a.x=Math.round(a.x),a.y=Math.round(a.y)},Na=null,Oa=function(){Na&&(e.unbind(document,"mousemove",Oa),e.addClass(a,"pswp--has_mouse"),i.mouseUsed=!0,Ca("mouseUsed")),Na=setTimeout(function(){Na=null},100)},Pa=function(){e.bind(document,"keydown",f),N.transform&&e.bind(f.scrollWrap,"click",f),i.mouseUsed||e.bind(document,"mousemove",Oa),e.bind(window,"resize scroll",f),Ca("bindEvents")},Qa=function(){e.unbind(window,"resize",f),e.unbind(window,"scroll",r.scroll),e.unbind(document,"keydown",f),e.unbind(document,"mousemove",Oa),N.transform&&e.unbind(f.scrollWrap,"click",f),U&&e.unbind(window,p,f),Ca("unbindEvents")},Ra=function(a,b){var c=hc(f.currItem,pa,a);return b&&(ca=c),c},Sa=function(a){return a||(a=f.currItem),a.initialZoomLevel},Ta=function(a){return a||(a=f.currItem),a.w>0?i.maxSpreadZoom:1},Ua=function(a,b,c,d){return d===f.currItem.initialZoomLevel?(c[a]=f.currItem.initialPosition[a],!0):(c[a]=Ka(a,d),c[a]>b.min[a]?(c[a]=b.min[a],!0):c[a]<b.max[a]&&(c[a]=b.max[a],!0))},Va=function(){if(E){var b=N.perspective&&!G;return u="translate"+(b?"3d(":"("),void(v=N.perspective?", 0px)":")")}E="left",e.addClass(a,"pswp--ie"),Ia=function(a,b){b.left=a+"px"},Ha=function(a){var b=a.fitRatio>1?1:a.fitRatio,c=a.container.style,d=b*a.w,e=b*a.h;c.width=d+"px",c.height=e+"px",c.left=a.initialPosition.x+"px",c.top=a.initialPosition.y+"px"},Ga=function(){if(da){var a=da,b=f.currItem,c=b.fitRatio>1?1:b.fitRatio,d=c*b.w,e=c*b.h;a.width=d+"px",a.height=e+"px",a.left=oa.x+"px",a.top=oa.y+"px"}}},Wa=function(a){var b="";i.escKey&&27===a.keyCode?b="close":i.arrowKeys&&(37===a.keyCode?b="prev":39===a.keyCode&&(b="next")),b&&(a.ctrlKey||a.altKey||a.shiftKey||a.metaKey||(a.preventDefault?a.preventDefault():a.returnValue=!1,f[b]()))},Xa=function(a){a&&(X||W||ea||S)&&(a.preventDefault(),a.stopPropagation())},Ya=function(){f.setScrollOffset(0,e.getScrollY())},Za={},$a=0,_a=function(a){Za[a]&&(Za[a].raf&&I(Za[a].raf),
$a--,delete Za[a])},ab=function(a){Za[a]&&_a(a),Za[a]||($a++,Za[a]={})},bb=function(){for(var a in Za)Za.hasOwnProperty(a)&&_a(a)},cb=function(a,b,c,d,e,f,g){var h,i=Da();ab(a);var j=function(){if(Za[a]){if(h=Da()-i,h>=d)return _a(a),f(c),void(g&&g());f((c-b)*e(h/d)+b),Za[a].raf=H(j)}};j()},db={shout:Ca,listen:Ba,viewportSize:pa,options:i,isMainScrollAnimating:function(){return ea},getZoomLevel:function(){return s},getCurrentIndex:function(){return m},isDragging:function(){return U},isZooming:function(){return _},setScrollOffset:function(a,b){ra.x=a,M=ra.y=b,Ca("updateScrollOffset",ra)},applyZoomPan:function(a,b,c,d){oa.x=b,oa.y=c,s=a,Ga(d)},init:function(){if(!j&&!k){var c;f.framework=e,f.template=a,f.bg=e.getChildByClass(a,"pswp__bg"),J=a.className,j=!0,N=e.detectFeatures(),H=N.raf,I=N.caf,E=N.transform,L=N.oldIE,f.scrollWrap=e.getChildByClass(a,"pswp__scroll-wrap"),f.container=e.getChildByClass(f.scrollWrap,"pswp__container"),n=f.container.style,f.itemHolders=y=[{el:f.container.children[0],wrap:0,index:-1},{el:f.container.children[1],wrap:0,index:-1},{el:f.container.children[2],wrap:0,index:-1}],y[0].el.style.display=y[2].el.style.display="none",Va(),r={resize:f.updateSize,scroll:Ya,keydown:Wa,click:Xa};var d=N.isOldIOSPhone||N.isOldAndroid||N.isMobileOpera;for(N.animationName&&N.transform&&!d||(i.showAnimationDuration=i.hideAnimationDuration=0),c=0;c<va.length;c++)f["init"+va[c]]();if(b){var g=f.ui=new b(f,e);g.init()}Ca("firstUpdate"),m=m||i.index||0,(isNaN(m)||0>m||m>=_b())&&(m=0),f.currItem=$b(m),(N.isOldIOSPhone||N.isOldAndroid)&&(ua=!1),a.setAttribute("aria-hidden","false"),i.modal&&(ua?a.style.position="fixed":(a.style.position="absolute",a.style.top=e.getScrollY()+"px")),void 0===M&&(Ca("initialLayout"),M=K=e.getScrollY());var l="pswp--open ";for(i.mainClass&&(l+=i.mainClass+" "),i.showHideOpacity&&(l+="pswp--animate_opacity "),l+=G?"pswp--touch":"pswp--notouch",l+=N.animationName?" pswp--css_animation":"",l+=N.svg?" pswp--svg":"",e.addClass(a,l),f.updateSize(),o=-1,ta=null,c=0;h>c;c++)Ia((c+o)*sa.x,y[c].el.style);L||e.bind(f.scrollWrap,q,f),Ba("initialZoomInEnd",function(){f.setContent(y[0],m-1),f.setContent(y[2],m+1),y[0].el.style.display=y[2].el.style.display="block",i.focus&&a.focus(),Pa()}),f.setContent(y[1],m),f.updateCurrItem(),Ca("afterInit"),ua||(w=setInterval(function(){$a||U||_||s!==f.currItem.initialZoomLevel||f.updateSize()},1e3)),e.addClass(a,"pswp--visible")}},close:function(){j&&(j=!1,k=!0,Ca("close"),Qa(),bc(f.currItem,null,!0,f.destroy))},destroy:function(){Ca("destroy"),Wb&&clearTimeout(Wb),a.setAttribute("aria-hidden","true"),a.className=J,w&&clearInterval(w),e.unbind(f.scrollWrap,q,f),e.unbind(window,"scroll",f),yb(),bb(),Aa=null},panTo:function(a,b,c){c||(a>ca.min.x?a=ca.min.x:a<ca.max.x&&(a=ca.max.x),b>ca.min.y?b=ca.min.y:b<ca.max.y&&(b=ca.max.y)),oa.x=a,oa.y=b,Ga()},handleEvent:function(a){a=a||window.event,r[a.type]&&r[a.type](a)},goTo:function(a){a=za(a);var b=a-m;ta=b,m=a,f.currItem=$b(m),qa-=b,Ja(sa.x*qa),bb(),ea=!1,f.updateCurrItem()},next:function(){f.goTo(m+1)},prev:function(){f.goTo(m-1)},updateCurrZoomItem:function(a){if(a&&Ca("beforeChange",0),y[1].el.children.length){var b=y[1].el.children[0];da=e.hasClass(b,"pswp__zoom-wrap")?b.style:null}else da=null;ca=f.currItem.bounds,t=s=f.currItem.initialZoomLevel,oa.x=ca.center.x,oa.y=ca.center.y,a&&Ca("afterChange")},invalidateCurrItems:function(){x=!0;for(var a=0;h>a;a++)y[a].item&&(y[a].item.needsUpdate=!0)},updateCurrItem:function(a){if(0!==ta){var b,c=Math.abs(ta);if(!(a&&2>c)){f.currItem=$b(m),xa=!1,Ca("beforeChange",ta),c>=h&&(o+=ta+(ta>0?-h:h),c=h);for(var d=0;c>d;d++)ta>0?(b=y.shift(),y[h-1]=b,o++,Ia((o+2)*sa.x,b.el.style),f.setContent(b,m-c+d+1+1)):(b=y.pop(),y.unshift(b),o--,Ia(o*sa.x,b.el.style),f.setContent(b,m+c-d-1-1));if(da&&1===Math.abs(ta)){var e=$b(z);e.initialZoomLevel!==s&&(hc(e,pa),lc(e),Ha(e))}ta=0,f.updateCurrZoomItem(),z=m,Ca("afterChange")}}},updateSize:function(b){if(!ua&&i.modal){var c=e.getScrollY();if(M!==c&&(a.style.top=c+"px",M=c),!b&&wa.x===window.innerWidth&&wa.y===window.innerHeight)return;wa.x=window.innerWidth,wa.y=window.innerHeight,a.style.height=wa.y+"px"}if(pa.x=f.scrollWrap.clientWidth,pa.y=f.scrollWrap.clientHeight,Ya(),sa.x=pa.x+Math.round(pa.x*i.spacing),sa.y=pa.y,Ja(sa.x*qa),Ca("beforeResize"),void 0!==o){for(var d,g,j,k=0;h>k;k++)d=y[k],Ia((k+o)*sa.x,d.el.style),j=m+k-1,i.loop&&_b()>2&&(j=za(j)),g=$b(j),g&&(x||g.needsUpdate||!g.bounds)?(f.cleanSlide(g),f.setContent(d,j),1===k&&(f.currItem=g,f.updateCurrZoomItem(!0)),g.needsUpdate=!1):-1===d.index&&j>=0&&f.setContent(d,j),g&&g.container&&(hc(g,pa),lc(g),Ha(g));x=!1}t=s=f.currItem.initialZoomLevel,ca=f.currItem.bounds,ca&&(oa.x=ca.center.x,oa.y=ca.center.y,Ga(!0)),Ca("resize")},zoomTo:function(a,b,c,d,f){b&&(t=s,tb.x=Math.abs(b.x)-oa.x,tb.y=Math.abs(b.y)-oa.y,La(na,oa));var g=Ra(a,!1),h={};Ua("x",g,h,a),Ua("y",g,h,a);var i=s,j={x:oa.x,y:oa.y};Ma(h);var k=function(b){1===b?(s=a,oa.x=h.x,oa.y=h.y):(s=(a-i)*b+i,oa.x=(h.x-j.x)*b+j.x,oa.y=(h.y-j.y)*b+j.y),f&&f(b),Ga(1===b)};c?cb("customZoomTo",0,1,c,d||e.easing.sine.inOut,k):k(1)}},eb=30,fb=10,gb={},hb={},ib={},jb={},kb={},lb=[],mb={},nb=[],ob={},pb=0,qb=la(),rb=0,sb=la(),tb=la(),ub=la(),vb=function(a,b){return a.x===b.x&&a.y===b.y},wb=function(a,b){return Math.abs(a.x-b.x)<g&&Math.abs(a.y-b.y)<g},xb=function(a,b){return ob.x=Math.abs(a.x-b.x),ob.y=Math.abs(a.y-b.y),Math.sqrt(ob.x*ob.x+ob.y*ob.y)},yb=function(){Y&&(I(Y),Y=null)},zb=function(){U&&(Y=H(zb),Pb())},Ab=function(){return!("fit"===i.scaleMode&&s===f.currItem.initialZoomLevel)},Bb=function(a,b){return!!a&&!(a.className&&a.className.indexOf("pswp__scroll-wrap")>-1)&&(b(a)?a:Bb(a.parentNode,b))},Cb={},Db=function(a,b){return Cb.prevent=!Bb(a.target,i.isClickableElement),Ca("preventDragEvent",a,b,Cb),Cb.prevent},Eb=function(a,b){return b.x=a.pageX,b.y=a.pageY,b.id=a.identifier,b},Fb=function(a,b,c){c.x=.5*(a.x+b.x),c.y=.5*(a.y+b.y)},Gb=function(a,b,c){if(a-P>50){var d=nb.length>2?nb.shift():{};d.x=b,d.y=c,nb.push(d),P=a}},Hb=function(){var a=oa.y-f.currItem.initialPosition.y;return 1-Math.abs(a/(pa.y/2))},Ib={},Jb={},Kb=[],Lb=function(a){for(;Kb.length>0;)Kb.pop();return F?(ka=0,lb.forEach(function(a){0===ka?Kb[0]=a:1===ka&&(Kb[1]=a),ka++})):a.type.indexOf("touch")>-1?a.touches&&a.touches.length>0&&(Kb[0]=Eb(a.touches[0],Ib),a.touches.length>1&&(Kb[1]=Eb(a.touches[1],Jb))):(Ib.x=a.pageX,Ib.y=a.pageY,Ib.id="",Kb[0]=Ib),Kb},Mb=function(a,b){var c,d,e,g,h=0,j=oa[a]+b[a],k=b[a]>0,l=sb.x+b.x,m=sb.x-mb.x;return c=j>ca.min[a]||j<ca.max[a]?i.panEndFriction:1,j=oa[a]+b[a]*c,!i.allowPanToNext&&s!==f.currItem.initialZoomLevel||(da?"h"!==fa||"x"!==a||W||(k?(j>ca.min[a]&&(c=i.panEndFriction,h=ca.min[a]-j,d=ca.min[a]-na[a]),(0>=d||0>m)&&_b()>1?(g=l,0>m&&l>mb.x&&(g=mb.x)):ca.min.x!==ca.max.x&&(e=j)):(j<ca.max[a]&&(c=i.panEndFriction,h=j-ca.max[a],d=na[a]-ca.max[a]),(0>=d||m>0)&&_b()>1?(g=l,m>0&&l<mb.x&&(g=mb.x)):ca.min.x!==ca.max.x&&(e=j))):g=l,"x"!==a)?void(ea||Z||s>f.currItem.fitRatio&&(oa[a]+=b[a]*c)):(void 0!==g&&(Ja(g,!0),Z=g!==mb.x),ca.min.x!==ca.max.x&&(void 0!==e?oa.x=e:Z||(oa.x+=b.x*c)),void 0!==g)},Nb=function(a){if(!("mousedown"===a.type&&a.button>0)){if(Zb)return void a.preventDefault();if(!T||"mousedown"!==a.type){if(Db(a,!0)&&a.preventDefault(),Ca("pointerDown"),F){var b=e.arraySearch(lb,a.pointerId,"id");0>b&&(b=lb.length),lb[b]={x:a.pageX,y:a.pageY,id:a.pointerId}}var c=Lb(a),d=c.length;$=null,bb(),U&&1!==d||(U=ga=!0,e.bind(window,p,f),R=ja=ha=S=Z=X=V=W=!1,fa=null,Ca("firstTouchStart",c),La(na,oa),ma.x=ma.y=0,La(jb,c[0]),La(kb,jb),mb.x=sa.x*qa,nb=[{x:jb.x,y:jb.y}],P=O=Da(),Ra(s,!0),yb(),zb()),!_&&d>1&&!ea&&!Z&&(t=s,W=!1,_=V=!0,ma.y=ma.x=0,La(na,oa),La(gb,c[0]),La(hb,c[1]),Fb(gb,hb,ub),tb.x=Math.abs(ub.x)-oa.x,tb.y=Math.abs(ub.y)-oa.y,aa=ba=xb(gb,hb))}}},Ob=function(a){if(a.preventDefault(),F){var b=e.arraySearch(lb,a.pointerId,"id");if(b>-1){var c=lb[b];c.x=a.pageX,c.y=a.pageY}}if(U){var d=Lb(a);if(fa||X||_)$=d;else if(sb.x!==sa.x*qa)fa="h";else{var f=Math.abs(d[0].x-jb.x)-Math.abs(d[0].y-jb.y);Math.abs(f)>=fb&&(fa=f>0?"h":"v",$=d)}}},Pb=function(){if($){var a=$.length;if(0!==a)if(La(gb,$[0]),ib.x=gb.x-jb.x,ib.y=gb.y-jb.y,_&&a>1){if(jb.x=gb.x,jb.y=gb.y,!ib.x&&!ib.y&&vb($[1],hb))return;La(hb,$[1]),W||(W=!0,Ca("zoomGestureStarted"));var b=xb(gb,hb),c=Ub(b);c>f.currItem.initialZoomLevel+f.currItem.initialZoomLevel/15&&(ja=!0);var d=1,e=Sa(),g=Ta();if(e>c)if(i.pinchToClose&&!ja&&t<=f.currItem.initialZoomLevel){var h=e-c,j=1-h/(e/1.2);Ea(j),Ca("onPinchClose",j),ha=!0}else d=(e-c)/e,d>1&&(d=1),c=e-d*(e/3);else c>g&&(d=(c-g)/(6*e),d>1&&(d=1),c=g+d*e);0>d&&(d=0),aa=b,Fb(gb,hb,qb),ma.x+=qb.x-ub.x,ma.y+=qb.y-ub.y,La(ub,qb),oa.x=Ka("x",c),oa.y=Ka("y",c),R=c>s,s=c,Ga()}else{if(!fa)return;if(ga&&(ga=!1,Math.abs(ib.x)>=fb&&(ib.x-=$[0].x-kb.x),Math.abs(ib.y)>=fb&&(ib.y-=$[0].y-kb.y)),jb.x=gb.x,jb.y=gb.y,0===ib.x&&0===ib.y)return;if("v"===fa&&i.closeOnVerticalDrag&&!Ab()){ma.y+=ib.y,oa.y+=ib.y;var k=Hb();return S=!0,Ca("onVerticalDrag",k),Ea(k),void Ga()}Gb(Da(),gb.x,gb.y),X=!0,ca=f.currItem.bounds;var l=Mb("x",ib);l||(Mb("y",ib),Ma(oa),Ga())}}},Qb=function(a){if(N.isOldAndroid){if(T&&"mouseup"===a.type)return;a.type.indexOf("touch")>-1&&(clearTimeout(T),T=setTimeout(function(){T=0},600))}Ca("pointerUp"),Db(a,!1)&&a.preventDefault();var b;if(F){var c=e.arraySearch(lb,a.pointerId,"id");if(c>-1)if(b=lb.splice(c,1)[0],navigator.pointerEnabled)b.type=a.pointerType||"mouse";else{var d={4:"mouse",2:"touch",3:"pen"};b.type=d[a.pointerType],b.type||(b.type=a.pointerType||"mouse")}}var g,h=Lb(a),j=h.length;if("mouseup"===a.type&&(j=0),2===j)return $=null,!0;1===j&&La(kb,h[0]),0!==j||fa||ea||(b||("mouseup"===a.type?b={x:a.pageX,y:a.pageY,type:"mouse"}:a.changedTouches&&a.changedTouches[0]&&(b={x:a.changedTouches[0].pageX,y:a.changedTouches[0].pageY,type:"touch"})),Ca("touchRelease",a,b));var k=-1;if(0===j&&(U=!1,e.unbind(window,p,f),yb(),_?k=0:-1!==rb&&(k=Da()-rb)),rb=1===j?Da():-1,g=-1!==k&&150>k?"zoom":"swipe",_&&2>j&&(_=!1,1===j&&(g="zoomPointerUp"),Ca("zoomGestureEnded")),$=null,X||W||ea||S)if(bb(),Q||(Q=Rb()),Q.calculateSwipeSpeed("x"),S){var l=Hb();if(l<i.verticalDragRange)f.close();else{var m=oa.y,n=ia;cb("verticalDrag",0,1,300,e.easing.cubic.out,function(a){oa.y=(f.currItem.initialPosition.y-m)*a+m,Ea((1-n)*a+n),Ga()}),Ca("onVerticalDrag",1)}}else{if((Z||ea)&&0===j){var o=Tb(g,Q);if(o)return;g="zoomPointerUp"}if(!ea)return"swipe"!==g?void Vb():void(!Z&&s>f.currItem.fitRatio&&Sb(Q))}},Rb=function(){var a,b,c={lastFlickOffset:{},lastFlickDist:{},lastFlickSpeed:{},slowDownRatio:{},slowDownRatioReverse:{},speedDecelerationRatio:{},speedDecelerationRatioAbs:{},distanceOffset:{},backAnimDestination:{},backAnimStarted:{},calculateSwipeSpeed:function(d){nb.length>1?(a=Da()-P+50,b=nb[nb.length-2][d]):(a=Da()-O,b=kb[d]),c.lastFlickOffset[d]=jb[d]-b,c.lastFlickDist[d]=Math.abs(c.lastFlickOffset[d]),c.lastFlickDist[d]>20?c.lastFlickSpeed[d]=c.lastFlickOffset[d]/a:c.lastFlickSpeed[d]=0,Math.abs(c.lastFlickSpeed[d])<.1&&(c.lastFlickSpeed[d]=0),c.slowDownRatio[d]=.95,c.slowDownRatioReverse[d]=1-c.slowDownRatio[d],c.speedDecelerationRatio[d]=1},calculateOverBoundsAnimOffset:function(a,b){c.backAnimStarted[a]||(oa[a]>ca.min[a]?c.backAnimDestination[a]=ca.min[a]:oa[a]<ca.max[a]&&(c.backAnimDestination[a]=ca.max[a]),void 0!==c.backAnimDestination[a]&&(c.slowDownRatio[a]=.7,c.slowDownRatioReverse[a]=1-c.slowDownRatio[a],c.speedDecelerationRatioAbs[a]<.05&&(c.lastFlickSpeed[a]=0,c.backAnimStarted[a]=!0,cb("bounceZoomPan"+a,oa[a],c.backAnimDestination[a],b||300,e.easing.sine.out,function(b){oa[a]=b,Ga()}))))},calculateAnimOffset:function(a){c.backAnimStarted[a]||(c.speedDecelerationRatio[a]=c.speedDecelerationRatio[a]*(c.slowDownRatio[a]+c.slowDownRatioReverse[a]-c.slowDownRatioReverse[a]*c.timeDiff/10),c.speedDecelerationRatioAbs[a]=Math.abs(c.lastFlickSpeed[a]*c.speedDecelerationRatio[a]),c.distanceOffset[a]=c.lastFlickSpeed[a]*c.speedDecelerationRatio[a]*c.timeDiff,oa[a]+=c.distanceOffset[a])},panAnimLoop:function(){return Za.zoomPan&&(Za.zoomPan.raf=H(c.panAnimLoop),c.now=Da(),c.timeDiff=c.now-c.lastNow,c.lastNow=c.now,c.calculateAnimOffset("x"),c.calculateAnimOffset("y"),Ga(),c.calculateOverBoundsAnimOffset("x"),c.calculateOverBoundsAnimOffset("y"),c.speedDecelerationRatioAbs.x<.05&&c.speedDecelerationRatioAbs.y<.05)?(oa.x=Math.round(oa.x),oa.y=Math.round(oa.y),Ga(),void _a("zoomPan")):void 0}};return c},Sb=function(a){return a.calculateSwipeSpeed("y"),ca=f.currItem.bounds,a.backAnimDestination={},a.backAnimStarted={},Math.abs(a.lastFlickSpeed.x)<=.05&&Math.abs(a.lastFlickSpeed.y)<=.05?(a.speedDecelerationRatioAbs.x=a.speedDecelerationRatioAbs.y=0,a.calculateOverBoundsAnimOffset("x"),a.calculateOverBoundsAnimOffset("y"),!0):(ab("zoomPan"),a.lastNow=Da(),void a.panAnimLoop())},Tb=function(a,b){var c;ea||(pb=m);var d;if("swipe"===a){var g=jb.x-kb.x,h=b.lastFlickDist.x<10;g>eb&&(h||b.lastFlickOffset.x>20)?d=-1:-eb>g&&(h||b.lastFlickOffset.x<-20)&&(d=1)}var j;d&&(m+=d,0>m?(m=i.loop?_b()-1:0,j=!0):m>=_b()&&(m=i.loop?0:_b()-1,j=!0),(!j||i.loop)&&(ta+=d,qa-=d,c=!0));var k,l=sa.x*qa,n=Math.abs(l-sb.x);return c||l>sb.x==b.lastFlickSpeed.x>0?(k=Math.abs(b.lastFlickSpeed.x)>0?n/Math.abs(b.lastFlickSpeed.x):333,k=Math.min(k,400),k=Math.max(k,250)):k=333,pb===m&&(c=!1),ea=!0,Ca("mainScrollAnimStart"),cb("mainScroll",sb.x,l,k,e.easing.cubic.out,Ja,function(){bb(),ea=!1,pb=-1,(c||pb!==m)&&f.updateCurrItem(),Ca("mainScrollAnimComplete")}),c&&f.updateCurrItem(!0),c},Ub=function(a){return 1/ba*a*t},Vb=function(){var a=s,b=Sa(),c=Ta();b>s?a=b:s>c&&(a=c);var d,g=1,h=ia;return ha&&!R&&!ja&&b>s?(f.close(),!0):(ha&&(d=function(a){Ea((g-h)*a+h)}),f.zoomTo(a,0,200,e.easing.cubic.out,d),!0)};ya("Gestures",{publicMethods:{initGestures:function(){var a=function(a,b,c,d,e){A=a+b,B=a+c,C=a+d,D=e?a+e:""};F=N.pointerEvent,F&&N.touch&&(N.touch=!1),F?navigator.pointerEnabled?a("pointer","down","move","up","cancel"):a("MSPointer","Down","Move","Up","Cancel"):N.touch?(a("touch","start","move","end","cancel"),G=!0):a("mouse","down","move","up"),p=B+" "+C+" "+D,q=A,F&&!G&&(G=navigator.maxTouchPoints>1||navigator.msMaxTouchPoints>1),f.likelyTouchDevice=G,r[A]=Nb,r[B]=Ob,r[C]=Qb,D&&(r[D]=r[C]),N.touch&&(q+=" mousedown",p+=" mousemove mouseup",r.mousedown=r[A],r.mousemove=r[B],r.mouseup=r[C]),G||(i.allowPanToNext=!1)}}});var Wb,Xb,Yb,Zb,$b,_b,ac,bc=function(b,c,d,g){Wb&&clearTimeout(Wb),Zb=!0,Yb=!0;var h;b.initialLayout?(h=b.initialLayout,b.initialLayout=null):h=i.getThumbBoundsFn&&i.getThumbBoundsFn(m);var j=d?i.hideAnimationDuration:i.showAnimationDuration,k=function(){_a("initialZoom"),d?(f.template.removeAttribute("style"),f.bg.removeAttribute("style")):(Ea(1),c&&(c.style.display="block"),e.addClass(a,"pswp--animated-in"),Ca("initialZoom"+(d?"OutEnd":"InEnd"))),g&&g(),Zb=!1};if(!j||!h||void 0===h.x){var n=function(){Ca("initialZoom"+(d?"Out":"In")),s=b.initialZoomLevel,La(oa,b.initialPosition),Ga(),a.style.opacity=d?0:1,Ea(1),k()};return void n()}var o=function(){var c=l,g=!f.currItem.src||f.currItem.loadError||i.showHideOpacity;b.miniImg&&(b.miniImg.style.webkitBackfaceVisibility="hidden"),d||(s=h.w/b.w,oa.x=h.x,oa.y=h.y-K,f[g?"template":"bg"].style.opacity=.001,Ga()),ab("initialZoom"),d&&!c&&e.removeClass(a,"pswp--animated-in"),g&&(d?e[(c?"remove":"add")+"Class"](a,"pswp--animate_opacity"):setTimeout(function(){e.addClass(a,"pswp--animate_opacity")},30)),Wb=setTimeout(function(){if(Ca("initialZoom"+(d?"Out":"In")),d){var f=h.w/b.w,i={x:oa.x,y:oa.y},l=s,m=ia,n=function(b){1===b?(s=f,oa.x=h.x,oa.y=h.y-M):(s=(f-l)*b+l,oa.x=(h.x-i.x)*b+i.x,oa.y=(h.y-M-i.y)*b+i.y),Ga(),g?a.style.opacity=1-b:Ea(m-b*m)};c?cb("initialZoom",0,1,j,e.easing.cubic.out,n,k):(n(1),Wb=setTimeout(k,j+20))}else s=b.initialZoomLevel,La(oa,b.initialPosition),Ga(),Ea(1),g?a.style.opacity=1:Ea(1),Wb=setTimeout(k,j+20)},d?25:90)};o()},cc={},dc=[],ec={index:0,errorMsg:'<div class="pswp__error-msg"><a href="%url%" target="_blank">The image</a> could not be loaded.</div>',forceProgressiveLoading:!1,preload:[1,1],getNumItemsFn:function(){return Xb.length}},fc=function(){return{center:{x:0,y:0},max:{x:0,y:0},min:{x:0,y:0}}},gc=function(a,b,c){var d=a.bounds;d.center.x=Math.round((cc.x-b)/2),d.center.y=Math.round((cc.y-c)/2)+a.vGap.top,d.max.x=b>cc.x?Math.round(cc.x-b):d.center.x,d.max.y=c>cc.y?Math.round(cc.y-c)+a.vGap.top:d.center.y,d.min.x=b>cc.x?0:d.center.x,d.min.y=c>cc.y?a.vGap.top:d.center.y},hc=function(a,b,c){if(a.src&&!a.loadError){var d=!c;if(d&&(a.vGap||(a.vGap={top:0,bottom:0}),Ca("parseVerticalMargin",a)),cc.x=b.x,cc.y=b.y-a.vGap.top-a.vGap.bottom,d){var e=cc.x/a.w,f=cc.y/a.h;a.fitRatio=f>e?e:f;var g=i.scaleMode;"orig"===g?c=1:"fit"===g&&(c=a.fitRatio),c>1&&(c=1),a.initialZoomLevel=c,a.bounds||(a.bounds=fc())}if(!c)return;return gc(a,a.w*c,a.h*c),d&&c===a.initialZoomLevel&&(a.initialPosition=a.bounds.center),a.bounds}return a.w=a.h=0,a.initialZoomLevel=a.fitRatio=1,a.bounds=fc(),a.initialPosition=a.bounds.center,a.bounds},ic=function(a,b,c,d,e,f){b.loadError||d&&(b.imageAppended=!0,lc(b,d),c.appendChild(d),f&&setTimeout(function(){b&&b.loaded&&b.placeholder&&(b.placeholder.style.display="none",b.placeholder=null)},500))},jc=function(a){a.loading=!0,a.loaded=!1;var b=a.img=e.createEl("pswp__img","img"),c=function(){a.loading=!1,a.loaded=!0,a.loadComplete?a.loadComplete(a):a.img=null,b.onload=b.onerror=null,b=null};return b.onload=c,b.onerror=function(){a.loadError=!0,c()},b.src=a.src,b},kc=function(a,b){return a.src&&a.loadError&&a.container?(b&&(a.container.innerHTML=""),a.container.innerHTML=i.errorMsg.replace("%url%",a.src),!0):void 0},lc=function(a,b,c){if(a.src){b||(b=a.container.lastChild);var d=c?a.w:Math.round(a.w*a.fitRatio),e=c?a.h:Math.round(a.h*a.fitRatio);a.placeholder&&!a.loaded&&(a.placeholder.style.width=d+"px",a.placeholder.style.height=e+"px"),b.style.width=d+"px",b.style.height=e+"px"}},mc=function(){if(dc.length){for(var a,b=0;b<dc.length;b++)a=dc[b],a.holder.index===a.index&&ic(a.index,a.item,a.baseDiv,a.img,!1,a.clearPlaceholder);dc=[]}};ya("Controller",{publicMethods:{lazyLoadItem:function(a){a=za(a);var b=$b(a);!b||b.loaded||b.loading||(Ca("gettingData",a,b),b.src&&jc(b))},initController:function(){e.extend(i,ec,!0),f.items=Xb=c,$b=f.getItemAt,_b=i.getNumItemsFn,ac=i.loop,_b()<3&&(i.loop=!1),Ba("beforeChange",function(a){var b,c=i.preload,d=null===a||a>0,e=Math.min(c[0],_b()),g=Math.min(c[1],_b());for(b=1;(d?g:e)>=b;b++)f.lazyLoadItem(m+b);for(b=1;(d?e:g)>=b;b++)f.lazyLoadItem(m-b)}),Ba("initialLayout",function(){f.currItem.initialLayout=i.getThumbBoundsFn&&i.getThumbBoundsFn(m)}),Ba("mainScrollAnimComplete",mc),Ba("initialZoomInEnd",mc),Ba("destroy",function(){for(var a,b=0;b<Xb.length;b++)a=Xb[b],a.container&&(a.container=null),a.placeholder&&(a.placeholder=null),a.img&&(a.img=null),a.preloader&&(a.preloader=null),a.loadError&&(a.loaded=a.loadError=!1);dc=null})},getItemAt:function(a){return a>=0&&void 0!==Xb[a]&&Xb[a]},allowProgressiveImg:function(){return i.forceProgressiveLoading||!G||i.mouseUsed||screen.width>1200},setContent:function(a,b){i.loop&&(b=za(b));var c=f.getItemAt(a.index);c&&(c.container=null);var d,g=f.getItemAt(b);if(!g)return void(a.el.innerHTML="");Ca("gettingData",b,g),a.index=b,a.item=g;var h=g.container=e.createEl("pswp__zoom-wrap");if(!g.src&&g.html&&(g.html.tagName?h.appendChild(g.html):h.innerHTML=g.html),kc(g),hc(g,pa),!g.src||g.loadError||g.loaded)g.src&&!g.loadError&&(d=e.createEl("pswp__img","img"),d.style.opacity=1,d.src=g.src,lc(g,d),ic(b,g,h,d,!0));else{if(g.loadComplete=function(c){if(j){if(a&&a.index===b){if(kc(c,!0))return c.loadComplete=c.img=null,hc(c,pa),Ha(c),void(a.index===m&&f.updateCurrZoomItem());c.imageAppended?!Zb&&c.placeholder&&(c.placeholder.style.display="none",c.placeholder=null):N.transform&&(ea||Zb)?dc.push({item:c,baseDiv:h,img:c.img,index:b,holder:a,clearPlaceholder:!0}):ic(b,c,h,c.img,ea||Zb,!0)}c.loadComplete=null,c.img=null,Ca("imageLoadComplete",b,c)}},e.features.transform){var k="pswp__img pswp__img--placeholder";k+=g.msrc?"":" pswp__img--placeholder--blank";var l=e.createEl(k,g.msrc?"img":"");g.msrc&&(l.src=g.msrc),lc(g,l),h.appendChild(l),g.placeholder=l}g.loading||jc(g),f.allowProgressiveImg()&&(!Yb&&N.transform?dc.push({item:g,baseDiv:h,img:g.img,index:b,holder:a}):ic(b,g,h,g.img,!0,!0))}Yb||b!==m?Ha(g):(da=h.style,bc(g,d||g.img)),a.el.innerHTML="",a.el.appendChild(h)},cleanSlide:function(a){a.img&&(a.img.onload=a.img.onerror=null),a.loaded=a.loading=a.img=a.imageAppended=!1}}});var nc,oc={},pc=function(a,b,c){var d=document.createEvent("CustomEvent"),e={origEvent:a,target:a.target,releasePoint:b,pointerType:c||"touch"};d.initCustomEvent("pswpTap",!0,!0,e),a.target.dispatchEvent(d)};ya("Tap",{publicMethods:{initTap:function(){Ba("firstTouchStart",f.onTapStart),Ba("touchRelease",f.onTapRelease),Ba("destroy",function(){oc={},nc=null})},onTapStart:function(a){a.length>1&&(clearTimeout(nc),nc=null)},onTapRelease:function(a,b){if(b&&!X&&!V&&!$a){var c=b;if(nc&&(clearTimeout(nc),nc=null,wb(c,oc)))return void Ca("doubleTap",c);if("mouse"===b.type)return void pc(a,b,"mouse");var d=a.target.tagName.toUpperCase();if("BUTTON"===d||e.hasClass(a.target,"pswp__single-tap"))return void pc(a,b);La(oc,c),nc=setTimeout(function(){pc(a,b),nc=null},300)}}}});var qc;ya("DesktopZoom",{publicMethods:{initDesktopZoom:function(){L||(G?Ba("mouseUsed",function(){f.setupDesktopZoom()}):f.setupDesktopZoom(!0))},setupDesktopZoom:function(b){qc={};var c="wheel mousewheel DOMMouseScroll";Ba("bindEvents",function(){e.bind(a,c,f.handleMouseWheel)}),Ba("unbindEvents",function(){qc&&e.unbind(a,c,f.handleMouseWheel)}),f.mouseZoomedIn=!1;var d,g=function(){f.mouseZoomedIn&&(e.removeClass(a,"pswp--zoomed-in"),f.mouseZoomedIn=!1),1>s?e.addClass(a,"pswp--zoom-allowed"):e.removeClass(a,"pswp--zoom-allowed"),h()},h=function(){d&&(e.removeClass(a,"pswp--dragging"),d=!1)};Ba("resize",g),Ba("afterChange",g),Ba("pointerDown",function(){f.mouseZoomedIn&&(d=!0,e.addClass(a,"pswp--dragging"))}),Ba("pointerUp",h),b||g()},handleMouseWheel:function(a){if(s<=f.currItem.fitRatio)return i.modal&&(!i.closeOnScroll||$a||U?a.preventDefault():E&&Math.abs(a.deltaY)>2&&(l=!0,f.close())),!0;if(a.stopPropagation(),qc.x=0,"deltaX"in a)1===a.deltaMode?(qc.x=18*a.deltaX,qc.y=18*a.deltaY):(qc.x=a.deltaX,qc.y=a.deltaY);else if("wheelDelta"in a)a.wheelDeltaX&&(qc.x=-.16*a.wheelDeltaX),a.wheelDeltaY?qc.y=-.16*a.wheelDeltaY:qc.y=-.16*a.wheelDelta;else{if(!("detail"in a))return;qc.y=a.detail}Ra(s,!0);var b=oa.x-qc.x,c=oa.y-qc.y;(i.modal||b<=ca.min.x&&b>=ca.max.x&&c<=ca.min.y&&c>=ca.max.y)&&a.preventDefault(),f.panTo(b,c)},toggleDesktopZoom:function(b){b=b||{x:pa.x/2+ra.x,y:pa.y/2+ra.y};var c=i.getDoubleTapZoom(!0,f.currItem),d=s===c;f.mouseZoomedIn=!d,f.zoomTo(d?f.currItem.initialZoomLevel:c,b,333),e[(d?"remove":"add")+"Class"](a,"pswp--zoomed-in")}}});var rc,sc,tc,uc,vc,wc,xc,yc,zc,Ac,Bc,Cc,Dc={history:!0,galleryUID:1},Ec=function(){return Bc.hash.substring(1)},Fc=function(){rc&&clearTimeout(rc),tc&&clearTimeout(tc)},Gc=function(){var a=Ec(),b={};if(a.length<5)return b;var c,d=a.split("&");for(c=0;c<d.length;c++)if(d[c]){var e=d[c].split("=");e.length<2||(b[e[0]]=e[1])}if(i.galleryPIDs){var f=b.pid;for(b.pid=0,c=0;c<Xb.length;c++)if(Xb[c].pid===f){b.pid=c;break}}else b.pid=parseInt(b.pid,10)-1;return b.pid<0&&(b.pid=0),b},Hc=function(){if(tc&&clearTimeout(tc),$a||U)return void(tc=setTimeout(Hc,500));uc?clearTimeout(sc):uc=!0;var a=m+1,b=$b(m);b.hasOwnProperty("pid")&&(a=b.pid);var c=xc+"&gid="+i.galleryUID+"&pid="+a;yc||-1===Bc.hash.indexOf(c)&&(Ac=!0);var d=Bc.href.split("#")[0]+"#"+c;Cc?"#"+c!==window.location.hash&&history[yc?"replaceState":"pushState"]("",document.title,d):yc?Bc.replace(d):Bc.hash=c,yc=!0,sc=setTimeout(function(){uc=!1},60)};ya("History",{publicMethods:{initHistory:function(){if(e.extend(i,Dc,!0),i.history){Bc=window.location,Ac=!1,zc=!1,yc=!1,xc=Ec(),Cc="pushState"in history,xc.indexOf("gid=")>-1&&(xc=xc.split("&gid=")[0],xc=xc.split("?gid=")[0]),Ba("afterChange",f.updateURL),Ba("unbindEvents",function(){e.unbind(window,"hashchange",f.onHashChange)});var a=function(){wc=!0,zc||(Ac?history.back():xc?Bc.hash=xc:Cc?history.pushState("",document.title,Bc.pathname+Bc.search):Bc.hash=""),Fc()};Ba("unbindEvents",function(){l&&a()}),Ba("destroy",function(){wc||a()}),Ba("firstUpdate",function(){m=Gc().pid});var b=xc.indexOf("pid=");b>-1&&(xc=xc.substring(0,b),"&"===xc.slice(-1)&&(xc=xc.slice(0,-1))),setTimeout(function(){j&&e.bind(window,"hashchange",f.onHashChange)},40)}},onHashChange:function(){return Ec()===xc?(zc=!0,void f.close()):void(uc||(vc=!0,f.goTo(Gc().pid),vc=!1))},updateURL:function(){Fc(),vc||(yc?rc=setTimeout(Hc,800):Hc())}}}),e.extend(f,db)};return a}),!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.PhotoSwipeUI_Default=b()}(this,function(){"use strict";var a=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=this,w=!1,x=!0,y=!0,z={barsSize:{top:44,bottom:"auto"},closeElClasses:["item","caption","zoom-wrap","ui","top-bar"],timeToIdle:4e3,timeToIdleOutside:1e3,loadingIndicatorDelay:1e3,addCaptionHTMLFn:function(a,b){return a.title?(b.children[0].innerHTML=a.title,!0):(b.children[0].innerHTML="",!1)},closeEl:!0,captionEl:!0,fullscreenEl:!0,zoomEl:!0,shareEl:!0,counterEl:!0,arrowEl:!0,preloaderEl:!0,tapToClose:!1,tapToToggleControls:!0,clickToCloseNonZoomable:!0,shareButtons:[{id:"facebook",label:"Share on Facebook",url:"https://www.facebook.com/sharer/sharer.php?u={{url}}"},{id:"twitter",label:"Tweet",url:"https://twitter.com/intent/tweet?text={{text}}&url={{url}}"},{id:"pinterest",label:"Pin it",url:"http://www.pinterest.com/pin/create/button/?url={{url}}&media={{image_url}}&description={{text}}"},{id:"download",label:"Download image",url:"{{raw_image_url}}",download:!0}],getImageURLForShare:function(){return a.currItem.src||""},getPageURLForShare:function(){return window.location.href},getTextForShare:function(){return a.currItem.title||""},indexIndicatorSep:" / "},A=function(a){if(r)return!0;a=a||window.event,q.timeToIdle&&q.mouseUsed&&!k&&K();for(var c,d,e=a.target||a.srcElement,f=e.className,g=0;g<S.length;g++)c=S[g],c.onTap&&f.indexOf("pswp__"+c.name)>-1&&(c.onTap(),d=!0);if(d){a.stopPropagation&&a.stopPropagation(),r=!0;var h=b.features.isOldAndroid?600:30;s=setTimeout(function(){r=!1},h)}},B=function(){return!a.likelyTouchDevice||q.mouseUsed||screen.width>1200},C=function(a,c,d){b[(d?"add":"remove")+"Class"](a,"pswp__"+c)},D=function(){var a=1===q.getNumItemsFn();a!==p&&(C(d,"ui--one-slide",a),p=a)},E=function(){C(i,"share-modal--hidden",y)},F=function(){return y=!y,y?(b.removeClass(i,"pswp__share-modal--fade-in"),setTimeout(function(){y&&E()},300)):(E(),setTimeout(function(){y||b.addClass(i,"pswp__share-modal--fade-in")},30)),y||H(),!1},G=function(b){b=b||window.event;var c=b.target||b.srcElement;return a.shout("shareLinkClick",b,c),!(!c.href||!c.hasAttribute("download")&&(window.open(c.href,"pswp_share","scrollbars=yes,resizable=yes,toolbar=no,location=yes,width=550,height=420,top=100,left="+(window.screen?Math.round(screen.width/2-275):100)),y||F(),1))},H=function(){for(var a,b,c,d,e,f="",g=0;g<q.shareButtons.length;g++)a=q.shareButtons[g],c=q.getImageURLForShare(a),d=q.getPageURLForShare(a),e=q.getTextForShare(a),b=a.url.replace("{{url}}",encodeURIComponent(d)).replace("{{image_url}}",encodeURIComponent(c)).replace("{{raw_image_url}}",c).replace("{{text}}",encodeURIComponent(e)),f+='<a href="'+b+'" target="_blank" class="pswp__share--'+a.id+'"'+(a.download?"download":"")+">"+a.label+"</a>",q.parseShareButtonOut&&(f=q.parseShareButtonOut(a,f));i.children[0].innerHTML=f,i.children[0].onclick=G},I=function(a){for(var c=0;c<q.closeElClasses.length;c++)if(b.hasClass(a,"pswp__"+q.closeElClasses[c]))return!0},J=0,K=function(){clearTimeout(u),J=0,k&&v.setIdle(!1)},L=function(a){a=a?a:window.event;var b=a.relatedTarget||a.toElement;b&&"HTML"!==b.nodeName||(clearTimeout(u),u=setTimeout(function(){v.setIdle(!0)},q.timeToIdleOutside))},M=function(){q.fullscreenEl&&(c||(c=v.getFullscreenAPI()),c?(b.bind(document,c.eventK,v.updateFullscreen),v.updateFullscreen(),b.addClass(a.template,"pswp--supports-fs")):b.removeClass(a.template,"pswp--supports-fs"))},N=function(){q.preloaderEl&&(O(!0),l("beforeChange",function(){clearTimeout(o),o=setTimeout(function(){a.currItem&&a.currItem.loading?(!a.allowProgressiveImg()||a.currItem.img&&!a.currItem.img.naturalWidth)&&O(!1):O(!0)},q.loadingIndicatorDelay)}),l("imageLoadComplete",function(b,c){a.currItem===c&&O(!0)}))},O=function(a){n!==a&&(C(m,"preloader--active",!a),n=a)},P=function(a){var c=a.vGap;if(B()){var g=q.barsSize;if(q.captionEl&&"auto"===g.bottom)if(f||(f=b.createEl("pswp__caption pswp__caption--fake"),f.appendChild(b.createEl("pswp__caption__center")),d.insertBefore(f,e),b.addClass(d,"pswp__ui--fit")),q.addCaptionHTMLFn(a,f,!0)){var h=f.clientHeight;c.bottom=parseInt(h,10)||44}else c.bottom=g.top;else c.bottom="auto"===g.bottom?0:g.bottom;c.top=g.top}else c.top=c.bottom=0},Q=function(){q.timeToIdle&&l("mouseUsed",function(){b.bind(document,"mousemove",K),b.bind(document,"mouseout",L),t=setInterval(function(){J++,2===J&&v.setIdle(!0)},q.timeToIdle/2)})},R=function(){l("onVerticalDrag",function(a){x&&.95>a?v.hideControls():!x&&a>=.95&&v.showControls()});var a;l("onPinchClose",function(b){x&&.9>b?(v.hideControls(),a=!0):a&&!x&&b>.9&&v.showControls()}),l("zoomGestureEnded",function(){a=!1,a&&!x&&v.showControls()})},S=[{name:"caption",option:"captionEl",onInit:function(a){e=a}},{name:"share-modal",option:"shareEl",onInit:function(a){i=a},onTap:function(){F()}},{name:"button--share",option:"shareEl",onInit:function(a){h=a},onTap:function(){F()}},{name:"button--zoom",option:"zoomEl",onTap:a.toggleDesktopZoom},{name:"counter",option:"counterEl",onInit:function(a){g=a}},{name:"button--close",option:"closeEl",onTap:a.close},{name:"button--arrow--left",option:"arrowEl",onTap:a.prev},{name:"button--arrow--right",option:"arrowEl",onTap:a.next},{name:"button--fs",option:"fullscreenEl",onTap:function(){c.isFullscreen()?c.exit():c.enter()}},{name:"preloader",option:"preloaderEl",onInit:function(a){m=a}}],T=function(){var a,c,e,f=function(d){if(d)for(var f=d.length,g=0;f>g;g++){a=d[g],c=a.className;for(var h=0;h<S.length;h++)e=S[h],c.indexOf("pswp__"+e.name)>-1&&(q[e.option]?(b.removeClass(a,"pswp__element--disabled"),e.onInit&&e.onInit(a)):b.addClass(a,"pswp__element--disabled"))}};f(d.children);var g=b.getChildByClass(d,"pswp__top-bar");g&&f(g.children)};v.init=function(){b.extend(a.options,z,!0),q=a.options,d=b.getChildByClass(a.scrollWrap,"pswp__ui"),l=a.listen,R(),l("beforeChange",v.update),l("doubleTap",function(b){var c=a.currItem.initialZoomLevel;a.getZoomLevel()!==c?a.zoomTo(c,b,333):a.zoomTo(q.getDoubleTapZoom(!1,a.currItem),b,333)}),l("preventDragEvent",function(a,b,c){var d=a.target||a.srcElement;d&&d.className&&a.type.indexOf("mouse")>-1&&(d.className.indexOf("__caption")>0||/(SMALL|STRONG|EM)/i.test(d.tagName))&&(c.prevent=!1)}),l("bindEvents",function(){b.bind(d,"pswpTap click",A),b.bind(a.scrollWrap,"pswpTap",v.onGlobalTap),a.likelyTouchDevice||b.bind(a.scrollWrap,"mouseover",v.onMouseOver)}),l("unbindEvents",function(){y||F(),t&&clearInterval(t),b.unbind(document,"mouseout",L),b.unbind(document,"mousemove",K),b.unbind(d,"pswpTap click",A),b.unbind(a.scrollWrap,"pswpTap",v.onGlobalTap),b.unbind(a.scrollWrap,"mouseover",v.onMouseOver),c&&(b.unbind(document,c.eventK,v.updateFullscreen),c.isFullscreen()&&(q.hideAnimationDuration=0,c.exit()),c=null)}),l("destroy",function(){q.captionEl&&(f&&d.removeChild(f),b.removeClass(e,"pswp__caption--empty")),i&&(i.children[0].onclick=null),b.removeClass(d,"pswp__ui--over-close"),b.addClass(d,"pswp__ui--hidden"),v.setIdle(!1)}),q.showAnimationDuration||b.removeClass(d,"pswp__ui--hidden"),l("initialZoomIn",function(){q.showAnimationDuration&&b.removeClass(d,"pswp__ui--hidden")}),l("initialZoomOut",function(){b.addClass(d,"pswp__ui--hidden")}),l("parseVerticalMargin",P),T(),q.shareEl&&h&&i&&(y=!0),D(),Q(),
M(),N()},v.setIdle=function(a){k=a,C(d,"ui--idle",a)},v.update=function(){x&&a.currItem?(v.updateIndexIndicator(),q.captionEl&&(q.addCaptionHTMLFn(a.currItem,e),C(e,"caption--empty",!a.currItem.title)),w=!0):w=!1,y||F(),D()},v.updateFullscreen=function(d){d&&setTimeout(function(){a.setScrollOffset(0,b.getScrollY())},50),b[(c.isFullscreen()?"add":"remove")+"Class"](a.template,"pswp--fs")},v.updateIndexIndicator=function(){q.counterEl&&(g.innerHTML=a.getCurrentIndex()+1+q.indexIndicatorSep+q.getNumItemsFn())},v.onGlobalTap=function(c){c=c||window.event;var d=c.target||c.srcElement;if(!r)if(c.detail&&"mouse"===c.detail.pointerType){if(I(d))return void a.close();b.hasClass(d,"pswp__img")&&(1===a.getZoomLevel()&&a.getZoomLevel()<=a.currItem.fitRatio?q.clickToCloseNonZoomable&&a.close():a.toggleDesktopZoom(c.detail.releasePoint))}else if(q.tapToToggleControls&&(x?v.hideControls():v.showControls()),q.tapToClose&&(b.hasClass(d,"pswp__img")||I(d)))return void a.close()},v.onMouseOver=function(a){a=a||window.event;var b=a.target||a.srcElement;C(d,"ui--over-close",I(b))},v.hideControls=function(){b.addClass(d,"pswp__ui--hidden"),x=!1},v.showControls=function(){x=!0,w||v.update(),b.removeClass(d,"pswp__ui--hidden")},v.supportsFullscreen=function(){var a=document;return!!(a.exitFullscreen||a.mozCancelFullScreen||a.webkitExitFullscreen||a.msExitFullscreen)},v.getFullscreenAPI=function(){var b,c=document.documentElement,d="fullscreenchange";return c.requestFullscreen?b={enterK:"requestFullscreen",exitK:"exitFullscreen",elementK:"fullscreenElement",eventK:d}:c.mozRequestFullScreen?b={enterK:"mozRequestFullScreen",exitK:"mozCancelFullScreen",elementK:"mozFullScreenElement",eventK:"moz"+d}:c.webkitRequestFullscreen?b={enterK:"webkitRequestFullscreen",exitK:"webkitExitFullscreen",elementK:"webkitFullscreenElement",eventK:"webkit"+d}:c.msRequestFullscreen&&(b={enterK:"msRequestFullscreen",exitK:"msExitFullscreen",elementK:"msFullscreenElement",eventK:"MSFullscreenChange"}),b&&(b.enter=function(){return j=q.closeOnScroll,q.closeOnScroll=!1,"webkitRequestFullscreen"!==this.enterK?a.template[this.enterK]():void a.template[this.enterK](Element.ALLOW_KEYBOARD_INPUT)},b.exit=function(){return q.closeOnScroll=j,document[this.exitK]()},b.isFullscreen=function(){return document[this.elementK]}),b}};return a}),"undefined"==typeof YAHOO||!YAHOO)var YAHOO={};YAHOO.namespace=function(){var e,c,f,b=arguments,g=null;for(e=0;e<b.length;e+=1)for(f=(""+b[e]).split("."),g=YAHOO,c="YAHOO"==f[0]?1:0;c<f.length;c+=1)g[f[c]]=g[f[c]]||{},g=g[f[c]];return g},YAHOO.log=function(d,a,c){var b=YAHOO.widget.Logger;return!(!b||!b.log)&&b.log(d,a,c)},YAHOO.register=function(a,f,e){var c,j,h,g,d,k=YAHOO.env.modules;for(k[a]||(k[a]={versions:[],builds:[]}),c=k[a],j=e.version,h=e.build,g=YAHOO.env.listeners,c.name=a,c.version=j,c.build=h,c.versions.push(j),c.builds.push(h),c.mainClass=f,d=0;d<g.length;d+=1)g[d](c);f?(f.VERSION=j,f.BUILD=h):YAHOO.log("mainClass is undefined for module "+a,"warn")},YAHOO.env=YAHOO.env||{modules:[],listeners:[]},YAHOO.env.getVersion=function(a){return YAHOO.env.modules[a]||null},YAHOO.env.parseUA=function(d){var a,e=function(i){var j=0;return parseFloat(i.replace(/\./g,function(){return 1==j++?"":"."}))},h=navigator,g={ie:0,opera:0,gecko:0,webkit:0,chrome:0,mobile:null,air:0,ipad:0,iphone:0,ipod:0,ios:null,android:0,webos:0,caja:h&&h.cajaVersion,secure:!1,os:null},c=d||navigator&&navigator.userAgent,f=window&&window.location,b=f&&f.href;return g.secure=b&&0===b.toLowerCase().indexOf("https"),c&&(/windows|win32/i.test(c)?g.os="windows":/macintosh/i.test(c)?g.os="macintosh":/rhino/i.test(c)&&(g.os="rhino"),/KHTML/.test(c)&&(g.webkit=1),a=c.match(/AppleWebKit\/([^\s]*)/),a&&a[1]&&(g.webkit=e(a[1]),/ Mobile\//.test(c)?(g.mobile="Apple",a=c.match(/OS ([^\s]*)/),a&&a[1]&&(a=e(a[1].replace("_","."))),g.ios=a,g.ipad=g.ipod=g.iphone=0,a=c.match(/iPad|iPod|iPhone/),a&&a[0]&&(g[a[0].toLowerCase()]=g.ios)):(a=c.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/),a&&(g.mobile=a[0]),/webOS/.test(c)&&(g.mobile="WebOS",a=c.match(/webOS\/([^\s]*);/),a&&a[1]&&(g.webos=e(a[1]))),/ Android/.test(c)&&(g.mobile="Android",a=c.match(/Android ([^\s]*);/),a&&a[1]&&(g.android=e(a[1])))),a=c.match(/Chrome\/([^\s]*)/),a&&a[1]?g.chrome=e(a[1]):(a=c.match(/AdobeAIR\/([^\s]*)/),a&&(g.air=a[0]))),g.webkit||(a=c.match(/Opera[\s\/]([^\s]*)/),a&&a[1]?(g.opera=e(a[1]),a=c.match(/Version\/([^\s]*)/),a&&a[1]&&(g.opera=e(a[1])),a=c.match(/Opera Mini[^;]*/),a&&(g.mobile=a[0])):(a=c.match(/MSIE\s([^;]*)/),a&&a[1]?g.ie=e(a[1]):(a=c.match(/Gecko\/([^\s]*)/),a&&(g.gecko=1,a=c.match(/rv:([^\s\)]*)/),a&&a[1]&&(g.gecko=e(a[1]))))))),g},YAHOO.env.ua=YAHOO.env.parseUA(),function(){if(YAHOO.namespace("util","widget","example"),"undefined"!=typeof YAHOO_config){var c,b=YAHOO_config.listener,a=YAHOO.env.listeners,d=!0;if(b){for(c=0;c<a.length;c++)if(a[c]==b){d=!1;break}d&&a.push(b)}}}(),YAHOO.lang=YAHOO.lang||{},function(){var f=YAHOO.lang,a=Object.prototype,c="[object Array]",h="[object Function]",i="[object Object]",b=[],g={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;","`":"&#x60;"},d=["toString","valueOf"],e={isArray:function(j){return a.toString.apply(j)===c},isBoolean:function(j){return"boolean"==typeof j},isFunction:function(j){return"function"==typeof j||a.toString.apply(j)===h},isNull:function(j){return null===j},isNumber:function(j){return"number"==typeof j&&isFinite(j)},isObject:function(j){return j&&("object"==typeof j||f.isFunction(j))||!1},isString:function(j){return"string"==typeof j},isUndefined:function(j){return"undefined"==typeof j},_IEEnumFix:YAHOO.env.ua.ie?function(l,k){var j,n,m;for(j=0;j<d.length;j+=1)n=d[j],m=k[n],f.isFunction(m)&&m!=a[n]&&(l[n]=m)}:function(){},escapeHTML:function(j){return j.replace(/[&<>"'\/`]/g,function(k){return g[k]})},extend:function(m,n,l){if(!n||!m)throw new Error("extend failed, please check that all dependencies are included.");var j,k=function(){};if(k.prototype=n.prototype,m.prototype=new k,m.prototype.constructor=m,m.superclass=n.prototype,n.prototype.constructor==a.constructor&&(n.prototype.constructor=n),l){for(j in l)f.hasOwnProperty(l,j)&&(m.prototype[j]=l[j]);f._IEEnumFix(m.prototype,l)}},augmentObject:function(n,m){if(!m||!n)throw new Error("Absorb failed, verify dependencies.");var l,o,j=arguments,k=j[2];if(k&&k!==!0)for(l=2;l<j.length;l+=1)n[j[l]]=m[j[l]];else{for(o in m)!k&&o in n||(n[o]=m[o]);f._IEEnumFix(n,m)}return n},augmentProto:function(m,l){if(!l||!m)throw new Error("Augment failed, verify dependencies.");var k,j=[m.prototype,l.prototype];for(k=2;k<arguments.length;k+=1)j.push(arguments[k]);return f.augmentObject.apply(this,j),m},dump:function(j,p){var l,n,r=[],t="{...}",k="f(){...}",q=", ",m=" => ";if(!f.isObject(j))return j+"";if(j instanceof Date||"nodeType"in j&&"tagName"in j)return j;if(f.isFunction(j))return k;if(p=f.isNumber(p)?p:3,f.isArray(j)){for(r.push("["),l=0,n=j.length;l<n;l+=1)f.isObject(j[l])?r.push(p>0?f.dump(j[l],p-1):t):r.push(j[l]),r.push(q);r.length>1&&r.pop(),r.push("]")}else{r.push("{");for(l in j)f.hasOwnProperty(j,l)&&(r.push(l+m),f.isObject(j[l])?r.push(p>0?f.dump(j[l],p-1):t):r.push(j[l]),r.push(q));r.length>1&&r.pop(),r.push("}")}return r.join("")},substitute:function(x,y,E,l){for(var D,C,B,G,t,u,p,n,w,F=[],z=x.length,A="dump",r=" ",q="{",m="}";D=x.lastIndexOf(q,z),!(D<0||(C=x.indexOf(m,D),D+1>C));)p=x.substring(D+1,C),G=p,u=null,B=G.indexOf(r),B>-1&&(u=G.substring(B+1),G=G.substring(0,B)),t=y[G],E&&(t=E(G,t,u)),f.isObject(t)?f.isArray(t)?t=f.dump(t,parseInt(u,10)):(u=u||"",n=u.indexOf(A),n>-1&&(u=u.substring(4)),w=t.toString(),t=w===i||n>-1?f.dump(t,parseInt(u,10)):w):f.isString(t)||f.isNumber(t)||(t="~-"+F.length+"-~",F[F.length]=p),x=x.substring(0,D)+t+x.substring(C+1),l===!1&&(z=D-1);for(D=F.length-1;D>=0;D-=1)x=x.replace(new RegExp("~-"+D+"-~"),"{"+F[D]+"}","g");return x},trim:function(j){try{return j.replace(/^\s+|\s+$/g,"")}catch(k){return j}},merge:function(){var m,n={},k=arguments,j=k.length;for(m=0;m<j;m+=1)f.augmentObject(n,k[m],!0);return n},later:function(t,k,u,n,p){t=t||0,k=k||{};var q,j,l=u,s=n;if(f.isString(u)&&(l=k[u]),!l)throw new TypeError("method undefined");return f.isUndefined(n)||f.isArray(s)||(s=[n]),q=function(){l.apply(k,s||b)},j=p?setInterval(q,t):setTimeout(q,t),{interval:p,cancel:function(){this.interval?clearInterval(j):clearTimeout(j)}}},isValue:function(j){return f.isObject(j)||f.isString(j)||f.isNumber(j)||f.isBoolean(j)}};f.hasOwnProperty=a.hasOwnProperty?function(j,k){return j&&j.hasOwnProperty&&j.hasOwnProperty(k)}:function(j,k){return!f.isUndefined(j[k])&&j.constructor.prototype[k]!==j[k]},e.augmentObject(f,e,!0),YAHOO.util.Lang=f,f.augment=f.augmentProto,YAHOO.augment=f.augmentProto,YAHOO.extend=f.extend}(),YAHOO.register("yahoo",YAHOO,{version:"2.9.0",build:"2800"});var CryptoJS=CryptoJS||function(e,g){var a={},b=a.lib={},j=b.Base=function(){function n(){}return{extend:function(p){n.prototype=this;var o=new n;return p&&o.mixIn(p),o.hasOwnProperty("init")||(o.init=function(){o.$super.init.apply(this,arguments)}),o.init.prototype=o,o.$super=this,o},create:function(){var o=this.extend();return o.init.apply(o,arguments),o},init:function(){},mixIn:function(p){for(var o in p)p.hasOwnProperty(o)&&(this[o]=p[o]);p.hasOwnProperty("toString")&&(this.toString=p.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),l=b.WordArray=j.extend({init:function(o,n){o=this.words=o||[],n!=g?this.sigBytes=n:this.sigBytes=4*o.length},toString:function(n){return(n||h).stringify(this)},concat:function(t){var q=this.words,p=t.words,n=this.sigBytes,s=t.sigBytes;if(this.clamp(),n%4)for(var r=0;r<s;r++){var o=p[r>>>2]>>>24-r%4*8&255;q[n+r>>>2]|=o<<24-(n+r)%4*8}else for(var r=0;r<s;r+=4)q[n+r>>>2]=p[r>>>2];return this.sigBytes+=s,this},clamp:function(){var o=this.words,n=this.sigBytes;o[n>>>2]&=4294967295<<32-n%4*8,o.length=e.ceil(n/4)},clone:function(){var n=j.clone.call(this);return n.words=this.words.slice(0),n},random:function(p){for(var o=[],n=0;n<p;n+=4)o.push(4294967296*e.random()|0);return new l.init(o,p)}}),m=a.enc={},h=m.Hex={stringify:function(p){for(var r=p.words,o=p.sigBytes,q=[],n=0;n<o;n++){var s=r[n>>>2]>>>24-n%4*8&255;q.push((s>>>4).toString(16)),q.push((15&s).toString(16))}return q.join("")},parse:function(p){for(var n=p.length,q=[],o=0;o<n;o+=2)q[o>>>3]|=parseInt(p.substr(o,2),16)<<24-o%8*4;return new l.init(q,n/2)}},d=m.Latin1={stringify:function(q){for(var r=q.words,p=q.sigBytes,n=[],o=0;o<p;o++){var s=r[o>>>2]>>>24-o%4*8&255;n.push(String.fromCharCode(s))}return n.join("")},parse:function(p){for(var n=p.length,q=[],o=0;o<n;o++)q[o>>>2]|=(255&p.charCodeAt(o))<<24-o%4*8;return new l.init(q,n)}},c=m.Utf8={stringify:function(n){try{return decodeURIComponent(escape(d.stringify(n)))}catch(o){throw new Error("Malformed UTF-8 data")}},parse:function(n){return d.parse(unescape(encodeURIComponent(n)))}},i=b.BufferedBlockAlgorithm=j.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(n){"string"==typeof n&&(n=c.parse(n)),this._data.concat(n),this._nDataBytes+=n.sigBytes},_process:function(w){var q=this._data,x=q.words,n=q.sigBytes,t=this.blockSize,v=4*t,u=n/v;u=w?e.ceil(u):e.max((0|u)-this._minBufferSize,0);var s=u*t,r=e.min(4*s,n);if(s){for(var p=0;p<s;p+=t)this._doProcessBlock(x,p);var o=x.splice(0,s);q.sigBytes-=r}return new l.init(o,r)},clone:function(){var n=j.clone.call(this);return n._data=this._data.clone(),n},_minBufferSize:0}),k=(b.Hasher=i.extend({cfg:j.extend(),init:function(n){this.cfg=this.cfg.extend(n),this.reset()},reset:function(){i.reset.call(this),this._doReset()},update:function(n){return this._append(n),this._process(),this},finalize:function(n){n&&this._append(n);var o=this._doFinalize();return o},blockSize:16,_createHelper:function(n){return function(p,o){return new n.init(o).finalize(p)}},_createHmacHelper:function(n){return function(p,o){return new k.HMAC.init(n,o).finalize(p)}}}),a.algo={});return a}(Math);!function(g){var a=CryptoJS,f=a.lib,e=f.Base,h=f.WordArray,a=a.x64={};a.Word=e.extend({init:function(b,c){this.high=b,this.low=c}}),a.WordArray=e.extend({init:function(b,c){b=this.words=b||[],this.sigBytes=c!=g?c:8*b.length},toX32:function(){for(var b=this.words,c=b.length,a=[],d=0;d<c;d++){var e=b[d];a.push(e.high),a.push(e.low)}return h.create(a,this.sigBytes)},clone:function(){for(var b=e.clone.call(this),c=b.words=this.words.slice(0),a=c.length,d=0;d<a;d++)c[d]=c[d].clone();return b}})}(),function(){var c=CryptoJS,k=c.enc.Utf8;c.algo.HMAC=c.lib.Base.extend({init:function(a,b){a=this._hasher=new a.init,"string"==typeof b&&(b=k.parse(b));var c=a.blockSize,e=4*c;b.sigBytes>e&&(b=a.finalize(b)),b.clamp();for(var f=this._oKey=b.clone(),g=this._iKey=b.clone(),h=f.words,j=g.words,d=0;d<c;d++)h[d]^=1549556828,j[d]^=909522486;f.sigBytes=g.sigBytes=e,this.reset()},reset:function(){var a=this._hasher;a.reset(),a.update(this._iKey)},update:function(a){return this._hasher.update(a),this},finalize:function(a){var b=this._hasher;return a=b.finalize(a),b.reset(),b.finalize(this._oKey.clone().concat(a))}})}(),function(k){for(var g=CryptoJS,h=g.lib,v=h.WordArray,j=h.Hasher,h=g.algo,s=[],t=[],u=function(q){return 4294967296*(q-(0|q))|0},l=2,b=0;64>b;){var d;a:{d=l;for(var w=k.sqrt(d),r=2;r<=w;r++)if(!(d%r)){d=!1;break a}d=!0}d&&(8>b&&(s[b]=u(k.pow(l,.5))),t[b]=u(k.pow(l,1/3)),b++),l++}var n=[],h=h.SHA256=j.extend({_doReset:function(){this._hash=new v.init(s.slice(0))},_doProcessBlock:function(q,h){for(var a=this._hash.words,c=a[0],d=a[1],b=a[2],k=a[3],f=a[4],g=a[5],j=a[6],l=a[7],e=0;64>e;e++){if(16>e)n[e]=0|q[h+e];else{var m=n[e-15],p=n[e-2];n[e]=((m<<25|m>>>7)^(m<<14|m>>>18)^m>>>3)+n[e-7]+((p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10)+n[e-16]}m=l+((f<<26|f>>>6)^(f<<21|f>>>11)^(f<<7|f>>>25))+(f&g^~f&j)+t[e]+n[e],p=((c<<30|c>>>2)^(c<<19|c>>>13)^(c<<10|c>>>22))+(c&d^c&b^d&b),l=j,j=g,g=f,f=k+m|0,k=b,b=d,d=c,c=m+p|0}a[0]=a[0]+c|0,a[1]=a[1]+d|0,a[2]=a[2]+b|0,a[3]=a[3]+k|0,a[4]=a[4]+f|0,a[5]=a[5]+g|0,a[6]=a[6]+j|0,a[7]=a[7]+l|0},_doFinalize:function(){var d=this._data,b=d.words,a=8*this._nDataBytes,c=8*d.sigBytes;return b[c>>>5]|=128<<24-c%32,b[(c+64>>>9<<4)+14]=k.floor(a/4294967296),b[(c+64>>>9<<4)+15]=a,d.sigBytes=4*b.length,this._process(),this._hash},clone:function(){var b=j.clone.call(this);return b._hash=this._hash.clone(),b}});g.SHA256=j._createHelper(h),g.HmacSHA256=j._createHmacHelper(h)}(Math),function(){var b=CryptoJS,d=b.lib.WordArray,a=b.algo,c=a.SHA256,a=a.SHA224=c.extend({_doReset:function(){this._hash=new d.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var a=c._doFinalize.call(this);return a.sigBytes-=4,a}});b.SHA224=c._createHelper(a),b.HmacSHA224=c._createHmacHelper(a)}(),function(){function a(){return d.create.apply(d,arguments)}for(var n=CryptoJS,r=n.lib.Hasher,e=n.x64,d=e.Word,T=e.WordArray,e=n.algo,ea=[a(1116352408,3609767458),a(1899447441,602891725),a(3049323471,3964484399),a(3921009573,2173295548),a(961987163,4081628472),a(1508970993,3053834265),a(2453635748,2937671579),a(2870763221,3664609560),a(3624381080,2734883394),a(310598401,1164996542),a(607225278,1323610764),a(1426881987,3590304994),a(1925078388,4068182383),a(2162078206,991336113),a(2614888103,633803317),a(3248222580,3479774868),a(3835390401,2666613458),a(4022224774,944711139),a(264347078,2341262773),a(604807628,2007800933),a(770255983,1495990901),a(1249150122,1856431235),a(1555081692,3175218132),a(1996064986,2198950837),a(2554220882,3999719339),a(2821834349,766784016),a(2952996808,2566594879),a(3210313671,3203337956),a(3336571891,1034457026),a(3584528711,2466948901),a(113926993,3758326383),a(338241895,168717936),a(666307205,1188179964),a(773529912,1546045734),a(1294757372,1522805485),a(1396182291,2643833823),a(1695183700,2343527390),a(1986661051,1014477480),a(2177026350,1206759142),a(2456956037,344077627),a(2730485921,1290863460),a(2820302411,3158454273),a(3259730800,3505952657),a(3345764771,106217008),a(3516065817,3606008344),a(3600352804,1432725776),a(4094571909,1467031594),a(275423344,851169720),a(430227734,3100823752),a(506948616,1363258195),a(659060556,3750685593),a(883997877,3785050280),a(958139571,3318307427),a(1322822218,3812723403),a(1537002063,2003034995),a(1747873779,3602036899),a(1955562222,1575990012),a(2024104815,1125592928),a(2227730452,2716904306),a(2361852424,442776044),a(2428436474,593698344),a(2756734187,3733110249),a(3204031479,2999351573),a(3329325298,3815920427),a(3391569614,3928383900),a(3515267271,566280711),a(3940187606,3454069534),a(4118630271,4000239992),a(116418474,1914138554),a(174292421,2731055270),a(289380356,3203993006),a(460393269,320620315),a(685471733,587496836),a(852142971,1086792851),a(1017036298,365543100),a(1126000580,2618297676),a(1288033470,3409855158),a(1501505948,4234509866),a(1607167915,987167468),a(1816402316,1246189591)],v=[],w=0;80>w;w++)v[w]=a();e=e.SHA512=r.extend({_doReset:function(){this._hash=new T.init([new d.init(1779033703,4089235720),new d.init(3144134277,2227873595),new d.init(1013904242,4271175723),new d.init(2773480762,1595750129),new d.init(1359893119,2917565137),new d.init(2600822924,725511199),new d.init(528734635,4215389547),new d.init(1541459225,327033209)])},_doProcessBlock:function(a,d){for(var f=this._hash.words,F=f[0],e=f[1],n=f[2],r=f[3],G=f[4],H=f[5],I=f[6],f=f[7],w=F.high,J=F.low,X=e.high,K=e.low,Y=n.high,L=n.low,Z=r.high,M=r.low,$=G.high,N=G.low,aa=H.high,O=H.low,ba=I.high,P=I.low,ca=f.high,Q=f.low,k=w,g=J,z=X,x=K,A=Y,y=L,U=Z,B=M,l=$,h=N,R=aa,C=O,S=ba,D=P,V=ca,E=Q,m=0;80>m;m++){var s=v[m];if(16>m)var j=s.high=0|a[d+2*m],b=s.low=0|a[d+2*m+1];else{var j=v[m-15],b=j.high,p=j.low,j=(b>>>1|p<<31)^(b>>>8|p<<24)^b>>>7,p=(p>>>1|b<<31)^(p>>>8|b<<24)^(p>>>7|b<<25),u=v[m-2],b=u.high,c=u.low,u=(b>>>19|c<<13)^(b<<3|c>>>29)^b>>>6,c=(c>>>19|b<<13)^(c<<3|b>>>29)^(c>>>6|b<<26),b=v[m-7],W=b.high,t=v[m-16],q=t.high,t=t.low,b=p+b.low,j=j+W+(b>>>0<p>>>0?1:0),b=b+c,j=j+u+(b>>>0<c>>>0?1:0),b=b+t,j=j+q+(b>>>0<t>>>0?1:0);s.high=j,s.low=b}var W=l&R^~l&S,t=h&C^~h&D,s=k&z^k&A^z&A,T=g&x^g&y^x&y,p=(k>>>28|g<<4)^(k<<30|g>>>2)^(k<<25|g>>>7),u=(g>>>28|k<<4)^(g<<30|k>>>2)^(g<<25|k>>>7),c=ea[m],fa=c.high,da=c.low,c=E+((h>>>14|l<<18)^(h>>>18|l<<14)^(h<<23|l>>>9)),q=V+((l>>>14|h<<18)^(l>>>18|h<<14)^(l<<23|h>>>9))+(c>>>0<E>>>0?1:0),c=c+t,q=q+W+(c>>>0<t>>>0?1:0),c=c+da,q=q+fa+(c>>>0<da>>>0?1:0),c=c+b,q=q+j+(c>>>0<b>>>0?1:0),b=u+T,s=p+s+(b>>>0<u>>>0?1:0),V=S,E=D,S=R,D=C,R=l,C=h,h=B+c|0,l=U+q+(h>>>0<B>>>0?1:0)|0,U=A,B=y,A=z,y=x,z=k,x=g,g=c+b|0,k=q+s+(g>>>0<c>>>0?1:0)|0}J=F.low=J+g,F.high=w+k+(J>>>0<g>>>0?1:0),K=e.low=K+x,e.high=X+z+(K>>>0<x>>>0?1:0),L=n.low=L+y,n.high=Y+A+(L>>>0<y>>>0?1:0),M=r.low=M+B,r.high=Z+U+(M>>>0<B>>>0?1:0),N=G.low=N+h,G.high=$+l+(N>>>0<h>>>0?1:0),O=H.low=O+C,H.high=aa+R+(O>>>0<C>>>0?1:0),P=I.low=P+D,I.high=ba+S+(P>>>0<D>>>0?1:0),Q=f.low=Q+E,f.high=ca+V+(Q>>>0<E>>>0?1:0)},_doFinalize:function(){var a=this._data,d=a.words,f=8*this._nDataBytes,e=8*a.sigBytes;return d[e>>>5]|=128<<24-e%32,d[(e+128>>>10<<5)+30]=Math.floor(f/4294967296),d[(e+128>>>10<<5)+31]=f,a.sigBytes=4*d.length,this._process(),this._hash.toX32()},clone:function(){var a=r.clone.call(this);return a._hash=this._hash.clone(),a},blockSize:32}),n.SHA512=r._createHelper(e),n.HmacSHA512=r._createHmacHelper(e)}(),function(){var c=CryptoJS,a=c.x64,b=a.Word,e=a.WordArray,a=c.algo,d=a.SHA512,a=a.SHA384=d.extend({_doReset:function(){this._hash=new e.init([new b.init(3418070365,3238371032),new b.init(1654270250,914150663),new b.init(2438529370,812702999),new b.init(355462360,4144912697),new b.init(1731405415,4290775857),new b.init(2394180231,1750603025),new b.init(3675008525,1694076839),new b.init(1203062813,3204075428)])},_doFinalize:function(){var a=d._doFinalize.call(this);return a.sigBytes-=16,a}});c.SHA384=d._createHelper(a),c.HmacSHA384=d._createHmacHelper(a)}(),function(E){function h(a,f,g,j,p,h,k){return a=a+(f&g|~f&j)+p+k,(a<<h|a>>>32-h)+f}function k(a,f,g,j,p,h,k){return a=a+(f&j|g&~j)+p+k,(a<<h|a>>>32-h)+f}function l(a,f,g,j,h,k,l){return a=a+(f^g^j)+h+l,(a<<k|a>>>32-k)+f}function n(a,f,g,j,h,k,l){return a=a+(g^(f|~j))+h+l,(a<<k|a>>>32-k)+f}for(var r=CryptoJS,q=r.lib,F=q.WordArray,s=q.Hasher,q=r.algo,a=[],t=0;64>t;t++)a[t]=4294967296*E.abs(E.sin(t+1))|0;q=q.MD5=s.extend({_doReset:function(){this._hash=new F.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(m,f){for(var g=0;16>g;g++){var j=f+g,p=m[j];m[j]=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8)}var g=this._hash.words,j=m[f+0],p=m[f+1],q=m[f+2],r=m[f+3],s=m[f+4],t=m[f+5],u=m[f+6],v=m[f+7],w=m[f+8],x=m[f+9],y=m[f+10],z=m[f+11],A=m[f+12],B=m[f+13],C=m[f+14],D=m[f+15],b=g[0],c=g[1],d=g[2],e=g[3],b=h(b,c,d,e,j,7,a[0]),e=h(e,b,c,d,p,12,a[1]),d=h(d,e,b,c,q,17,a[2]),c=h(c,d,e,b,r,22,a[3]),b=h(b,c,d,e,s,7,a[4]),e=h(e,b,c,d,t,12,a[5]),d=h(d,e,b,c,u,17,a[6]),c=h(c,d,e,b,v,22,a[7]),b=h(b,c,d,e,w,7,a[8]),e=h(e,b,c,d,x,12,a[9]),d=h(d,e,b,c,y,17,a[10]),c=h(c,d,e,b,z,22,a[11]),b=h(b,c,d,e,A,7,a[12]),e=h(e,b,c,d,B,12,a[13]),d=h(d,e,b,c,C,17,a[14]),c=h(c,d,e,b,D,22,a[15]),b=k(b,c,d,e,p,5,a[16]),e=k(e,b,c,d,u,9,a[17]),d=k(d,e,b,c,z,14,a[18]),c=k(c,d,e,b,j,20,a[19]),b=k(b,c,d,e,t,5,a[20]),e=k(e,b,c,d,y,9,a[21]),d=k(d,e,b,c,D,14,a[22]),c=k(c,d,e,b,s,20,a[23]),b=k(b,c,d,e,x,5,a[24]),e=k(e,b,c,d,C,9,a[25]),d=k(d,e,b,c,r,14,a[26]),c=k(c,d,e,b,w,20,a[27]),b=k(b,c,d,e,B,5,a[28]),e=k(e,b,c,d,q,9,a[29]),d=k(d,e,b,c,v,14,a[30]),c=k(c,d,e,b,A,20,a[31]),b=l(b,c,d,e,t,4,a[32]),e=l(e,b,c,d,w,11,a[33]),d=l(d,e,b,c,z,16,a[34]),c=l(c,d,e,b,C,23,a[35]),b=l(b,c,d,e,p,4,a[36]),e=l(e,b,c,d,s,11,a[37]),d=l(d,e,b,c,v,16,a[38]),c=l(c,d,e,b,y,23,a[39]),b=l(b,c,d,e,B,4,a[40]),e=l(e,b,c,d,j,11,a[41]),d=l(d,e,b,c,r,16,a[42]),c=l(c,d,e,b,u,23,a[43]),b=l(b,c,d,e,x,4,a[44]),e=l(e,b,c,d,A,11,a[45]),d=l(d,e,b,c,D,16,a[46]),c=l(c,d,e,b,q,23,a[47]),b=n(b,c,d,e,j,6,a[48]),e=n(e,b,c,d,v,10,a[49]),d=n(d,e,b,c,C,15,a[50]),c=n(c,d,e,b,t,21,a[51]),b=n(b,c,d,e,A,6,a[52]),e=n(e,b,c,d,r,10,a[53]),d=n(d,e,b,c,y,15,a[54]),c=n(c,d,e,b,p,21,a[55]),b=n(b,c,d,e,w,6,a[56]),e=n(e,b,c,d,D,10,a[57]),d=n(d,e,b,c,u,15,a[58]),c=n(c,d,e,b,B,21,a[59]),b=n(b,c,d,e,s,6,a[60]),e=n(e,b,c,d,z,10,a[61]),d=n(d,e,b,c,q,15,a[62]),c=n(c,d,e,b,x,21,a[63]);g[0]=g[0]+b|0,g[1]=g[1]+c|0,g[2]=g[2]+d|0,g[3]=g[3]+e|0},_doFinalize:function(){var a=this._data,f=a.words,g=8*this._nDataBytes,j=8*a.sigBytes;f[j>>>5]|=128<<24-j%32;var h=E.floor(g/4294967296);for(f[(j+64>>>9<<4)+15]=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8),f[(j+64>>>9<<4)+14]=16711935&(g<<8|g>>>24)|4278255360&(g<<24|g>>>8),a.sigBytes=4*(f.length+1),this._process(),a=this._hash,f=a.words,g=0;4>g;g++)j=f[g],f[g]=16711935&(j<<8|j>>>24)|4278255360&(j<<24|j>>>8);return a},clone:function(){var a=s.clone.call(this);return a._hash=this._hash.clone(),a}}),r.MD5=s._createHelper(q),r.HmacMD5=s._createHmacHelper(q)}(Math),function(){var h=CryptoJS,j=h.lib.WordArray;h.enc.Base64={stringify:function(b){var e=b.words,f=b.sigBytes,c=this._map;b.clamp(),b=[];for(var a=0;a<f;a+=3)for(var d=(e[a>>>2]>>>24-8*(a%4)&255)<<16|(e[a+1>>>2]>>>24-8*((a+1)%4)&255)<<8|e[a+2>>>2]>>>24-8*((a+2)%4)&255,g=0;4>g&&a+.75*g<f;g++)b.push(c.charAt(d>>>6*(3-g)&63));if(e=c.charAt(64))for(;b.length%4;)b.push(e);return b.join("")},parse:function(b){var e=b.length,f=this._map,c=f.charAt(64);c&&(c=b.indexOf(c),-1!=c&&(e=c));for(var c=[],a=0,d=0;d<e;d++)if(d%4){var g=f.indexOf(b.charAt(d-1))<<2*(d%4),h=f.indexOf(b.charAt(d))>>>6-2*(d%4);c[a>>>2]|=(g|h)<<24-8*(a%4),a++}return j.create(c,a)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),CryptoJS.lib.Cipher||function(u){var g=CryptoJS,f=g.lib,k=f.Base,l=f.WordArray,q=f.BufferedBlockAlgorithm,r=g.enc.Base64,v=g.algo.EvpKDF,n=f.Cipher=q.extend({cfg:k.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c),this._xformMode=a,this._key=b,this.reset()},reset:function(){q.reset.call(this),this._doReset()},process:function(a){return this._append(a),this._process()},finalize:function(a){return a&&this._append(a),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(a){return{encrypt:function(b,c,d){return("string"==typeof c?s:j).encrypt(a,b,c,d)},decrypt:function(b,c,d){return("string"==typeof c?s:j).decrypt(a,b,c,d)}}}});f.StreamCipher=n.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var m=g.mode={},t=function(a,b,c){var d=this._iv;d?this._iv=u:d=this._prevBlock;for(var e=0;e<c;e++)a[b+e]^=d[e]},h=(f.BlockCipherMode=k.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a,this._iv=b}})).extend();h.Encryptor=h.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize;t.call(this,a,b,d),c.encryptBlock(a,b),this._prevBlock=a.slice(b,b+d)}}),h.Decryptor=h.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize,e=a.slice(b,b+d);c.decryptBlock(a,b),t.call(this,a,b,d),this._prevBlock=e}}),m=m.CBC=h,h=(g.pad={}).Pkcs7={pad:function(a,b){for(var c=4*b,c=c-a.sigBytes%c,d=c<<24|c<<16|c<<8|c,e=[],f=0;f<c;f+=4)e.push(d);c=l.create(e,c),a.concat(c)},unpad:function(a){a.sigBytes-=255&a.words[a.sigBytes-1>>>2]}},f.BlockCipher=n.extend({cfg:n.cfg.extend({mode:m,padding:h}),reset:function(){n.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var c=a.createEncryptor;else c=a.createDecryptor,this._minBufferSize=1;this._mode=c.call(a,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var p=f.CipherParams=k.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),m=(g.format={}).OpenSSL={stringify:function(a){var b=a.ciphertext;return a=a.salt,(a?l.create([1398893684,1701076831]).concat(a).concat(b):b).toString(r)},parse:function(a){a=r.parse(a);var b=a.words;if(1398893684==b[0]&&1701076831==b[1]){var c=l.create(b.slice(2,4));b.splice(0,4),a.sigBytes-=16}return p.create({ciphertext:a,salt:c})}},j=f.SerializableCipher=k.extend({cfg:k.extend({format:m}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);var e=a.createEncryptor(c,d);return b=e.finalize(b),e=e.cfg,p.create({ciphertext:b,key:c,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),a.createDecryptor(c,d).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),g=(g.kdf={}).OpenSSL={execute:function(a,b,c,d){return d||(d=l.random(8)),a=v.create({keySize:b+c}).compute(a,d),c=l.create(a.words.slice(b),4*c),a.sigBytes=4*b,p.create({key:a,iv:c,salt:d})}},s=f.PasswordBasedCipher=j.extend({cfg:j.cfg.extend({kdf:g}),encrypt:function(a,b,c,d){return d=this.cfg.extend(d),c=d.kdf.execute(c,a.keySize,a.ivSize),d.iv=c.iv,a=j.encrypt.call(this,a,b,c.key,d),a.mixIn(c),a},decrypt:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),c=d.kdf.execute(c,a.keySize,a.ivSize,b.salt),d.iv=c.iv,j.decrypt.call(this,a,b,c.key,d)}})}(),function(){for(var q=CryptoJS,x=q.lib.BlockCipher,r=q.algo,j=[],y=[],z=[],A=[],B=[],C=[],s=[],u=[],v=[],w=[],g=[],k=0;256>k;k++)g[k]=128>k?k<<1:k<<1^283;for(var n=0,l=0,k=0;256>k;k++){var f=l^l<<1^l<<2^l<<3^l<<4,f=f>>>8^255&f^99;j[n]=f,y[f]=n;var t=g[n],D=g[t],E=g[D],b=257*g[f]^16843008*f;z[n]=b<<24|b>>>8,A[n]=b<<16|b>>>16,B[n]=b<<8|b>>>24,C[n]=b,b=16843009*E^65537*D^257*t^16843008*n,s[f]=b<<24|b>>>8,u[f]=b<<16|b>>>16,v[f]=b<<8|b>>>24,w[f]=b,n?(n=t^g[g[g[E^t]]],l^=g[g[l]]):n=l=1}var F=[0,1,2,4,8,16,32,64,128,27,54],r=r.AES=x.extend({_doReset:function(){for(var c=this._key,e=c.words,a=c.sigBytes/4,c=4*((this._nRounds=a+6)+1),b=this._keySchedule=[],h=0;h<c;h++)if(h<a)b[h]=e[h];else{var d=b[h-1];h%a?6<a&&4==h%a&&(d=j[d>>>24]<<24|j[d>>>16&255]<<16|j[d>>>8&255]<<8|j[255&d]):(d=d<<8|d>>>24,d=j[d>>>24]<<24|j[d>>>16&255]<<16|j[d>>>8&255]<<8|j[255&d],d^=F[h/a|0]<<24),b[h]=b[h-a]^d}for(e=this._invKeySchedule=[],a=0;a<c;a++)h=c-a,d=a%4?b[h]:b[h-4],e[a]=4>a||4>=h?d:s[j[d>>>24]]^u[j[d>>>16&255]]^v[j[d>>>8&255]]^w[j[255&d]]},encryptBlock:function(c,e){this._doCryptBlock(c,e,this._keySchedule,z,A,B,C,j)},decryptBlock:function(c,e){var a=c[e+1];c[e+1]=c[e+3],c[e+3]=a,this._doCryptBlock(c,e,this._invKeySchedule,s,u,v,w,y),a=c[e+1],c[e+1]=c[e+3],c[e+3]=a},_doCryptBlock:function(c,e,a,b,h,d,j,m){for(var n=this._nRounds,f=c[e]^a[0],g=c[e+1]^a[1],k=c[e+2]^a[2],p=c[e+3]^a[3],l=4,t=1;t<n;t++)var q=b[f>>>24]^h[g>>>16&255]^d[k>>>8&255]^j[255&p]^a[l++],r=b[g>>>24]^h[k>>>16&255]^d[p>>>8&255]^j[255&f]^a[l++],s=b[k>>>24]^h[p>>>16&255]^d[f>>>8&255]^j[255&g]^a[l++],p=b[p>>>24]^h[f>>>16&255]^d[g>>>8&255]^j[255&k]^a[l++],f=q,g=r,k=s;q=(m[f>>>24]<<24|m[g>>>16&255]<<16|m[k>>>8&255]<<8|m[255&p])^a[l++],r=(m[g>>>24]<<24|m[k>>>16&255]<<16|m[p>>>8&255]<<8|m[255&f])^a[l++],s=(m[k>>>24]<<24|m[p>>>16&255]<<16|m[f>>>8&255]<<8|m[255&g])^a[l++],p=(m[p>>>24]<<24|m[f>>>16&255]<<16|m[g>>>8&255]<<8|m[255&k])^a[l++],c[e]=q,c[e+1]=r,c[e+2]=s,c[e+3]=p},keySize:8});q.AES=x._createHelper(r)}(),function(){function j(b,c){var a=(this._lBlock>>>b^this._rBlock)&c;this._rBlock^=a,this._lBlock^=a<<b}function l(b,c){var a=(this._rBlock>>>b^this._lBlock)&c;this._lBlock^=a,this._rBlock^=a<<b}var h=CryptoJS,e=h.lib,n=e.WordArray,e=e.BlockCipher,g=h.algo,q=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],p=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],r=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],s=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,
377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],t=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],m=g.DES=e.extend({_doReset:function(){for(var b=this._key.words,c=[],a=0;56>a;a++){var f=q[a]-1;c[a]=b[f>>>5]>>>31-f%32&1}for(b=this._subKeys=[],f=0;16>f;f++){for(var d=b[f]=[],e=r[f],a=0;24>a;a++)d[a/6|0]|=c[(p[a]-1+e)%28]<<31-a%6,d[4+(a/6|0)]|=c[28+(p[a+24]-1+e)%28]<<31-a%6;for(d[0]=d[0]<<1|d[0]>>>31,a=1;7>a;a++)d[a]>>>=4*(a-1)+3;d[7]=d[7]<<5|d[7]>>>27}for(c=this._invSubKeys=[],a=0;16>a;a++)c[a]=b[15-a]},encryptBlock:function(b,c){this._doCryptBlock(b,c,this._subKeys)},decryptBlock:function(b,c){this._doCryptBlock(b,c,this._invSubKeys)},_doCryptBlock:function(b,c,a){this._lBlock=b[c],this._rBlock=b[c+1],j.call(this,4,252645135),j.call(this,16,65535),l.call(this,2,858993459),l.call(this,8,16711935),j.call(this,1,1431655765);for(var f=0;16>f;f++){for(var d=a[f],e=this._lBlock,h=this._rBlock,g=0,k=0;8>k;k++)g|=s[k][((h^d[k])&t[k])>>>0];this._lBlock=h,this._rBlock=e^g}a=this._lBlock,this._lBlock=this._rBlock,this._rBlock=a,j.call(this,1,1431655765),l.call(this,8,16711935),l.call(this,2,858993459),j.call(this,16,65535),j.call(this,4,252645135),b[c]=this._lBlock,b[c+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});h.DES=e._createHelper(m),g=g.TripleDES=e.extend({_doReset:function(){var b=this._key.words;this._des1=m.createEncryptor(n.create(b.slice(0,2))),this._des2=m.createEncryptor(n.create(b.slice(2,4))),this._des3=m.createEncryptor(n.create(b.slice(4,6)))},encryptBlock:function(b,c){this._des1.encryptBlock(b,c),this._des2.decryptBlock(b,c),this._des3.encryptBlock(b,c)},decryptBlock:function(b,c){this._des3.decryptBlock(b,c),this._des2.encryptBlock(b,c),this._des1.decryptBlock(b,c)},keySize:6,ivSize:2,blockSize:2}),h.TripleDES=e._createHelper(g)}(),function(){var k=CryptoJS,b=k.lib,m=b.WordArray,l=b.Hasher,d=[],b=k.algo.SHA1=l.extend({_doReset:function(){this._hash=new m.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(n,p){for(var a=this._hash.words,e=a[0],f=a[1],h=a[2],j=a[3],b=a[4],c=0;80>c;c++){if(16>c)d[c]=0|n[p+c];else{var g=d[c-3]^d[c-8]^d[c-14]^d[c-16];d[c]=g<<1|g>>>31}g=(e<<5|e>>>27)+b+d[c],g=20>c?g+((f&h|~f&j)+1518500249):40>c?g+((f^h^j)+1859775393):60>c?g+((f&h|f&j|h&j)-1894007588):g+((f^h^j)-899497514),b=j,j=h,h=f<<30|f>>>2,f=e,e=g}a[0]=a[0]+e|0,a[1]=a[1]+f|0,a[2]=a[2]+h|0,a[3]=a[3]+j|0,a[4]=a[4]+b|0},_doFinalize:function(){var b=this._data,d=b.words,a=8*this._nDataBytes,e=8*b.sigBytes;return d[e>>>5]|=128<<24-e%32,d[(e+64>>>9<<4)+14]=Math.floor(a/4294967296),d[(e+64>>>9<<4)+15]=a,b.sigBytes=4*d.length,this._process(),this._hash},clone:function(){var b=l.clone.call(this);return b._hash=this._hash.clone(),b}});k.SHA1=l._createHelper(b),k.HmacSHA1=l._createHmacHelper(b)}(),function(){var q=CryptoJS,d=q.lib,n=d.WordArray,p=d.Hasher,d=q.algo,x=n.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),y=n.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),z=n.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),A=n.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),B=n.create([0,1518500249,1859775393,2400959708,2840853838]),C=n.create([1352829926,1548603684,1836072691,2053994217,0]),d=d.RIPEMD160=p.extend({_doReset:function(){this._hash=n.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,v){for(var b=0;16>b;b++){var c=v+b,f=e[c];e[c]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8)}var t,g,h,j,r,u,k,l,m,s,c=this._hash.words,f=B.words,d=C.words,n=x.words,q=y.words,p=z.words,w=A.words;u=t=c[0],k=g=c[1],l=h=c[2],m=j=c[3],s=r=c[4];for(var a,b=0;80>b;b+=1)a=t+e[v+n[b]]|0,a=16>b?a+((g^h^j)+f[0]):32>b?a+((g&h|~g&j)+f[1]):48>b?a+(((g|~h)^j)+f[2]):64>b?a+((g&j|h&~j)+f[3]):a+((g^(h|~j))+f[4]),a|=0,a=a<<p[b]|a>>>32-p[b],a=a+r|0,t=r,r=j,j=h<<10|h>>>22,h=g,g=a,a=u+e[v+q[b]]|0,a=16>b?a+((k^(l|~m))+d[0]):32>b?a+((k&m|l&~m)+d[1]):48>b?a+(((k|~l)^m)+d[2]):64>b?a+((k&l|~k&m)+d[3]):a+((k^l^m)+d[4]),a|=0,a=a<<w[b]|a>>>32-w[b],a=a+s|0,u=s,s=m,m=l<<10|l>>>22,l=k,k=a;a=c[1]+h+m|0,c[1]=c[2]+j+s|0,c[2]=c[3]+r+u|0,c[3]=c[4]+t+k|0,c[4]=c[0]+g+l|0,c[0]=a},_doFinalize:function(){var e=this._data,d=e.words,b=8*this._nDataBytes,c=8*e.sigBytes;for(d[c>>>5]|=128<<24-c%32,d[(c+64>>>9<<4)+14]=16711935&(b<<8|b>>>24)|4278255360&(b<<24|b>>>8),e.sigBytes=4*(d.length+1),this._process(),e=this._hash,d=e.words,b=0;5>b;b++)c=d[b],d[b]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8);return e},clone:function(){var d=p.clone.call(this);return d._hash=this._hash.clone(),d}});q.RIPEMD160=p._createHelper(d),q.HmacRIPEMD160=p._createHmacHelper(d)}(Math),function(){var b=CryptoJS,a=b.lib,d=a.Base,m=a.WordArray,a=b.algo,q=a.HMAC,l=a.PBKDF2=d.extend({cfg:d.extend({keySize:4,hasher:a.SHA1,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,b){for(var c=this.cfg,f=q.create(c.hasher,a),g=m.create(),d=m.create([1]),l=g.words,r=d.words,n=c.keySize,c=c.iterations;l.length<n;){var h=f.update(b).finalize(d);f.reset();for(var j=h.words,s=j.length,k=h,p=1;p<c;p++){k=f.finalize(k),f.reset();for(var t=k.words,e=0;e<s;e++)j[e]^=t[e]}g.concat(h),r[0]++}return g.sigBytes=4*n,g}});b.PBKDF2=function(a,b,c){return l.create(c).compute(a,b)}}();var b64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64pad="=",dbits,canary=0xdeadbeefcafe,j_lm=15715070==(16777215&canary);j_lm&&"Microsoft Internet Explorer"==navigator.appName?(BigInteger.prototype.am=am2,dbits=30):j_lm&&"Netscape"!=navigator.appName?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28),BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP),BigInteger.prototype.F1=BI_FP-dbits,BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=new Array,rr,vv;for(rr="0".charCodeAt(0),vv=0;vv<=9;++vv)BI_RC[rr++]=vv;for(rr="a".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;for(rr="A".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;Classic.prototype.convert=cConvert,Classic.prototype.revert=cRevert,Classic.prototype.reduce=cReduce,Classic.prototype.mulTo=cMulTo,Classic.prototype.sqrTo=cSqrTo,Montgomery.prototype.convert=montConvert,Montgomery.prototype.revert=montRevert,Montgomery.prototype.reduce=montReduce,Montgomery.prototype.mulTo=montMulTo,Montgomery.prototype.sqrTo=montSqrTo,BigInteger.prototype.copyTo=bnpCopyTo,BigInteger.prototype.fromInt=bnpFromInt,BigInteger.prototype.fromString=bnpFromString,BigInteger.prototype.clamp=bnpClamp,BigInteger.prototype.dlShiftTo=bnpDLShiftTo,BigInteger.prototype.drShiftTo=bnpDRShiftTo,BigInteger.prototype.lShiftTo=bnpLShiftTo,BigInteger.prototype.rShiftTo=bnpRShiftTo,BigInteger.prototype.subTo=bnpSubTo,BigInteger.prototype.multiplyTo=bnpMultiplyTo,BigInteger.prototype.squareTo=bnpSquareTo,BigInteger.prototype.divRemTo=bnpDivRemTo,BigInteger.prototype.invDigit=bnpInvDigit,BigInteger.prototype.isEven=bnpIsEven,BigInteger.prototype.exp=bnpExp,BigInteger.prototype.toString=bnToString,BigInteger.prototype.negate=bnNegate,BigInteger.prototype.abs=bnAbs,BigInteger.prototype.compareTo=bnCompareTo,BigInteger.prototype.bitLength=bnBitLength,BigInteger.prototype.mod=bnMod,BigInteger.prototype.modPowInt=bnModPowInt,BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1),NullExp.prototype.convert=nNop,NullExp.prototype.revert=nNop,NullExp.prototype.mulTo=nMulTo,NullExp.prototype.sqrTo=nSqrTo,Barrett.prototype.convert=barrettConvert,Barrett.prototype.revert=barrettRevert,Barrett.prototype.reduce=barrettReduce,Barrett.prototype.mulTo=barrettMulTo,Barrett.prototype.sqrTo=barrettSqrTo;var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],lplim=(1<<26)/lowprimes[lowprimes.length-1];BigInteger.prototype.chunkSize=bnpChunkSize,BigInteger.prototype.toRadix=bnpToRadix,BigInteger.prototype.fromRadix=bnpFromRadix,BigInteger.prototype.fromNumber=bnpFromNumber,BigInteger.prototype.bitwiseTo=bnpBitwiseTo,BigInteger.prototype.changeBit=bnpChangeBit,BigInteger.prototype.addTo=bnpAddTo,BigInteger.prototype.dMultiply=bnpDMultiply,BigInteger.prototype.dAddOffset=bnpDAddOffset,BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo,BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo,BigInteger.prototype.modInt=bnpModInt,BigInteger.prototype.millerRabin=bnpMillerRabin,BigInteger.prototype.clone=bnClone,BigInteger.prototype.intValue=bnIntValue,BigInteger.prototype.byteValue=bnByteValue,BigInteger.prototype.shortValue=bnShortValue,BigInteger.prototype.signum=bnSigNum,BigInteger.prototype.toByteArray=bnToByteArray,BigInteger.prototype.equals=bnEquals,BigInteger.prototype.min=bnMin,BigInteger.prototype.max=bnMax,BigInteger.prototype.and=bnAnd,BigInteger.prototype.or=bnOr,BigInteger.prototype.xor=bnXor,BigInteger.prototype.andNot=bnAndNot,BigInteger.prototype.not=bnNot,BigInteger.prototype.shiftLeft=bnShiftLeft,BigInteger.prototype.shiftRight=bnShiftRight,BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit,BigInteger.prototype.bitCount=bnBitCount,BigInteger.prototype.testBit=bnTestBit,BigInteger.prototype.setBit=bnSetBit,BigInteger.prototype.clearBit=bnClearBit,BigInteger.prototype.flipBit=bnFlipBit,BigInteger.prototype.add=bnAdd,BigInteger.prototype.subtract=bnSubtract,BigInteger.prototype.multiply=bnMultiply,BigInteger.prototype.divide=bnDivide,BigInteger.prototype.remainder=bnRemainder,BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder,BigInteger.prototype.modPow=bnModPow,BigInteger.prototype.modInverse=bnModInverse,BigInteger.prototype.pow=bnPow,BigInteger.prototype.gcd=bnGCD,BigInteger.prototype.isProbablePrime=bnIsProbablePrime,BigInteger.prototype.square=bnSquare,Arcfour.prototype.init=ARC4init,Arcfour.prototype.next=ARC4next;var rng_psize=256,rng_state,rng_pool,rng_pptr;if(null==rng_pool){rng_pool=new Array,rng_pptr=0;var t;if("Netscape"==navigator.appName&&navigator.appVersion<"5"&&window.crypto){var z=window.crypto.random(32);for(t=0;t<z.length;++t)rng_pool[rng_pptr++]=255&z.charCodeAt(t)}for(;rng_pptr<rng_psize;)t=Math.floor(65536*Math.random()),rng_pool[rng_pptr++]=t>>>8,rng_pool[rng_pptr++]=255&t;rng_pptr=0,rng_seed_time()}SecureRandom.prototype.nextBytes=rng_get_bytes;var SHA1_SIZE=20;RSAKey.prototype.doPublic=RSADoPublic,RSAKey.prototype.setPublic=RSASetPublic,RSAKey.prototype.encrypt=RSAEncrypt,RSAKey.prototype.encryptOAEP=RSAEncryptOAEP,RSAKey.prototype.type="RSA";var SHA1_SIZE=20;RSAKey.prototype.doPrivate=RSADoPrivate,RSAKey.prototype.setPrivate=RSASetPrivate,RSAKey.prototype.setPrivateEx=RSASetPrivateEx,RSAKey.prototype.generate=RSAGenerate,RSAKey.prototype.decrypt=RSADecrypt,RSAKey.prototype.decryptOAEP=RSADecryptOAEP,ECFieldElementFp.prototype.equals=feFpEquals,ECFieldElementFp.prototype.toBigInteger=feFpToBigInteger,ECFieldElementFp.prototype.negate=feFpNegate,ECFieldElementFp.prototype.add=feFpAdd,ECFieldElementFp.prototype.subtract=feFpSubtract,ECFieldElementFp.prototype.multiply=feFpMultiply,ECFieldElementFp.prototype.square=feFpSquare,ECFieldElementFp.prototype.divide=feFpDivide,ECPointFp.prototype.getX=pointFpGetX,ECPointFp.prototype.getY=pointFpGetY,ECPointFp.prototype.equals=pointFpEquals,ECPointFp.prototype.isInfinity=pointFpIsInfinity,ECPointFp.prototype.negate=pointFpNegate,ECPointFp.prototype.add=pointFpAdd,ECPointFp.prototype.twice=pointFpTwice,ECPointFp.prototype.multiply=pointFpMultiply,ECPointFp.prototype.multiplyTwo=pointFpMultiplyTwo,ECCurveFp.prototype.getQ=curveFpGetQ,ECCurveFp.prototype.getA=curveFpGetA,ECCurveFp.prototype.getB=curveFpGetB,ECCurveFp.prototype.equals=curveFpEquals,ECCurveFp.prototype.getInfinity=curveFpGetInfinity,ECCurveFp.prototype.fromBigInteger=curveFpFromBigInteger,ECCurveFp.prototype.decodePointHex=curveFpDecodePointHex,ECFieldElementFp.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},ECPointFp.prototype.getEncoded=function(c){var d=function(h,f){var g=h.toByteArrayUnsigned();if(f<g.length)g=g.slice(g.length-f);else for(;f>g.length;)g.unshift(0);return g},a=this.getX().toBigInteger(),e=this.getY().toBigInteger(),b=d(a,32);return c?e.isEven()?b.unshift(2):b.unshift(3):(b.unshift(4),b=b.concat(d(e,32))),b},ECPointFp.decodeFrom=function(g,c){var e=(c[0],c.length-1),d=c.slice(1,1+e/2),b=c.slice(1+e/2,1+e);d.unshift(0),b.unshift(0);var a=new BigInteger(d),h=new BigInteger(b);return new ECPointFp(g,g.fromBigInteger(a),g.fromBigInteger(h))},ECPointFp.decodeFromHex=function(g,c){var e=(c.substr(0,2),c.length-2),d=c.substr(2,e/2),b=c.substr(2+e/2,e/2),a=new BigInteger(d,16),h=new BigInteger(b,16);return new ECPointFp(g,g.fromBigInteger(a),g.fromBigInteger(h))},ECPointFp.prototype.add2D=function(c){if(this.isInfinity())return c;if(c.isInfinity())return this;if(this.x.equals(c.x))return this.y.equals(c.y)?this.twice():this.curve.getInfinity();var g=c.x.subtract(this.x),e=c.y.subtract(this.y),a=e.divide(g),d=a.square().subtract(this.x).subtract(c.x),f=a.multiply(this.x.subtract(d)).subtract(this.y);return new ECPointFp(this.curve,d,f)},ECPointFp.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var b=this.curve.fromBigInteger(BigInteger.valueOf(2)),e=this.curve.fromBigInteger(BigInteger.valueOf(3)),a=this.x.square().multiply(e).add(this.curve.a).divide(this.y.multiply(b)),c=a.square().subtract(this.x.multiply(b)),d=a.multiply(this.x.subtract(c)).subtract(this.y);return new ECPointFp(this.curve,c,d)},ECPointFp.prototype.multiply2D=function(b){if(this.isInfinity())return this;if(0==b.signum())return this.curve.getInfinity();var c,g=b,f=g.multiply(new BigInteger("3")),l=this.negate(),d=this;for(c=f.bitLength()-2;c>0;--c){d=d.twice();var a=f.testBit(c),j=g.testBit(c);a!=j&&(d=d.add2D(a?this:l))}return d},ECPointFp.prototype.isOnCurve=function(){var d=this.getX().toBigInteger(),i=this.getY().toBigInteger(),f=this.curve.getA().toBigInteger(),c=this.curve.getB().toBigInteger(),h=this.curve.getQ(),e=i.multiply(i).mod(h),g=d.multiply(d).multiply(d).add(f.multiply(d)).add(c).mod(h);return e.equals(g)},ECPointFp.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},ECPointFp.prototype.validate=function(){var c=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var a=this.getX().toBigInteger(),b=this.getY().toBigInteger();if(a.compareTo(BigInteger.ONE)<0||a.compareTo(c.subtract(BigInteger.ONE))>0)throw new Error("x coordinate out of bounds");if(b.compareTo(BigInteger.ONE)<0||b.compareTo(c.subtract(BigInteger.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(c).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0},"undefined"!=typeof KJUR&&KJUR||(KJUR={}),"undefined"!=typeof KJUR.asn1&&KJUR.asn1||(KJUR.asn1={}),KJUR.asn1.ASN1Util=new function(){this.integerToByteHex=function(a){var b=a.toString(16);return b.length%2==1&&(b="0"+b),b},this.bigIntToMinTwosComplementsHex=function(j){var f=j.toString(16);if("-"!=f.substr(0,1))f.length%2==1?f="0"+f:f.match(/^[0-7]/)||(f="00"+f);else{var a=f.substr(1),e=a.length;e%2==1?e+=1:f.match(/^[0-7]/)||(e+=2);for(var g="",d=0;d<e;d++)g+="f";var c=new BigInteger(g,16),b=c.xor(j).add(BigInteger.ONE);f=b.toString(16).replace(/^-/,"")}return f},this.getPEMStringFromHex=function(a,b){var f=(KJUR.asn1,CryptoJS.enc.Hex.parse(a)),d=CryptoJS.enc.Base64.stringify(f),e=d.replace(/(.{64})/g,"$1\r\n");return e=e.replace(/\r\n$/,""),"-----BEGIN "+b+"-----\r\n"+e+"\r\n-----END "+b+"-----\r\n"},this.newObject=function(b){var e=KJUR.asn1,h=Object.keys(b);if(1!=h.length)throw"key of param shall be only one.";var g=h[0];if(":bool:int:bitstr:octstr:null:oid:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+g+":")==-1)throw"undefined key: "+g;if("bool"==g)return new e.DERBoolean(b[g]);if("int"==g)return new e.DERInteger(b[g]);if("bitstr"==g)return new e.DERBitString(b[g]);if("octstr"==g)return new e.DEROctetString(b[g]);if("null"==g)return new e.DERNull(b[g]);if("oid"==g)return new e.DERObjectIdentifier(b[g]);if("utf8str"==g)return new e.DERUTF8String(b[g]);if("numstr"==g)return new e.DERNumericString(b[g]);if("prnstr"==g)return new e.DERPrintableString(b[g]);if("telstr"==g)return new e.DERTeletexString(b[g]);if("ia5str"==g)return new e.DERIA5String(b[g]);if("utctime"==g)return new e.DERUTCTime(b[g]);if("gentime"==g)return new e.DERGeneralizedTime(b[g]);if("seq"==g){for(var k=b[g],f=[],c=0;c<k.length;c++){var j=e.ASN1Util.newObject(k[c]);f.push(j)}return new e.DERSequence({array:f})}if("set"==g){for(var k=b[g],f=[],c=0;c<k.length;c++){var j=e.ASN1Util.newObject(k[c]);f.push(j)}return new e.DERSet({array:f})}if("tag"==g){var d={};if(void 0!==b[g].explicit&&(d.explicit=b[g].explicit),void 0!==b[g].tag&&(d.tag=b[g].tag),void 0===b[g].obj)throw"obj shall be specified for 'tag'.";return d.obj=e.ASN1Util.newObject(b[g].obj),new e.DERTaggedObject(d)}}},KJUR.asn1.ASN1Object=function(){var a="";this.getLengthHexFromValue=function(){if("undefined"==typeof this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+a.length+",v="+this.hV;var i=this.hV.length/2,h=i.toString(16);if(h.length%2==1&&(h="0"+h),i<128)return h;var g=h.length/2;if(g>15)throw"ASN.1 length too long to represent by 8x: n = "+i.toString(16);var f=128+g;return f.toString(16)+h},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},KJUR.asn1.DERAbstractString=function(c){KJUR.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(d){this.hTLV=null,this.isModified=!0,this.s=d,this.hV=stohex(this.s)},this.setStringHex=function(d){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=d},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof c&&("string"==typeof c?this.setString(c):"undefined"!=typeof c.str?this.setString(c.str):"undefined"!=typeof c.hex&&this.setStringHex(c.hex))},YAHOO.lang.extend(KJUR.asn1.DERAbstractString,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractTime=function(c){KJUR.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(f){utc=f.getTime()+6e4*f.getTimezoneOffset();var e=new Date(utc);return e},this.formatDate=function(j,l){var e=this.zeroPadding,k=this.localDateToUTC(j),m=String(k.getFullYear());"utc"==l&&(m=m.substr(2,2));var i=e(String(k.getMonth()+1),2),n=e(String(k.getDate()),2),f=e(String(k.getHours()),2),g=e(String(k.getMinutes()),2),h=e(String(k.getSeconds()),2);return m+i+n+f+g+h+"Z"},this.zeroPadding=function(e,d){return e.length>=d?e:new Array(d-e.length+1).join("0")+e},this.getString=function(){return this.s},this.setString=function(d){this.hTLV=null,this.isModified=!0,this.s=d,this.hV=stohex(d)},this.setByDateValue=function(h,j,e,d,f,g){var i=new Date(Date.UTC(h,j-1,e,d,f,g,0));this.setByDate(i)},this.getFreshValueHex=function(){return this.hV}},YAHOO.lang.extend(KJUR.asn1.DERAbstractTime,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractStructured=function(b){KJUR.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(c){this.hTLV=null,this.isModified=!0,this.asn1Array=c},this.appendASN1Object=function(c){this.hTLV=null,this.isModified=!0,this.asn1Array.push(c)},this.asn1Array=new Array,"undefined"!=typeof b&&"undefined"!=typeof b.array&&(this.asn1Array=b.array)},YAHOO.lang.extend(KJUR.asn1.DERAbstractStructured,KJUR.asn1.ASN1Object),KJUR.asn1.DERBoolean=function(){KJUR.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},YAHOO.lang.extend(KJUR.asn1.DERBoolean,KJUR.asn1.ASN1Object),KJUR.asn1.DERInteger=function(a){KJUR.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(b){this.hTLV=null,this.isModified=!0,this.hV=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(b)},this.setByInteger=function(c){var b=new BigInteger(String(c),10);this.setByBigInteger(b)},this.setValueHex=function(b){this.hV=b},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof a&&("undefined"!=typeof a.bigint?this.setByBigInteger(a.bigint):"undefined"!=typeof a.int?this.setByInteger(a.int):"number"==typeof a?this.setByInteger(a):"undefined"!=typeof a.hex&&this.setValueHex(a.hex))},YAHOO.lang.extend(KJUR.asn1.DERInteger,KJUR.asn1.ASN1Object),KJUR.asn1.DERBitString=function(a){KJUR.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(b){this.hTLV=null,this.isModified=!0,this.hV=b},this.setUnusedBitsAndHexValue=function(b,d){if(b<0||7<b)throw"unused bits shall be from 0 to 7: u = "+b;var c="0"+b;this.hTLV=null,this.isModified=!0,this.hV=c+d},this.setByBinaryString=function(e){e=e.replace(/0+$/,"");var f=8-e.length%8;8==f&&(f=0);for(var g=0;g<=f;g++)e+="0";for(var j="",g=0;g<e.length-1;g+=8){var d=e.substr(g,8),c=parseInt(d,2).toString(16);1==c.length&&(c="0"+c),j+=c}this.hTLV=null,this.isModified=!0,this.hV="0"+f+j},this.setByBooleanArray=function(d){for(var c="",b=0;b<d.length;b++)c+=1==d[b]?"1":"0";this.setByBinaryString(c)},this.newFalseArray=function(d){for(var b=new Array(d),c=0;c<d;c++)b[c]=!1;return b},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof a&&("string"==typeof a&&a.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(a):"undefined"!=typeof a.hex?this.setHexValueIncludingUnusedBits(a.hex):"undefined"!=typeof a.bin?this.setByBinaryString(a.bin):"undefined"!=typeof a.array&&this.setByBooleanArray(a.array))},YAHOO.lang.extend(KJUR.asn1.DERBitString,KJUR.asn1.ASN1Object),KJUR.asn1.DEROctetString=function(a){KJUR.asn1.DEROctetString.superclass.constructor.call(this,a),this.hT="04"},YAHOO.lang.extend(KJUR.asn1.DEROctetString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNull=function(){KJUR.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},YAHOO.lang.extend(KJUR.asn1.DERNull,KJUR.asn1.ASN1Object),KJUR.asn1.DERObjectIdentifier=function(c){var b=function(d){var e=d.toString(16);return 1==e.length&&(e="0"+e),e},a=function(k){var j="",e=new BigInteger(k,10),d=e.toString(2),f=7-d.length%7;7==f&&(f=0);for(var m="",g=0;g<f;g++)m+="0";d=m+d;for(var g=0;g<d.length-1;g+=7){var l=d.substr(g,7);g!=d.length-7&&(l="1"+l),j+=b(parseInt(l,2))}return j};KJUR.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(d){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=d},this.setValueOidString=function(f){if(!f.match(/^[0-9.]+$/))throw"malformed oid string: "+f;var g="",d=f.split("."),j=40*parseInt(d[0])+parseInt(d[1]);g+=b(j),d.splice(0,2);for(var e=0;e<d.length;e++)g+=a(d[e]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=g},this.setValueName=function(e){if("undefined"==typeof KJUR.asn1.x509.OID.name2oidList[e])throw"DERObjectIdentifier oidName undefined: "+e;var d=KJUR.asn1.x509.OID.name2oidList[e];this.setValueOidString(d)},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof c&&("string"==typeof c&&c.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(c):void 0!==KJUR.asn1.x509.OID.name2oidList[c]?this.setValueOidString(KJUR.asn1.x509.OID.name2oidList[c]):"undefined"!=typeof c.oid?this.setValueOidString(c.oid):"undefined"!=typeof c.hex?this.setValueHex(c.hex):"undefined"!=typeof c.name&&this.setValueName(c.name))},YAHOO.lang.extend(KJUR.asn1.DERObjectIdentifier,KJUR.asn1.ASN1Object),KJUR.asn1.DERUTF8String=function(a){KJUR.asn1.DERUTF8String.superclass.constructor.call(this,a),this.hT="0c"},YAHOO.lang.extend(KJUR.asn1.DERUTF8String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNumericString=function(a){KJUR.asn1.DERNumericString.superclass.constructor.call(this,a),this.hT="12"},YAHOO.lang.extend(KJUR.asn1.DERNumericString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERPrintableString=function(a){KJUR.asn1.DERPrintableString.superclass.constructor.call(this,a),this.hT="13"},YAHOO.lang.extend(KJUR.asn1.DERPrintableString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERTeletexString=function(a){KJUR.asn1.DERTeletexString.superclass.constructor.call(this,a),this.hT="14"},YAHOO.lang.extend(KJUR.asn1.DERTeletexString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERIA5String=function(a){KJUR.asn1.DERIA5String.superclass.constructor.call(this,a),this.hT="16"},YAHOO.lang.extend(KJUR.asn1.DERIA5String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERUTCTime=function(a){KJUR.asn1.DERUTCTime.superclass.constructor.call(this,a),this.hT="17",this.setByDate=function(b){this.hTLV=null,this.isModified=!0,this.date=b,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},"undefined"!=typeof a&&("undefined"!=typeof a.str?this.setString(a.str):"string"==typeof a&&a.match(/^[0-9]{12}Z$/)?this.setString(a):"undefined"!=typeof a.hex?this.setStringHex(a.hex):"undefined"!=typeof a.date&&this.setByDate(a.date))},YAHOO.lang.extend(KJUR.asn1.DERUTCTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERGeneralizedTime=function(a){KJUR.asn1.DERGeneralizedTime.superclass.constructor.call(this,a),
this.hT="18",this.setByDate=function(b){this.hTLV=null,this.isModified=!0,this.date=b,this.s=this.formatDate(this.date,"gen"),this.hV=stohex(this.s)},"undefined"!=typeof a&&("undefined"!=typeof a.str?this.setString(a.str):"string"==typeof a&&a.match(/^[0-9]{14}Z$/)?this.setString(a):"undefined"!=typeof a.hex?this.setStringHex(a.hex):"undefined"!=typeof a.date&&this.setByDate(a.date))},YAHOO.lang.extend(KJUR.asn1.DERGeneralizedTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERSequence=function(a){KJUR.asn1.DERSequence.superclass.constructor.call(this,a),this.hT="30",this.getFreshValueHex=function(){for(var c="",b=0;b<this.asn1Array.length;b++){var d=this.asn1Array[b];c+=d.getEncodedHex()}return this.hV=c,this.hV}},YAHOO.lang.extend(KJUR.asn1.DERSequence,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERSet=function(a){KJUR.asn1.DERSet.superclass.constructor.call(this,a),this.hT="31",this.getFreshValueHex=function(){for(var b=new Array,c=0;c<this.asn1Array.length;c++){var d=this.asn1Array[c];b.push(d.getEncodedHex())}return b.sort(),this.hV=b.join(""),this.hV}},YAHOO.lang.extend(KJUR.asn1.DERSet,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERTaggedObject=function(a){KJUR.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(b,c,d){this.hT=c,this.isExplicit=b,this.asn1Object=d,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=d.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,c),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},"undefined"!=typeof a&&("undefined"!=typeof a.tag&&(this.hT=a.tag),"undefined"!=typeof a.explicit&&(this.isExplicit=a.explicit),"undefined"!=typeof a.obj&&(this.asn1Object=a.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},YAHOO.lang.extend(KJUR.asn1.DERTaggedObject,KJUR.asn1.ASN1Object);var ASN1HEX=new function(){this.getByteLengthOfL_AtObj=function(b,c){if("8"!=b.substring(c+2,c+3))return 1;var a=parseInt(b.substring(c+3,c+4));return 0==a?-1:0<a&&a<10?a+1:-2},this.getHexOfL_AtObj=function(b,c){var a=this.getByteLengthOfL_AtObj(b,c);return a<1?"":b.substring(c+2,c+2+2*a)},this.getIntOfL_AtObj=function(c,d){var b=this.getHexOfL_AtObj(c,d);if(""==b)return-1;var a;return a=parseInt(b.substring(0,1))<8?new BigInteger(b,16):new BigInteger(b.substring(2),16),a.intValue()},this.getStartPosOfV_AtObj=function(b,c){var a=this.getByteLengthOfL_AtObj(b,c);return a<0?a:c+2*(a+1)},this.getHexOfV_AtObj=function(c,d){var b=this.getStartPosOfV_AtObj(c,d),a=this.getIntOfL_AtObj(c,d);return c.substring(b,b+2*a)},this.getHexOfTLV_AtObj=function(c,e){var b=c.substr(e,2),d=this.getHexOfL_AtObj(c,e),a=this.getHexOfV_AtObj(c,e);return b+d+a},this.getPosOfNextSibling_AtObj=function(c,d){var b=this.getStartPosOfV_AtObj(c,d),a=this.getIntOfL_AtObj(c,d);return b+2*a},this.getPosArrayOfChildren_AtObj=function(f,j){var c=new Array,i=this.getStartPosOfV_AtObj(f,j);c.push(i);for(var b=this.getIntOfL_AtObj(f,j),g=i,d=0;;){var e=this.getPosOfNextSibling_AtObj(f,g);if(null==e||e-i>=2*b)break;if(d>=200)break;c.push(e),g=e,d++}return c},this.getNthChildIndex_AtObj=function(d,b,e){var c=this.getPosArrayOfChildren_AtObj(d,b);return c[e]},this.getDecendantIndexByNthList=function(e,d,c){if(0==c.length)return d;var f=c.shift(),b=this.getPosArrayOfChildren_AtObj(e,d);return this.getDecendantIndexByNthList(e,b[f],c)},this.getDecendantHexTLVByNthList=function(d,c,b){var a=this.getDecendantIndexByNthList(d,c,b);return this.getHexOfTLV_AtObj(d,a)},this.getDecendantHexVByNthList=function(d,c,b){var a=this.getDecendantIndexByNthList(d,c,b);return this.getHexOfV_AtObj(d,a)}};"undefined"!=typeof KJUR&&KJUR||(KJUR={}),"undefined"!=typeof KJUR.asn1&&KJUR.asn1||(KJUR.asn1={}),"undefined"!=typeof KJUR.asn1.x509&&KJUR.asn1.x509||(KJUR.asn1.x509={}),KJUR.asn1.x509.Certificate=function(f){KJUR.asn1.x509.Certificate.superclass.constructor.call(this),this.setRsaPrvKeyByPEMandPass=function(h,j){var g=PKCS5PKEY.getDecryptedKeyHex(h,j),i=new RSAKey;i.readPrivateKeyFromASN1HexString(g),this.rsaPrvKey=i},this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg,sig=new KJUR.crypto.Signature({alg:"SHA1withRSA",prov:"cryptojs/jsrsa"}),sig.initSign(this.rsaPrvKey),sig.updateHex(this.asn1TBSCert.getEncodedHex()),this.hexSig=sig.sign(),this.asn1Sig=new KJUR.asn1.DERBitString({hex:"00"+this.hexSig});var g=new KJUR.asn1.DERSequence({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=g.getEncodedHex(),this.isModified=!1},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},this.getPEMString=function(){var i=this.getEncodedHex(),g=CryptoJS.enc.Hex.parse(i),h=CryptoJS.enc.Base64.stringify(g),j=h.replace(/(.{64})/g,"$1\r\n");return"-----BEGIN CERTIFICATE-----\r\n"+j+"\r\n-----END CERTIFICATE-----\r\n"},"undefined"!=typeof f&&("undefined"!=typeof f.tbscertobj&&(this.asn1TBSCert=f.tbscertobj),"undefined"!=typeof f.rsaprvkey&&(this.rsaPrvKey=f.rsaprvkey),"undefined"!=typeof f.rsaprvpem&&"undefined"!=typeof f.rsaprvpas&&this.setRsaPrvKeyByPEMandPass(f.rsaprvpem,f.rsaprvpas))},YAHOO.lang.extend(KJUR.asn1.x509.Certificate,KJUR.asn1.ASN1Object),KJUR.asn1.x509.TBSCertificate=function(a){KJUR.asn1.x509.TBSCertificate.superclass.constructor.call(this),this._initialize=function(){this.asn1Array=new Array,this.asn1Version=new KJUR.asn1.DERTaggedObject({obj:new KJUR.asn1.DERInteger({int:2})}),this.asn1SerialNumber=null,this.asn1SignatureAlg=null,this.asn1Issuer=null,this.asn1NotBefore=null,this.asn1NotAfter=null,this.asn1Subject=null,this.asn1SubjPKey=null,this.extensionsArray=new Array},this.setSerialNumberByParam=function(b){this.asn1SerialNumber=new KJUR.asn1.DERInteger(b)},this.setSignatureAlgByParam=function(b){this.asn1SignatureAlg=new KJUR.asn1.x509.AlgorithmIdentifier(b)},this.setIssuerByParam=function(b){this.asn1Issuer=new KJUR.asn1.x509.X500Name(b)},this.setNotBeforeByParam=function(b){this.asn1NotBefore=new KJUR.asn1.x509.Time(b)},this.setNotAfterByParam=function(b){this.asn1NotAfter=new KJUR.asn1.x509.Time(b)},this.setSubjectByParam=function(b){this.asn1Subject=new KJUR.asn1.x509.X500Name(b)},this.setSubjectPublicKeyByParam=function(b){this.asn1SubjPKey=new KJUR.asn1.x509.SubjectPublicKeyInfo(b)},this.appendExtension=function(b){this.extensionsArray.push(b)},this.getEncodedHex=function(){if(null==this.asn1NotBefore||null==this.asn1NotAfter)throw"notBefore and/or notAfter not set";var c=new KJUR.asn1.DERSequence({array:[this.asn1NotBefore,this.asn1NotAfter]});if(this.asn1Array=new Array,this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1SerialNumber),this.asn1Array.push(this.asn1SignatureAlg),this.asn1Array.push(this.asn1Issuer),this.asn1Array.push(c),this.asn1Array.push(this.asn1Subject),this.asn1Array.push(this.asn1SubjPKey),this.extensionsArray.length>0){var d=new KJUR.asn1.DERSequence({array:this.extensionsArray}),b=new KJUR.asn1.DERTaggedObject({explicit:!0,tag:"a3",obj:d});this.asn1Array.push(b)}var e=new KJUR.asn1.DERSequence({array:this.asn1Array});return this.hTLV=e.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize()},YAHOO.lang.extend(KJUR.asn1.x509.TBSCertificate,KJUR.asn1.ASN1Object),KJUR.asn1.x509.Extension=function(b){KJUR.asn1.x509.Extension.superclass.constructor.call(this),this.getEncodedHex=function(){var f=new KJUR.asn1.DERObjectIdentifier({oid:this.oid}),e=new KJUR.asn1.DEROctetString({hex:this.getExtnValueHex()}),d=new Array;d.push(f),this.critical&&d.push(new KJUR.asn1.DERBoolean),d.push(e);var c=new KJUR.asn1.DERSequence({array:d});return c.getEncodedHex()},this.critical=!1,"undefined"!=typeof b&&"undefined"!=typeof b.critical&&(this.critical=b.critical)},YAHOO.lang.extend(KJUR.asn1.x509.Extension,KJUR.asn1.ASN1Object),KJUR.asn1.x509.KeyUsage=function(a){KJUR.asn1.x509.KeyUsage.superclass.constructor.call(this,a),this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.15","undefined"!=typeof a&&"undefined"!=typeof a.bin&&(this.asn1ExtnValue=new KJUR.asn1.DERBitString(a))},YAHOO.lang.extend(KJUR.asn1.x509.KeyUsage,KJUR.asn1.x509.Extension),KJUR.asn1.x509.BasicConstraints=function(c){KJUR.asn1.x509.BasicConstraints.superclass.constructor.call(this,c),this.getExtnValueHex=function(){var e=new Array;this.cA&&e.push(new KJUR.asn1.DERBoolean),this.pathLen>-1&&e.push(new KJUR.asn1.DERInteger({int:this.pathLen}));var d=new KJUR.asn1.DERSequence({array:e});return this.asn1ExtnValue=d,this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,"undefined"!=typeof c&&("undefined"!=typeof c.cA&&(this.cA=c.cA),"undefined"!=typeof c.pathLen&&(this.pathLen=c.pathLen))},YAHOO.lang.extend(KJUR.asn1.x509.BasicConstraints,KJUR.asn1.x509.Extension),KJUR.asn1.x509.CRLDistributionPoints=function(a){KJUR.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,a),this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.setByDPArray=function(b){this.asn1ExtnValue=new KJUR.asn1.DERSequence({array:b})},this.setByOneURI=function(e){var b=new KJUR.asn1.x509.GeneralNames([{uri:e}]),d=new KJUR.asn1.x509.DistributionPointName(b),c=new KJUR.asn1.x509.DistributionPoint({dpobj:d});this.setByDPArray([c])},this.oid="2.5.29.31","undefined"!=typeof a&&("undefined"!=typeof a.array?this.setByDPArray(a.array):"undefined"!=typeof a.uri&&this.setByOneURI(a.uri))},YAHOO.lang.extend(KJUR.asn1.x509.CRLDistributionPoints,KJUR.asn1.x509.Extension),KJUR.asn1.x509.ExtKeyUsage=function(a){KJUR.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,a),this.setPurposeArray=function(b){this.asn1ExtnValue=new KJUR.asn1.DERSequence;for(var c=0;c<b.length;c++){var d=new KJUR.asn1.DERObjectIdentifier(b[c]);this.asn1ExtnValue.appendASN1Object(d)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.37","undefined"!=typeof a&&"undefined"!=typeof a.array&&this.setPurposeArray(a.array)},YAHOO.lang.extend(KJUR.asn1.x509.ExtKeyUsage,KJUR.asn1.x509.Extension),KJUR.asn1.x509.CRL=function(f){KJUR.asn1.x509.CRL.superclass.constructor.call(this),this.setRsaPrvKeyByPEMandPass=function(h,j){var g=PKCS5PKEY.getDecryptedKeyHex(h,j),i=new RSAKey;i.readPrivateKeyFromASN1HexString(g),this.rsaPrvKey=i},this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCertList.asn1SignatureAlg,sig=new KJUR.crypto.Signature({alg:"SHA1withRSA",prov:"cryptojs/jsrsa"}),sig.initSign(this.rsaPrvKey),sig.updateHex(this.asn1TBSCertList.getEncodedHex()),this.hexSig=sig.sign(),this.asn1Sig=new KJUR.asn1.DERBitString({hex:"00"+this.hexSig});var g=new KJUR.asn1.DERSequence({array:[this.asn1TBSCertList,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=g.getEncodedHex(),this.isModified=!1},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},this.getPEMString=function(){var i=this.getEncodedHex(),g=CryptoJS.enc.Hex.parse(i),h=CryptoJS.enc.Base64.stringify(g),j=h.replace(/(.{64})/g,"$1\r\n");return"-----BEGIN X509 CRL-----\r\n"+j+"\r\n-----END X509 CRL-----\r\n"},"undefined"!=typeof f&&("undefined"!=typeof f.tbsobj&&(this.asn1TBSCertList=f.tbsobj),"undefined"!=typeof f.rsaprvkey&&(this.rsaPrvKey=f.rsaprvkey),"undefined"!=typeof f.rsaprvpem&&"undefined"!=typeof f.rsaprvpas&&this.setRsaPrvKeyByPEMandPass(f.rsaprvpem,f.rsaprvpas))},YAHOO.lang.extend(KJUR.asn1.x509.CRL,KJUR.asn1.ASN1Object),KJUR.asn1.x509.TBSCertList=function(b){KJUR.asn1.x509.TBSCertList.superclass.constructor.call(this),this.setSignatureAlgByParam=function(c){this.asn1SignatureAlg=new KJUR.asn1.x509.AlgorithmIdentifier(c)},this.setIssuerByParam=function(c){this.asn1Issuer=new KJUR.asn1.x509.X500Name(c)},this.setThisUpdateByParam=function(c){this.asn1ThisUpdate=new KJUR.asn1.x509.Time(c)},this.setNextUpdateByParam=function(c){this.asn1NextUpdate=new KJUR.asn1.x509.Time(c)},this.addRevokedCert=function(c,d){var f={};void 0!=c&&null!=c&&(f.sn=c),void 0!=d&&null!=d&&(f.time=d);var e=new KJUR.asn1.x509.CRLEntry(f);this.aRevokedCert.push(e)},this.getEncodedHex=function(){if(this.asn1Array=new Array,null!=this.asn1Version&&this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1SignatureAlg),this.asn1Array.push(this.asn1Issuer),this.asn1Array.push(this.asn1ThisUpdate),null!=this.asn1NextUpdate&&this.asn1Array.push(this.asn1NextUpdate),this.aRevokedCert.length>0){var c=new KJUR.asn1.DERSequence({array:this.aRevokedCert});this.asn1Array.push(c)}var d=new KJUR.asn1.DERSequence({array:this.asn1Array});return this.hTLV=d.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize=function(){this.asn1Version=null,this.asn1SignatureAlg=null,this.asn1Issuer=null,this.asn1ThisUpdate=null,this.asn1NextUpdate=null,this.aRevokedCert=new Array},this._initialize()},YAHOO.lang.extend(KJUR.asn1.x509.TBSCertList,KJUR.asn1.ASN1Object),KJUR.asn1.x509.CRLEntry=function(c){KJUR.asn1.x509.CRLEntry.superclass.constructor.call(this),this.setCertSerial=function(d){this.sn=new KJUR.asn1.DERInteger(d)},this.setRevocationDate=function(d){this.time=new KJUR.asn1.x509.Time(d)},this.getEncodedHex=function(){var d=new KJUR.asn1.DERSequence({array:[this.sn,this.time]});return this.TLV=d.getEncodedHex(),this.TLV},"undefined"!=typeof c&&("undefined"!=typeof c.time&&this.setRevocationDate(c.time),"undefined"!=typeof c.sn&&this.setCertSerial(c.sn))},YAHOO.lang.extend(KJUR.asn1.x509.CRLEntry,KJUR.asn1.ASN1Object),KJUR.asn1.x509.X500Name=function(a){KJUR.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=new Array,this.setByString=function(b){var c=b.split("/");c.shift();for(var d=0;d<c.length;d++)this.asn1Array.push(new KJUR.asn1.x509.RDN({str:c[d]}))},this.getEncodedHex=function(){var b=new KJUR.asn1.DERSequence({array:this.asn1Array});return this.TLV=b.getEncodedHex(),this.TLV},"undefined"!=typeof a&&"undefined"!=typeof a.str&&this.setByString(a.str)},YAHOO.lang.extend(KJUR.asn1.x509.X500Name,KJUR.asn1.ASN1Object),KJUR.asn1.x509.RDN=function(a){KJUR.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=new Array,this.addByString=function(b){this.asn1Array.push(new KJUR.asn1.x509.AttributeTypeAndValue({str:b}))},this.getEncodedHex=function(){var b=new KJUR.asn1.DERSet({array:this.asn1Array});return this.TLV=b.getEncodedHex(),this.TLV},"undefined"!=typeof a&&"undefined"!=typeof a.str&&this.addByString(a.str)},YAHOO.lang.extend(KJUR.asn1.x509.RDN,KJUR.asn1.ASN1Object),KJUR.asn1.x509.AttributeTypeAndValue=function(b){KJUR.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this);var a="utf8";this.setByString=function(e){if(!e.match(/^([^=]+)=(.+)$/))throw"malformed attrTypeAndValueStr: "+e;this.setByAttrTypeAndValueStr(RegExp.$1,RegExp.$2)},this.setByAttrTypeAndValueStr=function(g,f){this.typeObj=KJUR.asn1.x509.OID.atype2obj(g);var e=a;"C"==g&&(e="prn"),this.valueObj=this.getValueObj(e,f)},this.getValueObj=function(f,e){if("utf8"==f)return new KJUR.asn1.DERUTF8String({str:e});if("prn"==f)return new KJUR.asn1.DERPrintableString({str:e});if("tel"==f)return new KJUR.asn1.DERTeletexString({str:e});if("ia5"==f)return new KJUR.asn1.DERIA5String({str:e});throw"unsupported directory string type: type="+f+" value="+e},this.getEncodedHex=function(){var e=new KJUR.asn1.DERSequence({array:[this.typeObj,this.valueObj]});return this.TLV=e.getEncodedHex(),this.TLV},"undefined"!=typeof b&&"undefined"!=typeof b.str&&this.setByString(b.str)},YAHOO.lang.extend(KJUR.asn1.x509.AttributeTypeAndValue,KJUR.asn1.ASN1Object),KJUR.asn1.x509.SubjectPublicKeyInfo=function(d){KJUR.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this),this.setRSAKey=function(e){if(!RSAKey.prototype.isPrototypeOf(e))throw"argument is not RSAKey instance";this.rsaKey=e;var g=new KJUR.asn1.DERInteger({bigint:e.n}),f=new KJUR.asn1.DERInteger({int:e.e}),i=new KJUR.asn1.DERSequence({array:[g,f]}),h=i.getEncodedHex();this.asn1AlgId=new KJUR.asn1.x509.AlgorithmIdentifier({name:"rsaEncryption"}),this.asn1SubjPKey=new KJUR.asn1.DERBitString({hex:"00"+h})},this.setRSAPEM=function(g){if(!g.match(/-----BEGIN PUBLIC KEY-----/))throw"key not supported";var n=g;n=n.replace(/^-----[^-]+-----/,""),n=n.replace(/-----[^-]+-----\s*$/,"");var m=n.replace(/\s+/g,""),f=CryptoJS.enc.Base64.parse(m),i=CryptoJS.enc.Hex.stringify(f),k=_rsapem_getHexValueArrayOfChildrenFromHex(i),h=k[1],l=h.substr(2),e=_rsapem_getHexValueArrayOfChildrenFromHex(l),j=new RSAKey;j.setPublic(e[0],e[1]),this.setRSAKey(j)},this.getEncodedHex=function(){if(null==this.asn1AlgId||null==this.asn1SubjPKey)throw"algId and/or subjPubKey not set";var e=new KJUR.asn1.DERSequence({array:[this.asn1AlgId,this.asn1SubjPKey]});return this.hTLV=e.getEncodedHex(),this.hTLV},"undefined"!=typeof d&&("undefined"!=typeof d.rsakey&&this.setRSAKey(d.rsakey),"undefined"!=typeof d.rsapem&&this.setRSAPEM(d.rsapem))},YAHOO.lang.extend(KJUR.asn1.x509.SubjectPublicKeyInfo,KJUR.asn1.ASN1Object),KJUR.asn1.x509.Time=function(c){KJUR.asn1.x509.Time.superclass.constructor.call(this),this.setTimeParams=function(d){this.timeParams=d},this.getEncodedHex=function(){if(null==this.timeParams)throw"timeParams shall be specified. ({'str':'130403235959Z'}}";var d=null;return d="utc"==this.type?new KJUR.asn1.DERUTCTime(this.timeParams):new KJUR.asn1.DERGeneralizedTime(this.timeParams),this.TLV=d.getEncodedHex(),this.TLV},this.type="utc","undefined"!=typeof c&&("undefined"!=typeof c.type&&(this.type=c.type),this.timeParams=c)},YAHOO.lang.extend(KJUR.asn1.x509.Time,KJUR.asn1.ASN1Object),KJUR.asn1.x509.AlgorithmIdentifier=function(d){KJUR.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.getEncodedHex=function(){if(null==this.nameAlg&&null==this.asn1Alg)throw"algorithm not specified";null!=this.nameAlg&&null==this.asn1Alg&&(this.asn1Alg=KJUR.asn1.x509.OID.name2obj(this.nameAlg));var e=new KJUR.asn1.DERSequence({array:[this.asn1Alg,this.asn1Params]});return this.hTLV=e.getEncodedHex(),this.hTLV},"undefined"!=typeof d&&("undefined"!=typeof d.name&&(this.nameAlg=d.name),"undefined"!=typeof d.asn1params&&(this.asn1Params=d.asn1params)),null==this.asn1Params&&(this.asn1Params=new KJUR.asn1.DERNull)},YAHOO.lang.extend(KJUR.asn1.x509.AlgorithmIdentifier,KJUR.asn1.ASN1Object),KJUR.asn1.x509.GeneralName=function(d){KJUR.asn1.x509.GeneralName.superclass.constructor.call(this);var a={rfc822:"81",dns:"82",uri:"86"};this.setByParam=function(g){var e=null;if("undefined"!=typeof g.rfc822&&(this.type="rfc822",e=new KJUR.asn1.DERIA5String({str:g[this.type]})),"undefined"!=typeof g.dns&&(this.type="dns",e=new KJUR.asn1.DERIA5String({str:g[this.type]})),"undefined"!=typeof g.uri&&(this.type="uri",e=new KJUR.asn1.DERIA5String({str:g[this.type]})),null==this.type)throw"unsupported type in params="+g;this.asn1Obj=new KJUR.asn1.DERTaggedObject({explicit:!1,tag:a[this.type],obj:e})},this.getEncodedHex=function(){return this.asn1Obj.getEncodedHex()},"undefined"!=typeof d&&this.setByParam(d)},YAHOO.lang.extend(KJUR.asn1.x509.GeneralName,KJUR.asn1.ASN1Object),KJUR.asn1.x509.GeneralNames=function(b){KJUR.asn1.x509.GeneralNames.superclass.constructor.call(this),this.setByParamArray=function(e){for(var c=0;c<e.length;c++){var d=new KJUR.asn1.x509.GeneralName(e[c]);this.asn1Array.push(d)}},this.getEncodedHex=function(){var c=new KJUR.asn1.DERSequence({array:this.asn1Array});return c.getEncodedHex()},this.asn1Array=new Array,"undefined"!=typeof b&&this.setByParamArray(b)},YAHOO.lang.extend(KJUR.asn1.x509.GeneralNames,KJUR.asn1.ASN1Object),KJUR.asn1.x509.DistributionPointName=function(b){if(KJUR.asn1.x509.DistributionPointName.superclass.constructor.call(this),this.getEncodedHex=function(){if("full"!=this.type)throw"currently type shall be 'full': "+this.type;return this.asn1Obj=new KJUR.asn1.DERTaggedObject({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.getEncodedHex(),this.hTLV},"undefined"!=typeof b){if(!KJUR.asn1.x509.GeneralNames.prototype.isPrototypeOf(b))throw"This class supports GeneralNames only as argument";this.type="full",this.tag="a0",this.asn1V=b}},YAHOO.lang.extend(KJUR.asn1.x509.DistributionPointName,KJUR.asn1.ASN1Object),KJUR.asn1.x509.DistributionPoint=function(b){KJUR.asn1.x509.DistributionPoint.superclass.constructor.call(this),this.getEncodedHex=function(){var c=new KJUR.asn1.DERSequence;if(null!=this.asn1DP){var d=new KJUR.asn1.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});c.appendASN1Object(d)}return this.hTLV=c.getEncodedHex(),this.hTLV},"undefined"!=typeof b&&"undefined"!=typeof b.dpobj&&(this.asn1DP=b.dpobj)},YAHOO.lang.extend(KJUR.asn1.x509.DistributionPoint,KJUR.asn1.ASN1Object),KJUR.asn1.x509.OID=new function(a){this.atype2oidList={C:"2.5.4.6",O:"2.5.4.10",OU:"2.5.4.11",ST:"2.5.4.8",L:"2.5.4.7",CN:"2.5.4.3"},this.name2oidList={sha384:"2.16.840.1.101.3.4.2.2",sha224:"2.16.840.1.101.3.4.2.4",SHA1withRSA:"1.2.840.113549.1.1.5",rsaEncryption:"1.2.840.113549.1.1.1",subjectKeyIdentifier:"2.5.29.14",countryName:"2.5.4.6",organization:"2.5.4.10",organizationalUnit:"2.5.4.11",stateOrProvinceName:"2.5.4.8",locality:"2.5.4.7",commonName:"2.5.4.3",keyUsage:"2.5.29.15",basicConstraints:"2.5.29.19",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",authorityKeyIdentifier:"2.5.29.35",extKeyUsage:"2.5.29.37",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9"},this.objCache={},this.name2obj=function(b){if("undefined"!=typeof this.objCache[b])return this.objCache[b];if("undefined"==typeof this.name2oidList[b])throw"Name of ObjectIdentifier not defined: "+b;var c=this.name2oidList[b],d=new KJUR.asn1.DERObjectIdentifier({oid:c});return this.objCache[b]=d,d},this.atype2obj=function(b){if("undefined"!=typeof this.objCache[b])return this.objCache[b];if("undefined"==typeof this.atype2oidList[b])throw"AttributeType name undefined: "+b;var c=this.atype2oidList[b],d=new KJUR.asn1.DERObjectIdentifier({oid:c});return this.objCache[b]=d,d}},KJUR.asn1.x509.X509Util=new function(){this.getPKCS8PubKeyPEMfromRSAKey=function(i){var h=null,f=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(i.n),j=KJUR.asn1.ASN1Util.integerToByteHex(i.e),a=new KJUR.asn1.DERInteger({hex:f}),g=new KJUR.asn1.DERInteger({hex:j}),l=new KJUR.asn1.DERSequence({array:[a,g]}),c=l.getEncodedHex(),d=new KJUR.asn1.x509.AlgorithmIdentifier({name:"rsaEncryption"}),b=new KJUR.asn1.DERBitString({hex:"00"+c}),k=new KJUR.asn1.DERSequence({array:[d,b]}),e=k.getEncodedHex(),h=KJUR.asn1.ASN1Util.getPEMStringFromHex(e,"PUBLIC KEY");return h}};var utf8tob64u,b64utoutf8;"function"==typeof Buffer?(utf8tob64u=function(a){return b64tob64u(new Buffer(a,"utf8").toString("base64"))},b64utoutf8=function(a){return new Buffer(b64utob64(a),"base64").toString("utf8")}):(utf8tob64u=function(a){return hextob64u(uricmptohex(encodeURIComponentAll(a)))},b64utoutf8=function(a){return decodeURIComponent(hextouricmp(b64utohex(a)))}),"undefined"!=typeof KJUR&&KJUR||(KJUR={}),"undefined"!=typeof KJUR.crypto&&KJUR.crypto||(KJUR.crypto={}),KJUR.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:"CryptoJS.algo.MD5",sha1:"CryptoJS.algo.SHA1",sha224:"CryptoJS.algo.SHA224",sha256:"CryptoJS.algo.SHA256",sha384:"CryptoJS.algo.SHA384",sha512:"CryptoJS.algo.SHA512",ripemd160:"CryptoJS.algo.RIPEMD160"},this.getDigestInfoHex=function(a,b){if("undefined"==typeof this.DIGESTINFOHEAD[b])throw"alg not supported in Util.DIGESTINFOHEAD: "+b;return this.DIGESTINFOHEAD[b]+a},this.getPaddedDigestInfoHex=function(h,a,j){var c=this.getDigestInfoHex(h,a),d=j/4;if(c.length+22>d)throw"key is too short for SigAlg: keylen="+j+","+a;for(var b="0001",k="00"+c,g="",l=d-b.length-k.length,f=0;f<l;f+=2)g+="ff";var e=b+g+k;return e},this.hashString=function(a,c){var b=new KJUR.crypto.MessageDigest({alg:c});return b.digestString(a)},this.hashHex=function(b,c){var a=new KJUR.crypto.MessageDigest({alg:c});return a.digestHex(b)},this.sha1=function(a){var b=new KJUR.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"});return b.digestString(a)},this.sha256=function(a){var b=new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"});return b.digestString(a)},this.sha256Hex=function(a){var b=new KJUR.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"});return b.digestHex(a)},this.sha512=function(a){var b=new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"});return b.digestString(a)},this.sha512Hex=function(a){var b=new KJUR.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"});return b.digestHex(a)},this.md5=function(a){var b=new KJUR.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return b.digestString(a)},this.ripemd160=function(a){var b=new KJUR.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return b.digestString(a)},this.getCryptoJSMDByName=function(a){}},KJUR.crypto.MessageDigest=function(params){var md=null,algName=null,provName=null;this.setAlgAndProvider=function(alg,prov){if(null!=alg&&void 0===prov&&(prov=KJUR.crypto.Util.DEFAULTPROVIDER[alg]),":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(alg)!=-1&&"cryptojs"==prov){try{this.md=eval(KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[alg]).create()}catch(ex){throw"setAlgAndProvider hash alg set fail alg="+alg+"/"+ex}this.updateString=function(str){this.md.update(str)},this.updateHex=function(hex){var wHex=CryptoJS.enc.Hex.parse(hex);this.md.update(wHex)},this.digest=function(){var hash=this.md.finalize();return hash.toString(CryptoJS.enc.Hex)},this.digestString=function(str){return this.updateString(str),this.digest()},this.digestHex=function(hex){return this.updateHex(hex),this.digest()}}if(":sha256:".indexOf(alg)!=-1&&"sjcl"==prov){try{this.md=new sjcl.hash.sha256}catch(ex){throw"setAlgAndProvider hash alg set fail alg="+alg+"/"+ex}this.updateString=function(str){this.md.update(str)},this.updateHex=function(hex){var baHex=sjcl.codec.hex.toBits(hex);this.md.update(baHex)},this.digest=function(){var hash=this.md.finalize();return sjcl.codec.hex.fromBits(hash)},this.digestString=function(str){return this.updateString(str),this.digest()},this.digestHex=function(hex){return this.updateHex(hex),this.digest()}}},this.updateString=function(str){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(hex){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(str){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(hex){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==params&&void 0!==params.alg&&(this.algName=params.alg,void 0===params.prov&&(this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},KJUR.crypto.Mac=function(params){var mac=null,pass=null,algName=null,provName=null,algProv=null;this.setAlgAndProvider=function(alg,prov){if(null==alg&&(alg="hmacsha1"),alg=alg.toLowerCase(),"hmac"!=alg.substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+alg;void 0===prov&&(prov=KJUR.crypto.Util.DEFAULTPROVIDER[alg]),this.algProv=alg+"/"+prov;var hashAlg=alg.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(hashAlg)!=-1&&"cryptojs"==prov){try{var mdObj=eval(KJUR.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[hashAlg]);this.mac=CryptoJS.algo.HMAC.create(mdObj,this.pass)}catch(ex){throw"setAlgAndProvider hash alg set fail hashAlg="+hashAlg+"/"+ex}this.updateString=function(str){this.mac.update(str)},this.updateHex=function(hex){var wHex=CryptoJS.enc.Hex.parse(hex);this.mac.update(wHex)},this.doFinal=function(){var hash=this.mac.finalize();return hash.toString(CryptoJS.enc.Hex)},this.doFinalString=function(str){return this.updateString(str),this.doFinal()},this.doFinalHex=function(hex){return this.updateHex(hex),this.doFinal()}}},this.updateString=function(str){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(hex){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(str){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(hex){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},void 0!==params&&(void 0!==params.pass&&(this.pass=params.pass),void 0!==params.alg&&(this.algName=params.alg,void 0===params.prov&&(this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},KJUR.crypto.Signature=function(o){var q=null;if(this._setAlgNames=function(){this.algName.match(/^(.+)with(.+)$/)&&(this.mdAlgName=RegExp.$1.toLowerCase(),this.pubkeyAlgName=RegExp.$2.toLowerCase())},this._zeroPaddingOfSignature=function(x,w){for(var v="",t=w/4-x.length,u=0;u<t;u++)v+="0";return v+x},this.setAlgAndProvider=function(u,t){if(this._setAlgNames(),"cryptojs/jsrsa"!=t)throw"provider not supported: "+t;if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new KJUR.crypto.MessageDigest({alg:this.mdAlgName})}catch(s){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+s}this.init=function(v,w){if("string"==typeof v)if(v.indexOf("-END ENCRYPTED PRIVATE KEY-",0)!=-1&&void 0!==w)this.prvKey=PKCS5PKEY.getKeyFromEncryptedPKCS8PEM(v,w),this.state="SIGN";else if(v.indexOf("-END RSA PRIVATE KEY-",0)!=-1&&v.indexOf(",ENCRYPTED",0)!=-1&&void 0!==w)this.prvKey=PKCS5PKEY.getRSAKeyFromEncryptedPKCS5PEM(v,w),this.state="SIGN";else if(v.indexOf("-END RSA PRIVATE KEY-",0)!=-1&&v.indexOf(",ENCRYPTED",0)==-1&&void 0===w)this.prvKey=new RSAKey,this.prvKey.readPrivateKeyFromPEMString(v),this.state="SIGN";else if(v.indexOf("-END PRIVATE KEY-",0)!=-1&&void 0===w)this.prvKey=PKCS5PKEY.getKeyFromPlainPrivatePKCS8PEM(v),this.state="SIGN";else if(v.indexOf("-END PUBLIC KEY-",0)!=-1&&void 0===w)this.pubKey=PKCS5PKEY.getKeyFromPublicPKCS8PEM(v),this.state="VERIFY";else{if(v.indexOf("-END CERTIFICATE-",0)==-1&&v.indexOf("-END X509 CERTIFICATE-",0)==-1&&v.indexOf("-END TRUSTED CERTIFICATE-",0)==-1||void 0!==w)throw"unsupported arguments";this.pubKey=X509.getPublicKeyFromCertPEM(v),this.state="VERIFY"}else if(v instanceof RSAKey)if(null!=v.d)this.prvKey=v,this.state="SIGN";else{if(null==v.n)throw"RSAKey object is not private and public key";this.pubKey=v,this.state="VERIFY";
}else if(v instanceof KJUR.crypto.ECDSA)if(null!=v.prvKeyHex)this.prvKey=v,this.state="SIGN";else{if(null==v.pubKeyHex)throw"ECDSA object is not private and public key";this.pubKey=v,this.state="VERIFY"}},this.initSign=function(v){"string"==typeof v.ecprvhex&&"string"==typeof v.eccurvename?(this.ecprvhex=v.ecprvhex,this.eccurvename=v.eccurvename):this.prvKey=v,this.state="SIGN"},this.initVerifyByPublicKey=function(v){"string"==typeof v.ecpubhex&&"string"==typeof v.eccurvename?(this.ecpubhex=v.ecpubhex,this.eccurvename=v.eccurvename):v instanceof KJUR.crypto.ECDSA?this.pubKey=v:v instanceof RSAKey&&(this.pubKey=v),this.state="VERIFY"},this.initVerifyByCertificatePEM=function(v){var w=new X509;w.readCertPEM(v),this.pubKey=w.subjectPublicKeyRSA,this.state="VERIFY"},this.updateString=function(v){this.md.updateString(v)},this.updateHex=function(v){this.md.updateHex(v)},this.sign=function(){if(this.sHashHex=this.md.digest(),"undefined"!=typeof this.ecprvhex&&"undefined"!=typeof this.eccurvename){var v=new KJUR.crypto.ECDSA({curve:this.eccurvename});this.hSign=v.signHex(this.sHashHex,this.ecprvhex)}else if("rsaandmgf1"==this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if("rsa"==this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else{if(!(this.prvKey instanceof KJUR.crypto.ECDSA))throw"Signature: unsupported public key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(v){this.updateString(v),this.sign()},this.signHex=function(v){this.updateHex(v),this.sign()},this.verify=function(v){if(this.sHashHex=this.md.digest(),"undefined"!=typeof this.ecpubhex&&"undefined"!=typeof this.eccurvename){var w=new KJUR.crypto.ECDSA({curve:this.eccurvename});return w.verifyHex(this.sHashHex,v,this.ecpubhex)}if("rsaandmgf1"==this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,v,this.mdAlgName,this.pssSaltLen);if("rsa"==this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,v);if(this.pubKey instanceof KJUR.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,v);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(s,t){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.initVerifyByPublicKey=function(s){throw"initVerifyByPublicKey(rsaPubKeyy) not supported for this alg:prov="+this.algProvName},this.initVerifyByCertificatePEM=function(s){throw"initVerifyByCertificatePEM(certPEM) not supported for this alg:prov="+this.algProvName},this.initSign=function(s){throw"initSign(prvKey) not supported for this alg:prov="+this.algProvName},this.updateString=function(s){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(s){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(s){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(s){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(s){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=o,void 0!==o&&(void 0!==o.alg&&(this.algName=o.alg,void 0===o.prov?this.provName=KJUR.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=o.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==o.psssaltlen&&(this.pssSaltLen=o.psssaltlen),void 0!==o.prvkeypem)){if(void 0!==o.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{var q=new RSAKey;q.readPrivateKeyFromPEMString(o.prvkeypem),this.initSign(q)}catch(m){throw"fatal error to load pem private key: "+m}}},KJUR.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1"}},"undefined"!=typeof KJUR&&KJUR||(KJUR={}),"undefined"!=typeof KJUR.crypto&&KJUR.crypto||(KJUR.crypto={}),KJUR.crypto.ECDSA=function(h){var e="secp256r1",a=new SecureRandom;this.type="EC",this.getBigRandom=function(i){return new BigInteger(i.bitLength(),a).mod(i.subtract(BigInteger.ONE)).add(BigInteger.ONE)},this.setNamedCurve=function(i){this.ecparams=KJUR.crypto.ECParameterDB.getByName(i),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=i},this.setPrivateKeyHex=function(i){this.prvKeyHex=i},this.setPublicKeyHex=function(i){this.pubKeyHex=i},this.generateKeyPairHex=function(){var k=this.ecparams.n,n=this.getBigRandom(k),l=this.ecparams.G.multiply(n),q=l.getX().toBigInteger(),o=l.getY().toBigInteger(),i=this.ecparams.keylen/4,m=("0000000000"+n.toString(16)).slice(-i),r=("0000000000"+q.toString(16)).slice(-i),p=("0000000000"+o.toString(16)).slice(-i),j="04"+r+p;return this.prvKeyHex=m,this.pubKeyHex=j,{ecprvhex:m,ecpubhex:j}},this.signWithMessageHash=function(i){return this.signHex(i,this.prvKeyHex)},this.signHex=function(o,j){var t=new BigInteger(j,16),l=this.ecparams.n,q=new BigInteger(o,16);do var m=this.getBigRandom(l),u=this.ecparams.G,p=u.multiply(m),i=p.getX().toBigInteger().mod(l);while(i.compareTo(BigInteger.ZERO)<=0);var v=m.modInverse(l).multiply(q.add(t.multiply(i))).mod(l);return KJUR.crypto.ECDSA.biRSSigToASN1Sig(i,v)},this.sign=function(m,u){var q=u,j=this.ecparams.n,p=BigInteger.fromByteArrayUnsigned(m);do var l=this.getBigRandom(j),t=this.ecparams.G,o=t.multiply(l),i=o.getX().toBigInteger().mod(j);while(i.compareTo(BigInteger.ZERO)<=0);var v=l.modInverse(j).multiply(p.add(q.multiply(i))).mod(j);return this.serializeSig(i,v)},this.verifyWithMessageHash=function(j,i){return this.verifyHex(j,i,this.pubKeyHex)},this.verifyHex=function(m,i,p){var l,j,o=KJUR.crypto.ECDSA.parseSigHex(i);l=o.r,j=o.s;var k;k=ECPointFp.decodeFromHex(this.ecparams.curve,p);var n=new BigInteger(m,16);return this.verifyRaw(n,l,j,k)},this.verify=function(o,p,j){var l,i;if(Bitcoin.Util.isArray(p)){var n=this.parseSig(p);l=n.r,i=n.s}else{if("object"!=typeof p||!p.r||!p.s)throw"Invalid value for signature";l=p.r,i=p.s}var k;if(j instanceof ECPointFp)k=j;else{if(!Bitcoin.Util.isArray(j))throw"Invalid format for pubkey value, must be byte array or ECPointFp";k=ECPointFp.decodeFrom(this.ecparams.curve,j)}var m=BigInteger.fromByteArrayUnsigned(o);return this.verifyRaw(m,l,i,k)},this.verifyRaw=function(o,i,w,m){var l=this.ecparams.n,u=this.ecparams.G;if(i.compareTo(BigInteger.ONE)<0||i.compareTo(l)>=0)return!1;if(w.compareTo(BigInteger.ONE)<0||w.compareTo(l)>=0)return!1;var p=w.modInverse(l),k=o.multiply(p).mod(l),j=i.multiply(p).mod(l),q=u.multiply(k).add(m.multiply(j)),t=q.getX().toBigInteger().mod(l);return t.equals(i)},this.serializeSig=function(k,j){var l=k.toByteArraySigned(),i=j.toByteArraySigned(),m=[];return m.push(2),m.push(l.length),m=m.concat(l),m.push(2),m.push(i.length),m=m.concat(i),m.unshift(m.length),m.unshift(48),m},this.parseSig=function(n){var m;if(48!=n[0])throw new Error("Signature not a valid DERSequence");if(m=2,2!=n[m])throw new Error("First element in signature must be a DERInteger");var l=n.slice(m+2,m+2+n[m+1]);if(m+=2+n[m+1],2!=n[m])throw new Error("Second element in signature must be a DERInteger");var i=n.slice(m+2,m+2+n[m+1]);m+=2+n[m+1];var k=BigInteger.fromByteArrayUnsigned(l),j=BigInteger.fromByteArrayUnsigned(i);return{r:k,s:j}},this.parseSigCompact=function(m){if(65!==m.length)throw"Signature has the wrong length";var j=m[0]-27;if(j<0||j>7)throw"Invalid signature type";var o=this.ecparams.n,l=BigInteger.fromByteArrayUnsigned(m.slice(1,33)).mod(o),k=BigInteger.fromByteArrayUnsigned(m.slice(33,65)).mod(o);return{r:l,s:k,i:j}},void 0!==h&&void 0!==h.curve&&(this.curveName=h.curve),void 0===this.curveName&&(this.curveName=e),this.setNamedCurve(this.curveName),void 0!==h&&(void 0!==h.prv&&(this.prvKeyHex=h.prv),void 0!==h.pub&&(this.pubKeyHex=h.pub))},KJUR.crypto.ECDSA.parseSigHex=function(a){var b=KJUR.crypto.ECDSA.parseSigHexInHexRS(a),d=new BigInteger(b.r,16),c=new BigInteger(b.s,16);return{r:d,s:c}},KJUR.crypto.ECDSA.parseSigHexInHexRS=function(c){if("30"!=c.substr(0,2))throw"signature is not a ASN.1 sequence";var b=ASN1HEX.getPosArrayOfChildren_AtObj(c,0);if(2!=b.length)throw"number of signature ASN.1 sequence elements seem wrong";var g=b[0],f=b[1];if("02"!=c.substr(g,2))throw"1st item of sequene of signature is not ASN.1 integer";if("02"!=c.substr(f,2))throw"2nd item of sequene of signature is not ASN.1 integer";var e=ASN1HEX.getHexOfV_AtObj(c,g),d=ASN1HEX.getHexOfV_AtObj(c,f);return{r:e,s:d}},KJUR.crypto.ECDSA.asn1SigToConcatSig=function(c){var d=KJUR.crypto.ECDSA.parseSigHexInHexRS(c),b=d.r,a=d.s;if("00"==b.substr(0,2)&&b.length/2*8%128==8&&(b=b.substr(2)),"00"==a.substr(0,2)&&a.length/2*8%128==8&&(a=a.substr(2)),b.length/2*8%128!=0)throw"unknown ECDSA sig r length error";if(a.length/2*8%128!=0)throw"unknown ECDSA sig s length error";return b+a},KJUR.crypto.ECDSA.concatSigToASN1Sig=function(a){if(a.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var c=a.substr(0,a.length/2),b=a.substr(a.length/2);return KJUR.crypto.ECDSA.hexRSSigToASN1Sig(c,b)},KJUR.crypto.ECDSA.hexRSSigToASN1Sig=function(b,a){var d=new BigInteger(b,16),c=new BigInteger(a,16);return KJUR.crypto.ECDSA.biRSSigToASN1Sig(d,c)},KJUR.crypto.ECDSA.biRSSigToASN1Sig=function(e,c){var b=new KJUR.asn1.DERInteger({bigint:e}),a=new KJUR.asn1.DERInteger({bigint:c}),d=new KJUR.asn1.DERSequence({array:[b,a]});return d.getEncodedHex()},"undefined"!=typeof KJUR&&KJUR||(KJUR={}),"undefined"!=typeof KJUR.crypto&&KJUR.crypto||(KJUR.crypto={}),KJUR.crypto.ECParameterDB=new function(){function a(d){return new BigInteger(d,16)}var b={},c={};this.getByName=function(e){var d=e;if("undefined"!=typeof c[d]&&(d=c[e]),"undefined"!=typeof b[d])return b[d];throw"unregistered EC curve name: "+d},this.regist=function(A,l,o,g,m,e,j,f,k,u,d,x){b[A]={};var s=a(o),z=a(g),y=a(m),t=a(e),w=a(j),r=new ECCurveFp(s,z,y),q=r.decodePointHex("04"+f+k);b[A].name=A,b[A].keylen=l,b[A].curve=r,b[A].G=q,b[A].n=t,b[A].h=w,b[A].oid=d,b[A].info=x;for(var v=0;v<u.length;v++)c[u[v]]=A}},KJUR.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),KJUR.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),KJUR.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),KJUR.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),KJUR.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),KJUR.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),KJUR.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),KJUR.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),KJUR.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),KJUR.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);var PKCS5PKEY=function(){var c=function(n,p,o){return i(CryptoJS.AES,n,p,o)},d=function(n,p,o){return i(CryptoJS.TripleDES,n,p,o)},i=function(q,v,s,o){var p=CryptoJS.enc.Hex.parse(v),u=CryptoJS.enc.Hex.parse(s),n=CryptoJS.enc.Hex.parse(o),r={};r.key=u,r.iv=n,r.ciphertext=p;var t=q.decrypt(r,u,{iv:n});return CryptoJS.enc.Hex.stringify(t)},j=function(n,p,o){return e(CryptoJS.AES,n,p,o)},m=function(n,p,o){return e(CryptoJS.TripleDES,n,p,o)},e=function(s,x,v,p){var r=CryptoJS.enc.Hex.parse(x),w=CryptoJS.enc.Hex.parse(v),o=CryptoJS.enc.Hex.parse(p),u=s.encrypt(r,w,{iv:o}),q=CryptoJS.enc.Hex.parse(u.toString()),t=CryptoJS.enc.Base64.stringify(q);return t},g={"AES-256-CBC":{proc:c,eproc:j,keylen:32,ivlen:16},"AES-192-CBC":{proc:c,eproc:j,keylen:24,ivlen:16},"AES-128-CBC":{proc:c,eproc:j,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:d,eproc:m,keylen:24,ivlen:8}},b=function(n){return g[n].proc},k=function(n){var p=CryptoJS.lib.WordArray.random(n),o=CryptoJS.enc.Hex.stringify(p);return o},l=function(q){var r={};q.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"))&&(r.cipher=RegExp.$1,r.ivsalt=RegExp.$2),q.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"))&&(r.type=RegExp.$1);var p=-1,t=0;q.indexOf("\r\n\r\n")!=-1&&(p=q.indexOf("\r\n\r\n"),t=2),q.indexOf("\n\n")!=-1&&(p=q.indexOf("\n\n"),t=1);var o=q.indexOf("-----END");if(p!=-1&&o!=-1){var n=q.substring(p+2*t,o-t);n=n.replace(/\s+/g,""),r.data=n}return r},h=function(o,w,n){for(var t=n.substring(0,16),r=CryptoJS.enc.Hex.parse(t),p=CryptoJS.enc.Utf8.parse(w),s=g[o].keylen+g[o].ivlen,v="",u=null;;){var q=CryptoJS.algo.MD5.create();if(null!=u&&q.update(u),q.update(p),q.update(r),u=q.finalize(),v+=CryptoJS.enc.Hex.stringify(u),v.length>=2*s)break}var x={};return x.keyhex=v.substr(0,2*g[o].keylen),x.ivhex=v.substr(2*g[o].keylen,2*g[o].ivlen),x},a=function(n,t,p,u){var q=CryptoJS.enc.Base64.parse(n),o=CryptoJS.enc.Hex.stringify(q),s=g[t].proc,r=s(o,p,u);return r},f=function(n,q,o,s){var p=g[q].eproc,r=p(n,o,s);return r};return{version:"1.0.5",getHexFromPEM:function(o,r){var p=o;if(p.indexOf("BEGIN "+r)==-1)throw"can't find PEM header: "+r;p=p.replace("-----BEGIN "+r+"-----",""),p=p.replace("-----END "+r+"-----","");var q=p.replace(/\s+/g,""),n=b64tohex(q);return n},getDecryptedKeyHexByKeyIV:function(o,r,q,p){var n=b(r);return n(o,q,p)},parsePKCS5PEM:function(n){return l(n)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(o,n,p){return h(o,n,p)},decryptKeyB64:function(n,p,o,q){return a(n,p,o,q)},getDecryptedKeyHex:function(w,v){var o=l(w),p=(o.type,o.cipher),n=o.ivsalt,q=o.data,u=h(p,v,n),t=u.keyhex,s=a(q,p,t,n);return s},getRSAKeyFromEncryptedPKCS5PEM:function(p,o){var q=this.getDecryptedKeyHex(p,o),n=new RSAKey;return n.readPrivateKeyFromASN1HexString(q),n},getEryptedPKCS5PEMFromPrvKeyHex:function(q,x,r,p){var n="";if("undefined"!=typeof r&&null!=r||(r="AES-256-CBC"),"undefined"==typeof g[r])throw"PKCS5PKEY unsupported algorithm: "+r;if("undefined"==typeof p||null==p){var t=g[r].ivlen,s=k(t);p=s.toUpperCase()}var w=h(r,x,p),v=w.keyhex,u=f(q,r,v,p),o=u.replace(/(.{64})/g,"$1\r\n"),n="-----BEGIN RSA PRIVATE KEY-----\r\n";return n+="Proc-Type: 4,ENCRYPTED\r\n",n+="DEK-Info: "+r+","+p+"\r\n",n+="\r\n",n+=o,n+="\r\n-----END RSA PRIVATE KEY-----\r\n"},getEryptedPKCS5PEMFromRSAKey:function(C,D,o,s){var A=new KJUR.asn1.DERInteger({int:0}),v=new KJUR.asn1.DERInteger({bigint:C.n}),z=new KJUR.asn1.DERInteger({int:C.e}),B=new KJUR.asn1.DERInteger({bigint:C.d}),t=new KJUR.asn1.DERInteger({bigint:C.p}),r=new KJUR.asn1.DERInteger({bigint:C.q}),y=new KJUR.asn1.DERInteger({bigint:C.dmp1}),u=new KJUR.asn1.DERInteger({bigint:C.dmq1}),x=new KJUR.asn1.DERInteger({bigint:C.coeff}),E=new KJUR.asn1.DERSequence({array:[A,v,z,B,t,r,y,u,x]}),w=E.getEncodedHex();return this.getEryptedPKCS5PEMFromPrvKeyHex(w,D,o,s)},newEncryptedPKCS5PEM:function(n,o,r,s){"undefined"!=typeof o&&null!=o||(o=1024),"undefined"!=typeof r&&null!=r||(r="10001");var p=new RSAKey;p.generate(o,r);var q=null;return q="undefined"==typeof s||null==s?this.getEncryptedPKCS5PEMFromRSAKey(pkey,n):this.getEncryptedPKCS5PEMFromRSAKey(pkey,n,s)},getRSAKeyFromPlainPKCS8PEM:function(p){if(p.match(/ENCRYPTED/))throw"pem shall be not ENCRYPTED";var o=this.getHexFromPEM(p,"PRIVATE KEY"),n=this.getRSAKeyFromPlainPKCS8Hex(o);return n},getRSAKeyFromPlainPKCS8Hex:function(q){var p=ASN1HEX.getPosArrayOfChildren_AtObj(q,0);if(3!=p.length)throw"outer DERSequence shall have 3 elements: "+p.length;var o=ASN1HEX.getHexOfTLV_AtObj(q,p[1]);if("300d06092a864886f70d0101010500"!=o)throw"PKCS8 AlgorithmIdentifier is not rsaEnc: "+o;var o=ASN1HEX.getHexOfTLV_AtObj(q,p[1]),r=ASN1HEX.getHexOfTLV_AtObj(q,p[2]),s=ASN1HEX.getHexOfV_AtObj(r,0),n=new RSAKey;return n.readPrivateKeyFromASN1HexString(s),n},parseHexOfEncryptedPKCS8:function(u){var q={},p=ASN1HEX.getPosArrayOfChildren_AtObj(u,0);if(2!=p.length)throw"malformed format: SEQUENCE(0).items != 2: "+p.length;q.ciphertext=ASN1HEX.getHexOfV_AtObj(u,p[1]);var w=ASN1HEX.getPosArrayOfChildren_AtObj(u,p[0]);if(2!=w.length)throw"malformed format: SEQUENCE(0.0).items != 2: "+w.length;if("2a864886f70d01050d"!=ASN1HEX.getHexOfV_AtObj(u,w[0]))throw"this only supports pkcs5PBES2";var n=ASN1HEX.getPosArrayOfChildren_AtObj(u,w[1]);if(2!=w.length)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+n.length;var o=ASN1HEX.getPosArrayOfChildren_AtObj(u,n[1]);if(2!=o.length)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+o.length;if("2a864886f70d0307"!=ASN1HEX.getHexOfV_AtObj(u,o[0]))throw"this only supports TripleDES";q.encryptionSchemeAlg="TripleDES",q.encryptionSchemeIV=ASN1HEX.getHexOfV_AtObj(u,o[1]);var r=ASN1HEX.getPosArrayOfChildren_AtObj(u,n[0]);if(2!=r.length)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+r.length;if("2a864886f70d01050c"!=ASN1HEX.getHexOfV_AtObj(u,r[0]))throw"this only supports pkcs5PBKDF2";var v=ASN1HEX.getPosArrayOfChildren_AtObj(u,r[1]);if(v.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+v.length;q.pbkdf2Salt=ASN1HEX.getHexOfV_AtObj(u,v[0]);var s=ASN1HEX.getHexOfV_AtObj(u,v[1]);try{q.pbkdf2Iter=parseInt(s,16)}catch(t){throw"malformed format pbkdf2Iter: "+s}return q},getPBKDF2KeyHexFromParam:function(s,n){var r=CryptoJS.enc.Hex.parse(s.pbkdf2Salt),o=s.pbkdf2Iter,q=CryptoJS.PBKDF2(n,r,{keySize:6,iterations:o}),p=CryptoJS.enc.Hex.stringify(q);return p},getPlainPKCS8HexFromEncryptedPKCS8PEM:function(v,w){var p=this.getHexFromPEM(v,"ENCRYPTED PRIVATE KEY"),n=this.parseHexOfEncryptedPKCS8(p),s=PKCS5PKEY.getPBKDF2KeyHexFromParam(n,w),t={};t.ciphertext=CryptoJS.enc.Hex.parse(n.ciphertext);var r=CryptoJS.enc.Hex.parse(s),q=CryptoJS.enc.Hex.parse(n.encryptionSchemeIV),u=CryptoJS.TripleDES.decrypt(t,r,{iv:q}),o=CryptoJS.enc.Hex.stringify(u);return o},getRSAKeyFromEncryptedPKCS8PEM:function(q,p){var o=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(q,p),n=this.getRSAKeyFromPlainPKCS8Hex(o);return n},getKeyFromEncryptedPKCS8PEM:function(q,o){var n=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(q,o),p=this.getKeyFromPlainPrivatePKCS8Hex(n);return p},parsePlainPrivatePKCS8Hex:function(q){var o={};if(o.algparam=null,"30"!=q.substr(0,2))throw"malformed plain PKCS8 private key(code:001)";var p=ASN1HEX.getPosArrayOfChildren_AtObj(q,0);if(3!=p.length)throw"malformed plain PKCS8 private key(code:002)";if("30"!=q.substr(p[1],2))throw"malformed PKCS8 private key(code:003)";var n=ASN1HEX.getPosArrayOfChildren_AtObj(q,p[1]);if(2!=n.length)throw"malformed PKCS8 private key(code:004)";if("06"!=q.substr(n[0],2))throw"malformed PKCS8 private key(code:005)";if(o.algoid=ASN1HEX.getHexOfV_AtObj(q,n[0]),"06"==q.substr(n[1],2)&&(o.algparam=ASN1HEX.getHexOfV_AtObj(q,n[1])),"04"!=q.substr(p[2],2))throw"malformed PKCS8 private key(code:006)";return o.keyidx=ASN1HEX.getStartPosOfV_AtObj(q,p[2]),o},getKeyFromPlainPrivatePKCS8PEM:function(o){var n=this.getHexFromPEM(o,"PRIVATE KEY"),p=this.getKeyFromPlainPrivatePKCS8Hex(n);return p},getKeyFromPlainPrivatePKCS8Hex:function(n){var p=this.parsePlainPrivatePKCS8Hex(n);if("2a864886f70d010101"==p.algoid){this.parsePrivateRawRSAKeyHexAtObj(n,p);var o=p.key,q=new RSAKey;return q.setPrivateEx(o.n,o.e,o.d,o.p,o.q,o.dp,o.dq,o.co),q}if("2a8648ce3d0201"==p.algoid){if(this.parsePrivateRawECKeyHexAtObj(n,p),void 0===KJUR.crypto.OID.oidhex2name[p.algparam])throw"KJUR.crypto.OID.oidhex2name undefined: "+p.algparam;var r=KJUR.crypto.OID.oidhex2name[p.algparam],q=new KJUR.crypto.ECDSA({curve:r,prv:p.key});return q}throw"unsupported private key algorithm"},getRSAKeyFromPublicPKCS8PEM:function(o){var p=this.getHexFromPEM(o,"PUBLIC KEY"),n=this.getRSAKeyFromPublicPKCS8Hex(p);return n},getKeyFromPublicPKCS8PEM:function(o){var p=this.getHexFromPEM(o,"PUBLIC KEY"),n=this.getKeyFromPublicPKCS8Hex(p);return n},getKeyFromPublicPKCS8Hex:function(o){var n=this.parsePublicPKCS8Hex(o);if("2a864886f70d010101"==n.algoid){var r=this.parsePublicRawRSAKeyHex(n.key),p=new RSAKey;return p.setPublic(r.n,r.e),p}if("2a8648ce3d0201"==n.algoid){if(void 0===KJUR.crypto.OID.oidhex2name[n.algparam])throw"KJUR.crypto.OID.oidhex2name undefined: "+n.algparam;var q=KJUR.crypto.OID.oidhex2name[n.algparam],p=new KJUR.crypto.ECDSA({curve:q,pub:n.key});return p}throw"unsupported public key algorithm"},parsePublicRawRSAKeyHex:function(p){var n={};if("30"!=p.substr(0,2))throw"malformed RSA key(code:001)";var o=ASN1HEX.getPosArrayOfChildren_AtObj(p,0);if(2!=o.length)throw"malformed RSA key(code:002)";if("02"!=p.substr(o[0],2))throw"malformed RSA key(code:003)";if(n.n=ASN1HEX.getHexOfV_AtObj(p,o[0]),"02"!=p.substr(o[1],2))throw"malformed RSA key(code:004)";return n.e=ASN1HEX.getHexOfV_AtObj(p,o[1]),n},parsePrivateRawRSAKeyHexAtObj:function(o,q){var p=q.keyidx;if("30"!=o.substr(p,2))throw"malformed RSA private key(code:001)";var n=ASN1HEX.getPosArrayOfChildren_AtObj(o,p);if(9!=n.length)throw"malformed RSA private key(code:002)";q.key={},q.key.n=ASN1HEX.getHexOfV_AtObj(o,n[1]),q.key.e=ASN1HEX.getHexOfV_AtObj(o,n[2]),q.key.d=ASN1HEX.getHexOfV_AtObj(o,n[3]),q.key.p=ASN1HEX.getHexOfV_AtObj(o,n[4]),q.key.q=ASN1HEX.getHexOfV_AtObj(o,n[5]),q.key.dp=ASN1HEX.getHexOfV_AtObj(o,n[6]),q.key.dq=ASN1HEX.getHexOfV_AtObj(o,n[7]),q.key.co=ASN1HEX.getHexOfV_AtObj(o,n[8])},parsePrivateRawECKeyHexAtObj:function(o,q){var p=q.keyidx;if("30"!=o.substr(p,2))throw"malformed ECC private key(code:001)";var n=ASN1HEX.getPosArrayOfChildren_AtObj(o,p);if(3!=n.length)throw"malformed ECC private key(code:002)";if("04"!=o.substr(n[1],2))throw"malformed ECC private key(code:003)";q.key=ASN1HEX.getHexOfV_AtObj(o,n[1])},parsePublicPKCS8Hex:function(q){var o={};o.algparam=null;var p=ASN1HEX.getPosArrayOfChildren_AtObj(q,0);if(2!=p.length)throw"outer DERSequence shall have 2 elements: "+p.length;var r=p[0];if("30"!=q.substr(r,2))throw"malformed PKCS8 public key(code:001)";var n=ASN1HEX.getPosArrayOfChildren_AtObj(q,r);if(2!=n.length)throw"malformed PKCS8 public key(code:002)";if("06"!=q.substr(n[0],2))throw"malformed PKCS8 public key(code:003)";if(o.algoid=ASN1HEX.getHexOfV_AtObj(q,n[0]),"06"==q.substr(n[1],2)&&(o.algparam=ASN1HEX.getHexOfV_AtObj(q,n[1])),"03"!=q.substr(p[1],2))throw"malformed PKCS8 public key(code:004)";return o.key=ASN1HEX.getHexOfV_AtObj(q,p[1]).substr(2),o},getRSAKeyFromPublicPKCS8Hex:function(r){var q=ASN1HEX.getPosArrayOfChildren_AtObj(r,0);if(2!=q.length)throw"outer DERSequence shall have 2 elements: "+q.length;var p=ASN1HEX.getHexOfTLV_AtObj(r,q[0]);if("300d06092a864886f70d0101010500"!=p)throw"PKCS8 AlgorithmId is not rsaEncryption";if("03"!=r.substr(q[1],2))throw"PKCS8 Public Key is not BITSTRING encapslated.";var t=ASN1HEX.getStartPosOfV_AtObj(r,q[1])+2;if("30"!=r.substr(t,2))throw"PKCS8 Public Key is not SEQUENCE.";var n=ASN1HEX.getPosArrayOfChildren_AtObj(r,t);if(2!=n.length)throw"inner DERSequence shall have 2 elements: "+n.length;if("02"!=r.substr(n[0],2))throw"N is not ASN.1 INTEGER";if("02"!=r.substr(n[1],2))throw"E is not ASN.1 INTEGER";var u=ASN1HEX.getHexOfV_AtObj(r,n[0]),s=ASN1HEX.getHexOfV_AtObj(r,n[1]),o=new RSAKey;return o.setPublic(u,s),o}}}(),KEYUTIL=function(){var c=function(n,p,o){return i(CryptoJS.AES,n,p,o)},d=function(n,p,o){return i(CryptoJS.TripleDES,n,p,o)},i=function(q,v,s,o){var p=CryptoJS.enc.Hex.parse(v),u=CryptoJS.enc.Hex.parse(s),n=CryptoJS.enc.Hex.parse(o),r={};r.key=u,r.iv=n,r.ciphertext=p;var t=q.decrypt(r,u,{iv:n});return CryptoJS.enc.Hex.stringify(t)},j=function(n,p,o){return e(CryptoJS.AES,n,p,o)},m=function(n,p,o){return e(CryptoJS.TripleDES,n,p,o)},e=function(r,w,t,o){var q=CryptoJS.enc.Hex.parse(w),v=CryptoJS.enc.Hex.parse(t),n=CryptoJS.enc.Hex.parse(o),u=r.encrypt(q,v,{iv:n}),p=CryptoJS.enc.Hex.parse(u.toString()),s=CryptoJS.enc.Base64.stringify(p);return s},g={"AES-256-CBC":{proc:c,eproc:j,keylen:32,ivlen:16},"AES-192-CBC":{proc:c,eproc:j,keylen:24,ivlen:16},"AES-128-CBC":{proc:c,eproc:j,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:d,eproc:m,keylen:24,ivlen:8}},b=function(n){return g[n].proc},k=function(n){var p=CryptoJS.lib.WordArray.random(n),o=CryptoJS.enc.Hex.stringify(p);return o},l=function(q){var r={};q.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"))&&(r.cipher=RegExp.$1,r.ivsalt=RegExp.$2),q.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"))&&(r.type=RegExp.$1);var p=-1,t=0;q.indexOf("\r\n\r\n")!=-1&&(p=q.indexOf("\r\n\r\n"),t=2),q.indexOf("\n\n")!=-1&&(p=q.indexOf("\n\n"),t=1);var o=q.indexOf("-----END");if(p!=-1&&o!=-1){var n=q.substring(p+2*t,o-t);n=n.replace(/\s+/g,""),r.data=n}return r},h=function(o,w,n){for(var t=n.substring(0,16),r=CryptoJS.enc.Hex.parse(t),p=CryptoJS.enc.Utf8.parse(w),s=g[o].keylen+g[o].ivlen,v="",u=null;;){var q=CryptoJS.algo.MD5.create();if(null!=u&&q.update(u),q.update(p),q.update(r),u=q.finalize(),v+=CryptoJS.enc.Hex.stringify(u),v.length>=2*s)break}var x={};return x.keyhex=v.substr(0,2*g[o].keylen),x.ivhex=v.substr(2*g[o].keylen,2*g[o].ivlen),x},a=function(n,t,p,u){var q=CryptoJS.enc.Base64.parse(n),o=CryptoJS.enc.Hex.stringify(q),s=g[t].proc,r=s(o,p,u);return r},f=function(n,q,o,s){var p=g[q].eproc,r=p(n,o,s);return r};return{version:"1.0.0",getHexFromPEM:function(o,r){var p=o;if(p.indexOf("BEGIN "+r)==-1)throw"can't find PEM header: "+r;p=p.replace("-----BEGIN "+r+"-----",""),p=p.replace("-----END "+r+"-----","");var q=p.replace(/\s+/g,""),n=b64tohex(q);return n},getDecryptedKeyHexByKeyIV:function(o,r,q,p){var n=b(r);return n(o,q,p)},parsePKCS5PEM:function(n){return l(n)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(o,n,p){return h(o,n,p)},decryptKeyB64:function(n,p,o,q){return a(n,p,o,q)},getDecryptedKeyHex:function(w,v){var o=l(w),p=(o.type,o.cipher),n=o.ivsalt,q=o.data,u=h(p,v,n),t=u.keyhex,s=a(q,p,t,n);return s},getRSAKeyFromEncryptedPKCS5PEM:function(p,o){var q=this.getDecryptedKeyHex(p,o),n=new RSAKey;return n.readPrivateKeyFromASN1HexString(q),n},getEncryptedPKCS5PEMFromPrvKeyHex:function(q,x,r,p){var n="";if("undefined"!=typeof r&&null!=r||(r="AES-256-CBC"),"undefined"==typeof g[r])throw"KEYUTIL unsupported algorithm: "+r;if("undefined"==typeof p||null==p){var t=g[r].ivlen,s=k(t);p=s.toUpperCase()}var w=h(r,x,p),v=w.keyhex,u=f(q,r,v,p),o=u.replace(/(.{64})/g,"$1\r\n"),n="-----BEGIN RSA PRIVATE KEY-----\r\n";return n+="Proc-Type: 4,ENCRYPTED\r\n",n+="DEK-Info: "+r+","+p+"\r\n",n+="\r\n",n+=o,n+="\r\n-----END RSA PRIVATE KEY-----\r\n"},getEncryptedPKCS5PEMFromRSAKey:function(C,D,o,s){var A=new KJUR.asn1.DERInteger({int:0}),v=new KJUR.asn1.DERInteger({bigint:C.n}),z=new KJUR.asn1.DERInteger({int:C.e}),B=new KJUR.asn1.DERInteger({bigint:C.d}),t=new KJUR.asn1.DERInteger({bigint:C.p}),r=new KJUR.asn1.DERInteger({bigint:C.q}),y=new KJUR.asn1.DERInteger({bigint:C.dmp1}),u=new KJUR.asn1.DERInteger({bigint:C.dmq1}),x=new KJUR.asn1.DERInteger({bigint:C.coeff}),E=new KJUR.asn1.DERSequence({array:[A,v,z,B,t,r,y,u,x]}),w=E.getEncodedHex();return this.getEncryptedPKCS5PEMFromPrvKeyHex(w,D,o,s)},newEncryptedPKCS5PEM:function(n,o,r,s){"undefined"!=typeof o&&null!=o||(o=1024),"undefined"!=typeof r&&null!=r||(r="10001");var p=new RSAKey;p.generate(o,r);var q=null;return q="undefined"==typeof s||null==s?this.getEncryptedPKCS5PEMFromRSAKey(pkey,n):this.getEncryptedPKCS5PEMFromRSAKey(pkey,n,s)},getRSAKeyFromPlainPKCS8PEM:function(p){if(p.match(/ENCRYPTED/))throw"pem shall be not ENCRYPTED";var o=this.getHexFromPEM(p,"PRIVATE KEY"),n=this.getRSAKeyFromPlainPKCS8Hex(o);return n},getRSAKeyFromPlainPKCS8Hex:function(q){var p=ASN1HEX.getPosArrayOfChildren_AtObj(q,0);if(3!=p.length)throw"outer DERSequence shall have 3 elements: "+p.length;var o=ASN1HEX.getHexOfTLV_AtObj(q,p[1]);if("300d06092a864886f70d0101010500"!=o)throw"PKCS8 AlgorithmIdentifier is not rsaEnc: "+o;var o=ASN1HEX.getHexOfTLV_AtObj(q,p[1]),r=ASN1HEX.getHexOfTLV_AtObj(q,p[2]),s=ASN1HEX.getHexOfV_AtObj(r,0),n=new RSAKey;return n.readPrivateKeyFromASN1HexString(s),n},parseHexOfEncryptedPKCS8:function(u){var q={},p=ASN1HEX.getPosArrayOfChildren_AtObj(u,0);if(2!=p.length)throw"malformed format: SEQUENCE(0).items != 2: "+p.length;q.ciphertext=ASN1HEX.getHexOfV_AtObj(u,p[1]);var w=ASN1HEX.getPosArrayOfChildren_AtObj(u,p[0]);if(2!=w.length)throw"malformed format: SEQUENCE(0.0).items != 2: "+w.length;if("2a864886f70d01050d"!=ASN1HEX.getHexOfV_AtObj(u,w[0]))throw"this only supports pkcs5PBES2";var n=ASN1HEX.getPosArrayOfChildren_AtObj(u,w[1]);if(2!=w.length)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+n.length;
var o=ASN1HEX.getPosArrayOfChildren_AtObj(u,n[1]);if(2!=o.length)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+o.length;if("2a864886f70d0307"!=ASN1HEX.getHexOfV_AtObj(u,o[0]))throw"this only supports TripleDES";q.encryptionSchemeAlg="TripleDES",q.encryptionSchemeIV=ASN1HEX.getHexOfV_AtObj(u,o[1]);var r=ASN1HEX.getPosArrayOfChildren_AtObj(u,n[0]);if(2!=r.length)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+r.length;if("2a864886f70d01050c"!=ASN1HEX.getHexOfV_AtObj(u,r[0]))throw"this only supports pkcs5PBKDF2";var v=ASN1HEX.getPosArrayOfChildren_AtObj(u,r[1]);if(v.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+v.length;q.pbkdf2Salt=ASN1HEX.getHexOfV_AtObj(u,v[0]);var s=ASN1HEX.getHexOfV_AtObj(u,v[1]);try{q.pbkdf2Iter=parseInt(s,16)}catch(t){throw"malformed format pbkdf2Iter: "+s}return q},getPBKDF2KeyHexFromParam:function(s,n){var r=CryptoJS.enc.Hex.parse(s.pbkdf2Salt),o=s.pbkdf2Iter,q=CryptoJS.PBKDF2(n,r,{keySize:6,iterations:o}),p=CryptoJS.enc.Hex.stringify(q);return p},getPlainPKCS8HexFromEncryptedPKCS8PEM:function(v,w){var p=this.getHexFromPEM(v,"ENCRYPTED PRIVATE KEY"),n=this.parseHexOfEncryptedPKCS8(p),s=KEYUTIL.getPBKDF2KeyHexFromParam(n,w),t={};t.ciphertext=CryptoJS.enc.Hex.parse(n.ciphertext);var r=CryptoJS.enc.Hex.parse(s),q=CryptoJS.enc.Hex.parse(n.encryptionSchemeIV),u=CryptoJS.TripleDES.decrypt(t,r,{iv:q}),o=CryptoJS.enc.Hex.stringify(u);return o},getRSAKeyFromEncryptedPKCS8PEM:function(q,p){var o=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(q,p),n=this.getRSAKeyFromPlainPKCS8Hex(o);return n},getKeyFromEncryptedPKCS8PEM:function(q,o){var n=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(q,o),p=this.getKeyFromPlainPrivatePKCS8Hex(n);return p},parsePlainPrivatePKCS8Hex:function(q){var o={};if(o.algparam=null,"30"!=q.substr(0,2))throw"malformed plain PKCS8 private key(code:001)";var p=ASN1HEX.getPosArrayOfChildren_AtObj(q,0);if(3!=p.length)throw"malformed plain PKCS8 private key(code:002)";if("30"!=q.substr(p[1],2))throw"malformed PKCS8 private key(code:003)";var n=ASN1HEX.getPosArrayOfChildren_AtObj(q,p[1]);if(2!=n.length)throw"malformed PKCS8 private key(code:004)";if("06"!=q.substr(n[0],2))throw"malformed PKCS8 private key(code:005)";if(o.algoid=ASN1HEX.getHexOfV_AtObj(q,n[0]),"06"==q.substr(n[1],2)&&(o.algparam=ASN1HEX.getHexOfV_AtObj(q,n[1])),"04"!=q.substr(p[2],2))throw"malformed PKCS8 private key(code:006)";return o.keyidx=ASN1HEX.getStartPosOfV_AtObj(q,p[2]),o},getKeyFromPlainPrivatePKCS8PEM:function(o){var n=this.getHexFromPEM(o,"PRIVATE KEY"),p=this.getKeyFromPlainPrivatePKCS8Hex(n);return p},getKeyFromPlainPrivatePKCS8Hex:function(n){var p=this.parsePlainPrivatePKCS8Hex(n);if("2a864886f70d010101"==p.algoid){this.parsePrivateRawRSAKeyHexAtObj(n,p);var o=p.key,q=new RSAKey;return q.setPrivateEx(o.n,o.e,o.d,o.p,o.q,o.dp,o.dq,o.co),q}if("2a8648ce3d0201"==p.algoid){if(this.parsePrivateRawECKeyHexAtObj(n,p),void 0===KJUR.crypto.OID.oidhex2name[p.algparam])throw"KJUR.crypto.OID.oidhex2name undefined: "+p.algparam;var r=KJUR.crypto.OID.oidhex2name[p.algparam],q=new KJUR.crypto.ECDSA({curve:r,prv:p.key});return q}throw"unsupported private key algorithm"},getRSAKeyFromPublicPKCS8PEM:function(o){var p=this.getHexFromPEM(o,"PUBLIC KEY"),n=this.getRSAKeyFromPublicPKCS8Hex(p);return n},getKeyFromPublicPKCS8PEM:function(o){var p=this.getHexFromPEM(o,"PUBLIC KEY"),n=this.getKeyFromPublicPKCS8Hex(p);return n},getKeyFromPublicPKCS8Hex:function(o){var n=this.parsePublicPKCS8Hex(o);if("2a864886f70d010101"==n.algoid){var r=this.parsePublicRawRSAKeyHex(n.key),p=new RSAKey;return p.setPublic(r.n,r.e),p}if("2a8648ce3d0201"==n.algoid){if(void 0===KJUR.crypto.OID.oidhex2name[n.algparam])throw"KJUR.crypto.OID.oidhex2name undefined: "+n.algparam;var q=KJUR.crypto.OID.oidhex2name[n.algparam],p=new KJUR.crypto.ECDSA({curve:q,pub:n.key});return p}throw"unsupported public key algorithm"},parsePublicRawRSAKeyHex:function(p){var n={};if("30"!=p.substr(0,2))throw"malformed RSA key(code:001)";var o=ASN1HEX.getPosArrayOfChildren_AtObj(p,0);if(2!=o.length)throw"malformed RSA key(code:002)";if("02"!=p.substr(o[0],2))throw"malformed RSA key(code:003)";if(n.n=ASN1HEX.getHexOfV_AtObj(p,o[0]),"02"!=p.substr(o[1],2))throw"malformed RSA key(code:004)";return n.e=ASN1HEX.getHexOfV_AtObj(p,o[1]),n},parsePrivateRawRSAKeyHexAtObj:function(o,q){var p=q.keyidx;if("30"!=o.substr(p,2))throw"malformed RSA private key(code:001)";var n=ASN1HEX.getPosArrayOfChildren_AtObj(o,p);if(9!=n.length)throw"malformed RSA private key(code:002)";q.key={},q.key.n=ASN1HEX.getHexOfV_AtObj(o,n[1]),q.key.e=ASN1HEX.getHexOfV_AtObj(o,n[2]),q.key.d=ASN1HEX.getHexOfV_AtObj(o,n[3]),q.key.p=ASN1HEX.getHexOfV_AtObj(o,n[4]),q.key.q=ASN1HEX.getHexOfV_AtObj(o,n[5]),q.key.dp=ASN1HEX.getHexOfV_AtObj(o,n[6]),q.key.dq=ASN1HEX.getHexOfV_AtObj(o,n[7]),q.key.co=ASN1HEX.getHexOfV_AtObj(o,n[8])},parsePrivateRawECKeyHexAtObj:function(o,q){var p=q.keyidx;if("30"!=o.substr(p,2))throw"malformed ECC private key(code:001)";var n=ASN1HEX.getPosArrayOfChildren_AtObj(o,p);if(3!=n.length)throw"malformed ECC private key(code:002)";if("04"!=o.substr(n[1],2))throw"malformed ECC private key(code:003)";q.key=ASN1HEX.getHexOfV_AtObj(o,n[1])},parsePublicPKCS8Hex:function(q){var o={};o.algparam=null;var p=ASN1HEX.getPosArrayOfChildren_AtObj(q,0);if(2!=p.length)throw"outer DERSequence shall have 2 elements: "+p.length;var r=p[0];if("30"!=q.substr(r,2))throw"malformed PKCS8 public key(code:001)";var n=ASN1HEX.getPosArrayOfChildren_AtObj(q,r);if(2!=n.length)throw"malformed PKCS8 public key(code:002)";if("06"!=q.substr(n[0],2))throw"malformed PKCS8 public key(code:003)";if(o.algoid=ASN1HEX.getHexOfV_AtObj(q,n[0]),"06"==q.substr(n[1],2)&&(o.algparam=ASN1HEX.getHexOfV_AtObj(q,n[1])),"03"!=q.substr(p[1],2))throw"malformed PKCS8 public key(code:004)";return o.key=ASN1HEX.getHexOfV_AtObj(q,p[1]).substr(2),o},getRSAKeyFromPublicPKCS8Hex:function(r){var q=ASN1HEX.getPosArrayOfChildren_AtObj(r,0);if(2!=q.length)throw"outer DERSequence shall have 2 elements: "+q.length;var p=ASN1HEX.getHexOfTLV_AtObj(r,q[0]);if("300d06092a864886f70d0101010500"!=p)throw"PKCS8 AlgorithmId is not rsaEncryption";if("03"!=r.substr(q[1],2))throw"PKCS8 Public Key is not BITSTRING encapslated.";var t=ASN1HEX.getStartPosOfV_AtObj(r,q[1])+2;if("30"!=r.substr(t,2))throw"PKCS8 Public Key is not SEQUENCE.";var n=ASN1HEX.getPosArrayOfChildren_AtObj(r,t);if(2!=n.length)throw"inner DERSequence shall have 2 elements: "+n.length;if("02"!=r.substr(n[0],2))throw"N is not ASN.1 INTEGER";if("02"!=r.substr(n[1],2))throw"E is not ASN.1 INTEGER";var u=ASN1HEX.getHexOfV_AtObj(r,n[0]),s=ASN1HEX.getHexOfV_AtObj(r,n[1]),o=new RSAKey;return o.setPublic(u,s),o}}}();KEYUTIL.getKey=function(d,a,c){if(d instanceof RSAKey)return d;if(d instanceof KJUR.crypto.ECDSA)return d;if(void 0!==d.xy&&void 0!==d.curve)return new KJUR.crypto.ECDSA({prv:d.xy,curve:d.curve});if(void 0!==d.n&&void 0!==d.e&&void 0!==d.d&&void 0!==d.p&&void 0!==d.q&&void 0!==d.dp&&void 0!==d.dq&&void 0!==d.co){var b=new RSAKey;return b.setPrivateEx(d.n,d.e,d.d,d.p,d.q,d.dp,d.dq,d.co),b}if(void 0!==d.d&&void 0!==d.curve)return new KJUR.crypto.ECDSA({pub:d.d,curve:d.curve});if(void 0!==d.n&&d.e){var b=new RSAKey;return b.setPublic(d.n,d.e),b}if(d.indexOf("-END CERTIFICATE-",0)!=-1||d.indexOf("-END X509 CERTIFICATE-",0)!=-1||d.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1)return X509.getPublicKeyFromCertPEM(d);if("pkcs8pub"===c)return KEYUTIL.getKeyFromPublicPKCS8Hex(d);if(d.indexOf("-END PUBLIC KEY-")!=-1)return KEYUTIL.getKeyFromPublicPKCS8PEM(d);if("pkcs5prv"===c){var b=new RSAKey;return b.readPrivateKeyFromASN1HexString(d),b}if("pkcs5prv"===c){var b=new RSAKey;return b.readPrivateKeyFromASN1HexString(d),b}if(d.indexOf("-END RSA PRIVATE KEY-")!=-1&&d.indexOf("4,ENCRYPTED")==-1){var b=new RSAKey;return b.readPrivateKeyFromPEMString(d),b}if(d.indexOf("-END PRIVATE KEY-")!=-1)return KEYUTIL.getKeyFromPlainPrivatePKCS8PEM(d);if(d.indexOf("-END RSA PRIVATE KEY-")!=-1&&d.indexOf("4,ENCRYPTED")!=-1)return KEYUTIL.getRSAKeyFromEncryptedPKCS5PEM(d,a);if(d.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1)return KEYUTIL.getKeyFromEncryptedPKCS8PEM(d,a);throw"not supported argument"},KEYUTIL.generateKeypair=function(a,c){if("RSA"==a){var b=c,h=new RSAKey;h.generate(b,"10001");var f=new RSAKey,e=h.n.toString(16),i=h.e.toString(16);f.setPublic(e,i);var k={};return k.prvKeyObj=h,k.pubKeyObj=f,k}if("EC"==a){var d=c,g=new KJUR.crypto.ECDSA({curve:d}),j=g.generateKeyPairHex(),h=new KJUR.crypto.ECDSA({curve:d});h.setPrivateKeyHex(j.ecprvhex);var f=new KJUR.crypto.ECDSA({curve:d});f.setPublicKeyHex(j.ecpubhex);var k={};return k.prvKeyObj=h,k.pubKeyObj=f,k}throw"unknown algorithm: "+a},RSAKey.prototype.readPrivateKeyFromPEMString=_rsapem_readPrivateKeyFromPEMString,RSAKey.prototype.readPrivateKeyFromASN1HexString=_rsapem_readPrivateKeyFromASN1HexString;var _RE_HEXDECONLY=new RegExp("");_RE_HEXDECONLY.compile("[^0-9a-f]","gi"),RSAKey.prototype.signWithMessageHash=_rsasign_signWithMessageHash,RSAKey.prototype.signString=_rsasign_signString,RSAKey.prototype.signStringWithSHA1=_rsasign_signStringWithSHA1,RSAKey.prototype.signStringWithSHA256=_rsasign_signStringWithSHA256,RSAKey.prototype.sign=_rsasign_signString,RSAKey.prototype.signWithSHA1=_rsasign_signStringWithSHA1,RSAKey.prototype.signWithSHA256=_rsasign_signStringWithSHA256,RSAKey.prototype.signWithMessageHashPSS=_rsasign_signWithMessageHashPSS,RSAKey.prototype.signStringPSS=_rsasign_signStringPSS,RSAKey.prototype.signPSS=_rsasign_signStringPSS,RSAKey.SALT_LEN_HLEN=-1,RSAKey.SALT_LEN_MAX=-2,RSAKey.prototype.verifyWithMessageHash=_rsasign_verifyWithMessageHash,RSAKey.prototype.verifyString=_rsasign_verifyString,RSAKey.prototype.verifyHexSignatureForMessage=_rsasign_verifyHexSignatureForMessage,RSAKey.prototype.verify=_rsasign_verifyString,RSAKey.prototype.verifyHexSignatureForByteArrayMessage=_rsasign_verifyHexSignatureForMessage,RSAKey.prototype.verifyWithMessageHashPSS=_rsasign_verifyWithMessageHashPSS,RSAKey.prototype.verifyStringPSS=_rsasign_verifyStringPSS,RSAKey.prototype.verifyPSS=_rsasign_verifyStringPSS,RSAKey.SALT_LEN_RECOVER=-2,X509.pemToBase64=function(a){var b=a;return b=b.replace("-----BEGIN CERTIFICATE-----",""),b=b.replace("-----END CERTIFICATE-----",""),b=b.replace(/[ \n]+/g,"")},X509.pemToHex=function(a){var c=X509.pemToBase64(a),b=b64tohex(c);return b},X509.getSubjectPublicKeyPosFromCertHex=function(f){var e=X509.getSubjectPublicKeyInfoPosFromCertHex(f);if(e==-1)return-1;var b=ASN1HEX.getPosArrayOfChildren_AtObj(f,e);if(2!=b.length)return-1;var d=b[1];if("03"!=f.substring(d,d+2))return-1;var c=ASN1HEX.getStartPosOfV_AtObj(f,d);return"00"!=f.substring(c,c+2)?-1:c+2},X509.getSubjectPublicKeyInfoPosFromCertHex=function(d){var c=ASN1HEX.getStartPosOfV_AtObj(d,0),b=ASN1HEX.getPosArrayOfChildren_AtObj(d,c);return b.length<1?-1:"a003020102"==d.substring(b[0],b[0]+10)?b.length<6?-1:b[6]:b.length<5?-1:b[5]},X509.getPublicKeyHexArrayFromCertHex=function(f){var e=X509.getSubjectPublicKeyPosFromCertHex(f),b=ASN1HEX.getPosArrayOfChildren_AtObj(f,e);if(2!=b.length)return[];var d=ASN1HEX.getHexOfV_AtObj(f,b[0]),c=ASN1HEX.getHexOfV_AtObj(f,b[1]);return null!=d&&null!=c?[d,c]:[]},X509.getHexTbsCertificateFromCert=function(b){var a=ASN1HEX.getStartPosOfV_AtObj(b,0);return a},X509.getPublicKeyHexArrayFromCertPEM=function(c){var d=X509.pemToHex(c),b=X509.getPublicKeyHexArrayFromCertHex(d);return b},X509.hex2dn=function(e){for(var f="",c=ASN1HEX.getPosArrayOfChildren_AtObj(e,0),d=0;d<c.length;d++){var b=ASN1HEX.getHexOfTLV_AtObj(e,c[d]);f=f+"/"+X509.hex2rdn(b)}return f},X509.hex2rdn=function(a){var f=ASN1HEX.getDecendantHexTLVByNthList(a,0,[0,0]),e=ASN1HEX.getDecendantHexVByNthList(a,0,[0,1]),c="";try{c=X509.DN_ATTRHEX[f]}catch(b){c=f}e=e.replace(/(..)/g,"%$1");var d=decodeURIComponent(e);return c+"="+d},X509.DN_ATTRHEX={"0603550406":"C","060355040a":"O","060355040b":"OU","0603550403":"CN","0603550405":"SN","0603550408":"ST","0603550407":"L"},X509.getPublicKeyFromCertPEM=function(a){var d=X509.getPublicKeyInfoPropOfCertPEM(a);if("2a864886f70d010101"==d.algoid){var e=PKCS5PKEY.parsePublicRawRSAKeyHex(d.keyhex),b=new RSAKey;return b.setPublic(e.n,e.e),b}if(d.algoid="2a8648ce3d0201"){var c=KJUR.crypto.OID.oidhex2name[d.algparam],b=new KJUR.crypto.ECDSA({curve:c,info:d.keyhex});return b.setPublicKeyHex(d.keyhex),b}throw"unsupported key"},X509.getPublicKeyInfoPropOfCertPEM=function(e){var c={};c.algparam=null;var g=X509.pemToHex(e),d=ASN1HEX.getPosArrayOfChildren_AtObj(g,0);if(3!=d.length)throw"malformed X.509 certificate PEM (code:001)";if("30"!=g.substr(d[0],2))throw"malformed X.509 certificate PEM (code:002)";var b=ASN1HEX.getPosArrayOfChildren_AtObj(g,d[0]);if(b.length<7)throw"malformed X.509 certificate PEM (code:003)";var h=ASN1HEX.getPosArrayOfChildren_AtObj(g,b[6]);if(2!=h.length)throw"malformed X.509 certificate PEM (code:004)";var f=ASN1HEX.getPosArrayOfChildren_AtObj(g,h[0]);if(2!=f.length)throw"malformed X.509 certificate PEM (code:005)";if(c.algoid=ASN1HEX.getHexOfV_AtObj(g,f[0]),"06"==g.substr(f[1],2)&&(c.algparam=ASN1HEX.getHexOfV_AtObj(g,f[1])),"03"!=g.substr(h[1],2))throw"malformed X.509 certificate PEM (code:006)";var a=ASN1HEX.getHexOfV_AtObj(g,h[1]);return c.keyhex=a.substr(2),c};var jsonParse=function(){function h(l,m,n){return m?g[m]:String.fromCharCode(parseInt(n,16))}var e="(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)",j='(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))',i='(?:"'+j+'*")',d=new RegExp("(?:false|true|null|[\\{\\}\\[\\]]|"+e+"|"+i+")","g"),k=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),g={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},c=new String(""),a="\\",b=({"{":Object,"[":Array},Object.hasOwnProperty);return function(u,q){var x,p=u.match(d),v=p[0],l=!1;"{"===v?x={}:"["===v?x=[]:(x=[],l=!0);for(var t,r=[x],o=1-l,m=p.length;o<m;++o){v=p[o];var w;switch(v.charCodeAt(0)){default:w=r[0],w[t||w.length]=+v,t=void 0;break;case 34:if(v=v.substring(1,v.length-1),v.indexOf(a)!==-1&&(v=v.replace(k,h)),w=r[0],!t){if(!(w instanceof Array)){t=v||c;break}t=w.length}w[t]=v,t=void 0;break;case 91:w=r[0],r.unshift(w[t||w.length]=[]),t=void 0;break;case 93:r.shift();break;case 102:w=r[0],w[t||w.length]=!1,t=void 0;break;case 110:w=r[0],w[t||w.length]=null,t=void 0;break;case 116:w=r[0],w[t||w.length]=!0,t=void 0;break;case 123:w=r[0],r.unshift(w[t||w.length]={}),t=void 0;break;case 125:r.shift()}}if(l){if(1!==r.length)throw new Error;x=x[0]}else if(r.length)throw new Error;if(q){var s=function(C,B){var D=C[B];if(D&&"object"==typeof D){var n=null;for(var z in D)if(b.call(D,z)&&D!==C){var y=s(D,z);void 0!==y?D[z]=y:(n||(n=[]),n.push(z))}if(n)for(var A=n.length;--A>=0;)delete D[n[A]]}return q.call(C,B,D)};x=s({"":x},"")}return x}}();"undefined"!=typeof KJUR&&KJUR||(KJUR={}),"undefined"!=typeof KJUR.jws&&KJUR.jws||(KJUR.jws={}),KJUR.jws.JWS=function(){function b(l,k){return utf8tob64u(l)+"."+utf8tob64u(k)}function c(l){var m=l.alg,k="";if("RS256"!=m&&"RS512"!=m&&"PS256"!=m&&"PS512"!=m)throw"JWS signature algorithm not supported: "+m;return"256"==m.substr(2)&&(k="sha256"),"512"==m.substr(2)&&(k="sha512"),k}function e(k){return c(jsonParse(k))}function j(k,p,s,m,q,r){var n=new RSAKey;n.setPrivate(m,q,r);var l=e(k),o=n.signString(s,l);return o}function i(q,p,o,n,m){var k=null;k="undefined"==typeof m?e(q):c(m);var l="PS"==m.alg.substr(0,2);return n.hashAndSign?b64tob64u(n.hashAndSign(k,o,"binary","base64",l)):hextob64u(l?n.signStringPSS(o,k):n.signString(o,k))}function d(q,p,o,l){var n=new RSAKey;n.readPrivateKeyFromPEMString(l);var k=e(q),m=n.signString(o,k);return m}this.parseJWS=function(n,p){if(void 0===this.parsedJWS||!p&&void 0===this.parsedJWS.sigvalH){if(null==n.match(/^([^.]+)\.([^.]+)\.([^.]+)$/))throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var q=RegExp.$1,l=RegExp.$2,r=RegExp.$3,t=q+"."+l;if(this.parsedJWS={},this.parsedJWS.headB64U=q,this.parsedJWS.payloadB64U=l,this.parsedJWS.sigvalB64U=r,this.parsedJWS.si=t,!p){var o=b64utohex(r),m=parseBigInt(o,16);this.parsedJWS.sigvalH=o,this.parsedJWS.sigvalBI=m}var k=b64utoutf8(q),s=b64utoutf8(l);if(this.parsedJWS.headS=k,this.parsedJWS.payloadS=s,!this.isSafeJSONString(k,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+k}},this.verifyJWSByNE=function(m,l,k){return this.parseJWS(m),_rsasign_verifySignatureWithArgs(this.parsedJWS.si,this.parsedJWS.sigvalBI,l,k)},this.verifyJWSByKey=function(n,m){this.parseJWS(n);var k=c(this.parsedJWS.headP),l="PS"==this.parsedJWS.headP.alg.substr(0,2);return m.hashAndVerify?m.hashAndVerify(k,new Buffer(this.parsedJWS.si,"utf8").toString("base64"),b64utob64(this.parsedJWS.sigvalB64U),"base64",l):l?m.verifyStringPSS(this.parsedJWS.si,this.parsedJWS.sigvalH,k):m.verifyString(this.parsedJWS.si,this.parsedJWS.sigvalH)},this.verifyJWSByPemX509Cert=function(m,k){this.parseJWS(m);var l=new X509;return l.readCertPEM(k),l.subjectPublicKeyRSA.verifyString(this.parsedJWS.si,this.parsedJWS.sigvalH)},this.generateJWSByNED=function(r,n,q,m,p){if(!this.isSafeJSONString(r))throw"JWS Head is not safe JSON string: "+r;var l=b(r,n),o=j(r,n,l,q,m,p),k=hextob64u(o);return this.parsedJWS={},this.parsedJWS.headB64U=l.split(".")[0],this.parsedJWS.payloadB64U=l.split(".")[1],this.parsedJWS.sigvalB64U=k,l+"."+k},this.generateJWSByKey=function(p,n,k){var o={};if(!this.isSafeJSONString(p,o,"headP"))throw"JWS Head is not safe JSON string: "+p;var m=b(p,n),l=i(p,n,m,k,o.headP);return this.parsedJWS={},this.parsedJWS.headB64U=m.split(".")[0],this.parsedJWS.payloadB64U=m.split(".")[1],this.parsedJWS.sigvalB64U=l,m+"."+l},this.generateJWSByP1PrvKey=function(p,n,k){if(!this.isSafeJSONString(p))throw"JWS Head is not safe JSON string: "+p;var m=b(p,n),o=d(p,n,m,k),l=hextob64u(o);return this.parsedJWS={},this.parsedJWS.headB64U=m.split(".")[0],this.parsedJWS.payloadB64U=m.split(".")[1],this.parsedJWS.sigvalB64U=l,m+"."+l}},KJUR.jws.JWS.sign=function(b,p,i,l,k){var j=KJUR.jws.JWS;if(!j.isSafeJSONString(p))throw"JWS Head is not safe JSON string: "+sHead;var e=j.readSafeJSONString(p);""!=b&&null!=b||void 0===e.alg||(b=e.alg),""!=b&&null!=b&&void 0===e.alg&&(e.alg=b,p=JSON.stringify(e));var d=null;if(void 0===j.jwsalg2sigalg[b])throw"unsupported alg name: "+b;d=j.jwsalg2sigalg[b];var c=utf8tob64u(p),g=utf8tob64u(i),n=c+"."+g,m="";if("Hmac"==d.substr(0,4)){if(void 0===l)throw"hexadecimal key shall be specified for HMAC";var h=new KJUR.crypto.Mac({alg:d,pass:hextorstr(l)});h.updateString(n),m=h.doFinal()}else if(d.indexOf("withECDSA")!=-1){var o=new KJUR.crypto.Signature({alg:d});o.init(l,k),o.updateString(n),hASN1Sig=o.sign(),m=KJUR.crypto.ECDSA.asn1SigToConcatSig(hASN1Sig)}else if("none"!=d){var o=new KJUR.crypto.Signature({alg:d});o.init(l,k),o.updateString(n),m=o.sign()}var f=hextob64u(m);return n+"."+f},KJUR.jws.JWS.verify=function(d,m){var k=KJUR.jws.JWS,l=d.split("."),c=l[0],h=l[1],o=c+"."+h,n=b64utohex(l[2]),f=k.readSafeJSONString(b64utoutf8(l[0])),b=null;if(void 0===f.alg)throw"algorithm not specified in header";b=f.alg;var e=null;if(void 0===k.jwsalg2sigalg[f.alg])throw"unsupported alg name: "+b;if(e=k.jwsalg2sigalg[b],"none"==e)return!0;if("Hmac"==e.substr(0,4)){if(void 0===m)throw"hexadecimal key shall be specified for HMAC";var j=new KJUR.crypto.Mac({alg:e,pass:hextorstr(m)});return j.updateString(o),hSig2=j.doFinal(),n==hSig2}if(e.indexOf("withECDSA")!=-1){var g=null;try{g=KJUR.crypto.ECDSA.concatSigToASN1Sig(n)}catch(i){return!1}var p=new KJUR.crypto.Signature({alg:e});return p.init(m),p.updateString(o),p.verify(g)}var p=new KJUR.crypto.Signature({alg:e});return p.init(m),p.updateString(o),p.verify(n)},KJUR.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},KJUR.jws.JWS.isSafeJSONString=function(d,c,e){var f=null;try{return f=jsonParse(d),"object"!=typeof f?0:f.constructor===Array?0:(c&&(c[e]=f),1)}catch(b){return 0}},KJUR.jws.JWS.readSafeJSONString=function(c){var d=null;try{return d=jsonParse(c),"object"!=typeof d?null:d.constructor===Array?null:d}catch(b){return null}},KJUR.jws.JWS.getEncodedSignatureValueFromJWS=function(b){if(null==b.match(/^[^.]+\.[^.]+\.([^.]+)$/))throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return RegExp.$1},KJUR.jws.IntDate=function(){},KJUR.jws.IntDate.get=function(b){if("now"==b)return KJUR.jws.IntDate.getNow();if("now + 1hour"==b)return KJUR.jws.IntDate.getNow()+3600;if("now + 1day"==b)return KJUR.jws.IntDate.getNow()+86400;if("now + 1month"==b)return KJUR.jws.IntDate.getNow()+2592e3;if("now + 1year"==b)return KJUR.jws.IntDate.getNow()+31536e3;if(b.match(/Z$/))return KJUR.jws.IntDate.getZulu(b);if(b.match(/^[0-9]+$/))return parseInt(b);throw"unsupported format: "+b},KJUR.jws.IntDate.getZulu=function(h){if(a=h.match(/(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)Z/)){var g=parseInt(RegExp.$1),i=parseInt(RegExp.$2)-1,c=parseInt(RegExp.$3),b=parseInt(RegExp.$4),e=parseInt(RegExp.$5),f=parseInt(RegExp.$6),j=new Date(Date.UTC(g,i,c,b,e,f));return~~(j/1e3)}throw"unsupported format: "+h},KJUR.jws.IntDate.getNow=function(){var b=~~(new Date/1e3);return b},KJUR.jws.IntDate.intDate2UTCString=function(b){var c=new Date(1e3*b);return c.toUTCString()},KJUR.jws.IntDate.intDate2Zulu=function(f){var j=new Date(1e3*f),i=("0000"+j.getUTCFullYear()).slice(-4),h=("00"+(j.getUTCMonth()+1)).slice(-2),c=("00"+j.getUTCDate()).slice(-2),b=("00"+j.getUTCHours()).slice(-2),e=("00"+j.getUTCMinutes()).slice(-2),g=("00"+j.getUTCSeconds()).slice(-2);return i+h+c+b+e+g+"Z"},function(root,factory){"function"==typeof define&&define.amd?define(factory):"object"==typeof module&&"object"==typeof module.exports?module.exports=factory():root.Cldr=factory()}(this,function(){var arrayIsArray=Array.isArray||function(obj){return"[object Array]"===Object.prototype.toString.call(obj)},pathNormalize=function(path,attributes){if(arrayIsArray(path)&&(path=path.join("/")),"string"!=typeof path)throw new Error('invalid path "'+path+'"');return path=path.replace(/^\//,"").replace(/^cldr\//,""),path=path.replace(/{[a-zA-Z]+}/g,function(name){return name=name.replace(/^{([^}]*)}$/,"$1"),attributes[name]}),path.split("/")},arraySome=function(array,callback){var i,length;if(array.some)return array.some(callback);for(i=0,length=array.length;i<length;i++)if(callback(array[i],i,array))return!0;return!1},coreLikelySubtags=function(Cldr,cldr,subtags,options){var match,matchFound,language=subtags[0],script=subtags[1],sep=Cldr.localeSep,territory=subtags[2];return options=options||{},"und"!==language&&"Zzzz"!==script&&"ZZ"!==territory?[language,script,territory]:"undefined"!=typeof cldr.get("supplemental/likelySubtags")?(matchFound=arraySome([[language,script,territory],[language,territory],[language,script],[language],["und",script]],function(test){return match=!/\b(Zzzz|ZZ)\b/.test(test.join(sep))&&cldr.get(["supplemental/likelySubtags",test.join(sep)])}),matchFound?(match=match.split(sep),["und"!==language?language:match[0],"Zzzz"!==script?script:match[1],"ZZ"!==territory?territory:match[2]]):options.force?cldr.get("supplemental/likelySubtags/und").split(sep):void 0):void 0},coreRemoveLikelySubtags=function(Cldr,cldr,maxLanguageId){var match,matchFound,language=maxLanguageId[0],script=maxLanguageId[1],territory=maxLanguageId[2];return matchFound=arraySome([[[language,"Zzzz","ZZ"],[language]],[[language,"Zzzz",territory],[language,territory]],[[language,script,"ZZ"],[language,script]]],function(test){var result=coreLikelySubtags(Cldr,cldr,test[0]);return match=test[1],result&&result[0]===maxLanguageId[0]&&result[1]===maxLanguageId[1]&&result[2]===maxLanguageId[2]}),matchFound?match:maxLanguageId},coreSubtags=function(locale){var aux,unicodeLanguageId,subtags=[];return locale=locale.replace(/_/,"-"),aux=locale.split("-u-"),aux[1]&&(aux[1]=aux[1].split("-t-"),locale=aux[0]+(aux[1][1]?"-t-"+aux[1][1]:""),subtags[4]=aux[1][0]),unicodeLanguageId=locale.split("-t-")[0],aux=unicodeLanguageId.match(/^(([a-z]{2,3})(-([A-Z][a-z]{3}))?(-([A-Z]{2}|[0-9]{3}))?)(-[a-zA-Z0-9]{5,8}|[0-9][a-zA-Z0-9]{3})*$|^(root)$/),null===aux?["und","Zzzz","ZZ"]:(subtags[0]=aux[9]||aux[2]||"und",subtags[1]=aux[4]||"Zzzz",subtags[2]=aux[6]||"ZZ",subtags[3]=aux[7],subtags)},arrayForEach=function(array,callback){var i,length;if(array.forEach)return array.forEach(callback);for(i=0,length=array.length;i<length;i++)callback(array[i],i,array)},bundleLookup=function(Cldr,cldr,minLanguageId){var availableBundleMap=Cldr._availableBundleMap,availableBundleMapQueue=Cldr._availableBundleMapQueue;return availableBundleMapQueue.length&&(arrayForEach(availableBundleMapQueue,function(bundle){var existing,maxBundle,minBundle,subtags;subtags=coreSubtags(bundle),maxBundle=coreLikelySubtags(Cldr,cldr,subtags,{force:!0})||subtags,minBundle=coreRemoveLikelySubtags(Cldr,cldr,maxBundle),minBundle=minBundle.join(Cldr.localeSep),existing=availableBundleMapQueue[minBundle],existing&&existing.length<bundle.length||(availableBundleMap[minBundle]=bundle)}),Cldr._availableBundleMapQueue=[]),availableBundleMap[minLanguageId]||null},objectKeys=function(object){var i,result=[];if(Object.keys)return Object.keys(object);for(i in object)result.push(i);return result},createError=function(code,attributes){var error,message;return message=code+(attributes&&JSON?": "+JSON.stringify(attributes):""),error=new Error(message),error.code=code,arrayForEach(objectKeys(attributes),function(attribute){error[attribute]=attributes[attribute]}),error},validate=function(code,check,attributes){if(!check)throw createError(code,attributes)},validatePresence=function(value,name){validate("E_MISSING_PARAMETER","undefined"!=typeof value,{name:name})},validateType=function(value,name,check,expected){validate("E_INVALID_PAR_TYPE",check,{expected:expected,name:name,value:value})},validateTypePath=function(value,name){validateType(value,name,"string"==typeof value||arrayIsArray(value),"String or Array")},isPlainObject=function(obj){return null!==obj&&""+obj=="[object Object]"},validateTypePlainObject=function(value,name){validateType(value,name,"undefined"==typeof value||isPlainObject(value),"Plain Object")},validateTypeString=function(value,name){validateType(value,name,"string"==typeof value,"a string")},resourceGet=function(data,path){var i,node=data,length=path.length;for(i=0;i<length-1;i++)if(node=node[path[i]],!node)return;return node[path[i]]},coreSetAvailableBundles=function(Cldr,json){var bundle,availableBundleMapQueue=Cldr._availableBundleMapQueue,main=resourceGet(json,["main"]);if(main)for(bundle in main)main.hasOwnProperty(bundle)&&"root"!==bundle&&availableBundleMapQueue.push(bundle)},alwaysArray=function(somethingOrArray){return arrayIsArray(somethingOrArray)?somethingOrArray:[somethingOrArray]},jsonMerge=function(){var merge=function(){var destination={},sources=[].slice.call(arguments,0);return arrayForEach(sources,function(source){var prop;for(prop in source)prop in destination&&"object"==typeof destination[prop]&&!arrayIsArray(destination[prop])?destination[prop]=merge(destination[prop],source[prop]):destination[prop]=source[prop]}),destination};return merge}(),coreLoad=function(Cldr,source,jsons){var i,j,json;for(validatePresence(jsons[0],"json"),i=0;i<jsons.length;i++)for(json=alwaysArray(jsons[i]),j=0;j<json.length;j++)validateTypePlainObject(json[j],"json"),source=jsonMerge(source,json[j]),coreSetAvailableBundles(Cldr,json[j]);return source},itemGetResolved=function(Cldr,path,attributes){var normalizedPath=pathNormalize(path,attributes);return resourceGet(Cldr._resolved,normalizedPath)},Cldr=function(locale){this.init(locale)};return Cldr._alwaysArray=alwaysArray,Cldr._coreLoad=coreLoad,Cldr._createError=createError,Cldr._itemGetResolved=itemGetResolved,Cldr._jsonMerge=jsonMerge,Cldr._pathNormalize=pathNormalize,Cldr._resourceGet=resourceGet,Cldr._validatePresence=validatePresence,Cldr._validateType=validateType,Cldr._validateTypePath=validateTypePath,Cldr._validateTypePlainObject=validateTypePlainObject,Cldr._availableBundleMap={},Cldr._availableBundleMapQueue=[],Cldr._resolved={},Cldr.localeSep="-",Cldr.load=function(){Cldr._resolved=coreLoad(Cldr,Cldr._resolved,arguments)},Cldr.prototype.init=function(locale){var attributes,language,maxLanguageId,minLanguageId,script,subtags,territory,unicodeLocaleExtensions,variant,sep=Cldr.localeSep;validatePresence(locale,"locale"),validateTypeString(locale,"locale"),subtags=coreSubtags(locale),unicodeLocaleExtensions=subtags[4],variant=subtags[3],maxLanguageId=coreLikelySubtags(Cldr,this,subtags,{force:!0})||subtags,language=maxLanguageId[0],script=maxLanguageId[1],territory=maxLanguageId[2],minLanguageId=coreRemoveLikelySubtags(Cldr,this,maxLanguageId).join(sep),this.attributes=attributes={bundle:bundleLookup(Cldr,this,minLanguageId),minlanguageId:minLanguageId,maxLanguageId:maxLanguageId.join(sep),language:language,script:script,territory:territory,region:territory,variant:variant},unicodeLocaleExtensions&&("-"+unicodeLocaleExtensions).replace(/-[a-z]{3,8}|(-[a-z]{2})-([a-z]{3,8})/g,function(attribute,key,type){key?attributes["u"+key]=type:attributes["u"+attribute]=!0}),this.locale=locale},Cldr.prototype.get=function(path){return validatePresence(path,"path"),validateTypePath(path,"path"),itemGetResolved(Cldr,path,this.attributes)},Cldr.prototype.main=function(path){return validatePresence(path,"path"),validateTypePath(path,"path"),validate("E_MISSING_BUNDLE",null!==this.attributes.bundle,{locale:this.locale}),path=alwaysArray(path),this.get(["main/{bundle}"].concat(path))},Cldr}),function(factory){"function"==typeof define&&define.amd?define(["../cldr"],factory):"object"==typeof module&&"object"==typeof module.exports?module.exports=factory(require("cldrjs")):factory(Cldr)}(function(Cldr){function validateTypeEvent(value,name){validateType(value,name,"string"==typeof value||value instanceof RegExp,"String or RegExp")}function validateThenCall(method,self){return function(event,listener){return validatePresence(event,"event"),validateTypeEvent(event,"event"),validatePresence(listener,"listener"),validateTypeFunction(listener,"listener"),self[method].apply(self,arguments)}}function off(self){return validateThenCall("off",self)}function on(self){return validateThenCall("on",self)}function once(self){return validateThenCall("once",self)}function getOverload(){superGet=Cldr.prototype.get,Cldr.prototype.get=function(path){var value=superGet.apply(this,arguments);return path=pathNormalize(path,this.attributes).join("/"),globalEe.trigger("get",[path,value]),this.ee.trigger("get",[path,value]),value}}var EventEmitter,pathNormalize=Cldr._pathNormalize,validatePresence=Cldr._validatePresence,validateType=Cldr._validateType;EventEmitter=function(){function EventEmitter(){}function indexOfListener(listeners,listener){for(var i=listeners.length;i--;)if(listeners[i].listener===listener)return i;return-1}function alias(name){return function(){return this[name].apply(this,arguments)}}var proto=EventEmitter.prototype,exports=this,originalGlobalValue=exports.EventEmitter;return proto.getListeners=function(evt){var response,key,events=this._getEvents();if(evt instanceof RegExp){response={};for(key in events)events.hasOwnProperty(key)&&evt.test(key)&&(response[key]=events[key])}else response=events[evt]||(events[evt]=[]);return response},proto.flattenListeners=function(listeners){var i,flatListeners=[];for(i=0;i<listeners.length;i+=1)flatListeners.push(listeners[i].listener);return flatListeners},proto.getListenersAsObject=function(evt){var response,listeners=this.getListeners(evt);return listeners instanceof Array&&(response={},response[evt]=listeners),response||listeners},proto.addListener=function(evt,listener){var key,listeners=this.getListenersAsObject(evt),listenerIsWrapped="object"==typeof listener;for(key in listeners)listeners.hasOwnProperty(key)&&indexOfListener(listeners[key],listener)===-1&&listeners[key].push(listenerIsWrapped?listener:{
listener:listener,once:!1});return this},proto.on=alias("addListener"),proto.addOnceListener=function(evt,listener){return this.addListener(evt,{listener:listener,once:!0})},proto.once=alias("addOnceListener"),proto.defineEvent=function(evt){return this.getListeners(evt),this},proto.defineEvents=function(evts){for(var i=0;i<evts.length;i+=1)this.defineEvent(evts[i]);return this},proto.removeListener=function(evt,listener){var index,key,listeners=this.getListenersAsObject(evt);for(key in listeners)listeners.hasOwnProperty(key)&&(index=indexOfListener(listeners[key],listener),index!==-1&&listeners[key].splice(index,1));return this},proto.off=alias("removeListener"),proto.addListeners=function(evt,listeners){return this.manipulateListeners(!1,evt,listeners)},proto.removeListeners=function(evt,listeners){return this.manipulateListeners(!0,evt,listeners)},proto.manipulateListeners=function(remove,evt,listeners){var i,value,single=remove?this.removeListener:this.addListener,multiple=remove?this.removeListeners:this.addListeners;if("object"!=typeof evt||evt instanceof RegExp)for(i=listeners.length;i--;)single.call(this,evt,listeners[i]);else for(i in evt)evt.hasOwnProperty(i)&&(value=evt[i])&&("function"==typeof value?single.call(this,i,value):multiple.call(this,i,value));return this},proto.removeEvent=function(evt){var key,type=typeof evt,events=this._getEvents();if("string"===type)delete events[evt];else if(evt instanceof RegExp)for(key in events)events.hasOwnProperty(key)&&evt.test(key)&&delete events[key];else delete this._events;return this},proto.removeAllListeners=alias("removeEvent"),proto.emitEvent=function(evt,args){var listener,i,key,response,listeners=this.getListenersAsObject(evt);for(key in listeners)if(listeners.hasOwnProperty(key))for(i=listeners[key].length;i--;)listener=listeners[key][i],listener.once===!0&&this.removeListener(evt,listener.listener),response=listener.listener.apply(this,args||[]),response===this._getOnceReturnValue()&&this.removeListener(evt,listener.listener);return this},proto.trigger=alias("emitEvent"),proto.emit=function(evt){var args=Array.prototype.slice.call(arguments,1);return this.emitEvent(evt,args)},proto.setOnceReturnValue=function(value){return this._onceReturnValue=value,this},proto._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},proto._getEvents=function(){return this._events||(this._events={})},EventEmitter.noConflict=function(){return exports.EventEmitter=originalGlobalValue,EventEmitter},EventEmitter}();var superGet,superInit,validateTypeFunction=function(value,name){validateType(value,name,"undefined"==typeof value||"function"==typeof value,"Function")},globalEe=new EventEmitter;return Cldr.off=off(globalEe),Cldr.on=on(globalEe),Cldr.once=once(globalEe),superInit=Cldr.prototype.init,Cldr.prototype.init=function(){var ee;this.ee=ee=new EventEmitter,this.off=off(ee),this.on=on(ee),this.once=once(ee),superInit.apply(this,arguments)},Cldr._eventInit=getOverload,getOverload(),Cldr}),function(factory){"function"==typeof define&&define.amd?define(["../cldr"],factory):"object"==typeof module&&"object"==typeof module.exports?module.exports=factory(require("cldrjs")):factory(Cldr)}(function(Cldr){var alwaysArray=Cldr._alwaysArray,supplementalMain=function(cldr){var prepend,supplemental;return prepend=function(prepend){return function(path){return path=alwaysArray(path),cldr.get([prepend].concat(path))}},supplemental=prepend("supplemental"),supplemental.weekData=prepend("supplemental/weekData"),supplemental.weekData.firstDay=function(){return cldr.get("supplemental/weekData/firstDay/{territory}")||cldr.get("supplemental/weekData/firstDay/001")},supplemental.weekData.minDays=function(){var minDays=cldr.get("supplemental/weekData/minDays/{territory}")||cldr.get("supplemental/weekData/minDays/001");return parseInt(minDays,10)},supplemental.timeData=prepend("supplemental/timeData"),supplemental.timeData.allowed=function(){return cldr.get("supplemental/timeData/{territory}/_allowed")||cldr.get("supplemental/timeData/001/_allowed")},supplemental.timeData.preferred=function(){return cldr.get("supplemental/timeData/{territory}/_preferred")||cldr.get("supplemental/timeData/001/_preferred")},supplemental},initSuper=Cldr.prototype.init;return Cldr.prototype.init=function(){initSuper.apply(this,arguments),this.supplemental=supplementalMain(this)},Cldr}),function(root,factory){"function"==typeof define&&define.amd?define(["cldr","cldr/event"],factory):"object"==typeof exports?module.exports=factory(require("cldrjs")):root.Globalize=factory(root.Cldr)}(this,function(Cldr){function validateLikelySubtags(cldr){cldr.once("get",validateCldr),cldr.get("supplemental/likelySubtags")}function Globalize(locale){return this instanceof Globalize?(validateParameterPresence(locale,"locale"),validateParameterTypeLocale(locale,"locale"),this.cldr=alwaysCldr(locale),void validateLikelySubtags(this.cldr)):new Globalize(locale)}var toString=function(variable){return"string"==typeof variable?variable:"number"==typeof variable?""+variable:JSON.stringify(variable)},formatMessage=function(message,data){return message=message.replace(/{[0-9a-zA-Z-_. ]+}/g,function(name){return name=name.replace(/^{([^}]*)}$/,"$1"),toString(data[name])})},objectExtend=function(){var destination=arguments[0],sources=[].slice.call(arguments,1);return sources.forEach(function(source){var prop;for(prop in source)destination[prop]=source[prop]}),destination},createError=function(code,message,attributes){var error;return message=code+(message?": "+formatMessage(message,attributes):""),error=new Error(message),error.code=code,objectExtend(error,attributes),error},stringHash=function(str){return[].reduce.call(str,function(hash,i){var chr=i.charCodeAt(0);return hash=(hash<<5)-hash+chr,0|hash},0)},runtimeKey=function(fnName,locale,args,argsStr){var hash;return argsStr=argsStr||JSON.stringify(args),hash=stringHash(fnName+locale+argsStr),hash>0?"a"+hash:"b"+Math.abs(hash)},runtimeBind=function(args,cldr,fn,runtimeArgs){var argsStr=JSON.stringify(args),locale=cldr.locale;return fn.runtimeKey=runtimeKey(fn.name,locale,null,argsStr),fn.generatorString=function(){return'Globalize("'+locale+'").'+fn.name+"("+argsStr.slice(1,-1)+")"},fn.runtimeArgs=runtimeArgs,fn},validate=function(code,message,check,attributes){if(!check)throw createError(code,message,attributes)},alwaysArray=function(stringOrArray){return Array.isArray(stringOrArray)?stringOrArray:stringOrArray?[stringOrArray]:[]},validateCldr=function(path,value,options){var skipBoolean;options=options||{},skipBoolean=alwaysArray(options.skip).some(function(pathRe){return pathRe.test(path)}),validate("E_MISSING_CLDR","Missing required CLDR content `{path}`.",value||skipBoolean,{path:path})},validateDefaultLocale=function(value){validate("E_DEFAULT_LOCALE_NOT_DEFINED","Default locale has not been defined.",void 0!==value,{})},validateParameterPresence=function(value,name){validate("E_MISSING_PARAMETER","Missing required parameter `{name}`.",void 0!==value,{name:name})},validateParameterRange=function(value,name,minimum,maximum){validate("E_PAR_OUT_OF_RANGE","Parameter `{name}` has value `{value}` out of range [{minimum}, {maximum}].",void 0===value||value>=minimum&&value<=maximum,{maximum:maximum,minimum:minimum,name:name,value:value})},validateParameterType=function(value,name,check,expected){validate("E_INVALID_PAR_TYPE","Invalid `{name}` parameter ({value}). {expected} expected.",check,{expected:expected,name:name,value:value})},validateParameterTypeLocale=function(value,name){validateParameterType(value,name,void 0===value||"string"==typeof value||value instanceof Cldr,"String or Cldr instance")},isPlainObject=function(obj){return null!==obj&&""+obj=="[object Object]"},validateParameterTypePlainObject=function(value,name){validateParameterType(value,name,void 0===value||isPlainObject(value),"Plain Object")},alwaysCldr=function(localeOrCldr){return localeOrCldr instanceof Cldr?localeOrCldr:new Cldr(localeOrCldr)},regexpEscape=function(string){return string.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},stringPad=function(str,count,right){var length;for("string"!=typeof str&&(str=String(str)),length=str.length;length<count;length+=1)str=right?str+"0":"0"+str;return str};return Globalize.load=function(){Cldr.load.apply(Cldr,arguments)},Globalize.locale=function(locale){return validateParameterTypeLocale(locale,"locale"),arguments.length&&(this.cldr=alwaysCldr(locale),validateLikelySubtags(this.cldr)),this.cldr},Globalize._alwaysArray=alwaysArray,Globalize._createError=createError,Globalize._formatMessage=formatMessage,Globalize._isPlainObject=isPlainObject,Globalize._objectExtend=objectExtend,Globalize._regexpEscape=regexpEscape,Globalize._runtimeBind=runtimeBind,Globalize._stringPad=stringPad,Globalize._validate=validate,Globalize._validateCldr=validateCldr,Globalize._validateDefaultLocale=validateDefaultLocale,Globalize._validateParameterPresence=validateParameterPresence,Globalize._validateParameterRange=validateParameterRange,Globalize._validateParameterTypePlainObject=validateParameterTypePlainObject,Globalize._validateParameterType=validateParameterType,Globalize}),!function(a,b){"function"==typeof define&&define.amd?define(["cldr","../globalize","cldr/event","cldr/supplemental"],b):"object"==typeof exports?module.exports=b(require("cldrjs"),require("globalize")):b(a.Cldr,a.Globalize)}(this,function(a,b){function M(a){var b=a[2],c=a[3],d=a[4],e=a[5],f=a[6];if(isNaN(e*f)){if(!isNaN(e)||!isNaN(f))throw new Error("Neither or both the minimum and maximum significant digits must be present");k(b,"minimumIntegerDigits",1,21),k(c,"minimumFractionDigits",0,20),k(d,"maximumFractionDigits",c,20)}else k(e,"minimumSignificantDigits",1,21),k(f,"maximumSignificantDigits",e,21)}var c=b._createError,d=b._objectExtend,e=b._regexpEscape,f=b._runtimeBind,g=b._stringPad,h=b._validateCldr,i=b._validateDefaultLocale,j=b._validateParameterPresence,k=b._validateParameterRange,l=b._validateParameterType,m=b._validateParameterTypePlainObject,n=function(a){return c("E_UNSUPPORTED","Unsupported {feature}.",{feature:a})},o=function(a,b){l(a,b,void 0===a||"number"==typeof a,"Number")},p=function(a,b){l(a,b,void 0===a||"string"==typeof a,"a string")},q=function(a,b,c){var d,e=b,f="",g=",",h=!!c;for(a=String(a).split("."),d=a[0].length;d>e;)f=a[0].slice(d-e,d)+(f.length?g:"")+f,d-=e,h&&(e=c,h=!1);return a[0]=a[0].slice(0,d)+(f.length?g:"")+f,a.join(".")},r=function(a,b,c,d,e,f){return d?(a=f?e(a,f):e(a,{exponent:-d}),c&&(a=String(a).split("."),a[1]=g(a[1]||"",c,!0),a=a.join("."))):a=e(a),a=String(a),b&&(a=a.split("."),a[0]=g(a[0],b),a=a.join(".")),a},s=function(a,b,c){var d;return a=a.toPrecision(b+2),d=Math.ceil(Math.log(Math.abs(a))/Math.log(10)),d-=b,c(a,{exponent:d})},t=function(a,b,c,d){var e,f;if(b>c&&(c=b),e=s(a,b,d),f=s(a,c,d),a=+e===+f?e:f,a=(+a).toString(10),/e/.test(a))throw n({feature:"integers out of (1e21, 1e-7)"});return b-a.replace(/^0+|\./g,"").length>0&&(a=a.split("."),a[1]=g(a[1]||"",b-a[0].replace(/^0+/,"").length,!0),a=a.join(".")),a},u=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,s,u,v,w;return k=b[1],g=b[2],f=b[3],d=b[4],h=b[5],e=b[6],s=b[7],m=b[8],u=b[9],p=b[15],c=b[16],i=b[17],w=b[18],j=b[19],isNaN(a)?i:(a<0?(n=b[12],l=b[13],v=b[14]):(n=b[11],l=b[0],v=b[10]),isFinite(a)?(o=l,n.indexOf("%")!==-1?a*=100:n.indexOf("‰")!==-1&&(a*=1e3),a=isNaN(h*e)?r(a,g,f,d,p,s):t(a,h,e,p),a=a.replace(/^-/,""),m&&(a=q(a,m,u)),o+=a,o+=v,o.replace(/('([^']|'')+'|'')|./g,function(a,b){return b?(b=b.replace(/''/,"'"),b.length>2&&(b=b.slice(1,-1)),b):(a=a.replace(/[.,\-+E%\u2030]/,function(a){return w[a]}),j&&(a=a.replace(/[0-9]/,function(a){return j[+a]})),a)})):l+c+v)},v=function(a){return function(c){return j(c,"value"),o(c,"value"),u(c,a)}},w=function(a){var b=a.attributes["u-nu"];return b?("traditio"===b&&(b="traditional"),["native","traditional","finance"].indexOf(b)!==-1?a.main(["numbers/otherNumberingSystems",b]):b):a.main("numbers/defaultNumberingSystem")},x=function(a){var b,c=w(a);if("latn"!==c){if(b=a.supplemental(["numberingSystems",c]),"numeric"!==b._type)throw n("`"+b._type+"` numbering system");return b._digits}},y=/^(('[^']+'|''|[^*#@0,.E])*)(\*.)?((([#,]*[0,]*0+)(\.0*[0-9]*#*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,z=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,o,p,q,r,s,t;if(a=a.match(y),!a)throw new Error("Invalid pattern: "+a);if(m=a[1],l=a[3],e=a[4],s=a[8],q=a[9],t=a[10],s?s.replace(/(@+)(#*)/,function(a,b,c){k=b.length,h=k+c.length}):(d=a[7],f=a[6],d&&(d.replace(/[0-9]+/,function(a){i=a}),i?(p=+("0."+i),i=i.length):i=0,g=d.length-1),f.replace(/0+$/,function(a){j=a.length})),q)throw n({feature:"scientific notation (not implemented)"});if(l)throw n({feature:"padding (not implemented)"});return(b=e.lastIndexOf(","))!==-1&&(c=e.split(".")[0],o=c.length-b-1,(c=e.lastIndexOf(",",b-1))!==-1&&(r=b-1-c)),[m,l,j,i,g,k,h,p,o,r,t]},A=function(a,b){return b.main(["numbers/symbols-numberSystem-"+w(b),a])},B={".":"decimal",",":"group","%":"percentSign","+":"plusSign","-":"minusSign",E:"exponential","‰":"perMille"},C=function(a){var b,c={};for(b in B)c[b]=A(B[b],a);return c},D=function(a){return isNaN(a)?NaN:Math[a<0?"ceil":"floor"](a)},E=function(a){return a=a||"round",a="truncate"===a?D:Math[a],function(b,c){var d,e;if(b=+b,isNaN(b))return NaN;if("object"==typeof c&&c.exponent){if(d=+c.exponent,e=1,0===d)return a(b);if("number"!=typeof d||d%1!==0)return NaN}else{if(e=+c||1,1===e)return a(b);if(isNaN(e))return NaN;e=e.toExponential().split("e"),d=+e[1],e=+e[0]}return b=b.toString().split("e"),b[0]=+b[0]/e,b[1]=b[1]?+b[1]-d:-d,b=a(+(b[0]+"e"+b[1])),b=b.toString().split("e"),b[0]=+b[0]*e,b[1]=b[1]?+b[1]+d:d,+(b[0]+"e"+b[1])}},F=function(a,b,c){function k(a,b){a in c&&(j[b]=c[a])}var d,e,f,g,h,i,j;return c=c||{},a=a.split(";"),h=a[0],d=a[1]||"-"+h,f=z(d),e=f[0],g=f[10],i=E(c.round),i.generatorString=function(){return"numberRound("+(c.round?'"'+c.round+'"':"")+")"},j=z(h).concat([h,e+h+g,e,g,i,A("infinity",b),A("nan",b),C(b),x(b)]),k("minimumIntegerDigits",2),k("minimumFractionDigits",3),k("maximumFractionDigits",4),k("minimumSignificantDigits",5),k("maximumSignificantDigits",6),c.useGrouping===!1&&(j[8]=null),"minimumFractionDigits"in c&&!("maximumFractionDigits"in c)?j[4]=Math.max(j[3],j[4]):!("minimumFractionDigits"in c)&&"maximumFractionDigits"in c&&(j[3]=Math.min(j[3],j[4])),j},G=/^([^0-9]*)(([0-9,]*[0-9]+)(\.[0-9]+)?)(E[+-]?[0-9]+)?([^0-9]*)$/,H=function(a,b){var c,d,f,g,h,i,j,k,l,m,n;if(d=b[0],g=b[1],j=b[2],k=b[3],f=b[4],c=a.match(d))l=1/0,m=a.slice(0,c.length),n=a.slice(c.length+1);else{if(i=new RegExp(Object.keys(g).map(function(a){return e(a)}).join("|"),"g"),a=a.replace(i,function(a){return g[a]}),f&&(h=new RegExp(Object.keys(f).map(function(a){return e(a)}).join("|"),"g"),a=a.replace(h,function(a){return f[a]})),"."===a.charAt(0)&&(a="0"+a),a=a.match(G),!a)return NaN;if(m=a[1],n=a[6],l=a[2].replace(/,/g,""),a[5]&&(l+=a[5]),l=+l,isNaN(l))return NaN;a[0].indexOf("%")!==-1?(l/=100,n=n.replace("%","")):a[0].indexOf("‰")!==-1&&(l/=1e3,n=n.replace("‰",""))}return m===j&&n===k&&(l*=-1),l},I=function(a){return function(c){return j(c,"value"),p(c,"value"),H(c,a)}},J=function(a){var b,c={};for(b in B)c[A(B[b],a)]=b;return c},K=function(a,b){var c,e,f,g,h=x(b);return a=a.split(";"),f=a[1]||"-"+a[0],g=z(f),h&&(c=h.split("").reduce(function(a,b,c){return a[b]=String(c),a},{}),e="0123456789".split("").reduce(function(a,b){return a[b]="invalid",a},{}),c=d(e,c)),[A("infinity",b),d({},B,J(b)),g[0],g[10].replace("%","").replace("‰",""),c]},L=function(a,b){if("decimal"!==a&&"percent"!==a)throw new Error("Invalid style");return b.main(["numbers",a+"Formats-numberSystem-"+w(b),"standard"])};return b.numberFormatter=b.prototype.numberFormatter=function(a){var b,c,d,e,g;return m(a,"options"),a=a||{},c=this.cldr,b=[a],i(c),c.on("get",h),d=a.raw?a.raw:L(a.style||"decimal",c),e=F(d,c,a),c.off("get",h),M(e),g=v(e),f(b,c,g,[e]),g},b.numberParser=b.prototype.numberParser=function(a){var b,c,d,e,g;return m(a,"options"),a=a||{},c=this.cldr,b=[a],i(c),c.on("get",h),d=a.raw?a.raw:L(a.style||"decimal",c),e=K(d,c),c.off("get",h),g=I(e),f(b,c,g,[e]),g},b.formatNumber=b.prototype.formatNumber=function(a,b){return j(a,"value"),o(a,"value"),this.numberFormatter(b)(a)},b.parseNumber=b.prototype.parseNumber=function(a,b){return j(a,"value"),p(a,"value"),this.numberParser(b)(a)},b._createErrorUnsupportedFeature=n,b._numberNumberingSystem=w,b._numberPattern=L,b._numberSymbol=A,b._stringPad=g,b._validateParameterTypeNumber=o,b._validateParameterTypeString=p,b}),function(a,b){"function"==typeof define&&define.amd?define(["cldr","../globalize","./number","cldr/event","cldr/supplemental"],b):"object"==typeof exports?module.exports=b(require("cldrjs"),require("globalize")):b(a.Cldr,a.Globalize)}(this,function(a,b){function P(a,b){j(a,b,{skip:[/dates\/calendars\/gregorian\/dateTimeFormats\/availableFormats/,/dates\/calendars\/gregorian\/days\/.*\/short/,/supplemental\/timeData\/(?!001)/,/supplemental\/weekData\/(?!001)/]})}var c=b._createError,d=b._createErrorUnsupportedFeature,e=b._formatMessage,f=b._numberSymbol,g=b._regexpEscape,h=b._runtimeBind,i=b._stringPad,j=b._validateCldr,k=b._validateDefaultLocale,l=b._validateParameterPresence,m=b._validateParameterType,n=b._validateParameterTypePlainObject,o=b._validateParameterTypeString,p=function(a,b){m(a,b,void 0===a||a instanceof Date,"Date")},q=function(a,b){return c("E_INVALID_PAR_VALUE","Invalid `{name}` value ({value}).",{name:a,value:b})},r=function(a,b){function i(a,c,d){return e(b.main(["dates/calendars/gregorian/dateTimeFormats",a]),[d,c])}var c,d,f,g,h;switch(!0){case"skeleton"in a:f=a.skeleton,d=b.main(["dates/calendars/gregorian/dateTimeFormats/availableFormats",f]),d||(g=f.split(/[^hHKkmsSAzZOvVXx]/).slice(-1)[0],c=f.split(/[^GyYuUrQqMLlwWdDFgEec]/)[0],h=/(MMMM|LLLL).*[Ec]/.test(c)?"full":/MMMM/g.test(c)?"long":/MMM/g.test(c)||/LLL/g.test(c)?"medium":"short",d=i(h,b.main(["dates/calendars/gregorian/dateTimeFormats/availableFormats",c]),b.main(["dates/calendars/gregorian/dateTimeFormats/availableFormats",g])));break;case"date"in a:case"time"in a:d=b.main(["dates/calendars/gregorian","date"in a?"dateFormats":"timeFormats",a.date||a.time]);break;case"datetime"in a:d=i(a.datetime,b.main(["dates/calendars/gregorian/dateFormats",a.datetime]),b.main(["dates/calendars/gregorian/timeFormats",a.datetime]));break;case"raw"in a:d=a.raw;break;default:throw q({name:"options",value:a})}return d},s=function(a,b){return(a.getDay()-b+7)%7},t=function(a,b){var c=864e5;return(b.getTime()-a.getTime())/c},u=function(a,b){switch(a=new Date(a.getTime()),b){case"year":a.setMonth(0);case"month":a.setDate(1);case"day":a.setHours(0);case"hour":a.setMinutes(0);case"minute":a.setSeconds(0);case"second":a.setMilliseconds(0)}return a},v=function(a){return Math.floor(t(u(a,"year"),a))},w=function(a){return a-u(a,"day")},x=/([a-z])\1*|'([^']|'')+'|''|./gi,y=function(a,b,c,d){var e,f=a.getTimezoneOffset();return e=Math.abs(f),d=d||{1:function(a){return i(a,1)},2:function(a){return i(a,2)}},b.split(";")[f>0?1:0].replace(":",c).replace(/HH?/,function(a){return d[a.length](Math.floor(e/60))}).replace(/mm/,function(){return d[2](e%60)})},z=["sun","mon","tue","wed","thu","fri","sat"],A=function(a,b,c){var d=c.timeSeparator;return c.pattern.replace(x,function(e){var f,g=e.charAt(0),h=e.length;switch("j"===g&&(g=c.preferredTime),"Z"===g&&(h<4?(g="x",h=4):h<5?(g="O",h=4):(g="X",h=5)),g){case"G":f=c.eras[a.getFullYear()<0?0:1];break;case"y":f=a.getFullYear(),2===h&&(f=String(f),f=+f.substr(f.length-2));break;case"Y":f=new Date(a.getTime()),f.setDate(f.getDate()+7-s(a,c.firstDay)-c.firstDay-c.minDays),f=f.getFullYear(),2===h&&(f=String(f),f=+f.substr(f.length-2));break;case"Q":case"q":f=Math.ceil((a.getMonth()+1)/3),h>2&&(f=c.quarters[g][h][f]);break;case"M":case"L":f=a.getMonth()+1,h>2&&(f=c.months[g][h][f]);break;case"w":f=s(u(a,"year"),c.firstDay),f=Math.ceil((v(a)+f)/7)-(7-f>=c.minDays?0:1);break;case"W":f=s(u(a,"month"),c.firstDay),f=Math.ceil((a.getDate()+f)/7)-(7-f>=c.minDays?0:1);break;case"d":f=a.getDate();break;case"D":f=v(a)+1;break;case"F":f=Math.floor(a.getDate()/7)+1;break;case"e":case"c":if(h<=2){f=s(a,c.firstDay)+1;break}case"E":f=z[a.getDay()],f=c.days[g][h][f];break;case"a":f=c.dayPeriods[a.getHours()<12?"am":"pm"];break;case"h":f=a.getHours()%12||12;break;case"H":f=a.getHours();break;case"K":f=a.getHours()%12;break;case"k":f=a.getHours()||24;break;case"m":f=a.getMinutes();break;case"s":f=a.getSeconds();break;case"S":f=Math.round(a.getMilliseconds()*Math.pow(10,h-3));break;case"A":f=Math.round(w(a)*Math.pow(10,h-3));break;case"z":case"O":0===a.getTimezoneOffset()?f=c.gmtZeroFormat:(f=y(a,h<4?"+H;-H":c.tzLongHourFormat,d,b),f=c.gmtFormat.replace(/\{0\}/,f));break;case"X":if(0===a.getTimezoneOffset()){f="Z";break}case"x":f=1===h?"+HH;-HH":h%2?"+HH:mm;-HH:mm":"+HHmm;-HHmm",f=y(a,f,":");break;case":":f=d;break;case"'":e=e.replace(/''/,"'"),h>2&&(e=e.slice(1,-1)),f=e;break;default:f=e}return"number"==typeof f&&(f=b[h](f)),f})},B=function(a,b){return function(d){return l(d,"value"),p(d,"value"),A(d,a,b)}},C=function(a){return z.indexOf(a.supplemental.weekData.firstDay())},D=function(a,b){function g(a){c.numberFormatters[a]=i("",a)}var c={numberFormatters:{},pattern:a,timeSeparator:f("timeSeparator",b)},e=["abbreviated","wide","narrow"];return a.replace(x,function(a){var f,h=a.charAt(0),i=a.length;switch("j"===h&&(c.preferredTime=h=b.supplemental.timeData.preferred()),"Z"===h&&4===i&&(h="O",i=4),h){case"G":c.eras=b.main(["dates/calendars/gregorian/eras",i<=3?"eraAbbr":4===i?"eraNames":"eraNarrow"]);break;case"y":f=!0;break;case"Y":c.firstDay=C(b),c.minDays=b.supplemental.weekData.minDays(),f=!0;break;case"u":case"U":throw d({feature:"year pattern `"+h+"`"});case"Q":case"q":i>2?(c.quarters||(c.quarters={}),c.quarters[h]||(c.quarters[h]={}),c.quarters[h][i]=b.main(["dates/calendars/gregorian/quarters","Q"===h?"format":"stand-alone",e[i-3]])):f=!0;break;case"M":case"L":i>2?(c.months||(c.months={}),c.months[h]||(c.months[h]={}),c.months[h][i]=b.main(["dates/calendars/gregorian/months","M"===h?"format":"stand-alone",e[i-3]])):f=!0;break;case"w":case"W":c.firstDay=C(b),c.minDays=b.supplemental.weekData.minDays(),f=!0;break;case"d":case"D":case"F":f=!0;break;case"g":throw d({feature:"Julian day pattern `g`"});case"e":case"c":if(i<=2){c.firstDay=C(b),f=!0;break}case"E":c.days||(c.days={}),c.days[h]||(c.days[h]={}),6===i?c.days[h][i]=b.main(["dates/calendars/gregorian/days","c"===h?"stand-alone":"format","short"])||b.main(["dates/calendars/gregorian/days","c"===h?"stand-alone":"format","abbreviated"]):c.days[h][i]=b.main(["dates/calendars/gregorian/days","c"===h?"stand-alone":"format",e[i<3?0:i-3]]);break;case"a":c.dayPeriods=b.main("dates/calendars/gregorian/dayPeriods/format/wide");break;case"h":case"H":case"K":case"k":case"m":case"s":case"S":case"A":f=!0;break;case"z":case"O":c.gmtFormat=b.main("dates/timeZoneNames/gmtFormat"),c.gmtZeroFormat=b.main("dates/timeZoneNames/gmtZeroFormat"),c.tzLongHourFormat=b.main("dates/timeZoneNames/hourFormat");case"Z":case"X":case"x":g(1),g(2);break;case"v":case"V":throw d({feature:"timezone pattern `"+h+"`"})}f&&g(i)}),c},E=function(a){return 1===new Date(a,1,29).getMonth()},F=function(a){return new Date(a.getFullYear(),a.getMonth()+1,0).getDate()},G=function(a,b){var c=new Date(a.getFullYear(),a.getMonth()+1,0).getDate();a.setDate(b<1?1:b<c?b:c)},H=function(a,b){var c=a.getDate();a.setDate(1),a.setMonth(b),G(a,c)},I=function(a,b,c){return a<b||a>c},J=function(a,b,c){var e,f,g,h,i,j,k,l,m=0,n=1,o=2,p=3,q=4,r=5,s=6,t=new Date,v=[],w=["year","month","day","hour","minute","second","milliseconds"];if(!b.length)return null;if(l=b.every(function(a){var b,l,u,w;if("literal"===a.type)return!0;switch(l=a.type.charAt(0),w=a.type.length,"j"===l&&(l=c.preferredTimeData),l){case"G":v.push(m),h=+a.value;break;case"y":if(u=a.value,2===w){if(I(u,0,99))return!1;b=100*Math.floor(t.getFullYear()/100),u+=b,u>t.getFullYear()+20&&(u-=100)}t.setFullYear(u),v.push(m);break;case"Y":throw d({feature:"year pattern `"+l+"`"});case"Q":case"q":break;case"M":case"L":if(u=w<=2?a.value:+a.value,I(u,1,12))return!1;H(t,u-1),v.push(n);break;case"w":case"W":break;case"d":f=a.value,v.push(o);break;case"D":g=a.value,v.push(o);break;case"F":break;case"e":case"c":case"E":break;case"a":e=a.value;break;case"h":if(u=a.value,I(u,1,12))return!1;i=j=!0,t.setHours(12===u?0:u),v.push(p);break;case"K":if(u=a.value,I(u,0,11))return!1;i=j=!0,t.setHours(u),v.push(p);break;case"k":if(u=a.value,I(u,1,24))return!1;i=!0,t.setHours(24===u?0:u),v.push(p);break;case"H":if(u=a.value,I(u,0,23))return!1;i=!0,t.setHours(u),v.push(p);break;case"m":if(u=a.value,I(u,0,59))return!1;t.setMinutes(u),v.push(q);break;case"s":if(u=a.value,I(u,0,59))return!1;t.setSeconds(u),v.push(r);break;case"A":t.setHours(0),t.setMinutes(0),t.setSeconds(0);case"S":u=Math.round(a.value*Math.pow(10,3-w)),t.setMilliseconds(u),v.push(s);break;case"Z":case"z":case"O":case"X":case"x":k=a.value-t.getTimezoneOffset()}return!0}),!l)return null;if(i&&!(!e^j))return null;if(0===h&&t.setFullYear(t.getFullYear()*-1+1),void 0!==f){if(I(f,1,F(t)))return null;t.setDate(f)}else if(void 0!==g){if(I(g,1,E(t.getFullYear())?366:365))return null;t.setMonth(0),t.setDate(g)}return j&&"pm"===e&&t.setHours(t.getHours()+12),k&&t.setMinutes(t.getMinutes()+k),v=Math.max.apply(null,v),t=u(t,w[v])},K=/[0-9\xB2\xB3\xB9\xBC-\xBE\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u09F4-\u09F9\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0B72-\u0B77\u0BE6-\u0BF2\u0C66-\u0C6F\u0C78-\u0C7E\u0CE6-\u0CEF\u0D66-\u0D75\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F33\u1040-\u1049\u1090-\u1099\u1369-\u137C\u16EE-\u16F0\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1946-\u194F\u19D0-\u19DA\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\u2070\u2074-\u2079\u2080-\u2089\u2150-\u2182\u2185-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2CFD\u3007\u3021-\u3029\u3038-\u303A\u3192-\u3195\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\uA620-\uA629\uA6E6-\uA6EF\uA830-\uA835\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19]|\uD800[\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDEE1-\uDEFB\uDF20-\uDF23\uDF41\uDF4A\uDFD1-\uDFD5]|\uD801[\uDCA0-\uDCA9]|\uD802[\uDC58-\uDC5F\uDC79-\uDC7F\uDCA7-\uDCAF\uDD16-\uDD1B\uDE40-\uDE47\uDE7D\uDE7E\uDE9D-\uDE9F\uDEEB-\uDEEF\uDF58-\uDF5F\uDF78-\uDF7F\uDFA9-\uDFAF]|\uD803[\uDE60-\uDE7E]|\uD804[\uDC52-\uDC6F\uDCF0-\uDCF9\uDD36-\uDD3F\uDDD0-\uDDD9\uDDE1-\uDDF4\uDEF0-\uDEF9]|\uD805[\uDCD0-\uDCD9\uDE50-\uDE59\uDEC0-\uDEC9]|\uD806[\uDCE0-\uDCF2]|\uD809[\uDC00-\uDC6E]|\uD81A[\uDE60-\uDE69\uDF50-\uDF59\uDF5B-\uDF61]|\uD834[\uDF60-\uDF71]|\uD835[\uDFCE-\uDFFF]|\uD83A[\uDCC7-\uDCCF]|\uD83C[\uDD00-\uDD0C]/,L=function(a,b,c){var d,e=c.timeSeparator,f=[],h=["abbreviated","wide","narrow"];return d=c.pattern.match(x).every(function(d){function n(b,c){var d=a.match(b);return c=c||function(a){return+a},!!d&&(d.length<8?m.value=60*(d[1]?-c(d[1]):c(d[4])):m.value=60*(d[1]?-c(d[1]):c(d[7]))+(d[1]?-c(d[4]):c(d[10])),!0)}function o(a,b,c){var d;return b||(b="{0}"),d=a.replace("+","\\+").replace(/HH|mm/g,"(("+K.source+")("+K.source+"))").replace(/H|m/g,"(("+K.source+")("+K.source+")?)"),c&&(d=d.replace(/:/g,c)),d=d.split(";").map(function(a){return b.replace("{0}",a)}).join("|"),new RegExp(d)}function p(){if(1===j)return k=!0,l=K}function q(){if(1===j)return k=!0,l=new RegExp("("+K.source+")("+K.source+")?")}function r(){if(2===j)return k=!0,l=new RegExp("("+K.source+")("+K.source+")")}function s(b){var d,e,f=c[b.join("/")];for(d in f)if(e=new RegExp("^"+f[d]),e.test(a))return m.value=d,l=new RegExp(f[d]);return null}var i,j,k,l,m={};switch(m.type=d,i=d.charAt(0),j=d.length,"Z"===i&&(j<4?(i="x",j=4):j<5?(i="O",j=4):(i="X",j=5)),i){case"G":s(["gregorian/eras",j<=3?"eraAbbr":4===j?"eraNames":"eraNarrow"]);break;case"y":case"Y":k=!0,l=1===j?new RegExp("("+K.source+")+"):2===j?new RegExp("("+K.source+")("+K.source+")"):new RegExp("("+K.source+"){"+j+",}");break;case"Q":case"q":p()||r()||s(["gregorian/quarters","Q"===i?"format":"stand-alone",h[j-3]]);break;case"M":case"L":q()||r()||s(["gregorian/months","M"===i?"format":"stand-alone",h[j-3]]);break;case"D":j<=3&&(k=!0,l=new RegExp("("+K.source+"){"+j+",3}"));break;case"W":case"F":p();break;case"e":case"c":if(j<=2){p()||r();break}case"E":6===j?s(["gregorian/days",["c"===i?"stand-alone":"format"],"short"])||s(["gregorian/days",["c"===i?"stand-alone":"format"],"abbreviated"]):s(["gregorian/days",["c"===i?"stand-alone":"format"],h[j<3?0:j-3]]);break;case"a":s(["gregorian/dayPeriods/format/wide"]);break;case"w":case"d":case"h":case"H":case"K":case"k":case"j":case"m":case"s":q()||r();break;case"S":k=!0,l=new RegExp("("+K.source+"){"+j+"}");break;case"A":k=!0,l=new RegExp("("+K.source+"){"+(j+5)+"}");break;case"z":case"O":if(a===c["timeZoneNames/gmtZeroFormat"])m.value=0,l=new RegExp(c["timeZoneNames/gmtZeroFormat"]);else if(l=o(j<4?"+H;-H":c["timeZoneNames/hourFormat"],c["timeZoneNames/gmtFormat"],e),!n(l,b))return null;break;case"X":if("Z"===a){m.value=0,l=/Z/;break}case"x":if(l=o(1===j?"+HH;-HH":j%2?"+HH:mm;-HH:mm":"+HHmm;-HHmm"),!n(l))return null;break;case"'":m.type="literal",d=d.replace(/''/,"'"),j>2&&(d=d.slice(1,-1)),l=new RegExp(g(d));break;default:m.type="literal",l=/./}return!!l&&(a=a.replace(new RegExp("^"+l.source),function(a){return m.lexeme=a,k&&(m.value=b(a)),""}),!!m.lexeme&&(f.push(m),!0))}),d?f:[]},M=function(a,b,c){return function(e){var f;return l(e,"value"),o(e,"value"),f=L(e,a,c),J(e,f,b)||null}},N=function(a){return{preferredTimeData:a.supplemental.timeData.preferred()}},O=function(a,b){function g(a,b){c[a.replace(/^.*\/dates\//,"").replace(/calendars\//,"")]=b}var c={pattern:a,timeSeparator:f("timeSeparator",b)},e=["abbreviated","wide","narrow"];return b.on("get",g),a.match(x).forEach(function(a){var c,f;switch(c=a.charAt(0),f=a.length,"Z"===c&&f<5&&(c="O",f=4),c){case"G":b.main(["dates/calendars/gregorian/eras",f<=3?"eraAbbr":4===f?"eraNames":"eraNarrow"]);break;case"u":case"U":throw d({feature:"year pattern `"+c+"`"});case"Q":case"q":f>2&&b.main(["dates/calendars/gregorian/quarters","Q"===c?"format":"stand-alone",e[f-3]]);break;case"M":case"L":f>2&&b.main(["dates/calendars/gregorian/months","M"===c?"format":"stand-alone",e[f-3]]);break;case"g":throw d({feature:"Julian day pattern `g`"});case"e":case"c":if(f<=2)break;case"E":6===f?b.main(["dates/calendars/gregorian/days",["c"===c?"stand-alone":"format"],"short"])||b.main(["dates/calendars/gregorian/days",["c"===c?"stand-alone":"format"],"abbreviated"]):b.main(["dates/calendars/gregorian/days",["c"===c?"stand-alone":"format"],e[f<3?0:f-3]]);break;case"a":b.main(["dates/calendars/gregorian/dayPeriods/format/wide"]);break;case"z":case"O":b.main("dates/timeZoneNames/gmtFormat"),b.main("dates/timeZoneNames/gmtZeroFormat"),b.main("dates/timeZoneNames/hourFormat");break;case"v":case"V":throw d({feature:"timezone pattern `"+c+"`"})}}),b.off("get",g),c};return b.dateFormatter=b.prototype.dateFormatter=function(a){var b,c,d,e,f,g,i;n(a,"options"),c=this.cldr,a=a||{skeleton:"yMd"},b=[a],k(c),c.on("get",P),f=r(a,c),g=D(f,c),c.off("get",P),d=g.numberFormatters,delete g.numberFormatters;for(e in d)d[e]=this.numberFormatter({raw:d[e]});return i=B(d,g),h(b,c,i,[d,g]),i},b.dateParser=b.prototype.dateParser=function(a){var b,c,d,e,f,g,i;return n(a,"options"),c=this.cldr,a=a||{skeleton:"yMd"},b=[a],k(c),c.on("get",P),f=r(a,c),g=O(f,c),e=N(c),c.off("get",P),d=this.numberParser({raw:"0"}),i=M(d,e,g),h(b,c,i,[d,e,g]),i},b.formatDate=b.prototype.formatDate=function(a,b){return l(a,"value"),p(a,"value"),this.dateFormatter(b)(a)},b.parseDate=b.prototype.parseDate=function(a,b){return l(a,"value"),o(a,"value"),this.dateParser(b)(a)},b}),!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{
var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.io=e()}}(function(){var define;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){module.exports=_dereq_("./lib/")},{"./lib/":2}],2:[function(_dereq_,module,exports){function lookup(uri,opts){"object"==typeof uri&&(opts=uri,uri=void 0),opts=opts||{};var io,parsed=url(uri),source=parsed.source,id=parsed.id;return opts.forceNew||opts["force new connection"]||!1===opts.multiplex?(debug("ignoring socket cache for %s",source),io=Manager(source,opts)):(cache[id]||(debug("new io instance for %s",source),cache[id]=Manager(source,opts)),io=cache[id]),io.socket(parsed.path)}var url=_dereq_("./url"),parser=_dereq_("socket.io-parser"),Manager=_dereq_("./manager"),debug=_dereq_("debug")("socket.io-client");module.exports=exports=lookup;var cache=exports.managers={};exports.protocol=parser.protocol,exports.connect=lookup,exports.Manager=_dereq_("./manager"),exports.Socket=_dereq_("./socket")},{"./manager":3,"./socket":5,"./url":6,debug:10,"socket.io-parser":46}],3:[function(_dereq_,module,exports){function Manager(uri,opts){return this instanceof Manager?(uri&&"object"==typeof uri&&(opts=uri,uri=void 0),opts=opts||{},opts.path=opts.path||"/socket.io",this.nsps={},this.subs=[],this.opts=opts,this.reconnection(opts.reconnection!==!1),this.reconnectionAttempts(opts.reconnectionAttempts||1/0),this.reconnectionDelay(opts.reconnectionDelay||1e3),this.reconnectionDelayMax(opts.reconnectionDelayMax||5e3),this.randomizationFactor(opts.randomizationFactor||.5),this.backoff=new Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==opts.timeout?2e4:opts.timeout),this.readyState="closed",this.uri=uri,this.connected=[],this.encoding=!1,this.packetBuffer=[],this.encoder=new parser.Encoder,this.decoder=new parser.Decoder,this.autoConnect=opts.autoConnect!==!1,void(this.autoConnect&&this.open())):new Manager(uri,opts)}var eio=(_dereq_("./url"),_dereq_("engine.io-client")),Socket=_dereq_("./socket"),Emitter=_dereq_("component-emitter"),parser=_dereq_("socket.io-parser"),on=_dereq_("./on"),bind=_dereq_("component-bind"),debug=(_dereq_("object-component"),_dereq_("debug")("socket.io-client:manager")),indexOf=_dereq_("indexof"),Backoff=_dereq_("backo2");module.exports=Manager,Manager.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var nsp in this.nsps)this.nsps[nsp].emit.apply(this.nsps[nsp],arguments)},Manager.prototype.updateSocketIds=function(){for(var nsp in this.nsps)this.nsps[nsp].id=this.engine.id},Emitter(Manager.prototype),Manager.prototype.reconnection=function(v){return arguments.length?(this._reconnection=!!v,this):this._reconnection},Manager.prototype.reconnectionAttempts=function(v){return arguments.length?(this._reconnectionAttempts=v,this):this._reconnectionAttempts},Manager.prototype.reconnectionDelay=function(v){return arguments.length?(this._reconnectionDelay=v,this.backoff&&this.backoff.setMin(v),this):this._reconnectionDelay},Manager.prototype.randomizationFactor=function(v){return arguments.length?(this._randomizationFactor=v,this.backoff&&this.backoff.setJitter(v),this):this._randomizationFactor},Manager.prototype.reconnectionDelayMax=function(v){return arguments.length?(this._reconnectionDelayMax=v,this.backoff&&this.backoff.setMax(v),this):this._reconnectionDelayMax},Manager.prototype.timeout=function(v){return arguments.length?(this._timeout=v,this):this._timeout},Manager.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},Manager.prototype.open=Manager.prototype.connect=function(fn){if(debug("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;debug("opening %s",this.uri),this.engine=eio(this.uri,this.opts);var socket=this.engine,self=this;this.readyState="opening",this.skipReconnect=!1;var openSub=on(socket,"open",function(){self.onopen(),fn&&fn()}),errorSub=on(socket,"error",function(data){if(debug("connect_error"),self.cleanup(),self.readyState="closed",self.emitAll("connect_error",data),fn){var err=new Error("Connection error");err.data=data,fn(err)}else self.maybeReconnectOnOpen()});if(!1!==this._timeout){var timeout=this._timeout;debug("connect attempt will timeout after %d",timeout);var timer=setTimeout(function(){debug("connect attempt timed out after %d",timeout),openSub.destroy(),socket.close(),socket.emit("error","timeout"),self.emitAll("connect_timeout",timeout)},timeout);this.subs.push({destroy:function(){clearTimeout(timer)}})}return this.subs.push(openSub),this.subs.push(errorSub),this},Manager.prototype.onopen=function(){debug("open"),this.cleanup(),this.readyState="open",this.emit("open");var socket=this.engine;this.subs.push(on(socket,"data",bind(this,"ondata"))),this.subs.push(on(this.decoder,"decoded",bind(this,"ondecoded"))),this.subs.push(on(socket,"error",bind(this,"onerror"))),this.subs.push(on(socket,"close",bind(this,"onclose")))},Manager.prototype.ondata=function(data){this.decoder.add(data)},Manager.prototype.ondecoded=function(packet){this.emit("packet",packet)},Manager.prototype.onerror=function(err){debug("error",err),this.emitAll("error",err)},Manager.prototype.socket=function(nsp){var socket=this.nsps[nsp];if(!socket){socket=new Socket(this,nsp),this.nsps[nsp]=socket;var self=this;socket.on("connect",function(){socket.id=self.engine.id,~indexOf(self.connected,socket)||self.connected.push(socket)})}return socket},Manager.prototype.destroy=function(socket){var index=indexOf(this.connected,socket);~index&&this.connected.splice(index,1),this.connected.length||this.close()},Manager.prototype.packet=function(packet){debug("writing packet %j",packet);var self=this;self.encoding?self.packetBuffer.push(packet):(self.encoding=!0,this.encoder.encode(packet,function(encodedPackets){for(var i=0;i<encodedPackets.length;i++)self.engine.write(encodedPackets[i]);self.encoding=!1,self.processPacketQueue()}))},Manager.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var pack=this.packetBuffer.shift();this.packet(pack)}},Manager.prototype.cleanup=function(){for(var sub;sub=this.subs.shift();)sub.destroy();this.packetBuffer=[],this.encoding=!1,this.decoder.destroy()},Manager.prototype.close=Manager.prototype.disconnect=function(){this.skipReconnect=!0,this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},Manager.prototype.onclose=function(reason){debug("close"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",reason),this._reconnection&&!this.skipReconnect&&this.reconnect()},Manager.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var self=this;if(this.backoff.attempts>=this._reconnectionAttempts)debug("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var delay=this.backoff.duration();debug("will wait %dms before reconnect attempt",delay),this.reconnecting=!0;var timer=setTimeout(function(){self.skipReconnect||(debug("attempting reconnect"),self.emitAll("reconnect_attempt",self.backoff.attempts),self.emitAll("reconnecting",self.backoff.attempts),self.skipReconnect||self.open(function(err){err?(debug("reconnect attempt error"),self.reconnecting=!1,self.reconnect(),self.emitAll("reconnect_error",err.data)):(debug("reconnect success"),self.onreconnect())}))},delay);this.subs.push({destroy:function(){clearTimeout(timer)}})}},Manager.prototype.onreconnect=function(){var attempt=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",attempt)}},{"./on":4,"./socket":5,"./url":6,backo2:7,"component-bind":8,"component-emitter":9,debug:10,"engine.io-client":11,indexof:42,"object-component":43,"socket.io-parser":46}],4:[function(_dereq_,module,exports){function on(obj,ev,fn){return obj.on(ev,fn),{destroy:function(){obj.removeListener(ev,fn)}}}module.exports=on},{}],5:[function(_dereq_,module,exports){function Socket(io,nsp){this.io=io,this.nsp=nsp,this.json=this,this.ids=0,this.acks={},this.io.autoConnect&&this.open(),this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0}var parser=_dereq_("socket.io-parser"),Emitter=_dereq_("component-emitter"),toArray=_dereq_("to-array"),on=_dereq_("./on"),bind=_dereq_("component-bind"),debug=_dereq_("debug")("socket.io-client:socket"),hasBin=_dereq_("has-binary");module.exports=exports=Socket;var events={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},emit=Emitter.prototype.emit;Emitter(Socket.prototype),Socket.prototype.subEvents=function(){if(!this.subs){var io=this.io;this.subs=[on(io,"open",bind(this,"onopen")),on(io,"packet",bind(this,"onpacket")),on(io,"close",bind(this,"onclose"))]}},Socket.prototype.open=Socket.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen(),this)},Socket.prototype.send=function(){var args=toArray(arguments);return args.unshift("message"),this.emit.apply(this,args),this},Socket.prototype.emit=function(ev){if(events.hasOwnProperty(ev))return emit.apply(this,arguments),this;var args=toArray(arguments),parserType=parser.EVENT;hasBin(args)&&(parserType=parser.BINARY_EVENT);var packet={type:parserType,data:args};return"function"==typeof args[args.length-1]&&(debug("emitting packet with ack id %d",this.ids),this.acks[this.ids]=args.pop(),packet.id=this.ids++),this.connected?this.packet(packet):this.sendBuffer.push(packet),this},Socket.prototype.packet=function(packet){packet.nsp=this.nsp,this.io.packet(packet)},Socket.prototype.onopen=function(){debug("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:parser.CONNECT})},Socket.prototype.onclose=function(reason){debug("close (%s)",reason),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",reason)},Socket.prototype.onpacket=function(packet){if(packet.nsp==this.nsp)switch(packet.type){case parser.CONNECT:this.onconnect();break;case parser.EVENT:this.onevent(packet);break;case parser.BINARY_EVENT:this.onevent(packet);break;case parser.ACK:this.onack(packet);break;case parser.BINARY_ACK:this.onack(packet);break;case parser.DISCONNECT:this.ondisconnect();break;case parser.ERROR:this.emit("error",packet.data)}},Socket.prototype.onevent=function(packet){var args=packet.data||[];debug("emitting event %j",args),null!=packet.id&&(debug("attaching ack callback to event"),args.push(this.ack(packet.id))),this.connected?emit.apply(this,args):this.receiveBuffer.push(args)},Socket.prototype.ack=function(id){var self=this,sent=!1;return function(){if(!sent){sent=!0;var args=toArray(arguments);debug("sending ack %j",args);var type=hasBin(args)?parser.BINARY_ACK:parser.ACK;self.packet({type:type,id:id,data:args})}}},Socket.prototype.onack=function(packet){debug("calling ack %s with %j",packet.id,packet.data);var fn=this.acks[packet.id];fn.apply(this,packet.data),delete this.acks[packet.id]},Socket.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},Socket.prototype.emitBuffered=function(){var i;for(i=0;i<this.receiveBuffer.length;i++)emit.apply(this,this.receiveBuffer[i]);for(this.receiveBuffer=[],i=0;i<this.sendBuffer.length;i++)this.packet(this.sendBuffer[i]);this.sendBuffer=[]},Socket.prototype.ondisconnect=function(){debug("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},Socket.prototype.destroy=function(){if(this.subs){for(var i=0;i<this.subs.length;i++)this.subs[i].destroy();this.subs=null}this.io.destroy(this)},Socket.prototype.close=Socket.prototype.disconnect=function(){return this.connected&&(debug("performing disconnect (%s)",this.nsp),this.packet({type:parser.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{"./on":4,"component-bind":8,"component-emitter":9,debug:10,"has-binary":38,"socket.io-parser":46,"to-array":50}],6:[function(_dereq_,module,exports){(function(global){function url(uri,loc){var obj=uri,loc=loc||global.location;return null==uri&&(uri=loc.protocol+"//"+loc.host),"string"==typeof uri&&("/"==uri.charAt(0)&&(uri="/"==uri.charAt(1)?loc.protocol+uri:loc.hostname+uri),/^(https?|wss?):\/\//.test(uri)||(debug("protocol-less url %s",uri),uri="undefined"!=typeof loc?loc.protocol+"//"+uri:"https://"+uri),debug("parse %s",uri),obj=parseuri(uri)),obj.port||(/^(http|ws)$/.test(obj.protocol)?obj.port="80":/^(http|ws)s$/.test(obj.protocol)&&(obj.port="443")),obj.path=obj.path||"/",obj.id=obj.protocol+"://"+obj.host+":"+obj.port,obj.href=obj.protocol+"://"+obj.host+(loc&&loc.port==obj.port?"":":"+obj.port),obj}var parseuri=_dereq_("parseuri"),debug=_dereq_("debug")("socket.io-client:url");module.exports=url}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{debug:10,parseuri:44}],7:[function(_dereq_,module,exports){function Backoff(opts){opts=opts||{},this.ms=opts.min||100,this.max=opts.max||1e4,this.factor=opts.factor||2,this.jitter=opts.jitter>0&&opts.jitter<=1?opts.jitter:0,this.attempts=0}module.exports=Backoff,Backoff.prototype.duration=function(){var ms=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var rand=Math.random(),deviation=Math.floor(rand*this.jitter*ms);ms=0==(1&Math.floor(10*rand))?ms-deviation:ms+deviation}return 0|Math.min(ms,this.max)},Backoff.prototype.reset=function(){this.attempts=0},Backoff.prototype.setMin=function(min){this.ms=min},Backoff.prototype.setMax=function(max){this.max=max},Backoff.prototype.setJitter=function(jitter){this.jitter=jitter}},{}],8:[function(_dereq_,module,exports){var slice=[].slice;module.exports=function(obj,fn){if("string"==typeof fn&&(fn=obj[fn]),"function"!=typeof fn)throw new Error("bind() requires a function");var args=slice.call(arguments,2);return function(){return fn.apply(obj,args.concat(slice.call(arguments)))}}},{}],9:[function(_dereq_,module,exports){function Emitter(obj){if(obj)return mixin(obj)}function mixin(obj){for(var key in Emitter.prototype)obj[key]=Emitter.prototype[key];return obj}module.exports=Emitter,Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){return this._callbacks=this._callbacks||{},(this._callbacks[event]=this._callbacks[event]||[]).push(fn),this},Emitter.prototype.once=function(event,fn){function on(){self.off(event,on),fn.apply(this,arguments)}var self=this;return this._callbacks=this._callbacks||{},on.fn=fn,this.on(event,on),this},Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var callbacks=this._callbacks[event];if(!callbacks)return this;if(1==arguments.length)return delete this._callbacks[event],this;for(var cb,i=0;i<callbacks.length;i++)if(cb=callbacks[i],cb===fn||cb.fn===fn){callbacks.splice(i,1);break}return this},Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks[event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;i<len;++i)callbacks[i].apply(this,args)}return this},Emitter.prototype.listeners=function(event){return this._callbacks=this._callbacks||{},this._callbacks[event]||[]},Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}},{}],10:[function(_dereq_,module,exports){function debug(name){return debug.enabled(name)?function(fmt){fmt=coerce(fmt);var curr=new Date,ms=curr-(debug[name]||curr);debug[name]=curr,fmt=name+" "+fmt+" +"+debug.humanize(ms),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function coerce(val){return val instanceof Error?val.stack||val.message:val}module.exports=debug,debug.names=[],debug.skips=[],debug.enable=function(name){try{localStorage.debug=name}catch(e){}for(var split=(name||"").split(/[\s,]+/),len=split.length,i=0;i<len;i++)name=split[i].replace("*",".*?"),"-"===name[0]?debug.skips.push(new RegExp("^"+name.substr(1)+"$")):debug.names.push(new RegExp("^"+name+"$"))},debug.disable=function(){debug.enable("")},debug.humanize=function(ms){var sec=1e3,min=6e4,hour=60*min;return ms>=hour?(ms/hour).toFixed(1)+"h":ms>=min?(ms/min).toFixed(1)+"m":ms>=sec?(ms/sec|0)+"s":ms+"ms"},debug.enabled=function(name){for(var i=0,len=debug.skips.length;i<len;i++)if(debug.skips[i].test(name))return!1;for(var i=0,len=debug.names.length;i<len;i++)if(debug.names[i].test(name))return!0;return!1};try{window.localStorage&&debug.enable(localStorage.debug)}catch(e){}},{}],11:[function(_dereq_,module,exports){module.exports=_dereq_("./lib/")},{"./lib/":12}],12:[function(_dereq_,module,exports){module.exports=_dereq_("./socket"),module.exports.parser=_dereq_("engine.io-parser")},{"./socket":13,"engine.io-parser":25}],13:[function(_dereq_,module,exports){(function(global){function Socket(uri,opts){if(!(this instanceof Socket))return new Socket(uri,opts);if(opts=opts||{},uri&&"object"==typeof uri&&(opts=uri,uri=null),uri&&(uri=parseuri(uri),opts.host=uri.host,opts.secure="https"==uri.protocol||"wss"==uri.protocol,opts.port=uri.port,uri.query&&(opts.query=uri.query)),this.secure=null!=opts.secure?opts.secure:global.location&&"https:"==location.protocol,opts.host){var pieces=opts.host.split(":");opts.hostname=pieces.shift(),pieces.length?opts.port=pieces.pop():opts.port||(opts.port=this.secure?"443":"80")}this.agent=opts.agent||!1,this.hostname=opts.hostname||(global.location?location.hostname:"localhost"),this.port=opts.port||(global.location&&location.port?location.port:this.secure?443:80),this.query=opts.query||{},"string"==typeof this.query&&(this.query=parseqs.decode(this.query)),this.upgrade=!1!==opts.upgrade,this.path=(opts.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!opts.forceJSONP,this.jsonp=!1!==opts.jsonp,this.forceBase64=!!opts.forceBase64,this.enablesXDR=!!opts.enablesXDR,this.timestampParam=opts.timestampParam||"t",this.timestampRequests=opts.timestampRequests,this.transports=opts.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.callbackBuffer=[],this.policyPort=opts.policyPort||843,this.rememberUpgrade=opts.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=opts.onlyBinaryUpgrades,this.pfx=opts.pfx||null,this.key=opts.key||null,this.passphrase=opts.passphrase||null,this.cert=opts.cert||null,this.ca=opts.ca||null,this.ciphers=opts.ciphers||null,this.rejectUnauthorized=opts.rejectUnauthorized||null,this.open()}function clone(obj){var o={};for(var i in obj)obj.hasOwnProperty(i)&&(o[i]=obj[i]);return o}var transports=_dereq_("./transports"),Emitter=_dereq_("component-emitter"),debug=_dereq_("debug")("engine.io-client:socket"),index=_dereq_("indexof"),parser=_dereq_("engine.io-parser"),parseuri=_dereq_("parseuri"),parsejson=_dereq_("parsejson"),parseqs=_dereq_("parseqs");module.exports=Socket,Socket.priorWebsocketSuccess=!1,Emitter(Socket.prototype),Socket.protocol=parser.protocol,Socket.Socket=Socket,Socket.Transport=_dereq_("./transport"),Socket.transports=_dereq_("./transports"),Socket.parser=_dereq_("engine.io-parser"),Socket.prototype.createTransport=function(name){debug('creating transport "%s"',name);var query=clone(this.query);query.EIO=parser.protocol,query.transport=name,this.id&&(query.sid=this.id);var transport=new transports[name]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:query,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized});return transport},Socket.prototype.open=function(){var transport;if(this.rememberUpgrade&&Socket.priorWebsocketSuccess&&this.transports.indexOf("websocket")!=-1)transport="websocket";else{if(0==this.transports.length){var self=this;return void setTimeout(function(){self.emit("error","No transports available")},0)}transport=this.transports[0]}this.readyState="opening";var transport;try{transport=this.createTransport(transport)}catch(e){return this.transports.shift(),void this.open()}transport.open(),this.setTransport(transport)},Socket.prototype.setTransport=function(transport){debug("setting transport %s",transport.name);var self=this;this.transport&&(debug("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=transport,transport.on("drain",function(){self.onDrain()}).on("packet",function(packet){self.onPacket(packet)}).on("error",function(e){self.onError(e)}).on("close",function(){self.onClose("transport close")})},Socket.prototype.probe=function(name){function onTransportOpen(){if(self.onlyBinaryUpgrades){var upgradeLosesBinary=!this.supportsBinary&&self.transport.supportsBinary;failed=failed||upgradeLosesBinary}failed||(debug('probe transport "%s" opened',name),transport.send([{type:"ping",data:"probe"}]),transport.once("packet",function(msg){if(!failed)if("pong"==msg.type&&"probe"==msg.data){if(debug('probe transport "%s" pong',name),self.upgrading=!0,self.emit("upgrading",transport),!transport)return;Socket.priorWebsocketSuccess="websocket"==transport.name,debug('pausing current transport "%s"',self.transport.name),self.transport.pause(function(){failed||"closed"!=self.readyState&&(debug("changing transport and sending upgrade packet"),cleanup(),self.setTransport(transport),transport.send([{type:"upgrade"}]),self.emit("upgrade",transport),transport=null,self.upgrading=!1,self.flush())})}else{debug('probe transport "%s" failed',name);var err=new Error("probe error");err.transport=transport.name,self.emit("upgradeError",err)}}))}function freezeTransport(){failed||(failed=!0,cleanup(),transport.close(),transport=null)}function onerror(err){var error=new Error("probe error: "+err);error.transport=transport.name,freezeTransport(),debug('probe transport "%s" failed because of error: %s',name,err),self.emit("upgradeError",error)}function onTransportClose(){onerror("transport closed")}function onclose(){onerror("socket closed")}function onupgrade(to){transport&&to.name!=transport.name&&(debug('"%s" works - aborting "%s"',to.name,transport.name),freezeTransport())}function cleanup(){transport.removeListener("open",onTransportOpen),transport.removeListener("error",onerror),transport.removeListener("close",onTransportClose),self.removeListener("close",onclose),self.removeListener("upgrading",onupgrade)}debug('probing transport "%s"',name);var transport=this.createTransport(name,{probe:1}),failed=!1,self=this;Socket.priorWebsocketSuccess=!1,transport.once("open",onTransportOpen),transport.once("error",onerror),transport.once("close",onTransportClose),this.once("close",onclose),this.once("upgrading",onupgrade),transport.open()},Socket.prototype.onOpen=function(){if(debug("socket open"),this.readyState="open",Socket.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){debug("starting upgrade probes");for(var i=0,l=this.upgrades.length;i<l;i++)this.probe(this.upgrades[i])}},Socket.prototype.onPacket=function(packet){if("opening"==this.readyState||"open"==this.readyState)switch(debug('socket receive: type "%s", data "%s"',packet.type,packet.data),this.emit("packet",packet),this.emit("heartbeat"),packet.type){case"open":this.onHandshake(parsejson(packet.data));break;case"pong":this.setPing();break;case"error":var err=new Error("server error");err.code=packet.data,this.emit("error",err);break;case"message":this.emit("data",packet.data),this.emit("message",packet.data)}else debug('packet received with socket readyState "%s"',this.readyState)},Socket.prototype.onHandshake=function(data){this.emit("handshake",data),this.id=data.sid,this.transport.query.sid=data.sid,this.upgrades=this.filterUpgrades(data.upgrades),this.pingInterval=data.pingInterval,this.pingTimeout=data.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},Socket.prototype.onHeartbeat=function(timeout){clearTimeout(this.pingTimeoutTimer);var self=this;self.pingTimeoutTimer=setTimeout(function(){"closed"!=self.readyState&&self.onClose("ping timeout")},timeout||self.pingInterval+self.pingTimeout)},Socket.prototype.setPing=function(){var self=this;clearTimeout(self.pingIntervalTimer),self.pingIntervalTimer=setTimeout(function(){debug("writing ping packet - expecting pong within %sms",self.pingTimeout),self.ping(),self.onHeartbeat(self.pingTimeout)},self.pingInterval)},Socket.prototype.ping=function(){this.sendPacket("ping")},Socket.prototype.onDrain=function(){for(var i=0;i<this.prevBufferLen;i++)this.callbackBuffer[i]&&this.callbackBuffer[i]();this.writeBuffer.splice(0,this.prevBufferLen),this.callbackBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0==this.writeBuffer.length?this.emit("drain"):this.flush()},Socket.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(debug("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},Socket.prototype.write=Socket.prototype.send=function(msg,fn){return this.sendPacket("message",msg,fn),this},Socket.prototype.sendPacket=function(type,data,fn){if("closing"!=this.readyState&&"closed"!=this.readyState){var packet={type:type,data:data};this.emit("packetCreate",packet),this.writeBuffer.push(packet),this.callbackBuffer.push(fn),this.flush()}},Socket.prototype.close=function(){function close(){self.onClose("forced close"),debug("socket closing - telling transport to close"),self.transport.close()}function cleanupAndClose(){self.removeListener("upgrade",cleanupAndClose),self.removeListener("upgradeError",cleanupAndClose),close()}function waitForUpgrade(){self.once("upgrade",cleanupAndClose),self.once("upgradeError",cleanupAndClose)}if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var self=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?waitForUpgrade():close()}):this.upgrading?waitForUpgrade():close()}return this},Socket.prototype.onError=function(err){debug("socket error %j",err),Socket.priorWebsocketSuccess=!1,this.emit("error",err),this.onClose("transport error",err)},Socket.prototype.onClose=function(reason,desc){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){debug('socket close with reason: "%s"',reason);var self=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),setTimeout(function(){self.writeBuffer=[],self.callbackBuffer=[],self.prevBufferLen=0},0),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",reason,desc)}},Socket.prototype.filterUpgrades=function(upgrades){for(var filteredUpgrades=[],i=0,j=upgrades.length;i<j;i++)~index(this.transports,upgrades[i])&&filteredUpgrades.push(upgrades[i]);return filteredUpgrades}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./transport":14,"./transports":15,"component-emitter":9,debug:22,"engine.io-parser":25,indexof:42,parsejson:34,parseqs:35,parseuri:36}],14:[function(_dereq_,module,exports){function Transport(opts){this.path=opts.path,this.hostname=opts.hostname,this.port=opts.port,this.secure=opts.secure,this.query=opts.query,this.timestampParam=opts.timestampParam,this.timestampRequests=opts.timestampRequests,this.readyState="",this.agent=opts.agent||!1,this.socket=opts.socket,this.enablesXDR=opts.enablesXDR,this.pfx=opts.pfx,this.key=opts.key,this.passphrase=opts.passphrase,this.cert=opts.cert,this.ca=opts.ca,this.ciphers=opts.ciphers,this.rejectUnauthorized=opts.rejectUnauthorized}var parser=_dereq_("engine.io-parser"),Emitter=_dereq_("component-emitter");module.exports=Transport,Emitter(Transport.prototype),Transport.timestamps=0,Transport.prototype.onError=function(msg,desc){var err=new Error(msg);return err.type="TransportError",err.description=desc,this.emit("error",err),this},Transport.prototype.open=function(){return"closed"!=this.readyState&&""!=this.readyState||(this.readyState="opening",this.doOpen()),this},Transport.prototype.close=function(){return"opening"!=this.readyState&&"open"!=this.readyState||(this.doClose(),this.onClose()),this},Transport.prototype.send=function(packets){if("open"!=this.readyState)throw new Error("Transport not open");this.write(packets)},Transport.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},Transport.prototype.onData=function(data){var packet=parser.decodePacket(data,this.socket.binaryType);this.onPacket(packet)},Transport.prototype.onPacket=function(packet){this.emit("packet",packet)},Transport.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"component-emitter":9,"engine.io-parser":25}],15:[function(_dereq_,module,exports){(function(global){function polling(opts){var xhr,xd=!1,xs=!1,jsonp=!1!==opts.jsonp;if(global.location){var isSSL="https:"==location.protocol,port=location.port;port||(port=isSSL?443:80),xd=opts.hostname!=location.hostname||port!=opts.port,xs=opts.secure!=isSSL}if(opts.xdomain=xd,opts.xscheme=xs,xhr=new XMLHttpRequest(opts),"open"in xhr&&!opts.forceJSONP)return new XHR(opts);if(!jsonp)throw new Error("JSONP disabled");return new JSONP(opts)}var XMLHttpRequest=_dereq_("xmlhttprequest"),XHR=_dereq_("./polling-xhr"),JSONP=_dereq_("./polling-jsonp"),websocket=_dereq_("./websocket");exports.polling=polling,exports.websocket=websocket}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(_dereq_,module,exports){(function(global){function empty(){}function JSONPPolling(opts){Polling.call(this,opts),this.query=this.query||{},callbacks||(global.___eio||(global.___eio=[]),callbacks=global.___eio),this.index=callbacks.length;var self=this;callbacks.push(function(msg){self.onData(msg)}),this.query.j=this.index,global.document&&global.addEventListener&&global.addEventListener("beforeunload",function(){self.script&&(self.script.onerror=empty)},!1)}var Polling=_dereq_("./polling"),inherit=_dereq_("component-inherit");module.exports=JSONPPolling;var callbacks,rNewline=/\n/g,rEscapedNewline=/\\n/g;inherit(JSONPPolling,Polling),JSONPPolling.prototype.supportsBinary=!1,JSONPPolling.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),Polling.prototype.doClose.call(this)},JSONPPolling.prototype.doPoll=function(){var self=this,script=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),script.async=!0,script.src=this.uri(),script.onerror=function(e){self.onError("jsonp poll error",e)};var insertAt=document.getElementsByTagName("script")[0];
insertAt.parentNode.insertBefore(script,insertAt),this.script=script;var isUAgecko="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);isUAgecko&&setTimeout(function(){var iframe=document.createElement("iframe");document.body.appendChild(iframe),document.body.removeChild(iframe)},100)},JSONPPolling.prototype.doWrite=function(data,fn){function complete(){initIframe(),fn()}function initIframe(){if(self.iframe)try{self.form.removeChild(self.iframe)}catch(e){self.onError("jsonp polling iframe removal error",e)}try{var html='<iframe src="javascript:0" name="'+self.iframeId+'">';iframe=document.createElement(html)}catch(e){iframe=document.createElement("iframe"),iframe.name=self.iframeId,iframe.src="javascript:0"}iframe.id=self.iframeId,self.form.appendChild(iframe),self.iframe=iframe}var self=this;if(!this.form){var iframe,form=document.createElement("form"),area=document.createElement("textarea"),id=this.iframeId="eio_iframe_"+this.index;form.className="socketio",form.style.position="absolute",form.style.top="-1000px",form.style.left="-1000px",form.target=id,form.method="POST",form.setAttribute("accept-charset","utf-8"),area.name="d",form.appendChild(area),document.body.appendChild(form),this.form=form,this.area=area}this.form.action=this.uri(),initIframe(),data=data.replace(rEscapedNewline,"\\\n"),this.area.value=data.replace(rNewline,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==self.iframe.readyState&&complete()}:this.iframe.onload=complete}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-inherit":21}],17:[function(_dereq_,module,exports){(function(global){function empty(){}function XHR(opts){if(Polling.call(this,opts),global.location){var isSSL="https:"==location.protocol,port=location.port;port||(port=isSSL?443:80),this.xd=opts.hostname!=global.location.hostname||port!=opts.port,this.xs=opts.secure!=isSSL}}function Request(opts){this.method=opts.method||"GET",this.uri=opts.uri,this.xd=!!opts.xd,this.xs=!!opts.xs,this.async=!1!==opts.async,this.data=void 0!=opts.data?opts.data:null,this.agent=opts.agent,this.isBinary=opts.isBinary,this.supportsBinary=opts.supportsBinary,this.enablesXDR=opts.enablesXDR,this.pfx=opts.pfx,this.key=opts.key,this.passphrase=opts.passphrase,this.cert=opts.cert,this.ca=opts.ca,this.ciphers=opts.ciphers,this.rejectUnauthorized=opts.rejectUnauthorized,this.create()}function unloadHandler(){for(var i in Request.requests)Request.requests.hasOwnProperty(i)&&Request.requests[i].abort()}var XMLHttpRequest=_dereq_("xmlhttprequest"),Polling=_dereq_("./polling"),Emitter=_dereq_("component-emitter"),inherit=_dereq_("component-inherit"),debug=_dereq_("debug")("engine.io-client:polling-xhr");module.exports=XHR,module.exports.Request=Request,inherit(XHR,Polling),XHR.prototype.supportsBinary=!0,XHR.prototype.request=function(opts){return opts=opts||{},opts.uri=this.uri(),opts.xd=this.xd,opts.xs=this.xs,opts.agent=this.agent||!1,opts.supportsBinary=this.supportsBinary,opts.enablesXDR=this.enablesXDR,opts.pfx=this.pfx,opts.key=this.key,opts.passphrase=this.passphrase,opts.cert=this.cert,opts.ca=this.ca,opts.ciphers=this.ciphers,opts.rejectUnauthorized=this.rejectUnauthorized,new Request(opts)},XHR.prototype.doWrite=function(data,fn){var isBinary="string"!=typeof data&&void 0!==data,req=this.request({method:"POST",data:data,isBinary:isBinary}),self=this;req.on("success",fn),req.on("error",function(err){self.onError("xhr post error",err)}),this.sendXhr=req},XHR.prototype.doPoll=function(){debug("xhr poll");var req=this.request(),self=this;req.on("data",function(data){self.onData(data)}),req.on("error",function(err){self.onError("xhr poll error",err)}),this.pollXhr=req},Emitter(Request.prototype),Request.prototype.create=function(){var opts={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};opts.pfx=this.pfx,opts.key=this.key,opts.passphrase=this.passphrase,opts.cert=this.cert,opts.ca=this.ca,opts.ciphers=this.ciphers,opts.rejectUnauthorized=this.rejectUnauthorized;var xhr=this.xhr=new XMLHttpRequest(opts),self=this;try{if(debug("xhr open %s: %s",this.method,this.uri),xhr.open(this.method,this.uri,this.async),this.supportsBinary&&(xhr.responseType="arraybuffer"),"POST"==this.method)try{this.isBinary?xhr.setRequestHeader("Content-type","application/octet-stream"):xhr.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}"withCredentials"in xhr&&(xhr.withCredentials=!0),this.hasXDR()?(xhr.onload=function(){self.onLoad()},xhr.onerror=function(){self.onError(xhr.responseText)}):xhr.onreadystatechange=function(){4==xhr.readyState&&(200==xhr.status||1223==xhr.status?self.onLoad():setTimeout(function(){self.onError(xhr.status)},0))},debug("xhr data %s",this.data),xhr.send(this.data)}catch(e){return void setTimeout(function(){self.onError(e)},0)}global.document&&(this.index=Request.requestsCount++,Request.requests[this.index]=this)},Request.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},Request.prototype.onData=function(data){this.emit("data",data),this.onSuccess()},Request.prototype.onError=function(err){this.emit("error",err),this.cleanup(!0)},Request.prototype.cleanup=function(fromError){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=empty:this.xhr.onreadystatechange=empty,fromError)try{this.xhr.abort()}catch(e){}global.document&&delete Request.requests[this.index],this.xhr=null}},Request.prototype.onLoad=function(){var data;try{var contentType;try{contentType=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(e){}data="application/octet-stream"===contentType?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(e){this.onError(e)}null!=data&&this.onData(data)},Request.prototype.hasXDR=function(){return"undefined"!=typeof global.XDomainRequest&&!this.xs&&this.enablesXDR},Request.prototype.abort=function(){this.cleanup()},global.document&&(Request.requestsCount=0,Request.requests={},global.attachEvent?global.attachEvent("onunload",unloadHandler):global.addEventListener&&global.addEventListener("beforeunload",unloadHandler,!1))}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-emitter":9,"component-inherit":21,debug:22,xmlhttprequest:20}],18:[function(_dereq_,module,exports){function Polling(opts){var forceBase64=opts&&opts.forceBase64;hasXHR2&&!forceBase64||(this.supportsBinary=!1),Transport.call(this,opts)}var Transport=_dereq_("../transport"),parseqs=_dereq_("parseqs"),parser=_dereq_("engine.io-parser"),inherit=_dereq_("component-inherit"),debug=_dereq_("debug")("engine.io-client:polling");module.exports=Polling;var hasXHR2=function(){var XMLHttpRequest=_dereq_("xmlhttprequest"),xhr=new XMLHttpRequest({xdomain:!1});return null!=xhr.responseType}();inherit(Polling,Transport),Polling.prototype.name="polling",Polling.prototype.doOpen=function(){this.poll()},Polling.prototype.pause=function(onPause){function pause(){debug("paused"),self.readyState="paused",onPause()}var self=this;if(this.readyState="pausing",this.polling||!this.writable){var total=0;this.polling&&(debug("we are currently polling - waiting to pause"),total++,this.once("pollComplete",function(){debug("pre-pause polling complete"),--total||pause()})),this.writable||(debug("we are currently writing - waiting to pause"),total++,this.once("drain",function(){debug("pre-pause writing complete"),--total||pause()}))}else pause()},Polling.prototype.poll=function(){debug("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},Polling.prototype.onData=function(data){var self=this;debug("polling got data %s",data);var callback=function(packet,index,total){return"opening"==self.readyState&&self.onOpen(),"close"==packet.type?(self.onClose(),!1):void self.onPacket(packet)};parser.decodePayload(data,this.socket.binaryType,callback),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():debug('ignoring poll - transport state "%s"',this.readyState))},Polling.prototype.doClose=function(){function close(){debug("writing close packet"),self.write([{type:"close"}])}var self=this;"open"==this.readyState?(debug("transport open - closing"),close()):(debug("transport not open - deferring close"),this.once("open",close))},Polling.prototype.write=function(packets){var self=this;this.writable=!1;var callbackfn=function(){self.writable=!0,self.emit("drain")},self=this;parser.encodePayload(packets,this.supportsBinary,function(data){self.doWrite(data,callbackfn)})},Polling.prototype.uri=function(){var query=this.query||{},schema=this.secure?"https":"http",port="";return!1!==this.timestampRequests&&(query[this.timestampParam]=+new Date+"-"+Transport.timestamps++),this.supportsBinary||query.sid||(query.b64=1),query=parseqs.encode(query),this.port&&("https"==schema&&443!=this.port||"http"==schema&&80!=this.port)&&(port=":"+this.port),query.length&&(query="?"+query),schema+"://"+this.hostname+port+this.path+query}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:35,xmlhttprequest:20}],19:[function(_dereq_,module,exports){function WS(opts){var forceBase64=opts&&opts.forceBase64;forceBase64&&(this.supportsBinary=!1),Transport.call(this,opts)}var Transport=_dereq_("../transport"),parser=_dereq_("engine.io-parser"),parseqs=_dereq_("parseqs"),inherit=_dereq_("component-inherit"),debug=_dereq_("debug")("engine.io-client:websocket"),WebSocket=_dereq_("ws");module.exports=WS,inherit(WS,Transport),WS.prototype.name="websocket",WS.prototype.supportsBinary=!0,WS.prototype.doOpen=function(){if(this.check()){var uri=this.uri(),protocols=void 0,opts={agent:this.agent};opts.pfx=this.pfx,opts.key=this.key,opts.passphrase=this.passphrase,opts.cert=this.cert,opts.ca=this.ca,opts.ciphers=this.ciphers,opts.rejectUnauthorized=this.rejectUnauthorized,this.ws=new WebSocket(uri,protocols,opts),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.binaryType="arraybuffer",this.addEventListeners()}},WS.prototype.addEventListeners=function(){var self=this;this.ws.onopen=function(){self.onOpen()},this.ws.onclose=function(){self.onClose()},this.ws.onmessage=function(ev){self.onData(ev.data)},this.ws.onerror=function(e){self.onError("websocket error",e)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(WS.prototype.onData=function(data){var self=this;setTimeout(function(){Transport.prototype.onData.call(self,data)},0)}),WS.prototype.write=function(packets){function ondrain(){self.writable=!0,self.emit("drain")}var self=this;this.writable=!1;for(var i=0,l=packets.length;i<l;i++)parser.encodePacket(packets[i],this.supportsBinary,function(data){try{self.ws.send(data)}catch(e){debug("websocket closed before onclose event")}});setTimeout(ondrain,0)},WS.prototype.onClose=function(){Transport.prototype.onClose.call(this)},WS.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},WS.prototype.uri=function(){var query=this.query||{},schema=this.secure?"wss":"ws",port="";return this.port&&("wss"==schema&&443!=this.port||"ws"==schema&&80!=this.port)&&(port=":"+this.port),this.timestampRequests&&(query[this.timestampParam]=+new Date),this.supportsBinary||(query.b64=1),query=parseqs.encode(query),query.length&&(query="?"+query),schema+"://"+this.hostname+port+this.path+query},WS.prototype.check=function(){return!(!WebSocket||"__initialize"in WebSocket&&this.name===WS.prototype.name)}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:35,ws:37}],20:[function(_dereq_,module,exports){var hasCORS=_dereq_("has-cors");module.exports=function(opts){var xdomain=opts.xdomain,xscheme=opts.xscheme,enablesXDR=opts.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!xdomain||hasCORS))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!xscheme&&enablesXDR)return new XDomainRequest}catch(e){}if(!xdomain)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}},{"has-cors":40}],21:[function(_dereq_,module,exports){module.exports=function(a,b){var fn=function(){};fn.prototype=b.prototype,a.prototype=new fn,a.prototype.constructor=a}},{}],22:[function(_dereq_,module,exports){function useColors(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function formatArgs(){var args=arguments,useColors=this.useColors;if(args[0]=(useColors?"%c":"")+this.namespace+(useColors?" %c":" ")+args[0]+(useColors?"%c ":" ")+"+"+exports.humanize(this.diff),!useColors)return args;var c="color: "+this.color;args=[args[0],c,"color: inherit"].concat(Array.prototype.slice.call(args,1));var index=0,lastC=0;return args[0].replace(/%[a-z%]/g,function(match){"%"!==match&&(index++,"%c"===match&&(lastC=index))}),args.splice(lastC,0,c),args}function log(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)}function save(namespaces){try{null==namespaces?localStorage.removeItem("debug"):localStorage.debug=namespaces}catch(e){}}function load(){var r;try{r=localStorage.debug}catch(e){}return r}exports=module.exports=_dereq_("./debug"),exports.log=log,exports.formatArgs=formatArgs,exports.save=save,exports.load=load,exports.useColors=useColors,exports.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],exports.formatters.j=function(v){return JSON.stringify(v)},exports.enable(load())},{"./debug":23}],23:[function(_dereq_,module,exports){function selectColor(){return exports.colors[prevColor++%exports.colors.length]}function debug(namespace){function disabled(){}function enabled(){var self=enabled,curr=+new Date,ms=curr-(prevTime||curr);self.diff=ms,self.prev=prevTime,self.curr=curr,prevTime=curr,null==self.useColors&&(self.useColors=exports.useColors()),null==self.color&&self.useColors&&(self.color=selectColor());var args=Array.prototype.slice.call(arguments);args[0]=exports.coerce(args[0]),"string"!=typeof args[0]&&(args=["%o"].concat(args));var index=0;args[0]=args[0].replace(/%([a-z%])/g,function(match,format){if("%"===match)return match;index++;var formatter=exports.formatters[format];if("function"==typeof formatter){var val=args[index];match=formatter.call(self,val),args.splice(index,1),index--}return match}),"function"==typeof exports.formatArgs&&(args=exports.formatArgs.apply(self,args));var logFn=enabled.log||exports.log||console.log.bind(console);logFn.apply(self,args)}disabled.enabled=!1,enabled.enabled=!0;var fn=exports.enabled(namespace)?enabled:disabled;return fn.namespace=namespace,fn}function enable(namespaces){exports.save(namespaces);for(var split=(namespaces||"").split(/[\s,]+/),len=split.length,i=0;i<len;i++)split[i]&&(namespaces=split[i].replace(/\*/g,".*?"),"-"===namespaces[0]?exports.skips.push(new RegExp("^"+namespaces.substr(1)+"$")):exports.names.push(new RegExp("^"+namespaces+"$")))}function disable(){exports.enable("")}function enabled(name){var i,len;for(i=0,len=exports.skips.length;i<len;i++)if(exports.skips[i].test(name))return!1;for(i=0,len=exports.names.length;i<len;i++)if(exports.names[i].test(name))return!0;return!1}function coerce(val){return val instanceof Error?val.stack||val.message:val}exports=module.exports=debug,exports.coerce=coerce,exports.disable=disable,exports.enable=enable,exports.enabled=enabled,exports.humanize=_dereq_("ms"),exports.names=[],exports.skips=[],exports.formatters={};var prevTime,prevColor=0},{ms:24}],24:[function(_dereq_,module,exports){function parse(str){var match=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(str);if(match){var n=parseFloat(match[1]),type=(match[2]||"ms").toLowerCase();switch(type){case"years":case"year":case"y":return n*y;case"days":case"day":case"d":return n*d;case"hours":case"hour":case"h":return n*h;case"minutes":case"minute":case"m":return n*m;case"seconds":case"second":case"s":return n*s;case"ms":return n}}}function short(ms){return ms>=d?Math.round(ms/d)+"d":ms>=h?Math.round(ms/h)+"h":ms>=m?Math.round(ms/m)+"m":ms>=s?Math.round(ms/s)+"s":ms+"ms"}function long(ms){return plural(ms,d,"day")||plural(ms,h,"hour")||plural(ms,m,"minute")||plural(ms,s,"second")||ms+" ms"}function plural(ms,n,name){if(!(ms<n))return ms<1.5*n?Math.floor(ms/n)+" "+name:Math.ceil(ms/n)+" "+name+"s"}var s=1e3,m=60*s,h=60*m,d=24*h,y=365.25*d;module.exports=function(val,options){return options=options||{},"string"==typeof val?parse(val):options.long?long(val):short(val)}},{}],25:[function(_dereq_,module,exports){(function(global){function encodeBase64Object(packet,callback){var message="b"+exports.packets[packet.type]+packet.data.data;return callback(message)}function encodeArrayBuffer(packet,supportsBinary,callback){if(!supportsBinary)return exports.encodeBase64Packet(packet,callback);var data=packet.data,contentArray=new Uint8Array(data),resultBuffer=new Uint8Array(1+data.byteLength);resultBuffer[0]=packets[packet.type];for(var i=0;i<contentArray.length;i++)resultBuffer[i+1]=contentArray[i];return callback(resultBuffer.buffer)}function encodeBlobAsArrayBuffer(packet,supportsBinary,callback){if(!supportsBinary)return exports.encodeBase64Packet(packet,callback);var fr=new FileReader;return fr.onload=function(){packet.data=fr.result,exports.encodePacket(packet,supportsBinary,!0,callback)},fr.readAsArrayBuffer(packet.data)}function encodeBlob(packet,supportsBinary,callback){if(!supportsBinary)return exports.encodeBase64Packet(packet,callback);if(dontSendBlobs)return encodeBlobAsArrayBuffer(packet,supportsBinary,callback);var length=new Uint8Array(1);length[0]=packets[packet.type];var blob=new Blob([length.buffer,packet.data]);return callback(blob)}function map(ary,each,done){for(var result=new Array(ary.length),next=after(ary.length,done),eachWithIndex=function(i,el,cb){each(el,function(error,msg){result[i]=msg,cb(error,result)})},i=0;i<ary.length;i++)eachWithIndex(i,ary[i],next)}var keys=_dereq_("./keys"),hasBinary=_dereq_("has-binary"),sliceBuffer=_dereq_("arraybuffer.slice"),base64encoder=_dereq_("base64-arraybuffer"),after=_dereq_("after"),utf8=_dereq_("utf8"),isAndroid=navigator.userAgent.match(/Android/i),isPhantomJS=/PhantomJS/i.test(navigator.userAgent),dontSendBlobs=isAndroid||isPhantomJS;exports.protocol=3;var packets=exports.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},packetslist=keys(packets),err={type:"error",data:"parser error"},Blob=_dereq_("blob");exports.encodePacket=function(packet,supportsBinary,utf8encode,callback){"function"==typeof supportsBinary&&(callback=supportsBinary,supportsBinary=!1),"function"==typeof utf8encode&&(callback=utf8encode,utf8encode=null);var data=void 0===packet.data?void 0:packet.data.buffer||packet.data;if(global.ArrayBuffer&&data instanceof ArrayBuffer)return encodeArrayBuffer(packet,supportsBinary,callback);if(Blob&&data instanceof global.Blob)return encodeBlob(packet,supportsBinary,callback);if(data&&data.base64)return encodeBase64Object(packet,callback);var encoded=packets[packet.type];return void 0!==packet.data&&(encoded+=utf8encode?utf8.encode(String(packet.data)):String(packet.data)),callback(""+encoded)},exports.encodeBase64Packet=function(packet,callback){var message="b"+exports.packets[packet.type];if(Blob&&packet.data instanceof Blob){var fr=new FileReader;return fr.onload=function(){var b64=fr.result.split(",")[1];callback(message+b64)},fr.readAsDataURL(packet.data)}var b64data;try{b64data=String.fromCharCode.apply(null,new Uint8Array(packet.data))}catch(e){for(var typed=new Uint8Array(packet.data),basic=new Array(typed.length),i=0;i<typed.length;i++)basic[i]=typed[i];b64data=String.fromCharCode.apply(null,basic)}return message+=global.btoa(b64data),callback(message)},exports.decodePacket=function(data,binaryType,utf8decode){if("string"==typeof data||void 0===data){if("b"==data.charAt(0))return exports.decodeBase64Packet(data.substr(1),binaryType);if(utf8decode)try{data=utf8.decode(data)}catch(e){return err}var type=data.charAt(0);return Number(type)==type&&packetslist[type]?data.length>1?{type:packetslist[type],data:data.substring(1)}:{type:packetslist[type]}:err}var asArray=new Uint8Array(data),type=asArray[0],rest=sliceBuffer(data,1);return Blob&&"blob"===binaryType&&(rest=new Blob([rest])),{type:packetslist[type],data:rest}},exports.decodeBase64Packet=function(msg,binaryType){var type=packetslist[msg.charAt(0)];if(!global.ArrayBuffer)return{type:type,data:{base64:!0,data:msg.substr(1)}};var data=base64encoder.decode(msg.substr(1));return"blob"===binaryType&&Blob&&(data=new Blob([data])),{type:type,data:data}},exports.encodePayload=function(packets,supportsBinary,callback){function setLengthHeader(message){return message.length+":"+message}function encodeOne(packet,doneCallback){exports.encodePacket(packet,!!isBinary&&supportsBinary,!0,function(message){doneCallback(null,setLengthHeader(message))})}"function"==typeof supportsBinary&&(callback=supportsBinary,supportsBinary=null);var isBinary=hasBinary(packets);return supportsBinary&&isBinary?Blob&&!dontSendBlobs?exports.encodePayloadAsBlob(packets,callback):exports.encodePayloadAsArrayBuffer(packets,callback):packets.length?void map(packets,encodeOne,function(err,results){return callback(results.join(""))}):callback("0:")},exports.decodePayload=function(data,binaryType,callback){if("string"!=typeof data)return exports.decodePayloadAsBinary(data,binaryType,callback);"function"==typeof binaryType&&(callback=binaryType,binaryType=null);var packet;if(""==data)return callback(err,0,1);for(var n,msg,length="",i=0,l=data.length;i<l;i++){var chr=data.charAt(i);if(":"!=chr)length+=chr;else{if(""==length||length!=(n=Number(length)))return callback(err,0,1);if(msg=data.substr(i+1,n),length!=msg.length)return callback(err,0,1);if(msg.length){if(packet=exports.decodePacket(msg,binaryType,!0),err.type==packet.type&&err.data==packet.data)return callback(err,0,1);var ret=callback(packet,i+n,l);if(!1===ret)return}i+=n,length=""}}return""!=length?callback(err,0,1):void 0},exports.encodePayloadAsArrayBuffer=function(packets,callback){function encodeOne(packet,doneCallback){exports.encodePacket(packet,!0,!0,function(data){return doneCallback(null,data)})}return packets.length?void map(packets,encodeOne,function(err,encodedPackets){var totalLength=encodedPackets.reduce(function(acc,p){var len;return len="string"==typeof p?p.length:p.byteLength,acc+len.toString().length+len+2},0),resultArray=new Uint8Array(totalLength),bufferIndex=0;return encodedPackets.forEach(function(p){var isString="string"==typeof p,ab=p;if(isString){for(var view=new Uint8Array(p.length),i=0;i<p.length;i++)view[i]=p.charCodeAt(i);ab=view.buffer}isString?resultArray[bufferIndex++]=0:resultArray[bufferIndex++]=1;for(var lenStr=ab.byteLength.toString(),i=0;i<lenStr.length;i++)resultArray[bufferIndex++]=parseInt(lenStr[i]);resultArray[bufferIndex++]=255;for(var view=new Uint8Array(ab),i=0;i<view.length;i++)resultArray[bufferIndex++]=view[i]}),callback(resultArray.buffer)}):callback(new ArrayBuffer(0))},exports.encodePayloadAsBlob=function(packets,callback){function encodeOne(packet,doneCallback){exports.encodePacket(packet,!0,!0,function(encoded){var binaryIdentifier=new Uint8Array(1);if(binaryIdentifier[0]=1,"string"==typeof encoded){for(var view=new Uint8Array(encoded.length),i=0;i<encoded.length;i++)view[i]=encoded.charCodeAt(i);encoded=view.buffer,binaryIdentifier[0]=0}for(var len=encoded instanceof ArrayBuffer?encoded.byteLength:encoded.size,lenStr=len.toString(),lengthAry=new Uint8Array(lenStr.length+1),i=0;i<lenStr.length;i++)lengthAry[i]=parseInt(lenStr[i]);if(lengthAry[lenStr.length]=255,Blob){var blob=new Blob([binaryIdentifier.buffer,lengthAry.buffer,encoded]);doneCallback(null,blob)}})}map(packets,encodeOne,function(err,results){return callback(new Blob(results))})},exports.decodePayloadAsBinary=function(data,binaryType,callback){"function"==typeof binaryType&&(callback=binaryType,binaryType=null);for(var bufferTail=data,buffers=[],numberTooLong=!1;bufferTail.byteLength>0;){for(var tailArray=new Uint8Array(bufferTail),isString=0===tailArray[0],msgLength="",i=1;255!=tailArray[i];i++){if(msgLength.length>310){numberTooLong=!0;break}msgLength+=tailArray[i]}if(numberTooLong)return callback(err,0,1);bufferTail=sliceBuffer(bufferTail,2+msgLength.length),msgLength=parseInt(msgLength);var msg=sliceBuffer(bufferTail,0,msgLength);if(isString)try{msg=String.fromCharCode.apply(null,new Uint8Array(msg))}catch(e){var typed=new Uint8Array(msg);msg="";for(var i=0;i<typed.length;i++)msg+=String.fromCharCode(typed[i])}buffers.push(msg),bufferTail=sliceBuffer(bufferTail,msgLength)}var total=buffers.length;buffers.forEach(function(buffer,i){callback(exports.decodePacket(buffer,binaryType,!0),i,total)})}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./keys":26,after:27,"arraybuffer.slice":28,"base64-arraybuffer":29,blob:30,"has-binary":31,utf8:33}],26:[function(_dereq_,module,exports){module.exports=Object.keys||function(obj){var arr=[],has=Object.prototype.hasOwnProperty;for(var i in obj)has.call(obj,i)&&arr.push(i);return arr}},{}],27:[function(_dereq_,module,exports){function after(count,callback,err_cb){function proxy(err,result){if(proxy.count<=0)throw new Error("after called too many times");--proxy.count,err?(bail=!0,callback(err),callback=err_cb):0!==proxy.count||bail||callback(null,result)}var bail=!1;return err_cb=err_cb||noop,proxy.count=count,0===count?callback():proxy}function noop(){}module.exports=after},{}],28:[function(_dereq_,module,exports){module.exports=function(arraybuffer,start,end){var bytes=arraybuffer.byteLength;if(start=start||0,end=end||bytes,arraybuffer.slice)return arraybuffer.slice(start,end);if(start<0&&(start+=bytes),end<0&&(end+=bytes),end>bytes&&(end=bytes),start>=bytes||start>=end||0===bytes)return new ArrayBuffer(0);for(var abv=new Uint8Array(arraybuffer),result=new Uint8Array(end-start),i=start,ii=0;i<end;i++,ii++)result[ii]=abv[i];return result.buffer}},{}],29:[function(_dereq_,module,exports){!function(chars){"use strict";exports.encode=function(arraybuffer){var i,bytes=new Uint8Array(arraybuffer),len=bytes.length,base64="";for(i=0;i<len;i+=3)base64+=chars[bytes[i]>>2],base64+=chars[(3&bytes[i])<<4|bytes[i+1]>>4],base64+=chars[(15&bytes[i+1])<<2|bytes[i+2]>>6],base64+=chars[63&bytes[i+2]];return len%3===2?base64=base64.substring(0,base64.length-1)+"=":len%3===1&&(base64=base64.substring(0,base64.length-2)+"=="),base64},exports.decode=function(base64){var i,encoded1,encoded2,encoded3,encoded4,bufferLength=.75*base64.length,len=base64.length,p=0;"="===base64[base64.length-1]&&(bufferLength--,"="===base64[base64.length-2]&&bufferLength--);var arraybuffer=new ArrayBuffer(bufferLength),bytes=new Uint8Array(arraybuffer);for(i=0;i<len;i+=4)encoded1=chars.indexOf(base64[i]),encoded2=chars.indexOf(base64[i+1]),encoded3=chars.indexOf(base64[i+2]),encoded4=chars.indexOf(base64[i+3]),bytes[p++]=encoded1<<2|encoded2>>4,bytes[p++]=(15&encoded2)<<4|encoded3>>2,bytes[p++]=(3&encoded3)<<6|63&encoded4;return arraybuffer}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],30:[function(_dereq_,module,exports){(function(global){function BlobBuilderConstructor(ary,options){options=options||{};for(var bb=new BlobBuilder,i=0;i<ary.length;i++)bb.append(ary[i]);return options.type?bb.getBlob(options.type):bb.getBlob()}var BlobBuilder=global.BlobBuilder||global.WebKitBlobBuilder||global.MSBlobBuilder||global.MozBlobBuilder,blobSupported=function(){try{var b=new Blob(["hi"]);return 2==b.size}catch(e){return!1}}(),blobBuilderSupported=BlobBuilder&&BlobBuilder.prototype.append&&BlobBuilder.prototype.getBlob;module.exports=function(){return blobSupported?global.Blob:blobBuilderSupported?BlobBuilderConstructor:void 0}()}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],31:[function(_dereq_,module,exports){(function(global){function hasBinary(data){function _hasBinary(obj){if(!obj)return!1;if(global.Buffer&&global.Buffer.isBuffer(obj)||global.ArrayBuffer&&obj instanceof ArrayBuffer||global.Blob&&obj instanceof Blob||global.File&&obj instanceof File)return!0;if(isArray(obj)){for(var i=0;i<obj.length;i++)if(_hasBinary(obj[i]))return!0}else if(obj&&"object"==typeof obj){obj.toJSON&&(obj=obj.toJSON());for(var key in obj)if(obj.hasOwnProperty(key)&&_hasBinary(obj[key]))return!0}return!1}return _hasBinary(data)}var isArray=_dereq_("isarray");module.exports=hasBinary}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:32}],32:[function(_dereq_,module,exports){module.exports=Array.isArray||function(arr){return"[object Array]"==Object.prototype.toString.call(arr)}},{}],33:[function(_dereq_,module,exports){(function(global){!function(root){function ucs2decode(string){for(var value,extra,output=[],counter=0,length=string.length;counter<length;)value=string.charCodeAt(counter++),value>=55296&&value<=56319&&counter<length?(extra=string.charCodeAt(counter++),56320==(64512&extra)?output.push(((1023&value)<<10)+(1023&extra)+65536):(output.push(value),counter--)):output.push(value);return output}function ucs2encode(array){for(var value,length=array.length,index=-1,output="";++index<length;)value=array[index],value>65535&&(value-=65536,output+=stringFromCharCode(value>>>10&1023|55296),value=56320|1023&value),output+=stringFromCharCode(value);return output}function createByte(codePoint,shift){return stringFromCharCode(codePoint>>shift&63|128)}function encodeCodePoint(codePoint){if(0==(4294967168&codePoint))return stringFromCharCode(codePoint);var symbol="";return 0==(4294965248&codePoint)?symbol=stringFromCharCode(codePoint>>6&31|192):0==(4294901760&codePoint)?(symbol=stringFromCharCode(codePoint>>12&15|224),symbol+=createByte(codePoint,6)):0==(4292870144&codePoint)&&(symbol=stringFromCharCode(codePoint>>18&7|240),symbol+=createByte(codePoint,12),symbol+=createByte(codePoint,6)),symbol+=stringFromCharCode(63&codePoint|128)}function utf8encode(string){for(var codePoint,codePoints=ucs2decode(string),length=codePoints.length,index=-1,byteString="";++index<length;)codePoint=codePoints[index],byteString+=encodeCodePoint(codePoint);return byteString}function readContinuationByte(){if(byteIndex>=byteCount)throw Error("Invalid byte index");var continuationByte=255&byteArray[byteIndex];if(byteIndex++,128==(192&continuationByte))return 63&continuationByte;throw Error("Invalid continuation byte")}function decodeSymbol(){var byte1,byte2,byte3,byte4,codePoint;if(byteIndex>byteCount)throw Error("Invalid byte index");if(byteIndex==byteCount)return!1;if(byte1=255&byteArray[byteIndex],byteIndex++,0==(128&byte1))return byte1;if(192==(224&byte1)){var byte2=readContinuationByte();if(codePoint=(31&byte1)<<6|byte2,codePoint>=128)return codePoint;throw Error("Invalid continuation byte")}if(224==(240&byte1)){if(byte2=readContinuationByte(),byte3=readContinuationByte(),codePoint=(15&byte1)<<12|byte2<<6|byte3,codePoint>=2048)return codePoint;throw Error("Invalid continuation byte")}if(240==(248&byte1)&&(byte2=readContinuationByte(),byte3=readContinuationByte(),byte4=readContinuationByte(),codePoint=(15&byte1)<<18|byte2<<12|byte3<<6|byte4,codePoint>=65536&&codePoint<=1114111))return codePoint;throw Error("Invalid UTF-8 detected")}function utf8decode(byteString){byteArray=ucs2decode(byteString),byteCount=byteArray.length,byteIndex=0;for(var tmp,codePoints=[];(tmp=decodeSymbol())!==!1;)codePoints.push(tmp);return ucs2encode(codePoints)}var freeExports="object"==typeof exports&&exports,freeModule="object"==typeof module&&module&&module.exports==freeExports&&module,freeGlobal="object"==typeof global&&global;freeGlobal.global!==freeGlobal&&freeGlobal.window!==freeGlobal||(root=freeGlobal);
var byteArray,byteCount,byteIndex,stringFromCharCode=String.fromCharCode,utf8={version:"2.0.0",encode:utf8encode,decode:utf8decode};if("function"==typeof define&&"object"==typeof define.amd&&define.amd)define(function(){return utf8});else if(freeExports&&!freeExports.nodeType)if(freeModule)freeModule.exports=utf8;else{var object={},hasOwnProperty=object.hasOwnProperty;for(var key in utf8)hasOwnProperty.call(utf8,key)&&(freeExports[key]=utf8[key])}else root.utf8=utf8}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],34:[function(_dereq_,module,exports){(function(global){var rvalidchars=/^[\],:{}\s]*$/,rvalidescape=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rvalidtokens=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,rtrimLeft=/^\s+/,rtrimRight=/\s+$/;module.exports=function(data){return"string"==typeof data&&data?(data=data.replace(rtrimLeft,"").replace(rtrimRight,""),global.JSON&&JSON.parse?JSON.parse(data):rvalidchars.test(data.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,""))?new Function("return "+data)():void 0):null}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],35:[function(_dereq_,module,exports){exports.encode=function(obj){var str="";for(var i in obj)obj.hasOwnProperty(i)&&(str.length&&(str+="&"),str+=encodeURIComponent(i)+"="+encodeURIComponent(obj[i]));return str},exports.decode=function(qs){for(var qry={},pairs=qs.split("&"),i=0,l=pairs.length;i<l;i++){var pair=pairs[i].split("=");qry[decodeURIComponent(pair[0])]=decodeURIComponent(pair[1])}return qry}},{}],36:[function(_dereq_,module,exports){var re=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];module.exports=function(str){var src=str,b=str.indexOf("["),e=str.indexOf("]");b!=-1&&e!=-1&&(str=str.substring(0,b)+str.substring(b,e).replace(/:/g,";")+str.substring(e,str.length));for(var m=re.exec(str||""),uri={},i=14;i--;)uri[parts[i]]=m[i]||"";return b!=-1&&e!=-1&&(uri.source=src,uri.host=uri.host.substring(1,uri.host.length-1).replace(/;/g,":"),uri.authority=uri.authority.replace("[","").replace("]","").replace(/;/g,":"),uri.ipv6uri=!0),uri}},{}],37:[function(_dereq_,module,exports){function ws(uri,protocols,opts){var instance;return instance=protocols?new WebSocket(uri,protocols):new WebSocket(uri)}var global=function(){return this}(),WebSocket=global.WebSocket||global.MozWebSocket;module.exports=WebSocket?ws:null,WebSocket&&(ws.prototype=WebSocket.prototype)},{}],38:[function(_dereq_,module,exports){(function(global){function hasBinary(data){function _hasBinary(obj){if(!obj)return!1;if(global.Buffer&&global.Buffer.isBuffer(obj)||global.ArrayBuffer&&obj instanceof ArrayBuffer||global.Blob&&obj instanceof Blob||global.File&&obj instanceof File)return!0;if(isArray(obj)){for(var i=0;i<obj.length;i++)if(_hasBinary(obj[i]))return!0}else if(obj&&"object"==typeof obj){obj.toJSON&&(obj=obj.toJSON());for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)&&_hasBinary(obj[key]))return!0}return!1}return _hasBinary(data)}var isArray=_dereq_("isarray");module.exports=hasBinary}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:39}],39:[function(_dereq_,module,exports){module.exports=_dereq_(32)},{}],40:[function(_dereq_,module,exports){var global=_dereq_("global");try{module.exports="XMLHttpRequest"in global&&"withCredentials"in new global.XMLHttpRequest}catch(err){module.exports=!1}},{global:41}],41:[function(_dereq_,module,exports){module.exports=function(){return this}()},{}],42:[function(_dereq_,module,exports){var indexOf=[].indexOf;module.exports=function(arr,obj){if(indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i)if(arr[i]===obj)return i;return-1}},{}],43:[function(_dereq_,module,exports){var has=Object.prototype.hasOwnProperty;exports.keys=Object.keys||function(obj){var keys=[];for(var key in obj)has.call(obj,key)&&keys.push(key);return keys},exports.values=function(obj){var vals=[];for(var key in obj)has.call(obj,key)&&vals.push(obj[key]);return vals},exports.merge=function(a,b){for(var key in b)has.call(b,key)&&(a[key]=b[key]);return a},exports.length=function(obj){return exports.keys(obj).length},exports.isEmpty=function(obj){return 0==exports.length(obj)}},{}],44:[function(_dereq_,module,exports){var re=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];module.exports=function(str){for(var m=re.exec(str||""),uri={},i=14;i--;)uri[parts[i]]=m[i]||"";return uri}},{}],45:[function(_dereq_,module,exports){(function(global){var isArray=_dereq_("isarray"),isBuf=_dereq_("./is-buffer");exports.deconstructPacket=function(packet){function _deconstructPacket(data){if(!data)return data;if(isBuf(data)){var placeholder={_placeholder:!0,num:buffers.length};return buffers.push(data),placeholder}if(isArray(data)){for(var newData=new Array(data.length),i=0;i<data.length;i++)newData[i]=_deconstructPacket(data[i]);return newData}if("object"==typeof data&&!(data instanceof Date)){var newData={};for(var key in data)newData[key]=_deconstructPacket(data[key]);return newData}return data}var buffers=[],packetData=packet.data,pack=packet;return pack.data=_deconstructPacket(packetData),pack.attachments=buffers.length,{packet:pack,buffers:buffers}},exports.reconstructPacket=function(packet,buffers){function _reconstructPacket(data){if(data&&data._placeholder){var buf=buffers[data.num];return buf}if(isArray(data)){for(var i=0;i<data.length;i++)data[i]=_reconstructPacket(data[i]);return data}if(data&&"object"==typeof data){for(var key in data)data[key]=_reconstructPacket(data[key]);return data}return data}return packet.data=_reconstructPacket(packet.data),packet.attachments=void 0,packet},exports.removeBlobs=function(data,callback){function _removeBlobs(obj,curKey,containingObject){if(!obj)return obj;if(global.Blob&&obj instanceof Blob||global.File&&obj instanceof File){pendingBlobs++;var fileReader=new FileReader;fileReader.onload=function(){containingObject?containingObject[curKey]=this.result:bloblessData=this.result,--pendingBlobs||callback(bloblessData)},fileReader.readAsArrayBuffer(obj)}else if(isArray(obj))for(var i=0;i<obj.length;i++)_removeBlobs(obj[i],i,obj);else if(obj&&"object"==typeof obj&&!isBuf(obj))for(var key in obj)_removeBlobs(obj[key],key,obj)}var pendingBlobs=0,bloblessData=data;_removeBlobs(bloblessData),pendingBlobs||callback(bloblessData)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-buffer":47,isarray:48}],46:[function(_dereq_,module,exports){function Encoder(){}function encodeAsString(obj){var str="",nsp=!1;return str+=obj.type,exports.BINARY_EVENT!=obj.type&&exports.BINARY_ACK!=obj.type||(str+=obj.attachments,str+="-"),obj.nsp&&"/"!=obj.nsp&&(nsp=!0,str+=obj.nsp),null!=obj.id&&(nsp&&(str+=",",nsp=!1),str+=obj.id),null!=obj.data&&(nsp&&(str+=","),str+=json.stringify(obj.data)),debug("encoded %j as %s",obj,str),str}function encodeAsBinary(obj,callback){function writeEncoding(bloblessData){var deconstruction=binary.deconstructPacket(bloblessData),pack=encodeAsString(deconstruction.packet),buffers=deconstruction.buffers;buffers.unshift(pack),callback(buffers)}binary.removeBlobs(obj,writeEncoding)}function Decoder(){this.reconstructor=null}function decodeString(str){var p={},i=0;if(p.type=Number(str.charAt(0)),null==exports.types[p.type])return error();if(exports.BINARY_EVENT==p.type||exports.BINARY_ACK==p.type){for(var buf="";"-"!=str.charAt(++i)&&(buf+=str.charAt(i),i!=str.length););if(buf!=Number(buf)||"-"!=str.charAt(i))throw new Error("Illegal attachments");p.attachments=Number(buf)}if("/"==str.charAt(i+1))for(p.nsp="";++i;){var c=str.charAt(i);if(","==c)break;if(p.nsp+=c,i==str.length)break}else p.nsp="/";var next=str.charAt(i+1);if(""!==next&&Number(next)==next){for(p.id="";++i;){var c=str.charAt(i);if(null==c||Number(c)!=c){--i;break}if(p.id+=str.charAt(i),i==str.length)break}p.id=Number(p.id)}if(str.charAt(++i))try{p.data=json.parse(str.substr(i))}catch(e){return error()}return debug("decoded %s as %j",str,p),p}function BinaryReconstructor(packet){this.reconPack=packet,this.buffers=[]}function error(data){return{type:exports.ERROR,data:"parser error"}}var debug=_dereq_("debug")("socket.io-parser"),json=_dereq_("json3"),Emitter=(_dereq_("isarray"),_dereq_("component-emitter")),binary=_dereq_("./binary"),isBuf=_dereq_("./is-buffer");exports.protocol=4,exports.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],exports.CONNECT=0,exports.DISCONNECT=1,exports.EVENT=2,exports.ACK=3,exports.ERROR=4,exports.BINARY_EVENT=5,exports.BINARY_ACK=6,exports.Encoder=Encoder,exports.Decoder=Decoder,Encoder.prototype.encode=function(obj,callback){if(debug("encoding packet %j",obj),exports.BINARY_EVENT==obj.type||exports.BINARY_ACK==obj.type)encodeAsBinary(obj,callback);else{var encoding=encodeAsString(obj);callback([encoding])}},Emitter(Decoder.prototype),Decoder.prototype.add=function(obj){var packet;if("string"==typeof obj)packet=decodeString(obj),exports.BINARY_EVENT==packet.type||exports.BINARY_ACK==packet.type?(this.reconstructor=new BinaryReconstructor(packet),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",packet)):this.emit("decoded",packet);else{if(!isBuf(obj)&&!obj.base64)throw new Error("Unknown type: "+obj);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");packet=this.reconstructor.takeBinaryData(obj),packet&&(this.reconstructor=null,this.emit("decoded",packet))}},Decoder.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},BinaryReconstructor.prototype.takeBinaryData=function(binData){if(this.buffers.push(binData),this.buffers.length==this.reconPack.attachments){var packet=binary.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),packet}return null},BinaryReconstructor.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{"./binary":45,"./is-buffer":47,"component-emitter":9,debug:10,isarray:48,json3:49}],47:[function(_dereq_,module,exports){(function(global){function isBuf(obj){return global.Buffer&&global.Buffer.isBuffer(obj)||global.ArrayBuffer&&obj instanceof ArrayBuffer}module.exports=isBuf}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],48:[function(_dereq_,module,exports){module.exports=_dereq_(32)},{}],49:[function(_dereq_,module,exports){!function(window){function has(name){if(has[name]!==undef)return has[name];var isSupported;if("bug-string-char-index"==name)isSupported="a"!="a"[0];else if("json"==name)isSupported=has("json-stringify")&&has("json-parse");else{var value,serialized='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==name){var stringify=JSON3.stringify,stringifySupported="function"==typeof stringify&&isExtended;if(stringifySupported){(value=function(){return 1}).toJSON=value;try{stringifySupported="0"===stringify(0)&&"0"===stringify(new Number)&&'""'==stringify(new String)&&stringify(getClass)===undef&&stringify(undef)===undef&&stringify()===undef&&"1"===stringify(value)&&"[1]"==stringify([value])&&"[null]"==stringify([undef])&&"null"==stringify(null)&&"[null,null,null]"==stringify([undef,getClass,null])&&stringify({a:[value,!0,!1,null,"\0\b\n\f\r\t"]})==serialized&&"1"===stringify(null,value)&&"[\n 1,\n 2\n]"==stringify([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==stringify(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==stringify(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==stringify(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==stringify(new Date(-1))}catch(exception){stringifySupported=!1}}isSupported=stringifySupported}if("json-parse"==name){var parse=JSON3.parse;if("function"==typeof parse)try{if(0===parse("0")&&!parse(!1)){value=parse(serialized);var parseSupported=5==value.a.length&&1===value.a[0];if(parseSupported){try{parseSupported=!parse('"\t"')}catch(exception){}if(parseSupported)try{parseSupported=1!==parse("01")}catch(exception){}if(parseSupported)try{parseSupported=1!==parse("1.")}catch(exception){}}}}catch(exception){parseSupported=!1}isSupported=parseSupported}}return has[name]=!!isSupported}var isProperty,forEach,undef,getClass={}.toString,isLoader="function"==typeof define&&define.amd,nativeJSON="object"==typeof JSON&&JSON,JSON3="object"==typeof exports&&exports&&!exports.nodeType&&exports;JSON3&&nativeJSON?(JSON3.stringify=nativeJSON.stringify,JSON3.parse=nativeJSON.parse):JSON3=window.JSON=nativeJSON||{};var isExtended=new Date(-0xc782b5b800cec);try{isExtended=isExtended.getUTCFullYear()==-109252&&0===isExtended.getUTCMonth()&&1===isExtended.getUTCDate()&&10==isExtended.getUTCHours()&&37==isExtended.getUTCMinutes()&&6==isExtended.getUTCSeconds()&&708==isExtended.getUTCMilliseconds()}catch(exception){}if(!has("json")){var functionClass="[object Function]",dateClass="[object Date]",numberClass="[object Number]",stringClass="[object String]",arrayClass="[object Array]",booleanClass="[object Boolean]",charIndexBuggy=has("bug-string-char-index");if(!isExtended)var floor=Math.floor,Months=[0,31,59,90,120,151,181,212,243,273,304,334],getDay=function(year,month){return Months[month]+365*(year-1970)+floor((year-1969+(month=+(month>1)))/4)-floor((year-1901+month)/100)+floor((year-1601+month)/400)};(isProperty={}.hasOwnProperty)||(isProperty=function(property){var constructor,members={};return(members.__proto__=null,members.__proto__={toString:1},members).toString!=getClass?isProperty=function(property){var original=this.__proto__,result=property in(this.__proto__=null,this);return this.__proto__=original,result}:(constructor=members.constructor,isProperty=function(property){var parent=(this.constructor||constructor).prototype;return property in this&&!(property in parent&&this[property]===parent[property])}),members=null,isProperty.call(this,property)});var PrimitiveTypes={boolean:1,number:1,string:1,undefined:1},isHostType=function(object,property){var type=typeof object[property];return"object"==type?!!object[property]:!PrimitiveTypes[type]};if(forEach=function(object,callback){var Properties,members,property,size=0;(Properties=function(){this.valueOf=0}).prototype.valueOf=0,members=new Properties;for(property in members)isProperty.call(members,property)&&size++;return Properties=members=null,size?forEach=2==size?function(object,callback){var property,members={},isFunction=getClass.call(object)==functionClass;for(property in object)isFunction&&"prototype"==property||isProperty.call(members,property)||!(members[property]=1)||!isProperty.call(object,property)||callback(property)}:function(object,callback){var property,isConstructor,isFunction=getClass.call(object)==functionClass;for(property in object)isFunction&&"prototype"==property||!isProperty.call(object,property)||(isConstructor="constructor"===property)||callback(property);(isConstructor||isProperty.call(object,property="constructor"))&&callback(property)}:(members=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],forEach=function(object,callback){var property,length,isFunction=getClass.call(object)==functionClass,hasProperty=!isFunction&&"function"!=typeof object.constructor&&isHostType(object,"hasOwnProperty")?object.hasOwnProperty:isProperty;for(property in object)isFunction&&"prototype"==property||!hasProperty.call(object,property)||callback(property);for(length=members.length;property=members[--length];hasProperty.call(object,property)&&callback(property));}),forEach(object,callback)},!has("json-stringify")){var Escapes={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},leadingZeroes="000000",toPaddedString=function(width,value){return(leadingZeroes+(value||0)).slice(-width)},unicodePrefix="\\u00",quote=function(value){var symbols,result='"',index=0,length=value.length,isLarge=length>10&&charIndexBuggy;for(isLarge&&(symbols=value.split(""));index<length;index++){var charCode=value.charCodeAt(index);switch(charCode){case 8:case 9:case 10:case 12:case 13:case 34:case 92:result+=Escapes[charCode];break;default:if(charCode<32){result+=unicodePrefix+toPaddedString(2,charCode.toString(16));break}result+=isLarge?symbols[index]:charIndexBuggy?value.charAt(index):value[index]}}return result+'"'},serialize=function(property,object,callback,properties,whitespace,indentation,stack){var value,className,year,month,date,time,hours,minutes,seconds,milliseconds,results,element,index,length,prefix,result;try{value=object[property]}catch(exception){}if("object"==typeof value&&value)if(className=getClass.call(value),className!=dateClass||isProperty.call(value,"toJSON"))"function"==typeof value.toJSON&&(className!=numberClass&&className!=stringClass&&className!=arrayClass||isProperty.call(value,"toJSON"))&&(value=value.toJSON(property));else if(value>-1/0&&value<1/0){if(getDay){for(date=floor(value/864e5),year=floor(date/365.2425)+1970-1;getDay(year+1,0)<=date;year++);for(month=floor((date-getDay(year,0))/30.42);getDay(year,month+1)<=date;month++);date=1+date-getDay(year,month),time=(value%864e5+864e5)%864e5,hours=floor(time/36e5)%24,minutes=floor(time/6e4)%60,seconds=floor(time/1e3)%60,milliseconds=time%1e3}else year=value.getUTCFullYear(),month=value.getUTCMonth(),date=value.getUTCDate(),hours=value.getUTCHours(),minutes=value.getUTCMinutes(),seconds=value.getUTCSeconds(),milliseconds=value.getUTCMilliseconds();value=(year<=0||year>=1e4?(year<0?"-":"+")+toPaddedString(6,year<0?-year:year):toPaddedString(4,year))+"-"+toPaddedString(2,month+1)+"-"+toPaddedString(2,date)+"T"+toPaddedString(2,hours)+":"+toPaddedString(2,minutes)+":"+toPaddedString(2,seconds)+"."+toPaddedString(3,milliseconds)+"Z"}else value=null;if(callback&&(value=callback.call(object,property,value)),null===value)return"null";if(className=getClass.call(value),className==booleanClass)return""+value;if(className==numberClass)return value>-1/0&&value<1/0?""+value:"null";if(className==stringClass)return quote(""+value);if("object"==typeof value){for(length=stack.length;length--;)if(stack[length]===value)throw TypeError();if(stack.push(value),results=[],prefix=indentation,indentation+=whitespace,className==arrayClass){for(index=0,length=value.length;index<length;index++)element=serialize(index,value,callback,properties,whitespace,indentation,stack),results.push(element===undef?"null":element);result=results.length?whitespace?"[\n"+indentation+results.join(",\n"+indentation)+"\n"+prefix+"]":"["+results.join(",")+"]":"[]"}else forEach(properties||value,function(property){var element=serialize(property,value,callback,properties,whitespace,indentation,stack);element!==undef&&results.push(quote(property)+":"+(whitespace?" ":"")+element)}),result=results.length?whitespace?"{\n"+indentation+results.join(",\n"+indentation)+"\n"+prefix+"}":"{"+results.join(",")+"}":"{}";return stack.pop(),result}};JSON3.stringify=function(source,filter,width){var whitespace,callback,properties,className;if("function"==typeof filter||"object"==typeof filter&&filter)if((className=getClass.call(filter))==functionClass)callback=filter;else if(className==arrayClass){properties={};for(var value,index=0,length=filter.length;index<length;value=filter[index++],className=getClass.call(value),(className==stringClass||className==numberClass)&&(properties[value]=1));}if(width)if((className=getClass.call(width))==numberClass){if((width-=width%1)>0)for(whitespace="",width>10&&(width=10);whitespace.length<width;whitespace+=" ");}else className==stringClass&&(whitespace=width.length<=10?width:width.slice(0,10));return serialize("",(value={},value[""]=source,value),callback,properties,whitespace,"",[])}}if(!has("json-parse")){var Index,Source,fromCharCode=String.fromCharCode,Unescapes={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},abort=function(){throw Index=Source=null,SyntaxError()},lex=function(){for(var value,begin,position,isSigned,charCode,source=Source,length=source.length;Index<length;)switch(charCode=source.charCodeAt(Index)){case 9:case 10:case 13:case 32:Index++;break;case 123:case 125:case 91:case 93:case 58:case 44:return value=charIndexBuggy?source.charAt(Index):source[Index],Index++,value;case 34:for(value="@",Index++;Index<length;)if(charCode=source.charCodeAt(Index),charCode<32)abort();else if(92==charCode)switch(charCode=source.charCodeAt(++Index)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:value+=Unescapes[charCode],Index++;break;case 117:for(begin=++Index,position=Index+4;Index<position;Index++)charCode=source.charCodeAt(Index),charCode>=48&&charCode<=57||charCode>=97&&charCode<=102||charCode>=65&&charCode<=70||abort();value+=fromCharCode("0x"+source.slice(begin,Index));break;default:abort()}else{if(34==charCode)break;for(charCode=source.charCodeAt(Index),begin=Index;charCode>=32&&92!=charCode&&34!=charCode;)charCode=source.charCodeAt(++Index);value+=source.slice(begin,Index)}if(34==source.charCodeAt(Index))return Index++,value;abort();default:if(begin=Index,45==charCode&&(isSigned=!0,charCode=source.charCodeAt(++Index)),charCode>=48&&charCode<=57){for(48==charCode&&(charCode=source.charCodeAt(Index+1),charCode>=48&&charCode<=57)&&abort(),isSigned=!1;Index<length&&(charCode=source.charCodeAt(Index),charCode>=48&&charCode<=57);Index++);if(46==source.charCodeAt(Index)){for(position=++Index;position<length&&(charCode=source.charCodeAt(position),charCode>=48&&charCode<=57);position++);position==Index&&abort(),Index=position}if(charCode=source.charCodeAt(Index),101==charCode||69==charCode){for(charCode=source.charCodeAt(++Index),43!=charCode&&45!=charCode||Index++,position=Index;position<length&&(charCode=source.charCodeAt(position),charCode>=48&&charCode<=57);position++);position==Index&&abort(),Index=position}return+source.slice(begin,Index)}if(isSigned&&abort(),"true"==source.slice(Index,Index+4))return Index+=4,!0;if("false"==source.slice(Index,Index+5))return Index+=5,!1;if("null"==source.slice(Index,Index+4))return Index+=4,null;abort()}return"$"},get=function(value){var results,hasMembers;if("$"==value&&abort(),"string"==typeof value){if("@"==(charIndexBuggy?value.charAt(0):value[0]))return value.slice(1);if("["==value){for(results=[];value=lex(),"]"!=value;hasMembers||(hasMembers=!0))hasMembers&&(","==value?(value=lex(),"]"==value&&abort()):abort()),","==value&&abort(),results.push(get(value));return results}if("{"==value){for(results={};value=lex(),"}"!=value;hasMembers||(hasMembers=!0))hasMembers&&(","==value?(value=lex(),"}"==value&&abort()):abort()),","!=value&&"string"==typeof value&&"@"==(charIndexBuggy?value.charAt(0):value[0])&&":"==lex()||abort(),results[value.slice(1)]=get(lex());return results}abort()}return value},update=function(source,property,callback){var element=walk(source,property,callback);element===undef?delete source[property]:source[property]=element},walk=function(source,property,callback){var length,value=source[property];if("object"==typeof value&&value)if(getClass.call(value)==arrayClass)for(length=value.length;length--;)update(value,length,callback);else forEach(value,function(property){update(value,property,callback)});return callback.call(source,property,value)};JSON3.parse=function(source,callback){var result,value;return Index=0,Source=""+source,result=get(lex()),"$"!=lex()&&abort(),Index=Source=null,callback&&getClass.call(callback)==functionClass?walk((value={},value[""]=result,value),"",callback):result}}}isLoader&&define(function(){return JSON3})}(this)},{}],50:[function(_dereq_,module,exports){function toArray(list,index){var array=[];index=index||0;for(var i=index||0;i<list.length;i++)array[i-index]=list[i];return array}module.exports=toArray},{}]},{},[1])(1)}),!function(a){"function"==typeof define&&define.amd?define("picker",["jquery"],a):"object"==typeof exports?module.exports=a(require("jquery")):this.Picker=a(jQuery)}(function(a){function b(f,g,i,m){function n(){return b._.node("div",b._.node("div",b._.node("div",b._.node("div",B.component.nodes(w.open),y.box),y.wrap),y.frame),y.holder,'tabindex="-1"')}function o(){z.data(g,B).addClass(y.input).val(z.data("value")?B.get("select",x.format):f.value),x.editable||z.on("focus."+w.id+" click."+w.id,function(a){a.preventDefault(),B.open()}).on("keydown."+w.id,u),e(f,{haspopup:!0,expanded:!1,readonly:!1,owns:f.id+"_root"})}function p(){e(B.$root[0],"hidden",!0)}function q(){B.$holder.on({keydown:u,"focus.toOpen":t,blur:function(){z.removeClass(y.target)},focusin:function(a){B.$root.removeClass(y.focused),a.stopPropagation()},"mousedown click":function(b){var c=b.target;c!=B.$holder[0]&&(b.stopPropagation(),"mousedown"!=b.type||a(c).is("input, select, textarea, button, option")||(b.preventDefault(),B.$holder[0].focus()))}}).on("click","[data-pick], [data-nav], [data-clear], [data-close]",function(){var b=a(this),c=b.data(),d=b.hasClass(y.navDisabled)||b.hasClass(y.disabled),e=h();e=e&&(e.type||e.href),(d||e&&!a.contains(B.$root[0],e))&&B.$holder[0].focus(),!d&&c.nav?B.set("highlight",B.component.item.highlight,{nav:c.nav}):!d&&"pick"in c?(B.set("select",c.pick),x.closeOnSelect&&B.close(!0)):c.clear?(B.clear(),x.closeOnClear&&B.close(!0)):c.close&&B.close(!0)})}function r(){var b;x.hiddenName===!0?(b=f.name,f.name=""):(b=["string"==typeof x.hiddenPrefix?x.hiddenPrefix:"","string"==typeof x.hiddenSuffix?x.hiddenSuffix:"_submit"],b=b[0]+f.name+b[1]),B._hidden=a('<input type=hidden name="'+b+'"'+(z.data("value")||f.value?' value="'+B.get("select",x.formatSubmit)+'"':"")+">")[0],z.on("change."+w.id,function(){B._hidden.value=f.value?B.get("select",x.formatSubmit):""})}function s(){v&&l?B.$holder.find("."+y.frame).one("transitionend",function(){B.$holder[0].focus()}):B.$holder[0].focus()}function t(a){a.stopPropagation(),z.addClass(y.target),B.$root.addClass(y.focused),B.open()}function u(a){var b=a.keyCode,c=/^(8|46)$/.test(b);return 27==b?(B.close(!0),!1):void((32==b||c||!w.open&&B.component.key[b])&&(a.preventDefault(),a.stopPropagation(),c?B.clear().close():B.open()))}if(!f)return b;var v=!1,w={id:f.id||"P"+Math.abs(~~(Math.random()*new Date))},x=i?a.extend(!0,{},i.defaults,m):m||{},y=a.extend({},b.klasses(),x.klass),z=a(f),A=function(){return this.start()},B=A.prototype={constructor:A,$node:z,start:function(){return w&&w.start?B:(w.methods={},w.start=!0,w.open=!1,w.type=f.type,f.autofocus=f==h(),f.readOnly=!x.editable,f.id=f.id||w.id,"text"!=f.type&&(f.type="text"),B.component=new i(B,x),B.$root=a('<div class="'+y.picker+'" id="'+f.id+'_root" />'),p(),B.$holder=a(n()).appendTo(B.$root),q(),x.formatSubmit&&r(),o(),x.containerHidden?a(x.containerHidden).append(B._hidden):z.after(B._hidden),x.container?a(x.container).append(B.$root):z.after(B.$root),B.on({start:B.component.onStart,render:B.component.onRender,stop:B.component.onStop,open:B.component.onOpen,close:B.component.onClose,set:B.component.onSet}).on({start:x.onStart,render:x.onRender,stop:x.onStop,open:x.onOpen,close:x.onClose,set:x.onSet}),v=c(B.$holder[0]),f.autofocus&&B.open(),B.trigger("start").trigger("render"))},render:function(b){return b?(B.$holder=a(n()),q(),B.$root.html(B.$holder)):B.$root.find("."+y.box).html(B.component.nodes(w.open)),B.trigger("render")},stop:function(){return w.start?(B.close(),B._hidden&&B._hidden.parentNode.removeChild(B._hidden),B.$root.remove(),z.removeClass(y.input).removeData(g),setTimeout(function(){z.off("."+w.id)},0),f.type=w.type,f.readOnly=!1,B.trigger("stop"),w.methods={},w.start=!1,B):B},open:function(c){return w.open?B:(z.addClass(y.active),e(f,"expanded",!0),setTimeout(function(){B.$root.addClass(y.opened),e(B.$root[0],"hidden",!1)},0),c!==!1&&(w.open=!0,v&&k.css("overflow","hidden").css("padding-right","+="+d()),s(),j.on("click."+w.id+" focusin."+w.id,function(a){var b=a.target;b!=f&&b!=document&&3!=a.which&&B.close(b===B.$holder[0])}).on("keydown."+w.id,function(c){var d=c.keyCode,e=B.component.key[d],f=c.target;27==d?B.close(!0):f!=B.$holder[0]||!e&&13!=d?a.contains(B.$root[0],f)&&13==d&&(c.preventDefault(),f.click()):(c.preventDefault(),e?b._.trigger(B.component.key.go,B,[b._.trigger(e)]):B.$root.find("."+y.highlighted).hasClass(y.disabled)||(B.set("select",B.component.item.highlight),x.closeOnSelect&&B.close(!0)))})),B.trigger("open"))},close:function(a){return a&&(x.editable?f.focus():(B.$holder.off("focus.toOpen").focus(),setTimeout(function(){B.$holder.on("focus.toOpen",t)},0))),z.removeClass(y.active),e(f,"expanded",!1),setTimeout(function(){B.$root.removeClass(y.opened+" "+y.focused),e(B.$root[0],"hidden",!0)},0),w.open?(w.open=!1,v&&k.css("overflow","").css("padding-right","-="+d()),j.off("."+w.id),B.trigger("close")):B},clear:function(a){return B.set("clear",null,a)},set:function(b,c,d){var e,f,g=a.isPlainObject(b),h=g?b:{};if(d=g&&a.isPlainObject(c)?c:d||{},b){g||(h[b]=c);for(e in h)f=h[e],e in B.component.item&&(void 0===f&&(f=null),B.component.set(e,f,d)),("select"==e||"clear"==e)&&z.val("clear"==e?"":B.get(e,x.format)).trigger("change");B.render()}return d.muted?B:B.trigger("set",h)},get:function(a,c){if(a=a||"value",null!=w[a])return w[a];if("valueSubmit"==a){if(B._hidden)return B._hidden.value;a="value"}if("value"==a)return f.value;if(a in B.component.item){if("string"==typeof c){var d=B.component.get(a);return d?b._.trigger(B.component.formats.toString,B.component,[c,d]):""}return B.component.get(a)}},on:function(b,c,d){var e,f,g=a.isPlainObject(b),h=g?b:{};if(b){g||(h[b]=c);for(e in h)f=h[e],d&&(e="_"+e),w.methods[e]=w.methods[e]||[],w.methods[e].push(f)}return B},off:function(){var a,b,c=arguments;for(a=0,namesCount=c.length;a<namesCount;a+=1)b=c[a],b in w.methods&&delete w.methods[b];return B},trigger:function(a,c){var d=function(a){var d=w.methods[a];d&&d.map(function(a){b._.trigger(a,B,[c])})};return d("_"+a),d(a),B}};return new A}function c(a){var b,c="position";return a.currentStyle?b=a.currentStyle[c]:window.getComputedStyle&&(b=getComputedStyle(a)[c]),"fixed"==b}function d(){if(k.height()<=i.height())return 0;var b=a('<div style="visibility:hidden;width:100px" />').appendTo("body"),c=b[0].offsetWidth;b.css("overflow","scroll");var d=a('<div style="width:100%" />').appendTo(b),e=d[0].offsetWidth;return b.remove(),c-e}function e(b,c,d){if(a.isPlainObject(c))for(var e in c)f(b,e,c[e]);else f(b,c,d)}function f(a,b,c){a.setAttribute(("role"==b?"":"aria-")+b,c)}function g(b,c){a.isPlainObject(b)||(b={attribute:c}),c="";for(var d in b){var e=("role"==d?"":"aria-")+d,f=b[d];c+=null==f?"":e+'="'+b[d]+'"'}return c}function h(){try{return document.activeElement}catch(a){}}var i=a(window),j=a(document),k=a(document.documentElement),l=null!=document.documentElement.style.transition;return b.klasses=function(a){return a=a||"picker",{picker:a,opened:a+"--opened",focused:a+"--focused",input:a+"__input",active:a+"__input--active",target:a+"__input--target",holder:a+"__holder",frame:a+"__frame",wrap:a+"__wrap",box:a+"__box"}},b._={group:function(a){for(var c,d="",e=b._.trigger(a.min,a);e<=b._.trigger(a.max,a,[e]);e+=a.i)c=b._.trigger(a.item,a,[e]),d+=b._.node(a.node,c[0],c[1],c[2]);return d},node:function(b,c,d,e){return c?(c=a.isArray(c)?c.join(""):c,d=d?' class="'+d+'"':"",e=e?" "+e:"","<"+b+d+e+">"+c+"</"+b+">"):""},lead:function(a){return(10>a?"0":"")+a},trigger:function(a,b,c){return"function"==typeof a?a.apply(b,c||[]):a},digits:function(a){
return/\d/.test(a[1])?2:1},isDate:function(a){return{}.toString.call(a).indexOf("Date")>-1&&this.isInteger(a.getDate())},isInteger:function(a){return{}.toString.call(a).indexOf("Number")>-1&&a%1===0},ariaAttr:g},b.extend=function(c,d){a.fn[c]=function(e,f){var g=this.data(c);return"picker"==e?g:g&&"string"==typeof e?b._.trigger(g[e],g,[f]):this.each(function(){var f=a(this);f.data(c)||new b(this,c,d,e)})},a.fn[c].defaults=d.defaults},b}),!function(a){"function"==typeof define&&define.amd?define(["picker","jquery"],a):"object"==typeof exports?module.exports=a(require("./picker.js"),require("jquery")):a(Picker,jQuery)}(function(a,b){function c(a,b){var c=this,d=a.$node[0],e=d.value,f=a.$node.data("value"),g=f||e,h=f?b.formatSubmit:b.format,i=function(){return d.currentStyle?"rtl"==d.currentStyle.direction:"rtl"==getComputedStyle(a.$root[0]).direction};c.settings=b,c.$node=a.$node,c.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse navigate create validate",view:"parse create validate viewset",disable:"deactivate",enable:"activate"},c.item={},c.item.clear=null,c.item.disable=(b.disable||[]).slice(0),c.item.enable=-function(a){return a[0]===!0?a.shift():-1}(c.item.disable),c.set("min",b.min).set("max",b.max).set("now"),g?c.set("select",g,{format:h,defaultValue:!0}):c.set("select",null).set("highlight",c.item.now),c.key={40:7,38:-7,39:function(){return i()?-1:1},37:function(){return i()?1:-1},go:function(a){var b=c.item.highlight,d=new Date(b.year,b.month,b.date+a);c.set("highlight",d,{interval:a}),this.render()}},a.on("render",function(){a.$root.find("."+b.klass.selectMonth).on("change",function(){var c=this.value;c&&(a.set("highlight",[a.get("view").year,c,a.get("highlight").date]),a.$root.find("."+b.klass.selectMonth).trigger("focus"))}),a.$root.find("."+b.klass.selectYear).on("change",function(){var c=this.value;c&&(a.set("highlight",[c,a.get("view").month,a.get("highlight").date]),a.$root.find("."+b.klass.selectYear).trigger("focus"))})},1).on("open",function(){var d="";c.disabled(c.get("now"))&&(d=":not(."+b.klass.buttonToday+")"),a.$root.find("button"+d+", select").attr("disabled",!1)},1).on("close",function(){a.$root.find("button, select").attr("disabled",!0)},1)}var d=7,e=6,f=a._;c.prototype.set=function(a,b,c){var d=this,e=d.item;return null===b?("clear"==a&&(a="select"),e[a]=b,d):(e["enable"==a?"disable":"flip"==a?"enable":a]=d.queue[a].split(" ").map(function(e){return b=d[e](a,b,c)}).pop(),"select"==a?d.set("highlight",e.select,c):"highlight"==a?d.set("view",e.highlight,c):a.match(/^(flip|min|max|disable|enable)$/)&&(e.select&&d.disabled(e.select)&&d.set("select",e.select,c),e.highlight&&d.disabled(e.highlight)&&d.set("highlight",e.highlight,c)),d)},c.prototype.get=function(a){return this.item[a]},c.prototype.create=function(a,c,d){var e,g=this;return c=void 0===c?a:c,c==-(1/0)||c==1/0?e=c:b.isPlainObject(c)&&f.isInteger(c.pick)?c=c.obj:b.isArray(c)?(c=new Date(c[0],c[1],c[2]),c=f.isDate(c)?c:g.create().obj):c=f.isInteger(c)||f.isDate(c)?g.normalize(new Date(c),d):g.now(a,c,d),{year:e||c.getFullYear(),month:e||c.getMonth(),date:e||c.getDate(),day:e||c.getDay(),obj:e||c,pick:e||c.getTime()}},c.prototype.createRange=function(a,c){var d=this,e=function(a){return a===!0||b.isArray(a)||f.isDate(a)?d.create(a):a};return f.isInteger(a)||(a=e(a)),f.isInteger(c)||(c=e(c)),f.isInteger(a)&&b.isPlainObject(c)?a=[c.year,c.month,c.date+a]:f.isInteger(c)&&b.isPlainObject(a)&&(c=[a.year,a.month,a.date+c]),{from:e(a),to:e(c)}},c.prototype.withinRange=function(a,b){return a=this.createRange(a.from,a.to),b.pick>=a.from.pick&&b.pick<=a.to.pick},c.prototype.overlapRanges=function(a,b){var c=this;return a=c.createRange(a.from,a.to),b=c.createRange(b.from,b.to),c.withinRange(a,b.from)||c.withinRange(a,b.to)||c.withinRange(b,a.from)||c.withinRange(b,a.to)},c.prototype.now=function(a,b,c){return b=new Date,c&&c.rel&&b.setDate(b.getDate()+c.rel),this.normalize(b,c)},c.prototype.navigate=function(a,c,d){var e,f,g,h,i=b.isArray(c),j=b.isPlainObject(c),k=this.item.view;if(i||j){for(j?(f=c.year,g=c.month,h=c.date):(f=+c[0],g=+c[1],h=+c[2]),d&&d.nav&&k&&k.month!==g&&(f=k.year,g=k.month),e=new Date(f,g+(d&&d.nav?d.nav:0),1),f=e.getFullYear(),g=e.getMonth();new Date(f,g,h).getMonth()!==g;)h-=1;c=[f,g,h]}return c},c.prototype.normalize=function(a){return a.setHours(0,0,0,0),a},c.prototype.measure=function(a,b){var c=this;return b?"string"==typeof b?b=c.parse(a,b):f.isInteger(b)&&(b=c.now(a,b,{rel:b})):b="min"==a?-(1/0):1/0,b},c.prototype.viewset=function(a,b){return this.create([b.year,b.month,1])},c.prototype.validate=function(a,c,d){var e,g,h,i,j=this,k=c,l=d&&d.interval?d.interval:1,m=-1===j.item.enable,n=j.item.min,o=j.item.max,p=m&&j.item.disable.filter(function(a){if(b.isArray(a)){var d=j.create(a).pick;d<c.pick?e=!0:d>c.pick&&(g=!0)}return f.isInteger(a)}).length;if((!d||!d.nav&&!d.defaultValue)&&(!m&&j.disabled(c)||m&&j.disabled(c)&&(p||e||g)||!m&&(c.pick<=n.pick||c.pick>=o.pick)))for(m&&!p&&(!g&&l>0||!e&&0>l)&&(l*=-1);j.disabled(c)&&(Math.abs(l)>1&&(c.month<k.month||c.month>k.month)&&(c=k,l=l>0?1:-1),c.pick<=n.pick?(h=!0,l=1,c=j.create([n.year,n.month,n.date+(c.pick===n.pick?0:-1)])):c.pick>=o.pick&&(i=!0,l=-1,c=j.create([o.year,o.month,o.date+(c.pick===o.pick?0:1)])),!h||!i);)c=j.create([c.year,c.month,c.date+l]);return c},c.prototype.disabled=function(a){var c=this,d=c.item.disable.filter(function(d){return f.isInteger(d)?a.day===(c.settings.firstDay?d:d-1)%7:b.isArray(d)||f.isDate(d)?a.pick===c.create(d).pick:b.isPlainObject(d)?c.withinRange(d,a):void 0});return d=d.length&&!d.filter(function(a){return b.isArray(a)&&"inverted"==a[3]||b.isPlainObject(a)&&a.inverted}).length,-1===c.item.enable?!d:d||a.pick<c.item.min.pick||a.pick>c.item.max.pick},c.prototype.parse=function(a,b,c){var d=this,e={};return b&&"string"==typeof b?(c&&c.format||(c=c||{},c.format=d.settings.format),d.formats.toArray(c.format).map(function(a){var c=d.formats[a],g=c?f.trigger(c,d,[b,e]):a.replace(/^!/,"").length;c&&(e[a]=b.substr(0,g)),b=b.substr(g)}),[e.yyyy||e.yy,+(e.mm||e.m)-1,e.dd||e.d]):b},c.prototype.formats=function(){function a(a,b,c){var d=a.match(/[^\x00-\x7F]+|\w+/)[0];return c.mm||c.m||(c.m=b.indexOf(d)+1),d.length}function b(a){return a.match(/\w+/)[0].length}return{d:function(a,b){return a?f.digits(a):b.date},dd:function(a,b){return a?2:f.lead(b.date)},ddd:function(a,c){return a?b(a):this.settings.weekdaysShort[c.day]},dddd:function(a,c){return a?b(a):this.settings.weekdaysFull[c.day]},m:function(a,b){return a?f.digits(a):b.month+1},mm:function(a,b){return a?2:f.lead(b.month+1)},mmm:function(b,c){var d=this.settings.monthsShort;return b?a(b,d,c):d[c.month]},mmmm:function(b,c){var d=this.settings.monthsFull;return b?a(b,d,c):d[c.month]},yy:function(a,b){return a?2:(""+b.year).slice(2)},yyyy:function(a,b){return a?4:b.year},toArray:function(a){return a.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(a,b){var c=this;return c.formats.toArray(a).map(function(a){return f.trigger(c.formats[a],c,[0,b])||a.replace(/^!/,"")}).join("")}}}(),c.prototype.isDateExact=function(a,c){var d=this;return f.isInteger(a)&&f.isInteger(c)||"boolean"==typeof a&&"boolean"==typeof c?a===c:(f.isDate(a)||b.isArray(a))&&(f.isDate(c)||b.isArray(c))?d.create(a).pick===d.create(c).pick:!(!b.isPlainObject(a)||!b.isPlainObject(c))&&(d.isDateExact(a.from,c.from)&&d.isDateExact(a.to,c.to))},c.prototype.isDateOverlap=function(a,c){var d=this,e=d.settings.firstDay?1:0;return f.isInteger(a)&&(f.isDate(c)||b.isArray(c))?(a=a%7+e,a===d.create(c).day+1):f.isInteger(c)&&(f.isDate(a)||b.isArray(a))?(c=c%7+e,c===d.create(a).day+1):!(!b.isPlainObject(a)||!b.isPlainObject(c))&&d.overlapRanges(a,c)},c.prototype.flipEnable=function(a){var b=this.item;b.enable=a||(-1==b.enable?1:-1)},c.prototype.deactivate=function(a,c){var d=this,e=d.item.disable.slice(0);return"flip"==c?d.flipEnable():c===!1?(d.flipEnable(1),e=[]):c===!0?(d.flipEnable(-1),e=[]):c.map(function(a){for(var c,g=0;g<e.length;g+=1)if(d.isDateExact(a,e[g])){c=!0;break}c||(f.isInteger(a)||f.isDate(a)||b.isArray(a)||b.isPlainObject(a)&&a.from&&a.to)&&e.push(a)}),e},c.prototype.activate=function(a,c){var d=this,e=d.item.disable,g=e.length;return"flip"==c?d.flipEnable():c===!0?(d.flipEnable(1),e=[]):c===!1?(d.flipEnable(-1),e=[]):c.map(function(a){var c,h,i,j;for(i=0;g>i;i+=1){if(h=e[i],d.isDateExact(h,a)){c=e[i]=null,j=!0;break}if(d.isDateOverlap(h,a)){b.isPlainObject(a)?(a.inverted=!0,c=a):b.isArray(a)?(c=a,c[3]||c.push("inverted")):f.isDate(a)&&(c=[a.getFullYear(),a.getMonth(),a.getDate(),"inverted"]);break}}if(c)for(i=0;g>i;i+=1)if(d.isDateExact(e[i],a)){e[i]=null;break}if(j)for(i=0;g>i;i+=1)if(d.isDateOverlap(e[i],a)){e[i]=null;break}c&&e.push(c)}),e.filter(function(a){return null!=a})},c.prototype.nodes=function(a){var b=this,c=b.settings,g=b.item,h=g.now,i=g.select,j=g.highlight,k=g.view,l=g.disable,m=g.min,n=g.max,o=function(a,b){return c.firstDay&&(a.push(a.shift()),b.push(b.shift())),f.node("thead",f.node("tr",f.group({min:0,max:d-1,i:1,node:"th",item:function(d){return[a[d],c.klass.weekdays,'scope=col title="'+b[d]+'"']}})))}((c.showWeekdaysFull?c.weekdaysFull:c.weekdaysShort).slice(0),c.weekdaysFull.slice(0)),p=function(a){return f.node("div"," ",c.klass["nav"+(a?"Next":"Prev")]+(a&&k.year>=n.year&&k.month>=n.month||!a&&k.year<=m.year&&k.month<=m.month?" "+c.klass.navDisabled:""),"data-nav="+(a||-1)+" "+f.ariaAttr({role:"button",controls:b.$node[0].id+"_table"})+' title="'+(a?c.labelMonthNext:c.labelMonthPrev)+'"')},q=function(){var d=c.showMonthsShort?c.monthsShort:c.monthsFull;return c.selectMonths?f.node("select",f.group({min:0,max:11,i:1,node:"option",item:function(a){return[d[a],0,"value="+a+(k.month==a?" selected":"")+(k.year==m.year&&a<m.month||k.year==n.year&&a>n.month?" disabled":"")]}}),c.klass.selectMonth,(a?"":"disabled")+" "+f.ariaAttr({controls:b.$node[0].id+"_table"})+' title="'+c.labelMonthSelect+'"'):f.node("div",d[k.month],c.klass.month)},r=function(){var d=k.year,e=c.selectYears===!0?5:~~(c.selectYears/2);if(e){var g=m.year,h=n.year,i=d-e,j=d+e;if(g>i&&(j+=g-i,i=g),j>h){var l=i-g,o=j-h;i-=l>o?o:l,j=h}return f.node("select",f.group({min:i,max:j,i:1,node:"option",item:function(a){return[a,0,"value="+a+(d==a?" selected":"")]}}),c.klass.selectYear,(a?"":"disabled")+" "+f.ariaAttr({controls:b.$node[0].id+"_table"})+' title="'+c.labelYearSelect+'"')}return f.node("div",d,c.klass.year)};return f.node("div",(c.selectYears?r()+q():q()+r())+p()+p(1),c.klass.header)+f.node("table",o+f.node("tbody",f.group({min:0,max:e-1,i:1,node:"tr",item:function(a){var e=c.firstDay&&0===b.create([k.year,k.month,1]).day?-7:0;return[f.group({min:d*a-k.day+e+1,max:function(){return this.min+d-1},i:1,node:"td",item:function(a){a=b.create([k.year,k.month,a+(c.firstDay?1:0)]);var d=i&&i.pick==a.pick,e=j&&j.pick==a.pick,g=l&&b.disabled(a)||a.pick<m.pick||a.pick>n.pick,o=f.trigger(b.formats.toString,b,[c.format,a]);return[f.node("div",a.date,function(b){return b.push(k.month==a.month?c.klass.infocus:c.klass.outfocus),h.pick==a.pick&&b.push(c.klass.now),d&&b.push(c.klass.selected),e&&b.push(c.klass.highlighted),g&&b.push(c.klass.disabled),b.join(" ")}([c.klass.day]),"data-pick="+a.pick+" "+f.ariaAttr({role:"gridcell",label:o,selected:!(!d||b.$node.val()!==o)||null,activedescendant:!!e||null,disabled:!!g||null})),"",f.ariaAttr({role:"presentation"})]}})]}})),c.klass.table,'id="'+b.$node[0].id+'_table" '+f.ariaAttr({role:"grid",controls:b.$node[0].id,readonly:!0}))+f.node("div",f.node("button",c.today,c.klass.buttonToday,"type=button data-pick="+h.pick+(a&&!b.disabled(h)?"":" disabled")+" "+f.ariaAttr({controls:b.$node[0].id}))+f.node("button",c.clear,c.klass.buttonClear,"type=button data-clear=1"+(a?"":" disabled")+" "+f.ariaAttr({controls:b.$node[0].id}))+f.node("button",c.close,c.klass.buttonClose,"type=button data-close=true "+(a?"":" disabled")+" "+f.ariaAttr({controls:b.$node[0].id})),c.klass.footer)},c.defaults=function(a){return{labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],today:"Today",clear:"Clear",close:"Close",closeOnSelect:!0,closeOnClear:!0,format:"d mmmm, yyyy",klass:{table:a+"table",header:a+"header",navPrev:a+"nav--prev",navNext:a+"nav--next",navDisabled:a+"nav--disabled",month:a+"month",year:a+"year",selectMonth:a+"select--month",selectYear:a+"select--year",weekdays:a+"weekday",day:a+"day",disabled:a+"day--disabled",selected:a+"day--selected",highlighted:a+"day--highlighted",now:a+"day--today",infocus:a+"day--infocus",outfocus:a+"day--outfocus",footer:a+"footer",buttonClear:a+"button--clear",buttonToday:a+"button--today",buttonClose:a+"button--close"}}}(a.klasses().picker+"__"),a.extend("pickadate",c)}),!function(a){"function"==typeof define&&define.amd?define(["picker","jquery"],a):"object"==typeof exports?module.exports=a(require("./picker.js"),require("jquery")):a(Picker,jQuery)}(function(a,b){function c(a,b){var c=this,d=a.$node[0].value,e=a.$node.data("value"),f=e||d,g=e?b.formatSubmit:b.format;c.settings=b,c.$node=a.$node,c.queue={interval:"i",min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse create validate",view:"parse create validate",disable:"deactivate",enable:"activate"},c.item={},c.item.clear=null,c.item.interval=b.interval||30,c.item.disable=(b.disable||[]).slice(0),c.item.enable=-function(a){return a[0]===!0?a.shift():-1}(c.item.disable),c.set("min",b.min).set("max",b.max).set("now"),f?c.set("select",f,{format:g}):c.set("select",null).set("highlight",c.item.now),c.key={40:1,38:-1,39:1,37:-1,go:function(a){c.set("highlight",c.item.highlight.pick+a*c.item.interval,{interval:a*c.item.interval}),this.render()}},a.on("render",function(){var c=a.$root.children(),d=c.find("."+b.klass.viewset),e=function(a){return["webkit","moz","ms","o",""].map(function(b){return(b?"-"+b+"-":"")+a})},f=function(a,b){e("transform").map(function(c){a.css(c,b)}),e("transition").map(function(c){a.css(c,b)})};d.length&&(f(c,"none"),c[0].scrollTop=~~d.position().top-2*d[0].clientHeight,f(c,""))},1).on("open",function(){a.$root.find("button").attr("disabled",!1)},1).on("close",function(){a.$root.find("button").attr("disabled",!0)},1)}var d=24,e=60,f=12,g=d*e,h=a._;c.prototype.set=function(a,b,c){var d=this,e=d.item;return null===b?("clear"==a&&(a="select"),e[a]=b,d):(e["enable"==a?"disable":"flip"==a?"enable":a]=d.queue[a].split(" ").map(function(e){return b=d[e](a,b,c)}).pop(),"select"==a?d.set("highlight",e.select,c):"highlight"==a?d.set("view",e.highlight,c):"interval"==a?d.set("min",e.min,c).set("max",e.max,c):a.match(/^(flip|min|max|disable|enable)$/)&&(e.select&&d.disabled(e.select)&&d.set("select",b,c),e.highlight&&d.disabled(e.highlight)&&d.set("highlight",b,c),"min"==a&&d.set("max",e.max,c)),d)},c.prototype.get=function(a){return this.item[a]},c.prototype.create=function(a,c,f){var i=this;return c=void 0===c?a:c,h.isDate(c)&&(c=[c.getHours(),c.getMinutes()]),b.isPlainObject(c)&&h.isInteger(c.pick)?c=c.pick:b.isArray(c)?c=+c[0]*e+ +c[1]:h.isInteger(c)||(c=i.now(a,c,f)),"max"==a&&c<i.item.min.pick&&(c+=g),"min"!=a&&"max"!=a&&(c-i.item.min.pick)%i.item.interval!==0&&(c+=i.item.interval),c=i.normalize(a,c,f),{hour:~~(d+c/e)%d,mins:(e+c%e)%e,time:(g+c)%g,pick:c%g}},c.prototype.createRange=function(a,c){var d=this,e=function(a){return a===!0||b.isArray(a)||h.isDate(a)?d.create(a):a};return h.isInteger(a)||(a=e(a)),h.isInteger(c)||(c=e(c)),h.isInteger(a)&&b.isPlainObject(c)?a=[c.hour,c.mins+a*d.settings.interval]:h.isInteger(c)&&b.isPlainObject(a)&&(c=[a.hour,a.mins+c*d.settings.interval]),{from:e(a),to:e(c)}},c.prototype.withinRange=function(a,b){return a=this.createRange(a.from,a.to),b.pick>=a.from.pick&&b.pick<=a.to.pick},c.prototype.overlapRanges=function(a,b){var c=this;return a=c.createRange(a.from,a.to),b=c.createRange(b.from,b.to),c.withinRange(a,b.from)||c.withinRange(a,b.to)||c.withinRange(b,a.from)||c.withinRange(b,a.to)},c.prototype.now=function(a,b){var c,d=this.item.interval,f=new Date,g=f.getHours()*e+f.getMinutes(),i=h.isInteger(b);return g-=g%d,c=0>b&&-d>=d*b+g,g+="min"==a&&c?0:d,i&&(g+=d*(c&&"max"!=a?b+1:b)),g},c.prototype.normalize=function(a,b){var c=this.item.interval,d=this.item.min&&this.item.min.pick||0;return b-="min"==a?0:(b-d)%c},c.prototype.measure=function(a,c,f){var g=this;return c||(c="min"==a?[0,0]:[d-1,e-1]),"string"==typeof c?c=g.parse(a,c):c===!0||h.isInteger(c)?c=g.now(a,c,f):b.isPlainObject(c)&&h.isInteger(c.pick)&&(c=g.normalize(a,c.pick,f)),c},c.prototype.validate=function(a,b,c){var d=this,e=c&&c.interval?c.interval:d.item.interval;return d.disabled(b)&&(b=d.shift(b,e)),b=d.scope(b),d.disabled(b)&&(b=d.shift(b,-1*e)),b},c.prototype.disabled=function(a){var c=this,d=c.item.disable.filter(function(d){return h.isInteger(d)?a.hour==d:b.isArray(d)||h.isDate(d)?a.pick==c.create(d).pick:b.isPlainObject(d)?c.withinRange(d,a):void 0});return d=d.length&&!d.filter(function(a){return b.isArray(a)&&"inverted"==a[2]||b.isPlainObject(a)&&a.inverted}).length,-1===c.item.enable?!d:d||a.pick<c.item.min.pick||a.pick>c.item.max.pick},c.prototype.shift=function(a,b){var c=this,d=c.item.min.pick,e=c.item.max.pick;for(b=b||c.item.interval;c.disabled(a)&&(a=c.create(a.pick+=b),!(a.pick<=d||a.pick>=e)););return a},c.prototype.scope=function(a){var b=this.item.min.pick,c=this.item.max.pick;return this.create(a.pick>c?c:a.pick<b?b:a)},c.prototype.parse=function(a,b,c){var d,f,g,i,j,k=this,l={};if(!b||"string"!=typeof b)return b;c&&c.format||(c=c||{},c.format=k.settings.format),k.formats.toArray(c.format).map(function(a){var c,d=k.formats[a],e=d?h.trigger(d,k,[b,l]):a.replace(/^!/,"").length;d&&(c=b.substr(0,e),l[a]=c.match(/^\d+$/)?+c:c),b=b.substr(e)});for(i in l)j=l[i],h.isInteger(j)?i.match(/^(h|hh)$/i)?(d=j,("h"==i||"hh"==i)&&(d%=12)):"i"==i&&(f=j):i.match(/^a$/i)&&j.match(/^p/i)&&("h"in l||"hh"in l)&&(g=!0);return(g?d+12:d)*e+f},c.prototype.formats={h:function(a,b){return a?h.digits(a):b.hour%f||f},hh:function(a,b){return a?2:h.lead(b.hour%f||f)},H:function(a,b){return a?h.digits(a):""+b.hour%24},HH:function(a,b){return a?h.digits(a):h.lead(b.hour%24)},i:function(a,b){return a?2:h.lead(b.mins)},a:function(a,b){return a?4:g/2>b.time%g?"a.m.":"p.m."},A:function(a,b){return a?2:g/2>b.time%g?"AM":"PM"},toArray:function(a){return a.split(/(h{1,2}|H{1,2}|i|a|A|!.)/g)},toString:function(a,b){var c=this;return c.formats.toArray(a).map(function(a){return h.trigger(c.formats[a],c,[0,b])||a.replace(/^!/,"")}).join("")}},c.prototype.isTimeExact=function(a,c){var d=this;return h.isInteger(a)&&h.isInteger(c)||"boolean"==typeof a&&"boolean"==typeof c?a===c:(h.isDate(a)||b.isArray(a))&&(h.isDate(c)||b.isArray(c))?d.create(a).pick===d.create(c).pick:!(!b.isPlainObject(a)||!b.isPlainObject(c))&&(d.isTimeExact(a.from,c.from)&&d.isTimeExact(a.to,c.to))},c.prototype.isTimeOverlap=function(a,c){var d=this;return h.isInteger(a)&&(h.isDate(c)||b.isArray(c))?a===d.create(c).hour:h.isInteger(c)&&(h.isDate(a)||b.isArray(a))?c===d.create(a).hour:!(!b.isPlainObject(a)||!b.isPlainObject(c))&&d.overlapRanges(a,c)},c.prototype.flipEnable=function(a){var b=this.item;b.enable=a||(-1==b.enable?1:-1)},c.prototype.deactivate=function(a,c){var d=this,e=d.item.disable.slice(0);return"flip"==c?d.flipEnable():c===!1?(d.flipEnable(1),e=[]):c===!0?(d.flipEnable(-1),e=[]):c.map(function(a){for(var c,f=0;f<e.length;f+=1)if(d.isTimeExact(a,e[f])){c=!0;break}c||(h.isInteger(a)||h.isDate(a)||b.isArray(a)||b.isPlainObject(a)&&a.from&&a.to)&&e.push(a)}),e},c.prototype.activate=function(a,c){var d=this,e=d.item.disable,f=e.length;return"flip"==c?d.flipEnable():c===!0?(d.flipEnable(1),e=[]):c===!1?(d.flipEnable(-1),e=[]):c.map(function(a){var c,g,i,j;for(i=0;f>i;i+=1){if(g=e[i],d.isTimeExact(g,a)){c=e[i]=null,j=!0;break}if(d.isTimeOverlap(g,a)){b.isPlainObject(a)?(a.inverted=!0,c=a):b.isArray(a)?(c=a,c[2]||c.push("inverted")):h.isDate(a)&&(c=[a.getFullYear(),a.getMonth(),a.getDate(),"inverted"]);break}}if(c)for(i=0;f>i;i+=1)if(d.isTimeExact(e[i],a)){e[i]=null;break}if(j)for(i=0;f>i;i+=1)if(d.isTimeOverlap(e[i],a)){e[i]=null;break}c&&e.push(c)}),e.filter(function(a){return null!=a})},c.prototype.i=function(a,b){return h.isInteger(b)&&b>0?b:this.item.interval},c.prototype.nodes=function(a){var b=this,c=b.settings,d=b.item.select,e=b.item.highlight,f=b.item.view,g=b.item.disable;return h.node("ul",h.group({min:b.item.min.pick,max:b.item.max.pick,i:b.item.interval,node:"li",item:function(a){a=b.create(a);var i=a.pick,j=d&&d.pick==i,k=e&&e.pick==i,l=g&&b.disabled(a),m=h.trigger(b.formats.toString,b,[c.format,a]);return[h.trigger(b.formats.toString,b,[h.trigger(c.formatLabel,b,[a])||c.format,a]),function(a){return j&&a.push(c.klass.selected),k&&a.push(c.klass.highlighted),f&&f.pick==i&&a.push(c.klass.viewset),l&&a.push(c.klass.disabled),a.join(" ")}([c.klass.listItem]),"data-pick="+a.pick+" "+h.ariaAttr({role:"option",label:m,selected:!(!j||b.$node.val()!==m)||null,activedescendant:!!k||null,disabled:!!l||null})]}})+h.node("li",h.node("button",c.clear,c.klass.buttonClear,"type=button data-clear=1"+(a?"":" disabled")+" "+h.ariaAttr({controls:b.$node[0].id})),"",h.ariaAttr({role:"presentation"})),c.klass.list,h.ariaAttr({role:"listbox",controls:b.$node[0].id}))},c.defaults=function(a){return{clear:"Clear",format:"h:i A",interval:30,closeOnSelect:!0,closeOnClear:!0,klass:{picker:a+" "+a+"--time",holder:a+"__holder",list:a+"__list",listItem:a+"__list-item",disabled:a+"__list-item--disabled",selected:a+"__list-item--selected",highlighted:a+"__list-item--highlighted",viewset:a+"__list-item--viewset",now:a+"__list-item--now",buttonClear:a+"__button--clear"}}}(a.klasses().picker),a.extend("pickatime",c)}),[].map||(Array.prototype.map=function(a,b){for(var c=this,d=c.length,e=new Array(d),f=0;d>f;f++)f in c&&(e[f]=a.call(b,c[f],f,c));return e}),[].filter||(Array.prototype.filter=function(a){if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=[],e=arguments[1],f=0;c>f;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d}),[].indexOf||(Array.prototype.indexOf=function(a){if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>1&&(d=Number(arguments[1]),d!=d?d=0:0!==d&&d!=1/0&&d!=-(1/0)&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);c>e;e++)if(e in b&&b[e]===a)return e;return-1});var nativeSplit=String.prototype.split,compliantExecNpcg=void 0===/()??/.exec("")[1];String.prototype.split=function(a,b){var c=this;if("[object RegExp]"!==Object.prototype.toString.call(a))return nativeSplit.call(c,a,b);var d,e,f,g,h=[],i=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.extended?"x":"")+(a.sticky?"y":""),j=0;for(a=new RegExp(a.source,i+"g"),c+="",compliantExecNpcg||(d=new RegExp("^"+a.source+"$(?!\\s)",i)),b=void 0===b?-1>>>0:b>>>0;(e=a.exec(c))&&(f=e.index+e[0].length,!(f>j&&(h.push(c.slice(j,e.index)),!compliantExecNpcg&&e.length>1&&e[0].replace(d,function(){for(var a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(e[a]=void 0)}),e.length>1&&e.index<c.length&&Array.prototype.push.apply(h,e.slice(1)),g=e[0].length,j=f,h.length>=b)));)a.lastIndex===e.index&&a.lastIndex++;return j===c.length?(g||!a.test(""))&&h.push(""):h.push(c.slice(j)),h.length>b?h.slice(0,b):h};var getUserMedia=null,attachMediaStream=null,reattachMediaStream=null,webrtcDetectedBrowser=null,webrtcDetectedVersion=null,webrtcMinimumVersion=null,webrtcUtils={log:function(){console.log.apply(console,arguments)},extractVersion:function(uastring,expr,pos){var match=uastring.match(expr);return match&&match.length>=pos&&parseInt(match[pos],10)}};if("object"==typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return"mozSrcObject"in this?this.mozSrcObject:this._srcObject},set:function(stream){"mozSrcObject"in this?this.mozSrcObject=stream:(this._srcObject=stream,this.src=URL.createObjectURL(stream))}}),getUserMedia=window.navigator&&window.navigator.getUserMedia),attachMediaStream=function(element,stream){element.srcObject=stream},reattachMediaStream=function(to,from){to.srcObject=from.srcObject},"undefined"!=typeof window&&window.navigator)if(navigator.mozGetUserMedia){if(webrtcUtils.log("This appears to be Firefox"),webrtcDetectedBrowser="firefox",webrtcDetectedVersion=webrtcUtils.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1),webrtcMinimumVersion=31,window.RTCPeerConnection||(window.RTCPeerConnection=function(pcConfig,pcConstraints){if(webrtcDetectedVersion<38&&pcConfig&&pcConfig.iceServers){for(var newIceServers=[],i=0;i<pcConfig.iceServers.length;i++){var server=pcConfig.iceServers[i];if(server.hasOwnProperty("urls"))for(var j=0;j<server.urls.length;j++){var newServer={url:server.urls[j]};0===server.urls[j].indexOf("turn")&&(newServer.username=server.username,newServer.credential=server.credential),newIceServers.push(newServer)}else newIceServers.push(pcConfig.iceServers[i])}pcConfig.iceServers=newIceServers}return new mozRTCPeerConnection(pcConfig,pcConstraints)},mozRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return arguments.length?mozRTCPeerConnection.generateCertificate.apply(null,arguments):mozRTCPeerConnection.generateCertificate}}),window.RTCSessionDescription=mozRTCSessionDescription,window.RTCIceCandidate=mozRTCIceCandidate),getUserMedia=function(constraints,onSuccess,onError){var constraintsToFF37=function(c){if("object"!=typeof c||c.require)return c;var require=[];return Object.keys(c).forEach(function(key){if("require"!==key&&"advanced"!==key&&"mediaSource"!==key){var r=c[key]="object"==typeof c[key]?c[key]:{ideal:c[key]};if(void 0===r.min&&void 0===r.max&&void 0===r.exact||require.push(key),void 0!==r.exact&&("number"==typeof r.exact?r.min=r.max=r.exact:c[key]=r.exact,delete r.exact),void 0!==r.ideal){c.advanced=c.advanced||[];var oc={};"number"==typeof r.ideal?oc[key]={min:r.ideal,max:r.ideal}:oc[key]=r.ideal,c.advanced.push(oc),delete r.ideal,Object.keys(r).length||delete c[key]}}}),require.length&&(c.require=require),c};return webrtcDetectedVersion<38&&(webrtcUtils.log("spec: "+JSON.stringify(constraints)),constraints.audio&&(constraints.audio=constraintsToFF37(constraints.audio)),constraints.video&&(constraints.video=constraintsToFF37(constraints.video)),webrtcUtils.log("ff37: "+JSON.stringify(constraints))),navigator.mozGetUserMedia(constraints,onSuccess,onError)},navigator.getUserMedia=getUserMedia,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:requestUserMedia,addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(resolve){var infos=[{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}];resolve(infos)})},webrtcDetectedVersion<41){var orgEnumerateDevices=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return orgEnumerateDevices().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}}else if(navigator.webkitGetUserMedia&&window.webkitRTCPeerConnection&&!window.RTCPeerConnection){webrtcUtils.log("This appears to be Chrome"),webrtcDetectedBrowser="chrome",webrtcDetectedVersion=webrtcUtils.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2),webrtcMinimumVersion=38,window.RTCPeerConnection=function(pcConfig,pcConstraints){pcConfig&&pcConfig.iceTransportPolicy&&(pcConfig.iceTransports=pcConfig.iceTransportPolicy);var pc=new webkitRTCPeerConnection(pcConfig,pcConstraints),origGetStats=pc.getStats.bind(pc);return pc.getStats=function(selector,successCallback,errorCallback){var self=this,args=arguments;if(arguments.length>0&&"function"==typeof selector)return origGetStats(selector,successCallback);var fixChromeStats=function(response){var standardReport={},reports=response.result();return reports.forEach(function(report){var standardStats={id:report.id,timestamp:report.timestamp,type:report.type};report.names().forEach(function(name){standardStats[name]=report.stat(name)}),standardReport[standardStats.id]=standardStats}),standardReport};if(arguments.length>=2){var successCallbackWrapper=function(response){args[1](fixChromeStats(response))};return origGetStats.apply(this,[successCallbackWrapper,arguments[0]])}return new Promise(function(resolve,reject){1===args.length&&null===selector?origGetStats.apply(self,[function(response){resolve.apply(null,[fixChromeStats(response)])},reject]):origGetStats.apply(self,[resolve,reject])})},pc},webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return arguments.length?webkitRTCPeerConnection.generateCertificate.apply(null,arguments):webkitRTCPeerConnection.generateCertificate}}),["createOffer","createAnswer"].forEach(function(method){var nativeMethod=webkitRTCPeerConnection.prototype[method];webkitRTCPeerConnection.prototype[method]=function(){var self=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var opts=1===arguments.length?arguments[0]:void 0;return new Promise(function(resolve,reject){nativeMethod.apply(self,[resolve,reject,opts])})}return nativeMethod.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(method){var nativeMethod=webkitRTCPeerConnection.prototype[method];webkitRTCPeerConnection.prototype[method]=function(){var args=arguments,self=this;return new Promise(function(resolve,reject){nativeMethod.apply(self,[args[0],function(){resolve(),args.length>=2&&args[1].apply(null,[])},function(err){reject(err),args.length>=3&&args[2].apply(null,[err])}])})}});var constraintsToChrome=function(c){if("object"!=typeof c||c.mandatory||c.optional)return c;var cc={};return Object.keys(c).forEach(function(key){if("require"!==key&&"advanced"!==key&&"mediaSource"!==key){var r="object"==typeof c[key]?c[key]:{ideal:c[key]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var oldname=function(prefix,name){return prefix?prefix+name.charAt(0).toUpperCase()+name.slice(1):"deviceId"===name?"sourceId":name};if(void 0!==r.ideal){cc.optional=cc.optional||[];var oc={};"number"==typeof r.ideal?(oc[oldname("min",key)]=r.ideal,cc.optional.push(oc),oc={},oc[oldname("max",key)]=r.ideal,cc.optional.push(oc)):(oc[oldname("",key)]=r.ideal,cc.optional.push(oc))}void 0!==r.exact&&"number"!=typeof r.exact?(cc.mandatory=cc.mandatory||{},cc.mandatory[oldname("",key)]=r.exact):["min","max"].forEach(function(mix){void 0!==r[mix]&&(cc.mandatory=cc.mandatory||{},cc.mandatory[oldname(mix,key)]=r[mix])})}}),c.advanced&&(cc.optional=(cc.optional||[]).concat(c.advanced)),cc};if(getUserMedia=function(constraints,onSuccess,onError){return constraints.audio&&(constraints.audio=constraintsToChrome(constraints.audio)),constraints.video&&(constraints.video=constraintsToChrome(constraints.video)),webrtcUtils.log("chrome: "+JSON.stringify(constraints)),navigator.webkitGetUserMedia(constraints,onSuccess,onError)},navigator.getUserMedia=getUserMedia,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:requestUserMedia,enumerateDevices:function(){return new Promise(function(resolve){var kinds={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(devices){
resolve(devices.map(function(device){return{label:device.label,kind:kinds[device.kind],deviceId:device.id,groupId:""}}))})})}}),navigator.mediaDevices.getUserMedia){var origGetUserMedia=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(c){return webrtcUtils.log("spec:   "+JSON.stringify(c)),c.audio=constraintsToChrome(c.audio),c.video=constraintsToChrome(c.video),webrtcUtils.log("chrome: "+JSON.stringify(c)),origGetUserMedia(c)}}else navigator.mediaDevices.getUserMedia=function(constraints){return requestUserMedia(constraints)};"undefined"==typeof navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){webrtcUtils.log("Dummy mediaDevices.addEventListener called.")}),"undefined"==typeof navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){webrtcUtils.log("Dummy mediaDevices.removeEventListener called.")}),attachMediaStream=function(element,stream){webrtcDetectedVersion>=43?element.srcObject=stream:"undefined"!=typeof element.src?element.src=URL.createObjectURL(stream):webrtcUtils.log("Error attaching stream to element.")},reattachMediaStream=function(to,from){webrtcDetectedVersion>=43?to.srcObject=from.srcObject:to.src=from.src}}else if(navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)){if(webrtcUtils.log("This appears to be Edge"),webrtcDetectedBrowser="edge",webrtcDetectedVersion=webrtcUtils.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2),webrtcMinimumVersion=10547,window.RTCIceGatherer){var generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},localCName=generateIdentifier(),SDPUtils={};SDPUtils.splitLines=function(blob){return blob.trim().split("\n").map(function(line){return line.trim()})},SDPUtils.splitSections=function(blob){var parts=blob.split("\r\nm=");return parts.map(function(part,index){return(index>0?"m="+part:part).trim()+"\r\n"})},SDPUtils.matchPrefix=function(blob,prefix){return SDPUtils.splitLines(blob).filter(function(line){return 0===line.indexOf(prefix)})},SDPUtils.parseCandidate=function(line){var parts;parts=0===line.indexOf("a=candidate:")?line.substring(12).split(" "):line.substring(10).split(" ");for(var candidate={foundation:parts[0],component:parts[1],protocol:parts[2].toLowerCase(),priority:parseInt(parts[3],10),ip:parts[4],port:parseInt(parts[5],10),type:parts[7]},i=8;i<parts.length;i+=2)switch(parts[i]){case"raddr":candidate.relatedAddress=parts[i+1];break;case"rport":candidate.relatedPort=parseInt(parts[i+1],10);break;case"tcptype":candidate.tcpType=parts[i+1]}return candidate},SDPUtils.writeCandidate=function(candidate){var sdp=[];sdp.push(candidate.foundation),sdp.push(candidate.component),sdp.push(candidate.protocol.toUpperCase()),sdp.push(candidate.priority),sdp.push(candidate.ip),sdp.push(candidate.port);var type=candidate.type;return sdp.push("typ"),sdp.push(type),"host"!==type&&candidate.relatedAddress&&candidate.relatedPort&&(sdp.push("raddr"),sdp.push(candidate.relatedAddress),sdp.push("rport"),sdp.push(candidate.relatedPort)),candidate.tcpType&&"tcp"===candidate.protocol.toLowerCase()&&(sdp.push("tcptype"),sdp.push(candidate.tcpType)),"candidate:"+sdp.join(" ")},SDPUtils.parseRtpMap=function(line){var parts=line.substr(9).split(" "),parsed={payloadType:parseInt(parts.shift(),10)};return parts=parts[0].split("/"),parsed.name=parts[0],parsed.clockRate=parseInt(parts[1],10),parsed.numChannels=3===parts.length?parseInt(parts[2],10):1,parsed},SDPUtils.writeRtpMap=function(codec){var pt=codec.payloadType;return void 0!==codec.preferredPayloadType&&(pt=codec.preferredPayloadType),"a=rtpmap:"+pt+" "+codec.name+"/"+codec.clockRate+(1!==codec.numChannels?"/"+codec.numChannels:"")+"\r\n"},SDPUtils.parseFmtp=function(line){for(var kv,parsed={},parts=line.substr(line.indexOf(" ")+1).split(";"),j=0;j<parts.length;j++)kv=parts[j].trim().split("="),parsed[kv[0].trim()]=kv[1];return parsed},SDPUtils.writeFtmp=function(codec){var line="",pt=codec.payloadType;if(void 0!==codec.preferredPayloadType&&(pt=codec.preferredPayloadType),codec.parameters&&codec.parameters.length){var params=[];Object.keys(codec.parameters).forEach(function(param){params.push(param+"="+codec.parameters[param])}),line+="a=fmtp:"+pt+" "+params.join(";")+"\r\n"}return line},SDPUtils.parseRtcpFb=function(line){var parts=line.substr(line.indexOf(" ")+1).split(" ");return{type:parts.shift(),parameter:parts.join(" ")}},SDPUtils.writeRtcpFb=function(codec){var lines="",pt=codec.payloadType;return void 0!==codec.preferredPayloadType&&(pt=codec.preferredPayloadType),codec.rtcpFeedback&&codec.rtcpFeedback.length&&codec.rtcpFeedback.forEach(function(fb){lines+="a=rtcp-fb:"+pt+" "+fb.type+" "+fb.parameter+"\r\n"}),lines},SDPUtils.parseSsrcMedia=function(line){var sp=line.indexOf(" "),parts={ssrc:line.substr(7,sp-7)},colon=line.indexOf(":",sp);return colon>-1?(parts.attribute=line.substr(sp+1,colon-sp-1),parts.value=line.substr(colon+1)):parts.attribute=line.substr(sp+1),parts},SDPUtils.getDtlsParameters=function(mediaSection,sessionpart){var lines=SDPUtils.splitLines(mediaSection);lines=lines.concat(SDPUtils.splitLines(sessionpart));var fpLine=lines.filter(function(line){return 0===line.indexOf("a=fingerprint:")})[0].substr(14),dtlsParameters={role:"auto",fingerprints:[{algorithm:fpLine.split(" ")[0],value:fpLine.split(" ")[1]}]};return dtlsParameters},SDPUtils.writeDtlsParameters=function(params,setupType){var sdp="a=setup:"+setupType+"\r\n";return params.fingerprints.forEach(function(fp){sdp+="a=fingerprint:"+fp.algorithm+" "+fp.value+"\r\n"}),sdp},SDPUtils.getIceParameters=function(mediaSection,sessionpart){var lines=SDPUtils.splitLines(mediaSection);lines=lines.concat(SDPUtils.splitLines(sessionpart));var iceParameters={usernameFragment:lines.filter(function(line){return 0===line.indexOf("a=ice-ufrag:")})[0].substr(12),password:lines.filter(function(line){return 0===line.indexOf("a=ice-pwd:")})[0].substr(10)};return iceParameters},SDPUtils.writeIceParameters=function(params){return"a=ice-ufrag:"+params.usernameFragment+"\r\na=ice-pwd:"+params.password+"\r\n"},SDPUtils.parseRtpParameters=function(mediaSection){for(var description={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},lines=SDPUtils.splitLines(mediaSection),mline=lines[0].split(" "),i=3;i<mline.length;i++){var pt=mline[i],rtpmapline=SDPUtils.matchPrefix(mediaSection,"a=rtpmap:"+pt+" ")[0];if(rtpmapline){var codec=SDPUtils.parseRtpMap(rtpmapline),fmtps=SDPUtils.matchPrefix(mediaSection,"a=fmtp:"+pt+" ");codec.parameters=fmtps.length?SDPUtils.parseFmtp(fmtps[0]):{},codec.rtcpFeedback=SDPUtils.matchPrefix(mediaSection,"a=rtcp-fb:"+pt+" ").map(SDPUtils.parseRtcpFb),description.codecs.push(codec)}}return description},SDPUtils.writeRtpDescription=function(kind,caps){var sdp="";return sdp+="m="+kind+" ",sdp+=caps.codecs.length>0?"9":"0",sdp+=" UDP/TLS/RTP/SAVPF ",sdp+=caps.codecs.map(function(codec){return void 0!==codec.preferredPayloadType?codec.preferredPayloadType:codec.payloadType}).join(" ")+"\r\n",sdp+="c=IN IP4 0.0.0.0\r\n",sdp+="a=rtcp:9 IN IP4 0.0.0.0\r\n",caps.codecs.forEach(function(codec){sdp+=SDPUtils.writeRtpMap(codec),sdp+=SDPUtils.writeFtmp(codec),sdp+=SDPUtils.writeRtcpFb(codec)}),sdp+="a=rtcp-mux\r\n"},SDPUtils.writeSessionBoilerplate=function(){return"v=0\r\no=thisisadapterortc 8169639915646943137 2 IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},SDPUtils.writeMediaSection=function(transceiver,caps,type,stream){var sdp=SDPUtils.writeRtpDescription(transceiver.kind,caps);if(sdp+=SDPUtils.writeIceParameters(transceiver.iceGatherer.getLocalParameters()),sdp+=SDPUtils.writeDtlsParameters(transceiver.dtlsTransport.getLocalParameters(),"offer"===type?"actpass":"active"),sdp+="a=mid:"+transceiver.mid+"\r\n",sdp+=transceiver.rtpSender&&transceiver.rtpReceiver?"a=sendrecv\r\n":transceiver.rtpSender?"a=sendonly\r\n":transceiver.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",transceiver.rtpSender){var msid="msid:"+stream.id+" "+transceiver.rtpSender.track.id+"\r\n";sdp+="a="+msid,sdp+="a=ssrc:"+transceiver.sendSsrc+" "+msid}return sdp+="a=ssrc:"+transceiver.sendSsrc+" cname:"+localCName+"\r\n"},SDPUtils.getDirection=function(mediaSection,sessionpart){for(var lines=SDPUtils.splitLines(mediaSection),i=0;i<lines.length;i++)switch(lines[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return lines[i].substr(2)}return sessionpart?SDPUtils.getDirection(sessionpart):"sendrecv"},window.RTCIceCandidate||(window.RTCIceCandidate=function(args){return args}),window.RTCSessionDescription||(window.RTCSessionDescription=function(args){return args}),window.RTCPeerConnection=function(config){var self=this;if(this.onicecandidate=null,this.onaddstream=null,this.onremovestream=null,this.onsignalingstatechange=null,this.oniceconnectionstatechange=null,this.onnegotiationneeded=null,this.ondatachannel=null,this.localStreams=[],this.remoteStreams=[],this.getLocalStreams=function(){return self.localStreams},this.getRemoteStreams=function(){return self.remoteStreams},this.localDescription=new RTCSessionDescription({type:"",sdp:""}),this.remoteDescription=new RTCSessionDescription({type:"",sdp:""}),this.signalingState="stable",this.iceConnectionState="new",this.iceOptions={gatherPolicy:"all",iceServers:[]},config&&config.iceTransportPolicy)switch(config.iceTransportPolicy){case"all":case"relay":this.iceOptions.gatherPolicy=config.iceTransportPolicy;break;case"none":throw new TypeError('iceTransportPolicy "none" not supported')}config&&config.iceServers&&config.iceServers.forEach(function(server){if(server.urls){var url;url="string"==typeof server.urls?server.urls:server.urls[0],url.indexOf("transport=udp")!==-1&&self.iceServers.push({username:server.username,credential:server.credential,urls:url})}}),this.transceivers=[],this._localIceCandidatesBuffer=[]},window.RTCPeerConnection.prototype._emitBufferedCandidates=function(){var self=this;this._localIceCandidatesBuffer.forEach(function(event){null!==self.onicecandidate&&self.onicecandidate(event)}),this._localIceCandidatesBuffer=[]},window.RTCPeerConnection.prototype.addStream=function(stream){this.localStreams.push(stream.clone()),this._maybeFireNegotiationNeeded()},window.RTCPeerConnection.prototype.removeStream=function(stream){var idx=this.localStreams.indexOf(stream);idx>-1&&(this.localStreams.splice(idx,1),this._maybeFireNegotiationNeeded())},window.RTCPeerConnection.prototype._getCommonCapabilities=function(localCapabilities,remoteCapabilities){var commonCapabilities={codecs:[],headerExtensions:[],fecMechanisms:[]};return localCapabilities.codecs.forEach(function(lCodec){for(var i=0;i<remoteCapabilities.codecs.length;i++){var rCodec=remoteCapabilities.codecs[i];if(lCodec.name.toLowerCase()===rCodec.name.toLowerCase()&&lCodec.clockRate===rCodec.clockRate&&lCodec.numChannels===rCodec.numChannels){commonCapabilities.codecs.push(rCodec);break}}}),localCapabilities.headerExtensions.forEach(function(lHeaderExtension){for(var i=0;i<remoteCapabilities.headerExtensions.length;i++){var rHeaderExtension=remoteCapabilities.headerExtensions[i];if(lHeaderExtension.uri===rHeaderExtension.uri){commonCapabilities.headerExtensions.push(rHeaderExtension);break}}}),commonCapabilities},window.RTCPeerConnection.prototype._createIceAndDtlsTransports=function(mid,sdpMLineIndex){var self=this,iceGatherer=new RTCIceGatherer(self.iceOptions),iceTransport=new RTCIceTransport(iceGatherer);iceGatherer.onlocalcandidate=function(evt){var event={};event.candidate={sdpMid:mid,sdpMLineIndex:sdpMLineIndex};var cand=evt.candidate;cand&&0!==Object.keys(cand).length?(cand.component="RTCP"===iceTransport.component?2:1,event.candidate.candidate=SDPUtils.writeCandidate(cand)):(void 0===iceGatherer.state&&(iceGatherer.state="completed"),event.candidate.candidate="candidate:1 1 udp 1 0.0.0.0 9 typ endOfCandidates");var complete=self.transceivers.every(function(transceiver){return transceiver.iceGatherer&&"completed"===transceiver.iceGatherer.state});null!==self.onicecandidate&&(self.localDescription&&""===self.localDescription.type?(self._localIceCandidatesBuffer.push(event),complete&&self._localIceCandidatesBuffer.push({})):(self.onicecandidate(event),complete&&self.onicecandidate({})))},iceTransport.onicestatechange=function(){self._updateConnectionState()};var dtlsTransport=new RTCDtlsTransport(iceTransport);return dtlsTransport.ondtlsstatechange=function(){self._updateConnectionState()},dtlsTransport.onerror=function(){dtlsTransport.state="failed",self._updateConnectionState()},{iceGatherer:iceGatherer,iceTransport:iceTransport,dtlsTransport:dtlsTransport}},window.RTCPeerConnection.prototype._transceive=function(transceiver,send,recv){var params=this._getCommonCapabilities(transceiver.localCapabilities,transceiver.remoteCapabilities);send&&transceiver.rtpSender&&(params.encodings=[{ssrc:transceiver.sendSsrc}],params.rtcp={cname:localCName,ssrc:transceiver.recvSsrc},transceiver.rtpSender.send(params)),recv&&transceiver.rtpReceiver&&(params.encodings=[{ssrc:transceiver.recvSsrc}],params.rtcp={cname:transceiver.cname,ssrc:transceiver.sendSsrc},transceiver.rtpReceiver.receive(params))},window.RTCPeerConnection.prototype.setLocalDescription=function(description){var self=this;if("offer"===description.type)this._pendingOffer&&(this.transceivers=this._pendingOffer,delete this._pendingOffer);else if("answer"===description.type){var sections=SDPUtils.splitSections(self.remoteDescription.sdp),sessionpart=sections.shift();sections.forEach(function(mediaSection,sdpMLineIndex){var transceiver=self.transceivers[sdpMLineIndex],iceGatherer=transceiver.iceGatherer,iceTransport=transceiver.iceTransport,dtlsTransport=transceiver.dtlsTransport,localCapabilities=transceiver.localCapabilities,remoteCapabilities=transceiver.remoteCapabilities,rejected="0"===mediaSection.split("\n",1)[0].split(" ",2)[1];if(!rejected){var remoteIceParameters=SDPUtils.getIceParameters(mediaSection,sessionpart);iceTransport.start(iceGatherer,remoteIceParameters,"controlled");var remoteDtlsParameters=SDPUtils.getDtlsParameters(mediaSection,sessionpart);dtlsTransport.start(remoteDtlsParameters);var params=self._getCommonCapabilities(localCapabilities,remoteCapabilities);self._transceive(transceiver,params.codecs.length>0,!1)}})}switch(this.localDescription=description,description.type){case"offer":this._updateSignalingState("have-local-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+description.type+'"')}var hasCallback=arguments.length>1&&"function"==typeof arguments[1];if(hasCallback){var cb=arguments[1];window.setTimeout(function(){cb(),self._emitBufferedCandidates()},0)}var p=Promise.resolve();return p.then(function(){hasCallback||window.setTimeout(self._emitBufferedCandidates.bind(self),0)}),p},window.RTCPeerConnection.prototype.setRemoteDescription=function(description){var self=this,stream=new MediaStream,sections=SDPUtils.splitSections(description.sdp),sessionpart=sections.shift();switch(sections.forEach(function(mediaSection,sdpMLineIndex){var transceiver,iceGatherer,iceTransport,dtlsTransport,rtpSender,rtpReceiver,sendSsrc,recvSsrc,localCapabilities,remoteIceParameters,remoteDtlsParameters,lines=SDPUtils.splitLines(mediaSection),mline=lines[0].substr(2).split(" "),kind=mline[0],rejected="0"===mline[1],direction=SDPUtils.getDirection(mediaSection,sessionpart),remoteCapabilities=SDPUtils.parseRtpParameters(mediaSection);rejected||(remoteIceParameters=SDPUtils.getIceParameters(mediaSection,sessionpart),remoteDtlsParameters=SDPUtils.getDtlsParameters(mediaSection,sessionpart));var cname,mid=SDPUtils.matchPrefix(mediaSection,"a=mid:")[0].substr(6),remoteSsrc=SDPUtils.matchPrefix(mediaSection,"a=ssrc:").map(function(line){return SDPUtils.parseSsrcMedia(line)}).filter(function(obj){return"cname"===obj.attribute})[0];if(remoteSsrc&&(recvSsrc=parseInt(remoteSsrc.ssrc,10),cname=remoteSsrc.value),"offer"===description.type){var transports=self._createIceAndDtlsTransports(mid,sdpMLineIndex);if(localCapabilities=RTCRtpReceiver.getCapabilities(kind),sendSsrc=1001*(2*sdpMLineIndex+2),rtpReceiver=new RTCRtpReceiver(transports.dtlsTransport,kind),stream.addTrack(rtpReceiver.track),self.localStreams.length>0&&self.localStreams[0].getTracks().length>=sdpMLineIndex){var localtrack=self.localStreams[0].getTracks()[sdpMLineIndex];rtpSender=new RTCRtpSender(localtrack,transports.dtlsTransport)}self.transceivers[sdpMLineIndex]={iceGatherer:transports.iceGatherer,iceTransport:transports.iceTransport,dtlsTransport:transports.dtlsTransport,localCapabilities:localCapabilities,remoteCapabilities:remoteCapabilities,rtpSender:rtpSender,rtpReceiver:rtpReceiver,kind:kind,mid:mid,cname:cname,sendSsrc:sendSsrc,recvSsrc:recvSsrc},self._transceive(self.transceivers[sdpMLineIndex],!1,"sendrecv"===direction||"sendonly"===direction)}else"answer"!==description.type||rejected||(transceiver=self.transceivers[sdpMLineIndex],iceGatherer=transceiver.iceGatherer,iceTransport=transceiver.iceTransport,dtlsTransport=transceiver.dtlsTransport,rtpSender=transceiver.rtpSender,rtpReceiver=transceiver.rtpReceiver,sendSsrc=transceiver.sendSsrc,localCapabilities=transceiver.localCapabilities,self.transceivers[sdpMLineIndex].recvSsrc=recvSsrc,self.transceivers[sdpMLineIndex].remoteCapabilities=remoteCapabilities,self.transceivers[sdpMLineIndex].cname=cname,iceTransport.start(iceGatherer,remoteIceParameters,"controlling"),dtlsTransport.start(remoteDtlsParameters),self._transceive(transceiver,"sendrecv"===direction||"recvonly"===direction,"sendrecv"===direction||"sendonly"===direction),!rtpReceiver||"sendrecv"!==direction&&"sendonly"!==direction?delete transceiver.rtpReceiver:stream.addTrack(rtpReceiver.track))}),this.remoteDescription=description,description.type){case"offer":this._updateSignalingState("have-remote-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+description.type+'"')}return window.setTimeout(function(){null!==self.onaddstream&&stream.getTracks().length&&(self.remoteStreams.push(stream),window.setTimeout(function(){self.onaddstream({stream:stream})},0))},0),arguments.length>1&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},window.RTCPeerConnection.prototype.close=function(){this.transceivers.forEach(function(transceiver){transceiver.iceTransport&&transceiver.iceTransport.stop(),transceiver.dtlsTransport&&transceiver.dtlsTransport.stop(),transceiver.rtpSender&&transceiver.rtpSender.stop(),transceiver.rtpReceiver&&transceiver.rtpReceiver.stop()}),this._updateSignalingState("closed")},window.RTCPeerConnection.prototype._updateSignalingState=function(newState){this.signalingState=newState,null!==this.onsignalingstatechange&&this.onsignalingstatechange()},window.RTCPeerConnection.prototype._maybeFireNegotiationNeeded=function(){null!==this.onnegotiationneeded&&this.onnegotiationneeded()},window.RTCPeerConnection.prototype._updateConnectionState=function(){var newState,self=this,states={new:0,closed:0,connecting:0,checking:0,connected:0,completed:0,failed:0};this.transceivers.forEach(function(transceiver){states[transceiver.iceTransport.state]++,states[transceiver.dtlsTransport.state]++}),states.connected+=states.completed,newState="new",states.failed>0?newState="failed":states.connecting>0||states.checking>0?newState="connecting":states.disconnected>0?newState="disconnected":states.new>0?newState="new":(states.connecting>0||states.completed>0)&&(newState="connected"),newState!==self.iceConnectionState&&(self.iceConnectionState=newState,null!==this.oniceconnectionstatechange&&this.oniceconnectionstatechange())},window.RTCPeerConnection.prototype.createOffer=function(){var self=this;if(this._pendingOffer)throw new Error("createOffer called while there is a pending offer.");var offerOptions;1===arguments.length&&"function"!=typeof arguments[0]?offerOptions=arguments[0]:3===arguments.length&&(offerOptions=arguments[2]);var tracks=[],numAudioTracks=0,numVideoTracks=0;if(this.localStreams.length&&(numAudioTracks=this.localStreams[0].getAudioTracks().length,numVideoTracks=this.localStreams[0].getVideoTracks().length),offerOptions){if(offerOptions.mandatory||offerOptions.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==offerOptions.offerToReceiveAudio&&(numAudioTracks=offerOptions.offerToReceiveAudio),void 0!==offerOptions.offerToReceiveVideo&&(numVideoTracks=offerOptions.offerToReceiveVideo)}for(this.localStreams.length&&this.localStreams[0].getTracks().forEach(function(track){tracks.push({kind:track.kind,track:track,wantReceive:"audio"===track.kind?numAudioTracks>0:numVideoTracks>0}),"audio"===track.kind?numAudioTracks--:"video"===track.kind&&numVideoTracks--});numAudioTracks>0||numVideoTracks>0;)numAudioTracks>0&&(tracks.push({kind:"audio",wantReceive:!0}),numAudioTracks--),numVideoTracks>0&&(tracks.push({kind:"video",wantReceive:!0}),numVideoTracks--);var sdp=SDPUtils.writeSessionBoilerplate(),transceivers=[];tracks.forEach(function(mline,sdpMLineIndex){var rtpSender,rtpReceiver,track=mline.track,kind=mline.kind,mid=generateIdentifier(),transports=self._createIceAndDtlsTransports(mid,sdpMLineIndex),localCapabilities=RTCRtpSender.getCapabilities(kind),sendSsrc=1001*(2*sdpMLineIndex+1);track&&(rtpSender=new RTCRtpSender(track,transports.dtlsTransport)),mline.wantReceive&&(rtpReceiver=new RTCRtpReceiver(transports.dtlsTransport,kind)),transceivers[sdpMLineIndex]={iceGatherer:transports.iceGatherer,iceTransport:transports.iceTransport,dtlsTransport:transports.dtlsTransport,localCapabilities:localCapabilities,remoteCapabilities:null,rtpSender:rtpSender,rtpReceiver:rtpReceiver,kind:kind,mid:mid,sendSsrc:sendSsrc,recvSsrc:null};var transceiver=transceivers[sdpMLineIndex];sdp+=SDPUtils.writeMediaSection(transceiver,transceiver.localCapabilities,"offer",self.localStreams[0])}),this._pendingOffer=transceivers;var desc=new RTCSessionDescription({type:"offer",sdp:sdp});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,desc),Promise.resolve(desc)},window.RTCPeerConnection.prototype.createAnswer=function(){var answerOptions,self=this;1===arguments.length&&"function"!=typeof arguments[0]?answerOptions=arguments[0]:3===arguments.length&&(answerOptions=arguments[2]);var sdp=SDPUtils.writeSessionBoilerplate();this.transceivers.forEach(function(transceiver){var commonCapabilities=self._getCommonCapabilities(transceiver.localCapabilities,transceiver.remoteCapabilities);sdp+=SDPUtils.writeMediaSection(transceiver,commonCapabilities,"answer",self.localStreams[0])});var desc=new RTCSessionDescription({type:"answer",sdp:sdp});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,desc),Promise.resolve(desc)},window.RTCPeerConnection.prototype.addIceCandidate=function(candidate){var mLineIndex=candidate.sdpMLineIndex;if(candidate.sdpMid)for(var i=0;i<this.transceivers.length;i++)if(this.transceivers[i].mid===candidate.sdpMid){mLineIndex=i;break}var transceiver=this.transceivers[mLineIndex];if(transceiver){var cand=Object.keys(candidate.candidate).length>0?SDPUtils.parseCandidate(candidate.candidate):{};if("tcp"===cand.protocol&&0===cand.port)return;if("1"!==cand.component)return;"endOfCandidates"===cand.type&&(cand={}),transceiver.iceTransport.addRemoteCandidate(cand)}return arguments.length>1&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},window.RTCPeerConnection.prototype.getStats=function(){var promises=[];this.transceivers.forEach(function(transceiver){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(method){transceiver[method]&&promises.push(transceiver[method].getStats())})});var cb=arguments.length>1&&"function"==typeof arguments[1]&&arguments[1];return new Promise(function(resolve){var results={};Promise.all(promises).then(function(res){res.forEach(function(result){Object.keys(result).forEach(function(id){results[id]=result[id]})}),cb&&window.setTimeout(cb,0,results),resolve(results)})})}}}else webrtcUtils.log("Browser does not appear to be WebRTC-capable");else webrtcUtils.log("This does not appear to be a browser"),webrtcDetectedBrowser="not a browser";"object"!=typeof window||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection||Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(f){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=f),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.getTracks().forEach(function(track){var event=new Event("track");event.track=track,event.receiver={track:track},event.streams=[e.stream],this.dispatchEvent(event)}.bind(this))}.bind(this))}});var webrtcTesting={};try{Object.defineProperty(webrtcTesting,"version",{set:function(version){webrtcDetectedVersion=version}})}catch(e){}var Easyrtc=function(){function isEmptyObj(obj){if(null===obj||void 0===obj)return!0;var key;for(key in obj)if(obj.hasOwnProperty(key))return!1;return!0}function stopStream(stream){var i,tracks;for(tracks=stream.getAudioTracks(),i=0;i<tracks.length;i++)try{tracks[i].stop()}catch(err){}for(tracks=stream.getVideoTracks(),i=0;i<tracks.length;i++)try{tracks[i].stop()}catch(err){}if("function"==typeof stream.stop)try{stream.stop()}catch(err){}}function isSocketConnected(socket){return socket&&(socket.socket&&socket.socket.connected||socket.connected)}function event(eventName,callingFunction){if("string"!=typeof eventName)throw self.showError(self.errCodes.DEVELOPER_ERR,callingFunction+" called without a string as the first argument"),"developer error";if(!allowedEvents[eventName])throw self.showError(self.errCodes.DEVELOPER_ERR,callingFunction+" called with a bad event name = "+eventName),"developer error"}function getSourceList(callback,sourceType){navigator.mediaDevices.enumerateDevices().then(function(values){for(var results=[],i=0;i<values.length;i++){var source=values[i];source.kind===sourceType&&results.push(source)}callback(results)}).catch(function(reason){webrtcUtils.log("Unable to enumerate devices ("+reason+")")})}function sendRoomApiFields(roomName,fields){var fieldAsString=JSON.stringify(fields);JSON.parse(fieldAsString);var dataToShip={msgType:"setRoomApiField",msgData:{setRoomApiField:{roomName:roomName,field:fields}}};self.webSocket.json.emit("easyrtcCmd",dataToShip,function(ackMsg){"error"===ackMsg.msgType&&self.showError(ackMsg.msgData.errorCode,ackMsg.msgData.errorText)})}function enqueueSendRoomApi(roomName){roomApiFieldTimer&&clearTimeout(roomApiFieldTimer),roomApiFieldTimer=setTimeout(function(){sendRoomApiFields(roomName,self._roomApiFields[roomName]),roomApiFieldTimer=null},10)}function enableMediaTracks(enable,tracks){var i;if(tracks)for(i=0;i<tracks.length;i++){var track=tracks[i];track.enabled=enable}}function getLocalMediaStreamByName(streamName){return streamName||(streamName="default"),namedLocalMediaStreams.hasOwnProperty(streamName)?namedLocalMediaStreams[streamName]:null}function buildMediaIds(){var streamName,mediaMap={};for(streamName in namedLocalMediaStreams)namedLocalMediaStreams.hasOwnProperty(streamName)&&(mediaMap[streamName]=namedLocalMediaStreams[streamName].id||"default");return mediaMap}function registerLocalMediaStreamByName(stream,streamName){var roomName;if(streamName||(streamName="default"),stream.streamName=streamName,namedLocalMediaStreams[streamName]=stream,"default"!==streamName){var mediaIds=buildMediaIds(),roomData=self.roomData;for(roomName in roomData)roomData.hasOwnProperty(roomName)&&self.setRoomApiField(roomName,"mediaIds",mediaIds)}}function getNameOfRemoteStream(easyrtcId,webrtcStreamId){var roomName,mediaIds,streamName;if(webrtcStreamId||(webrtcStreamId="default"),peerConns[easyrtcId]&&(streamName=peerConns[easyrtcId].remoteStreamIdToName[webrtcStreamId]))return streamName;for(roomName in self.roomData)if(self.roomData.hasOwnProperty(roomName)){if(mediaIds=self.getRoomApiField(roomName,easyrtcId,"mediaIds"),!mediaIds)continue;for(streamName in mediaIds)if(mediaIds.hasOwnProperty(streamName)&&mediaIds[streamName]===webrtcStreamId)return streamName;if("firefox"===webrtcDetectedBrowser){if(mediaIds.default)return"default";for(var anyName in mediaIds)if(mediaIds.hasOwnProperty(anyName))return anyName}}}function closeLocalMediaStreamByName(streamName){streamName||(streamName="default");var stream=self.getLocalStream(streamName);if(stream){var id,roomName,streamId=stream.id||"default";if(namedLocalMediaStreams[streamName]){for(id in peerConns)if(peerConns.hasOwnProperty(id)){try{peerConns[id].pc.removeStream(stream)}catch(err){}self.sendPeerMessage(id,"__closingMediaStream",{streamId:streamId,streamName:streamName})}if(stopStream(namedLocalMediaStreams[streamName]),delete namedLocalMediaStreams[streamName],"default"!==streamName){var mediaIds=buildMediaIds();for(roomName in self.roomData)self.roomData.hasOwnProperty(roomName)&&self.setRoomApiField(roomName,"mediaIds",mediaIds)}}}}function _haveTracks(easyrtcid,checkAudio,streamName){var stream,peerConnObj;if(easyrtcid){if(peerConnObj=peerConns[easyrtcid],!peerConnObj)return self.showError(self.errCodes.DEVELOPER_ERR,"haveTracks called about a peer you don't have a connection to"),!1;stream=peerConnObj.getRemoteStreamByName(streamName)}else stream=getLocalMediaStreamByName(streamName);if(!stream)return!1;var tracks;try{tracks=checkAudio?stream.getAudioTracks():stream.getVideoTracks()}catch(oops){return!0}return!!tracks&&tracks.length>0}function disconnectBody(){var key;if(self.loggingOut=!0,offersPending={},acceptancePending={},self.disconnecting=!0,closedChannel=self.webSocket,self.webSocketConnected&&(preallocatedSocketIo||self.webSocket.close(),self.webSocketConnected=!1),self.hangupAll(),roomOccupantListener)for(key in lastLoggedInList)lastLoggedInList.hasOwnProperty(key)&&roomOccupantListener(key,{},!1);lastLoggedInList={},self.emitEvent("roomOccupant",{}),self.roomData={},self.roomJoin={},self.loggingOut=!1,self.myEasyrtcid=null,self.disconnecting=!1,oldConfig={}}function sendSignalling(destUser,msgType,msgData,successCallback,errorCallback){if(!self.webSocket)throw"Attempt to send message without a valid connection to the server.";var dataToShip={msgType:msgType};destUser&&(dataToShip.targetEasyrtcid=destUser),msgData&&(dataToShip.msgData=msgData),self.debugPrinter&&self.debugPrinter("sending socket message "+JSON.stringify(dataToShip)),self.webSocket.json.emit("easyrtcCmd",dataToShip,function(ackMsg){"error"!==ackMsg.msgType?(ackMsg.hasOwnProperty("msgData")||(ackMsg.msgData=null),successCallback&&successCallback(ackMsg.msgType,ackMsg.msgData)):errorCallback?errorCallback(ackMsg.msgData.errorCode,ackMsg.msgData.errorText):self.showError(ackMsg.msgData.errorCode,ackMsg.msgData.errorText)})}function sendByChunkHelper(destUser,msgData){var pos,len,startMessage,message,endMessage,transferId=destUser+"-"+sendByChunkUidCounter++,numberOfChunks=Math.ceil(msgData.length/self.maxP2PMessageLength);for(startMessage={transfer:"start",transferId:transferId,parts:numberOfChunks},endMessage={transfer:"end",transferId:transferId},peerConns[destUser].dataChannelS.send(JSON.stringify(startMessage)),pos=0,len=msgData.length;pos<len;pos+=self.maxP2PMessageLength)message={transferId:transferId,data:msgData.substr(pos,self.maxP2PMessageLength),transfer:"chunk"},peerConns[destUser].dataChannelS.send(JSON.stringify(message));peerConns[destUser].dataChannelS.send(JSON.stringify(endMessage))}function buildPeerConstraints(){var options=[];return options.push({DtlsSrtpKeyAgreement:"true"}),{optional:options}}function sendQueuedCandidates(peer,onSignalSuccess,onSignalFailure){var i;for(i=0;i<peerConns[peer].candidatesToSend.length;i++)sendSignalling(peer,"candidate",peerConns[peer].candidatesToSend[i],onSignalSuccess,onSignalFailure);
}function emitOnStreamClosed(easyrtcid,stream){if(peerConns[easyrtcid]){var streamName,id;id=stream.id?stream.id:"default",streamName=peerConns[easyrtcid].remoteStreamIdToName[id]||"default",peerConns[easyrtcid].liveRemoteStreams[streamName]&&self.onStreamClosed&&(delete peerConns[easyrtcid].liveRemoteStreams[streamName],self.onStreamClosed(easyrtcid,stream,streamName)),delete peerConns[easyrtcid].remoteStreamIdToName[id]}}function onRemoveStreamHelper(easyrtcid,stream){if(peerConns[easyrtcid]&&(emitOnStreamClosed(easyrtcid,stream),updateConfigurationInfo(),peerConns[easyrtcid].pc))try{peerConns[easyrtcid].pc.removeStream(stream)}catch(err){}}function buildDeltaRecord(added,deleted){function objectNotEmpty(obj){var i;for(i in obj)if(obj.hasOwnProperty(i))return!0;return!1}var result={};return objectNotEmpty(added)&&(result.added=added),objectNotEmpty(deleted)&&(result.deleted=deleted),objectNotEmpty(result)?result:null}function findDeltas(oldVersion,newVersion){var i,subPart,added={},deleted={};for(i in newVersion)newVersion.hasOwnProperty(i)&&(null===oldVersion||"undefined"==typeof oldVersion[i]?added[i]=newVersion[i]:"object"==typeof newVersion[i]?(subPart=findDeltas(oldVersion[i],newVersion[i]),null!==subPart&&(added[i]=newVersion[i])):newVersion[i]!==oldVersion[i]&&(added[i]=newVersion[i]));for(i in oldVersion)newVersion.hasOwnProperty(i)&&"undefined"==typeof newVersion[i]&&(deleted[i]=oldVersion[i]);return buildDeltaRecord(added,deleted)}function collectConfigurationInfo(){var i,p2pList={};for(i in peerConns)peerConns.hasOwnProperty(i)&&(p2pList[i]={connectTime:peerConns[i].connectTime,isInitiator:!!peerConns[i].isInitiator});var newConfig={userSettings:{sharingAudio:!!haveAudioVideo.audio,sharingVideo:!!haveAudioVideo.video,sharingData:!!dataEnabled,nativeVideoWidth:self.nativeVideoWidth,nativeVideoHeight:self.nativeVideoHeight,windowWidth:window.innerWidth,windowHeight:window.innerHeight,screenWidth:window.screen.width,screenHeight:window.screen.height,cookieEnabled:navigator.cookieEnabled,os:navigator.oscpu,language:navigator.language}};return isEmptyObj(p2pList)||(newConfig.p2pList=p2pList),newConfig}function updateConfiguration(){var newConfig=collectConfigurationInfo(!1),sendDeltas=function(){var alteredData=findDeltas(oldConfig,newConfig);alteredData&&(self.debugPrinter&&self.debugPrinter("cfg="+JSON.stringify(alteredData.added)),self.webSocket&&sendSignalling(null,"setUserCfg",{setUserCfg:alteredData.added},null,null)),oldConfig=newConfig};oldConfig==={}?sendDeltas():setTimeout(sendDeltas,100)}function buildPeerConnection(otherUser,isInitiator,failureCB,streamNames){function dataChannelMessageHandler(event){if(self.debugPrinter&&self.debugPrinter("saw dataChannel.onmessage event: "+JSON.stringify(event.data)),"dataChannelPrimed"===event.data)self.sendDataWS(otherUser,"dataChannelPrimed","");else try{var msg=JSON.parse(event.data);if(msg)if(msg.transfer&&msg.transferId)if("start"===msg.transfer){self.debugPrinter&&self.debugPrinter("start transfer #"+msg.transferId);var parts=parseInt(msg.parts);pendingTransfer={chunks:[],parts:parts,transferId:msg.transferId}}else if("chunk"===msg.transfer)self.debugPrinter&&self.debugPrinter("got chunk for transfer #"+msg.transferId),"string"==typeof msg.data&&msg.data.length<=self.maxP2PMessageLength?pendingTransfer?msg.transferId!==pendingTransfer.transferId?webrtcUtils.log("Developer error, invalid transfer id"):pendingTransfer.chunks.length+1>pendingTransfer.parts?webrtcUtils.log("Developer error, received too many chunks"):pendingTransfer.chunks.push(msg.data):webrtcUtils.log("Developer error, unexpected chunk"):webrtcUtils.log("Developer error, invalid data");else if("end"===msg.transfer){if(self.debugPrinter&&self.debugPrinter("end of transfer #"+msg.transferId),pendingTransfer)if(msg.transferId!==pendingTransfer.transferId)webrtcUtils.log("Developer error, invalid transfer id");else if(pendingTransfer.chunks.length!==pendingTransfer.parts)webrtcUtils.log("Developer error, received wrong number of chunks");else try{var chunkedMsg=JSON.parse(pendingTransfer.chunks.join(""));self.receivePeerDistribute(otherUser,chunkedMsg,null)}catch(err){webrtcUtils.log("Developer error, unable to parse message")}else webrtcUtils.log("Developer error, unexpected end of transfer");pendingTransfer={}}else webrtcUtils.log("Developer error, got an unknown transfer message"+msg.transfer);else self.receivePeerDistribute(otherUser,msg,null)}catch(err){}}function initOutGoingChannel(otherUser){self.debugPrinter&&self.debugPrinter("saw initOutgoingChannel call");var dataChannel=pc.createDataChannel(dataChannelName,self.getDatachannelConstraints());peerConns[otherUser].dataChannelS=dataChannel,peerConns[otherUser].dataChannelR=dataChannel,dataChannel.onmessage=dataChannelMessageHandler,dataChannel.onopen=function(event){self.debugPrinter&&self.debugPrinter("saw dataChannel.onopen event"),peerConns[otherUser]&&dataChannel.send("dataChannelPrimed")},dataChannel.onclose=function(event){self.debugPrinter&&self.debugPrinter("saw dataChannelS.onclose event"),peerConns[otherUser]&&(peerConns[otherUser].dataChannelReady=!1,delete peerConns[otherUser].dataChannelS),onDataChannelClose&&onDataChannelClose(otherUser),updateConfigurationInfo()}}function initIncomingChannel(otherUser){self.debugPrinter&&self.debugPrinter("initializing incoming channel handler for "+otherUser),peerConns[otherUser].pc.ondatachannel=function(event){self.debugPrinter&&self.debugPrinter("saw incoming data channel");var dataChannel=event.channel;peerConns[otherUser].dataChannelR=dataChannel,peerConns[otherUser].dataChannelS=dataChannel,peerConns[otherUser].dataChannelReady=!0,dataChannel.onmessage=dataChannelMessageHandler,dataChannel.onclose=function(event){self.debugPrinter&&self.debugPrinter("saw dataChannelR.onclose event"),peerConns[otherUser]&&(peerConns[otherUser].dataChannelReady=!1,delete peerConns[otherUser].dataChannelR),onDataChannelClose&&onDataChannelClose(otherUser),updateConfigurationInfo()},dataChannel.onopen=function(event){self.debugPrinter&&self.debugPrinter("saw dataChannel.onopen event"),peerConns[otherUser]&&dataChannel.send("dataChannelPrimed")}}}var pc,message,newPeerConn,iceConfig=pc_config_to_use?pc_config_to_use:pc_config;self.debugPrinter&&self.debugPrinter("building peer connection to "+otherUser);try{if(pc=self.createRTCPeerConnection(iceConfig,buildPeerConstraints()),!pc)throw message="Unable to create PeerConnection object, check your ice configuration("+JSON.stringify(iceConfig)+")",self.debugPrinter&&self.debugPrinter(message),message;dataEnabled&&"undefined"==typeof pc.createDataChannel&&(dataEnabled=!1),pc.onnegotiationneeded=function(event){peerConns[otherUser]&&peerConns[otherUser].enableNegotiateListener&&pc.createOffer(function(sdp){sdpLocalFilter&&(sdp.sdp=sdpLocalFilter(sdp.sdp)),pc.setLocalDescription(sdp,function(){self.sendPeerMessage(otherUser,"__addedMediaStream",{sdp:sdp})},function(){})},function(error){webrtcUtils.log("unexpected error in creating offer")})},pc.oniceconnectionstatechange=function(ev){iceConnectionStateChangeListener&&iceConnectionStateChangeListener(otherUser,ev.target);var connState=ev.currentTarget?ev.currentTarget.iceConnectionState:"unknown";switch(connState){case"connected":peerConns[otherUser]&&peerConns[otherUser].callSuccessCB&&peerConns[otherUser].callSuccessCB(otherUser,"connection");break;case"failed":failureCB&&failureCB(self.errCodes.NOVIABLEICE,"No usable STUN/TURN path"),delete peerConns[otherUser];break;case"disconnected":self.onPeerFailing&&self.onPeerFailing(otherUser),peerConns[otherUser]&&(peerConns[otherUser].failing=Date.now());break;case"closed":self.onPeerClosed&&self.onPeerClosed(otherUser);break;case"connected":case"completed":peerConns[otherUser]&&(peerConns[otherUser].failing&&self.onPeerRecovered&&self.onPeerRecovered(otherUser,peerConns[otherUser].failing,Date.now()),delete peerConns[otherUser].failing),delete peerConns[otherUser].failing}},pc.onconnection=function(){self.debugPrinter&&self.debugPrinter("onconnection called prematurely")},newPeerConn={pc:pc,candidatesToSend:[],startedAV:!1,connectionAccepted:!1,isInitiator:isInitiator,remoteStreamIdToName:{},streamsAddedAcks:{},liveRemoteStreams:{},getRemoteStreamByName:function(streamName){var i,roomName,remoteStreams=pc.getRemoteStreams(),keyToMatch=null;if(streamName||(streamName="default"),"default"===streamName)return remoteStreams.length>0?remoteStreams[0]:null;for(roomName in self.roomData)if(self.roomData.hasOwnProperty(roomName)){var mediaIds=self.getRoomApiField(roomName,otherUser,"mediaIds");if(keyToMatch=mediaIds?mediaIds[streamName]:null)break}for(keyToMatch||self.showError(self.errCodes.DEVELOPER_ERR,"remote peer does not have media stream called "+streamName),i=0;i<remoteStreams.length;i++){var remoteId;if(remoteId=remoteStreams[i].id?remoteStreams[i].id:"default",!keyToMatch||remoteId===keyToMatch)return remoteStreams[i]}return null}},pc.onicecandidate=function(event){if(!peerConns[otherUser]||!peerConns[otherUser].cancelled){var candidateData;if(event.candidate&&peerConns[otherUser]){if(candidateData={type:"candidate",label:event.candidate.sdpMLineIndex,id:event.candidate.sdpMid,candidate:event.candidate.candidate},iceCandidateFilter&&(candidateData=iceCandidateFilter(candidateData,!1),!candidateData))return;if(event.candidate.candidate.indexOf("typ relay")>0){var ipAddress=event.candidate.candidate.match(/(udp|tcp) \d+ (\d+\.\d+\.\d+\.\d+)/i)[2];self._turnServers[ipAddress]=!0}peerConns[otherUser].connectionAccepted?sendSignalling(otherUser,"candidate",candidateData,null,function(){failureCB(self.errCodes.PEER_GONE,"Candidate disappeared")}):peerConns[otherUser].candidatesToSend.push(candidateData)}}},pc.onaddstream=function(event){if(!peerConns[otherUser]||!peerConns[otherUser].cancelled){self.debugPrinter&&self.debugPrinter("saw incoming media stream"),peerConns[otherUser].startedAV||(peerConns[otherUser].startedAV=!0,peerConns[otherUser].sharingAudio=haveAudioVideo.audio,peerConns[otherUser].sharingVideo=haveAudioVideo.video,peerConns[otherUser].connectTime=(new Date).getTime(),peerConns[otherUser].callSuccessCB&&(peerConns[otherUser].sharingAudio||peerConns[otherUser].sharingVideo)&&peerConns[otherUser].callSuccessCB(otherUser,"audiovideo"),(self.audioEnabled||self.videoEnabled)&&updateConfiguration());var remoteName=getNameOfRemoteStream(otherUser,event.stream.id||"default");remoteName||(remoteName="default"),peerConns[otherUser].remoteStreamIdToName[event.stream.id||"default"]=remoteName,peerConns[otherUser].liveRemoteStreams[remoteName]=!0,event.stream.streamName=remoteName,self.streamAcceptor&&(self.streamAcceptor(otherUser,event.stream,remoteName),self.sendDataWS(otherUser,"easyrtc_streamReceived",{streamName:remoteName},function(){}))}},pc.onremovestream=function(event){self.debugPrinter&&self.debugPrinter("saw remove on remote media stream"),onRemoveStreamHelper(otherUser,event.stream)},peerConns[otherUser]=newPeerConn}catch(e){return self.debugPrinter&&self.debugPrinter(JSON.stringify(e)),failureCB(self.errCodes.SYSTEM_ERR,e.message),null}var i,stream;if(streamNames)for(i=0;i<streamNames.length;i++)stream=getLocalMediaStreamByName(streamNames[i]),stream?pc.addStream(stream):webrtcUtils.log("Developer error, attempt to access unknown local media stream "+streamNames[i]);else autoInitUserMedia&&(self.videoEnabled||self.audioEnabled)&&(stream=self.getLocalStream(),pc.addStream(stream));var pendingTransfer={};if(dataEnabled){if(self.setPeerListener(function(){peerConns[otherUser].dataChannelReady=!0,peerConns[otherUser].callSuccessCB&&peerConns[otherUser].callSuccessCB(otherUser,"datachannel"),onDataChannelOpen&&onDataChannelOpen(otherUser,!0),updateConfigurationInfo()},"dataChannelPrimed",otherUser),isInitiator)try{initOutGoingChannel(otherUser)}catch(channelErrorEvent){webrtcUtils.log("failed to init outgoing channel"),failureCB(self.errCodes.SYSTEM_ERR,self.formatError(channelErrorEvent))}isInitiator||initIncomingChannel(otherUser)}return pc.onconnection=function(){self.debugPrinter&&self.debugPrinter("setup pc.onconnection ")},self.setPeerListener(function(easyrtcid,msgType,msgData,targeting){newPeerConn.streamsAddedAcks[msgData.streamName]&&(newPeerConn.streamsAddedAcks[msgData.streamName](easyrtcid,msgData.streamName),delete newPeerConn.streamsAddedAcks[msgData.streamName])},"easyrtc_streamReceived",otherUser),pc}function doAnswerBody(caller,msgData,streamNames){var pc=buildPeerConnection(caller,!1,function(message){self.showError(self.errCodes.SYSTEM_ERR,message)},streamNames),newPeerConn=peerConns[caller];if(!pc)return void(self.debugPrinter&&self.debugPrinter("buildPeerConnection failed. Call not answered"));var setLocalAndSendMessage1=function(sessionDescription){if(!newPeerConn.cancelled){var sendAnswer=function(){function onSignalSuccess(){}function onSignalFailure(errorCode,errorText){delete peerConns[caller],self.showError(errorCode,errorText)}self.debugPrinter&&self.debugPrinter("sending answer"),sendSignalling(caller,"answer",sessionDescription,onSignalSuccess,onSignalFailure),peerConns[caller].connectionAccepted=!0,sendQueuedCandidates(caller,onSignalSuccess,onSignalFailure),pc.connectDataConnection&&(self.debugPrinter&&self.debugPrinter("calling connectDataConnection(5002,5001)"),pc.connectDataConnection(5002,5001))};sdpLocalFilter&&(sessionDescription.sdp=sdpLocalFilter(sessionDescription.sdp)),pc.setLocalDescription(sessionDescription,sendAnswer,function(message){self.showError(self.errCodes.INTERNAL_ERR,"setLocalDescription: "+message)})}},sd=new RTCSessionDescription(msgData);if(!sd)throw"Could not create the RTCSessionDescription";self.debugPrinter&&self.debugPrinter("sdp ||  "+JSON.stringify(sd));var invokeCreateAnswer=function(){newPeerConn.cancelled||pc.createAnswer(setLocalAndSendMessage1,function(message){self.showError(self.errCodes.INTERNAL_ERR,"create-answer: "+message)},receivedMediaConstraints)};self.debugPrinter&&self.debugPrinter("about to call setRemoteDescription in doAnswer");try{sdpRemoteFilter&&(sd.sdp=sdpRemoteFilter(sd.sdp)),pc.setRemoteDescription(sd,invokeCreateAnswer,function(message){self.showError(self.errCodes.INTERNAL_ERR,"set-remote-description: "+message)})}catch(srdError){webrtcUtils.log("set remote description failed"),self.debugPrinter&&self.debugPrinter("saw exception in setRemoteDescription"),self.showError(self.errCodes.INTERNAL_ERR,"setRemoteDescription failed: "+srdError.message)}}function doAnswer(caller,msgData,streamNames){if(!streamNames&&autoInitUserMedia){var localStream=self.getLocalStream();if(!localStream&&(self.videoEnabled||self.audioEnabled))return void self.initMediaSource(function(){doAnswer(caller,msgData)},function(errorCode,error){self.showError(self.errCodes.MEDIA_ERR,self.format(self.getConstantString("localMediaError")))})}use_fresh_ice_each_peer?self.getFreshIceConfig(function(succeeded){succeeded?doAnswerBody(caller,msgData,streamNames):self.showError(self.errCodes.CALL_ERR,"Failed to get fresh ice config")}):doAnswerBody(caller,msgData,streamNames)}function callBody(otherUser,callSuccessCB,callFailureCB,wasAcceptedCB,streamNames){acceptancePending[otherUser]=!0;var message,pc=buildPeerConnection(otherUser,!0,callFailureCB,streamNames);if(!pc)throw message="buildPeerConnection failed, call not completed",self.debugPrinter&&self.debugPrinter(message),message;peerConns[otherUser].callSuccessCB=callSuccessCB,peerConns[otherUser].callFailureCB=callFailureCB,peerConns[otherUser].wasAcceptedCB=wasAcceptedCB;var peerConnObj=peerConns[otherUser],setLocalAndSendMessage0=function(sessionDescription){if(!peerConnObj.cancelled){var sendOffer=function(){sendSignalling(otherUser,"offer",sessionDescription,null,callFailureCB)};sdpLocalFilter&&(sessionDescription.sdp=sdpLocalFilter(sessionDescription.sdp)),pc.setLocalDescription(sessionDescription,sendOffer,function(errorText){callFailureCB(self.errCodes.CALL_ERR,errorText)})}};setTimeout(function(){peerConns[otherUser]&&pc.createOffer(setLocalAndSendMessage0,function(errorObj){callFailureCB(self.errCodes.CALL_ERR,JSON.stringify(errorObj))},receivedMediaConstraints)},100)}function isStreamActive(stream){var isActive;return isActive=stream.active===!0||stream.ended===!1||stream.getTracks().reduce(function(track){return track.enabled})}function clearQueuedMessages(caller){queuedMessages[caller]={candidates:[]}}function hangupBody(otherUser){var i;if(self.debugPrinter&&self.debugPrinter("Hanging up on "+otherUser),clearQueuedMessages(otherUser),peerConns[otherUser]){if(peerConns[otherUser].pc){var remoteStreams=peerConns[otherUser].pc.getRemoteStreams();for(i=0;i<remoteStreams.length;i++)isStreamActive(remoteStreams[i])&&(emitOnStreamClosed(otherUser,remoteStreams[i]),stopStream(remoteStreams[i]));try{peerConns[otherUser].pc.close()}catch(err){self.debugPrinter&&self.debugPrinter("peer close failed:"+err)}}peerConns[otherUser].cancelled=!0,delete peerConns[otherUser],self.webSocket&&sendSignalling(otherUser,"hangup",null,function(){},function(errorCode,errorText){self.debugPrinter&&self.debugPrinter("hangup failed:"+errorText)}),acceptancePending[otherUser]&&delete acceptancePending[otherUser]}}function onRemoteHangup(caller){if(delete offersPending[caller],self.debugPrinter&&self.debugPrinter("Saw onRemote hangup event"),peerConns[caller]){if(peerConns[caller].cancelled=!0,peerConns[caller].pc){var remoteStreams=peerConns[caller].pc.getRemoteStreams();if(remoteStreams){var i;for(i=0;i<remoteStreams.length;i++){emitOnStreamClosed(caller,remoteStreams[i]);try{stopStream(remoteStreams[i])}catch(err){}}}try{peerConns[caller].pc.close()}catch(anyErrors){}}else self.callCancelled&&self.callCancelled(caller,!0);delete peerConns[caller],updateConfigurationInfo()}else self.callCancelled&&self.callCancelled(caller,!0)}function isPeerInAnyRoom(id){var roomName;for(roomName in lastLoggedInList)if(lastLoggedInList.hasOwnProperty(roomName)&&lastLoggedInList[roomName][id])return!0;return!1}function processLostPeers(peersInRoom){var id;for(id in peerConns)peerConns.hasOwnProperty(id)&&"undefined"==typeof peersInRoom[id]&&(isPeerInAnyRoom(id)||((peerConns[id].pc||peerConns[id].isInitiator)&&onRemoteHangup(id),delete offersPending[id],delete acceptancePending[id],clearQueuedMessages(id)));for(id in offersPending)offersPending.hasOwnProperty(id)&&!isPeerInAnyRoom(id)&&(onRemoteHangup(id),clearQueuedMessages(id),delete offersPending[id],delete acceptancePending[id]);for(id in acceptancePending)acceptancePending.hasOwnProperty(id)&&!isPeerInAnyRoom(id)&&(onRemoteHangup(id),clearQueuedMessages(id),delete acceptancePending[id])}function addAggregatingTimer(key,callback,period){period||(period=100);var counter=0;aggregatingTimers[key]&&(clearTimeout(aggregatingTimers[key].timer),counter=aggregatingTimers[key].counter),counter>20?(delete aggregatingTimers[key],callback()):(aggregatingTimers[key]={counter:counter+1},aggregatingTimers[key].timer=setTimeout(function(){delete aggregatingTimers[key],callback()},period))}function processOccupantList(roomName,occupantList){var id,myInfo=null,reducedList={};for(id in occupantList)occupantList.hasOwnProperty(id)&&(id===self.myEasyrtcid?myInfo=occupantList[id]:reducedList[id]=occupantList[id]);processLostPeers(reducedList),addAggregatingTimer("roomOccupants&"+roomName,function(){roomOccupantListener&&roomOccupantListener(roomName,reducedList,myInfo),self.emitEvent("roomOccupants",{roomName:roomName,occupants:lastLoggedInList})},100)}function onChannelMsg(msg,ackAcceptorFunc){var targeting={};ackAcceptorFunc&&ackAcceptorFunc(self.ackMessage),msg.targetEasyrtcid&&(targeting.targetEasyrtcid=msg.targetEasyrtcid),msg.targetRoom&&(targeting.targetRoom=msg.targetRoom),msg.targetGroup&&(targeting.targetGroup=msg.targetGroup),msg.senderEasyrtcid?self.receivePeerDistribute(msg.senderEasyrtcid,msg,targeting):receiveServerCB?receiveServerCB(msg.msgType,msg.msgData,targeting):webrtcUtils.log("Unhandled server message "+JSON.stringify(msg))}function processUrl(url){var ipAddress;0!==url.indexOf("turn:")&&0!==url.indexOf("turns:")||(ipAddress=url.split(/[@:&]/g)[1],self._turnServers[ipAddress]=!0)}function processIceConfig(iceConfig){var i,j,item;for(pc_config={iceServers:[]},self._turnServers={},iceConfig&&iceConfig.iceServers&&"undefined"!=typeof iceConfig.iceServers.length?pc_config={iceServers:iceConfig.iceServers}:self.showError(self.errCodes.DEVELOPER_ERR,"iceConfig received from server didn't have an array called iceServers, ignoring it"),i=0;i<iceConfig.iceServers.length;i++)if(item=iceConfig.iceServers[i],item.urls&&item.urls.length)for(j=0;j<item.urls.length;j++)processUrl(item.urls[j]);else item.url&&processUrl(item.url)}function processSessionData(sessionData){sessionData&&(sessionData.easyrtcsid&&(self.easyrtcsid=sessionData.easyrtcsid),sessionData.field&&(sessionFields=sessionData.field))}function processRoomData(roomData){self.roomData=roomData;var k,roomName,stuffToRemove,stuffToAdd,id,removeId;for(roomName in self.roomData)if(self.roomData.hasOwnProperty(roomName)){if("join"===roomData[roomName].roomStatus){self.roomJoin[roomName]||(self.roomJoin[roomName]=roomData[roomName]);var mediaIds=buildMediaIds();mediaIds!=={}&&self.setRoomApiField(roomName,"mediaIds",mediaIds)}else if("leave"===roomData[roomName].roomStatus){self.roomEntryListener&&self.roomEntryListener(!1,roomName),delete self.roomJoin[roomName],delete lastLoggedInList[roomName];continue}if(roomData[roomName].clientList)lastLoggedInList[roomName]=roomData[roomName].clientList;else if(roomData[roomName].clientListDelta){if(stuffToAdd=roomData[roomName].clientListDelta.updateClient)for(id in stuffToAdd)if(stuffToAdd.hasOwnProperty(id)){lastLoggedInList[roomName]||(lastLoggedInList[roomName]=[]),lastLoggedInList[roomName][id]||(lastLoggedInList[roomName][id]=stuffToAdd[id]);for(k in stuffToAdd[id])"apiField"!==k&&"presence"!==k||(lastLoggedInList[roomName][id][k]=stuffToAdd[id][k])}if(stuffToRemove=roomData[roomName].clientListDelta.removeClient,stuffToRemove&&lastLoggedInList[roomName])for(removeId in stuffToRemove)stuffToRemove.hasOwnProperty(removeId)&&delete lastLoggedInList[roomName][removeId]}self.roomJoin[roomName]&&roomData[roomName].field&&(fields.rooms[roomName]=roomData[roomName].field),"join"===roomData[roomName].roomStatus&&self.roomEntryListener&&self.roomEntryListener(!0,roomName),processOccupantList(roomName,lastLoggedInList[roomName])}self.emitEvent("roomOccupant",lastLoggedInList)}function onChannelCmd(msg,ackAcceptorFn){function processReject(caller){delete acceptancePending[caller],queuedMessages[caller]&&delete queuedMessages[caller],peerConns[caller]&&(peerConns[caller].wasAcceptedCB&&peerConns[caller].wasAcceptedCB(!1,caller),delete peerConns[caller])}function processAnswer(caller,msgData){if(delete acceptancePending[caller],peerConns[caller]){peerConns[caller].connectionAccepted=!0,peerConns[caller].wasAcceptedCB&&peerConns[caller].wasAcceptedCB(!0,caller);var onSignalSuccess=function(){},onSignalFailure=function(errorCode,errorText){peerConns[caller]&&delete peerConns[caller],self.showError(errorCode,errorText)};sendQueuedCandidates(caller,onSignalSuccess,onSignalFailure),pc=peerConns[caller].pc;var sd=new RTCSessionDescription(msgData);if(!sd)throw"Could not create the RTCSessionDescription";self.debugPrinter&&self.debugPrinter("about to call initiating setRemoteDescription");try{sdpRemoteFilter&&(sd.sdp=sdpRemoteFilter(sd.sdp)),pc.setRemoteDescription(sd,function(){pc.connectDataConnection&&(self.debugPrinter&&self.debugPrinter("calling connectDataConnection(5001,5002)"),pc.connectDataConnection(5001,5002))},function(message){webrtcUtils.log("setRemoteDescription failed ",message)})}catch(smdException){webrtcUtils.log("setRemoteDescription failed ",smdException)}flushCachedCandidates(caller)}}function processCandidateQueue(caller,msgData){peerConns[caller]&&peerConns[caller].pc?processCandidateBody(caller,msgData):(peerConns[caller]||(queuedMessages[caller]={candidates:[]}),queuedMessages[caller].candidates.push(msgData))}var pc,caller=msg.senderEasyrtcid,msgType=msg.msgType,msgData=msg.msgData;self.debugPrinter&&self.debugPrinter("received message of type "+msgType),"undefined"==typeof queuedMessages[caller]&&clearQueuedMessages(caller);var processCandidateBody=function(caller,msgData){function iceAddSuccess(){}function iceAddFailure(domError){self.showError(self.errCodes.ICECANDIDATE_ERR,"bad ice candidate ("+domError.name+"): "+JSON.stringify(candidate))}var candidate=null;if((!iceCandidateFilter||(msgData=iceCandidateFilter(msgData,!0)))&&(candidate=new RTCIceCandidate({sdpMLineIndex:msgData.label,candidate:msgData.candidate}),pc=peerConns[caller].pc,pc.addIceCandidate(candidate,iceAddSuccess,iceAddFailure),msgData.candidate.indexOf("typ relay")>0)){var ipAddress=msgData.candidate.match(/(udp|tcp) \d+ (\d+\.\d+\.\d+\.\d+)/i)[2];self._turnServers[ipAddress]=!0}},flushCachedCandidates=function(caller){var i;if(queuedMessages[caller]){for(i=0;i<queuedMessages[caller].candidates.length;i++)processCandidateBody(caller,queuedMessages[caller].candidates[i]);delete queuedMessages[caller]}},processOffer=function(caller,msgData){var helper=function(wasAccepted,streamNames){if(streamNames)if("string"==typeof streamNames)streamNames=[streamNames];else if(void 0===streamNames.length)return void self.showError(self.errCodes.DEVELOPER_ERR,"accept callback passed invalid streamNames");if(self.debugPrinter&&self.debugPrinter("offer accept="+wasAccepted),delete offersPending[caller],wasAccepted){if(!self.supportsPeerConnections())return void self.showError(self.errCodes.CALL_ERR,self.getConstantString("noWebrtcSupport"));doAnswer(caller,msgData,streamNames),flushCachedCandidates(caller)}else sendSignalling(caller,"reject",null,null,null),clearQueuedMessages(caller)};return acceptancePending[caller]&&caller<self.myEasyrtcid?(delete acceptancePending[caller],queuedMessages[caller]&&delete queuedMessages[caller],peerConns[caller].wasAcceptedCB&&peerConns[caller].wasAcceptedCB(!0,caller),delete peerConns[caller],void helper(!0)):(offersPending[caller]=msgData,void(self.acceptCheck?self.acceptCheck(caller,helper):helper(!0)))};switch(msgType){case"sessionData":processSessionData(msgData.sessionData);break;case"roomData":processRoomData(msgData.roomData);break;case"iceConfig":processIceConfig(msgData.iceConfig);break;case"forwardToUrl":msgData.newWindow?window.open(msgData.forwardToUrl.url):window.location.href=msgData.forwardToUrl.url;break;case"offer":processOffer(caller,msgData);break;case"reject":processReject(caller);break;case"answer":processAnswer(caller,msgData);break;case"candidate":processCandidateQueue(caller,msgData);break;case"hangup":onRemoteHangup(caller),clearQueuedMessages(caller);break;case"error":self.showError(msgData.errorCode,msgData.errorText);break;default:return void self.showError(self.errCodes.DEVELOPER_ERR,"received unknown message type from server, msgType is "+msgType)}ackAcceptorFn&&ackAcceptorFn(self.ackMessage)}function processToken(msg){var msgData=msg.msgData;self.debugPrinter&&self.debugPrinter("entered process token"),msgData.easyrtcid&&(self.myEasyrtcid=msgData.easyrtcid),msgData.field&&(fields.connection=msgData.field),msgData.iceConfig&&processIceConfig(msgData.iceConfig),msgData.sessionData&&processSessionData(msgData.sessionData),msgData.roomData&&processRoomData(msgData.roomData),msgData.application.field&&(fields.application=msgData.application.field)}function sendAuthenticate(successCallback,errorCallback){var cookies,target,i,easyrtcsid=null;if(self.cookieId&&document.cookie)for(cookies=document.cookie.split(/[; ]/g),target=self.cookieId+"=",i=0;i<cookies.length;i++)0===cookies[i].indexOf(target)&&(easyrtcsid=cookies[i].substring(target.length));var msgData={apiVersion:self.apiVersion,applicationName:self.applicationName,setUserCfg:collectConfigurationInfo(!0)};self.roomJoin||(self.roomJoin={}),self.presenceShow&&(msgData.setPresence={show:self.presenceShow,status:self.presenceStatus}),self.username&&(msgData.username=self.username),self.roomJoin&&!isEmptyObj(self.roomJoin)&&(msgData.roomJoin=self.roomJoin),easyrtcsid&&(msgData.easyrtcsid=easyrtcsid),credential&&(msgData.credential=credential),self.webSocket.json.emit("easyrtcAuth",{msgType:"authenticate",msgData:msgData},function(msg){var room;if("error"===msg.msgType)errorCallback(msg.msgData.errorCode,msg.msgData.errorText),self.roomJoin={};else{if(processToken(msg),self._roomApiFields)for(room in self._roomApiFields)self._roomApiFields.hasOwnProperty(room)&&enqueueSendRoomApi(room);successCallback&&successCallback(self.myEasyrtcid)}})}function connectToWSServer(successCallback,errorCallback){function addSocketListener(event,handler){self.webSocket.on(event,handler),self.websocketListeners.push({event:event,handler:handler})}function connectHandler(event){self.webSocketConnected=!0,self.webSocket||self.showError(self.errCodes.CONNECT_ERR,self.getConstantString("badsocket")),self.debugPrinter&&self.debugPrinter("saw socket-server onconnect event"),self.webSocketConnected?sendAuthenticate(successCallback,errorCallback):errorCallback(self.errCodes.SIGNAL_ERR,self.getConstantString("icf"))}var i;if(preallocatedSocketIo)self.webSocket=preallocatedSocketIo;else if(self.webSocket)for(i in self.websocketListeners)self.websocketListeners.hasOwnProperty(i)&&self.webSocket.removeEventListener(self.websocketListeners[i].event,self.websocketListeners[i].handler);else try{if(self.webSocket=io.connect(serverPath,connectionOptions),!self.webSocket)throw"io.connect failed"}catch(socketErr){return self.webSocket=0,void errorCallback(self.errCodes.SYSTEM_ERROR,socketErr.toString())}self.websocketListeners=[],addSocketListener("close",function(event){webrtcUtils.log("the web socket closed")}),addSocketListener("error",function(event){function handleErrorEvent(){self.myEasyrtcid&&isSocketConnected(self.webSocket)?self.showError(self.errCodes.SIGNAL_ERR,self.getConstantString("miscSignalError")):errorCallback(self.errCodes.CONNECT_ERR,self.getConstantString("noServer"))}handleErrorEvent()}),isSocketConnected(preallocatedSocketIo)?connectHandler(null):addSocketListener("connect",connectHandler),addSocketListener("easyrtcMsg",onChannelMsg),addSocketListener("easyrtcCmd",onChannelCmd),addSocketListener("disconnect",function(){self.webSocketConnected=!1,updateConfigurationInfo=function(){},oldConfig={},disconnectBody(),self.disconnectListener&&self.disconnectListener()})}var self=this,autoInitUserMedia=!0,sdpLocalFilter=null,sdpRemoteFilter=null,iceCandidateFilter=null,iceConnectionStateChangeListener=null,connectionOptions={"connect timeout":1e4,"force new connection":!0};this.setSdpFilters=function(localFilter,remoteFilter){sdpLocalFilter=localFilter,sdpRemoteFilter=remoteFilter},this.setPeerClosedListener=function(handler){this.onPeerClosed=handler},this.setPeerFailingListener=function(failingHandler,recoveredHandler){this.onPeerFailing=failingHandler,this.onPeerRecovered=recoveredHandler},this.setIceCandidateFilter=function(filter){iceCandidateFilter=filter},this.setIceConnectionStateChangeListener=function(listener){iceConnectionStateChangeListener=listener},this.setAutoInitUserMedia=function(flag){autoInitUserMedia=!!flag},this.format=function(format,arg1,arg2,arg3){for(var formatted=arguments[0],i=1;i<arguments.length;i++){var regexp=new RegExp("\\{"+(i-1)+"\\}","gi");formatted=formatted.replace(regexp,arguments[i])}return formatted};var haveAudioVideo={audio:!1,video:!1};this.getConstantString=function(key){return easyrtc_constantStrings[key]?easyrtc_constantStrings[key]:(self.showError(self.errCodes.DEVELOPER_ERR,"Could not find key='"+key+"' in easyrtc_constantStrings"),key)};var allowedEvents={roomOccupant:!0,roomOccupants:!0},eventListeners={};this.addEventListener=function(eventName,eventListener){if(event(eventName,"addEventListener"),"function"!=typeof eventListener)throw self.showError(self.errCodes.DEVELOPER_ERR,"addEventListener called with a non-function for second argument"),
"developer error";self.removeEventListener(eventName,eventListener),eventListeners[eventName]||(eventListeners[eventName]=[]),eventListeners[eventName][eventListeners[eventName].length]=eventListener},this.removeEventListener=function(eventName,eventListener){event(eventName,"removeEventListener");var listeners=eventListeners[eventName],i=0;if(listeners)for(i=0;i<listeners.length;i++)listeners[i]===eventListener&&(i<listeners.length-1&&(listeners[i]=listeners[listeners.length-1]),listeners.length=listeners.length-1)},this.emitEvent=function(eventName,eventData){event(eventName,"emitEvent");var listeners=eventListeners[eventName],i=0;if(listeners)for(i=0;i<listeners.length;i++)listeners[i](eventName,eventData)},this.errCodes={BAD_NAME:"BAD_NAME",CALL_ERR:"CALL_ERR",DEVELOPER_ERR:"DEVELOPER_ERR",SYSTEM_ERR:"SYSTEM_ERR",CONNECT_ERR:"CONNECT_ERR",MEDIA_ERR:"MEDIA_ERR",MEDIA_WARNING:"MEDIA_WARNING",INTERNAL_ERR:"INTERNAL_ERR",PEER_GONE:"PEER_GONE",ALREADY_CONNECTED:"ALREADY_CONNECTED",BAD_CREDENTIAL:"BAD_CREDENTIAL",ICECANDIDATE_ERR:"ICECANDIDATE_ERR",NOVIABLEICE:"NOVIABLEICE",SIGNAL_ERR:"SIGNAL_ERR"},this.apiVersion="1.0.17",this.ackMessage={msgType:"ack"},this.usernameRegExp=/^(.){1,64}$/,this.cookieId="easyrtcsid";this.loggingOut=!1,this.disconnecting=!1;var namedLocalMediaStreams={},sessionFields=[],receivedMediaConstraints={};this.enableAudioReceive=function(value){"firefox"===webrtcDetectedBrowser?receivedMediaConstraints.offerToReceiveAudio=value:(receivedMediaConstraints.mandatory=receivedMediaConstraints.mandatory||{},receivedMediaConstraints.mandatory.OfferToReceiveAudio=value)},this.enableVideoReceive=function(value){"firefox"===webrtcDetectedBrowser?receivedMediaConstraints.offerToReceiveVideo=value:(receivedMediaConstraints.mandatory=receivedMediaConstraints.mandatory||{},receivedMediaConstraints.mandatory.OfferToReceiveVideo=value)},this.enableAudioReceive(!0),this.enableVideoReceive(!0),this.getAudioSourceList=function(callback){getSourceList(callback,"audioinput")},this.getVideoSourceList=function(callback){getSourceList(callback,"videoinput")},self.audioEnabled=!0,self.videoEnabled=!0;var dataChannelName="dc";this.debugPrinter=null,this.myEasyrtcid="";var oldConfig={},offersPending={};this.nativeVideoHeight=0,this.maxP2PMessageLength=1e3,this.nativeVideoWidth=0;var credential=null;this.roomJoin={},this.isNameValid=function(name){return self.usernameRegExp.test(name)},this.setCookieId=function(cookieId){self.cookieId=cookieId},this._desiredVideoProperties={},this.setVideoSource=function(videoSrcId){self._desiredVideoProperties.videoSrcId=videoSrcId,delete self._desiredVideoProperties.screenCapture},this._desiredAudioProperties={},this.setAudioSource=function(audioSrcId){self._desiredAudioProperties.audioSrcId=audioSrcId},this.setVideoDims=function(width,height,frameRate){self._desiredVideoProperties.width=width,self._desiredVideoProperties.height=height,void 0!==frameRate&&(self._desiredVideoProperties.frameRate=frameRate)},this.setScreenCapture=function(enableScreenCapture){self._desiredVideoProperties.screenCapture=enableScreenCapture!==!1},self.getUserMediaConstraints=function(){var constraints={};return self._presetMediaConstraints?(constraints=self._presetMediaConstraints,delete self._presetMediaConstraints,constraints):self._desiredVideoProperties.screenCapture?{video:{mandatory:{chromeMediaSource:"screen",maxWidth:screen.width,maxHeight:screen.height,minWidth:screen.width,minHeight:screen.height,minFrameRate:1,maxFrameRate:5},optional:[]},audio:!1}:(self.videoEnabled?"firefox"===webrtcDetectedBrowser?(constraints.video={},self._desiredVideoProperties.width&&(constraints.video.width=self._desiredVideoProperties.width),self._desiredVideoProperties.height&&(constraints.video.height=self._desiredVideoProperties.height),self._desiredVideoProperties.frameRate&&(constraints.video.frameRate={max:self._desiredVideoProperties.frameRate}),self._desiredVideoProperties.videoSrcId&&(constraints.video.deviceId=self._desiredVideoProperties.videoSrcId)):(constraints.video={mandatory:{},optional:[]},self._desiredVideoProperties.width&&(constraints.video.mandatory.maxWidth=self._desiredVideoProperties.width,constraints.video.mandatory.minWidth=self._desiredVideoProperties.width),self._desiredVideoProperties.height&&(constraints.video.mandatory.maxHeight=self._desiredVideoProperties.height,constraints.video.mandatory.minHeight=self._desiredVideoProperties.height),self._desiredVideoProperties.frameRate&&(constraints.video.mandatory.maxFrameRate=self._desiredVideoProperties.frameRate),self._desiredVideoProperties.videoSrcId&&(constraints.video.optional=constraints.video.optional||[],constraints.video.optional.push({sourceId:self._desiredVideoProperties.videoSrcId})),0===constraints.video.mandatory.length&&0===constraints.video.optional.length&&(constraints.video=!0)):constraints.video=!1,self.audioEnabled?"firefox"===webrtcDetectedBrowser?(constraints.audio={},self._desiredAudioProperties.audioSrcId&&(constraints.audio.deviceId=self._desiredAudioProperties.audioSrcId)):(constraints.audio={mandatory:{},optional:[]},self._desiredAudioProperties.audioSrcId&&(constraints.audio.optional=constraints.audio.optional||[],constraints.audio.optional.push({sourceId:self._desiredAudioProperties.audioSrcId}))):constraints.audio=!1,constraints)},this.setApplicationName=function(name){self.applicationName=name},this.enableDebug=function(enable){enable?self.debugPrinter=function(message){var stackString=(new Error).stack,srcLine="location unknown";if(stackString){var stackFrameStrings=stackString.split("\n");srcLine="",stackFrameStrings.length>=3&&(srcLine=stackFrameStrings[2])}webrtcUtils.log("debug "+(new Date).toISOString()+" : "+message+" ["+srcLine+"]")}:self.debugPrinter=null},this.supportsGetUserMedia=function(){return!!getUserMedia},this.supportsPeerConnections=function(){return!!self.supportsGetUserMedia()&&!!window.RTCPeerConnection},this.createRTCPeerConnection=function(pc_config,optionalStuff){if(RTCPeerConnection)return new RTCPeerConnection(pc_config,optionalStuff);throw"Your browser doesn't support webRTC (RTCPeerConnection)"},this.getDatachannelConstraints=function(){return"chrome"===webrtcDetectedBrowser&&webrtcDetectedVersion<31?{reliable:!1}:{reliable:!0}},haveAudioVideo={audio:!1,video:!1};var dataEnabled=!1,serverPath=null,roomOccupantListener=null,onDataChannelOpen=null,onDataChannelClose=null,lastLoggedInList={},receivePeer={msgTypes:{}},receiveServerCB=null,updateConfigurationInfo=function(){},peerConns={},acceptancePending={};this.acceptCheck=function(caller,helper){helper(!0)},this.streamAcceptor=function(easyrtcid,stream){},this.onStreamClosed=function(easyrtcid){},this.callCancelled=function(easyrtcid){},this.getPeerConnectionByUserId=function(userId){return peerConns&&peerConns[userId]?peerConns[userId].pc:null};this.getPeerStatistics=function(easyrtcid,callback,filter){"firefox"===webrtcDetectedBrowser?self.getFirefoxPeerStatistics(easyrtcid,callback,filter):self.getChromePeerStatistics(easyrtcid,callback,filter)};var roomApiFieldTimer=null;this.setRoomApiField=function(roomName,fieldName,fieldValue){if(self._roomApiFields||(self._roomApiFields={}),!fieldName&&!fieldValue)return void delete self._roomApiFields[roomName];if(self._roomApiFields[roomName]||(self._roomApiFields[roomName]={}),void 0!==fieldValue&&null!==fieldValue){if("object"==typeof fieldValue)try{JSON.stringify(fieldValue)}catch(jsonError){return void self.showError(self.errCodes.DEVELOPER_ERR,"easyrtc.setRoomApiField passed bad object ")}self._roomApiFields[roomName][fieldName]={fieldName:fieldName,fieldValue:fieldValue}}else delete self._roomApiFields[roomName][fieldName];self.webSocketConnected&&enqueueSendRoomApi(roomName)},this.showError=function(messageCode,message){self.onError({errorCode:messageCode,errorText:message})},this.onError=function(errorObject){self.debugPrinter&&self.debugPrinter("saw error "+errorObject.errorText);var errorBody,errorDiv=document.getElementById("easyrtcErrorDialog");if(!errorDiv){errorDiv=document.createElement("div"),errorDiv.id="easyrtcErrorDialog";var title=document.createElement("div");title.innerHTML="Error messages",title.className="easyrtcErrorDialog_title",errorDiv.appendChild(title),errorBody=document.createElement("div"),errorBody.id="easyrtcErrorDialog_body",errorDiv.appendChild(errorBody);var clearButton=document.createElement("button");clearButton.appendChild(document.createTextNode("Okay")),clearButton.className="easyrtcErrorDialog_okayButton",clearButton.onclick=function(){errorBody.innerHTML="",errorDiv.style.display="none"},errorDiv.appendChild(clearButton),document.body.appendChild(errorDiv)}errorBody=document.getElementById("easyrtcErrorDialog_body");var messageNode=document.createElement("div");messageNode.className="easyrtcErrorDialog_element",messageNode.appendChild(document.createTextNode(errorObject.errorText)),errorBody.appendChild(messageNode),errorDiv.style.display="block"},this.createObjectURL=function(mediaStream){var errMessage;if(window.URL&&window.URL.createObjectURL)return window.URL.createObjectURL(mediaStream);if(window.webkitURL&&window.webkitURL.createObjectURL)return window.webkit.createObjectURL(mediaStream);throw errMessage="Your browsers does not support URL.createObjectURL.",self.debugPrinter&&self.debugPrinter("saw exception "+errMessage),errMessage},this.cleanId=function(idString){var MAP={"&":"&amp;","<":"&lt;",">":"&gt;"};return idString.replace(/[&<>]/g,function(c){return MAP[c]})},self.setRoomEntryListener=function(handler){self.roomEntryListener=handler},self.setRoomOccupantListener=function(listener){roomOccupantListener=listener},this.setDataChannelOpenListener=function(listener){onDataChannelOpen=listener},this.setDataChannelCloseListener=function(listener){onDataChannelClose=listener},this.getConnectionCount=function(){var i,count=0;for(i in peerConns)peerConns.hasOwnProperty(i)&&self.getConnectStatus(i)===self.IS_CONNECTED&&count++;return count},this.setMaxP2PMessageLength=function(maxLength){this.maxP2PMessageLength=maxLength},this.enableAudio=function(enabled){self.audioEnabled=enabled},this.enableVideo=function(enabled){self.videoEnabled=enabled},this.enableDataChannels=function(enabled){dataEnabled=enabled},this.getLocalMediaIds=function(){return Object.keys(namedLocalMediaStreams)},this.register3rdPartyLocalMediaStream=function(stream,streamName){return registerLocalMediaStreamByName(stream,streamName)},this.getNameOfRemoteStream=function(easyrtcId,webrtcStream){return"string"==typeof webrtcStream?getNameOfRemoteStream(easyrtcId,webrtcStream):webrtcStream.id?getNameOfRemoteStream(easyrtcId,webrtcStream.id):void 0},this.closeLocalMediaStream=function(streamName){return closeLocalMediaStreamByName(streamName)},this.closeLocalStream=this.closeLocalMediaStream,this.enableCamera=function(enable,streamName){var stream=getLocalMediaStreamByName(streamName);stream&&stream.getVideoTracks&&enableMediaTracks(enable,stream.getVideoTracks())},this.enableMicrophone=function(enable,streamName){var stream=getLocalMediaStreamByName(streamName);stream&&stream.getAudioTracks&&enableMediaTracks(enable,stream.getAudioTracks())},this.muteVideoObject=function(videoObjectName,mute){var videoObject;if("string"==typeof videoObjectName){if(videoObject=document.getElementById(videoObjectName),!videoObject)throw"Unknown video object "+videoObjectName}else{if(!videoObjectName)throw"muteVideoObject passed a null";videoObject=videoObjectName}videoObject.muted=!!mute},self.getLocalStreamAsUrl=function(streamName){var stream=getLocalMediaStreamByName(streamName);if(null===stream)throw"Developer error: attempt to get a MediaStream without invoking easyrtc.initMediaSource successfully";return self.createObjectURL(stream)},this.getLocalStream=function(streamName){return getLocalMediaStreamByName(streamName)||null},this.clearMediaStream=function(element){"undefined"!=typeof element.src?element.src="":"undefined"!=typeof element.srcObject?element.srcObject="":"undefined"!=typeof element.mozSrcObject&&(element.mozSrcObject=null)},this.setVideoObjectSrc=function(videoObject,stream){stream&&""!==stream?(videoObject.autoplay=!0,attachMediaStream(videoObject,stream),videoObject.play()):self.clearMediaStream(videoObject)},this.buildLocalMediaStream=function(streamName,audioTracks,videoTracks){var i;if("string"!=typeof streamName)return self.showError(self.errCodes.DEVELOPER_ERR,"easyrtc.buildLocalMediaStream not supplied a stream name"),null;var streamToClone=null;for(var key in namedLocalMediaStreams)if(namedLocalMediaStreams.hasOwnProperty(key)&&(streamToClone=namedLocalMediaStreams[key]))break;if(!streamToClone)for(key in peerConns)if(peerConns.hasOwnProperty(key)){var remoteStreams=peerConns[key].pc.getRemoteStreams();remoteStreams&&remoteStreams.length>0&&(streamToClone=remoteStreams[0])}if(!streamToClone)return self.showError(self.errCodes.DEVELOPER_ERR,"Attempt to create a mediastream without one to clone from"),null;var mediaClone=streamToClone.clone(),oldTracks=mediaClone.getTracks();if(audioTracks)for(i=0;i<audioTracks.length;i++)mediaClone.addTrack(audioTracks[i].clone());if(videoTracks)for(i=0;i<videoTracks.length;i++)mediaClone.addTrack(videoTracks[i].clone());for(i=0;i<oldTracks.length;i++)mediaClone.removeTrack(oldTracks[i]);return registerLocalMediaStreamByName(mediaClone,streamName),mediaClone},this.loadStylesheet=function(){var cssIndex,css,links=document.getElementsByTagName("link");for(cssIndex in links)if(links.hasOwnProperty(cssIndex)&&(css=links[cssIndex],css.href&&css.href.match(/\/easyrtc.css/)))return;var easySheet=document.createElement("link");easySheet.setAttribute("rel","stylesheet"),easySheet.setAttribute("type","text/css"),easySheet.setAttribute("href","/easyrtc/easyrtc.css");var headSection=document.getElementsByTagName("head")[0],firstHead=headSection.childNodes[0];headSection.insertBefore(easySheet,firstHead)},this.formatError=function(x){var name,result;if(null===x||"undefined"==typeof x)return"null";if("string"==typeof x)return x;if(x.type&&x.description)return x.type+" : "+x.description;if("object"!=typeof x)return"Strange case";try{return JSON.stringify(x)}catch(oops){result="{";for(name in x)x.hasOwnProperty(name)&&"string"==typeof x[name]&&(result=result+name+"='"+x[name]+"' ");return result+="}"}},this.initMediaSource=function(successCallback,errorCallback,streamName){function getCurrentTime(){return(new Date).getTime()}function tryAgain(error){var currentTime=getCurrentTime();currentTime<firstCallTime+1e3?(webrtcUtils.log("Trying getUserMedia a second time"),setTimeout(function(){getUserMedia(mode,onUserMediaSuccess,onUserMediaError)},3e3)):onUserMediaError(error)}if(self.debugPrinter&&self.debugPrinter("about to request local media"),streamName||(streamName="default"),haveAudioVideo={audio:self.audioEnabled,video:self.videoEnabled},errorCallback||(errorCallback=function(errorCode,errorText){var message="easyrtc.initMediaSource: "+self.formatError(errorText);self.debugPrinter&&self.debugPrinter(message),self.showError(self.errCodes.MEDIA_ERR,message)}),!self.supportsGetUserMedia())return void errorCallback(self.errCodes.MEDIA_ERR,self.getConstantString("noWebrtcSupport"));if(!successCallback)return void self.showError(self.errCodes.DEVELOPER_ERR,"easyrtc.initMediaSource not supplied a successCallback");var mode=self.getUserMediaConstraints(),onUserMediaSuccess=function(stream){self.debugPrinter&&self.debugPrinter("getUserMedia success callback entered"),self.debugPrinter&&self.debugPrinter("successfully got local media"),stream.streamName=streamName,registerLocalMediaStreamByName(stream,streamName);var videoObj,triesLeft,tryToGetSize,ele;haveAudioVideo.video?(videoObj=document.createElement("video"),videoObj.muted=!0,triesLeft=30,tryToGetSize=function(){videoObj.videoWidth>0||triesLeft<0?(self.nativeVideoWidth=videoObj.videoWidth,self.nativeVideoHeight=videoObj.videoHeight,!self._desiredVideoProperties.height||self.nativeVideoHeight===self._desiredVideoProperties.height&&self.nativeVideoWidth===self._desiredVideoProperties.width||self.showError(self.errCodes.MEDIA_WARNING,self.format(self.getConstantString("resolutionWarning"),self._desiredVideoProperties.width,self._desiredVideoProperties.height,self.nativeVideoWidth,self.nativeVideoHeight)),self.setVideoObjectSrc(videoObj,null),videoObj.removeNode?videoObj.removeNode(!0):(ele=document.createElement("div"),ele.appendChild(videoObj),ele.removeChild(videoObj)),updateConfigurationInfo(),successCallback&&successCallback(stream)):(triesLeft-=1,setTimeout(tryToGetSize,300))},self.setVideoObjectSrc(videoObj,stream),tryToGetSize()):(updateConfigurationInfo(),successCallback&&successCallback(stream))},onUserMediaError=function(error){webrtcUtils.log("getusermedia failed"),self.debugPrinter&&self.debugPrinter("failed to get local media");var errText;errText="string"==typeof error?error:error.name?error.name:"Unknown",errorCallback&&(webrtcUtils.log("invoking error callback",errText),errorCallback(self.errCodes.MEDIA_ERR,self.format(self.getConstantString("gumFailed"),errText))),closeLocalMediaStreamByName(streamName),haveAudioVideo={audio:!1,video:!1},updateConfigurationInfo()};if(!self.audioEnabled&&!self.videoEnabled)return void onUserMediaError(self.getConstantString("requireAudioOrVideo"));var firstCallTime;setTimeout(function(){try{firstCallTime=getCurrentTime(),getUserMedia(mode,onUserMediaSuccess,tryAgain)}catch(e){tryAgain(e)}},1e3)},this.setAcceptChecker=function(acceptCheck){self.acceptCheck=acceptCheck},this.setStreamAcceptor=function(acceptor){self.streamAcceptor=acceptor},self.setOnError=function(errListener){self.onError=errListener},this.setCallCancelled=function(callCancelled){self.callCancelled=callCancelled},this.setOnStreamClosed=function(onStreamClosed){self.onStreamClosed=onStreamClosed},this.supportsDataChannels=function(){return navigator.userAgent.match(/android/i)?webrtcDetectedVersion>=34:"firefox"===webrtcDetectedBrowser||webrtcDetectedVersion>=32},this.setPeerListener=function(listener,msgType,source){msgType?(receivePeer.msgTypes[msgType]||(receivePeer.msgTypes[msgType]={sources:{}}),source?receivePeer.msgTypes[msgType].sources[source]={cb:listener}:receivePeer.msgTypes[msgType].cb=listener):receivePeer.cb=listener},this.receivePeerDistribute=function(easyrtcid,msg,targeting){var msgType=msg.msgType,msgData=msg.msgData;if(!msgType)return void webrtcUtils.log("received peer message without msgType",msg);if(receivePeer.msgTypes[msgType]){if(receivePeer.msgTypes[msgType].sources[easyrtcid]&&receivePeer.msgTypes[msgType].sources[easyrtcid].cb)return void receivePeer.msgTypes[msgType].sources[easyrtcid].cb(easyrtcid,msgType,msgData,targeting);if(receivePeer.msgTypes[msgType].cb)return void receivePeer.msgTypes[msgType].cb(easyrtcid,msgType,msgData,targeting)}receivePeer.cb&&receivePeer.cb(easyrtcid,msgType,msgData,targeting)},this.setServerListener=function(listener){receiveServerCB=listener},this.setSocketUrl=function(socketUrl,options){self.debugPrinter&&self.debugPrinter("WebRTC signaling server URL set to "+socketUrl),serverPath=socketUrl,options&&(connectionOptions=options)},this.setUsername=function(username){return self.myEasyrtcid?(self.showError(self.errCodes.DEVELOPER_ERR,"easyrtc.setUsername called after authentication"),!1):self.isNameValid(username)?(self.username=username,!0):(self.showError(self.errCodes.BAD_NAME,self.format(self.getConstantString("badUserName"),username)),!1)},this.usernameToIds=function(username,room){var id,roomName,results=[];for(roomName in lastLoggedInList)if(lastLoggedInList.hasOwnProperty(roomName)&&(!room||roomName===room))for(id in lastLoggedInList[roomName])lastLoggedInList[roomName].hasOwnProperty(id)&&lastLoggedInList[roomName][id].username===username&&results.push({easyrtcid:id,roomName:roomName});return results},this.getRoomApiField=function(roomName,easyrtcid,fieldName){return lastLoggedInList[roomName]&&lastLoggedInList[roomName][easyrtcid]&&lastLoggedInList[roomName][easyrtcid].apiField&&lastLoggedInList[roomName][easyrtcid].apiField[fieldName]?lastLoggedInList[roomName][easyrtcid].apiField[fieldName].fieldValue:void 0},this.setCredential=function(credentialParm){try{return JSON.stringify(credentialParm),credential=credentialParm,!0}catch(oops){throw self.showError(self.errCodes.BAD_CREDENTIAL,"easyrtc.setCredential passed a non-JSON-able object"),"easyrtc.setCredential passed a non-JSON-able object"}},this.setDisconnectListener=function(disconnectListener){self.disconnectListener=disconnectListener},this.idToName=function(easyrtcid){var roomName;for(roomName in lastLoggedInList)if(lastLoggedInList.hasOwnProperty(roomName)&&lastLoggedInList[roomName][easyrtcid]&&lastLoggedInList[roomName][easyrtcid].username)return lastLoggedInList[roomName][easyrtcid].username;return easyrtcid},this.webSocket=null;var pc_config={},pc_config_to_use=null,use_fresh_ice_each_peer=!1;this.setUseFreshIceEachPeerConnection=function(value){use_fresh_ice_each_peer=value},this.getServerIce=function(){return pc_config},this.setIceUsedInCalls=function(ice){ice.iceServers?pc_config_to_use=ice:self.showError(self.errCodes.DEVELOPER_ERR,"Bad ice configuration passed to easyrtc.setIceUsedInCalls")};var closedChannel=null;this.haveAudioTrack=function(easyrtcid,streamName){return _haveTracks(easyrtcid,!0,streamName)},this.haveVideoTrack=function(easyrtcid,streamName){return _haveTracks(easyrtcid,!1,streamName)},this.getRoomField=function(roomName,fieldName){var fields=self.getRoomFields(roomName);return fields&&fields[fieldName]?fields[fieldName].fieldValue:void 0},this.supportsStatistics=function(){var peer;try{return peer=new RTCPeerConnection({iceServers:[]},{}),!!peer.getStats}catch(err){return!1}};var fields=null,preallocatedSocketIo=null;this.disconnect=function(){self.debugPrinter&&self.debugPrinter("attempt to disconnect from WebRTC signalling server"),self.disconnecting=!0,self.hangupAll(),self.loggingOut=!0,setTimeout(function(){if(self.webSocket){try{self.webSocket.disconnect()}catch(e){}closedChannel=self.webSocket,self.webSocket=0}self.loggingOut=!1,self.disconnecting=!1,roomOccupantListener&&roomOccupantListener(null,{},!1),self.emitEvent("roomOccupant",{}),oldConfig={}},250)};var sendByChunkUidCounter=0;this.sendDataP2P=function(destUser,msgType,msgData){var flattenedData=JSON.stringify({msgType:msgType,msgData:msgData});if(self.debugPrinter&&self.debugPrinter("sending p2p message to "+destUser+" with data="+JSON.stringify(flattenedData)),peerConns[destUser])if(peerConns[destUser].dataChannelS)if(peerConns[destUser].dataChannelReady)try{flattenedData.length>self.maxP2PMessageLength?sendByChunkHelper(destUser,flattenedData):peerConns[destUser].dataChannelS.send(flattenedData)}catch(oops){throw webrtcUtils.log("snedDataP2P error: ",oops),oops}else self.showError(self.errCodes.DEVELOPER_ERR,"Attempt to use data channel to "+destUser+" before it's ready to send.");else self.showError(self.errCodes.DEVELOPER_ERR,"Attempt to send data peer to peer without establishing a data channel to "+destUser+" first.");else self.showError(self.errCodes.DEVELOPER_ERR,"Attempt to send data peer to peer without a connection to "+destUser+" first.")},this.sendDataWS=function(destination,msgType,msgData,ackhandler){self.debugPrinter&&self.debugPrinter("sending client message via websockets to "+destination+" with data="+JSON.stringify(msgData)),ackhandler||(ackhandler=function(msg){"error"===msg.msgType&&self.showError(msg.msgData.errorCode,msg.msgData.errorText)});var outgoingMessage={msgType:msgType,msgData:msgData};if(destination&&("string"==typeof destination?outgoingMessage.targetEasyrtcid=destination:"object"==typeof destination&&(destination.targetEasyrtcid&&(outgoingMessage.targetEasyrtcid=destination.targetEasyrtcid),destination.targetRoom&&(outgoingMessage.targetRoom=destination.targetRoom),destination.targetGroup&&(outgoingMessage.targetGroup=destination.targetGroup))),!self.webSocket)throw self.debugPrinter&&self.debugPrinter("websocket failed because no connection to server"),"Attempt to send message without a valid connection to the server.";self.webSocket.json.emit("easyrtcMsg",outgoingMessage,ackhandler)},this.sendData=function(destUser,msgType,msgData,ackHandler){peerConns[destUser]&&peerConns[destUser].dataChannelReady?self.sendDataP2P(destUser,msgType,msgData):self.sendDataWS(destUser,msgType,msgData,ackHandler)},this.sendPeerMessage=function(destination,msgType,msgData,successCB,failureCB){function ackHandler(response){"error"===response.msgType?failureCB&&failureCB(response.msgData.errorCode,response.msgData.errorText):successCB&&successCB(response.msgType,response.msgData?response.msgData:null)}destination||self.showError(self.errCodes.DEVELOPER_ERR,"destination was null in sendPeerMessage"),self.debugPrinter&&self.debugPrinter("sending peer message "+JSON.stringify(msgData)),self.sendDataWS(destination,msgType,msgData,ackHandler)},this.sendServerMessage=function(msgType,msgData,successCB,failureCB){function ackhandler(response){"error"===response.msgType?failureCB&&failureCB(response.msgData.errorCode,response.msgData.errorText):successCB&&successCB(response.msgType,response.msgData?response.msgData:null)}if(self.debugPrinter){var dataToShip={msgType:msgType,msgData:msgData};self.debugPrinter("sending server message "+JSON.stringify(dataToShip))}self.sendDataWS(null,msgType,msgData,ackhandler)},this.getRoomList=function(callback,errorCallback){sendSignalling(null,"getRoomList",null,function(msgType,msgData){callback(msgData.roomList)},function(errorCode,errorText){errorCallback?errorCallback(errorCode,errorText):self.showError(errorCode,errorText)})},this.NOT_CONNECTED="not connected",this.BECOMING_CONNECTED="connection in progress to us.",this.IS_CONNECTED="is connected",this.getConnectStatus=function(otherUser){if(!peerConns.hasOwnProperty(otherUser))return self.NOT_CONNECTED;var peer=peerConns[otherUser];return!peer.sharingAudio&&!peer.sharingVideo||peer.startedAV?peer.sharingData&&!peer.dataChannelReady?self.BECOMING_CONNECTED:self.IS_CONNECTED:self.BECOMING_CONNECTED},this.call=function(otherUser,callSuccessCB,callFailureCB,wasAcceptedCB,streamNames){if(streamNames)if("string"==typeof streamNames)streamNames=[streamNames];else if("undefined"==typeof streamNames.length)return void self.showError(self.errCodes.DEVELOPER_ERR,"easyrtc.call passed bad streamNames");if(self.debugPrinter&&self.debugPrinter("initiating peer to peer call to "+otherUser+" audio="+self.audioEnabled+" video="+self.videoEnabled+" data="+dataEnabled),!self.supportsPeerConnections())return void callFailureCB(self.errCodes.CALL_ERR,self.getConstantString("noWebrtcSupport"));var message;if(!streamNames&&autoInitUserMedia){var stream=self.getLocalStream();if(!stream&&(self.audioEnabled||self.videoEnabled))return void self.initMediaSource(function(){self.call(otherUser,callSuccessCB,callFailureCB,wasAcceptedCB)},callFailureCB)}if(!self.webSocket)throw message="Attempt to make a call prior to connecting to service",self.debugPrinter&&self.debugPrinter(message),message;return offersPending[otherUser]?(wasAcceptedCB(!0,otherUser),doAnswer(otherUser,offersPending[otherUser],streamNames),delete offersPending[otherUser],void self.callCancelled(otherUser,!1)):"undefined"!=typeof acceptancePending[otherUser]?(message="Call already pending acceptance",self.debugPrinter&&self.debugPrinter(message),void callFailureCB(self.errCodes.ALREADY_CONNECTED,message)):void(use_fresh_ice_each_peer?self.getFreshIceConfig(function(succeeded){succeeded?callBody(otherUser,callSuccessCB,callFailureCB,wasAcceptedCB,streamNames):callFailureCB(self.errCodes.CALL_ERR,"Attempt to get fresh ice configuration failed")}):callBody(otherUser,callSuccessCB,callFailureCB,wasAcceptedCB,streamNames))};var queuedMessages={};this.hangup=function(otherUser){hangupBody(otherUser),updateConfigurationInfo()},this.hangupAll=function(){var sawAConnection=!1;for(var otherUser in peerConns)peerConns.hasOwnProperty(otherUser)&&(sawAConnection=!0,hangupBody(otherUser));sawAConnection&&updateConfigurationInfo()},this.doesDataChannelWork=function(otherUser){return!!peerConns[otherUser]&&!!peerConns[otherUser].dataChannelReady},this.getRemoteStream=function(easyrtcid,remoteStreamName){if(peerConns[easyrtcid])return peerConns[easyrtcid].getRemoteStreamByName(remoteStreamName);throw self.showError(self.errCodes.DEVELOPER_ERR,"attempt to get stream of uncalled party"),"Developer err: no such stream"},this.makeLocalStreamFromRemoteStream=function(easyrtcid,remoteStreamName,localStreamName){var remoteStream;if(!peerConns[easyrtcid].pc)throw"Developer err: no such peer ";if(remoteStream=peerConns[easyrtcid].getRemoteStreamByName(remoteStreamName),!remoteStream)throw"Developer err: no such stream";registerLocalMediaStreamByName(remoteStream,localStreamName)},this.addStreamToCall=function(easyrtcId,streamName,receiptHandler){streamName||(streamName="default");var stream=getLocalMediaStreamByName(streamName);if(stream)if(peerConns[easyrtcId]&&peerConns[easyrtcId].pc){var pc=peerConns[easyrtcId].pc;peerConns[easyrtcId].enableNegotiateListener=!0,pc.addStream(stream),receiptHandler&&(peerConns[easyrtcId].streamsAddedAcks[streamName]=receiptHandler)}else webrtcUtils.log("Can't add stream before a call has started.");else webrtcUtils.log("attempt to add nonexistent stream "+streamName)},this.setPeerListener(function(easyrtcid,msgType,msgData){if(peerConns[easyrtcid]&&peerConns[easyrtcid].pc){var sdp=msgData.sdp,pc=peerConns[easyrtcid].pc,setLocalAndSendMessage1=function(sessionDescription){var sendAnswer=function(){function onSignalSuccess(){}function onSignalFailure(errorCode,errorText){delete peerConns[easyrtcid],self.showError(errorCode,errorText)}self.debugPrinter&&self.debugPrinter("sending answer"),sendSignalling(easyrtcid,"answer",sessionDescription,onSignalSuccess,onSignalFailure),peerConns[easyrtcid].connectionAccepted=!0,sendQueuedCandidates(easyrtcid,onSignalSuccess,onSignalFailure)};sdpLocalFilter&&(sessionDescription.sdp=sdpLocalFilter(sessionDescription.sdp)),pc.setLocalDescription(sessionDescription,sendAnswer,function(message){self.showError(self.errCodes.INTERNAL_ERR,"setLocalDescription: "+msgData)})},invokeCreateAnswer=function(){pc.createAnswer(setLocalAndSendMessage1,function(message){self.showError(self.errCodes.INTERNAL_ERR,"create-answer: "+message)},receivedMediaConstraints),self.sendPeerMessage(easyrtcid,"__gotAddedMediaStream",{sdp:sdp})};self.debugPrinter&&self.debugPrinter("about to call setRemoteDescription in doAnswer");try{sdpRemoteFilter&&(sdp.sdp=sdpRemoteFilter(sdp.sdp)),pc.setRemoteDescription(new RTCSessionDescription(sdp),invokeCreateAnswer,function(message){self.showError(self.errCodes.INTERNAL_ERR,"set-remote-description: "+message)})}catch(srdError){webrtcUtils.log("set remote description failed"),self.debugPrinter&&self.debugPrinter("saw exception in setRemoteDescription"),self.showError(self.errCodes.INTERNAL_ERR,"setRemoteDescription failed: "+srdError.message)}}else self.showError(self.errCodes.DEVELOPER_ERR,"Attempt to add additional stream before establishing the base call.")},"__addedMediaStream"),this.setPeerListener(function(easyrtcid,msgType,msgData){if(peerConns[easyrtcid]&&peerConns[easyrtcid].pc){var sdp=msgData.sdp;sdpRemoteFilter&&(sdp.sdp=sdpRemoteFilter(sdp.sdp));var pc=peerConns[easyrtcid].pc;pc.setRemoteDescription(new RTCSessionDescription(sdp),function(){},function(message){self.showError(self.errCodes.INTERNAL_ERR,"set-remote-description: "+message)})}else self.debugPrinter&&self.debugPrinter("setPeerListener failed: __gotAddedMediaStream Unknow easyrtcid "+easyrtcid)},"__gotAddedMediaStream"),this.setPeerListener(function(easyrtcid,msgType,msgData){if(peerConns[easyrtcid]&&peerConns[easyrtcid].pc){var stream=peerConns[easyrtcid].getRemoteStreamByName(msgData.streamName);stream&&(onRemoveStreamHelper(easyrtcid,stream),stopStream(stream))}else self.debugPrinter&&self.debugPrinter("setPeerListener failed: __closingMediaStream Unknow easyrtcid "+easyrtcid);
},"__closingMediaStream"),this.dumpPeerConnectionInfo=function(){var i;for(var peer in peerConns)if(peerConns.hasOwnProperty(peer)){webrtcUtils.log("For peer "+peer);var pc=peerConns[peer].pc,remotes=pc.getRemoteStreams(),remoteIds=[];for(i=0;i<remotes.length;i++)remoteIds.push(remotes[i].id);var locals=pc.getLocalStreams(),localIds=[];for(i=0;i<locals.length;i++)localIds.push(locals[i].id);webrtcUtils.log("    "+JSON.stringify({local:localIds,remote:remoteIds}))}},this.isPeerInAnyRoom=function(easyrtcid){return isPeerInAnyRoom(easyrtcid)};var aggregatingTimers={};this.updatePresence=function(state,statusText){self.presenceShow=state,self.presenceStatus=statusText,self.webSocketConnected&&sendSignalling(null,"setPresence",{setPresence:{show:self.presenceShow,status:self.presenceStatus}},null)},this.getSessionFields=function(){return sessionFields},this.getSessionField=function(name){return sessionFields[name]?sessionFields[name].fieldValue:void 0},this.getRoomOccupantsAsArray=function(roomName){return lastLoggedInList[roomName]?Object.keys(lastLoggedInList[roomName]):null},this.getRoomOccupantsAsMap=function(roomName){return lastLoggedInList[roomName]},this.isTurnServer=function(ipAddress){return!!self._turnServers[ipAddress]},this.getFreshIceConfig=function(callback){var dataToShip={msgType:"getIceConfig",msgData:{}};callback||(callback=function(){}),self.webSocket.json.emit("easyrtcCmd",dataToShip,function(ackMsg){"iceConfig"===ackMsg.msgType?(processIceConfig(ackMsg.msgData.iceConfig),callback(!0)):(self.showError(ackMsg.msgData.errorCode,ackMsg.msgData.errorText),callback(!1))})},this.joinRoom=function(roomName,roomParameters,successCB,failureCB){if(self.roomJoin[roomName])return void self.showError(self.errCodes.DEVELOPER_ERR,"Attempt to join room "+roomName+" which you are already in.");var newRoomData={roomName:roomName};if(roomParameters){try{JSON.stringify(roomParameters)}catch(error){throw self.showError(self.errCodes.DEVELOPER_ERR,"non-jsonable parameter to easyrtc.joinRoom"),"Developer error, see application error messages"}var parameters={};for(var key in roomParameters)roomParameters.hasOwnProperty(key)&&(parameters[key]=roomParameters[key]);newRoomData.roomParameter=parameters}var roomData,signallingSuccess,signallingFailure,msgData={roomJoin:{}};self.webSocket?(msgData.roomJoin[roomName]=newRoomData,signallingSuccess=function(msgType,msgData){roomData=msgData.roomData,self.roomJoin[roomName]=newRoomData,successCB&&successCB(roomName),processRoomData(roomData)},signallingFailure=function(errorCode,errorText){failureCB?failureCB(errorCode,errorText,roomName):self.showError(errorCode,self.format(self.getConstantString("unableToEnterRoom"),roomName,errorText))},sendSignalling(null,"roomJoin",msgData,signallingSuccess,signallingFailure)):self.roomJoin[roomName]=newRoomData},this.leaveRoom=function(roomName,successCallback,failureCallback){var roomItem;self.roomJoin[roomName]&&(self.webSocket?(roomItem={},roomItem[roomName]={roomName:roomName},sendSignalling(null,"roomLeave",{roomLeave:roomItem},function(msgType,msgData){var roomData=msgData.roomData;processRoomData(roomData),successCallback&&successCallback(roomName)},function(errorCode,errorText){failureCallback&&failureCallback(errorCode,errorText,roomName)})):delete self.roomJoin[roomName])},this.getRoomsJoined=function(){var key,roomsIn={};for(key in self.roomJoin)self.roomJoin.hasOwnProperty(key)&&(roomsIn[key]=!0);return roomsIn},this.getRoomFields=function(roomName){return fields&&fields.rooms&&fields.rooms[roomName]?fields.rooms[roomName]:void 0},this.getApplicationFields=function(){return fields.application},this.getConnectionFields=function(){return fields.connection},this.useThisSocketConnection=function(alreadyAllocatedSocketIo){preallocatedSocketIo=alreadyAllocatedSocketIo},this.connect=function(applicationName,successCallback,errorCallback){return window.io||self.showError(self.errCodes.DEVELOPER_ERR,"Your HTML has not included the socket.io.js library"),!preallocatedSocketIo&&self.webSocket?void self.showError(self.errCodes.DEVELOPER_ERR,"Attempt to connect when already connected to socket server"):(pc_config={},closedChannel=null,oldConfig={},queuedMessages={},self.applicationName=applicationName,fields={rooms:{},application:{},connection:{}},self.debugPrinter&&self.debugPrinter("attempt to connect to WebRTC signalling server with application name="+applicationName),null===errorCallback&&(errorCallback=function(errorCode,errorText){self.showError(errorCode,errorText)}),void connectToWSServer(successCallback,errorCallback))}};window.easyrtc=new Easyrtc,function(){function easyAppBody(monitorVideoId,videoIds){function validateVideoIds(monitorVideoId,videoIds){var i;if(monitorVideoId&&!document.getElementById(monitorVideoId))return easyrtc.showError(easyrtc.errCodes.DEVELOPER_ERR,"The monitor video id passed to easyApp was bad, saw "+monitorVideoId),!1;for(i in videoIds)if(videoIds.hasOwnProperty(i)){var name=videoIds[i];if(!document.getElementById(name))return easyrtc.showError(easyrtc.errCodes.DEVELOPER_ERR,"The caller video id '"+name+"' passed to easyApp was bad."),!1}return!0}function getCallerOfVideo(videoObject){return videoIdToCallerMap[videoObject.id]}function setCallerOfVideo(videoObject,callerEasyrtcId){videoIdToCallerMap[videoObject.id]=callerEasyrtcId}function videoIsFree(obj){var caller=getCallerOfVideo(obj);return""===caller||null===caller||void 0===caller}function getIthVideo(i){return videoIdsP[i]?document.getElementById(videoIdsP[i]):null}function showVideo(video,stream){easyrtc.setVideoObjectSrc(video,stream),video.style.visibility&&(video.style.visibility="visible")}function hideVideo(video){easyrtc.setVideoObjectSrc(video,""),video.style.visibility="hidden"}var videoIdsP=videoIds||[],numPEOPLE=videoIds.length,videoIdToCallerMap={},onCall=null,onHangup=null;if(!validateVideoIds(monitorVideoId,videoIdsP))throw"bad video element id";monitorVideoId&&(document.getElementById(monitorVideoId).muted="muted"),easyrtc.addEventListener("roomOccupants",function(eventName,eventData){var i;for(i=0;i<numPEOPLE;i++){var video=getIthVideo(i);videoIsFree(video)||easyrtc.isPeerInAnyRoom(getCallerOfVideo(video))||(onHangup&&onHangup(getCallerOfVideo(video),i),setCallerOfVideo(video,null))}}),easyrtc.setOnCall=function(cb){onCall=cb},easyrtc.setOnHangup=function(cb){onHangup=cb},easyrtc.getIthCaller=function(i){if(i<0||i>=videoIdsP.length)return null;var vid=getIthVideo(i);return getCallerOfVideo(vid)},easyrtc.getSlotOfCaller=function(easyrtcid){var i;for(i=0;i<numPEOPLE;i++)if(easyrtc.getIthCaller(i)===easyrtcid)return i;return-1},easyrtc.setOnStreamClosed(function(caller){var i;for(i=0;i<numPEOPLE;i++){var video=getIthVideo(i);getCallerOfVideo(video)===caller&&(hideVideo(video),setCallerOfVideo(video,""),onHangup&&onHangup(caller,i))}}),easyrtc.setAcceptChecker(function(caller,helper){var i;for(i=0;i<numPEOPLE;i++){var video=getIthVideo(i);if(videoIsFree(video))return void helper(!0)}helper(!1)}),easyrtc.setStreamAcceptor(function(caller,stream){var i;easyrtc.debugPrinter&&easyrtc.debugPrinter("stream acceptor called");var video;for(i=0;i<numPEOPLE;i++)if(video=getIthVideo(i),getCallerOfVideo(video)===caller)return showVideo(video,stream),void(onCall&&onCall(caller,i));for(i=0;i<numPEOPLE;i++)if(video=getIthVideo(i),videoIsFree(video))return setCallerOfVideo(video,caller),onCall&&onCall(caller,i),void showVideo(video,stream);video=getIthVideo(0),video&&(easyrtc.hangup(getCallerOfVideo(video)),showVideo(video,stream),onCall&&onCall(caller,0)),setCallerOfVideo(video,caller)});var addControls,parentDiv,closeButton,i;if(autoAddCloseButtons)for(addControls=function(video){parentDiv=video.parentNode,setCallerOfVideo(video,""),closeButton=document.createElement("div"),closeButton.className="easyrtc_closeButton",closeButton.onclick=function(){getCallerOfVideo(video)&&(easyrtc.hangup(getCallerOfVideo(video)),hideVideo(video),setCallerOfVideo(video,""))},parentDiv.appendChild(closeButton)},i=0;i<numPEOPLE;i++)addControls(getIthVideo(i));var monitorVideo=null;if(easyrtc.videoEnabled&&null!==monitorVideoId){if(monitorVideo=document.getElementById(monitorVideoId),!monitorVideo)return void console.error("Programmer error: no object called "+monitorVideoId);monitorVideo.muted="muted",monitorVideo.defaultMuted=!0}}var autoAddCloseButtons=!0;easyrtc.dontAddCloseButtons=function(){autoAddCloseButtons=!1},easyrtc.easyApp=function(applicationName,monitorVideoId,videoIds,onReady,onFailure){function nextInitializationStep(){gotConnectionCallback&&gotConnectionCallback(!0,""),onReady(easyrtc.myEasyrtcid)}function postGetUserMedia(){function connectError(errorCode,errorText){gotConnectionCallback?gotConnectionCallback(!1,errorText):onFailure?onFailure(easyrtc.errCodes.CONNECT_ERR,errorText):easyrtc.showError(easyrtc.errCodes.CONNECT_ERR,errorText)}gotMediaCallback&&gotMediaCallback(!0,null),null!==monitorVideoId&&easyrtc.setVideoObjectSrc(document.getElementById(monitorVideoId),easyrtc.getLocalStream()),easyrtc.connect(applicationName,nextInitializationStep,connectError)}var gotMediaCallback=null,gotConnectionCallback=null;easyAppBody(monitorVideoId,videoIds),easyrtc.setGotMedia=function(gotMediaCB){gotMediaCallback=gotMediaCB},easyrtc.setPeerClosedListener(function(easyrtcid){setTimeout(function(){easyrtc.getSlotOfCaller(easyrtcid)>=0&&easyrtc.isPeerInAnyRoom(easyrtcid)&&easyrtc.call(easyrtcid,function(){},function(){},function(){})},1e3)}),easyrtc.setGotConnection=function(gotConnectionCB){gotConnectionCallback=gotConnectionCB};var stream=easyrtc.getLocalStream(null);stream?postGetUserMedia():easyrtc.initMediaSource(postGetUserMedia,function(errorCode,errorText){gotMediaCallback?gotMediaCallback(!1,errorText):onFailure?onFailure(easyrtc.errCodes.MEDIA_ERR,errorText):easyrtc.showError(easyrtc.errCodes.MEDIA_ERR,errorText)},null)}}();var easyrtc_constantStrings={unableToEnterRoom:"Unable to enter room {0} because {1}",resolutionWarning:"Requested video size of {0}x{1} but got size of {2}x{3}",badUserName:"Illegal username {0}",localMediaError:"Error getting local media stream: {0}",miscSignalError:"Miscellaneous error from signalling server. It may be ignorable.",noServer:"Unable to reach the EasyRTC signalling server.",badsocket:"Socket.io connect event fired with bad websocket.",icf:"Internal communications failure",statsNotSupported:"call statistics not supported by this browser, try Chrome.",noWebrtcSupport:"Your browser doesn't appear to support WebRTC.",gumFailed:"Failed to get access to local media. Error code was {0}.",requireAudioOrVideo:"At least one of audio and video must be provided"};!function(root,factory){"function"==typeof define&&define.amd?define([],factory):root.forge=factory()}(this,function(){var requirejs,require,define;return function(undef){function hasProp(obj,prop){return hasOwn.call(obj,prop)}function normalize(name,baseName){var nameParts,nameSegment,mapValue,foundMap,lastIndex,foundI,foundStarMap,starI,i,j,part,baseParts=baseName&&baseName.split("/"),map=config.map,starMap=map&&map["*"]||{};if(name&&"."===name.charAt(0))if(baseName){for(baseParts=baseParts.slice(0,baseParts.length-1),name=name.split("/"),lastIndex=name.length-1,config.nodeIdCompat&&jsSuffixRegExp.test(name[lastIndex])&&(name[lastIndex]=name[lastIndex].replace(jsSuffixRegExp,"")),name=baseParts.concat(name),i=0;i<name.length;i+=1)if(part=name[i],"."===part)name.splice(i,1),i-=1;else if(".."===part){if(1===i&&(".."===name[2]||".."===name[0]))break;i>0&&(name.splice(i-1,2),i-=2)}name=name.join("/")}else 0===name.indexOf("./")&&(name=name.substring(2));if((baseParts||starMap)&&map){for(nameParts=name.split("/"),i=nameParts.length;i>0;i-=1){if(nameSegment=nameParts.slice(0,i).join("/"),baseParts)for(j=baseParts.length;j>0;j-=1)if(mapValue=map[baseParts.slice(0,j).join("/")],mapValue&&(mapValue=mapValue[nameSegment])){foundMap=mapValue,foundI=i;break}if(foundMap)break;!foundStarMap&&starMap&&starMap[nameSegment]&&(foundStarMap=starMap[nameSegment],starI=i)}!foundMap&&foundStarMap&&(foundMap=foundStarMap,foundI=starI),foundMap&&(nameParts.splice(0,foundI,foundMap),name=nameParts.join("/"))}return name}function makeRequire(relName,forceSync){return function(){return req.apply(undef,aps.call(arguments,0).concat([relName,forceSync]))}}function makeNormalize(relName){return function(name){return normalize(name,relName)}}function makeLoad(depName){return function(value){defined[depName]=value}}function callDep(name){if(hasProp(waiting,name)){var args=waiting[name];delete waiting[name],defining[name]=!0,main.apply(undef,args)}if(!hasProp(defined,name)&&!hasProp(defining,name))throw new Error("No "+name);return defined[name]}function splitPrefix(name){var prefix,index=name?name.indexOf("!"):-1;return index>-1&&(prefix=name.substring(0,index),name=name.substring(index+1,name.length)),[prefix,name]}function makeConfig(name){return function(){return config&&config.config&&config.config[name]||{}}}var main,req,makeMap,handlers,defined={},waiting={},config={},defining={},hasOwn=Object.prototype.hasOwnProperty,aps=[].slice,jsSuffixRegExp=/\.js$/;makeMap=function(name,relName){var plugin,parts=splitPrefix(name),prefix=parts[0];return name=parts[1],prefix&&(prefix=normalize(prefix,relName),plugin=callDep(prefix)),prefix?name=plugin&&plugin.normalize?plugin.normalize(name,makeNormalize(relName)):normalize(name,relName):(name=normalize(name,relName),parts=splitPrefix(name),prefix=parts[0],name=parts[1],prefix&&(plugin=callDep(prefix))),{f:prefix?prefix+"!"+name:name,n:name,pr:prefix,p:plugin}},handlers={require:function(name){return makeRequire(name)},exports:function(name){var e=defined[name];return"undefined"!=typeof e?e:defined[name]={}},module:function(name){return{id:name,uri:"",exports:defined[name],config:makeConfig(name)}}},main=function(name,deps,callback,relName){var cjsModule,depName,ret,map,i,usingExports,args=[],callbackType=typeof callback;if(relName=relName||name,"undefined"===callbackType||"function"===callbackType){for(deps=!deps.length&&callback.length?["require","exports","module"]:deps,i=0;i<deps.length;i+=1)if(map=makeMap(deps[i],relName),depName=map.f,"require"===depName)args[i]=handlers.require(name);else if("exports"===depName)args[i]=handlers.exports(name),usingExports=!0;else if("module"===depName)cjsModule=args[i]=handlers.module(name);else if(hasProp(defined,depName)||hasProp(waiting,depName)||hasProp(defining,depName))args[i]=callDep(depName);else{if(!map.p)throw new Error(name+" missing "+depName);map.p.load(map.n,makeRequire(relName,!0),makeLoad(depName),{}),args[i]=defined[depName]}ret=callback?callback.apply(defined[name],args):void 0,name&&(cjsModule&&cjsModule.exports!==undef&&cjsModule.exports!==defined[name]?defined[name]=cjsModule.exports:ret===undef&&usingExports||(defined[name]=ret))}else name&&(defined[name]=callback)},requirejs=require=req=function(deps,callback,relName,forceSync,alt){if("string"==typeof deps)return handlers[deps]?handlers[deps](callback):callDep(makeMap(deps,callback).f);if(!deps.splice){if(config=deps,config.deps&&req(config.deps,config.callback),!callback)return;callback.splice?(deps=callback,callback=relName,relName=null):deps=undef}return callback=callback||function(){},"function"==typeof relName&&(relName=forceSync,forceSync=alt),forceSync?main(undef,deps,callback,relName):setTimeout(function(){main(undef,deps,callback,relName)},4),req},req.config=function(cfg){return req(cfg)},requirejs._defined=defined,define=function(name,deps,callback){deps.splice||(callback=deps,deps=[]),hasProp(defined,name)||hasProp(waiting,name)||(waiting[name]=[name,deps,callback])},define.amd={jQuery:!0}}(),define("node_modules/almond/almond",function(){}),function(){function initModule(forge){function ByteStringBuffer(b){if(this.data="",this.read=0,"string"==typeof b)this.data=b;else if(util.isArrayBuffer(b)||util.isArrayBufferView(b)){var arr=new Uint8Array(b);try{this.data=String.fromCharCode.apply(null,arr)}catch(e){for(var i=0;i<arr.length;++i)this.putByte(arr[i])}}else(b instanceof ByteStringBuffer||"object"==typeof b&&"string"==typeof b.data&&"number"==typeof b.read)&&(this.data=b.data,this.read=b.read);this._constructedStringLength=0}function DataBuffer(b,options){options=options||{},this.read=options.readOffset||0,this.growSize=options.growSize||1024;var isArrayBuffer=util.isArrayBuffer(b),isArrayBufferView=util.isArrayBufferView(b);return isArrayBuffer||isArrayBufferView?(isArrayBuffer?this.data=new DataView(b):this.data=new DataView(b.buffer,b.byteOffset,b.byteLength),void(this.write="writeOffset"in options?options.writeOffset:this.data.byteLength)):(this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!==b&&void 0!==b&&this.putBytes(b),void("writeOffset"in options&&(this.write=options.writeOffset)))}var util=forge.util=forge.util||{};!function(){function handler(event){if(event.source===window&&event.data===msg){event.stopPropagation();var copy=callbacks.slice();callbacks.length=0,copy.forEach(function(callback){callback()})}}if("undefined"!=typeof process&&process.nextTick)return util.nextTick=process.nextTick,void("function"==typeof setImmediate?util.setImmediate=setImmediate:util.setImmediate=util.nextTick);if("function"==typeof setImmediate)return util.setImmediate=setImmediate,void(util.nextTick=function(callback){return setImmediate(callback)});if(util.setImmediate=function(callback){setTimeout(callback,0)},"undefined"!=typeof window&&"function"==typeof window.postMessage){var msg="forge.setImmediate",callbacks=[];util.setImmediate=function(callback){callbacks.push(callback),1===callbacks.length&&window.postMessage(msg,"*")},window.addEventListener("message",handler,!0)}if("undefined"!=typeof MutationObserver){var now=Date.now(),attr=!0,div=document.createElement("div"),callbacks=[];new MutationObserver(function(){var copy=callbacks.slice();callbacks.length=0,copy.forEach(function(callback){callback()})}).observe(div,{attributes:!0});var oldSetImmediate=util.setImmediate;util.setImmediate=function(callback){Date.now()-now>15?(now=Date.now(),oldSetImmediate(callback)):(callbacks.push(callback),1===callbacks.length&&div.setAttribute("a",attr=!attr))}}util.nextTick=util.setImmediate}(),util.isArray=Array.isArray||function(x){return"[object Array]"===Object.prototype.toString.call(x)},util.isArrayBuffer=function(x){return"undefined"!=typeof ArrayBuffer&&x instanceof ArrayBuffer},util.isArrayBufferView=function(x){return x&&util.isArrayBuffer(x.buffer)&&void 0!==x.byteLength},util.ByteBuffer=ByteStringBuffer,util.ByteStringBuffer=ByteStringBuffer;var _MAX_CONSTRUCTED_STRING_LENGTH=4096;util.ByteStringBuffer.prototype._optimizeConstructedString=function(x){this._constructedStringLength+=x,this._constructedStringLength>_MAX_CONSTRUCTED_STRING_LENGTH&&(this.data.substr(0,1),this._constructedStringLength=0)},util.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},util.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},util.ByteStringBuffer.prototype.putByte=function(b){return this.putBytes(String.fromCharCode(b))},util.ByteStringBuffer.prototype.fillWithByte=function(b,n){b=String.fromCharCode(b);for(var d=this.data;n>0;)1&n&&(d+=b),n>>>=1,n>0&&(b+=b);return this.data=d,this._optimizeConstructedString(n),this},util.ByteStringBuffer.prototype.putBytes=function(bytes){return this.data+=bytes,this._optimizeConstructedString(bytes.length),this},util.ByteStringBuffer.prototype.putString=function(str){return this.putBytes(util.encodeUtf8(str))},util.ByteStringBuffer.prototype.putInt16=function(i){return this.putBytes(String.fromCharCode(i>>8&255)+String.fromCharCode(255&i))},util.ByteStringBuffer.prototype.putInt24=function(i){return this.putBytes(String.fromCharCode(i>>16&255)+String.fromCharCode(i>>8&255)+String.fromCharCode(255&i))},util.ByteStringBuffer.prototype.putInt32=function(i){return this.putBytes(String.fromCharCode(i>>24&255)+String.fromCharCode(i>>16&255)+String.fromCharCode(i>>8&255)+String.fromCharCode(255&i))},util.ByteStringBuffer.prototype.putInt16Le=function(i){return this.putBytes(String.fromCharCode(255&i)+String.fromCharCode(i>>8&255))},util.ByteStringBuffer.prototype.putInt24Le=function(i){return this.putBytes(String.fromCharCode(255&i)+String.fromCharCode(i>>8&255)+String.fromCharCode(i>>16&255))},util.ByteStringBuffer.prototype.putInt32Le=function(i){return this.putBytes(String.fromCharCode(255&i)+String.fromCharCode(i>>8&255)+String.fromCharCode(i>>16&255)+String.fromCharCode(i>>24&255))},util.ByteStringBuffer.prototype.putInt=function(i,n){var bytes="";do n-=8,bytes+=String.fromCharCode(i>>n&255);while(n>0);return this.putBytes(bytes)},util.ByteStringBuffer.prototype.putSignedInt=function(i,n){return i<0&&(i+=2<<n-1),this.putInt(i,n)},util.ByteStringBuffer.prototype.putBuffer=function(buffer){return this.putBytes(buffer.getBytes())},util.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},util.ByteStringBuffer.prototype.getInt16=function(){var rval=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,rval},util.ByteStringBuffer.prototype.getInt24=function(){var rval=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,rval},util.ByteStringBuffer.prototype.getInt32=function(){var rval=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,rval},util.ByteStringBuffer.prototype.getInt16Le=function(){var rval=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,rval},util.ByteStringBuffer.prototype.getInt24Le=function(){var rval=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,rval},util.ByteStringBuffer.prototype.getInt32Le=function(){var rval=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,rval},util.ByteStringBuffer.prototype.getInt=function(n){var rval=0;do rval=(rval<<8)+this.data.charCodeAt(this.read++),n-=8;while(n>0);return rval},util.ByteStringBuffer.prototype.getSignedInt=function(n){var x=this.getInt(n),max=2<<n-2;return x>=max&&(x-=max<<1),x},util.ByteStringBuffer.prototype.getBytes=function(count){var rval;return count?(count=Math.min(this.length(),count),rval=this.data.slice(this.read,this.read+count),this.read+=count):0===count?rval="":(rval=0===this.read?this.data:this.data.slice(this.read),this.clear()),rval},util.ByteStringBuffer.prototype.bytes=function(count){return"undefined"==typeof count?this.data.slice(this.read):this.data.slice(this.read,this.read+count)},util.ByteStringBuffer.prototype.at=function(i){return this.data.charCodeAt(this.read+i)},util.ByteStringBuffer.prototype.setAt=function(i,b){return this.data=this.data.substr(0,this.read+i)+String.fromCharCode(b)+this.data.substr(this.read+i+1),this},util.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},util.ByteStringBuffer.prototype.copy=function(){var c=util.createBuffer(this.data);return c.read=this.read,c},util.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},util.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},util.ByteStringBuffer.prototype.truncate=function(count){var len=Math.max(0,this.length()-count);return this.data=this.data.substr(this.read,len),this.read=0,this},util.ByteStringBuffer.prototype.toHex=function(){for(var rval="",i=this.read;i<this.data.length;++i){var b=this.data.charCodeAt(i);b<16&&(rval+="0"),rval+=b.toString(16)}return rval},util.ByteStringBuffer.prototype.toString=function(){return util.decodeUtf8(this.bytes())},util.DataBuffer=DataBuffer,util.DataBuffer.prototype.length=function(){return this.write-this.read},util.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},util.DataBuffer.prototype.accommodate=function(amount,growSize){if(this.length()>=amount)return this;growSize=Math.max(growSize||this.growSize,amount);var src=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),dst=new Uint8Array(this.length()+growSize);return dst.set(src),this.data=new DataView(dst.buffer),this},util.DataBuffer.prototype.putByte=function(b){return this.accommodate(1),this.data.setUint8(this.write++,b),this},util.DataBuffer.prototype.fillWithByte=function(b,n){this.accommodate(n);for(var i=0;i<n;++i)this.data.setUint8(b);return this},util.DataBuffer.prototype.putBytes=function(bytes,encoding){if(util.isArrayBufferView(bytes)){var src=new Uint8Array(bytes.buffer,bytes.byteOffset,bytes.byteLength),len=src.byteLength-src.byteOffset;this.accommodate(len);var dst=new Uint8Array(this.data.buffer,this.write);return dst.set(src),this.write+=len,this}if(util.isArrayBuffer(bytes)){var src=new Uint8Array(bytes);this.accommodate(src.byteLength);var dst=new Uint8Array(this.data.buffer);return dst.set(src,this.write),this.write+=src.byteLength,this}if(bytes instanceof util.DataBuffer||"object"==typeof bytes&&"number"==typeof bytes.read&&"number"==typeof bytes.write&&util.isArrayBufferView(bytes.data)){var src=new Uint8Array(bytes.data.byteLength,bytes.read,bytes.length());this.accommodate(src.byteLength);var dst=new Uint8Array(bytes.data.byteLength,this.write);return dst.set(src),this.write+=src.byteLength,this}if(bytes instanceof util.ByteStringBuffer&&(bytes=bytes.data,encoding="binary"),encoding=encoding||"binary","string"==typeof bytes){var view;if("hex"===encoding)return this.accommodate(Math.ceil(bytes.length/2)),view=new Uint8Array(this.data.buffer,this.write),this.write+=util.binary.hex.decode(bytes,view,this.write),this;if("base64"===encoding)return this.accommodate(3*Math.ceil(bytes.length/4)),view=new Uint8Array(this.data.buffer,this.write),this.write+=util.binary.base64.decode(bytes,view,this.write),this;if("utf8"===encoding&&(bytes=util.encodeUtf8(bytes),encoding="binary"),"binary"===encoding||"raw"===encoding)return this.accommodate(bytes.length),view=new Uint8Array(this.data.buffer,this.write),this.write+=util.binary.raw.decode(view),this;if("utf16"===encoding)return this.accommodate(2*bytes.length),view=new Uint16Array(this.data.buffer,this.write),this.write+=util.text.utf16.encode(view),this;throw new Error("Invalid encoding: "+encoding)}throw Error("Invalid parameter: "+bytes)},util.DataBuffer.prototype.putBuffer=function(buffer){return this.putBytes(buffer),buffer.clear(),this},util.DataBuffer.prototype.putString=function(str){return this.putBytes(str,"utf16")},util.DataBuffer.prototype.putInt16=function(i){return this.accommodate(2),this.data.setInt16(this.write,i),this.write+=2,this},util.DataBuffer.prototype.putInt24=function(i){return this.accommodate(3),this.data.setInt16(this.write,i>>8&65535),this.data.setInt8(this.write,i>>16&255),this.write+=3,this},util.DataBuffer.prototype.putInt32=function(i){return this.accommodate(4),this.data.setInt32(this.write,i),this.write+=4,this},util.DataBuffer.prototype.putInt16Le=function(i){return this.accommodate(2),this.data.setInt16(this.write,i,!0),this.write+=2,this},util.DataBuffer.prototype.putInt24Le=function(i){return this.accommodate(3),this.data.setInt8(this.write,i>>16&255),this.data.setInt16(this.write,i>>8&65535,!0),this.write+=3,this},util.DataBuffer.prototype.putInt32Le=function(i){return this.accommodate(4),this.data.setInt32(this.write,i,!0),this.write+=4,this},util.DataBuffer.prototype.putInt=function(i,n){this.accommodate(n/8);do n-=8,this.data.setInt8(this.write++,i>>n&255);while(n>0);return this},util.DataBuffer.prototype.putSignedInt=function(i,n){return this.accommodate(n/8),i<0&&(i+=2<<n-1),this.putInt(i,n)},util.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},util.DataBuffer.prototype.getInt16=function(){var rval=this.data.getInt16(this.read);return this.read+=2,rval},util.DataBuffer.prototype.getInt24=function(){var rval=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,rval},util.DataBuffer.prototype.getInt32=function(){var rval=this.data.getInt32(this.read);return this.read+=4,rval},util.DataBuffer.prototype.getInt16Le=function(){var rval=this.data.getInt16(this.read,!0);return this.read+=2,rval},util.DataBuffer.prototype.getInt24Le=function(){var rval=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,rval},util.DataBuffer.prototype.getInt32Le=function(){var rval=this.data.getInt32(this.read,!0);return this.read+=4,rval},util.DataBuffer.prototype.getInt=function(n){var rval=0;do rval=(rval<<8)+this.data.getInt8(this.read++),n-=8;while(n>0);return rval},util.DataBuffer.prototype.getSignedInt=function(n){var x=this.getInt(n),max=2<<n-2;return x>=max&&(x-=max<<1),x},util.DataBuffer.prototype.getBytes=function(count){var rval;return count?(count=Math.min(this.length(),count),rval=this.data.slice(this.read,this.read+count),this.read+=count):0===count?rval="":(rval=0===this.read?this.data:this.data.slice(this.read),this.clear()),rval},util.DataBuffer.prototype.bytes=function(count){return"undefined"==typeof count?this.data.slice(this.read):this.data.slice(this.read,this.read+count)},util.DataBuffer.prototype.at=function(i){return this.data.getUint8(this.read+i)},util.DataBuffer.prototype.setAt=function(i,b){return this.data.setUint8(i,b),this},util.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},util.DataBuffer.prototype.copy=function(){return new util.DataBuffer(this)},util.DataBuffer.prototype.compact=function(){if(this.read>0){var src=new Uint8Array(this.data.buffer,this.read),dst=new Uint8Array(src.byteLength);dst.set(src),this.data=new DataView(dst),this.write-=this.read,this.read=0}return this},util.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},util.DataBuffer.prototype.truncate=function(count){return this.write=Math.max(0,this.length()-count),this.read=Math.min(this.read,this.write),this},util.DataBuffer.prototype.toHex=function(){for(var rval="",i=this.read;i<this.data.byteLength;++i){var b=this.data.getUint8(i);b<16&&(rval+="0"),rval+=b.toString(16)}return rval},util.DataBuffer.prototype.toString=function(encoding){var view=new Uint8Array(this.data,this.read,this.length());if(encoding=encoding||"utf8","binary"===encoding||"raw"===encoding)return util.binary.raw.encode(view);if("hex"===encoding)return util.binary.hex.encode(view);if("base64"===encoding)return util.binary.base64.encode(view);if("utf8"===encoding)return util.text.utf8.decode(view);if("utf16"===encoding)return util.text.utf16.decode(view);throw new Error("Invalid encoding: "+encoding)},util.createBuffer=function(input,encoding){return encoding=encoding||"raw",void 0!==input&&"utf8"===encoding&&(input=util.encodeUtf8(input)),new util.ByteBuffer(input)},util.fillString=function(c,n){for(var s="";n>0;)1&n&&(s+=c),n>>>=1,n>0&&(c+=c);return s},util.xorBytes=function(s1,s2,n){for(var s3="",b="",t="",i=0,c=0;n>0;--n,++i)b=s1.charCodeAt(i)^s2.charCodeAt(i),c>=10&&(s3+=t,t="",c=0),t+=String.fromCharCode(b),++c;return s3+=t},util.hexToBytes=function(hex){var rval="",i=0;for(hex.length&!0&&(i=1,rval+=String.fromCharCode(parseInt(hex[0],16)));i<hex.length;i+=2)rval+=String.fromCharCode(parseInt(hex.substr(i,2),16));return rval},util.bytesToHex=function(bytes){return util.createBuffer(bytes).toHex()},util.int32ToBytes=function(i){return String.fromCharCode(i>>24&255)+String.fromCharCode(i>>16&255)+String.fromCharCode(i>>8&255)+String.fromCharCode(255&i)};var _base64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_base64Idx=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];
util.encode64=function(input,maxline){for(var chr1,chr2,chr3,line="",output="",i=0;i<input.length;)chr1=input.charCodeAt(i++),chr2=input.charCodeAt(i++),chr3=input.charCodeAt(i++),line+=_base64.charAt(chr1>>2),line+=_base64.charAt((3&chr1)<<4|chr2>>4),isNaN(chr2)?line+="==":(line+=_base64.charAt((15&chr2)<<2|chr3>>6),line+=isNaN(chr3)?"=":_base64.charAt(63&chr3)),maxline&&line.length>maxline&&(output+=line.substr(0,maxline)+"\r\n",line=line.substr(maxline));return output+=line},util.decode64=function(input){input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var enc1,enc2,enc3,enc4,output="",i=0;i<input.length;)enc1=_base64Idx[input.charCodeAt(i++)-43],enc2=_base64Idx[input.charCodeAt(i++)-43],enc3=_base64Idx[input.charCodeAt(i++)-43],enc4=_base64Idx[input.charCodeAt(i++)-43],output+=String.fromCharCode(enc1<<2|enc2>>4),64!==enc3&&(output+=String.fromCharCode((15&enc2)<<4|enc3>>2),64!==enc4&&(output+=String.fromCharCode((3&enc3)<<6|enc4)));return output},util.encodeUtf8=function(str){return unescape(encodeURIComponent(str))},util.decodeUtf8=function(str){return decodeURIComponent(escape(str))},util.binary={raw:{},hex:{},base64:{}},util.binary.raw.encode=function(bytes){return String.fromCharCode.apply(null,bytes)},util.binary.raw.decode=function(str,output,offset){var out=output;out||(out=new Uint8Array(str.length)),offset=offset||0;for(var j=offset,i=0;i<str.length;++i)out[j++]=str.charCodeAt(i);return output?j-offset:out},util.binary.hex.encode=util.bytesToHex,util.binary.hex.decode=function(hex,output,offset){var out=output;out||(out=new Uint8Array(Math.ceil(hex.length/2))),offset=offset||0;var i=0,j=offset;for(1&hex.length&&(i=1,out[j++]=parseInt(hex[0],16));i<hex.length;i+=2)out[j++]=parseInt(hex.substr(i,2),16);return output?j-offset:out},util.binary.base64.encode=function(input,maxline){for(var chr1,chr2,chr3,line="",output="",i=0;i<input.byteLength;)chr1=input[i++],chr2=input[i++],chr3=input[i++],line+=_base64.charAt(chr1>>2),line+=_base64.charAt((3&chr1)<<4|chr2>>4),isNaN(chr2)?line+="==":(line+=_base64.charAt((15&chr2)<<2|chr3>>6),line+=isNaN(chr3)?"=":_base64.charAt(63&chr3)),maxline&&line.length>maxline&&(output+=line.substr(0,maxline)+"\r\n",line=line.substr(maxline));return output+=line},util.binary.base64.decode=function(input,output,offset){var out=output;out||(out=new Uint8Array(3*Math.ceil(input.length/4))),input=input.replace(/[^A-Za-z0-9\+\/\=]/g,""),offset=offset||0;for(var enc1,enc2,enc3,enc4,i=0,j=offset;i<input.length;)enc1=_base64Idx[input.charCodeAt(i++)-43],enc2=_base64Idx[input.charCodeAt(i++)-43],enc3=_base64Idx[input.charCodeAt(i++)-43],enc4=_base64Idx[input.charCodeAt(i++)-43],out[j++]=enc1<<2|enc2>>4,64!==enc3&&(out[j++]=(15&enc2)<<4|enc3>>2,64!==enc4&&(out[j++]=(3&enc3)<<6|enc4));return output?j-offset:out.subarray(0,j)},util.text={utf8:{},utf16:{}},util.text.utf8.encode=function(str,output,offset){str=util.encodeUtf8(str);var out=output;out||(out=new Uint8Array(str.length)),offset=offset||0;for(var j=offset,i=0;i<str.length;++i)out[j++]=str.charCodeAt(i);return output?j-offset:out},util.text.utf8.decode=function(bytes){return util.decodeUtf8(String.fromCharCode.apply(null,bytes))},util.text.utf16.encode=function(str,output,offset){var out=output;out||(out=new Uint8Array(str.length));var view=new Uint16Array(out);offset=offset||0;for(var j=offset,k=offset,i=0;i<str.length;++i)view[k++]=str.charCodeAt(i),j+=2;return output?j-offset:out},util.text.utf16.decode=function(bytes){return String.fromCharCode.apply(null,new Uint16Array(bytes))},util.deflate=function(api,bytes,raw){if(bytes=util.decode64(api.deflate(util.encode64(bytes)).rval),raw){var start=2,flg=bytes.charCodeAt(1);32&flg&&(start=6),bytes=bytes.substring(start,bytes.length-4)}return bytes},util.inflate=function(api,bytes,raw){var rval=api.inflate(util.encode64(bytes)).rval;return null===rval?null:util.decode64(rval)};var _setStorageObject=function(api,id,obj){if(!api)throw new Error("WebStorage not available.");var rval;if(null===obj?rval=api.removeItem(id):(obj=util.encode64(JSON.stringify(obj)),rval=api.setItem(id,obj)),"undefined"!=typeof rval&&rval.rval!==!0){var error=new Error(rval.error.message);throw error.id=rval.error.id,error.name=rval.error.name,error}},_getStorageObject=function(api,id){if(!api)throw new Error("WebStorage not available.");var rval=api.getItem(id);if(api.init)if(null===rval.rval){if(rval.error){var error=new Error(rval.error.message);throw error.id=rval.error.id,error.name=rval.error.name,error}rval=null}else rval=rval.rval;return null!==rval&&(rval=JSON.parse(util.decode64(rval))),rval},_setItem=function(api,id,key,data){var obj=_getStorageObject(api,id);null===obj&&(obj={}),obj[key]=data,_setStorageObject(api,id,obj)},_getItem=function(api,id,key){var rval=_getStorageObject(api,id);return null!==rval&&(rval=key in rval?rval[key]:null),rval},_removeItem=function(api,id,key){var obj=_getStorageObject(api,id);if(null!==obj&&key in obj){delete obj[key];var empty=!0;for(var prop in obj){empty=!1;break}empty&&(obj=null),_setStorageObject(api,id,obj)}},_clearItems=function(api,id){_setStorageObject(api,id,null)},_callStorageFunction=function(func,args,location){var rval=null;"undefined"==typeof location&&(location=["web","flash"]);var type,done=!1,exception=null;for(var idx in location){type=location[idx];try{if("flash"===type||"both"===type){if(null===args[0])throw new Error("Flash local storage not available.");rval=func.apply(this,args),done="flash"===type}"web"!==type&&"both"!==type||(args[0]=localStorage,rval=func.apply(this,args),done=!0)}catch(ex){exception=ex}if(done)break}if(!done)throw exception;return rval};util.setItem=function(api,id,key,data,location){_callStorageFunction(_setItem,arguments,location)},util.getItem=function(api,id,key,location){return _callStorageFunction(_getItem,arguments,location)},util.removeItem=function(api,id,key,location){_callStorageFunction(_removeItem,arguments,location)},util.clearItems=function(api,id,location){_callStorageFunction(_clearItems,arguments,location)},util.parseUrl=function(str){var regex=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;regex.lastIndex=0;var m=regex.exec(str),url=null===m?null:{full:str,scheme:m[1],host:m[2],port:m[3],path:m[4]};return url&&(url.fullHost=url.host,url.port?80!==url.port&&"http"===url.scheme?url.fullHost+=":"+url.port:443!==url.port&&"https"===url.scheme&&(url.fullHost+=":"+url.port):"http"===url.scheme?url.port=80:"https"===url.scheme&&(url.port=443),url.full=url.scheme+"://"+url.fullHost),url};var _queryVariables=null;util.getQueryVariables=function(query){var rval,parse=function(q){for(var rval={},kvpairs=q.split("&"),i=0;i<kvpairs.length;i++){var key,val,pos=kvpairs[i].indexOf("=");pos>0?(key=kvpairs[i].substring(0,pos),val=kvpairs[i].substring(pos+1)):(key=kvpairs[i],val=null),key in rval||(rval[key]=[]),key in Object.prototype||null===val||rval[key].push(unescape(val))}return rval};return"undefined"==typeof query?(null===_queryVariables&&(_queryVariables="undefined"!=typeof window&&window.location&&window.location.search?parse(window.location.search.substring(1)):{}),rval=_queryVariables):rval=parse(query),rval},util.parseFragment=function(fragment){var fp=fragment,fq="",pos=fragment.indexOf("?");pos>0&&(fp=fragment.substring(0,pos),fq=fragment.substring(pos+1));var path=fp.split("/");path.length>0&&""===path[0]&&path.shift();var query=""===fq?{}:util.getQueryVariables(fq);return{pathString:fp,queryString:fq,path:path,query:query}},util.makeRequest=function(reqString){var frag=util.parseFragment(reqString),req={path:frag.pathString,query:frag.queryString,getPath:function(i){return"undefined"==typeof i?frag.path:frag.path[i]},getQuery:function(k,i){var rval;return"undefined"==typeof k?rval=frag.query:(rval=frag.query[k],rval&&"undefined"!=typeof i&&(rval=rval[i])),rval},getQueryLast:function(k,_default){var rval,vals=req.getQuery(k);return rval=vals?vals[vals.length-1]:_default}};return req},util.makeLink=function(path,query,fragment){path=jQuery.isArray(path)?path.join("/"):path;var qstr=jQuery.param(query||{});return fragment=fragment||"",path+(qstr.length>0?"?"+qstr:"")+(fragment.length>0?"#"+fragment:"")},util.setPath=function(object,keys,value){if("object"==typeof object&&null!==object)for(var i=0,len=keys.length;i<len;){var next=keys[i++];if(i==len)object[next]=value;else{var hasNext=next in object;(!hasNext||hasNext&&"object"!=typeof object[next]||hasNext&&null===object[next])&&(object[next]={}),object=object[next]}}},util.getPath=function(object,keys,_default){for(var i=0,len=keys.length,hasNext=!0;hasNext&&i<len&&"object"==typeof object&&null!==object;){var next=keys[i++];hasNext=next in object,hasNext&&(object=object[next])}return hasNext?object:_default},util.deletePath=function(object,keys){if("object"==typeof object&&null!==object)for(var i=0,len=keys.length;i<len;){var next=keys[i++];if(i==len)delete object[next];else{if(!(next in object)||"object"!=typeof object[next]||null===object[next])break;object=object[next]}}},util.isEmpty=function(obj){for(var prop in obj)if(obj.hasOwnProperty(prop))return!1;return!0},util.format=function(format){for(var match,part,re=/%./g,argi=0,parts=[],last=0;match=re.exec(format);){part=format.substring(last,re.lastIndex-2),part.length>0&&parts.push(part),last=re.lastIndex;var code=match[0][1];switch(code){case"s":case"o":argi<arguments.length?parts.push(arguments[argi++ +1]):parts.push("<?>");break;case"%":parts.push("%");break;default:parts.push("<%"+code+"?>")}}return parts.push(format.substring(last)),parts.join("")},util.formatNumber=function(number,decimals,dec_point,thousands_sep){var n=number,c=isNaN(decimals=Math.abs(decimals))?2:decimals,d=void 0===dec_point?",":dec_point,t=void 0===thousands_sep?".":thousands_sep,s=n<0?"-":"",i=parseInt(n=Math.abs(+n||0).toFixed(c),10)+"",j=i.length>3?i.length%3:0;return s+(j?i.substr(0,j)+t:"")+i.substr(j).replace(/(\d{3})(?=\d)/g,"$1"+t)+(c?d+Math.abs(n-i).toFixed(c).slice(2):"")},util.formatSize=function(size){return size=size>=1073741824?util.formatNumber(size/1073741824,2,".","")+" GiB":size>=1048576?util.formatNumber(size/1048576,2,".","")+" MiB":size>=1024?util.formatNumber(size/1024,0)+" KiB":util.formatNumber(size,0)+" bytes"},util.bytesFromIP=function(ip){return ip.indexOf(".")!==-1?util.bytesFromIPv4(ip):ip.indexOf(":")!==-1?util.bytesFromIPv6(ip):null},util.bytesFromIPv4=function(ip){if(ip=ip.split("."),4!==ip.length)return null;for(var b=util.createBuffer(),i=0;i<ip.length;++i){var num=parseInt(ip[i],10);if(isNaN(num))return null;b.putByte(num)}return b.getBytes()},util.bytesFromIPv6=function(ip){var blanks=0;ip=ip.split(":").filter(function(e){return 0===e.length&&++blanks,!0});for(var zeros=2*(8-ip.length+blanks),b=util.createBuffer(),i=0;i<8;++i)if(ip[i]&&0!==ip[i].length){var bytes=util.hexToBytes(ip[i]);bytes.length<2&&b.putByte(0),b.putBytes(bytes)}else b.fillWithByte(0,zeros),zeros=0;return b.getBytes()},util.bytesToIP=function(bytes){return 4===bytes.length?util.bytesToIPv4(bytes):16===bytes.length?util.bytesToIPv6(bytes):null},util.bytesToIPv4=function(bytes){if(4!==bytes.length)return null;for(var ip=[],i=0;i<bytes.length;++i)ip.push(bytes.charCodeAt(i));return ip.join(".")},util.bytesToIPv6=function(bytes){if(16!==bytes.length)return null;for(var ip=[],zeroGroups=[],zeroMaxGroup=0,i=0;i<bytes.length;i+=2){for(var hex=util.bytesToHex(bytes[i]+bytes[i+1]);"0"===hex[0]&&"0"!==hex;)hex=hex.substr(1);if("0"===hex){var last=zeroGroups[zeroGroups.length-1],idx=ip.length;last&&idx===last.end+1?(last.end=idx,last.end-last.start>zeroGroups[zeroMaxGroup].end-zeroGroups[zeroMaxGroup].start&&(zeroMaxGroup=zeroGroups.length-1)):zeroGroups.push({start:idx,end:idx})}ip.push(hex)}if(zeroGroups.length>0){var group=zeroGroups[zeroMaxGroup];group.end-group.start>0&&(ip.splice(group.start,group.end-group.start+1,""),0===group.start&&ip.unshift(""),7===group.end&&ip.push(""))}return ip.join(":")},util.estimateCores=function(options,callback){function sample(max,samples,numWorkers){if(0===samples){var avg=Math.floor(max.reduce(function(avg,x){return avg+x},0)/max.length);return util.cores=Math.max(1,avg),URL.revokeObjectURL(blobUrl),callback(null,util.cores)}map(numWorkers,function(err,results){max.push(reduce(numWorkers,results)),sample(max,samples-1,numWorkers)})}function map(numWorkers,callback){for(var workers=[],results=[],i=0;i<numWorkers;++i){var worker=new Worker(blobUrl);worker.addEventListener("message",function(e){if(results.push(e.data),results.length===numWorkers){for(var i=0;i<numWorkers;++i)workers[i].terminate();callback(null,results)}}),workers.push(worker)}for(var i=0;i<numWorkers;++i)workers[i].postMessage(i)}function reduce(numWorkers,results){for(var overlaps=[],n=0;n<numWorkers;++n)for(var r1=results[n],overlap=overlaps[n]=[],i=0;i<numWorkers;++i)if(n!==i){var r2=results[i];(r1.st>r2.st&&r1.st<r2.et||r2.st>r1.st&&r2.st<r1.et)&&overlap.push(i)}return overlaps.reduce(function(max,overlap){return Math.max(max,overlap.length)},0)}if("function"==typeof options&&(callback=options,options={}),options=options||{},"cores"in util&&!options.update)return callback(null,util.cores);if("undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return util.cores=navigator.hardwareConcurrency,callback(null,util.cores);if("undefined"==typeof Worker)return util.cores=1,callback(null,util.cores);if("undefined"==typeof Blob)return util.cores=2,callback(null,util.cores);var blobUrl=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(e){for(var st=Date.now(),et=st+4;Date.now()<et;);self.postMessage({st:st,et:et})})}.toString(),")()"],{type:"application/javascript"}));sample([],5,16)}}var name="util";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/util",["require","module"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){forge.cipher=forge.cipher||{},forge.cipher.algorithms=forge.cipher.algorithms||{},forge.cipher.createCipher=function(algorithm,key){var api=algorithm;if("string"==typeof api&&(api=forge.cipher.getAlgorithm(api),api&&(api=api())),!api)throw new Error("Unsupported algorithm: "+algorithm);return new forge.cipher.BlockCipher({algorithm:api,key:key,decrypt:!1})},forge.cipher.createDecipher=function(algorithm,key){var api=algorithm;if("string"==typeof api&&(api=forge.cipher.getAlgorithm(api),api&&(api=api())),!api)throw new Error("Unsupported algorithm: "+algorithm);return new forge.cipher.BlockCipher({algorithm:api,key:key,decrypt:!0})},forge.cipher.registerAlgorithm=function(name,algorithm){name=name.toUpperCase(),forge.cipher.algorithms[name]=algorithm},forge.cipher.getAlgorithm=function(name){return name=name.toUpperCase(),name in forge.cipher.algorithms?forge.cipher.algorithms[name]:null};var BlockCipher=forge.cipher.BlockCipher=function(options){this.algorithm=options.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=options.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=options.decrypt,this.algorithm.initialize(options)};BlockCipher.prototype.start=function(options){options=options||{};var opts={};for(var key in options)opts[key]=options[key];opts.decrypt=this._decrypt,this._finish=!1,this._input=forge.util.createBuffer(),this.output=options.output||forge.util.createBuffer(),this.mode.start(opts)},BlockCipher.prototype.update=function(input){for(input&&this._input.putBuffer(input);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},BlockCipher.prototype.finish=function(pad){pad&&"CBC"===this.mode.name&&(this.mode.pad=function(input){return pad(this.blockSize,input,!1)},this.mode.unpad=function(output){return pad(this.blockSize,output,!0)});var options={};return options.decrypt=this._decrypt,options.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,options))&&(this._finish=!0,this.update(),!(this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,options))&&!(this.mode.afterFinish&&!this.mode.afterFinish(this.output,options)))}}var name="cipher";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/cipher",["require","module","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){function transformIV(iv){if("string"==typeof iv&&(iv=forge.util.createBuffer(iv)),forge.util.isArray(iv)&&iv.length>4){var tmp=iv;iv=forge.util.createBuffer();for(var i=0;i<tmp.length;++i)iv.putByte(tmp[i])}return forge.util.isArray(iv)||(iv=[iv.getInt32(),iv.getInt32(),iv.getInt32(),iv.getInt32()]),iv}function inc32(block){block[block.length-1]=block[block.length-1]+1&4294967295}function from64To32(num){return[num/4294967296|0,4294967295&num]}forge.cipher=forge.cipher||{};var modes=forge.cipher.modes=forge.cipher.modes||{};modes.ecb=function(options){options=options||{},this.name="ECB",this.cipher=options.cipher,this.blockSize=options.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},modes.ecb.prototype.start=function(options){},modes.ecb.prototype.encrypt=function(input,output,finish){if(input.length()<this.blockSize&&!(finish&&input.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=input.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)output.putInt32(this._outBlock[i])},modes.ecb.prototype.decrypt=function(input,output,finish){if(input.length()<this.blockSize&&!(finish&&input.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=input.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)output.putInt32(this._outBlock[i])},modes.ecb.prototype.pad=function(input,options){var padding=input.length()===this.blockSize?this.blockSize:this.blockSize-input.length();return input.fillWithByte(padding,padding),!0},modes.ecb.prototype.unpad=function(output,options){if(options.overflow>0)return!1;var len=output.length(),count=output.at(len-1);return!(count>this.blockSize<<2)&&(output.truncate(count),!0)},modes.cbc=function(options){options=options||{},this.name="CBC",this.cipher=options.cipher,this.blockSize=options.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},modes.cbc.prototype.start=function(options){if(null===options.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in options))throw new Error("Invalid IV parameter.");this._iv=transformIV(options.iv),this._prev=this._iv.slice(0)}},modes.cbc.prototype.encrypt=function(input,output,finish){if(input.length()<this.blockSize&&!(finish&&input.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=this._prev[i]^input.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)output.putInt32(this._outBlock[i]);this._prev=this._outBlock},modes.cbc.prototype.decrypt=function(input,output,finish){if(input.length()<this.blockSize&&!(finish&&input.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=input.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)output.putInt32(this._prev[i]^this._outBlock[i]);this._prev=this._inBlock.slice(0)},modes.cbc.prototype.pad=function(input,options){var padding=input.length()===this.blockSize?this.blockSize:this.blockSize-input.length();return input.fillWithByte(padding,padding),!0},modes.cbc.prototype.unpad=function(output,options){if(options.overflow>0)return!1;var len=output.length(),count=output.at(len-1);return!(count>this.blockSize<<2)&&(output.truncate(count),!0)},modes.cfb=function(options){options=options||{},this.name="CFB",this.cipher=options.cipher,this.blockSize=options.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=forge.util.createBuffer(),this._partialBytes=0},modes.cfb.prototype.start=function(options){if(!("iv"in options))throw new Error("Invalid IV parameter.");this._iv=transformIV(options.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},modes.cfb.prototype.encrypt=function(input,output,finish){var inputLength=input.length();if(0===inputLength)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&inputLength>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=input.getInt32()^this._outBlock[i],output.putInt32(this._inBlock[i]);else{var partialBytes=(this.blockSize-inputLength)%this.blockSize;partialBytes>0&&(partialBytes=this.blockSize-partialBytes),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=input.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(partialBytes>0)input.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),partialBytes>0&&!finish)return output.putBytes(this._partialOutput.getBytes(partialBytes-this._partialBytes)),this._partialBytes=partialBytes,!0;output.putBytes(this._partialOutput.getBytes(inputLength-this._partialBytes)),this._partialBytes=0}},modes.cfb.prototype.decrypt=function(input,output,finish){var inputLength=input.length();if(0===inputLength)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&inputLength>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=input.getInt32(),output.putInt32(this._inBlock[i]^this._outBlock[i]);else{var partialBytes=(this.blockSize-inputLength)%this.blockSize;partialBytes>0&&(partialBytes=this.blockSize-partialBytes),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=input.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(partialBytes>0)input.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),partialBytes>0&&!finish)return output.putBytes(this._partialOutput.getBytes(partialBytes-this._partialBytes)),this._partialBytes=partialBytes,!0;output.putBytes(this._partialOutput.getBytes(inputLength-this._partialBytes)),this._partialBytes=0}},modes.ofb=function(options){options=options||{},this.name="OFB",this.cipher=options.cipher,this.blockSize=options.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=forge.util.createBuffer(),this._partialBytes=0},modes.ofb.prototype.start=function(options){if(!("iv"in options))throw new Error("Invalid IV parameter.");this._iv=transformIV(options.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},modes.ofb.prototype.encrypt=function(input,output,finish){var inputLength=input.length();if(0===input.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&inputLength>=this.blockSize)for(var i=0;i<this._ints;++i)output.putInt32(input.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];else{var partialBytes=(this.blockSize-inputLength)%this.blockSize;partialBytes>0&&(partialBytes=this.blockSize-partialBytes),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(input.getInt32()^this._outBlock[i]);if(partialBytes>0)input.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),partialBytes>0&&!finish)return output.putBytes(this._partialOutput.getBytes(partialBytes-this._partialBytes)),this._partialBytes=partialBytes,!0;output.putBytes(this._partialOutput.getBytes(inputLength-this._partialBytes)),this._partialBytes=0}},modes.ofb.prototype.decrypt=modes.ofb.prototype.encrypt,modes.ctr=function(options){options=options||{},this.name="CTR",this.cipher=options.cipher,this.blockSize=options.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=forge.util.createBuffer(),this._partialBytes=0},modes.ctr.prototype.start=function(options){if(!("iv"in options))throw new Error("Invalid IV parameter.");this._iv=transformIV(options.iv),this._inBlock=this._iv.slice(0),this._partialBytes=0},modes.ctr.prototype.encrypt=function(input,output,finish){var inputLength=input.length();if(0===inputLength)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&inputLength>=this.blockSize)for(var i=0;i<this._ints;++i)output.putInt32(input.getInt32()^this._outBlock[i]);else{var partialBytes=(this.blockSize-inputLength)%this.blockSize;partialBytes>0&&(partialBytes=this.blockSize-partialBytes),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(input.getInt32()^this._outBlock[i]);if(partialBytes>0&&(input.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),partialBytes>0&&!finish)return output.putBytes(this._partialOutput.getBytes(partialBytes-this._partialBytes)),this._partialBytes=partialBytes,!0;output.putBytes(this._partialOutput.getBytes(inputLength-this._partialBytes)),this._partialBytes=0}inc32(this._inBlock)},modes.ctr.prototype.decrypt=modes.ctr.prototype.encrypt,modes.gcm=function(options){options=options||{},this.name="GCM",this.cipher=options.cipher,this.blockSize=options.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=forge.util.createBuffer(),this._partialBytes=0,this._R=3774873600},modes.gcm.prototype.start=function(options){if(!("iv"in options))throw new Error("Invalid IV parameter.");var iv=forge.util.createBuffer(options.iv);this._cipherLength=0;var additionalData;if(additionalData="additionalData"in options?forge.util.createBuffer(options.additionalData):forge.util.createBuffer(),"tagLength"in options?this._tagLength=options.tagLength:this._tagLength=128,this._tag=null,options.decrypt&&(this._tag=forge.util.createBuffer(options.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var ivLength=iv.length();if(12===ivLength)this._j0=[iv.getInt32(),iv.getInt32(),iv.getInt32(),1];else{for(this._j0=[0,0,0,0];iv.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[iv.getInt32(),iv.getInt32(),iv.getInt32(),iv.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(from64To32(8*ivLength)))}this._inBlock=this._j0.slice(0),inc32(this._inBlock),this._partialBytes=0,additionalData=forge.util.createBuffer(additionalData),this._aDataLength=from64To32(8*additionalData.length());var overflow=additionalData.length()%this.blockSize;for(overflow&&additionalData.fillWithByte(0,this.blockSize-overflow),this._s=[0,0,0,0];additionalData.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[additionalData.getInt32(),additionalData.getInt32(),additionalData.getInt32(),additionalData.getInt32()])},modes.gcm.prototype.encrypt=function(input,output,finish){var inputLength=input.length();if(0===inputLength)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&inputLength>=this.blockSize){for(var i=0;i<this._ints;++i)output.putInt32(this._outBlock[i]^=input.getInt32());this._cipherLength+=this.blockSize}else{var partialBytes=(this.blockSize-inputLength)%this.blockSize;partialBytes>0&&(partialBytes=this.blockSize-partialBytes),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(input.getInt32()^this._outBlock[i]);if(0===partialBytes||finish){if(finish){var overflow=inputLength%this.blockSize;this._cipherLength+=overflow,this._partialOutput.truncate(this.blockSize-overflow)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),partialBytes>0&&!finish)return input.read-=this.blockSize,output.putBytes(this._partialOutput.getBytes(partialBytes-this._partialBytes)),this._partialBytes=partialBytes,!0;output.putBytes(this._partialOutput.getBytes(inputLength-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),inc32(this._inBlock)},modes.gcm.prototype.decrypt=function(input,output,finish){var inputLength=input.length();if(inputLength<this.blockSize&&!(finish&&inputLength>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),inc32(this._inBlock),this._hashBlock[0]=input.getInt32(),this._hashBlock[1]=input.getInt32(),this._hashBlock[2]=input.getInt32(),this._hashBlock[3]=input.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)output.putInt32(this._outBlock[i]^this._hashBlock[i]);inputLength<this.blockSize?this._cipherLength+=inputLength%this.blockSize:this._cipherLength+=this.blockSize},modes.gcm.prototype.afterFinish=function(output,options){var rval=!0;options.decrypt&&options.overflow&&output.truncate(this.blockSize-options.overflow),this.tag=forge.util.createBuffer();var lengths=this._aDataLength.concat(from64To32(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,lengths);var tag=[];this.cipher.encrypt(this._j0,tag);for(var i=0;i<this._ints;++i)this.tag.putInt32(this._s[i]^tag[i]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),options.decrypt&&this.tag.bytes()!==this._tag&&(rval=!1),rval},modes.gcm.prototype.multiply=function(x,y){for(var z_i=[0,0,0,0],v_i=y.slice(0),i=0;i<128;++i){var x_i=x[i/32|0]&1<<31-i%32;x_i&&(z_i[0]^=v_i[0],z_i[1]^=v_i[1],z_i[2]^=v_i[2],z_i[3]^=v_i[3]),this.pow(v_i,v_i)}return z_i},modes.gcm.prototype.pow=function(x,out){for(var lsb=1&x[3],i=3;i>0;--i)out[i]=x[i]>>>1|(1&x[i-1])<<31;out[0]=x[0]>>>1,lsb&&(out[0]^=this._R)},modes.gcm.prototype.tableMultiply=function(x){for(var z=[0,0,0,0],i=0;i<32;++i){var idx=i/8|0,x_i=x[idx]>>>4*(7-i%8)&15,ah=this._m[i][x_i];z[0]^=ah[0],z[1]^=ah[1],z[2]^=ah[2],z[3]^=ah[3]}return z},modes.gcm.prototype.ghash=function(h,y,x){
return y[0]^=x[0],y[1]^=x[1],y[2]^=x[2],y[3]^=x[3],this.tableMultiply(y)},modes.gcm.prototype.generateHashTable=function(h,bits){for(var multiplier=8/bits,perInt=4*multiplier,size=16*multiplier,m=new Array(size),i=0;i<size;++i){var tmp=[0,0,0,0],idx=i/perInt|0,shft=(perInt-1-i%perInt)*bits;tmp[idx]=1<<bits-1<<shft,m[i]=this.generateSubHashTable(this.multiply(tmp,h),bits)}return m},modes.gcm.prototype.generateSubHashTable=function(mid,bits){var size=1<<bits,half=size>>>1,m=new Array(size);m[half]=mid.slice(0);for(var i=half>>>1;i>0;)this.pow(m[2*i],m[i]=[]),i>>=1;for(i=2;i<half;){for(var j=1;j<i;++j){var m_i=m[i],m_j=m[j];m[i+j]=[m_i[0]^m_j[0],m_i[1]^m_j[1],m_i[2]^m_j[2],m_i[3]^m_j[3]]}i*=2}for(m[0]=[0,0,0,0],i=half+1;i<size;++i){var c=m[i^half];m[i]=[mid[0]^c[0],mid[1]^c[1],mid[2]^c[2],mid[3]^c[3]]}return m}}var name="cipherModes";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/cipherModes",["require","module","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){function registerAlgorithm(name,mode){var factory=function(){return new forge.aes.Algorithm(name,mode)};forge.cipher.registerAlgorithm(name,factory)}function initialize(){init=!0,rcon=[0,1,2,4,8,16,32,64,128,27,54];for(var xtime=new Array(256),i=0;i<128;++i)xtime[i]=i<<1,xtime[i+128]=i+128<<1^283;sbox=new Array(256),isbox=new Array(256),mix=new Array(4),imix=new Array(4);for(var i=0;i<4;++i)mix[i]=new Array(256),imix[i]=new Array(256);for(var e2,e4,e8,sx,sx2,me,ime,e=0,ei=0,i=0;i<256;++i){sx=ei^ei<<1^ei<<2^ei<<3^ei<<4,sx=sx>>8^255&sx^99,sbox[e]=sx,isbox[sx]=e,sx2=xtime[sx],e2=xtime[e],e4=xtime[e2],e8=xtime[e4],me=sx2<<24^sx<<16^sx<<8^(sx^sx2),ime=(e2^e4^e8)<<24^(e^e8)<<16^(e^e4^e8)<<8^(e^e2^e8);for(var n=0;n<4;++n)mix[n][e]=me,imix[n][sx]=ime,me=me<<24|me>>>8,ime=ime<<24|ime>>>8;0===e?e=ei=1:(e=e2^xtime[xtime[xtime[e2^e8]]],ei^=xtime[xtime[ei]])}}function _expandKey(key,decrypt){for(var temp,w=key.slice(0),iNk=1,Nk=w.length,Nr1=Nk+6+1,end=Nb*Nr1,i=Nk;i<end;++i)temp=w[i-1],i%Nk===0?(temp=sbox[temp>>>16&255]<<24^sbox[temp>>>8&255]<<16^sbox[255&temp]<<8^sbox[temp>>>24]^rcon[iNk]<<24,iNk++):Nk>6&&i%Nk===4&&(temp=sbox[temp>>>24]<<24^sbox[temp>>>16&255]<<16^sbox[temp>>>8&255]<<8^sbox[255&temp]),w[i]=w[i-Nk]^temp;if(decrypt){var tmp,m0=imix[0],m1=imix[1],m2=imix[2],m3=imix[3],wnew=w.slice(0);end=w.length;for(var i=0,wi=end-Nb;i<end;i+=Nb,wi-=Nb)if(0===i||i===end-Nb)wnew[i]=w[wi],wnew[i+1]=w[wi+3],wnew[i+2]=w[wi+2],wnew[i+3]=w[wi+1];else for(var n=0;n<Nb;++n)tmp=w[wi+n],wnew[i+(3&-n)]=m0[sbox[tmp>>>24]]^m1[sbox[tmp>>>16&255]]^m2[sbox[tmp>>>8&255]]^m3[sbox[255&tmp]];w=wnew}return w}function _updateBlock(w,input,output,decrypt){var m0,m1,m2,m3,sub,Nr=w.length/4-1;decrypt?(m0=imix[0],m1=imix[1],m2=imix[2],m3=imix[3],sub=isbox):(m0=mix[0],m1=mix[1],m2=mix[2],m3=mix[3],sub=sbox);var a,b,c,d,a2,b2,c2;a=input[0]^w[0],b=input[decrypt?3:1]^w[1],c=input[2]^w[2],d=input[decrypt?1:3]^w[3];for(var i=3,round=1;round<Nr;++round)a2=m0[a>>>24]^m1[b>>>16&255]^m2[c>>>8&255]^m3[255&d]^w[++i],b2=m0[b>>>24]^m1[c>>>16&255]^m2[d>>>8&255]^m3[255&a]^w[++i],c2=m0[c>>>24]^m1[d>>>16&255]^m2[a>>>8&255]^m3[255&b]^w[++i],d=m0[d>>>24]^m1[a>>>16&255]^m2[b>>>8&255]^m3[255&c]^w[++i],a=a2,b=b2,c=c2;output[0]=sub[a>>>24]<<24^sub[b>>>16&255]<<16^sub[c>>>8&255]<<8^sub[255&d]^w[++i],output[decrypt?3:1]=sub[b>>>24]<<24^sub[c>>>16&255]<<16^sub[d>>>8&255]<<8^sub[255&a]^w[++i],output[2]=sub[c>>>24]<<24^sub[d>>>16&255]<<16^sub[a>>>8&255]<<8^sub[255&b]^w[++i],output[decrypt?1:3]=sub[d>>>24]<<24^sub[a>>>16&255]<<16^sub[b>>>8&255]<<8^sub[255&c]^w[++i]}function _createCipher(options){options=options||{};var cipher,mode=(options.mode||"CBC").toUpperCase(),algorithm="AES-"+mode;cipher=options.decrypt?forge.cipher.createDecipher(algorithm,options.key):forge.cipher.createCipher(algorithm,options.key);var start=cipher.start;return cipher.start=function(iv,options){var output=null;options instanceof forge.util.ByteBuffer&&(output=options,options={}),options=options||{},options.output=output,options.iv=iv,start.call(cipher,options)},cipher}forge.aes=forge.aes||{},forge.aes.startEncrypting=function(key,iv,output,mode){var cipher=_createCipher({key:key,output:output,decrypt:!1,mode:mode});return cipher.start(iv),cipher},forge.aes.createEncryptionCipher=function(key,mode){return _createCipher({key:key,output:null,decrypt:!1,mode:mode})},forge.aes.startDecrypting=function(key,iv,output,mode){var cipher=_createCipher({key:key,output:output,decrypt:!0,mode:mode});return cipher.start(iv),cipher},forge.aes.createDecryptionCipher=function(key,mode){return _createCipher({key:key,output:null,decrypt:!0,mode:mode})},forge.aes.Algorithm=function(name,mode){init||initialize();var self=this;self.name=name,self.mode=new mode({blockSize:16,cipher:{encrypt:function(inBlock,outBlock){return _updateBlock(self._w,inBlock,outBlock,!1)},decrypt:function(inBlock,outBlock){return _updateBlock(self._w,inBlock,outBlock,!0)}}}),self._init=!1},forge.aes.Algorithm.prototype.initialize=function(options){if(!this._init){var tmp,key=options.key;if("string"!=typeof key||16!==key.length&&24!==key.length&&32!==key.length){if(forge.util.isArray(key)&&(16===key.length||24===key.length||32===key.length)){tmp=key,key=forge.util.createBuffer();for(var i=0;i<tmp.length;++i)key.putByte(tmp[i])}}else key=forge.util.createBuffer(key);if(!forge.util.isArray(key)){tmp=key,key=[];var len=tmp.length();if(16===len||24===len||32===len){len>>>=2;for(var i=0;i<len;++i)key.push(tmp.getInt32())}}if(!forge.util.isArray(key)||4!==key.length&&6!==key.length&&8!==key.length)throw new Error("Invalid key parameter.");var mode=this.mode.name,encryptOp=["CFB","OFB","CTR","GCM"].indexOf(mode)!==-1;this._w=_expandKey(key,options.decrypt&&!encryptOp),this._init=!0}},forge.aes._expandKey=function(key,decrypt){return init||initialize(),_expandKey(key,decrypt)},forge.aes._updateBlock=_updateBlock,registerAlgorithm("AES-CBC",forge.cipher.modes.cbc),registerAlgorithm("AES-CFB",forge.cipher.modes.cfb),registerAlgorithm("AES-OFB",forge.cipher.modes.ofb),registerAlgorithm("AES-CTR",forge.cipher.modes.ctr),registerAlgorithm("AES-GCM",forge.cipher.modes.gcm);var sbox,isbox,rcon,mix,imix,init=!1,Nb=4}var name="aes";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/aes",["require","module","./cipher","./cipherModes","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){forge.pki=forge.pki||{};var oids=forge.pki.oids=forge.oids=forge.oids||{};oids["1.2.840.113549.1.1.1"]="rsaEncryption",oids.rsaEncryption="1.2.840.113549.1.1.1",oids["1.2.840.113549.1.1.4"]="md5WithRSAEncryption",oids.md5WithRSAEncryption="1.2.840.113549.1.1.4",oids["1.2.840.113549.1.1.5"]="sha1WithRSAEncryption",oids.sha1WithRSAEncryption="1.2.840.113549.1.1.5",oids["1.2.840.113549.1.1.7"]="RSAES-OAEP",oids["RSAES-OAEP"]="1.2.840.113549.1.1.7",oids["1.2.840.113549.1.1.8"]="mgf1",oids.mgf1="1.2.840.113549.1.1.8",oids["1.2.840.113549.1.1.9"]="pSpecified",oids.pSpecified="1.2.840.113549.1.1.9",oids["1.2.840.113549.1.1.10"]="RSASSA-PSS",oids["RSASSA-PSS"]="1.2.840.113549.1.1.10",oids["1.2.840.113549.1.1.11"]="sha256WithRSAEncryption",oids.sha256WithRSAEncryption="1.2.840.113549.1.1.11",oids["1.2.840.113549.1.1.12"]="sha384WithRSAEncryption",oids.sha384WithRSAEncryption="1.2.840.113549.1.1.12",oids["1.2.840.113549.1.1.13"]="sha512WithRSAEncryption",oids.sha512WithRSAEncryption="1.2.840.113549.1.1.13",oids["1.3.14.3.2.7"]="desCBC",oids.desCBC="1.3.14.3.2.7",oids["1.3.14.3.2.26"]="sha1",oids.sha1="1.3.14.3.2.26",oids["2.16.840.1.101.3.4.2.1"]="sha256",oids.sha256="2.16.840.1.101.3.4.2.1",oids["2.16.840.1.101.3.4.2.2"]="sha384",oids.sha384="2.16.840.1.101.3.4.2.2",oids["2.16.840.1.101.3.4.2.3"]="sha512",oids.sha512="2.16.840.1.101.3.4.2.3",oids["1.2.840.113549.2.5"]="md5",oids.md5="1.2.840.113549.2.5",oids["1.2.840.113549.1.7.1"]="data",oids.data="1.2.840.113549.1.7.1",oids["1.2.840.113549.1.7.2"]="signedData",oids.signedData="1.2.840.113549.1.7.2",oids["1.2.840.113549.1.7.3"]="envelopedData",oids.envelopedData="1.2.840.113549.1.7.3",oids["1.2.840.113549.1.7.4"]="signedAndEnvelopedData",oids.signedAndEnvelopedData="1.2.840.113549.1.7.4",oids["1.2.840.113549.1.7.5"]="digestedData",oids.digestedData="1.2.840.113549.1.7.5",oids["1.2.840.113549.1.7.6"]="encryptedData",oids.encryptedData="1.2.840.113549.1.7.6",oids["1.2.840.113549.1.9.1"]="emailAddress",oids.emailAddress="1.2.840.113549.1.9.1",oids["1.2.840.113549.1.9.2"]="unstructuredName",oids.unstructuredName="1.2.840.113549.1.9.2",oids["1.2.840.113549.1.9.3"]="contentType",oids.contentType="1.2.840.113549.1.9.3",oids["1.2.840.113549.1.9.4"]="messageDigest",oids.messageDigest="1.2.840.113549.1.9.4",oids["1.2.840.113549.1.9.5"]="signingTime",oids.signingTime="1.2.840.113549.1.9.5",oids["1.2.840.113549.1.9.6"]="counterSignature",oids.counterSignature="1.2.840.113549.1.9.6",oids["1.2.840.113549.1.9.7"]="challengePassword",oids.challengePassword="1.2.840.113549.1.9.7",oids["1.2.840.113549.1.9.8"]="unstructuredAddress",oids.unstructuredAddress="1.2.840.113549.1.9.8",oids["1.2.840.113549.1.9.14"]="extensionRequest",oids.extensionRequest="1.2.840.113549.1.9.14",oids["1.2.840.113549.1.9.20"]="friendlyName",oids.friendlyName="1.2.840.113549.1.9.20",oids["1.2.840.113549.1.9.21"]="localKeyId",oids.localKeyId="1.2.840.113549.1.9.21",oids["1.2.840.113549.1.9.22.1"]="x509Certificate",oids.x509Certificate="1.2.840.113549.1.9.22.1",oids["1.2.840.113549.1.12.10.1.1"]="keyBag",oids.keyBag="1.2.840.113549.1.12.10.1.1",oids["1.2.840.113549.1.12.10.1.2"]="pkcs8ShroudedKeyBag",oids.pkcs8ShroudedKeyBag="1.2.840.113549.1.12.10.1.2",oids["1.2.840.113549.1.12.10.1.3"]="certBag",oids.certBag="1.2.840.113549.1.12.10.1.3",oids["1.2.840.113549.1.12.10.1.4"]="crlBag",oids.crlBag="1.2.840.113549.1.12.10.1.4",oids["1.2.840.113549.1.12.10.1.5"]="secretBag",oids.secretBag="1.2.840.113549.1.12.10.1.5",oids["1.2.840.113549.1.12.10.1.6"]="safeContentsBag",oids.safeContentsBag="1.2.840.113549.1.12.10.1.6",oids["1.2.840.113549.1.5.13"]="pkcs5PBES2",oids.pkcs5PBES2="1.2.840.113549.1.5.13",oids["1.2.840.113549.1.5.12"]="pkcs5PBKDF2",oids.pkcs5PBKDF2="1.2.840.113549.1.5.12",oids["1.2.840.113549.1.12.1.1"]="pbeWithSHAAnd128BitRC4",oids.pbeWithSHAAnd128BitRC4="1.2.840.113549.1.12.1.1",oids["1.2.840.113549.1.12.1.2"]="pbeWithSHAAnd40BitRC4",oids.pbeWithSHAAnd40BitRC4="1.2.840.113549.1.12.1.2",oids["1.2.840.113549.1.12.1.3"]="pbeWithSHAAnd3-KeyTripleDES-CBC",oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.3",oids["1.2.840.113549.1.12.1.4"]="pbeWithSHAAnd2-KeyTripleDES-CBC",oids["pbeWithSHAAnd2-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.4",oids["1.2.840.113549.1.12.1.5"]="pbeWithSHAAnd128BitRC2-CBC",oids["pbeWithSHAAnd128BitRC2-CBC"]="1.2.840.113549.1.12.1.5",oids["1.2.840.113549.1.12.1.6"]="pbewithSHAAnd40BitRC2-CBC",oids["pbewithSHAAnd40BitRC2-CBC"]="1.2.840.113549.1.12.1.6",oids["1.2.840.113549.3.7"]="des-EDE3-CBC",oids["des-EDE3-CBC"]="1.2.840.113549.3.7",oids["2.16.840.1.101.3.4.1.2"]="aes128-CBC",oids["aes128-CBC"]="2.16.840.1.101.3.4.1.2",oids["2.16.840.1.101.3.4.1.22"]="aes192-CBC",oids["aes192-CBC"]="2.16.840.1.101.3.4.1.22",oids["2.16.840.1.101.3.4.1.42"]="aes256-CBC",oids["aes256-CBC"]="2.16.840.1.101.3.4.1.42",oids["2.5.4.3"]="commonName",oids.commonName="2.5.4.3",oids["2.5.4.5"]="serialName",oids.serialName="2.5.4.5",oids["2.5.4.6"]="countryName",oids.countryName="2.5.4.6",oids["2.5.4.7"]="localityName",oids.localityName="2.5.4.7",oids["2.5.4.8"]="stateOrProvinceName",oids.stateOrProvinceName="2.5.4.8",oids["2.5.4.10"]="organizationName",oids.organizationName="2.5.4.10",oids["2.5.4.11"]="organizationalUnitName",oids.organizationalUnitName="2.5.4.11",oids["2.16.840.1.113730.1.1"]="nsCertType",oids.nsCertType="2.16.840.1.113730.1.1",oids["2.5.29.1"]="authorityKeyIdentifier",oids["2.5.29.2"]="keyAttributes",oids["2.5.29.3"]="certificatePolicies",oids["2.5.29.4"]="keyUsageRestriction",oids["2.5.29.5"]="policyMapping",oids["2.5.29.6"]="subtreesConstraint",oids["2.5.29.7"]="subjectAltName",oids["2.5.29.8"]="issuerAltName",oids["2.5.29.9"]="subjectDirectoryAttributes",oids["2.5.29.10"]="basicConstraints",oids["2.5.29.11"]="nameConstraints",oids["2.5.29.12"]="policyConstraints",oids["2.5.29.13"]="basicConstraints",oids["2.5.29.14"]="subjectKeyIdentifier",oids.subjectKeyIdentifier="2.5.29.14",oids["2.5.29.15"]="keyUsage",oids.keyUsage="2.5.29.15",oids["2.5.29.16"]="privateKeyUsagePeriod",oids["2.5.29.17"]="subjectAltName",oids.subjectAltName="2.5.29.17",oids["2.5.29.18"]="issuerAltName",oids.issuerAltName="2.5.29.18",oids["2.5.29.19"]="basicConstraints",oids.basicConstraints="2.5.29.19",oids["2.5.29.20"]="cRLNumber",oids["2.5.29.21"]="cRLReason",oids["2.5.29.22"]="expirationDate",oids["2.5.29.23"]="instructionCode",oids["2.5.29.24"]="invalidityDate",oids["2.5.29.25"]="cRLDistributionPoints",oids["2.5.29.26"]="issuingDistributionPoint",oids["2.5.29.27"]="deltaCRLIndicator",oids["2.5.29.28"]="issuingDistributionPoint",oids["2.5.29.29"]="certificateIssuer",oids["2.5.29.30"]="nameConstraints",oids["2.5.29.31"]="cRLDistributionPoints",oids["2.5.29.32"]="certificatePolicies",oids["2.5.29.33"]="policyMappings",oids["2.5.29.34"]="policyConstraints",oids["2.5.29.35"]="authorityKeyIdentifier",oids["2.5.29.36"]="policyConstraints",oids["2.5.29.37"]="extKeyUsage",oids.extKeyUsage="2.5.29.37",oids["2.5.29.46"]="freshestCRL",oids["2.5.29.54"]="inhibitAnyPolicy",oids["1.3.6.1.5.5.7.3.1"]="serverAuth",oids.serverAuth="1.3.6.1.5.5.7.3.1",oids["1.3.6.1.5.5.7.3.2"]="clientAuth",oids.clientAuth="1.3.6.1.5.5.7.3.2",oids["1.3.6.1.5.5.7.3.3"]="codeSigning",oids.codeSigning="1.3.6.1.5.5.7.3.3",oids["1.3.6.1.5.5.7.3.4"]="emailProtection",oids.emailProtection="1.3.6.1.5.5.7.3.4",oids["1.3.6.1.5.5.7.3.8"]="timeStamping",oids.timeStamping="1.3.6.1.5.5.7.3.8"}var name="oids";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/oids",["require","module"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){var asn1=forge.asn1=forge.asn1||{};asn1.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},asn1.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},asn1.create=function(tagClass,type,constructed,value){if(forge.util.isArray(value)){for(var tmp=[],i=0;i<value.length;++i)void 0!==value[i]&&tmp.push(value[i]);value=tmp}return{tagClass:tagClass,type:type,constructed:constructed,composed:constructed||forge.util.isArray(value),value:value}};var _getValueLength=function(b){var b2=b.getByte();if(128!==b2){var length,longForm=128&b2;return length=longForm?b.getInt((127&b2)<<3):b2}};asn1.fromDer=function(bytes,strict){if(void 0===strict&&(strict=!0),"string"==typeof bytes&&(bytes=forge.util.createBuffer(bytes)),bytes.length()<2){var error=new Error("Too few bytes to parse DER.");throw error.bytes=bytes.length(),error}var b1=bytes.getByte(),tagClass=192&b1,type=31&b1,length=_getValueLength(bytes);if(bytes.length()<length){if(strict){var error=new Error("Too few bytes to read ASN.1 value.");throw error.detail=bytes.length()+" < "+length,error}length=bytes.length()}var value,constructed=32===(32&b1),composed=constructed;if(!composed&&tagClass===asn1.Class.UNIVERSAL&&type===asn1.Type.BITSTRING&&length>1){var read=bytes.read,unused=bytes.getByte();if(0===unused){b1=bytes.getByte();var tc=192&b1;if(tc===asn1.Class.UNIVERSAL||tc===asn1.Class.CONTEXT_SPECIFIC)try{var len=_getValueLength(bytes);composed=len===length-(bytes.read-read),composed&&(++read,--length)}catch(ex){}}bytes.read=read}if(composed)if(value=[],void 0===length)for(;;){if(bytes.bytes(2)===String.fromCharCode(0,0)){bytes.getBytes(2);break}value.push(asn1.fromDer(bytes,strict))}else for(var start=bytes.length();length>0;)value.push(asn1.fromDer(bytes,strict)),length-=start-bytes.length(),start=bytes.length();else{if(void 0===length){if(strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");length=bytes.length()}if(type===asn1.Type.BMPSTRING){value="";for(var i=0;i<length;i+=2)value+=String.fromCharCode(bytes.getInt16())}else value=bytes.getBytes(length)}return asn1.create(tagClass,type,constructed,value)},asn1.toDer=function(obj){var bytes=forge.util.createBuffer(),b1=obj.tagClass|obj.type,value=forge.util.createBuffer();if(obj.composed){obj.constructed?b1|=32:value.putByte(0);for(var i=0;i<obj.value.length;++i)void 0!==obj.value[i]&&value.putBuffer(asn1.toDer(obj.value[i]))}else if(obj.type===asn1.Type.BMPSTRING)for(var i=0;i<obj.value.length;++i)value.putInt16(obj.value.charCodeAt(i));else value.putBytes(obj.value);if(bytes.putByte(b1),value.length()<=127)bytes.putByte(127&value.length());else{var len=value.length(),lenBytes="";do lenBytes+=String.fromCharCode(255&len),len>>>=8;while(len>0);bytes.putByte(128|lenBytes.length);for(var i=lenBytes.length-1;i>=0;--i)bytes.putByte(lenBytes.charCodeAt(i))}return bytes.putBuffer(value),bytes},asn1.oidToDer=function(oid){var values=oid.split("."),bytes=forge.util.createBuffer();bytes.putByte(40*parseInt(values[0],10)+parseInt(values[1],10));for(var last,valueBytes,value,b,i=2;i<values.length;++i){last=!0,valueBytes=[],value=parseInt(values[i],10);do b=127&value,value>>>=7,last||(b|=128),valueBytes.push(b),last=!1;while(value>0);for(var n=valueBytes.length-1;n>=0;--n)bytes.putByte(valueBytes[n])}return bytes},asn1.derToOid=function(bytes){var oid;"string"==typeof bytes&&(bytes=forge.util.createBuffer(bytes));var b=bytes.getByte();oid=Math.floor(b/40)+"."+b%40;for(var value=0;bytes.length()>0;)b=bytes.getByte(),value<<=7,128&b?value+=127&b:(oid+="."+(value+b),value=0);return oid},asn1.utcTimeToDate=function(utc){var date=new Date,year=parseInt(utc.substr(0,2),10);year=year>=50?1900+year:2e3+year;var MM=parseInt(utc.substr(2,2),10)-1,DD=parseInt(utc.substr(4,2),10),hh=parseInt(utc.substr(6,2),10),mm=parseInt(utc.substr(8,2),10),ss=0;if(utc.length>11){var c=utc.charAt(10),end=10;"+"!==c&&"-"!==c&&(ss=parseInt(utc.substr(10,2),10),end+=2)}if(date.setUTCFullYear(year,MM,DD),date.setUTCHours(hh,mm,ss,0),end&&(c=utc.charAt(end),"+"===c||"-"===c)){var hhoffset=parseInt(utc.substr(end+1,2),10),mmoffset=parseInt(utc.substr(end+4,2),10),offset=60*hhoffset+mmoffset;offset*=6e4,"+"===c?date.setTime(+date-offset):date.setTime(+date+offset)}return date},asn1.generalizedTimeToDate=function(gentime){var date=new Date,YYYY=parseInt(gentime.substr(0,4),10),MM=parseInt(gentime.substr(4,2),10)-1,DD=parseInt(gentime.substr(6,2),10),hh=parseInt(gentime.substr(8,2),10),mm=parseInt(gentime.substr(10,2),10),ss=parseInt(gentime.substr(12,2),10),fff=0,offset=0,isUTC=!1;"Z"===gentime.charAt(gentime.length-1)&&(isUTC=!0);var end=gentime.length-5,c=gentime.charAt(end);if("+"===c||"-"===c){var hhoffset=parseInt(gentime.substr(end+1,2),10),mmoffset=parseInt(gentime.substr(end+4,2),10);offset=60*hhoffset+mmoffset,offset*=6e4,"+"===c&&(offset*=-1),isUTC=!0}return"."===gentime.charAt(14)&&(fff=1e3*parseFloat(gentime.substr(14),10)),isUTC?(date.setUTCFullYear(YYYY,MM,DD),date.setUTCHours(hh,mm,ss,fff),date.setTime(+date+offset)):(date.setFullYear(YYYY,MM,DD),date.setHours(hh,mm,ss,fff)),date},asn1.dateToUtcTime=function(date){var rval="",format=[];format.push((""+date.getUTCFullYear()).substr(2)),format.push(""+(date.getUTCMonth()+1)),format.push(""+date.getUTCDate()),format.push(""+date.getUTCHours()),format.push(""+date.getUTCMinutes()),format.push(""+date.getUTCSeconds());for(var i=0;i<format.length;++i)format[i].length<2&&(rval+="0"),rval+=format[i];return rval+="Z"},asn1.integerToDer=function(x){var rval=forge.util.createBuffer();if(x>=-128&&x<128)return rval.putSignedInt(x,8);if(x>=-32768&&x<32768)return rval.putSignedInt(x,16);if(x>=-8388608&&x<8388608)return rval.putSignedInt(x,24);if(x>=-2147483648&&x<2147483648)return rval.putSignedInt(x,32);var error=new Error("Integer too large; max is 32-bits.");throw error.integer=x,error},asn1.derToInteger=function(bytes){"string"==typeof bytes&&(bytes=forge.util.createBuffer(bytes));var n=8*bytes.length();if(n>32)throw new Error("Integer too large; max is 32-bits.");return bytes.getSignedInt(n)},asn1.validate=function(obj,v,capture,errors){var rval=!1;if(obj.tagClass!==v.tagClass&&"undefined"!=typeof v.tagClass||obj.type!==v.type&&"undefined"!=typeof v.type)errors&&(obj.tagClass!==v.tagClass&&errors.push("["+v.name+'] Expected tag class "'+v.tagClass+'", got "'+obj.tagClass+'"'),obj.type!==v.type&&errors.push("["+v.name+'] Expected type "'+v.type+'", got "'+obj.type+'"'));else if(obj.constructed===v.constructed||"undefined"==typeof v.constructed){if(rval=!0,v.value&&forge.util.isArray(v.value))for(var j=0,i=0;rval&&i<v.value.length;++i)rval=v.value[i].optional||!1,obj.value[j]&&(rval=asn1.validate(obj.value[j],v.value[i],capture,errors),rval?++j:v.value[i].optional&&(rval=!0)),!rval&&errors&&errors.push("["+v.name+'] Tag class "'+v.tagClass+'", type "'+v.type+'" expected value length "'+v.value.length+'", got "'+obj.value.length+'"');rval&&capture&&(v.capture&&(capture[v.capture]=obj.value),v.captureAsn1&&(capture[v.captureAsn1]=obj))}else errors&&errors.push("["+v.name+'] Expected constructed "'+v.constructed+'", got "'+obj.constructed+'"');return rval};var _nonLatinRegex=/[^\\u0000-\\u00ff]/;asn1.prettyPrint=function(obj,level,indentation){var rval="";level=level||0,indentation=indentation||2,level>0&&(rval+="\n");for(var indent="",i=0;i<level*indentation;++i)indent+=" ";switch(rval+=indent+"Tag: ",obj.tagClass){case asn1.Class.UNIVERSAL:rval+="Universal:";break;case asn1.Class.APPLICATION:rval+="Application:";break;case asn1.Class.CONTEXT_SPECIFIC:rval+="Context-Specific:";break;case asn1.Class.PRIVATE:rval+="Private:"}if(obj.tagClass===asn1.Class.UNIVERSAL)switch(rval+=obj.type,obj.type){case asn1.Type.NONE:rval+=" (None)";break;case asn1.Type.BOOLEAN:rval+=" (Boolean)";break;case asn1.Type.BITSTRING:rval+=" (Bit string)";break;case asn1.Type.INTEGER:rval+=" (Integer)";break;case asn1.Type.OCTETSTRING:rval+=" (Octet string)";break;case asn1.Type.NULL:rval+=" (Null)";break;case asn1.Type.OID:rval+=" (Object Identifier)";break;case asn1.Type.ODESC:rval+=" (Object Descriptor)";break;case asn1.Type.EXTERNAL:rval+=" (External or Instance of)";break;case asn1.Type.REAL:rval+=" (Real)";break;case asn1.Type.ENUMERATED:rval+=" (Enumerated)";break;case asn1.Type.EMBEDDED:rval+=" (Embedded PDV)";break;case asn1.Type.UTF8:rval+=" (UTF8)";break;case asn1.Type.ROID:rval+=" (Relative Object Identifier)";break;case asn1.Type.SEQUENCE:rval+=" (Sequence)";break;case asn1.Type.SET:rval+=" (Set)";break;case asn1.Type.PRINTABLESTRING:rval+=" (Printable String)";break;case asn1.Type.IA5String:rval+=" (IA5String (ASCII))";break;case asn1.Type.UTCTIME:rval+=" (UTC time)";break;case asn1.Type.GENERALIZEDTIME:rval+=" (Generalized time)";break;case asn1.Type.BMPSTRING:rval+=" (BMP String)"}else rval+=obj.type;if(rval+="\n",rval+=indent+"Constructed: "+obj.constructed+"\n",obj.composed){for(var subvalues=0,sub="",i=0;i<obj.value.length;++i)void 0!==obj.value[i]&&(subvalues+=1,sub+=asn1.prettyPrint(obj.value[i],level+1,indentation),i+1<obj.value.length&&(sub+=","));rval+=indent+"Sub values: "+subvalues+sub}else{if(rval+=indent+"Value: ",obj.type===asn1.Type.OID){var oid=asn1.derToOid(obj.value);rval+=oid,forge.pki&&forge.pki.oids&&oid in forge.pki.oids&&(rval+=" ("+forge.pki.oids[oid]+") ")}if(obj.type===asn1.Type.INTEGER)try{rval+=asn1.derToInteger(obj.value)}catch(ex){rval+="0x"+forge.util.bytesToHex(obj.value)}else obj.type===asn1.Type.OCTETSTRING?(_nonLatinRegex.test(obj.value)||(rval+="("+obj.value+") "),rval+="0x"+forge.util.bytesToHex(obj.value)):rval+=obj.type===asn1.Type.UTF8?forge.util.decodeUtf8(obj.value):obj.type===asn1.Type.PRINTABLESTRING||obj.type===asn1.Type.IA5String?obj.value:_nonLatinRegex.test(obj.value)?"0x"+forge.util.bytesToHex(obj.value):0===obj.value.length?"[null]":obj.value}return rval}}var name="asn1";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/asn1",["require","module","./util","./oids"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){function _init(){_padding=String.fromCharCode(128),_padding+=forge.util.fillString(String.fromCharCode(0),64),_g=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],_r=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],_k=new Array(64);for(var i=0;i<64;++i)_k[i]=Math.floor(4294967296*Math.abs(Math.sin(i+1)));_initialized=!0}function _update(s,w,bytes){for(var t,a,b,c,d,f,r,i,len=bytes.length();len>=64;){for(a=s.h0,b=s.h1,c=s.h2,d=s.h3,i=0;i<16;++i)w[i]=bytes.getInt32Le(),f=d^b&(c^d),t=a+f+_k[i]+w[i],r=_r[i],a=d,d=c,c=b,b+=t<<r|t>>>32-r;for(;i<32;++i)f=c^d&(b^c),t=a+f+_k[i]+w[_g[i]],r=_r[i],a=d,d=c,c=b,b+=t<<r|t>>>32-r;for(;i<48;++i)f=b^c^d,t=a+f+_k[i]+w[_g[i]],r=_r[i],a=d,d=c,c=b,b+=t<<r|t>>>32-r;for(;i<64;++i)f=c^(b|~d),t=a+f+_k[i]+w[_g[i]],r=_r[i],a=d,d=c,c=b,b+=t<<r|t>>>32-r;s.h0=s.h0+a|0,s.h1=s.h1+b|0,s.h2=s.h2+c|0,s.h3=s.h3+d|0,len-=64}}var md5=forge.md5=forge.md5||{};forge.md=forge.md||{},forge.md.algorithms=forge.md.algorithms||{},forge.md.md5=forge.md.algorithms.md5=md5,md5.create=function(){_initialized||_init();var _state=null,_input=forge.util.createBuffer(),_w=new Array(16),md={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,messageLength64:[0,0]};return md.start=function(){return md.messageLength=0,md.messageLength64=[0,0],_input=forge.util.createBuffer(),_state={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},md},md.start(),md.update=function(msg,encoding){return"utf8"===encoding&&(msg=forge.util.encodeUtf8(msg)),md.messageLength+=msg.length,md.messageLength64[0]+=msg.length/4294967296>>>0,md.messageLength64[1]+=msg.length>>>0,_input.putBytes(msg),_update(_state,_w,_input),(_input.read>2048||0===_input.length())&&_input.compact(),md},md.digest=function(){var padBytes=forge.util.createBuffer();padBytes.putBytes(_input.bytes()),padBytes.putBytes(_padding.substr(0,64-(md.messageLength64[1]+8&63))),padBytes.putInt32Le(md.messageLength64[1]<<3),padBytes.putInt32Le(md.messageLength64[0]<<3|md.messageLength64[0]>>>28);var s2={h0:_state.h0,h1:_state.h1,h2:_state.h2,h3:_state.h3};_update(s2,_w,padBytes);var rval=forge.util.createBuffer();return rval.putInt32Le(s2.h0),rval.putInt32Le(s2.h1),rval.putInt32Le(s2.h2),rval.putInt32Le(s2.h3),rval},md};var _padding=null,_g=null,_r=null,_k=null,_initialized=!1}var name="md5";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/md5",["require","module","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){function _init(){_padding=String.fromCharCode(128),_padding+=forge.util.fillString(String.fromCharCode(0),64),_initialized=!0}function _update(s,w,bytes){for(var t,a,b,c,d,e,f,i,len=bytes.length();len>=64;){for(a=s.h0,b=s.h1,c=s.h2,d=s.h3,e=s.h4,i=0;i<16;++i)t=bytes.getInt32(),w[i]=t,f=d^b&(c^d),t=(a<<5|a>>>27)+f+e+1518500249+t,e=d,d=c,c=b<<30|b>>>2,b=a,a=t;for(;i<20;++i)t=w[i-3]^w[i-8]^w[i-14]^w[i-16],t=t<<1|t>>>31,w[i]=t,f=d^b&(c^d),t=(a<<5|a>>>27)+f+e+1518500249+t,e=d,d=c,c=b<<30|b>>>2,b=a,a=t;for(;i<32;++i)t=w[i-3]^w[i-8]^w[i-14]^w[i-16],t=t<<1|t>>>31,w[i]=t,f=b^c^d,t=(a<<5|a>>>27)+f+e+1859775393+t,e=d,d=c,c=b<<30|b>>>2,b=a,a=t;for(;i<40;++i)t=w[i-6]^w[i-16]^w[i-28]^w[i-32],t=t<<2|t>>>30,w[i]=t,f=b^c^d,t=(a<<5|a>>>27)+f+e+1859775393+t,e=d,d=c,c=b<<30|b>>>2,b=a,a=t;for(;i<60;++i)t=w[i-6]^w[i-16]^w[i-28]^w[i-32],t=t<<2|t>>>30,w[i]=t,f=b&c|d&(b^c),t=(a<<5|a>>>27)+f+e+2400959708+t,e=d,d=c,c=b<<30|b>>>2,b=a,a=t;for(;i<80;++i)t=w[i-6]^w[i-16]^w[i-28]^w[i-32],t=t<<2|t>>>30,w[i]=t,f=b^c^d,t=(a<<5|a>>>27)+f+e+3395469782+t,e=d,d=c,c=b<<30|b>>>2,b=a,a=t;s.h0=s.h0+a|0,s.h1=s.h1+b|0,s.h2=s.h2+c|0,s.h3=s.h3+d|0,s.h4=s.h4+e|0,len-=64}}var sha1=forge.sha1=forge.sha1||{};forge.md=forge.md||{},forge.md.algorithms=forge.md.algorithms||{},
forge.md.sha1=forge.md.algorithms.sha1=sha1,sha1.create=function(){_initialized||_init();var _state=null,_input=forge.util.createBuffer(),_w=new Array(80),md={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,messageLength64:[0,0]};return md.start=function(){return md.messageLength=0,md.messageLength64=[0,0],_input=forge.util.createBuffer(),_state={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},md},md.start(),md.update=function(msg,encoding){return"utf8"===encoding&&(msg=forge.util.encodeUtf8(msg)),md.messageLength+=msg.length,md.messageLength64[0]+=msg.length/4294967296>>>0,md.messageLength64[1]+=msg.length>>>0,_input.putBytes(msg),_update(_state,_w,_input),(_input.read>2048||0===_input.length())&&_input.compact(),md},md.digest=function(){var padBytes=forge.util.createBuffer();padBytes.putBytes(_input.bytes()),padBytes.putBytes(_padding.substr(0,64-(md.messageLength64[1]+8&63))),padBytes.putInt32(md.messageLength64[0]<<3|md.messageLength64[0]>>>28),padBytes.putInt32(md.messageLength64[1]<<3);var s2={h0:_state.h0,h1:_state.h1,h2:_state.h2,h3:_state.h3,h4:_state.h4};_update(s2,_w,padBytes);var rval=forge.util.createBuffer();return rval.putInt32(s2.h0),rval.putInt32(s2.h1),rval.putInt32(s2.h2),rval.putInt32(s2.h3),rval.putInt32(s2.h4),rval},md};var _padding=null,_initialized=!1}var name="sha1";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/sha1",["require","module","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){function _init(){_padding=String.fromCharCode(128),_padding+=forge.util.fillString(String.fromCharCode(0),64),_k=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],_initialized=!0}function _update(s,w,bytes){for(var t1,t2,s0,s1,ch,maj,i,a,b,c,d,e,f,g,h,len=bytes.length();len>=64;){for(i=0;i<16;++i)w[i]=bytes.getInt32();for(;i<64;++i)t1=w[i-2],t1=(t1>>>17|t1<<15)^(t1>>>19|t1<<13)^t1>>>10,t2=w[i-15],t2=(t2>>>7|t2<<25)^(t2>>>18|t2<<14)^t2>>>3,w[i]=t1+w[i-7]+t2+w[i-16]|0;for(a=s.h0,b=s.h1,c=s.h2,d=s.h3,e=s.h4,f=s.h5,g=s.h6,h=s.h7,i=0;i<64;++i)s1=(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7),ch=g^e&(f^g),s0=(a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10),maj=a&b|c&(a^b),t1=h+s1+ch+_k[i]+w[i],t2=s0+maj,h=g,g=f,f=e,e=d+t1|0,d=c,c=b,b=a,a=t1+t2|0;s.h0=s.h0+a|0,s.h1=s.h1+b|0,s.h2=s.h2+c|0,s.h3=s.h3+d|0,s.h4=s.h4+e|0,s.h5=s.h5+f|0,s.h6=s.h6+g|0,s.h7=s.h7+h|0,len-=64}}var sha256=forge.sha256=forge.sha256||{};forge.md=forge.md||{},forge.md.algorithms=forge.md.algorithms||{},forge.md.sha256=forge.md.algorithms.sha256=sha256,sha256.create=function(){_initialized||_init();var _state=null,_input=forge.util.createBuffer(),_w=new Array(64),md={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,messageLength64:[0,0]};return md.start=function(){return md.messageLength=0,md.messageLength64=[0,0],_input=forge.util.createBuffer(),_state={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},md},md.start(),md.update=function(msg,encoding){return"utf8"===encoding&&(msg=forge.util.encodeUtf8(msg)),md.messageLength+=msg.length,md.messageLength64[0]+=msg.length/4294967296>>>0,md.messageLength64[1]+=msg.length>>>0,_input.putBytes(msg),_update(_state,_w,_input),(_input.read>2048||0===_input.length())&&_input.compact(),md},md.digest=function(){var padBytes=forge.util.createBuffer();padBytes.putBytes(_input.bytes()),padBytes.putBytes(_padding.substr(0,64-(md.messageLength64[1]+8&63))),padBytes.putInt32(md.messageLength64[0]<<3|md.messageLength64[0]>>>28),padBytes.putInt32(md.messageLength64[1]<<3);var s2={h0:_state.h0,h1:_state.h1,h2:_state.h2,h3:_state.h3,h4:_state.h4,h5:_state.h5,h6:_state.h6,h7:_state.h7};_update(s2,_w,padBytes);var rval=forge.util.createBuffer();return rval.putInt32(s2.h0),rval.putInt32(s2.h1),rval.putInt32(s2.h2),rval.putInt32(s2.h3),rval.putInt32(s2.h4),rval.putInt32(s2.h5),rval.putInt32(s2.h6),rval.putInt32(s2.h7),rval},md};var _padding=null,_initialized=!1,_k=null}var name="sha256";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/sha256",["require","module","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){function _init(){_padding=String.fromCharCode(128),_padding+=forge.util.fillString(String.fromCharCode(0),128),_k=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],_states={},_states["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],_states["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],_states["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],_states["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],_initialized=!0}function _update(s,w,bytes){for(var t1_hi,t1_lo,t2_hi,t2_lo,s0_hi,s0_lo,s1_hi,s1_lo,ch_hi,ch_lo,maj_hi,maj_lo,a_hi,a_lo,b_hi,b_lo,c_hi,c_lo,d_hi,d_lo,e_hi,e_lo,f_hi,f_lo,g_hi,g_lo,h_hi,h_lo,i,hi,lo,w2,w7,w15,w16,len=bytes.length();len>=128;){for(i=0;i<16;++i)w[i][0]=bytes.getInt32()>>>0,w[i][1]=bytes.getInt32()>>>0;for(;i<80;++i)w2=w[i-2],hi=w2[0],lo=w2[1],t1_hi=((hi>>>19|lo<<13)^(lo>>>29|hi<<3)^hi>>>6)>>>0,t1_lo=((hi<<13|lo>>>19)^(lo<<3|hi>>>29)^(hi<<26|lo>>>6))>>>0,w15=w[i-15],hi=w15[0],lo=w15[1],t2_hi=((hi>>>1|lo<<31)^(hi>>>8|lo<<24)^hi>>>7)>>>0,t2_lo=((hi<<31|lo>>>1)^(hi<<24|lo>>>8)^(hi<<25|lo>>>7))>>>0,w7=w[i-7],w16=w[i-16],lo=t1_lo+w7[1]+t2_lo+w16[1],w[i][0]=t1_hi+w7[0]+t2_hi+w16[0]+(lo/4294967296>>>0)>>>0,w[i][1]=lo>>>0;for(a_hi=s[0][0],a_lo=s[0][1],b_hi=s[1][0],b_lo=s[1][1],c_hi=s[2][0],c_lo=s[2][1],d_hi=s[3][0],d_lo=s[3][1],e_hi=s[4][0],e_lo=s[4][1],f_hi=s[5][0],f_lo=s[5][1],g_hi=s[6][0],g_lo=s[6][1],h_hi=s[7][0],h_lo=s[7][1],i=0;i<80;++i)s1_hi=((e_hi>>>14|e_lo<<18)^(e_hi>>>18|e_lo<<14)^(e_lo>>>9|e_hi<<23))>>>0,s1_lo=((e_hi<<18|e_lo>>>14)^(e_hi<<14|e_lo>>>18)^(e_lo<<23|e_hi>>>9))>>>0,ch_hi=(g_hi^e_hi&(f_hi^g_hi))>>>0,ch_lo=(g_lo^e_lo&(f_lo^g_lo))>>>0,s0_hi=((a_hi>>>28|a_lo<<4)^(a_lo>>>2|a_hi<<30)^(a_lo>>>7|a_hi<<25))>>>0,s0_lo=((a_hi<<4|a_lo>>>28)^(a_lo<<30|a_hi>>>2)^(a_lo<<25|a_hi>>>7))>>>0,maj_hi=(a_hi&b_hi|c_hi&(a_hi^b_hi))>>>0,maj_lo=(a_lo&b_lo|c_lo&(a_lo^b_lo))>>>0,lo=h_lo+s1_lo+ch_lo+_k[i][1]+w[i][1],t1_hi=h_hi+s1_hi+ch_hi+_k[i][0]+w[i][0]+(lo/4294967296>>>0)>>>0,t1_lo=lo>>>0,lo=s0_lo+maj_lo,t2_hi=s0_hi+maj_hi+(lo/4294967296>>>0)>>>0,t2_lo=lo>>>0,h_hi=g_hi,h_lo=g_lo,g_hi=f_hi,g_lo=f_lo,f_hi=e_hi,f_lo=e_lo,lo=d_lo+t1_lo,e_hi=d_hi+t1_hi+(lo/4294967296>>>0)>>>0,e_lo=lo>>>0,d_hi=c_hi,d_lo=c_lo,c_hi=b_hi,c_lo=b_lo,b_hi=a_hi,b_lo=a_lo,lo=t1_lo+t2_lo,a_hi=t1_hi+t2_hi+(lo/4294967296>>>0)>>>0,a_lo=lo>>>0;lo=s[0][1]+a_lo,s[0][0]=s[0][0]+a_hi+(lo/4294967296>>>0)>>>0,s[0][1]=lo>>>0,lo=s[1][1]+b_lo,s[1][0]=s[1][0]+b_hi+(lo/4294967296>>>0)>>>0,s[1][1]=lo>>>0,lo=s[2][1]+c_lo,s[2][0]=s[2][0]+c_hi+(lo/4294967296>>>0)>>>0,s[2][1]=lo>>>0,lo=s[3][1]+d_lo,s[3][0]=s[3][0]+d_hi+(lo/4294967296>>>0)>>>0,s[3][1]=lo>>>0,lo=s[4][1]+e_lo,s[4][0]=s[4][0]+e_hi+(lo/4294967296>>>0)>>>0,s[4][1]=lo>>>0,lo=s[5][1]+f_lo,s[5][0]=s[5][0]+f_hi+(lo/4294967296>>>0)>>>0,s[5][1]=lo>>>0,lo=s[6][1]+g_lo,s[6][0]=s[6][0]+g_hi+(lo/4294967296>>>0)>>>0,s[6][1]=lo>>>0,lo=s[7][1]+h_lo,s[7][0]=s[7][0]+h_hi+(lo/4294967296>>>0)>>>0,s[7][1]=lo>>>0,len-=128}}var sha512=forge.sha512=forge.sha512||{};forge.md=forge.md||{},forge.md.algorithms=forge.md.algorithms||{},forge.md.sha512=forge.md.algorithms.sha512=sha512;var sha384=forge.sha384=forge.sha512.sha384=forge.sha512.sha384||{};sha384.create=function(){return sha512.create("SHA-384")},forge.md.sha384=forge.md.algorithms.sha384=sha384,forge.sha512.sha256=forge.sha512.sha256||{create:function(){return sha512.create("SHA-512/256")}},forge.md["sha512/256"]=forge.md.algorithms["sha512/256"]=forge.sha512.sha256,forge.sha512.sha224=forge.sha512.sha224||{create:function(){return sha512.create("SHA-512/224")}},forge.md["sha512/224"]=forge.md.algorithms["sha512/224"]=forge.sha512.sha224,sha512.create=function(algorithm){if(_initialized||_init(),"undefined"==typeof algorithm&&(algorithm="SHA-512"),!(algorithm in _states))throw new Error("Invalid SHA-512 algorithm: "+algorithm);for(var _state=_states[algorithm],_h=null,_input=forge.util.createBuffer(),_w=new Array(80),wi=0;wi<80;++wi)_w[wi]=new Array(2);var md={algorithm:algorithm.replace("-","").toLowerCase(),blockLength:128,digestLength:64,messageLength:0,messageLength128:[0,0,0,0]};return md.start=function(){md.messageLength=0,md.messageLength128=[0,0,0,0],_input=forge.util.createBuffer(),_h=new Array(_state.length);for(var i=0;i<_state.length;++i)_h[i]=_state[i].slice(0);return md},md.start(),md.update=function(msg,encoding){"utf8"===encoding&&(msg=forge.util.encodeUtf8(msg)),md.messageLength+=msg.length;var len=msg.length;len=[len/4294967296>>>0,len>>>0];for(var i=3;i>=0;--i)md.messageLength128[i]+=len[1],len[1]=len[0]+(md.messageLength128[i]/4294967296>>>0),md.messageLength128[i]=md.messageLength128[i]>>>0,len[0]=len[1]/4294967296>>>0;return _input.putBytes(msg),_update(_h,_w,_input),(_input.read>2048||0===_input.length())&&_input.compact(),md},md.digest=function(){var padBytes=forge.util.createBuffer();padBytes.putBytes(_input.bytes()),padBytes.putBytes(_padding.substr(0,128-(md.messageLength128[3]+16&127)));for(var bitLength=[],i=0;i<3;++i)bitLength[i]=md.messageLength128[i]<<3|md.messageLength128[i-1]>>>28;bitLength[3]=md.messageLength128[3]<<3,padBytes.putInt32(bitLength[0]),padBytes.putInt32(bitLength[1]),padBytes.putInt32(bitLength[2]),padBytes.putInt32(bitLength[3]);for(var h=new Array(_h.length),i=0;i<_h.length;++i)h[i]=_h[i].slice(0);_update(h,_w,padBytes);var hlen,rval=forge.util.createBuffer();hlen="SHA-512"===algorithm?h.length:"SHA-384"===algorithm?h.length-2:h.length-4;for(var i=0;i<hlen;++i)rval.putInt32(h[i][0]),i===hlen-1&&"SHA-512/224"===algorithm||rval.putInt32(h[i][1]);return rval},md};var _padding=null,_initialized=!1,_k=null,_states=null}var name="sha512";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/sha512",["require","module","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){forge.md=forge.md||{},forge.md.algorithms={md5:forge.md5,sha1:forge.sha1,sha256:forge.sha256},forge.md.md5=forge.md5,forge.md.sha1=forge.sha1,forge.md.sha256=forge.sha256}var name="md";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/md",["require","module","./md5","./sha1","./sha256","./sha512"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){var hmac=forge.hmac=forge.hmac||{};hmac.create=function(){var _key=null,_md=null,_ipadding=null,_opadding=null,ctx={};return ctx.start=function(md,key){if(null!==md)if("string"==typeof md){if(md=md.toLowerCase(),!(md in forge.md.algorithms))throw new Error('Unknown hash algorithm "'+md+'"');_md=forge.md.algorithms[md].create()}else _md=md;if(null===key)key=_key;else{if("string"==typeof key)key=forge.util.createBuffer(key);else if(forge.util.isArray(key)){var tmp=key;key=forge.util.createBuffer();for(var i=0;i<tmp.length;++i)key.putByte(tmp[i])}var keylen=key.length();keylen>_md.blockLength&&(_md.start(),_md.update(key.bytes()),key=_md.digest()),_ipadding=forge.util.createBuffer(),_opadding=forge.util.createBuffer(),keylen=key.length();for(var i=0;i<keylen;++i){var tmp=key.at(i);_ipadding.putByte(54^tmp),_opadding.putByte(92^tmp)}if(keylen<_md.blockLength)for(var tmp=_md.blockLength-keylen,i=0;i<tmp;++i)_ipadding.putByte(54),_opadding.putByte(92);_key=key,_ipadding=_ipadding.bytes(),_opadding=_opadding.bytes()}_md.start(),_md.update(_ipadding)},ctx.update=function(bytes){_md.update(bytes)},ctx.getMac=function(){var inner=_md.digest().bytes();return _md.start(),_md.update(_opadding),_md.update(inner),_md.digest()},ctx.digest=ctx.getMac,ctx}}var name="hmac";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/hmac",["require","module","./md","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){function foldHeader(header){for(var rval=header.name+": ",values=[],insertSpace=function(match,$1){return" "+$1},i=0;i<header.values.length;++i)values.push(header.values[i].replace(/^(\S+\r\n)/,insertSpace));rval+=values.join(",")+"\r\n";for(var length=0,candidate=-1,i=0;i<rval.length;++i,++length)if(length>65&&candidate!==-1){var insert=rval[candidate];","===insert?(++candidate,rval=rval.substr(0,candidate)+"\r\n "+rval.substr(candidate)):rval=rval.substr(0,candidate)+"\r\n"+insert+rval.substr(candidate+1),length=i-candidate-1,candidate=-1,++i}else" "!==rval[i]&&"\t"!==rval[i]&&","!==rval[i]||(candidate=i);return rval}function ltrim(str){return str.replace(/^\s+/,"")}var pem=forge.pem=forge.pem||{};pem.encode=function(msg,options){options=options||{};var header,rval="-----BEGIN "+msg.type+"-----\r\n";if(msg.procType&&(header={name:"Proc-Type",values:[String(msg.procType.version),msg.procType.type]},rval+=foldHeader(header)),msg.contentDomain&&(header={name:"Content-Domain",values:[msg.contentDomain]},rval+=foldHeader(header)),msg.dekInfo&&(header={name:"DEK-Info",values:[msg.dekInfo.algorithm]},msg.dekInfo.parameters&&header.values.push(msg.dekInfo.parameters),rval+=foldHeader(header)),msg.headers)for(var i=0;i<msg.headers.length;++i)rval+=foldHeader(msg.headers[i]);return msg.procType&&(rval+="\r\n"),rval+=forge.util.encode64(msg.body,options.maxline||64)+"\r\n",rval+="-----END "+msg.type+"-----\r\n"},pem.decode=function(str){for(var match,rval=[],rMessage=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,rHeader=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,rCRLF=/\r?\n/;;){if(match=rMessage.exec(str),!match)break;var msg={type:match[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:forge.util.decode64(match[3])};if(rval.push(msg),match[2]){for(var lines=match[2].split(rCRLF),li=0;match&&li<lines.length;){for(var line=lines[li].replace(/\s+$/,""),nl=li+1;nl<lines.length;++nl){var next=lines[nl];if(!/\s/.test(next[0]))break;line+=next,li=nl}if(match=line.match(rHeader)){for(var header={name:match[1],values:[]},values=match[2].split(","),vi=0;vi<values.length;++vi)header.values.push(ltrim(values[vi]));if(msg.procType)if(msg.contentDomain||"Content-Domain"!==header.name)if(msg.dekInfo||"DEK-Info"!==header.name)msg.headers.push(header);else{if(0===header.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');msg.dekInfo={algorithm:values[0],parameters:values[1]||null}}else msg.contentDomain=values[0]||"";else{if("Proc-Type"!==header.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==header.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');msg.procType={version:values[0],type:values[1]}}}++li}if("ENCRYPTED"===msg.procType&&!msg.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===rval.length)throw new Error("Invalid PEM formatted message.");return rval}}var name="pem";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pem",["require","module","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){function registerAlgorithm(name,mode){var factory=function(){return new forge.des.Algorithm(name,mode)};forge.cipher.registerAlgorithm(name,factory)}function _createKeys(key){for(var tmp,pc2bytes0=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],pc2bytes1=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],pc2bytes2=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],pc2bytes3=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],pc2bytes4=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],pc2bytes5=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],pc2bytes6=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],pc2bytes7=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],pc2bytes8=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],pc2bytes9=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],pc2bytes10=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],pc2bytes11=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],pc2bytes12=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],pc2bytes13=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],iterations=key.length()>8?3:1,keys=[],shifts=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],n=0,j=0;j<iterations;j++){var left=key.getInt32(),right=key.getInt32();tmp=252645135&(left>>>4^right),right^=tmp,left^=tmp<<4,tmp=65535&(right>>>-16^left),left^=tmp,right^=tmp<<-16,tmp=858993459&(left>>>2^right),right^=tmp,left^=tmp<<2,tmp=65535&(right>>>-16^left),left^=tmp,right^=tmp<<-16,tmp=1431655765&(left>>>1^right),right^=tmp,left^=tmp<<1,tmp=16711935&(right>>>8^left),left^=tmp,right^=tmp<<8,tmp=1431655765&(left>>>1^right),right^=tmp,left^=tmp<<1,tmp=left<<8|right>>>20&240,left=right<<24|right<<8&16711680|right>>>8&65280|right>>>24&240,right=tmp;for(var i=0;i<shifts.length;++i){shifts[i]?(left=left<<2|left>>>26,right=right<<2|right>>>26):(left=left<<1|left>>>27,right=right<<1|right>>>27),left&=-15,right&=-15;var lefttmp=pc2bytes0[left>>>28]|pc2bytes1[left>>>24&15]|pc2bytes2[left>>>20&15]|pc2bytes3[left>>>16&15]|pc2bytes4[left>>>12&15]|pc2bytes5[left>>>8&15]|pc2bytes6[left>>>4&15],righttmp=pc2bytes7[right>>>28]|pc2bytes8[right>>>24&15]|pc2bytes9[right>>>20&15]|pc2bytes10[right>>>16&15]|pc2bytes11[right>>>12&15]|pc2bytes12[right>>>8&15]|pc2bytes13[right>>>4&15];tmp=65535&(righttmp>>>16^lefttmp),keys[n++]=lefttmp^tmp,keys[n++]=righttmp^tmp<<16}}return keys}function _updateBlock(keys,input,output,decrypt){var looping,iterations=32===keys.length?3:9;looping=3===iterations?decrypt?[30,-2,-2]:[0,32,2]:decrypt?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var tmp,left=input[0],right=input[1];tmp=252645135&(left>>>4^right),right^=tmp,left^=tmp<<4,tmp=65535&(left>>>16^right),right^=tmp,left^=tmp<<16,tmp=858993459&(right>>>2^left),left^=tmp,right^=tmp<<2,tmp=16711935&(right>>>8^left),left^=tmp,right^=tmp<<8,tmp=1431655765&(left>>>1^right),right^=tmp,left^=tmp<<1,left=left<<1|left>>>31,right=right<<1|right>>>31;for(var j=0;j<iterations;j+=3){for(var endloop=looping[j+1],loopinc=looping[j+2],i=looping[j];i!=endloop;i+=loopinc){var right1=right^keys[i],right2=(right>>>4|right<<28)^keys[i+1];tmp=left,left=right,right=tmp^(spfunction2[right1>>>24&63]|spfunction4[right1>>>16&63]|spfunction6[right1>>>8&63]|spfunction8[63&right1]|spfunction1[right2>>>24&63]|spfunction3[right2>>>16&63]|spfunction5[right2>>>8&63]|spfunction7[63&right2])}tmp=left,left=right,right=tmp}left=left>>>1|left<<31,right=right>>>1|right<<31,tmp=1431655765&(left>>>1^right),right^=tmp,left^=tmp<<1,tmp=16711935&(right>>>8^left),left^=tmp,right^=tmp<<8,tmp=858993459&(right>>>2^left),left^=tmp,right^=tmp<<2,tmp=65535&(left>>>16^right),right^=tmp,left^=tmp<<16,tmp=252645135&(left>>>4^right),right^=tmp,left^=tmp<<4,output[0]=left,output[1]=right}function _createCipher(options){options=options||{};var cipher,mode=(options.mode||"CBC").toUpperCase(),algorithm="DES-"+mode;cipher=options.decrypt?forge.cipher.createDecipher(algorithm,options.key):forge.cipher.createCipher(algorithm,options.key);var start=cipher.start;return cipher.start=function(iv,options){var output=null;options instanceof forge.util.ByteBuffer&&(output=options,options={}),options=options||{},options.output=output,options.iv=iv,start.call(cipher,options)},cipher}forge.des=forge.des||{},forge.des.startEncrypting=function(key,iv,output,mode){var cipher=_createCipher({key:key,output:output,decrypt:!1,mode:mode||(null===iv?"ECB":"CBC")});return cipher.start(iv),cipher},forge.des.createEncryptionCipher=function(key,mode){return _createCipher({key:key,output:null,decrypt:!1,mode:mode})},forge.des.startDecrypting=function(key,iv,output,mode){var cipher=_createCipher({key:key,output:output,decrypt:!0,mode:mode||(null===iv?"ECB":"CBC")});return cipher.start(iv),cipher},forge.des.createDecryptionCipher=function(key,mode){return _createCipher({key:key,output:null,decrypt:!0,mode:mode})},forge.des.Algorithm=function(name,mode){var self=this;self.name=name,self.mode=new mode({blockSize:8,cipher:{encrypt:function(inBlock,outBlock){return _updateBlock(self._keys,inBlock,outBlock,!1)},decrypt:function(inBlock,outBlock){return _updateBlock(self._keys,inBlock,outBlock,!0)}}}),self._init=!1},forge.des.Algorithm.prototype.initialize=function(options){if(!this._init){var key=forge.util.createBuffer(options.key);if(0===this.name.indexOf("3DES")&&24!==key.length())throw new Error("Invalid Triple-DES key size: "+8*key.length());this._keys=_createKeys(key),this._init=!0}},registerAlgorithm("DES-ECB",forge.cipher.modes.ecb),registerAlgorithm("DES-CBC",forge.cipher.modes.cbc),registerAlgorithm("DES-CFB",forge.cipher.modes.cfb),registerAlgorithm("DES-OFB",forge.cipher.modes.ofb),registerAlgorithm("DES-CTR",forge.cipher.modes.ctr),registerAlgorithm("3DES-ECB",forge.cipher.modes.ecb),registerAlgorithm("3DES-CBC",forge.cipher.modes.cbc),registerAlgorithm("3DES-CFB",forge.cipher.modes.cfb),registerAlgorithm("3DES-OFB",forge.cipher.modes.ofb),registerAlgorithm("3DES-CTR",forge.cipher.modes.ctr);var spfunction1=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],spfunction2=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],spfunction3=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],spfunction4=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],spfunction5=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],spfunction6=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],spfunction7=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],spfunction8=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];
}var name="des";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/des",["require","module","./cipher","./cipherModes","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){var crypto,pkcs5=forge.pkcs5=forge.pkcs5||{},_nodejs="undefined"!=typeof process&&process.versions&&process.versions.node;_nodejs&&!forge.disableNativeCode&&(crypto=require("crypto")),forge.pbkdf2=pkcs5.pbkdf2=function(p,s,c,dkLen,md,callback){function outer(){return i>len?callback(null,dk):(prf.start(null,null),prf.update(s),prf.update(forge.util.int32ToBytes(i)),xor=u_c1=prf.digest().getBytes(),j=2,void inner())}function inner(){return j<=c?(prf.start(null,null),prf.update(u_c1),u_c=prf.digest().getBytes(),xor=forge.util.xorBytes(xor,u_c,hLen),u_c1=u_c,++j,forge.util.setImmediate(inner)):(dk+=i<len?xor:xor.substr(0,r),++i,void outer())}if("function"==typeof md&&(callback=md,md=null),_nodejs&&!forge.disableNativeCode&&crypto.pbkdf2&&(null===md||"object"!=typeof md)&&(crypto.pbkdf2Sync.length>4||!md||"sha1"===md))return"string"!=typeof md&&(md="sha1"),s=new Buffer(s,"binary"),callback?4===crypto.pbkdf2Sync.length?crypto.pbkdf2(p,s,c,dkLen,function(err,key){return err?callback(err):void callback(null,key.toString("binary"))}):crypto.pbkdf2(p,s,c,dkLen,md,function(err,key){return err?callback(err):void callback(null,key.toString("binary"))}):4===crypto.pbkdf2Sync.length?crypto.pbkdf2Sync(p,s,c,dkLen).toString("binary"):crypto.pbkdf2Sync(p,s,c,dkLen,md).toString("binary");if("undefined"!=typeof md&&null!==md||(md=forge.md.sha1.create()),"string"==typeof md){if(!(md in forge.md.algorithms))throw new Error("Unknown hash algorithm: "+md);md=forge.md[md].create()}var hLen=md.digestLength;if(dkLen>4294967295*hLen){var err=new Error("Derived key is too long.");if(callback)return callback(err);throw err}var len=Math.ceil(dkLen/hLen),r=dkLen-(len-1)*hLen,prf=forge.hmac.create();prf.start(md,p);var xor,u_c,u_c1,dk="";if(!callback){for(var i=1;i<=len;++i){prf.start(null,null),prf.update(s),prf.update(forge.util.int32ToBytes(i)),xor=u_c1=prf.digest().getBytes();for(var j=2;j<=c;++j)prf.start(null,null),prf.update(u_c1),u_c=prf.digest().getBytes(),xor=forge.util.xorBytes(xor,u_c,hLen),u_c1=u_c;dk+=i<len?xor:xor.substr(0,r)}return dk}var j,i=1;outer()}}var name="pbkdf2";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pbkdf2",["require","module","./hmac","./md","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){var _nodejs="undefined"!=typeof process&&process.versions&&process.versions.node,_crypto=null;forge.disableNativeCode||!_nodejs||process.versions["node-webkit"]||(_crypto=require("crypto"));var prng=forge.prng=forge.prng||{};prng.create=function(plugin){function _reseed(callback){if(ctx.pools[0].messageLength>=32)return _seed(),callback();var needed=32-ctx.pools[0].messageLength<<5;ctx.seedFile(needed,function(err,bytes){return err?callback(err):(ctx.collect(bytes),_seed(),void callback())})}function _reseedSync(){if(ctx.pools[0].messageLength>=32)return _seed();var needed=32-ctx.pools[0].messageLength<<5;ctx.collect(ctx.seedFileSync(needed)),_seed()}function _seed(){var md=ctx.plugin.md.create();md.update(ctx.pools[0].digest().getBytes()),ctx.pools[0].start();for(var k=1,i=1;i<32;++i)k=31===k?2147483648:k<<2,k%ctx.reseeds===0&&(md.update(ctx.pools[i].digest().getBytes()),ctx.pools[i].start());var keyBytes=md.digest().getBytes();md.start(),md.update(keyBytes);var seedBytes=md.digest().getBytes();ctx.key=ctx.plugin.formatKey(keyBytes),ctx.seed=ctx.plugin.formatSeed(seedBytes),ctx.reseeds=4294967295===ctx.reseeds?0:ctx.reseeds+1,ctx.generated=0}function defaultSeedFile(needed){var getRandomValues=null;if("undefined"!=typeof window){var _crypto=window.crypto||window.msCrypto;_crypto&&_crypto.getRandomValues&&(getRandomValues=function(arr){return _crypto.getRandomValues(arr)})}var b=forge.util.createBuffer();if(getRandomValues)for(;b.length()<needed;){var count=Math.max(1,Math.min(needed-b.length(),65536)/4),entropy=new Uint32Array(Math.floor(count));try{getRandomValues(entropy);for(var i=0;i<entropy.length;++i)b.putInt32(entropy[i])}catch(e){if(!("undefined"!=typeof QuotaExceededError&&e instanceof QuotaExceededError))throw e}}if(b.length()<needed)for(var hi,lo,next,seed=Math.floor(65536*Math.random());b.length()<needed;){lo=16807*(65535&seed),hi=16807*(seed>>16),lo+=(32767&hi)<<16,lo+=hi>>15,lo=(2147483647&lo)+(lo>>31),seed=4294967295&lo;for(var i=0;i<3;++i)next=seed>>>(i<<3),next^=Math.floor(256*Math.random()),b.putByte(String.fromCharCode(255&next))}return b.getBytes(needed)}for(var ctx={plugin:plugin,key:null,seed:null,time:null,reseeds:0,generated:0},md=plugin.md,pools=new Array(32),i=0;i<32;++i)pools[i]=md.create();return ctx.pools=pools,ctx.pool=0,ctx.generate=function(count,callback){function generate(err){if(err)return callback(err);if(b.length()>=count)return callback(null,b.getBytes(count));if(ctx.generated>1048575&&(ctx.key=null),null===ctx.key)return forge.util.nextTick(function(){_reseed(generate)});var bytes=cipher(ctx.key,ctx.seed);ctx.generated+=bytes.length,b.putBytes(bytes),ctx.key=formatKey(cipher(ctx.key,increment(ctx.seed))),ctx.seed=formatSeed(cipher(ctx.key,ctx.seed)),forge.util.setImmediate(generate)}if(!callback)return ctx.generateSync(count);var cipher=ctx.plugin.cipher,increment=ctx.plugin.increment,formatKey=ctx.plugin.formatKey,formatSeed=ctx.plugin.formatSeed,b=forge.util.createBuffer();ctx.key=null,generate()},ctx.generateSync=function(count){var cipher=ctx.plugin.cipher,increment=ctx.plugin.increment,formatKey=ctx.plugin.formatKey,formatSeed=ctx.plugin.formatSeed;ctx.key=null;for(var b=forge.util.createBuffer();b.length()<count;){ctx.generated>1048575&&(ctx.key=null),null===ctx.key&&_reseedSync();var bytes=cipher(ctx.key,ctx.seed);ctx.generated+=bytes.length,b.putBytes(bytes),ctx.key=formatKey(cipher(ctx.key,increment(ctx.seed))),ctx.seed=formatSeed(cipher(ctx.key,ctx.seed))}return b.getBytes(count)},_crypto?(ctx.seedFile=function(needed,callback){_crypto.randomBytes(needed,function(err,bytes){return err?callback(err):void callback(null,bytes.toString())})},ctx.seedFileSync=function(needed){return _crypto.randomBytes(needed).toString()}):(ctx.seedFile=function(needed,callback){try{callback(null,defaultSeedFile(needed))}catch(e){callback(e)}},ctx.seedFileSync=defaultSeedFile),ctx.collect=function(bytes){for(var count=bytes.length,i=0;i<count;++i)ctx.pools[ctx.pool].update(bytes.substr(i,1)),ctx.pool=31===ctx.pool?0:ctx.pool+1},ctx.collectInt=function(i,n){for(var bytes="",x=0;x<n;x+=8)bytes+=String.fromCharCode(i>>x&255);ctx.collect(bytes)},ctx.registerWorker=function(worker){if(worker===self)ctx.seedFile=function(needed,callback){function listener(e){var data=e.data;data.forge&&data.forge.prng&&(self.removeEventListener("message",listener),callback(data.forge.prng.err,data.forge.prng.bytes))}self.addEventListener("message",listener),self.postMessage({forge:{prng:{needed:needed}}})};else{var listener=function(e){var data=e.data;data.forge&&data.forge.prng&&ctx.seedFile(data.forge.prng.needed,function(err,bytes){worker.postMessage({forge:{prng:{err:err,bytes:bytes}}})})};worker.addEventListener("message",listener)}},ctx}}var name="prng";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/prng",["require","module","./md","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){forge.random&&forge.random.getBytes||!function(jQuery){function spawnPrng(){var ctx=forge.prng.create(prng_aes);return ctx.getBytes=function(count,callback){return ctx.generate(count,callback)},ctx.getBytesSync=function(count){return ctx.generate(count)},ctx}var prng_aes={},_prng_aes_output=new Array(4),_prng_aes_buffer=forge.util.createBuffer();prng_aes.formatKey=function(key){var tmp=forge.util.createBuffer(key);return key=new Array(4),key[0]=tmp.getInt32(),key[1]=tmp.getInt32(),key[2]=tmp.getInt32(),key[3]=tmp.getInt32(),forge.aes._expandKey(key,!1)},prng_aes.formatSeed=function(seed){var tmp=forge.util.createBuffer(seed);return seed=new Array(4),seed[0]=tmp.getInt32(),seed[1]=tmp.getInt32(),seed[2]=tmp.getInt32(),seed[3]=tmp.getInt32(),seed},prng_aes.cipher=function(key,seed){return forge.aes._updateBlock(key,seed,_prng_aes_output,!1),_prng_aes_buffer.putInt32(_prng_aes_output[0]),_prng_aes_buffer.putInt32(_prng_aes_output[1]),_prng_aes_buffer.putInt32(_prng_aes_output[2]),_prng_aes_buffer.putInt32(_prng_aes_output[3]),_prng_aes_buffer.getBytes()},prng_aes.increment=function(seed){return++seed[3],seed},prng_aes.md=forge.md.sha256;var _ctx=spawnPrng(),_nodejs="undefined"!=typeof process&&process.versions&&process.versions.node,getRandomValues=null;if("undefined"!=typeof window){var _crypto=window.crypto||window.msCrypto;_crypto&&_crypto.getRandomValues&&(getRandomValues=function(arr){return _crypto.getRandomValues(arr)})}if(forge.disableNativeCode||!_nodejs&&!getRandomValues){if("undefined"==typeof window||void 0===window.document,_ctx.collectInt(+new Date,32),"undefined"!=typeof navigator){var _navBytes="";for(var key in navigator)try{"string"==typeof navigator[key]&&(_navBytes+=navigator[key])}catch(e){}_ctx.collect(_navBytes),_navBytes=null}jQuery&&(jQuery().mousemove(function(e){_ctx.collectInt(e.clientX,16),_ctx.collectInt(e.clientY,16)}),jQuery().keypress(function(e){_ctx.collectInt(e.charCode,8)}))}if(forge.random)for(var key in _ctx)forge.random[key]=_ctx[key];else forge.random=_ctx;forge.random.createInstance=spawnPrng}("undefined"!=typeof jQuery?jQuery:null)}var name="random";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/random",["require","module","./aes","./md","./prng","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){var piTable=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],s=[1,2,3,5],rol=function(word,bits){return word<<bits&65535|(65535&word)>>16-bits},ror=function(word,bits){return(65535&word)>>bits|word<<16-bits&65535};forge.rc2=forge.rc2||{},forge.rc2.expandKey=function(key,effKeyBits){"string"==typeof key&&(key=forge.util.createBuffer(key)),effKeyBits=effKeyBits||128;var i,L=key,T=key.length(),T1=effKeyBits,T8=Math.ceil(T1/8),TM=255>>(7&T1);for(i=T;i<128;i++)L.putByte(piTable[L.at(i-1)+L.at(i-T)&255]);for(L.setAt(128-T8,piTable[L.at(128-T8)&TM]),i=127-T8;i>=0;i--)L.setAt(i,piTable[L.at(i+1)^L.at(i+T8)]);return L};var createCipher=function(key,bits,encrypt){var mixRound,mashRound,i,j,_finish=!1,_input=null,_output=null,_iv=null,K=[];for(key=forge.rc2.expandKey(key,bits),i=0;i<64;i++)K.push(key.getInt16Le());encrypt?(mixRound=function(R){for(i=0;i<4;i++)R[i]+=K[j]+(R[(i+3)%4]&R[(i+2)%4])+(~R[(i+3)%4]&R[(i+1)%4]),R[i]=rol(R[i],s[i]),j++},mashRound=function(R){for(i=0;i<4;i++)R[i]+=K[63&R[(i+3)%4]]}):(mixRound=function(R){for(i=3;i>=0;i--)R[i]=ror(R[i],s[i]),R[i]-=K[j]+(R[(i+3)%4]&R[(i+2)%4])+(~R[(i+3)%4]&R[(i+1)%4]),j--},mashRound=function(R){for(i=3;i>=0;i--)R[i]-=K[63&R[(i+3)%4]]});var runPlan=function(plan){var R=[];for(i=0;i<4;i++){var val=_input.getInt16Le();null!==_iv&&(encrypt?val^=_iv.getInt16Le():_iv.putInt16Le(val)),R.push(65535&val)}j=encrypt?0:63;for(var ptr=0;ptr<plan.length;ptr++)for(var ctr=0;ctr<plan[ptr][0];ctr++)plan[ptr][1](R);for(i=0;i<4;i++)null!==_iv&&(encrypt?_iv.putInt16Le(R[i]):R[i]^=_iv.getInt16Le()),_output.putInt16Le(R[i])},cipher=null;return cipher={start:function(iv,output){iv&&"string"==typeof iv&&(iv=forge.util.createBuffer(iv)),_finish=!1,_input=forge.util.createBuffer(),_output=output||new forge.util.createBuffer,_iv=iv,cipher.output=_output},update:function(input){for(_finish||_input.putBuffer(input);_input.length()>=8;)runPlan([[5,mixRound],[1,mashRound],[6,mixRound],[1,mashRound],[5,mixRound]])},finish:function(pad){var rval=!0;if(encrypt)if(pad)rval=pad(8,_input,!encrypt);else{var padding=8===_input.length()?8:8-_input.length();_input.fillWithByte(padding,padding)}if(rval&&(_finish=!0,cipher.update()),!encrypt&&(rval=0===_input.length()))if(pad)rval=pad(8,_output,!encrypt);else{var len=_output.length(),count=_output.at(len-1);count>len?rval=!1:_output.truncate(count)}return rval}}};forge.rc2.startEncrypting=function(key,iv,output){var cipher=forge.rc2.createEncryptionCipher(key,128);return cipher.start(iv,output),cipher},forge.rc2.createEncryptionCipher=function(key,bits){return createCipher(key,bits,!0)},forge.rc2.startDecrypting=function(key,iv,output){var cipher=forge.rc2.createDecryptionCipher(key,128);return cipher.start(iv,output),cipher},forge.rc2.createDecryptionCipher=function(key,bits){return createCipher(key,bits,!1)}}var name="rc2";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/rc2",["require","module","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){function BigInteger(a,b,c){this.data=[],null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function nbi(){return new BigInteger(null)}function am1(i,x,w,j,c,n){for(;--n>=0;){var v=x*this.data[i++]+w.data[j]+c;c=Math.floor(v/67108864),w.data[j++]=67108863&v}return c}function am2(i,x,w,j,c,n){for(var xl=32767&x,xh=x>>15;--n>=0;){var l=32767&this.data[i],h=this.data[i++]>>15,m=xh*l+h*xl;l=xl*l+((32767&m)<<15)+w.data[j]+(1073741823&c),c=(l>>>30)+(m>>>15)+xh*h+(c>>>30),w.data[j++]=1073741823&l}return c}function am3(i,x,w,j,c,n){for(var xl=16383&x,xh=x>>14;--n>=0;){var l=16383&this.data[i],h=this.data[i++]>>14,m=xh*l+h*xl;l=xl*l+((16383&m)<<14)+w.data[j]+c,c=(l>>28)+(m>>14)+xh*h,w.data[j++]=268435455&l}return c}function int2char(n){return BI_RM.charAt(n)}function intAt(s,i){var c=BI_RC[s.charCodeAt(i)];return null==c?-1:c}function bnpCopyTo(r){for(var i=this.t-1;i>=0;--i)r.data[i]=this.data[i];r.t=this.t,r.s=this.s}function bnpFromInt(x){this.t=1,this.s=x<0?-1:0,x>0?this.data[0]=x:x<-1?this.data[0]=x+this.DV:this.t=0}function nbv(i){var r=nbi();return r.fromInt(i),r}function bnpFromString(s,b){var k;if(16==b)k=4;else if(8==b)k=3;else if(256==b)k=8;else if(2==b)k=1;else if(32==b)k=5;else{if(4!=b)return void this.fromRadix(s,b);k=2}this.t=0,this.s=0;for(var i=s.length,mi=!1,sh=0;--i>=0;){var x=8==k?255&s[i]:intAt(s,i);x<0?"-"==s.charAt(i)&&(mi=!0):(mi=!1,0==sh?this.data[this.t++]=x:sh+k>this.DB?(this.data[this.t-1]|=(x&(1<<this.DB-sh)-1)<<sh,this.data[this.t++]=x>>this.DB-sh):this.data[this.t-1]|=x<<sh,sh+=k,sh>=this.DB&&(sh-=this.DB))}8==k&&0!=(128&s[0])&&(this.s=-1,sh>0&&(this.data[this.t-1]|=(1<<this.DB-sh)-1<<sh)),this.clamp(),mi&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var c=this.s&this.DM;this.t>0&&this.data[this.t-1]==c;)--this.t}function bnToString(b){if(this.s<0)return"-"+this.negate().toString(b);var k;if(16==b)k=4;else if(8==b)k=3;else if(2==b)k=1;else if(32==b)k=5;else{if(4!=b)return this.toRadix(b);k=2}var d,km=(1<<k)-1,m=!1,r="",i=this.t,p=this.DB-i*this.DB%k;if(i-- >0)for(p<this.DB&&(d=this.data[i]>>p)>0&&(m=!0,r=int2char(d));i>=0;)p<k?(d=(this.data[i]&(1<<p)-1)<<k-p,d|=this.data[--i]>>(p+=this.DB-k)):(d=this.data[i]>>(p-=k)&km,p<=0&&(p+=this.DB,--i)),d>0&&(m=!0),m&&(r+=int2char(d));return m?r:"0"}function bnNegate(){var r=nbi();return BigInteger.ZERO.subTo(this,r),r}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(a){var r=this.s-a.s;if(0!=r)return r;var i=this.t;if(r=i-a.t,0!=r)return this.s<0?-r:r;for(;--i>=0;)if(0!=(r=this.data[i]-a.data[i]))return r;return 0}function nbits(x){var t,r=1;return 0!=(t=x>>>16)&&(x=t,r+=16),0!=(t=x>>8)&&(x=t,r+=8),0!=(t=x>>4)&&(x=t,r+=4),0!=(t=x>>2)&&(x=t,r+=2),0!=(t=x>>1)&&(x=t,r+=1),r}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this.data[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(n,r){var i;for(i=this.t-1;i>=0;--i)r.data[i+n]=this.data[i];for(i=n-1;i>=0;--i)r.data[i]=0;r.t=this.t+n,r.s=this.s}function bnpDRShiftTo(n,r){for(var i=n;i<this.t;++i)r.data[i-n]=this.data[i];r.t=Math.max(this.t-n,0),r.s=this.s}function bnpLShiftTo(n,r){var i,bs=n%this.DB,cbs=this.DB-bs,bm=(1<<cbs)-1,ds=Math.floor(n/this.DB),c=this.s<<bs&this.DM;for(i=this.t-1;i>=0;--i)r.data[i+ds+1]=this.data[i]>>cbs|c,c=(this.data[i]&bm)<<bs;for(i=ds-1;i>=0;--i)r.data[i]=0;r.data[ds]=c,r.t=this.t+ds+1,r.s=this.s,r.clamp()}function bnpRShiftTo(n,r){r.s=this.s;var ds=Math.floor(n/this.DB);if(ds>=this.t)return void(r.t=0);var bs=n%this.DB,cbs=this.DB-bs,bm=(1<<bs)-1;r.data[0]=this.data[ds]>>bs;for(var i=ds+1;i<this.t;++i)r.data[i-ds-1]|=(this.data[i]&bm)<<cbs,r.data[i-ds]=this.data[i]>>bs;bs>0&&(r.data[this.t-ds-1]|=(this.s&bm)<<cbs),r.t=this.t-ds,r.clamp()}function bnpSubTo(a,r){for(var i=0,c=0,m=Math.min(a.t,this.t);i<m;)c+=this.data[i]-a.data[i],r.data[i++]=c&this.DM,c>>=this.DB;if(a.t<this.t){for(c-=a.s;i<this.t;)c+=this.data[i],r.data[i++]=c&this.DM,c>>=this.DB;c+=this.s}else{for(c+=this.s;i<a.t;)c-=a.data[i],r.data[i++]=c&this.DM,c>>=this.DB;c-=a.s}r.s=c<0?-1:0,c<-1?r.data[i++]=this.DV+c:c>0&&(r.data[i++]=c),r.t=i,r.clamp()}function bnpMultiplyTo(a,r){var x=this.abs(),y=a.abs(),i=x.t;for(r.t=i+y.t;--i>=0;)r.data[i]=0;for(i=0;i<y.t;++i)r.data[i+x.t]=x.am(0,y.data[i],r,i,0,x.t);r.s=0,r.clamp(),this.s!=a.s&&BigInteger.ZERO.subTo(r,r)}function bnpSquareTo(r){for(var x=this.abs(),i=r.t=2*x.t;--i>=0;)r.data[i]=0;for(i=0;i<x.t-1;++i){var c=x.am(i,x.data[i],r,2*i,0,1);(r.data[i+x.t]+=x.am(i+1,2*x.data[i],r,2*i+1,c,x.t-i-1))>=x.DV&&(r.data[i+x.t]-=x.DV,r.data[i+x.t+1]=1)}r.t>0&&(r.data[r.t-1]+=x.am(i,x.data[i],r,2*i,0,1)),r.s=0,r.clamp()}function bnpDivRemTo(m,q,r){var pm=m.abs();if(!(pm.t<=0)){var pt=this.abs();if(pt.t<pm.t)return null!=q&&q.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=nbi());var y=nbi(),ts=this.s,ms=m.s,nsh=this.DB-nbits(pm.data[pm.t-1]);nsh>0?(pm.lShiftTo(nsh,y),pt.lShiftTo(nsh,r)):(pm.copyTo(y),pt.copyTo(r));var ys=y.t,y0=y.data[ys-1];if(0!=y0){var yt=y0*(1<<this.F1)+(ys>1?y.data[ys-2]>>this.F2:0),d1=this.FV/yt,d2=(1<<this.F1)/yt,e=1<<this.F2,i=r.t,j=i-ys,t=null==q?nbi():q;for(y.dlShiftTo(j,t),r.compareTo(t)>=0&&(r.data[r.t++]=1,r.subTo(t,r)),BigInteger.ONE.dlShiftTo(ys,t),t.subTo(y,y);y.t<ys;)y.data[y.t++]=0;for(;--j>=0;){var qd=r.data[--i]==y0?this.DM:Math.floor(r.data[i]*d1+(r.data[i-1]+e)*d2);if((r.data[i]+=y.am(0,qd,r,j,0,ys))<qd)for(y.dlShiftTo(j,t),r.subTo(t,r);r.data[i]<--qd;)r.subTo(t,r)}null!=q&&(r.drShiftTo(ys,q),ts!=ms&&BigInteger.ZERO.subTo(q,q)),r.t=ys,r.clamp(),nsh>0&&r.rShiftTo(nsh,r),ts<0&&BigInteger.ZERO.subTo(r,r)}}}function bnMod(a){var r=nbi();return this.abs().divRemTo(a,null,r),this.s<0&&r.compareTo(BigInteger.ZERO)>0&&a.subTo(r,r),r}function Classic(m){this.m=m}function cConvert(x){return x.s<0||x.compareTo(this.m)>=0?x.mod(this.m):x}function cRevert(x){return x}function cReduce(x){x.divRemTo(this.m,null,x)}function cMulTo(x,y,r){x.multiplyTo(y,r),this.reduce(r)}function cSqrTo(x,r){x.squareTo(r),this.reduce(r)}function bnpInvDigit(){if(this.t<1)return 0;var x=this.data[0];if(0==(1&x))return 0;var y=3&x;return y=y*(2-(15&x)*y)&15,y=y*(2-(255&x)*y)&255,y=y*(2-((65535&x)*y&65535))&65535,y=y*(2-x*y%this.DV)%this.DV,y>0?this.DV-y:-y}function Montgomery(m){this.m=m,this.mp=m.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<m.DB-15)-1,this.mt2=2*m.t}function montConvert(x){var r=nbi();return x.abs().dlShiftTo(this.m.t,r),r.divRemTo(this.m,null,r),x.s<0&&r.compareTo(BigInteger.ZERO)>0&&this.m.subTo(r,r),r}function montRevert(x){var r=nbi();return x.copyTo(r),this.reduce(r),r}function montReduce(x){for(;x.t<=this.mt2;)x.data[x.t++]=0;for(var i=0;i<this.m.t;++i){var j=32767&x.data[i],u0=j*this.mpl+((j*this.mph+(x.data[i]>>15)*this.mpl&this.um)<<15)&x.DM;for(j=i+this.m.t,x.data[j]+=this.m.am(0,u0,x,i,0,this.m.t);x.data[j]>=x.DV;)x.data[j]-=x.DV,x.data[++j]++}x.clamp(),x.drShiftTo(this.m.t,x),x.compareTo(this.m)>=0&&x.subTo(this.m,x)}function montSqrTo(x,r){x.squareTo(r),this.reduce(r)}function montMulTo(x,y,r){x.multiplyTo(y,r),this.reduce(r)}function bnpIsEven(){return 0==(this.t>0?1&this.data[0]:this.s)}function bnpExp(e,z){if(e>4294967295||e<1)return BigInteger.ONE;var r=nbi(),r2=nbi(),g=z.convert(this),i=nbits(e)-1;for(g.copyTo(r);--i>=0;)if(z.sqrTo(r,r2),(e&1<<i)>0)z.mulTo(r2,g,r);else{var t=r;r=r2,r2=t}return z.revert(r)}function bnModPowInt(e,m){var z;return z=e<256||m.isEven()?new Classic(m):new Montgomery(m),this.exp(e,z)}function bnClone(){var r=nbi();return this.copyTo(r),r}function bnIntValue(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function bnByteValue(){return 0==this.t?this.s:this.data[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this.data[0]<<16>>16}function bnpChunkSize(r){return Math.floor(Math.LN2*this.DB/Math.log(r))}function bnSigNum(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1}function bnpToRadix(b){if(null==b&&(b=10),0==this.signum()||b<2||b>36)return"0";var cs=this.chunkSize(b),a=Math.pow(b,cs),d=nbv(a),y=nbi(),z=nbi(),r="";for(this.divRemTo(d,y,z);y.signum()>0;)r=(a+z.intValue()).toString(b).substr(1)+r,y.divRemTo(d,y,z);return z.intValue().toString(b)+r}function bnpFromRadix(s,b){this.fromInt(0),null==b&&(b=10);for(var cs=this.chunkSize(b),d=Math.pow(b,cs),mi=!1,j=0,w=0,i=0;i<s.length;++i){var x=intAt(s,i);x<0?"-"==s.charAt(i)&&0==this.signum()&&(mi=!0):(w=b*w+x,++j>=cs&&(this.dMultiply(d),this.dAddOffset(w,0),j=0,w=0))}j>0&&(this.dMultiply(Math.pow(b,j)),this.dAddOffset(w,0)),mi&&BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(a,b,c){if("number"==typeof b)if(a<2)this.fromInt(1);else for(this.fromNumber(a,c),this.testBit(a-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(a-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(BigInteger.ONE.shiftLeft(a-1),this);else{var x=new Array,t=7&a;x.length=(a>>3)+1,b.nextBytes(x),t>0?x[0]&=(1<<t)-1:x[0]=0,this.fromString(x,256)}}function bnToByteArray(){var i=this.t,r=new Array;r[0]=this.s;var d,p=this.DB-i*this.DB%8,k=0;if(i-- >0)for(p<this.DB&&(d=this.data[i]>>p)!=(this.s&this.DM)>>p&&(r[k++]=d|this.s<<this.DB-p);i>=0;)p<8?(d=(this.data[i]&(1<<p)-1)<<8-p,d|=this.data[--i]>>(p+=this.DB-8)):(d=this.data[i]>>(p-=8)&255,p<=0&&(p+=this.DB,--i)),0!=(128&d)&&(d|=-256),0==k&&(128&this.s)!=(128&d)&&++k,(k>0||d!=this.s)&&(r[k++]=d);return r}function bnEquals(a){return 0==this.compareTo(a)}function bnMin(a){return this.compareTo(a)<0?this:a}function bnMax(a){return this.compareTo(a)>0?this:a}function bnpBitwiseTo(a,op,r){var i,f,m=Math.min(a.t,this.t);for(i=0;i<m;++i)r.data[i]=op(this.data[i],a.data[i]);if(a.t<this.t){for(f=a.s&this.DM,i=m;i<this.t;++i)r.data[i]=op(this.data[i],f);r.t=this.t}else{for(f=this.s&this.DM,i=m;i<a.t;++i)r.data[i]=op(f,a.data[i]);r.t=a.t}r.s=op(this.s,a.s),r.clamp()}function op_and(x,y){return x&y}function bnAnd(a){var r=nbi();return this.bitwiseTo(a,op_and,r),r}function op_or(x,y){return x|y}function bnOr(a){var r=nbi();return this.bitwiseTo(a,op_or,r),r}function op_xor(x,y){return x^y}function bnXor(a){var r=nbi();return this.bitwiseTo(a,op_xor,r),r}function op_andnot(x,y){return x&~y}function bnAndNot(a){var r=nbi();return this.bitwiseTo(a,op_andnot,r),r}function bnNot(){for(var r=nbi(),i=0;i<this.t;++i)r.data[i]=this.DM&~this.data[i];return r.t=this.t,r.s=~this.s,r}function bnShiftLeft(n){var r=nbi();return n<0?this.rShiftTo(-n,r):this.lShiftTo(n,r),r}function bnShiftRight(n){var r=nbi();return n<0?this.lShiftTo(-n,r):this.rShiftTo(n,r),r}function lbit(x){if(0==x)return-1;var r=0;return 0==(65535&x)&&(x>>=16,r+=16),0==(255&x)&&(x>>=8,r+=8),0==(15&x)&&(x>>=4,r+=4),0==(3&x)&&(x>>=2,r+=2),0==(1&x)&&++r,r}function bnGetLowestSetBit(){for(var i=0;i<this.t;++i)if(0!=this.data[i])return i*this.DB+lbit(this.data[i]);return this.s<0?this.t*this.DB:-1}function cbit(x){for(var r=0;0!=x;)x&=x-1,++r;return r}function bnBitCount(){for(var r=0,x=this.s&this.DM,i=0;i<this.t;++i)r+=cbit(this.data[i]^x);return r}function bnTestBit(n){var j=Math.floor(n/this.DB);return j>=this.t?0!=this.s:0!=(this.data[j]&1<<n%this.DB)}function bnpChangeBit(n,op){var r=BigInteger.ONE.shiftLeft(n);return this.bitwiseTo(r,op,r),r}function bnSetBit(n){return this.changeBit(n,op_or)}function bnClearBit(n){return this.changeBit(n,op_andnot)}function bnFlipBit(n){return this.changeBit(n,op_xor)}function bnpAddTo(a,r){for(var i=0,c=0,m=Math.min(a.t,this.t);i<m;)c+=this.data[i]+a.data[i],r.data[i++]=c&this.DM,c>>=this.DB;if(a.t<this.t){for(c+=a.s;i<this.t;)c+=this.data[i],r.data[i++]=c&this.DM,c>>=this.DB;c+=this.s}else{for(c+=this.s;i<a.t;)c+=a.data[i],r.data[i++]=c&this.DM,c>>=this.DB;c+=a.s}r.s=c<0?-1:0,c>0?r.data[i++]=c:c<-1&&(r.data[i++]=this.DV+c),r.t=i,r.clamp()}function bnAdd(a){var r=nbi();return this.addTo(a,r),r}function bnSubtract(a){var r=nbi();return this.subTo(a,r),r}function bnMultiply(a){var r=nbi();return this.multiplyTo(a,r),r}function bnDivide(a){var r=nbi();return this.divRemTo(a,r,null),r}function bnRemainder(a){var r=nbi();return this.divRemTo(a,null,r),r}function bnDivideAndRemainder(a){var q=nbi(),r=nbi();return this.divRemTo(a,q,r),new Array(q,r)}function bnpDMultiply(n){this.data[this.t]=this.am(0,n-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(n,w){if(0!=n){for(;this.t<=w;)this.data[this.t++]=0;for(this.data[w]+=n;this.data[w]>=this.DV;)this.data[w]-=this.DV,++w>=this.t&&(this.data[this.t++]=0),++this.data[w]}}function NullExp(){}function nNop(x){return x}function nMulTo(x,y,r){x.multiplyTo(y,r)}function nSqrTo(x,r){x.squareTo(r)}function bnPow(e){return this.exp(e,new NullExp)}function bnpMultiplyLowerTo(a,n,r){var i=Math.min(this.t+a.t,n);for(r.s=0,r.t=i;i>0;)r.data[--i]=0;var j;for(j=r.t-this.t;i<j;++i)r.data[i+this.t]=this.am(0,a.data[i],r,i,0,this.t);for(j=Math.min(a.t,n);i<j;++i)this.am(0,a.data[i],r,i,0,n-i);r.clamp()}function bnpMultiplyUpperTo(a,n,r){--n;var i=r.t=this.t+a.t-n;for(r.s=0;--i>=0;)r.data[i]=0;for(i=Math.max(n-this.t,0);i<a.t;++i)r.data[this.t+i-n]=this.am(n-i,a.data[i],r,0,0,this.t+i-n);r.clamp(),r.drShiftTo(1,r)}function Barrett(m){this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*m.t,this.r2),this.mu=this.r2.divide(m),this.m=m}function barrettConvert(x){if(x.s<0||x.t>2*this.m.t)return x.mod(this.m);if(x.compareTo(this.m)<0)return x;var r=nbi();return x.copyTo(r),this.reduce(r),r}function barrettRevert(x){return x}function barrettReduce(x){for(x.drShiftTo(this.m.t-1,this.r2),x.t>this.m.t+1&&(x.t=this.m.t+1,x.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);x.compareTo(this.r2)<0;)x.dAddOffset(1,this.m.t+1);for(x.subTo(this.r2,x);x.compareTo(this.m)>=0;)x.subTo(this.m,x)}function barrettSqrTo(x,r){x.squareTo(r),this.reduce(r)}function barrettMulTo(x,y,r){x.multiplyTo(y,r),this.reduce(r)}function bnModPow(e,m){var k,z,i=e.bitLength(),r=nbv(1);if(i<=0)return r;k=i<18?1:i<48?3:i<144?4:i<768?5:6,z=i<8?new Classic(m):m.isEven()?new Barrett(m):new Montgomery(m);var g=new Array,n=3,k1=k-1,km=(1<<k)-1;if(g[1]=z.convert(this),k>1){var g2=nbi();for(z.sqrTo(g[1],g2);n<=km;)g[n]=nbi(),z.mulTo(g2,g[n-2],g[n]),n+=2}var w,t,j=e.t-1,is1=!0,r2=nbi();for(i=nbits(e.data[j])-1;j>=0;){for(i>=k1?w=e.data[j]>>i-k1&km:(w=(e.data[j]&(1<<i+1)-1)<<k1-i,
j>0&&(w|=e.data[j-1]>>this.DB+i-k1)),n=k;0==(1&w);)w>>=1,--n;if((i-=n)<0&&(i+=this.DB,--j),is1)g[w].copyTo(r),is1=!1;else{for(;n>1;)z.sqrTo(r,r2),z.sqrTo(r2,r),n-=2;n>0?z.sqrTo(r,r2):(t=r,r=r2,r2=t),z.mulTo(r2,g[w],r)}for(;j>=0&&0==(e.data[j]&1<<i);)z.sqrTo(r,r2),t=r,r=r2,r2=t,--i<0&&(i=this.DB-1,--j)}return z.revert(r)}function bnGCD(a){var x=this.s<0?this.negate():this.clone(),y=a.s<0?a.negate():a.clone();if(x.compareTo(y)<0){var t=x;x=y,y=t}var i=x.getLowestSetBit(),g=y.getLowestSetBit();if(g<0)return x;for(i<g&&(g=i),g>0&&(x.rShiftTo(g,x),y.rShiftTo(g,y));x.signum()>0;)(i=x.getLowestSetBit())>0&&x.rShiftTo(i,x),(i=y.getLowestSetBit())>0&&y.rShiftTo(i,y),x.compareTo(y)>=0?(x.subTo(y,x),x.rShiftTo(1,x)):(y.subTo(x,y),y.rShiftTo(1,y));return g>0&&y.lShiftTo(g,y),y}function bnpModInt(n){if(n<=0)return 0;var d=this.DV%n,r=this.s<0?n-1:0;if(this.t>0)if(0==d)r=this.data[0]%n;else for(var i=this.t-1;i>=0;--i)r=(d*r+this.data[i])%n;return r}function bnModInverse(m){var ac=m.isEven();if(this.isEven()&&ac||0==m.signum())return BigInteger.ZERO;for(var u=m.clone(),v=this.clone(),a=nbv(1),b=nbv(0),c=nbv(0),d=nbv(1);0!=u.signum();){for(;u.isEven();)u.rShiftTo(1,u),ac?(a.isEven()&&b.isEven()||(a.addTo(this,a),b.subTo(m,b)),a.rShiftTo(1,a)):b.isEven()||b.subTo(m,b),b.rShiftTo(1,b);for(;v.isEven();)v.rShiftTo(1,v),ac?(c.isEven()&&d.isEven()||(c.addTo(this,c),d.subTo(m,d)),c.rShiftTo(1,c)):d.isEven()||d.subTo(m,d),d.rShiftTo(1,d);u.compareTo(v)>=0?(u.subTo(v,u),ac&&a.subTo(c,a),b.subTo(d,b)):(v.subTo(u,v),ac&&c.subTo(a,c),d.subTo(b,d))}return 0!=v.compareTo(BigInteger.ONE)?BigInteger.ZERO:d.compareTo(m)>=0?d.subtract(m):d.signum()<0?(d.addTo(m,d),d.signum()<0?d.add(m):d):d}function bnIsProbablePrime(t){var i,x=this.abs();if(1==x.t&&x.data[0]<=lowprimes[lowprimes.length-1]){for(i=0;i<lowprimes.length;++i)if(x.data[0]==lowprimes[i])return!0;return!1}if(x.isEven())return!1;for(i=1;i<lowprimes.length;){for(var m=lowprimes[i],j=i+1;j<lowprimes.length&&m<lplim;)m*=lowprimes[j++];for(m=x.modInt(m);i<j;)if(m%lowprimes[i++]==0)return!1}return x.millerRabin(t)}function bnpMillerRabin(t){var n1=this.subtract(BigInteger.ONE),k=n1.getLowestSetBit();if(k<=0)return!1;for(var a,r=n1.shiftRight(k),prng=bnGetPrng(),i=0;i<t;++i){do a=new BigInteger(this.bitLength(),prng);while(a.compareTo(BigInteger.ONE)<=0||a.compareTo(n1)>=0);var y=a.modPow(r,this);if(0!=y.compareTo(BigInteger.ONE)&&0!=y.compareTo(n1)){for(var j=1;j++<k&&0!=y.compareTo(n1);)if(y=y.modPowInt(2,this),0==y.compareTo(BigInteger.ONE))return!1;if(0!=y.compareTo(n1))return!1}}return!0}function bnGetPrng(){return{nextBytes:function(x){for(var i=0;i<x.length;++i)x[i]=Math.floor(256*Math.random())}}}var dbits,canary=0xdeadbeefcafe,j_lm=15715070==(16777215&canary);"undefined"==typeof navigator?(BigInteger.prototype.am=am3,dbits=28):j_lm&&"Microsoft Internet Explorer"==navigator.appName?(BigInteger.prototype.am=am2,dbits=30):j_lm&&"Netscape"!=navigator.appName?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28),BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP),BigInteger.prototype.F1=BI_FP-dbits,BigInteger.prototype.F2=2*dbits-BI_FP;var rr,vv,BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=new Array;for(rr="0".charCodeAt(0),vv=0;vv<=9;++vv)BI_RC[rr++]=vv;for(rr="a".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;for(rr="A".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;Classic.prototype.convert=cConvert,Classic.prototype.revert=cRevert,Classic.prototype.reduce=cReduce,Classic.prototype.mulTo=cMulTo,Classic.prototype.sqrTo=cSqrTo,Montgomery.prototype.convert=montConvert,Montgomery.prototype.revert=montRevert,Montgomery.prototype.reduce=montReduce,Montgomery.prototype.mulTo=montMulTo,Montgomery.prototype.sqrTo=montSqrTo,BigInteger.prototype.copyTo=bnpCopyTo,BigInteger.prototype.fromInt=bnpFromInt,BigInteger.prototype.fromString=bnpFromString,BigInteger.prototype.clamp=bnpClamp,BigInteger.prototype.dlShiftTo=bnpDLShiftTo,BigInteger.prototype.drShiftTo=bnpDRShiftTo,BigInteger.prototype.lShiftTo=bnpLShiftTo,BigInteger.prototype.rShiftTo=bnpRShiftTo,BigInteger.prototype.subTo=bnpSubTo,BigInteger.prototype.multiplyTo=bnpMultiplyTo,BigInteger.prototype.squareTo=bnpSquareTo,BigInteger.prototype.divRemTo=bnpDivRemTo,BigInteger.prototype.invDigit=bnpInvDigit,BigInteger.prototype.isEven=bnpIsEven,BigInteger.prototype.exp=bnpExp,BigInteger.prototype.toString=bnToString,BigInteger.prototype.negate=bnNegate,BigInteger.prototype.abs=bnAbs,BigInteger.prototype.compareTo=bnCompareTo,BigInteger.prototype.bitLength=bnBitLength,BigInteger.prototype.mod=bnMod,BigInteger.prototype.modPowInt=bnModPowInt,BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1),NullExp.prototype.convert=nNop,NullExp.prototype.revert=nNop,NullExp.prototype.mulTo=nMulTo,NullExp.prototype.sqrTo=nSqrTo,Barrett.prototype.convert=barrettConvert,Barrett.prototype.revert=barrettRevert,Barrett.prototype.reduce=barrettReduce,Barrett.prototype.mulTo=barrettMulTo,Barrett.prototype.sqrTo=barrettSqrTo;var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],lplim=(1<<26)/lowprimes[lowprimes.length-1];BigInteger.prototype.chunkSize=bnpChunkSize,BigInteger.prototype.toRadix=bnpToRadix,BigInteger.prototype.fromRadix=bnpFromRadix,BigInteger.prototype.fromNumber=bnpFromNumber,BigInteger.prototype.bitwiseTo=bnpBitwiseTo,BigInteger.prototype.changeBit=bnpChangeBit,BigInteger.prototype.addTo=bnpAddTo,BigInteger.prototype.dMultiply=bnpDMultiply,BigInteger.prototype.dAddOffset=bnpDAddOffset,BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo,BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo,BigInteger.prototype.modInt=bnpModInt,BigInteger.prototype.millerRabin=bnpMillerRabin,BigInteger.prototype.clone=bnClone,BigInteger.prototype.intValue=bnIntValue,BigInteger.prototype.byteValue=bnByteValue,BigInteger.prototype.shortValue=bnShortValue,BigInteger.prototype.signum=bnSigNum,BigInteger.prototype.toByteArray=bnToByteArray,BigInteger.prototype.equals=bnEquals,BigInteger.prototype.min=bnMin,BigInteger.prototype.max=bnMax,BigInteger.prototype.and=bnAnd,BigInteger.prototype.or=bnOr,BigInteger.prototype.xor=bnXor,BigInteger.prototype.andNot=bnAndNot,BigInteger.prototype.not=bnNot,BigInteger.prototype.shiftLeft=bnShiftLeft,BigInteger.prototype.shiftRight=bnShiftRight,BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit,BigInteger.prototype.bitCount=bnBitCount,BigInteger.prototype.testBit=bnTestBit,BigInteger.prototype.setBit=bnSetBit,BigInteger.prototype.clearBit=bnClearBit,BigInteger.prototype.flipBit=bnFlipBit,BigInteger.prototype.add=bnAdd,BigInteger.prototype.subtract=bnSubtract,BigInteger.prototype.multiply=bnMultiply,BigInteger.prototype.divide=bnDivide,BigInteger.prototype.remainder=bnRemainder,BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder,BigInteger.prototype.modPow=bnModPow,BigInteger.prototype.modInverse=bnModInverse,BigInteger.prototype.pow=bnPow,BigInteger.prototype.gcd=bnGCD,BigInteger.prototype.isProbablePrime=bnIsProbablePrime,forge.jsbn=forge.jsbn||{},forge.jsbn.BigInteger=BigInteger}var name="jsbn";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/jsbn",["require","module"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){function rsa_mgf1(seed,maskLength,hash){hash||(hash=forge.md.sha1.create());for(var t="",count=Math.ceil(maskLength/hash.digestLength),i=0;i<count;++i){var c=String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,255&i);hash.start(),hash.update(seed+c),t+=hash.digest().getBytes()}return t.substring(0,maskLength)}var pkcs1=forge.pkcs1=forge.pkcs1||{};pkcs1.encode_rsa_oaep=function(key,message,options){var label,seed,md,mgf1Md;"string"==typeof options?(label=options,seed=arguments[3]||void 0,md=arguments[4]||void 0):options&&(label=options.label||void 0,seed=options.seed||void 0,md=options.md||void 0,options.mgf1&&options.mgf1.md&&(mgf1Md=options.mgf1.md)),md?md.start():md=forge.md.sha1.create(),mgf1Md||(mgf1Md=md);var keyLength=Math.ceil(key.n.bitLength()/8),maxLength=keyLength-2*md.digestLength-2;if(message.length>maxLength){var error=new Error("RSAES-OAEP input message length is too long.");throw error.length=message.length,error.maxLength=maxLength,error}label||(label=""),md.update(label,"raw");for(var lHash=md.digest(),PS="",PS_length=maxLength-message.length,i=0;i<PS_length;i++)PS+="\0";var DB=lHash.getBytes()+PS+""+message;if(seed){if(seed.length!==md.digestLength){var error=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw error.seedLength=seed.length,error.digestLength=md.digestLength,error}}else seed=forge.random.getBytes(md.digestLength);var dbMask=rsa_mgf1(seed,keyLength-md.digestLength-1,mgf1Md),maskedDB=forge.util.xorBytes(DB,dbMask,DB.length),seedMask=rsa_mgf1(maskedDB,md.digestLength,mgf1Md),maskedSeed=forge.util.xorBytes(seed,seedMask,seed.length);return"\0"+maskedSeed+maskedDB},pkcs1.decode_rsa_oaep=function(key,em,options){var label,md,mgf1Md;"string"==typeof options?(label=options,md=arguments[3]||void 0):options&&(label=options.label||void 0,md=options.md||void 0,options.mgf1&&options.mgf1.md&&(mgf1Md=options.mgf1.md));var keyLength=Math.ceil(key.n.bitLength()/8);if(em.length!==keyLength){var error=new Error("RSAES-OAEP encoded message length is invalid.");throw error.length=em.length,error.expectedLength=keyLength,error}if(void 0===md?md=forge.md.sha1.create():md.start(),mgf1Md||(mgf1Md=md),keyLength<2*md.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");label||(label=""),md.update(label,"raw");for(var lHash=md.digest().getBytes(),y=em.charAt(0),maskedSeed=em.substring(1,md.digestLength+1),maskedDB=em.substring(1+md.digestLength),seedMask=rsa_mgf1(maskedDB,md.digestLength,mgf1Md),seed=forge.util.xorBytes(maskedSeed,seedMask,maskedSeed.length),dbMask=rsa_mgf1(seed,keyLength-md.digestLength-1,mgf1Md),db=forge.util.xorBytes(maskedDB,dbMask,maskedDB.length),lHashPrime=db.substring(0,md.digestLength),error="\0"!==y,i=0;i<md.digestLength;++i)error|=lHash.charAt(i)!==lHashPrime.charAt(i);for(var in_ps=1,index=md.digestLength,j=md.digestLength;j<db.length;j++){var code=db.charCodeAt(j),is_0=1&code^1,error_mask=in_ps?65534:0;error|=code&error_mask,in_ps&=is_0,index+=in_ps}if(error||1!==db.charCodeAt(index))throw new Error("Invalid RSAES-OAEP padding.");return db.substring(index+1)}}var name="pkcs1";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs1",["require","module","./util","./random","./sha1"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){function primeincFindPrime(bits,rng,options,callback){return"workers"in options?primeincFindPrimeWithWorkers(bits,rng,options,callback):primeincFindPrimeWithoutWorkers(bits,rng,options,callback)}function primeincFindPrimeWithoutWorkers(bits,rng,options,callback){var num=generateRandom(bits,rng),deltaIdx=0,mrTests=getMillerRabinTests(num.bitLength());"millerRabinTests"in options&&(mrTests=options.millerRabinTests);var maxBlockTime=10;"maxBlockTime"in options&&(maxBlockTime=options.maxBlockTime);var start=+new Date;do{if(num.bitLength()>bits&&(num=generateRandom(bits,rng)),num.isProbablePrime(mrTests))return callback(null,num);num.dAddOffset(GCD_30_DELTA[deltaIdx++%8],0)}while(maxBlockTime<0||+new Date-start<maxBlockTime);forge.util.setImmediate(function(){primeincFindPrimeWithoutWorkers(bits,rng,options,callback)})}function primeincFindPrimeWithWorkers(bits,rng,options,callback){function generate(){function workerMessage(e){if(!found){--running;var data=e.data;if(data.found){for(var i=0;i<workers.length;++i)workers[i].terminate();return found=!0,callback(null,new BigInteger(data.prime,16))}num.bitLength()>bits&&(num=generateRandom(bits,rng));var hex=num.toString(16);e.target.postMessage({hex:hex,workLoad:workLoad}),num.dAddOffset(range,0)}}numWorkers=Math.max(1,numWorkers);for(var workers=[],i=0;i<numWorkers;++i)workers[i]=new Worker(workerScript);for(var running=numWorkers,i=0;i<numWorkers;++i)workers[i].addEventListener("message",workerMessage);var found=!1}if("undefined"==typeof Worker)return primeincFindPrimeWithoutWorkers(bits,rng,options,callback);var num=generateRandom(bits,rng),numWorkers=options.workers,workLoad=options.workLoad||100,range=30*workLoad/8,workerScript=options.workerScript||"forge/prime.worker.js";return numWorkers===-1?forge.util.estimateCores(function(err,cores){err&&(cores=2),numWorkers=cores-1,generate()}):void generate()}function generateRandom(bits,rng){var num=new BigInteger(bits,rng),bits1=bits-1;return num.testBit(bits1)||num.bitwiseTo(BigInteger.ONE.shiftLeft(bits1),op_or,num),num.dAddOffset(31-num.mod(THIRTY).byteValue(),0),num}function getMillerRabinTests(bits){return bits<=100?27:bits<=150?18:bits<=200?15:bits<=250?12:bits<=300?9:bits<=350?8:bits<=400?7:bits<=500?6:bits<=600?5:bits<=800?4:bits<=1250?3:2}if(!forge.prime){var prime=forge.prime=forge.prime||{},BigInteger=forge.jsbn.BigInteger,GCD_30_DELTA=[6,4,2,4,2,4,6,2],THIRTY=new BigInteger(null);THIRTY.fromInt(30);var op_or=function(x,y){return x|y};prime.generateProbablePrime=function(bits,options,callback){"function"==typeof options&&(callback=options,options={}),options=options||{};var algorithm=options.algorithm||"PRIMEINC";"string"==typeof algorithm&&(algorithm={name:algorithm}),algorithm.options=algorithm.options||{};var prng=options.prng||forge.random,rng={nextBytes:function(x){for(var b=prng.getBytesSync(x.length),i=0;i<x.length;++i)x[i]=b.charCodeAt(i)}};if("PRIMEINC"===algorithm.name)return primeincFindPrime(bits,rng,algorithm.options,callback);throw new Error("Invalid prime generation algorithm: "+algorithm.name)}}}var name="prime";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/prime",["require","module","./util","./jsbn","./random"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){function _encodePkcs1_v1_5(m,key,bt){var eb=forge.util.createBuffer(),k=Math.ceil(key.n.bitLength()/8);if(m.length>k-11){var error=new Error("Message is too long for PKCS#1 v1.5 padding.");throw error.length=m.length,error.max=k-11,error}eb.putByte(0),eb.putByte(bt);var padByte,padNum=k-3-m.length;if(0===bt||1===bt){padByte=0===bt?0:255;for(var i=0;i<padNum;++i)eb.putByte(padByte)}else for(;padNum>0;){for(var numZeros=0,padBytes=forge.random.getBytes(padNum),i=0;i<padNum;++i)padByte=padBytes.charCodeAt(i),0===padByte?++numZeros:eb.putByte(padByte);padNum=numZeros}return eb.putByte(0),eb.putBytes(m),eb}function _decodePkcs1_v1_5(em,key,pub,ml){var k=Math.ceil(key.n.bitLength()/8),eb=forge.util.createBuffer(em),first=eb.getByte(),bt=eb.getByte();if(0!==first||pub&&0!==bt&&1!==bt||!pub&&2!=bt||pub&&0===bt&&"undefined"==typeof ml)throw new Error("Encryption block is invalid.");var padNum=0;if(0===bt){padNum=k-3-ml;for(var i=0;i<padNum;++i)if(0!==eb.getByte())throw new Error("Encryption block is invalid.")}else if(1===bt)for(padNum=0;eb.length()>1;){if(255!==eb.getByte()){--eb.read;break}++padNum}else if(2===bt)for(padNum=0;eb.length()>1;){if(0===eb.getByte()){--eb.read;break}++padNum}var zero=eb.getByte();if(0!==zero||padNum!==k-3-eb.length())throw new Error("Encryption block is invalid.");return eb.getBytes()}function _generateKeyPair(state,options,callback){function generate(){getPrime(state.pBits,function(err,num){return err?callback(err):(state.p=num,null!==state.q?finish(err,state.q):void getPrime(state.qBits,finish))})}function getPrime(bits,callback){forge.prime.generateProbablePrime(bits,opts,callback)}function finish(err,num){if(err)return callback(err);if(state.q=num,state.p.compareTo(state.q)<0){var tmp=state.p;state.p=state.q,state.q=tmp}if(0!==state.p.subtract(BigInteger.ONE).gcd(state.e).compareTo(BigInteger.ONE))return state.p=null,void generate();if(0!==state.q.subtract(BigInteger.ONE).gcd(state.e).compareTo(BigInteger.ONE))return state.q=null,void getPrime(state.qBits,finish);if(state.p1=state.p.subtract(BigInteger.ONE),state.q1=state.q.subtract(BigInteger.ONE),state.phi=state.p1.multiply(state.q1),0!==state.phi.gcd(state.e).compareTo(BigInteger.ONE))return state.p=state.q=null,void generate();if(state.n=state.p.multiply(state.q),state.n.bitLength()!==state.bits)return state.q=null,void getPrime(state.qBits,finish);var d=state.e.modInverse(state.phi);state.keys={privateKey:pki.rsa.setPrivateKey(state.n,state.e,d,state.p,state.q,d.mod(state.p1),d.mod(state.q1),state.q.modInverse(state.p)),publicKey:pki.rsa.setPublicKey(state.n,state.e)},callback(null,state.keys)}"function"==typeof options&&(callback=options,options={}),options=options||{};var opts={algorithm:{name:options.algorithm||"PRIMEINC",options:{workers:options.workers||2,workLoad:options.workLoad||100,workerScript:options.workerScript}}};"prng"in options&&(opts.prng=options.prng),generate()}function _bnToBytes(b){var hex=b.toString(16);return hex[0]>="8"&&(hex="00"+hex),forge.util.hexToBytes(hex)}function _getMillerRabinTests(bits){return bits<=100?27:bits<=150?18:bits<=200?15:bits<=250?12:bits<=300?9:bits<=350?8:bits<=400?7:bits<=500?6:bits<=600?5:bits<=800?4:bits<=1250?3:2}if("undefined"==typeof BigInteger)var BigInteger=forge.jsbn.BigInteger;var asn1=forge.asn1;forge.pki=forge.pki||{},forge.pki.rsa=forge.rsa=forge.rsa||{};var pki=forge.pki,GCD_30_DELTA=[6,4,2,4,2,4,6,2],privateKeyValidator={name:"PrivateKeyInfo",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},rsaPrivateKeyValidator={name:"RSAPrivateKey",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},rsaPublicKeyValidator={name:"RSAPublicKey",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},publicKeyValidator=forge.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},emsaPkcs1v15encode=function(md){var oid;if(!(md.algorithm in pki.oids)){var error=new Error("Unknown message digest algorithm.");throw error.algorithm=md.algorithm,error}oid=pki.oids[md.algorithm];var oidBytes=asn1.oidToDer(oid).getBytes(),digestInfo=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[]),digestAlgorithm=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[]);digestAlgorithm.value.push(asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,oidBytes)),digestAlgorithm.value.push(asn1.create(asn1.Class.UNIVERSAL,asn1.Type.NULL,!1,""));var digest=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,md.digest().getBytes());return digestInfo.value.push(digestAlgorithm),digestInfo.value.push(digest),asn1.toDer(digestInfo).getBytes()},_modPow=function(x,key,pub){if(pub)return x.modPow(key.e,key.n);if(!key.p||!key.q)return x.modPow(key.d,key.n);key.dP||(key.dP=key.d.mod(key.p.subtract(BigInteger.ONE))),key.dQ||(key.dQ=key.d.mod(key.q.subtract(BigInteger.ONE))),key.qInv||(key.qInv=key.q.modInverse(key.p));var r;do r=new BigInteger(forge.util.bytesToHex(forge.random.getBytes(key.n.bitLength()/8)),16).mod(key.n);while(r.equals(BigInteger.ZERO));x=x.multiply(r.modPow(key.e,key.n)).mod(key.n);for(var xp=x.mod(key.p).modPow(key.dP,key.p),xq=x.mod(key.q).modPow(key.dQ,key.q);xp.compareTo(xq)<0;)xp=xp.add(key.p);var y=xp.subtract(xq).multiply(key.qInv).mod(key.p).multiply(key.q).add(xq);return y=y.multiply(r.modInverse(key.n)).mod(key.n)};pki.rsa.encrypt=function(m,key,bt){var eb,pub=bt,k=Math.ceil(key.n.bitLength()/8);bt!==!1&&bt!==!0?(pub=2===bt,eb=_encodePkcs1_v1_5(m,key,bt)):(eb=forge.util.createBuffer(),eb.putBytes(m));for(var x=new BigInteger(eb.toHex(),16),y=_modPow(x,key,pub),yhex=y.toString(16),ed=forge.util.createBuffer(),zeros=k-Math.ceil(yhex.length/2);zeros>0;)ed.putByte(0),--zeros;return ed.putBytes(forge.util.hexToBytes(yhex)),ed.getBytes()},pki.rsa.decrypt=function(ed,key,pub,ml){var k=Math.ceil(key.n.bitLength()/8);if(ed.length!==k){var error=new Error("Encrypted message length is invalid.");throw error.length=ed.length,error.expected=k,error}var y=new BigInteger(forge.util.createBuffer(ed).toHex(),16);if(y.compareTo(key.n)>=0)throw new Error("Encrypted message is invalid.");for(var x=_modPow(y,key,pub),xhex=x.toString(16),eb=forge.util.createBuffer(),zeros=k-Math.ceil(xhex.length/2);zeros>0;)eb.putByte(0),--zeros;return eb.putBytes(forge.util.hexToBytes(xhex)),ml!==!1?_decodePkcs1_v1_5(eb.getBytes(),key,pub):eb.getBytes()},pki.rsa.createKeyPairGenerationState=function(bits,e,options){"string"==typeof bits&&(bits=parseInt(bits,10)),bits=bits||2048,options=options||{};var rval,prng=options.prng||forge.random,rng={nextBytes:function(x){for(var b=prng.getBytesSync(x.length),i=0;i<x.length;++i)x[i]=b.charCodeAt(i)}},algorithm=options.algorithm||"PRIMEINC";if("PRIMEINC"!==algorithm)throw new Error("Invalid key generation algorithm: "+algorithm);return rval={algorithm:algorithm,state:0,bits:bits,rng:rng,eInt:e||65537,e:new BigInteger(null),p:null,q:null,qBits:bits>>1,pBits:bits-(bits>>1),pqState:0,num:null,keys:null},rval.e.fromInt(rval.eInt),rval},pki.rsa.stepKeyPairGenerationState=function(state,n){"algorithm"in state||(state.algorithm="PRIMEINC");var THIRTY=new BigInteger(null);THIRTY.fromInt(30);for(var t2,deltaIdx=0,op_or=function(x,y){return x|y},t1=+new Date,total=0;null===state.keys&&(n<=0||total<n);){if(0===state.state){var bits=null===state.p?state.pBits:state.qBits,bits1=bits-1;0===state.pqState?(state.num=new BigInteger(bits,state.rng),state.num.testBit(bits1)||state.num.bitwiseTo(BigInteger.ONE.shiftLeft(bits1),op_or,state.num),state.num.dAddOffset(31-state.num.mod(THIRTY).byteValue(),0),deltaIdx=0,++state.pqState):1===state.pqState?state.num.bitLength()>bits?state.pqState=0:state.num.isProbablePrime(_getMillerRabinTests(state.num.bitLength()))?++state.pqState:state.num.dAddOffset(GCD_30_DELTA[deltaIdx++%8],0):2===state.pqState?state.pqState=0===state.num.subtract(BigInteger.ONE).gcd(state.e).compareTo(BigInteger.ONE)?3:0:3===state.pqState&&(state.pqState=0,null===state.p?state.p=state.num:state.q=state.num,null!==state.p&&null!==state.q&&++state.state,state.num=null)}else if(1===state.state)state.p.compareTo(state.q)<0&&(state.num=state.p,state.p=state.q,state.q=state.num),++state.state;else if(2===state.state)state.p1=state.p.subtract(BigInteger.ONE),state.q1=state.q.subtract(BigInteger.ONE),state.phi=state.p1.multiply(state.q1),++state.state;else if(3===state.state)0===state.phi.gcd(state.e).compareTo(BigInteger.ONE)?++state.state:(state.p=null,state.q=null,state.state=0);else if(4===state.state)state.n=state.p.multiply(state.q),state.n.bitLength()===state.bits?++state.state:(state.q=null,state.state=0);else if(5===state.state){var d=state.e.modInverse(state.phi);state.keys={privateKey:pki.rsa.setPrivateKey(state.n,state.e,d,state.p,state.q,d.mod(state.p1),d.mod(state.q1),state.q.modInverse(state.p)),publicKey:pki.rsa.setPublicKey(state.n,state.e)}}t2=+new Date,total+=t2-t1,t1=t2}return null!==state.keys},pki.rsa.generateKeyPair=function(bits,e,options,callback){1===arguments.length?"object"==typeof bits?(options=bits,bits=void 0):"function"==typeof bits&&(callback=bits,bits=void 0):2===arguments.length?"number"==typeof bits?"function"==typeof e?(callback=e,e=void 0):"number"!=typeof e&&(options=e,e=void 0):(options=bits,callback=e,bits=void 0,e=void 0):3===arguments.length&&("number"==typeof e?"function"==typeof options&&(callback=options,options=void 0):(callback=options,options=e,e=void 0)),options=options||{},void 0===bits&&(bits=options.bits||2048),void 0===e&&(e=options.e||65537);var state=pki.rsa.createKeyPairGenerationState(bits,e,options);return callback?void _generateKeyPair(state,options,callback):(pki.rsa.stepKeyPairGenerationState(state,0),state.keys)},pki.setRsaPublicKey=pki.rsa.setPublicKey=function(n,e){var key={n:n,e:e};return key.encrypt=function(data,scheme,schemeOptions){if("string"==typeof scheme?scheme=scheme.toUpperCase():void 0===scheme&&(scheme="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===scheme)scheme={encode:function(m,key,pub){return _encodePkcs1_v1_5(m,key,2).getBytes()}};else if("RSA-OAEP"===scheme||"RSAES-OAEP"===scheme)scheme={encode:function(m,key){return forge.pkcs1.encode_rsa_oaep(key,m,schemeOptions)}};else if(["RAW","NONE","NULL",null].indexOf(scheme)!==-1)scheme={encode:function(e){return e}};else if("string"==typeof scheme)throw new Error('Unsupported encryption scheme: "'+scheme+'".');var e=scheme.encode(data,key,!0);return pki.rsa.encrypt(e,key,!0)},key.verify=function(digest,signature,scheme){"string"==typeof scheme?scheme=scheme.toUpperCase():void 0===scheme&&(scheme="RSASSA-PKCS1-V1_5"),"RSASSA-PKCS1-V1_5"===scheme?scheme={verify:function(digest,d){d=_decodePkcs1_v1_5(d,key,!0);var obj=asn1.fromDer(d);return digest===obj.value[1].value}}:"NONE"!==scheme&&"NULL"!==scheme&&null!==scheme||(scheme={verify:function(digest,d){return d=_decodePkcs1_v1_5(d,key,!0),digest===d}});var d=pki.rsa.decrypt(signature,key,!0,!1);return scheme.verify(digest,d,key.n.bitLength())},key},pki.setRsaPrivateKey=pki.rsa.setPrivateKey=function(n,e,d,p,q,dP,dQ,qInv){var key={n:n,e:e,d:d,p:p,q:q,dP:dP,dQ:dQ,qInv:qInv};return key.decrypt=function(data,scheme,schemeOptions){"string"==typeof scheme?scheme=scheme.toUpperCase():void 0===scheme&&(scheme="RSAES-PKCS1-V1_5");var d=pki.rsa.decrypt(data,key,!1,!1);if("RSAES-PKCS1-V1_5"===scheme)scheme={decode:_decodePkcs1_v1_5};else if("RSA-OAEP"===scheme||"RSAES-OAEP"===scheme)scheme={decode:function(d,key){return forge.pkcs1.decode_rsa_oaep(key,d,schemeOptions)}};else{if(["RAW","NONE","NULL",null].indexOf(scheme)===-1)throw new Error('Unsupported encryption scheme: "'+scheme+'".');scheme={decode:function(d){return d}}}return scheme.decode(d,key,!1)},key.sign=function(md,scheme){var bt=!1;"string"==typeof scheme&&(scheme=scheme.toUpperCase()),void 0===scheme||"RSASSA-PKCS1-V1_5"===scheme?(scheme={encode:emsaPkcs1v15encode},bt=1):"NONE"!==scheme&&"NULL"!==scheme&&null!==scheme||(scheme={encode:function(){return md}},bt=1);var d=scheme.encode(md,key.n.bitLength());return pki.rsa.encrypt(d,key,bt)},key},pki.wrapRsaPrivateKey=function(rsaKey){return asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,asn1.integerToDer(0).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(pki.oids.rsaEncryption).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.NULL,!1,"")]),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,asn1.toDer(rsaKey).getBytes())])},pki.privateKeyFromAsn1=function(obj){var capture={},errors=[];if(asn1.validate(obj,privateKeyValidator,capture,errors)&&(obj=asn1.fromDer(forge.util.createBuffer(capture.privateKey))),capture={},errors=[],!asn1.validate(obj,rsaPrivateKeyValidator,capture,errors)){var error=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");
throw error.errors=errors,error}var n,e,d,p,q,dP,dQ,qInv;return n=forge.util.createBuffer(capture.privateKeyModulus).toHex(),e=forge.util.createBuffer(capture.privateKeyPublicExponent).toHex(),d=forge.util.createBuffer(capture.privateKeyPrivateExponent).toHex(),p=forge.util.createBuffer(capture.privateKeyPrime1).toHex(),q=forge.util.createBuffer(capture.privateKeyPrime2).toHex(),dP=forge.util.createBuffer(capture.privateKeyExponent1).toHex(),dQ=forge.util.createBuffer(capture.privateKeyExponent2).toHex(),qInv=forge.util.createBuffer(capture.privateKeyCoefficient).toHex(),pki.setRsaPrivateKey(new BigInteger(n,16),new BigInteger(e,16),new BigInteger(d,16),new BigInteger(p,16),new BigInteger(q,16),new BigInteger(dP,16),new BigInteger(dQ,16),new BigInteger(qInv,16))},pki.privateKeyToAsn1=pki.privateKeyToRSAPrivateKey=function(key){return asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,asn1.integerToDer(0).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(key.n)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(key.e)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(key.d)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(key.p)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(key.q)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(key.dP)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(key.dQ)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(key.qInv))])},pki.publicKeyFromAsn1=function(obj){var capture={},errors=[];if(asn1.validate(obj,publicKeyValidator,capture,errors)){var oid=asn1.derToOid(capture.publicKeyOid);if(oid!==pki.oids.rsaEncryption){var error=new Error("Cannot read public key. Unknown OID.");throw error.oid=oid,error}obj=capture.rsaPublicKey}if(errors=[],!asn1.validate(obj,rsaPublicKeyValidator,capture,errors)){var error=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw error.errors=errors,error}var n=forge.util.createBuffer(capture.publicKeyModulus).toHex(),e=forge.util.createBuffer(capture.publicKeyExponent).toHex();return pki.setRsaPublicKey(new BigInteger(n,16),new BigInteger(e,16))},pki.publicKeyToAsn1=pki.publicKeyToSubjectPublicKeyInfo=function(key){return asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(pki.oids.rsaEncryption).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.NULL,!1,"")]),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.BITSTRING,!1,[pki.publicKeyToRSAPublicKey(key)])])},pki.publicKeyToRSAPublicKey=function(key){return asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(key.n)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,_bnToBytes(key.e))])}}var name="rsa";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/rsa",["require","module","./asn1","./jsbn","./oids","./pkcs1","./prime","./random","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){function hash(md,bytes){return md.start().update(bytes).digest().getBytes()}if("undefined"==typeof BigInteger)var BigInteger=forge.jsbn.BigInteger;var asn1=forge.asn1,pki=forge.pki=forge.pki||{};pki.pbe=forge.pbe=forge.pbe||{};var oids=pki.oids,encryptedPrivateKeyValidator={name:"EncryptedPrivateKeyInfo",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},PBES2AlgorithmsValidator={name:"PBES2Algorithms",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,onstructed:!0,capture:"kdfIterationCount"}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},pkcs12PbeParamsValidator={name:"pkcs-12PbeParams",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"iterations"}]};pki.encryptPrivateKeyInfo=function(obj,password,options){options=options||{},options.saltSize=options.saltSize||8,options.count=options.count||2048,options.algorithm=options.algorithm||"aes128";var dkLen,encryptionAlgorithm,encryptedData,salt=forge.random.getBytesSync(options.saltSize),count=options.count,countBytes=asn1.integerToDer(count);if(0===options.algorithm.indexOf("aes")||"des"===options.algorithm){var ivLen,encOid,cipherFn;switch(options.algorithm){case"aes128":dkLen=16,ivLen=16,encOid=oids["aes128-CBC"],cipherFn=forge.aes.createEncryptionCipher;break;case"aes192":dkLen=24,ivLen=16,encOid=oids["aes192-CBC"],cipherFn=forge.aes.createEncryptionCipher;break;case"aes256":dkLen=32,ivLen=16,encOid=oids["aes256-CBC"],cipherFn=forge.aes.createEncryptionCipher;break;case"des":dkLen=8,ivLen=8,encOid=oids.desCBC,cipherFn=forge.des.createEncryptionCipher;break;default:var error=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw error.algorithm=options.algorithm,error}var dk=forge.pkcs5.pbkdf2(password,salt,count,dkLen),iv=forge.random.getBytesSync(ivLen),cipher=cipherFn(dk);cipher.start(iv),cipher.update(asn1.toDer(obj)),cipher.finish(),encryptedData=cipher.output.getBytes(),encryptionAlgorithm=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(oids.pkcs5PBES2).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(oids.pkcs5PBKDF2).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,salt),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,countBytes.getBytes())])]),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(encOid).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,iv)])])])}else{if("3des"!==options.algorithm){var error=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw error.algorithm=options.algorithm,error}dkLen=24;var saltBytes=new forge.util.ByteBuffer(salt),dk=pki.pbe.generatePkcs12Key(password,saltBytes,1,count,dkLen),iv=pki.pbe.generatePkcs12Key(password,saltBytes,2,count,dkLen),cipher=forge.des.createEncryptionCipher(dk);cipher.start(iv),cipher.update(asn1.toDer(obj)),cipher.finish(),encryptedData=cipher.output.getBytes(),encryptionAlgorithm=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,salt),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,countBytes.getBytes())])])}var rval=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[encryptionAlgorithm,asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,encryptedData)]);return rval},pki.decryptPrivateKeyInfo=function(obj,password){var rval=null,capture={},errors=[];if(!asn1.validate(obj,encryptedPrivateKeyValidator,capture,errors)){var error=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw error.errors=errors,error}var oid=asn1.derToOid(capture.encryptionOid),cipher=pki.pbe.getCipher(oid,capture.encryptionParams,password),encrypted=forge.util.createBuffer(capture.encryptedData);return cipher.update(encrypted),cipher.finish()&&(rval=asn1.fromDer(cipher.output)),rval},pki.encryptedPrivateKeyToPem=function(epki,maxline){var msg={type:"ENCRYPTED PRIVATE KEY",body:asn1.toDer(epki).getBytes()};return forge.pem.encode(msg,{maxline:maxline})},pki.encryptedPrivateKeyFromPem=function(pem){var msg=forge.pem.decode(pem)[0];if("ENCRYPTED PRIVATE KEY"!==msg.type){var error=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw error.headerType=msg.type,error}if(msg.procType&&"ENCRYPTED"===msg.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return asn1.fromDer(msg.body)},pki.encryptRsaPrivateKey=function(rsaKey,password,options){if(options=options||{},!options.legacy){var rval=pki.wrapRsaPrivateKey(pki.privateKeyToAsn1(rsaKey));return rval=pki.encryptPrivateKeyInfo(rval,password,options),pki.encryptedPrivateKeyToPem(rval)}var algorithm,iv,dkLen,cipherFn;switch(options.algorithm){case"aes128":algorithm="AES-128-CBC",dkLen=16,iv=forge.random.getBytesSync(16),cipherFn=forge.aes.createEncryptionCipher;break;case"aes192":algorithm="AES-192-CBC",dkLen=24,iv=forge.random.getBytesSync(16),cipherFn=forge.aes.createEncryptionCipher;break;case"aes256":algorithm="AES-256-CBC",dkLen=32,iv=forge.random.getBytesSync(16),cipherFn=forge.aes.createEncryptionCipher;break;case"3des":algorithm="DES-EDE3-CBC",dkLen=24,iv=forge.random.getBytesSync(8),cipherFn=forge.des.createEncryptionCipher;break;case"des":algorithm="DES-CBC",dkLen=8,iv=forge.random.getBytesSync(8),cipherFn=forge.des.createEncryptionCipher;break;default:var error=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+options.algorithm+'".');throw error.algorithm=options.algorithm,error}var dk=forge.pbe.opensslDeriveBytes(password,iv.substr(0,8),dkLen),cipher=cipherFn(dk);cipher.start(iv),cipher.update(asn1.toDer(pki.privateKeyToAsn1(rsaKey))),cipher.finish();var msg={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:algorithm,parameters:forge.util.bytesToHex(iv).toUpperCase()},body:cipher.output.getBytes()};return forge.pem.encode(msg)},pki.decryptRsaPrivateKey=function(pem,password){var rval=null,msg=forge.pem.decode(pem)[0];if("ENCRYPTED PRIVATE KEY"!==msg.type&&"PRIVATE KEY"!==msg.type&&"RSA PRIVATE KEY"!==msg.type){var error=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw error.headerType=error,error}if(msg.procType&&"ENCRYPTED"===msg.procType.type){var dkLen,cipherFn;switch(msg.dekInfo.algorithm){case"DES-CBC":dkLen=8,cipherFn=forge.des.createDecryptionCipher;break;case"DES-EDE3-CBC":dkLen=24,cipherFn=forge.des.createDecryptionCipher;break;case"AES-128-CBC":dkLen=16,cipherFn=forge.aes.createDecryptionCipher;break;case"AES-192-CBC":dkLen=24,cipherFn=forge.aes.createDecryptionCipher;break;case"AES-256-CBC":dkLen=32,cipherFn=forge.aes.createDecryptionCipher;break;case"RC2-40-CBC":dkLen=5,cipherFn=function(key){return forge.rc2.createDecryptionCipher(key,40)};break;case"RC2-64-CBC":dkLen=8,cipherFn=function(key){return forge.rc2.createDecryptionCipher(key,64)};break;case"RC2-128-CBC":dkLen=16,cipherFn=function(key){return forge.rc2.createDecryptionCipher(key,128)};break;default:var error=new Error('Could not decrypt private key; unsupported encryption algorithm "'+msg.dekInfo.algorithm+'".');throw error.algorithm=msg.dekInfo.algorithm,error}var iv=forge.util.hexToBytes(msg.dekInfo.parameters),dk=forge.pbe.opensslDeriveBytes(password,iv.substr(0,8),dkLen),cipher=cipherFn(dk);if(cipher.start(iv),cipher.update(forge.util.createBuffer(msg.body)),!cipher.finish())return rval;rval=cipher.output.getBytes()}else rval=msg.body;return rval="ENCRYPTED PRIVATE KEY"===msg.type?pki.decryptPrivateKeyInfo(asn1.fromDer(rval),password):asn1.fromDer(rval),null!==rval&&(rval=pki.privateKeyFromAsn1(rval)),rval},pki.pbe.generatePkcs12Key=function(password,salt,id,iter,n,md){var j,l;"undefined"!=typeof md&&null!==md||(md=forge.md.sha1.create());var u=md.digestLength,v=md.blockLength,result=new forge.util.ByteBuffer,passBuf=new forge.util.ByteBuffer;if(null!==password&&void 0!==password){for(l=0;l<password.length;l++)passBuf.putInt16(password.charCodeAt(l));passBuf.putInt16(0)}var p=passBuf.length(),s=salt.length(),D=new forge.util.ByteBuffer;D.fillWithByte(id,v);var Slen=v*Math.ceil(s/v),S=new forge.util.ByteBuffer;for(l=0;l<Slen;l++)S.putByte(salt.at(l%s));var Plen=v*Math.ceil(p/v),P=new forge.util.ByteBuffer;for(l=0;l<Plen;l++)P.putByte(passBuf.at(l%p));var I=S;I.putBuffer(P);for(var c=Math.ceil(n/u),i=1;i<=c;i++){var buf=new forge.util.ByteBuffer;buf.putBytes(D.bytes()),buf.putBytes(I.bytes());for(var round=0;round<iter;round++)md.start(),md.update(buf.getBytes()),buf=md.digest();var B=new forge.util.ByteBuffer;for(l=0;l<v;l++)B.putByte(buf.at(l%u));var k=Math.ceil(s/v)+Math.ceil(p/v),Inew=new forge.util.ByteBuffer;for(j=0;j<k;j++){var chunk=new forge.util.ByteBuffer(I.getBytes(v)),x=511;for(l=B.length()-1;l>=0;l--)x>>=8,x+=B.at(l)+chunk.at(l),chunk.setAt(l,255&x);Inew.putBuffer(chunk)}I=Inew,result.putBuffer(buf)}return result.truncate(result.length()-n),result},pki.pbe.getCipher=function(oid,params,password){switch(oid){case pki.oids.pkcs5PBES2:return pki.pbe.getCipherForPBES2(oid,params,password);case pki.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case pki.oids["pbewithSHAAnd40BitRC2-CBC"]:return pki.pbe.getCipherForPKCS12PBE(oid,params,password);default:var error=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw error.oid=oid,error.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],error}},pki.pbe.getCipherForPBES2=function(oid,params,password){var capture={},errors=[];if(!asn1.validate(params,PBES2AlgorithmsValidator,capture,errors)){var error=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw error.errors=errors,error}if(oid=asn1.derToOid(capture.kdfOid),oid!==pki.oids.pkcs5PBKDF2){var error=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw error.oid=oid,error.supportedOids=["pkcs5PBKDF2"],error}if(oid=asn1.derToOid(capture.encOid),oid!==pki.oids["aes128-CBC"]&&oid!==pki.oids["aes192-CBC"]&&oid!==pki.oids["aes256-CBC"]&&oid!==pki.oids["des-EDE3-CBC"]&&oid!==pki.oids.desCBC){var error=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw error.oid=oid,error.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],error}var salt=capture.kdfSalt,count=forge.util.createBuffer(capture.kdfIterationCount);count=count.getInt(count.length()<<3);var dkLen,cipherFn;switch(pki.oids[oid]){case"aes128-CBC":dkLen=16,cipherFn=forge.aes.createDecryptionCipher;break;case"aes192-CBC":dkLen=24,cipherFn=forge.aes.createDecryptionCipher;break;case"aes256-CBC":dkLen=32,cipherFn=forge.aes.createDecryptionCipher;break;case"des-EDE3-CBC":dkLen=24,cipherFn=forge.des.createDecryptionCipher;break;case"desCBC":dkLen=8,cipherFn=forge.des.createDecryptionCipher}var dk=forge.pkcs5.pbkdf2(password,salt,count,dkLen),iv=capture.encIv,cipher=cipherFn(dk);return cipher.start(iv),cipher},pki.pbe.getCipherForPKCS12PBE=function(oid,params,password){var capture={},errors=[];if(!asn1.validate(params,pkcs12PbeParamsValidator,capture,errors)){var error=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw error.errors=errors,error}var salt=forge.util.createBuffer(capture.salt),count=forge.util.createBuffer(capture.iterations);count=count.getInt(count.length()<<3);var dkLen,dIvLen,cipherFn;switch(oid){case pki.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:dkLen=24,dIvLen=8,cipherFn=forge.des.startDecrypting;break;case pki.oids["pbewithSHAAnd40BitRC2-CBC"]:dkLen=5,dIvLen=8,cipherFn=function(key,iv){var cipher=forge.rc2.createDecryptionCipher(key,40);return cipher.start(iv,null),cipher};break;default:var error=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw error.oid=oid,error}var key=pki.pbe.generatePkcs12Key(password,salt,1,count,dkLen),iv=pki.pbe.generatePkcs12Key(password,salt,2,count,dIvLen);return cipherFn(key,iv)},pki.pbe.opensslDeriveBytes=function(password,salt,dkLen,md){"undefined"!=typeof md&&null!==md||(md=forge.md.md5.create()),null===salt&&(salt="");for(var digests=[hash(md,password+salt)],length=16,i=1;length<dkLen;++i,length+=16)digests.push(hash(md,digests[i-1]+password+salt));return digests.join("").substr(0,dkLen)}}var name="pbe";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pbe",["require","module","./aes","./asn1","./des","./md","./oids","./pem","./pbkdf2","./random","./rc2","./rsa","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){var asn1=forge.asn1,p7v=forge.pkcs7asn1=forge.pkcs7asn1||{};forge.pkcs7=forge.pkcs7||{},forge.pkcs7.asn1=p7v;var contentInfoValidator={name:"ContentInfo",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:asn1.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};p7v.contentInfoValidator=contentInfoValidator;var encryptedContentInfoValidator={name:"EncryptedContentInfo",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:asn1.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:asn1.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};p7v.envelopedDataValidator={name:"EnvelopedData",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(encryptedContentInfoValidator)},p7v.encryptedDataValidator={name:"EncryptedData",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"version"}].concat(encryptedContentInfoValidator)};var signerValidator={name:"SignerInfo",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.Version",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1},{name:"SignerInfo.IssuerAndSerialNumber",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0},{name:"SignerInfo.DigestAlgorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0},{name:"SignerInfo.AuthenticatedAttributes",tagClass:asn1.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.DigestEncryptionAlgorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0},{name:"SignerInfo.EncryptedDigest",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.UnauthenticatedAttributes",tagClass:asn1.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0}]};p7v.signedDataValidator={name:"SignedData",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},contentInfoValidator,{name:"SignedData.Certificates",tagClass:asn1.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:asn1.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SET,capture:"signerInfos",optional:!0,value:[signerValidator]}]},p7v.recipientInfoValidator={name:"RecipientInfo",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:asn1.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}}var name="pkcs7asn1";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs7asn1",["require","module","./asn1","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){forge.mgf=forge.mgf||{};var mgf1=forge.mgf.mgf1=forge.mgf1=forge.mgf1||{};mgf1.create=function(md){var mgf={generate:function(seed,maskLen){for(var t=new forge.util.ByteBuffer,len=Math.ceil(maskLen/md.digestLength),i=0;i<len;i++){var c=new forge.util.ByteBuffer;c.putInt32(i),md.start(),md.update(seed+c.getBytes()),t.putBuffer(md.digest())}return t.truncate(t.length()-maskLen),t.getBytes()}};return mgf}}var name="mgf1";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/mgf1",["require","module","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){forge.mgf=forge.mgf||{},forge.mgf.mgf1=forge.mgf1}var name="mgf";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/mgf",["require","module","./mgf1"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){var pss=forge.pss=forge.pss||{};pss.create=function(options){3===arguments.length&&(options={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var hash=options.md,mgf=options.mgf,hLen=hash.digestLength,salt_=options.salt||null;"string"==typeof salt_&&(salt_=forge.util.createBuffer(salt_));var sLen;if("saltLength"in options)sLen=options.saltLength;else{if(null===salt_)throw new Error("Salt length not specified or specific salt not given.");sLen=salt_.length()}if(null!==salt_&&salt_.length()!==sLen)throw new Error("Given salt length does not match length of given salt.");var prng=options.prng||forge.random,pssobj={};return pssobj.encode=function(md,modBits){var i,emBits=modBits-1,emLen=Math.ceil(emBits/8),mHash=md.digest().getBytes();if(emLen<hLen+sLen+2)throw new Error("Message is too long to encrypt.");var salt;salt=null===salt_?prng.getBytesSync(sLen):salt_.bytes();var m_=new forge.util.ByteBuffer;m_.fillWithByte(0,8),m_.putBytes(mHash),m_.putBytes(salt),hash.start(),hash.update(m_.getBytes());var h=hash.digest().getBytes(),ps=new forge.util.ByteBuffer;ps.fillWithByte(0,emLen-sLen-hLen-2),ps.putByte(1),ps.putBytes(salt);var db=ps.getBytes(),maskLen=emLen-hLen-1,dbMask=mgf.generate(h,maskLen),maskedDB="";for(i=0;i<maskLen;i++)maskedDB+=String.fromCharCode(db.charCodeAt(i)^dbMask.charCodeAt(i));var mask=65280>>8*emLen-emBits&255;return maskedDB=String.fromCharCode(maskedDB.charCodeAt(0)&~mask)+maskedDB.substr(1),maskedDB+h+String.fromCharCode(188)},pssobj.verify=function(mHash,em,modBits){var i,emBits=modBits-1,emLen=Math.ceil(emBits/8);if(em=em.substr(-emLen),emLen<hLen+sLen+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==em.charCodeAt(emLen-1))throw new Error("Encoded message does not end in 0xBC.");var maskLen=emLen-hLen-1,maskedDB=em.substr(0,maskLen),h=em.substr(maskLen,hLen),mask=65280>>8*emLen-emBits&255;if(0!==(maskedDB.charCodeAt(0)&mask))throw new Error("Bits beyond keysize not zero as expected.");var dbMask=mgf.generate(h,maskLen),db="";for(i=0;i<maskLen;i++)db+=String.fromCharCode(maskedDB.charCodeAt(i)^dbMask.charCodeAt(i));db=String.fromCharCode(db.charCodeAt(0)&~mask)+db.substr(1);var checkLen=emLen-hLen-sLen-2;for(i=0;i<checkLen;i++)if(0!==db.charCodeAt(i))throw new Error("Leftmost octets not zero as expected");if(1!==db.charCodeAt(checkLen))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var salt=db.substr(-sLen),m_=new forge.util.ByteBuffer;m_.fillWithByte(0,8),m_.putBytes(mHash),m_.putBytes(salt),hash.start(),hash.update(m_.getBytes());var h_=hash.digest().getBytes();return h===h_},pssobj}}var name="pss";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pss",["require","module","./random","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){function _getAttribute(obj,options){"string"==typeof options&&(options={shortName:options});for(var attr,rval=null,i=0;null===rval&&i<obj.attributes.length;++i)attr=obj.attributes[i],options.type&&options.type===attr.type?rval=attr:options.name&&options.name===attr.name?rval=attr:options.shortName&&options.shortName===attr.shortName&&(rval=attr);
return rval}function _dnToAsn1(obj){for(var attr,set,rval=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[]),attrs=obj.attributes,i=0;i<attrs.length;++i){attr=attrs[i];var value=attr.value,valueTagClass=asn1.Type.PRINTABLESTRING;"valueTagClass"in attr&&(valueTagClass=attr.valueTagClass,valueTagClass===asn1.Type.UTF8&&(value=forge.util.encodeUtf8(value))),set=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SET,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(attr.type).getBytes()),asn1.create(asn1.Class.UNIVERSAL,valueTagClass,!1,value)])]),rval.value.push(set)}return rval}function _fillMissingFields(attrs){for(var attr,i=0;i<attrs.length;++i){if(attr=attrs[i],"undefined"==typeof attr.name&&(attr.type&&attr.type in pki.oids?attr.name=pki.oids[attr.type]:attr.shortName&&attr.shortName in _shortNames&&(attr.name=pki.oids[_shortNames[attr.shortName]])),"undefined"==typeof attr.type){if(!(attr.name&&attr.name in pki.oids)){var error=new Error("Attribute type not specified.");throw error.attribute=attr,error}attr.type=pki.oids[attr.name]}if("undefined"==typeof attr.shortName&&attr.name&&attr.name in _shortNames&&(attr.shortName=_shortNames[attr.name]),attr.type===oids.extensionRequest&&(attr.valueConstructed=!0,attr.valueTagClass=asn1.Type.SEQUENCE,!attr.value&&attr.extensions)){attr.value=[];for(var ei=0;ei<attr.extensions.length;++ei)attr.value.push(pki.certificateExtensionToAsn1(_fillMissingExtensionFields(attr.extensions[ei])))}if("undefined"==typeof attr.value){var error=new Error("Attribute value not specified.");throw error.attribute=attr,error}}}function _fillMissingExtensionFields(e,options){if(options=options||{},"undefined"==typeof e.name&&e.id&&e.id in pki.oids&&(e.name=pki.oids[e.id]),"undefined"==typeof e.id){if(!(e.name&&e.name in pki.oids)){var error=new Error("Extension ID not specified.");throw error.extension=e,error}e.id=pki.oids[e.name]}if("undefined"==typeof e.value){if("keyUsage"===e.name){var unused=0,b2=0,b3=0;e.digitalSignature&&(b2|=128,unused=7),e.nonRepudiation&&(b2|=64,unused=6),e.keyEncipherment&&(b2|=32,unused=5),e.dataEncipherment&&(b2|=16,unused=4),e.keyAgreement&&(b2|=8,unused=3),e.keyCertSign&&(b2|=4,unused=2),e.cRLSign&&(b2|=2,unused=1),e.encipherOnly&&(b2|=1,unused=0),e.decipherOnly&&(b3|=128,unused=7);var value=String.fromCharCode(unused);0!==b3?value+=String.fromCharCode(b2)+String.fromCharCode(b3):0!==b2&&(value+=String.fromCharCode(b2)),e.value=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.BITSTRING,!1,value)}else if("basicConstraints"===e.name)e.value=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[]),e.cA&&e.value.value.push(asn1.create(asn1.Class.UNIVERSAL,asn1.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in e&&e.value.value.push(asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,asn1.integerToDer(e.pathLenConstraint).getBytes()));else if("extKeyUsage"===e.name){e.value=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[]);var seq=e.value.value;for(var key in e)e[key]===!0&&(key in oids?seq.push(asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(oids[key]).getBytes())):key.indexOf(".")!==-1&&seq.push(asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(key).getBytes())))}else if("nsCertType"===e.name){var unused=0,b2=0;e.client&&(b2|=128,unused=7),e.server&&(b2|=64,unused=6),e.email&&(b2|=32,unused=5),e.objsign&&(b2|=16,unused=4),e.reserved&&(b2|=8,unused=3),e.sslCA&&(b2|=4,unused=2),e.emailCA&&(b2|=2,unused=1),e.objCA&&(b2|=1,unused=0);var value=String.fromCharCode(unused);0!==b2&&(value+=String.fromCharCode(b2)),e.value=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.BITSTRING,!1,value)}else if("subjectAltName"===e.name||"issuerAltName"===e.name){e.value=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[]);for(var altName,n=0;n<e.altNames.length;++n){altName=e.altNames[n];var value=altName.value;if(7===altName.type&&altName.ip){if(value=forge.util.bytesFromIP(altName.ip),null===value){var error=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw error.extension=e,error}}else 8===altName.type&&(value=altName.oid?asn1.oidToDer(asn1.oidToDer(altName.oid)):asn1.oidToDer(value));e.value.value.push(asn1.create(asn1.Class.CONTEXT_SPECIFIC,altName.type,!1,value))}}else if("subjectKeyIdentifier"===e.name&&options.cert){var ski=options.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=ski.toHex(),e.value=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,ski.getBytes())}if("undefined"==typeof e.value){var error=new Error("Extension value not specified.");throw error.extension=e,error}return e}}function _signatureParametersToAsn1(oid,params){switch(oid){case oids["RSASSA-PSS"]:var parts=[];return void 0!==params.hash.algorithmOid&&parts.push(asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(params.hash.algorithmOid).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.NULL,!1,"")])])),void 0!==params.mgf.algorithmOid&&parts.push(asn1.create(asn1.Class.CONTEXT_SPECIFIC,1,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(params.mgf.algorithmOid).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(params.mgf.hash.algorithmOid).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.NULL,!1,"")])])])),void 0!==params.saltLength&&parts.push(asn1.create(asn1.Class.CONTEXT_SPECIFIC,2,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,asn1.integerToDer(params.saltLength).getBytes())])),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,parts);default:return asn1.create(asn1.Class.UNIVERSAL,asn1.Type.NULL,!1,"")}}function _CRIAttributesToAsn1(csr){var rval=asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===csr.attributes.length)return rval;for(var attrs=csr.attributes,i=0;i<attrs.length;++i){var attr=attrs[i],value=attr.value,valueTagClass=asn1.Type.UTF8;"valueTagClass"in attr&&(valueTagClass=attr.valueTagClass),valueTagClass===asn1.Type.UTF8&&(value=forge.util.encodeUtf8(value));var valueConstructed=!1;"valueConstructed"in attr&&(valueConstructed=attr.valueConstructed);var seq=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(attr.type).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SET,!0,[asn1.create(asn1.Class.UNIVERSAL,valueTagClass,valueConstructed,value)])]);rval.value.push(seq)}return rval}var asn1=forge.asn1,pki=forge.pki=forge.pki||{},oids=pki.oids,_shortNames={};_shortNames.CN=oids.commonName,_shortNames.commonName="CN",_shortNames.C=oids.countryName,_shortNames.countryName="C",_shortNames.L=oids.localityName,_shortNames.localityName="L",_shortNames.ST=oids.stateOrProvinceName,_shortNames.stateOrProvinceName="ST",_shortNames.O=oids.organizationName,_shortNames.organizationName="O",_shortNames.OU=oids.organizationalUnitName,_shortNames.organizationalUnitName="OU",_shortNames.E=oids.emailAddress,_shortNames.emailAddress="E";var publicKeyValidator=forge.pki.rsa.publicKeyValidator,x509CertificateValidator={name:"Certificate",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:asn1.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:asn1.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},publicKeyValidator,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:asn1.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.BITSTRING,constructed:!1,capture:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:asn1.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.BITSTRING,constructed:!1,capture:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:asn1.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:asn1.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.BITSTRING,constructed:!1,capture:"certSignature"}]},rsassaPssParameterValidator={name:"rsapss",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:asn1.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:asn1.Class.UNIVERSAL,type:asn1.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:asn1.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:asn1.Class.UNIVERSAL,type:asn1.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:asn1.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:asn1.Class.UNIVERSAL,type:asn1.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:asn1.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:asn1.Class.UNIVERSAL,type:asn1.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},certificationRequestInfoValidator={name:"CertificationRequestInfo",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},publicKeyValidator,{name:"CertificationRequestInfo.attributes",tagClass:asn1.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SET,constructed:!0}]}]}]},certificationRequestValidator={name:"CertificationRequest",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[certificationRequestInfoValidator,{name:"CertificationRequest.signatureAlgorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:asn1.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.BITSTRING,constructed:!1,capture:"csrSignature"}]};pki.RDNAttributesAsArray=function(rdn,md){for(var set,attr,obj,rval=[],si=0;si<rdn.value.length;++si){set=rdn.value[si];for(var i=0;i<set.value.length;++i)obj={},attr=set.value[i],obj.type=asn1.derToOid(attr.value[0].value),obj.value=attr.value[1].value,obj.valueTagClass=attr.value[1].type,obj.type in oids&&(obj.name=oids[obj.type],obj.name in _shortNames&&(obj.shortName=_shortNames[obj.name])),md&&(md.update(obj.type),md.update(obj.value)),rval.push(obj)}return rval},pki.CRIAttributesAsArray=function(attributes){for(var rval=[],si=0;si<attributes.length;++si)for(var seq=attributes[si],type=asn1.derToOid(seq.value[0].value),values=seq.value[1].value,vi=0;vi<values.length;++vi){var obj={};if(obj.type=type,obj.value=values[vi].value,obj.valueTagClass=values[vi].type,obj.type in oids&&(obj.name=oids[obj.type],obj.name in _shortNames&&(obj.shortName=_shortNames[obj.name])),obj.type===oids.extensionRequest){obj.extensions=[];for(var ei=0;ei<obj.value.length;++ei)obj.extensions.push(pki.certificateExtensionFromAsn1(obj.value[ei]))}rval.push(obj)}return rval};var _readSignatureParameters=function(oid,obj,fillDefaults){var params={};if(oid!==oids["RSASSA-PSS"])return params;fillDefaults&&(params={hash:{algorithmOid:oids.sha1},mgf:{algorithmOid:oids.mgf1,hash:{algorithmOid:oids.sha1}},saltLength:20});var capture={},errors=[];if(!asn1.validate(obj,rsassaPssParameterValidator,capture,errors)){var error=new Error("Cannot read RSASSA-PSS parameter block.");throw error.errors=errors,error}return void 0!==capture.hashOid&&(params.hash=params.hash||{},params.hash.algorithmOid=asn1.derToOid(capture.hashOid)),void 0!==capture.maskGenOid&&(params.mgf=params.mgf||{},params.mgf.algorithmOid=asn1.derToOid(capture.maskGenOid),params.mgf.hash=params.mgf.hash||{},params.mgf.hash.algorithmOid=asn1.derToOid(capture.maskGenHashOid)),void 0!==capture.saltLength&&(params.saltLength=capture.saltLength.charCodeAt(0)),params};pki.certificateFromPem=function(pem,computeHash,strict){var msg=forge.pem.decode(pem)[0];if("CERTIFICATE"!==msg.type&&"X509 CERTIFICATE"!==msg.type&&"TRUSTED CERTIFICATE"!==msg.type){var error=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw error.headerType=msg.type,error}if(msg.procType&&"ENCRYPTED"===msg.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var obj=asn1.fromDer(msg.body,strict);return pki.certificateFromAsn1(obj,computeHash)},pki.certificateToPem=function(cert,maxline){var msg={type:"CERTIFICATE",body:asn1.toDer(pki.certificateToAsn1(cert)).getBytes()};return forge.pem.encode(msg,{maxline:maxline})},pki.publicKeyFromPem=function(pem){var msg=forge.pem.decode(pem)[0];if("PUBLIC KEY"!==msg.type&&"RSA PUBLIC KEY"!==msg.type){var error=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw error.headerType=msg.type,error}if(msg.procType&&"ENCRYPTED"===msg.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var obj=asn1.fromDer(msg.body);return pki.publicKeyFromAsn1(obj)},pki.publicKeyToPem=function(key,maxline){var msg={type:"PUBLIC KEY",body:asn1.toDer(pki.publicKeyToAsn1(key)).getBytes()};return forge.pem.encode(msg,{maxline:maxline})},pki.publicKeyToRSAPublicKeyPem=function(key,maxline){var msg={type:"RSA PUBLIC KEY",body:asn1.toDer(pki.publicKeyToRSAPublicKey(key)).getBytes()};return forge.pem.encode(msg,{maxline:maxline})},pki.getPublicKeyFingerprint=function(key,options){options=options||{};var bytes,md=options.md||forge.md.sha1.create(),type=options.type||"RSAPublicKey";switch(type){case"RSAPublicKey":bytes=asn1.toDer(pki.publicKeyToRSAPublicKey(key)).getBytes();break;case"SubjectPublicKeyInfo":bytes=asn1.toDer(pki.publicKeyToAsn1(key)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+options.type+'".')}md.start(),md.update(bytes);var digest=md.digest();if("hex"===options.encoding){var hex=digest.toHex();return options.delimiter?hex.match(/.{2}/g).join(options.delimiter):hex}if("binary"===options.encoding)return digest.getBytes();if(options.encoding)throw new Error('Unknown encoding "'+options.encoding+'".');return digest},pki.certificationRequestFromPem=function(pem,computeHash,strict){var msg=forge.pem.decode(pem)[0];if("CERTIFICATE REQUEST"!==msg.type){var error=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw error.headerType=msg.type,error}if(msg.procType&&"ENCRYPTED"===msg.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var obj=asn1.fromDer(msg.body,strict);return pki.certificationRequestFromAsn1(obj,computeHash)},pki.certificationRequestToPem=function(csr,maxline){var msg={type:"CERTIFICATE REQUEST",body:asn1.toDer(pki.certificationRequestToAsn1(csr)).getBytes()};return forge.pem.encode(msg,{maxline:maxline})},pki.createCertificate=function(){var cert={};return cert.version=2,cert.serialNumber="00",cert.signatureOid=null,cert.signature=null,cert.siginfo={},cert.siginfo.algorithmOid=null,cert.validity={},cert.validity.notBefore=new Date,cert.validity.notAfter=new Date,cert.issuer={},cert.issuer.getField=function(sn){return _getAttribute(cert.issuer,sn)},cert.issuer.addField=function(attr){_fillMissingFields([attr]),cert.issuer.attributes.push(attr)},cert.issuer.attributes=[],cert.issuer.hash=null,cert.subject={},cert.subject.getField=function(sn){return _getAttribute(cert.subject,sn)},cert.subject.addField=function(attr){_fillMissingFields([attr]),cert.subject.attributes.push(attr)},cert.subject.attributes=[],cert.subject.hash=null,cert.extensions=[],cert.publicKey=null,cert.md=null,cert.setSubject=function(attrs,uniqueId){_fillMissingFields(attrs),cert.subject.attributes=attrs,delete cert.subject.uniqueId,uniqueId&&(cert.subject.uniqueId=uniqueId),cert.subject.hash=null},cert.setIssuer=function(attrs,uniqueId){_fillMissingFields(attrs),cert.issuer.attributes=attrs,delete cert.issuer.uniqueId,uniqueId&&(cert.issuer.uniqueId=uniqueId),cert.issuer.hash=null},cert.setExtensions=function(exts){for(var i=0;i<exts.length;++i)_fillMissingExtensionFields(exts[i],{cert:cert});cert.extensions=exts},cert.getExtension=function(options){"string"==typeof options&&(options={name:options});for(var ext,rval=null,i=0;null===rval&&i<cert.extensions.length;++i)ext=cert.extensions[i],options.id&&ext.id===options.id?rval=ext:options.name&&ext.name===options.name&&(rval=ext);return rval},cert.sign=function(key,md){cert.md=md||forge.md.sha1.create();var algorithmOid=oids[cert.md.algorithm+"WithRSAEncryption"];if(!algorithmOid){var error=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw error.algorithm=cert.md.algorithm,error}cert.signatureOid=cert.siginfo.algorithmOid=algorithmOid,cert.tbsCertificate=pki.getTBSCertificate(cert);var bytes=asn1.toDer(cert.tbsCertificate);cert.md.update(bytes.getBytes()),cert.signature=key.sign(cert.md)},cert.verify=function(child){var rval=!1;if(!cert.issued(child)){var issuer=child.issuer,subject=cert.subject,error=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw error.expectedIssuer=issuer.attributes,error.actualIssuer=subject.attributes,error}var md=child.md;if(null===md){if(child.signatureOid in oids){var oid=oids[child.signatureOid];switch(oid){case"sha1WithRSAEncryption":md=forge.md.sha1.create();break;case"md5WithRSAEncryption":md=forge.md.md5.create();break;case"sha256WithRSAEncryption":md=forge.md.sha256.create();break;case"RSASSA-PSS":md=forge.md.sha256.create()}}if(null===md){var error=new Error("Could not compute certificate digest. Unknown signature OID.");throw error.signatureOid=child.signatureOid,error}var tbsCertificate=child.tbsCertificate||pki.getTBSCertificate(child),bytes=asn1.toDer(tbsCertificate);md.update(bytes.getBytes())}if(null!==md){var scheme;switch(child.signatureOid){case oids.sha1WithRSAEncryption:scheme=void 0;break;case oids["RSASSA-PSS"]:var hash,mgf;if(hash=oids[child.signatureParameters.mgf.hash.algorithmOid],void 0===hash||void 0===forge.md[hash]){var error=new Error("Unsupported MGF hash function.");throw error.oid=child.signatureParameters.mgf.hash.algorithmOid,error.name=hash,error}if(mgf=oids[child.signatureParameters.mgf.algorithmOid],void 0===mgf||void 0===forge.mgf[mgf]){var error=new Error("Unsupported MGF function.");throw error.oid=child.signatureParameters.mgf.algorithmOid,error.name=mgf,error}if(mgf=forge.mgf[mgf].create(forge.md[hash].create()),hash=oids[child.signatureParameters.hash.algorithmOid],void 0===hash||void 0===forge.md[hash])throw{message:"Unsupported RSASSA-PSS hash function.",oid:child.signatureParameters.hash.algorithmOid,name:hash};scheme=forge.pss.create(forge.md[hash].create(),mgf,child.signatureParameters.saltLength)}rval=cert.publicKey.verify(md.digest().getBytes(),child.signature,scheme)}return rval},cert.isIssuer=function(parent){var rval=!1,i=cert.issuer,s=parent.subject;if(i.hash&&s.hash)rval=i.hash===s.hash;else if(i.attributes.length===s.attributes.length){rval=!0;for(var iattr,sattr,n=0;rval&&n<i.attributes.length;++n)iattr=i.attributes[n],sattr=s.attributes[n],iattr.type===sattr.type&&iattr.value===sattr.value||(rval=!1)}return rval},cert.issued=function(child){return child.isIssuer(cert)},cert.generateSubjectKeyIdentifier=function(){return pki.getPublicKeyFingerprint(cert.publicKey,{type:"RSAPublicKey"})},cert.verifySubjectKeyIdentifier=function(){for(var oid=oids.subjectKeyIdentifier,i=0;i<cert.extensions.length;++i){var ext=cert.extensions[i];if(ext.id===oid){var ski=cert.generateSubjectKeyIdentifier().getBytes();return forge.util.hexToBytes(ext.subjectKeyIdentifier)===ski}}return!1},cert},pki.certificateFromAsn1=function(obj,computeHash){var capture={},errors=[];if(!asn1.validate(obj,x509CertificateValidator,capture,errors)){var error=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw error.errors=errors,error}if("string"!=typeof capture.certSignature){for(var certSignature="\0",i=0;i<capture.certSignature.length;++i)certSignature+=asn1.toDer(capture.certSignature[i]).getBytes();capture.certSignature=certSignature}var oid=asn1.derToOid(capture.publicKeyOid);if(oid!==pki.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var cert=pki.createCertificate();cert.version=capture.certVersion?capture.certVersion.charCodeAt(0):0;var serial=forge.util.createBuffer(capture.certSerialNumber);cert.serialNumber=serial.toHex(),cert.signatureOid=forge.asn1.derToOid(capture.certSignatureOid),cert.signatureParameters=_readSignatureParameters(cert.signatureOid,capture.certSignatureParams,!0),cert.siginfo.algorithmOid=forge.asn1.derToOid(capture.certinfoSignatureOid),cert.siginfo.parameters=_readSignatureParameters(cert.siginfo.algorithmOid,capture.certinfoSignatureParams,!1);var signature=forge.util.createBuffer(capture.certSignature);++signature.read,cert.signature=signature.getBytes();var validity=[];if(void 0!==capture.certValidity1UTCTime&&validity.push(asn1.utcTimeToDate(capture.certValidity1UTCTime)),void 0!==capture.certValidity2GeneralizedTime&&validity.push(asn1.generalizedTimeToDate(capture.certValidity2GeneralizedTime)),void 0!==capture.certValidity3UTCTime&&validity.push(asn1.utcTimeToDate(capture.certValidity3UTCTime)),void 0!==capture.certValidity4GeneralizedTime&&validity.push(asn1.generalizedTimeToDate(capture.certValidity4GeneralizedTime)),validity.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(validity.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(cert.validity.notBefore=validity[0],cert.validity.notAfter=validity[1],cert.tbsCertificate=capture.tbsCertificate,computeHash){if(cert.md=null,cert.signatureOid in oids){var oid=oids[cert.signatureOid];switch(oid){case"sha1WithRSAEncryption":cert.md=forge.md.sha1.create();break;case"md5WithRSAEncryption":cert.md=forge.md.md5.create();break;case"sha256WithRSAEncryption":cert.md=forge.md.sha256.create();break;case"RSASSA-PSS":cert.md=forge.md.sha256.create()}}if(null===cert.md){var error=new Error("Could not compute certificate digest. Unknown signature OID.");throw error.signatureOid=cert.signatureOid,error}var bytes=asn1.toDer(cert.tbsCertificate);cert.md.update(bytes.getBytes())}var imd=forge.md.sha1.create();cert.issuer.getField=function(sn){return _getAttribute(cert.issuer,sn)},cert.issuer.addField=function(attr){_fillMissingFields([attr]),cert.issuer.attributes.push(attr)},cert.issuer.attributes=pki.RDNAttributesAsArray(capture.certIssuer,imd),capture.certIssuerUniqueId&&(cert.issuer.uniqueId=capture.certIssuerUniqueId),cert.issuer.hash=imd.digest().toHex();var smd=forge.md.sha1.create();return cert.subject.getField=function(sn){return _getAttribute(cert.subject,sn)},cert.subject.addField=function(attr){_fillMissingFields([attr]),cert.subject.attributes.push(attr)},cert.subject.attributes=pki.RDNAttributesAsArray(capture.certSubject,smd),capture.certSubjectUniqueId&&(cert.subject.uniqueId=capture.certSubjectUniqueId),cert.subject.hash=smd.digest().toHex(),capture.certExtensions?cert.extensions=pki.certificateExtensionsFromAsn1(capture.certExtensions):cert.extensions=[],cert.publicKey=pki.publicKeyFromAsn1(capture.subjectPublicKeyInfo),cert},pki.certificateExtensionsFromAsn1=function(exts){for(var rval=[],i=0;i<exts.value.length;++i)for(var extseq=exts.value[i],ei=0;ei<extseq.value.length;++ei)rval.push(pki.certificateExtensionFromAsn1(extseq.value[ei]));return rval},pki.certificateExtensionFromAsn1=function(ext){var e={};if(e.id=asn1.derToOid(ext.value[0].value),e.critical=!1,ext.value[1].type===asn1.Type.BOOLEAN?(e.critical=0!==ext.value[1].value.charCodeAt(0),e.value=ext.value[2].value):e.value=ext.value[1].value,e.id in oids)if(e.name=oids[e.id],"keyUsage"===e.name){var ev=asn1.fromDer(e.value),b2=0,b3=0;ev.value.length>1&&(b2=ev.value.charCodeAt(1),b3=ev.value.length>2?ev.value.charCodeAt(2):0),e.digitalSignature=128===(128&b2),e.nonRepudiation=64===(64&b2),e.keyEncipherment=32===(32&b2),e.dataEncipherment=16===(16&b2),e.keyAgreement=8===(8&b2),e.keyCertSign=4===(4&b2),e.cRLSign=2===(2&b2),e.encipherOnly=1===(1&b2),e.decipherOnly=128===(128&b3)}else if("basicConstraints"===e.name){var ev=asn1.fromDer(e.value);ev.value.length>0&&ev.value[0].type===asn1.Type.BOOLEAN?e.cA=0!==ev.value[0].value.charCodeAt(0):e.cA=!1;var value=null;ev.value.length>0&&ev.value[0].type===asn1.Type.INTEGER?value=ev.value[0].value:ev.value.length>1&&(value=ev.value[1].value),null!==value&&(e.pathLenConstraint=asn1.derToInteger(value))}else if("extKeyUsage"===e.name)for(var ev=asn1.fromDer(e.value),vi=0;vi<ev.value.length;++vi){var oid=asn1.derToOid(ev.value[vi].value);oid in oids?e[oids[oid]]=!0:e[oid]=!0}else if("nsCertType"===e.name){var ev=asn1.fromDer(e.value),b2=0;ev.value.length>1&&(b2=ev.value.charCodeAt(1)),e.client=128===(128&b2),e.server=64===(64&b2),e.email=32===(32&b2),e.objsign=16===(16&b2),e.reserved=8===(8&b2),e.sslCA=4===(4&b2),e.emailCA=2===(2&b2),e.objCA=1===(1&b2)}else if("subjectAltName"===e.name||"issuerAltName"===e.name){e.altNames=[];for(var gn,ev=asn1.fromDer(e.value),n=0;n<ev.value.length;++n){gn=ev.value[n];var altName={type:gn.type,value:gn.value};switch(e.altNames.push(altName),gn.type){case 1:case 2:case 6:break;case 7:altName.ip=forge.util.bytesToIP(gn.value);break;case 8:altName.oid=asn1.derToOid(gn.value)}}}else if("subjectKeyIdentifier"===e.name){var ev=asn1.fromDer(e.value);e.subjectKeyIdentifier=forge.util.bytesToHex(ev.value)}return e},pki.certificationRequestFromAsn1=function(obj,computeHash){var capture={},errors=[];if(!asn1.validate(obj,certificationRequestValidator,capture,errors)){var error=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw error.errors=errors,error}if("string"!=typeof capture.csrSignature){for(var csrSignature="\0",i=0;i<capture.csrSignature.length;++i)csrSignature+=asn1.toDer(capture.csrSignature[i]).getBytes();capture.csrSignature=csrSignature}var oid=asn1.derToOid(capture.publicKeyOid);if(oid!==pki.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var csr=pki.createCertificationRequest();csr.version=capture.csrVersion?capture.csrVersion.charCodeAt(0):0,csr.signatureOid=forge.asn1.derToOid(capture.csrSignatureOid),csr.signatureParameters=_readSignatureParameters(csr.signatureOid,capture.csrSignatureParams,!0),csr.siginfo.algorithmOid=forge.asn1.derToOid(capture.csrSignatureOid),csr.siginfo.parameters=_readSignatureParameters(csr.siginfo.algorithmOid,capture.csrSignatureParams,!1);var signature=forge.util.createBuffer(capture.csrSignature);if(++signature.read,csr.signature=signature.getBytes(),csr.certificationRequestInfo=capture.certificationRequestInfo,computeHash){if(csr.md=null,csr.signatureOid in oids){var oid=oids[csr.signatureOid];switch(oid){case"sha1WithRSAEncryption":csr.md=forge.md.sha1.create();break;case"md5WithRSAEncryption":csr.md=forge.md.md5.create();break;case"sha256WithRSAEncryption":csr.md=forge.md.sha256.create();break;case"RSASSA-PSS":csr.md=forge.md.sha256.create()}}if(null===csr.md){var error=new Error("Could not compute certification request digest. Unknown signature OID.");throw error.signatureOid=csr.signatureOid,error}var bytes=asn1.toDer(csr.certificationRequestInfo);csr.md.update(bytes.getBytes())}var smd=forge.md.sha1.create();return csr.subject.getField=function(sn){return _getAttribute(csr.subject,sn)},csr.subject.addField=function(attr){_fillMissingFields([attr]),csr.subject.attributes.push(attr);
},csr.subject.attributes=pki.RDNAttributesAsArray(capture.certificationRequestInfoSubject,smd),csr.subject.hash=smd.digest().toHex(),csr.publicKey=pki.publicKeyFromAsn1(capture.subjectPublicKeyInfo),csr.getAttribute=function(sn){return _getAttribute(csr,sn)},csr.addAttribute=function(attr){_fillMissingFields([attr]),csr.attributes.push(attr)},csr.attributes=pki.CRIAttributesAsArray(capture.certificationRequestInfoAttributes||[]),csr},pki.createCertificationRequest=function(){var csr={};return csr.version=0,csr.signatureOid=null,csr.signature=null,csr.siginfo={},csr.siginfo.algorithmOid=null,csr.subject={},csr.subject.getField=function(sn){return _getAttribute(csr.subject,sn)},csr.subject.addField=function(attr){_fillMissingFields([attr]),csr.subject.attributes.push(attr)},csr.subject.attributes=[],csr.subject.hash=null,csr.publicKey=null,csr.attributes=[],csr.getAttribute=function(sn){return _getAttribute(csr,sn)},csr.addAttribute=function(attr){_fillMissingFields([attr]),csr.attributes.push(attr)},csr.md=null,csr.setSubject=function(attrs){_fillMissingFields(attrs),csr.subject.attributes=attrs,csr.subject.hash=null},csr.setAttributes=function(attrs){_fillMissingFields(attrs),csr.attributes=attrs},csr.sign=function(key,md){csr.md=md||forge.md.sha1.create();var algorithmOid=oids[csr.md.algorithm+"WithRSAEncryption"];if(!algorithmOid){var error=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw error.algorithm=csr.md.algorithm,error}csr.signatureOid=csr.siginfo.algorithmOid=algorithmOid,csr.certificationRequestInfo=pki.getCertificationRequestInfo(csr);var bytes=asn1.toDer(csr.certificationRequestInfo);csr.md.update(bytes.getBytes()),csr.signature=key.sign(csr.md)},csr.verify=function(){var rval=!1,md=csr.md;if(null===md){if(csr.signatureOid in oids){var oid=oids[csr.signatureOid];switch(oid){case"sha1WithRSAEncryption":md=forge.md.sha1.create();break;case"md5WithRSAEncryption":md=forge.md.md5.create();break;case"sha256WithRSAEncryption":md=forge.md.sha256.create();break;case"RSASSA-PSS":md=forge.md.sha256.create()}}if(null===md){var error=new Error("Could not compute certification request digest. Unknown signature OID.");throw error.signatureOid=csr.signatureOid,error}var cri=csr.certificationRequestInfo||pki.getCertificationRequestInfo(csr),bytes=asn1.toDer(cri);md.update(bytes.getBytes())}if(null!==md){var scheme;switch(csr.signatureOid){case oids.sha1WithRSAEncryption:break;case oids["RSASSA-PSS"]:var hash,mgf;if(hash=oids[csr.signatureParameters.mgf.hash.algorithmOid],void 0===hash||void 0===forge.md[hash]){var error=new Error("Unsupported MGF hash function.");throw error.oid=csr.signatureParameters.mgf.hash.algorithmOid,error.name=hash,error}if(mgf=oids[csr.signatureParameters.mgf.algorithmOid],void 0===mgf||void 0===forge.mgf[mgf]){var error=new Error("Unsupported MGF function.");throw error.oid=csr.signatureParameters.mgf.algorithmOid,error.name=mgf,error}if(mgf=forge.mgf[mgf].create(forge.md[hash].create()),hash=oids[csr.signatureParameters.hash.algorithmOid],void 0===hash||void 0===forge.md[hash]){var error=new Error("Unsupported RSASSA-PSS hash function.");throw error.oid=csr.signatureParameters.hash.algorithmOid,error.name=hash,error}scheme=forge.pss.create(forge.md[hash].create(),mgf,csr.signatureParameters.saltLength)}rval=csr.publicKey.verify(md.digest().getBytes(),csr.signature,scheme)}return rval},csr},pki.getTBSCertificate=function(cert){var tbs=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,asn1.integerToDer(cert.version).getBytes())]),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,forge.util.hexToBytes(cert.serialNumber)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(cert.siginfo.algorithmOid).getBytes()),_signatureParametersToAsn1(cert.siginfo.algorithmOid,cert.siginfo.parameters)]),_dnToAsn1(cert.issuer),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.UTCTIME,!1,asn1.dateToUtcTime(cert.validity.notBefore)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.UTCTIME,!1,asn1.dateToUtcTime(cert.validity.notAfter))]),_dnToAsn1(cert.subject),pki.publicKeyToAsn1(cert.publicKey)]);return cert.issuer.uniqueId&&tbs.value.push(asn1.create(asn1.Class.CONTEXT_SPECIFIC,1,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.BITSTRING,!1,String.fromCharCode(0)+cert.issuer.uniqueId)])),cert.subject.uniqueId&&tbs.value.push(asn1.create(asn1.Class.CONTEXT_SPECIFIC,2,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.BITSTRING,!1,String.fromCharCode(0)+cert.subject.uniqueId)])),cert.extensions.length>0&&tbs.value.push(pki.certificateExtensionsToAsn1(cert.extensions)),tbs},pki.getCertificationRequestInfo=function(csr){var cri=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,asn1.integerToDer(csr.version).getBytes()),_dnToAsn1(csr.subject),pki.publicKeyToAsn1(csr.publicKey),_CRIAttributesToAsn1(csr)]);return cri},pki.distinguishedNameToAsn1=function(dn){return _dnToAsn1(dn)},pki.certificateToAsn1=function(cert){var tbsCertificate=cert.tbsCertificate||pki.getTBSCertificate(cert);return asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[tbsCertificate,asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(cert.signatureOid).getBytes()),_signatureParametersToAsn1(cert.signatureOid,cert.signatureParameters)]),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.BITSTRING,!1,String.fromCharCode(0)+cert.signature)])},pki.certificateExtensionsToAsn1=function(exts){var rval=asn1.create(asn1.Class.CONTEXT_SPECIFIC,3,!0,[]),seq=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[]);rval.value.push(seq);for(var i=0;i<exts.length;++i)seq.value.push(pki.certificateExtensionToAsn1(exts[i]));return rval},pki.certificateExtensionToAsn1=function(ext){var extseq=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[]);extseq.value.push(asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(ext.id).getBytes())),ext.critical&&extseq.value.push(asn1.create(asn1.Class.UNIVERSAL,asn1.Type.BOOLEAN,!1,String.fromCharCode(255)));var value=ext.value;return"string"!=typeof ext.value&&(value=asn1.toDer(value).getBytes()),extseq.value.push(asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,value)),extseq},pki.certificationRequestToAsn1=function(csr){var cri=csr.certificationRequestInfo||pki.getCertificationRequestInfo(csr);return asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[cri,asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(csr.signatureOid).getBytes()),_signatureParametersToAsn1(csr.signatureOid,csr.signatureParameters)]),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.BITSTRING,!1,String.fromCharCode(0)+csr.signature)])},pki.createCaStore=function(certs){function getBySubject(subject){if(!subject.hash){var md=forge.md.sha1.create();subject.attributes=pki.RDNAttributesAsArray(_dnToAsn1(subject),md),subject.hash=md.digest().toHex()}return caStore.certs[subject.hash]||null}var caStore={certs:{}};if(caStore.getIssuer=function(cert){var rval=getBySubject(cert.issuer);return rval},caStore.addCertificate=function(cert){if("string"==typeof cert&&(cert=forge.pki.certificateFromPem(cert)),!cert.subject.hash){var md=forge.md.sha1.create();cert.subject.attributes=pki.RDNAttributesAsArray(_dnToAsn1(cert.subject),md),cert.subject.hash=md.digest().toHex()}if(cert.subject.hash in caStore.certs){var tmp=caStore.certs[cert.subject.hash];forge.util.isArray(tmp)||(tmp=[tmp]),tmp.push(cert)}else caStore.certs[cert.subject.hash]=cert},caStore.hasCertificate=function(cert){var match=getBySubject(cert.subject);if(!match)return!1;forge.util.isArray(match)||(match=[match]);for(var der1=asn1.toDer(pki.certificateToAsn1(cert)).getBytes(),i=0;i<match.length;++i){var der2=asn1.toDer(pki.certificateToAsn1(match[i])).getBytes();if(der1===der2)return!0}return!1},certs)for(var i=0;i<certs.length;++i){var cert=certs[i];caStore.addCertificate(cert)}return caStore},pki.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},pki.verifyCertificateChain=function(caStore,chain,verify){chain=chain.slice(0);var certs=chain.slice(0),now=new Date,first=!0,error=null,depth=0;do{var cert=chain.shift(),parent=null,selfSigned=!1;if((now<cert.validity.notBefore||now>cert.validity.notAfter)&&(error={message:"Certificate is not valid yet or has expired.",error:pki.certificateError.certificate_expired,notBefore:cert.validity.notBefore,notAfter:cert.validity.notAfter,now:now}),null===error){if(parent=chain[0]||caStore.getIssuer(cert),null===parent&&cert.isIssuer(cert)&&(selfSigned=!0,parent=cert),parent){var parents=parent;forge.util.isArray(parents)||(parents=[parents]);for(var verified=!1;!verified&&parents.length>0;){parent=parents.shift();try{verified=parent.verify(cert)}catch(ex){}}verified||(error={message:"Certificate signature is invalid.",error:pki.certificateError.bad_certificate})}null!==error||parent&&!selfSigned||caStore.hasCertificate(cert)||(error={message:"Certificate is not trusted.",error:pki.certificateError.unknown_ca})}if(null===error&&parent&&!cert.isIssuer(parent)&&(error={message:"Certificate issuer is invalid.",error:pki.certificateError.bad_certificate}),null===error)for(var se={keyUsage:!0,basicConstraints:!0},i=0;null===error&&i<cert.extensions.length;++i){var ext=cert.extensions[i];!ext.critical||ext.name in se||(error={message:"Certificate has an unsupported critical extension.",error:pki.certificateError.unsupported_certificate})}if(null===error&&(!first||0===chain.length&&(!parent||selfSigned))){var bcExt=cert.getExtension("basicConstraints"),keyUsageExt=cert.getExtension("keyUsage");if(null!==keyUsageExt&&(keyUsageExt.keyCertSign&&null!==bcExt||(error={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:pki.certificateError.bad_certificate})),null!==error||null===bcExt||bcExt.cA||(error={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:pki.certificateError.bad_certificate}),null===error&&null!==keyUsageExt&&"pathLenConstraint"in bcExt){var pathLen=depth-1;pathLen>bcExt.pathLenConstraint&&(error={message:"Certificate basicConstraints pathLenConstraint violated.",error:pki.certificateError.bad_certificate})}}var vfd=null===error||error.error,ret=verify?verify(vfd,depth,certs):vfd;if(ret!==!0)throw vfd===!0&&(error={message:"The application rejected the certificate.",error:pki.certificateError.bad_certificate}),(ret||0===ret)&&("object"!=typeof ret||forge.util.isArray(ret)?"string"==typeof ret&&(error.error=ret):(ret.message&&(error.message=ret.message),ret.error&&(error.error=ret.error))),error;error=null,first=!1,++depth}while(chain.length>0);return!0}}var name="x509";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge.pki}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/x509",["require","module","./aes","./asn1","./des","./md","./mgf","./oids","./pem","./pss","./rsa","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){function _getBagsByAttribute(safeContents,attrName,attrValue,bagType){for(var result=[],i=0;i<safeContents.length;i++)for(var j=0;j<safeContents[i].safeBags.length;j++){var bag=safeContents[i].safeBags[j];void 0!==bagType&&bag.type!==bagType||(null!==attrName?void 0!==bag.attributes[attrName]&&bag.attributes[attrName].indexOf(attrValue)>=0&&result.push(bag):result.push(bag))}return result}function _decodePkcs7Data(data){if(data.composed||data.constructed){for(var value=forge.util.createBuffer(),i=0;i<data.value.length;++i)value.putBytes(data.value[i].value);data.composed=data.constructed=!1,data.value=value.getBytes()}return data}function _decodeAuthenticatedSafe(pfx,authSafe,strict,password){if(authSafe=asn1.fromDer(authSafe,strict),authSafe.tagClass!==asn1.Class.UNIVERSAL||authSafe.type!==asn1.Type.SEQUENCE||authSafe.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var i=0;i<authSafe.value.length;i++){var contentInfo=authSafe.value[i],capture={},errors=[];if(!asn1.validate(contentInfo,contentInfoValidator,capture,errors)){var error=new Error("Cannot read ContentInfo.");throw error.errors=errors,error}var obj={encrypted:!1},safeContents=null,data=capture.content.value[0];switch(asn1.derToOid(capture.contentType)){case pki.oids.data:if(data.tagClass!==asn1.Class.UNIVERSAL||data.type!==asn1.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");safeContents=_decodePkcs7Data(data).value;break;case pki.oids.encryptedData:safeContents=_decryptSafeContents(data,password),obj.encrypted=!0;break;default:var error=new Error("Unsupported PKCS#12 contentType.");throw error.contentType=asn1.derToOid(capture.contentType),error}obj.safeBags=_decodeSafeContents(safeContents,strict,password),pfx.safeContents.push(obj)}}function _decryptSafeContents(data,password){var capture={},errors=[];if(!asn1.validate(data,forge.pkcs7.asn1.encryptedDataValidator,capture,errors)){var error=new Error("Cannot read EncryptedContentInfo.");throw error.errors=errors,error}var oid=asn1.derToOid(capture.contentType);if(oid!==pki.oids.data){var error=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw error.oid=oid,error}oid=asn1.derToOid(capture.encAlgorithm);var cipher=pki.pbe.getCipher(oid,capture.encParameter,password),encryptedContentAsn1=_decodePkcs7Data(capture.encryptedContentAsn1),encrypted=forge.util.createBuffer(encryptedContentAsn1.value);if(cipher.update(encrypted),!cipher.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return cipher.output.getBytes()}function _decodeSafeContents(safeContents,strict,password){if(!strict&&0===safeContents.length)return[];if(safeContents=asn1.fromDer(safeContents,strict),safeContents.tagClass!==asn1.Class.UNIVERSAL||safeContents.type!==asn1.Type.SEQUENCE||safeContents.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var res=[],i=0;i<safeContents.value.length;i++){var safeBag=safeContents.value[i],capture={},errors=[];if(!asn1.validate(safeBag,safeBagValidator,capture,errors)){var error=new Error("Cannot read SafeBag.");throw error.errors=errors,error}var bag={type:asn1.derToOid(capture.bagId),attributes:_decodeBagAttributes(capture.bagAttributes)};res.push(bag);var validator,decoder,bagAsn1=capture.bagValue.value[0];switch(bag.type){case pki.oids.pkcs8ShroudedKeyBag:if(bagAsn1=pki.decryptPrivateKeyInfo(bagAsn1,password),null===bagAsn1)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case pki.oids.keyBag:try{bag.key=pki.privateKeyFromAsn1(bagAsn1)}catch(e){bag.key=null,bag.asn1=bagAsn1}continue;case pki.oids.certBag:validator=certBagValidator,decoder=function(){if(asn1.derToOid(capture.certId)!==pki.oids.x509Certificate){var error=new Error("Unsupported certificate type, only X.509 supported.");throw error.oid=asn1.derToOid(capture.certId),error}var certAsn1=asn1.fromDer(capture.cert,strict);try{bag.cert=pki.certificateFromAsn1(certAsn1,!0)}catch(e){bag.cert=null,bag.asn1=certAsn1}};break;default:var error=new Error("Unsupported PKCS#12 SafeBag type.");throw error.oid=bag.type,error}if(void 0!==validator&&!asn1.validate(bagAsn1,validator,capture,errors)){var error=new Error("Cannot read PKCS#12 "+validator.name);throw error.errors=errors,error}decoder()}return res}function _decodeBagAttributes(attributes){var decodedAttrs={};if(void 0!==attributes)for(var i=0;i<attributes.length;++i){var capture={},errors=[];if(!asn1.validate(attributes[i],attributeValidator,capture,errors)){var error=new Error("Cannot read PKCS#12 BagAttribute.");throw error.errors=errors,error}var oid=asn1.derToOid(capture.oid);if(void 0!==pki.oids[oid]){decodedAttrs[pki.oids[oid]]=[];for(var j=0;j<capture.values.length;++j)decodedAttrs[pki.oids[oid]].push(capture.values[j].value)}}return decodedAttrs}var asn1=forge.asn1,pki=forge.pki,p12=forge.pkcs12=forge.pkcs12||{},contentInfoValidator={name:"ContentInfo",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:asn1.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},pfxValidator={name:"PFX",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"version"},contentInfoValidator,{name:"PFX.macData",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:asn1.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},safeBagValidator={name:"SafeBag",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:asn1.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},attributeValidator={name:"Attribute",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SET,constructed:!0,capture:"values"}]},certBagValidator={name:"CertBag",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:asn1.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:asn1.Class.UNIVERSAL,type:asn1.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};p12.pkcs12FromAsn1=function(obj,strict,password){"string"==typeof strict?(password=strict,strict=!0):void 0===strict&&(strict=!0);var capture={},errors=[];if(!asn1.validate(obj,pfxValidator,capture,errors)){var error=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw error.errors=error,error}var pfx={version:capture.version.charCodeAt(0),safeContents:[],getBags:function(filter){var localKeyId,rval={};return"localKeyId"in filter?localKeyId=filter.localKeyId:"localKeyIdHex"in filter&&(localKeyId=forge.util.hexToBytes(filter.localKeyIdHex)),void 0===localKeyId&&!("friendlyName"in filter)&&"bagType"in filter&&(rval[filter.bagType]=_getBagsByAttribute(pfx.safeContents,null,null,filter.bagType)),void 0!==localKeyId&&(rval.localKeyId=_getBagsByAttribute(pfx.safeContents,"localKeyId",localKeyId,filter.bagType)),"friendlyName"in filter&&(rval.friendlyName=_getBagsByAttribute(pfx.safeContents,"friendlyName",filter.friendlyName,filter.bagType)),rval},getBagsByFriendlyName:function(friendlyName,bagType){return _getBagsByAttribute(pfx.safeContents,"friendlyName",friendlyName,bagType)},getBagsByLocalKeyId:function(localKeyId,bagType){return _getBagsByAttribute(pfx.safeContents,"localKeyId",localKeyId,bagType)}};if(3!==capture.version.charCodeAt(0)){var error=new Error("PKCS#12 PFX of version other than 3 not supported.");throw error.version=capture.version.charCodeAt(0),error}if(asn1.derToOid(capture.contentType)!==pki.oids.data){var error=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw error.oid=asn1.derToOid(capture.contentType),error}var data=capture.content.value[0];if(data.tagClass!==asn1.Class.UNIVERSAL||data.type!==asn1.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(data=_decodePkcs7Data(data),capture.mac){var md=null,macKeyBytes=0,macAlgorithm=asn1.derToOid(capture.macAlgorithm);switch(macAlgorithm){case pki.oids.sha1:md=forge.md.sha1.create(),macKeyBytes=20;break;case pki.oids.sha256:md=forge.md.sha256.create(),macKeyBytes=32;break;case pki.oids.sha384:md=forge.md.sha384.create(),macKeyBytes=48;break;case pki.oids.sha512:md=forge.md.sha512.create(),macKeyBytes=64;break;case pki.oids.md5:md=forge.md.md5.create(),macKeyBytes=16}if(null===md)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+macAlgorithm);var macSalt=new forge.util.ByteBuffer(capture.macSalt),macIterations="macIterations"in capture?parseInt(forge.util.bytesToHex(capture.macIterations),16):1,macKey=p12.generateKey(password,macSalt,3,macIterations,macKeyBytes,md),mac=forge.hmac.create();mac.start(md,macKey),mac.update(data.value);var macValue=mac.getMac();if(macValue.getBytes()!==capture.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return _decodeAuthenticatedSafe(pfx,data.value,strict,password),pfx},p12.toPkcs12Asn1=function(key,cert,password,options){options=options||{},options.saltSize=options.saltSize||8,options.count=options.count||2048,options.algorithm=options.algorithm||options.encAlgorithm||"aes128","useMac"in options||(options.useMac=!0),"localKeyId"in options||(options.localKeyId=null),"generateLocalKeyId"in options||(options.generateLocalKeyId=!0);var bagAttrs,localKeyId=options.localKeyId;if(null!==localKeyId)localKeyId=forge.util.hexToBytes(localKeyId);else if(options.generateLocalKeyId)if(cert){var pairedCert=forge.util.isArray(cert)?cert[0]:cert;"string"==typeof pairedCert&&(pairedCert=pki.certificateFromPem(pairedCert));var sha1=forge.md.sha1.create();sha1.update(asn1.toDer(pki.certificateToAsn1(pairedCert)).getBytes()),localKeyId=sha1.digest().getBytes()}else localKeyId=forge.random.getBytes(20);var attrs=[];null!==localKeyId&&attrs.push(asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(pki.oids.localKeyId).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SET,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,localKeyId)])])),"friendlyName"in options&&attrs.push(asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(pki.oids.friendlyName).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SET,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.BMPSTRING,!1,options.friendlyName)])])),attrs.length>0&&(bagAttrs=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SET,!0,attrs));var contents=[],chain=[];null!==cert&&(chain=forge.util.isArray(cert)?cert:[cert]);for(var certSafeBags=[],i=0;i<chain.length;++i){cert=chain[i],"string"==typeof cert&&(cert=pki.certificateFromPem(cert));var certBagAttrs=0===i?bagAttrs:void 0,certAsn1=pki.certificateToAsn1(cert),certSafeBag=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(pki.oids.certBag).getBytes()),asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(pki.oids.x509Certificate).getBytes()),asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,asn1.toDer(certAsn1).getBytes())])])]),certBagAttrs]);certSafeBags.push(certSafeBag)}if(certSafeBags.length>0){var certSafeContents=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,certSafeBags),certCI=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(pki.oids.data).getBytes()),asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,asn1.toDer(certSafeContents).getBytes())])]);contents.push(certCI)}var keyBag=null;if(null!==key){var pkAsn1=pki.wrapRsaPrivateKey(pki.privateKeyToAsn1(key));keyBag=null===password?asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(pki.oids.keyBag).getBytes()),asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[pkAsn1]),bagAttrs]):asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(pki.oids.pkcs8ShroudedKeyBag).getBytes()),asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[pki.encryptPrivateKeyInfo(pkAsn1,password,options)]),bagAttrs]);var keySafeContents=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[keyBag]),keyCI=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(pki.oids.data).getBytes()),asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,asn1.toDer(keySafeContents).getBytes())])]);contents.push(keyCI)}var macData,safe=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,contents);if(options.useMac){var sha1=forge.md.sha1.create(),macSalt=new forge.util.ByteBuffer(forge.random.getBytes(options.saltSize)),count=options.count,key=p12.generateKey(password,macSalt,3,count,20),mac=forge.hmac.create();mac.start(sha1,key),mac.update(asn1.toDer(safe).getBytes());var macValue=mac.getMac();macData=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(pki.oids.sha1).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.NULL,!1,"")]),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,macValue.getBytes())]),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,macSalt.getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,asn1.integerToDer(count).getBytes())])}return asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,asn1.integerToDer(3).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(pki.oids.data).getBytes()),asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,asn1.toDer(safe).getBytes())])]),macData])},p12.generateKey=forge.pbe.generatePkcs12Key}var name="pkcs12";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs12",["require","module","./asn1","./hmac","./oids","./pkcs7asn1","./pbe","./random","./rsa","./sha1","./util","./x509"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){var asn1=forge.asn1,pki=forge.pki=forge.pki||{};pki.pemToDer=function(pem){var msg=forge.pem.decode(pem)[0];if(msg.procType&&"ENCRYPTED"===msg.procType.type)throw new Error("Could not convert PEM to DER; PEM is encrypted.");return forge.util.createBuffer(msg.body)},pki.privateKeyFromPem=function(pem){var msg=forge.pem.decode(pem)[0];if("PRIVATE KEY"!==msg.type&&"RSA PRIVATE KEY"!==msg.type){var error=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw error.headerType=msg.type,error}if(msg.procType&&"ENCRYPTED"===msg.procType.type)throw new Error("Could not convert private key from PEM; PEM is encrypted.");var obj=asn1.fromDer(msg.body);return pki.privateKeyFromAsn1(obj)},pki.privateKeyToPem=function(key,maxline){var msg={type:"RSA PRIVATE KEY",body:asn1.toDer(pki.privateKeyToAsn1(key)).getBytes()};return forge.pem.encode(msg,{maxline:maxline})},pki.privateKeyInfoToPem=function(pki,maxline){var msg={type:"PRIVATE KEY",body:asn1.toDer(pki).getBytes()};return forge.pem.encode(msg,{maxline:maxline})}}var name="pki";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pki",["require","module","./asn1","./oids","./pbe","./pem","./pbkdf2","./pkcs12","./pss","./rsa","./util","./x509"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){var prf_TLS1=function(secret,label,seed,length){var rval=forge.util.createBuffer(),idx=secret.length>>1,slen=idx+(1&secret.length),s1=secret.substr(0,slen),s2=secret.substr(idx,slen),ai=forge.util.createBuffer(),hmac=forge.hmac.create();seed=label+seed;var md5itr=Math.ceil(length/16),sha1itr=Math.ceil(length/20);hmac.start("MD5",s1);var md5bytes=forge.util.createBuffer();ai.putBytes(seed);for(var i=0;i<md5itr;++i)hmac.start(null,null),hmac.update(ai.getBytes()),ai.putBuffer(hmac.digest()),hmac.start(null,null),hmac.update(ai.bytes()+seed),
md5bytes.putBuffer(hmac.digest());hmac.start("SHA1",s2);var sha1bytes=forge.util.createBuffer();ai.clear(),ai.putBytes(seed);for(var i=0;i<sha1itr;++i)hmac.start(null,null),hmac.update(ai.getBytes()),ai.putBuffer(hmac.digest()),hmac.start(null,null),hmac.update(ai.bytes()+seed),sha1bytes.putBuffer(hmac.digest());return rval.putBytes(forge.util.xorBytes(md5bytes.getBytes(),sha1bytes.getBytes(),length)),rval},hmac_sha1=function(key,seqNum,record){var hmac=forge.hmac.create();hmac.start("SHA1",key);var b=forge.util.createBuffer();return b.putInt32(seqNum[0]),b.putInt32(seqNum[1]),b.putByte(record.type),b.putByte(record.version.major),b.putByte(record.version.minor),b.putInt16(record.length),b.putBytes(record.fragment.bytes()),hmac.update(b.getBytes()),hmac.digest().getBytes()},deflate=function(c,record,s){var rval=!1;try{var bytes=c.deflate(record.fragment.getBytes());record.fragment=forge.util.createBuffer(bytes),record.length=bytes.length,rval=!0}catch(ex){}return rval},inflate=function(c,record,s){var rval=!1;try{var bytes=c.inflate(record.fragment.getBytes());record.fragment=forge.util.createBuffer(bytes),record.length=bytes.length,rval=!0}catch(ex){}return rval},readVector=function(b,lenBytes){var len=0;switch(lenBytes){case 1:len=b.getByte();break;case 2:len=b.getInt16();break;case 3:len=b.getInt24();break;case 4:len=b.getInt32()}return forge.util.createBuffer(b.getBytes(len))},writeVector=function(b,lenBytes,v){b.putInt(v.length(),lenBytes<<3),b.putBuffer(v)},tls={};tls.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},tls.SupportedVersions=[tls.Versions.TLS_1_1,tls.Versions.TLS_1_0],tls.Version=tls.SupportedVersions[0],tls.MaxFragment=15360,tls.ConnectionEnd={server:0,client:1},tls.PRFAlgorithm={tls_prf_sha256:0},tls.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},tls.CipherType={stream:0,block:1,aead:2},tls.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},tls.CompressionMethod={none:0,deflate:1},tls.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},tls.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},tls.Alert={},tls.Alert.Level={warning:1,fatal:2},tls.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},tls.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},tls.CipherSuites={},tls.getCipherSuite=function(twoBytes){var rval=null;for(var key in tls.CipherSuites){var cs=tls.CipherSuites[key];if(cs.id[0]===twoBytes.charCodeAt(0)&&cs.id[1]===twoBytes.charCodeAt(1)){rval=cs;break}}return rval},tls.handleUnexpected=function(c,record){var ignore=!c.open&&c.entity===tls.ConnectionEnd.client;ignore||c.error(c,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.unexpected_message}})},tls.handleHelloRequest=function(c,record,length){!c.handshaking&&c.handshakes>0&&(tls.queue(c,tls.createAlert(c,{level:tls.Alert.Level.warning,description:tls.Alert.Description.no_renegotiation})),tls.flush(c)),c.process()},tls.parseHelloMessage=function(c,record,length){var msg=null,client=c.entity===tls.ConnectionEnd.client;if(length<38)c.error(c,{message:client?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.illegal_parameter}});else{var b=record.fragment,remaining=b.length();if(msg={version:{major:b.getByte(),minor:b.getByte()},random:forge.util.createBuffer(b.getBytes(32)),session_id:readVector(b,1),extensions:[]},client?(msg.cipher_suite=b.getBytes(2),msg.compression_method=b.getByte()):(msg.cipher_suites=readVector(b,2),msg.compression_methods=readVector(b,1)),remaining=length-(remaining-b.length()),remaining>0){for(var exts=readVector(b,2);exts.length()>0;)msg.extensions.push({type:[exts.getByte(),exts.getByte()],data:readVector(exts,2)});if(!client)for(var i=0;i<msg.extensions.length;++i){var ext=msg.extensions[i];if(0===ext.type[0]&&0===ext.type[1])for(var snl=readVector(ext.data,2);snl.length()>0;){var snType=snl.getByte();if(0!==snType)break;c.session.extensions.server_name.serverNameList.push(readVector(snl,2).getBytes())}}}if(c.session.version&&(msg.version.major!==c.session.version.major||msg.version.minor!==c.session.version.minor))return c.error(c,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.protocol_version}});if(client)c.session.cipherSuite=tls.getCipherSuite(msg.cipher_suite);else for(var tmp=forge.util.createBuffer(msg.cipher_suites.bytes());tmp.length()>0&&(c.session.cipherSuite=tls.getCipherSuite(tmp.getBytes(2)),null===c.session.cipherSuite););if(null===c.session.cipherSuite)return c.error(c,{message:"No cipher suites in common.",send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.handshake_failure},cipherSuite:forge.util.bytesToHex(msg.cipher_suite)});client?c.session.compressionMethod=msg.compression_method:c.session.compressionMethod=tls.CompressionMethod.none}return msg},tls.createSecurityParameters=function(c,msg){var client=c.entity===tls.ConnectionEnd.client,msgRandom=msg.random.bytes(),cRandom=client?c.session.sp.client_random:msgRandom,sRandom=client?msgRandom:tls.createRandom().getBytes();c.session.sp={entity:c.entity,prf_algorithm:tls.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:c.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:cRandom,server_random:sRandom}},tls.handleServerHello=function(c,record,length){var msg=tls.parseHelloMessage(c,record,length);if(!c.fail){if(!(msg.version.minor<=c.version.minor))return c.error(c,{message:"Incompatible TLS version.",send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.protocol_version}});c.version.minor=msg.version.minor,c.session.version=c.version;var sessionId=msg.session_id.bytes();sessionId.length>0&&sessionId===c.session.id?(c.expect=SCC,c.session.resuming=!0,c.session.sp.server_random=msg.random.bytes()):(c.expect=SCE,c.session.resuming=!1,tls.createSecurityParameters(c,msg)),c.session.id=sessionId,c.process()}},tls.handleClientHello=function(c,record,length){var msg=tls.parseHelloMessage(c,record,length);if(!c.fail){var sessionId=msg.session_id.bytes(),session=null;if(c.sessionCache&&(session=c.sessionCache.getSession(sessionId),null===session?sessionId="":(session.version.major!==msg.version.major||session.version.minor>msg.version.minor)&&(session=null,sessionId="")),0===sessionId.length&&(sessionId=forge.random.getBytes(32)),c.session.id=sessionId,c.session.clientHelloVersion=msg.version,c.session.sp={},session)c.version=c.session.version=session.version,c.session.sp=session.sp;else{for(var version,i=1;i<tls.SupportedVersions.length&&(version=tls.SupportedVersions[i],!(version.minor<=msg.version.minor));++i);c.version={major:version.major,minor:version.minor},c.session.version=c.version}null!==session?(c.expect=CCC,c.session.resuming=!0,c.session.sp.client_random=msg.random.bytes()):(c.expect=c.verifyClient!==!1?CCE:CKE,c.session.resuming=!1,tls.createSecurityParameters(c,msg)),c.open=!0,tls.queue(c,tls.createRecord(c,{type:tls.ContentType.handshake,data:tls.createServerHello(c)})),c.session.resuming?(tls.queue(c,tls.createRecord(c,{type:tls.ContentType.change_cipher_spec,data:tls.createChangeCipherSpec()})),c.state.pending=tls.createConnectionState(c),c.state.current.write=c.state.pending.write,tls.queue(c,tls.createRecord(c,{type:tls.ContentType.handshake,data:tls.createFinished(c)}))):(tls.queue(c,tls.createRecord(c,{type:tls.ContentType.handshake,data:tls.createCertificate(c)})),c.fail||(tls.queue(c,tls.createRecord(c,{type:tls.ContentType.handshake,data:tls.createServerKeyExchange(c)})),c.verifyClient!==!1&&tls.queue(c,tls.createRecord(c,{type:tls.ContentType.handshake,data:tls.createCertificateRequest(c)})),tls.queue(c,tls.createRecord(c,{type:tls.ContentType.handshake,data:tls.createServerHelloDone(c)})))),tls.flush(c),c.process()}},tls.handleCertificate=function(c,record,length){if(length<3)return c.error(c,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.illegal_parameter}});var cert,asn1,b=record.fragment,msg={certificate_list:readVector(b,3)},certs=[];try{for(;msg.certificate_list.length()>0;)cert=readVector(msg.certificate_list,3),asn1=forge.asn1.fromDer(cert),cert=forge.pki.certificateFromAsn1(asn1,!0),certs.push(cert)}catch(ex){return c.error(c,{message:"Could not parse certificate list.",cause:ex,send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.bad_certificate}})}var client=c.entity===tls.ConnectionEnd.client;!client&&c.verifyClient!==!0||0!==certs.length?0===certs.length?c.expect=client?SKE:CKE:(client?c.session.serverCertificate=certs[0]:c.session.clientCertificate=certs[0],tls.verifyCertificateChain(c,certs)&&(c.expect=client?SKE:CKE)):c.error(c,{message:client?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.illegal_parameter}}),c.process()},tls.handleServerKeyExchange=function(c,record,length){return length>0?c.error(c,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.unsupported_certificate}}):(c.expect=SCR,void c.process())},tls.handleClientKeyExchange=function(c,record,length){if(length<48)return c.error(c,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.unsupported_certificate}});var b=record.fragment,msg={enc_pre_master_secret:readVector(b,2).getBytes()},privateKey=null;if(c.getPrivateKey)try{privateKey=c.getPrivateKey(c,c.session.serverCertificate),privateKey=forge.pki.privateKeyFromPem(privateKey)}catch(ex){c.error(c,{message:"Could not get private key.",cause:ex,send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.internal_error}})}if(null===privateKey)return c.error(c,{message:"No private key set.",send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.internal_error}});try{var sp=c.session.sp;sp.pre_master_secret=privateKey.decrypt(msg.enc_pre_master_secret);var version=c.session.clientHelloVersion;if(version.major!==sp.pre_master_secret.charCodeAt(0)||version.minor!==sp.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch(ex){sp.pre_master_secret=forge.random.getBytes(48)}c.expect=CCC,null!==c.session.clientCertificate&&(c.expect=CCV),c.process()},tls.handleCertificateRequest=function(c,record,length){if(length<3)return c.error(c,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.illegal_parameter}});var b=record.fragment,msg={certificate_types:readVector(b,1),certificate_authorities:readVector(b,2)};c.session.certificateRequest=msg,c.expect=SHD,c.process()},tls.handleCertificateVerify=function(c,record,length){if(length<2)return c.error(c,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.illegal_parameter}});var b=record.fragment;b.read-=4;var msgBytes=b.bytes();b.read+=4;var msg={signature:readVector(b,2).getBytes()},verify=forge.util.createBuffer();verify.putBuffer(c.session.md5.digest()),verify.putBuffer(c.session.sha1.digest()),verify=verify.getBytes();try{var cert=c.session.clientCertificate;if(!cert.publicKey.verify(verify,msg.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");c.session.md5.update(msgBytes),c.session.sha1.update(msgBytes)}catch(ex){return c.error(c,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.handshake_failure}})}c.expect=CCC,c.process()},tls.handleServerHelloDone=function(c,record,length){if(length>0)return c.error(c,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.record_overflow}});if(null===c.serverCertificate){var error={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.insufficient_security}},depth=0,ret=c.verify(c,error.alert.description,depth,[]);if(ret!==!0)return(ret||0===ret)&&("object"!=typeof ret||forge.util.isArray(ret)?"number"==typeof ret&&(error.alert.description=ret):(ret.message&&(error.message=ret.message),ret.alert&&(error.alert.description=ret.alert))),c.error(c,error)}null!==c.session.certificateRequest&&(record=tls.createRecord(c,{type:tls.ContentType.handshake,data:tls.createCertificate(c)}),tls.queue(c,record)),record=tls.createRecord(c,{type:tls.ContentType.handshake,data:tls.createClientKeyExchange(c)}),tls.queue(c,record),c.expect=SER;var callback=function(c,signature){null!==c.session.certificateRequest&&null!==c.session.clientCertificate&&tls.queue(c,tls.createRecord(c,{type:tls.ContentType.handshake,data:tls.createCertificateVerify(c,signature)})),tls.queue(c,tls.createRecord(c,{type:tls.ContentType.change_cipher_spec,data:tls.createChangeCipherSpec()})),c.state.pending=tls.createConnectionState(c),c.state.current.write=c.state.pending.write,tls.queue(c,tls.createRecord(c,{type:tls.ContentType.handshake,data:tls.createFinished(c)})),c.expect=SCC,tls.flush(c),c.process()};return null===c.session.certificateRequest||null===c.session.clientCertificate?callback(c,null):void tls.getClientSignature(c,callback)},tls.handleChangeCipherSpec=function(c,record){if(1!==record.fragment.getByte())return c.error(c,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.illegal_parameter}});var client=c.entity===tls.ConnectionEnd.client;(c.session.resuming&&client||!c.session.resuming&&!client)&&(c.state.pending=tls.createConnectionState(c)),c.state.current.read=c.state.pending.read,(!c.session.resuming&&client||c.session.resuming&&!client)&&(c.state.pending=null),c.expect=client?SFI:CFI,c.process()},tls.handleFinished=function(c,record,length){var b=record.fragment;b.read-=4;var msgBytes=b.bytes();b.read+=4;var vd=record.fragment.getBytes();b=forge.util.createBuffer(),b.putBuffer(c.session.md5.digest()),b.putBuffer(c.session.sha1.digest());var client=c.entity===tls.ConnectionEnd.client,label=client?"server finished":"client finished",sp=c.session.sp,vdl=12,prf=prf_TLS1;return b=prf(sp.master_secret,label,b.getBytes(),vdl),b.getBytes()!==vd?c.error(c,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.decrypt_error}}):(c.session.md5.update(msgBytes),c.session.sha1.update(msgBytes),(c.session.resuming&&client||!c.session.resuming&&!client)&&(tls.queue(c,tls.createRecord(c,{type:tls.ContentType.change_cipher_spec,data:tls.createChangeCipherSpec()})),c.state.current.write=c.state.pending.write,c.state.pending=null,tls.queue(c,tls.createRecord(c,{type:tls.ContentType.handshake,data:tls.createFinished(c)}))),c.expect=client?SAD:CAD,c.handshaking=!1,++c.handshakes,c.peerCertificate=client?c.session.serverCertificate:c.session.clientCertificate,tls.flush(c),c.isConnected=!0,c.connected(c),void c.process())},tls.handleAlert=function(c,record){var msg,b=record.fragment,alert={level:b.getByte(),description:b.getByte()};switch(alert.description){case tls.Alert.Description.close_notify:msg="Connection closed.";break;case tls.Alert.Description.unexpected_message:msg="Unexpected message.";break;case tls.Alert.Description.bad_record_mac:msg="Bad record MAC.";break;case tls.Alert.Description.decryption_failed:msg="Decryption failed.";break;case tls.Alert.Description.record_overflow:msg="Record overflow.";break;case tls.Alert.Description.decompression_failure:msg="Decompression failed.";break;case tls.Alert.Description.handshake_failure:msg="Handshake failure.";break;case tls.Alert.Description.bad_certificate:msg="Bad certificate.";break;case tls.Alert.Description.unsupported_certificate:msg="Unsupported certificate.";break;case tls.Alert.Description.certificate_revoked:msg="Certificate revoked.";break;case tls.Alert.Description.certificate_expired:msg="Certificate expired.";break;case tls.Alert.Description.certificate_unknown:msg="Certificate unknown.";break;case tls.Alert.Description.illegal_parameter:msg="Illegal parameter.";break;case tls.Alert.Description.unknown_ca:msg="Unknown certificate authority.";break;case tls.Alert.Description.access_denied:msg="Access denied.";break;case tls.Alert.Description.decode_error:msg="Decode error.";break;case tls.Alert.Description.decrypt_error:msg="Decrypt error.";break;case tls.Alert.Description.export_restriction:msg="Export restriction.";break;case tls.Alert.Description.protocol_version:msg="Unsupported protocol version.";break;case tls.Alert.Description.insufficient_security:msg="Insufficient security.";break;case tls.Alert.Description.internal_error:msg="Internal error.";break;case tls.Alert.Description.user_canceled:msg="User canceled.";break;case tls.Alert.Description.no_renegotiation:msg="Renegotiation not supported.";break;default:msg="Unknown error."}return alert.description===tls.Alert.Description.close_notify?c.close():(c.error(c,{message:msg,send:!1,origin:c.entity===tls.ConnectionEnd.client?"server":"client",alert:alert}),void c.process())},tls.handleHandshake=function(c,record){var b=record.fragment,type=b.getByte(),length=b.getInt24();if(length>b.length())return c.fragmented=record,record.fragment=forge.util.createBuffer(),b.read-=4,c.process();c.fragmented=null,b.read-=4;var bytes=b.bytes(length+4);b.read+=4,type in hsTable[c.entity][c.expect]?(c.entity!==tls.ConnectionEnd.server||c.open||c.fail||(c.handshaking=!0,c.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:forge.md.md5.create(),sha1:forge.md.sha1.create()}),type!==tls.HandshakeType.hello_request&&type!==tls.HandshakeType.certificate_verify&&type!==tls.HandshakeType.finished&&(c.session.md5.update(bytes),c.session.sha1.update(bytes)),hsTable[c.entity][c.expect][type](c,record,length)):tls.handleUnexpected(c,record)},tls.handleApplicationData=function(c,record){c.data.putBuffer(record.fragment),c.dataReady(c),c.process()},tls.handleHeartbeat=function(c,record){var b=record.fragment,type=b.getByte(),length=b.getInt16(),payload=b.getBytes(length);if(type===tls.HeartbeatMessageType.heartbeat_request){if(c.handshaking||length>payload.length)return c.process();tls.queue(c,tls.createRecord(c,{type:tls.ContentType.heartbeat,data:tls.createHeartbeat(tls.HeartbeatMessageType.heartbeat_response,payload)})),tls.flush(c)}else if(type===tls.HeartbeatMessageType.heartbeat_response){if(payload!==c.expectedHeartbeatPayload)return c.process();c.heartbeatReceived&&c.heartbeatReceived(c,forge.util.createBuffer(payload))}c.process()};var SHE=0,SCE=1,SKE=2,SCR=3,SHD=4,SCC=5,SFI=6,SAD=7,SER=8,CHE=0,CCE=1,CKE=2,CCV=3,CCC=4,CFI=5,CAD=6,__=tls.handleUnexpected,R0=tls.handleChangeCipherSpec,R1=tls.handleAlert,R2=tls.handleHandshake,R3=tls.handleApplicationData,R4=tls.handleHeartbeat,ctTable=[];ctTable[tls.ConnectionEnd.client]=[[__,R1,R2,__,R4],[__,R1,R2,__,R4],[__,R1,R2,__,R4],[__,R1,R2,__,R4],[__,R1,R2,__,R4],[R0,R1,__,__,R4],[__,R1,R2,__,R4],[__,R1,R2,R3,R4],[__,R1,R2,__,R4]],ctTable[tls.ConnectionEnd.server]=[[__,R1,R2,__,R4],[__,R1,R2,__,R4],[__,R1,R2,__,R4],[__,R1,R2,__,R4],[R0,R1,__,__,R4],[__,R1,R2,__,R4],[__,R1,R2,R3,R4],[__,R1,R2,__,R4]];var H0=tls.handleHelloRequest,H1=tls.handleServerHello,H2=tls.handleCertificate,H3=tls.handleServerKeyExchange,H4=tls.handleCertificateRequest,H5=tls.handleServerHelloDone,H6=tls.handleFinished,hsTable=[];hsTable[tls.ConnectionEnd.client]=[[__,__,H1,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__],[H0,__,__,__,__,__,__,__,__,__,__,H2,H3,H4,H5,__,__,__,__,__,__],[H0,__,__,__,__,__,__,__,__,__,__,__,H3,H4,H5,__,__,__,__,__,__],[H0,__,__,__,__,__,__,__,__,__,__,__,__,H4,H5,__,__,__,__,__,__],[H0,__,__,__,__,__,__,__,__,__,__,__,__,__,H5,__,__,__,__,__,__],[H0,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__],[H0,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,H6],[H0,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__],[H0,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__]];var H7=tls.handleClientHello,H8=tls.handleClientKeyExchange,H9=tls.handleCertificateVerify;hsTable[tls.ConnectionEnd.server]=[[__,H7,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__],[__,__,__,__,__,__,__,__,__,__,__,H2,__,__,__,__,__,__,__,__,__],[__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,H8,__,__,__,__],[__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,H9,__,__,__,__,__],[__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__],[__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,H6],[__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__],[__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__,__]],tls.generateKeys=function(c,sp){var prf=prf_TLS1,random=sp.client_random+sp.server_random;c.session.resuming||(sp.master_secret=prf(sp.pre_master_secret,"master secret",random,48).bytes(),sp.pre_master_secret=null),random=sp.server_random+sp.client_random;var length=2*sp.mac_key_length+2*sp.enc_key_length,tls10=c.version.major===tls.Versions.TLS_1_0.major&&c.version.minor===tls.Versions.TLS_1_0.minor;tls10&&(length+=2*sp.fixed_iv_length);var km=prf(sp.master_secret,"key expansion",random,length),rval={client_write_MAC_key:km.getBytes(sp.mac_key_length),server_write_MAC_key:km.getBytes(sp.mac_key_length),client_write_key:km.getBytes(sp.enc_key_length),server_write_key:km.getBytes(sp.enc_key_length)};return tls10&&(rval.client_write_IV=km.getBytes(sp.fixed_iv_length),rval.server_write_IV=km.getBytes(sp.fixed_iv_length)),rval},tls.createConnectionState=function(c){var client=c.entity===tls.ConnectionEnd.client,createMode=function(){var mode={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(record){return!0},compressionState:null,compressFunction:function(record){return!0},updateSequenceNumber:function(){4294967295===mode.sequenceNumber[1]?(mode.sequenceNumber[1]=0,++mode.sequenceNumber[0]):++mode.sequenceNumber[1]}};return mode},state={read:createMode(),write:createMode()};if(state.read.update=function(c,record){return state.read.cipherFunction(record,state.read)?state.read.compressFunction(c,record,state.read)||c.error(c,{message:"Could not decompress record.",send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.decompression_failure}}):c.error(c,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.bad_record_mac}}),!c.fail},state.write.update=function(c,record){return state.write.compressFunction(c,record,state.write)?state.write.cipherFunction(record,state.write)||c.error(c,{message:"Could not encrypt record.",send:!1,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.internal_error}}):c.error(c,{message:"Could not compress record.",send:!1,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.internal_error}}),!c.fail},c.session){var sp=c.session.sp;switch(c.session.cipherSuite.initSecurityParameters(sp),sp.keys=tls.generateKeys(c,sp),state.read.macKey=client?sp.keys.server_write_MAC_key:sp.keys.client_write_MAC_key,state.write.macKey=client?sp.keys.client_write_MAC_key:sp.keys.server_write_MAC_key,c.session.cipherSuite.initConnectionState(state,c,sp),sp.compression_algorithm){case tls.CompressionMethod.none:break;case tls.CompressionMethod.deflate:state.read.compressFunction=inflate,state.write.compressFunction=deflate;break;default:throw new Error("Unsupported compression algorithm.")}}return state},tls.createRandom=function(){var d=new Date,utc=+d+6e4*d.getTimezoneOffset(),rval=forge.util.createBuffer();return rval.putInt32(utc),rval.putBytes(forge.random.getBytes(28)),rval},tls.createRecord=function(c,options){if(!options.data)return null;var record={type:options.type,version:{major:c.version.major,minor:c.version.minor},length:options.data.length(),fragment:options.data};return record},tls.createAlert=function(c,alert){var b=forge.util.createBuffer();return b.putByte(alert.level),b.putByte(alert.description),tls.createRecord(c,{type:tls.ContentType.alert,data:b})},tls.createClientHello=function(c){c.session.clientHelloVersion={major:c.version.major,minor:c.version.minor};for(var cipherSuites=forge.util.createBuffer(),i=0;i<c.cipherSuites.length;++i){var cs=c.cipherSuites[i];cipherSuites.putByte(cs.id[0]),cipherSuites.putByte(cs.id[1])}var cSuites=cipherSuites.length(),compressionMethods=forge.util.createBuffer();compressionMethods.putByte(tls.CompressionMethod.none);var cMethods=compressionMethods.length(),extensions=forge.util.createBuffer();if(c.virtualHost){var ext=forge.util.createBuffer();ext.putByte(0),ext.putByte(0);var serverName=forge.util.createBuffer();serverName.putByte(0),writeVector(serverName,2,forge.util.createBuffer(c.virtualHost));var snList=forge.util.createBuffer();writeVector(snList,2,serverName),writeVector(ext,2,snList),extensions.putBuffer(ext)}var extLength=extensions.length();extLength>0&&(extLength+=2);var sessionId=c.session.id,length=sessionId.length+1+2+4+28+2+cSuites+1+cMethods+extLength,rval=forge.util.createBuffer();return rval.putByte(tls.HandshakeType.client_hello),rval.putInt24(length),rval.putByte(c.version.major),rval.putByte(c.version.minor),rval.putBytes(c.session.sp.client_random),writeVector(rval,1,forge.util.createBuffer(sessionId)),writeVector(rval,2,cipherSuites),writeVector(rval,1,compressionMethods),extLength>0&&writeVector(rval,2,extensions),rval},tls.createServerHello=function(c){var sessionId=c.session.id,length=sessionId.length+1+2+4+28+2+1,rval=forge.util.createBuffer();return rval.putByte(tls.HandshakeType.server_hello),rval.putInt24(length),rval.putByte(c.version.major),rval.putByte(c.version.minor),rval.putBytes(c.session.sp.server_random),writeVector(rval,1,forge.util.createBuffer(sessionId)),rval.putByte(c.session.cipherSuite.id[0]),rval.putByte(c.session.cipherSuite.id[1]),rval.putByte(c.session.compressionMethod),rval},tls.createCertificate=function(c){var client=c.entity===tls.ConnectionEnd.client,cert=null;if(c.getCertificate){var hint;hint=client?c.session.certificateRequest:c.session.extensions.server_name.serverNameList,cert=c.getCertificate(c,hint)}var certList=forge.util.createBuffer();if(null!==cert)try{forge.util.isArray(cert)||(cert=[cert]);for(var asn1=null,i=0;i<cert.length;++i){var msg=forge.pem.decode(cert[i])[0];if("CERTIFICATE"!==msg.type&&"X509 CERTIFICATE"!==msg.type&&"TRUSTED CERTIFICATE"!==msg.type){var error=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw error.headerType=msg.type,error}if(msg.procType&&"ENCRYPTED"===msg.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var der=forge.util.createBuffer(msg.body);null===asn1&&(asn1=forge.asn1.fromDer(der.bytes(),!1));var certBuffer=forge.util.createBuffer();writeVector(certBuffer,3,der),certList.putBuffer(certBuffer)}cert=forge.pki.certificateFromAsn1(asn1),client?c.session.clientCertificate=cert:c.session.serverCertificate=cert}catch(ex){return c.error(c,{message:"Could not send certificate list.",cause:ex,send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.bad_certificate}})}var length=3+certList.length(),rval=forge.util.createBuffer();return rval.putByte(tls.HandshakeType.certificate),rval.putInt24(length),writeVector(rval,3,certList),rval},tls.createClientKeyExchange=function(c){var b=forge.util.createBuffer();b.putByte(c.session.clientHelloVersion.major),b.putByte(c.session.clientHelloVersion.minor),b.putBytes(forge.random.getBytes(46));var sp=c.session.sp;sp.pre_master_secret=b.getBytes();var key=c.session.serverCertificate.publicKey;b=key.encrypt(sp.pre_master_secret);var length=b.length+2,rval=forge.util.createBuffer();return rval.putByte(tls.HandshakeType.client_key_exchange),rval.putInt24(length),rval.putInt16(b.length),rval.putBytes(b),rval},tls.createServerKeyExchange=function(c){var length=0,rval=forge.util.createBuffer();return length>0&&(rval.putByte(tls.HandshakeType.server_key_exchange),rval.putInt24(length)),rval},tls.getClientSignature=function(c,callback){var b=forge.util.createBuffer();b.putBuffer(c.session.md5.digest()),b.putBuffer(c.session.sha1.digest()),b=b.getBytes(),c.getSignature=c.getSignature||function(c,b,callback){var privateKey=null;if(c.getPrivateKey)try{privateKey=c.getPrivateKey(c,c.session.clientCertificate),privateKey=forge.pki.privateKeyFromPem(privateKey)}catch(ex){c.error(c,{message:"Could not get private key.",cause:ex,send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.internal_error}})}null===privateKey?c.error(c,{message:"No private key set.",send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.internal_error}}):b=privateKey.sign(b,null),callback(c,b)},c.getSignature(c,b,callback)},tls.createCertificateVerify=function(c,signature){var length=signature.length+2,rval=forge.util.createBuffer();return rval.putByte(tls.HandshakeType.certificate_verify),rval.putInt24(length),rval.putInt16(signature.length),rval.putBytes(signature),rval},tls.createCertificateRequest=function(c){var certTypes=forge.util.createBuffer();certTypes.putByte(1);var cAs=forge.util.createBuffer();for(var key in c.caStore.certs){var cert=c.caStore.certs[key],dn=forge.pki.distinguishedNameToAsn1(cert.subject);cAs.putBuffer(forge.asn1.toDer(dn))}var length=1+certTypes.length()+2+cAs.length(),rval=forge.util.createBuffer();return rval.putByte(tls.HandshakeType.certificate_request),rval.putInt24(length),writeVector(rval,1,certTypes),writeVector(rval,2,cAs),rval},tls.createServerHelloDone=function(c){var rval=forge.util.createBuffer();return rval.putByte(tls.HandshakeType.server_hello_done),rval.putInt24(0),rval},tls.createChangeCipherSpec=function(){var rval=forge.util.createBuffer();return rval.putByte(1),rval},tls.createFinished=function(c){var b=forge.util.createBuffer();b.putBuffer(c.session.md5.digest()),b.putBuffer(c.session.sha1.digest());var client=c.entity===tls.ConnectionEnd.client,sp=c.session.sp,vdl=12,prf=prf_TLS1,label=client?"client finished":"server finished";b=prf(sp.master_secret,label,b.getBytes(),vdl);var rval=forge.util.createBuffer();return rval.putByte(tls.HandshakeType.finished),rval.putInt24(b.length()),rval.putBuffer(b),rval},tls.createHeartbeat=function(type,payload,payloadLength){"undefined"==typeof payloadLength&&(payloadLength=payload.length);var rval=forge.util.createBuffer();rval.putByte(type),rval.putInt16(payloadLength),rval.putBytes(payload);var plaintextLength=rval.length(),paddingLength=Math.max(16,plaintextLength-payloadLength-3);
return rval.putBytes(forge.random.getBytes(paddingLength)),rval},tls.queue=function(c,record){if(record){if(record.type===tls.ContentType.handshake){var bytes=record.fragment.bytes();c.session.md5.update(bytes),c.session.sha1.update(bytes),bytes=null}var records;if(record.fragment.length()<=tls.MaxFragment)records=[record];else{records=[];for(var data=record.fragment.bytes();data.length>tls.MaxFragment;)records.push(tls.createRecord(c,{type:record.type,data:forge.util.createBuffer(data.slice(0,tls.MaxFragment))})),data=data.slice(tls.MaxFragment);data.length>0&&records.push(tls.createRecord(c,{type:record.type,data:forge.util.createBuffer(data)}))}for(var i=0;i<records.length&&!c.fail;++i){var rec=records[i],s=c.state.current.write;s.update(c,rec)&&c.records.push(rec)}}},tls.flush=function(c){for(var i=0;i<c.records.length;++i){var record=c.records[i];c.tlsData.putByte(record.type),c.tlsData.putByte(record.version.major),c.tlsData.putByte(record.version.minor),c.tlsData.putInt16(record.fragment.length()),c.tlsData.putBuffer(c.records[i].fragment)}return c.records=[],c.tlsDataReady(c)};var _certErrorToAlertDesc=function(error){switch(error){case!0:return!0;case forge.pki.certificateError.bad_certificate:return tls.Alert.Description.bad_certificate;case forge.pki.certificateError.unsupported_certificate:return tls.Alert.Description.unsupported_certificate;case forge.pki.certificateError.certificate_revoked:return tls.Alert.Description.certificate_revoked;case forge.pki.certificateError.certificate_expired:return tls.Alert.Description.certificate_expired;case forge.pki.certificateError.certificate_unknown:return tls.Alert.Description.certificate_unknown;case forge.pki.certificateError.unknown_ca:return tls.Alert.Description.unknown_ca;default:return tls.Alert.Description.bad_certificate}},_alertDescToCertError=function(desc){switch(desc){case!0:return!0;case tls.Alert.Description.bad_certificate:return forge.pki.certificateError.bad_certificate;case tls.Alert.Description.unsupported_certificate:return forge.pki.certificateError.unsupported_certificate;case tls.Alert.Description.certificate_revoked:return forge.pki.certificateError.certificate_revoked;case tls.Alert.Description.certificate_expired:return forge.pki.certificateError.certificate_expired;case tls.Alert.Description.certificate_unknown:return forge.pki.certificateError.certificate_unknown;case tls.Alert.Description.unknown_ca:return forge.pki.certificateError.unknown_ca;default:return forge.pki.certificateError.bad_certificate}};tls.verifyCertificateChain=function(c,chain){try{forge.pki.verifyCertificateChain(c.caStore,chain,function(vfd,depth,chain){var ret=(_certErrorToAlertDesc(vfd),c.verify(c,vfd,depth,chain));if(ret!==!0){if("object"==typeof ret&&!forge.util.isArray(ret)){var error=new Error("The application rejected the certificate.");throw error.send=!0,error.alert={level:tls.Alert.Level.fatal,description:tls.Alert.Description.bad_certificate},ret.message&&(error.message=ret.message),ret.alert&&(error.alert.description=ret.alert),error}ret!==vfd&&(ret=_alertDescToCertError(ret))}return ret})}catch(ex){var err=ex;("object"!=typeof err||forge.util.isArray(err))&&(err={send:!0,alert:{level:tls.Alert.Level.fatal,description:_certErrorToAlertDesc(ex)}}),"send"in err||(err.send=!0),"alert"in err||(err.alert={level:tls.Alert.Level.fatal,description:_certErrorToAlertDesc(err.error)}),c.error(c,err)}return!c.fail},tls.createSessionCache=function(cache,capacity){var rval=null;if(cache&&cache.getSession&&cache.setSession&&cache.order)rval=cache;else{rval={},rval.cache=cache||{},rval.capacity=Math.max(capacity||100,1),rval.order=[];for(var key in cache)rval.order.length<=capacity?rval.order.push(key):delete cache[key];rval.getSession=function(sessionId){var session=null,key=null;if(sessionId?key=forge.util.bytesToHex(sessionId):rval.order.length>0&&(key=rval.order[0]),null!==key&&key in rval.cache){session=rval.cache[key],delete rval.cache[key];for(var i in rval.order)if(rval.order[i]===key){rval.order.splice(i,1);break}}return session},rval.setSession=function(sessionId,session){if(rval.order.length===rval.capacity){var key=rval.order.shift();delete rval.cache[key]}var key=forge.util.bytesToHex(sessionId);rval.order.push(key),rval.cache[key]=session}}return rval},tls.createConnection=function(options){var caStore=null;caStore=options.caStore?forge.util.isArray(options.caStore)?forge.pki.createCaStore(options.caStore):options.caStore:forge.pki.createCaStore();var cipherSuites=options.cipherSuites||null;if(null===cipherSuites){cipherSuites=[];for(var key in tls.CipherSuites)cipherSuites.push(tls.CipherSuites[key])}var entity=options.server?tls.ConnectionEnd.server:tls.ConnectionEnd.client,sessionCache=options.sessionCache?tls.createSessionCache(options.sessionCache):null,c={version:{major:tls.Version.major,minor:tls.Version.minor},entity:entity,sessionId:options.sessionId,caStore:caStore,sessionCache:sessionCache,cipherSuites:cipherSuites,connected:options.connected,virtualHost:options.virtualHost||null,verifyClient:options.verifyClient||!1,verify:options.verify||function(cn,vfd,dpth,cts){return vfd},getCertificate:options.getCertificate||null,getPrivateKey:options.getPrivateKey||null,getSignature:options.getSignature||null,input:forge.util.createBuffer(),tlsData:forge.util.createBuffer(),data:forge.util.createBuffer(),tlsDataReady:options.tlsDataReady,dataReady:options.dataReady,heartbeatReceived:options.heartbeatReceived,closed:options.closed,error:function(c,ex){ex.origin=ex.origin||(c.entity===tls.ConnectionEnd.client?"client":"server"),ex.send&&(tls.queue(c,tls.createAlert(c,ex.alert)),tls.flush(c));var fatal=ex.fatal!==!1;fatal&&(c.fail=!0),options.error(c,ex),fatal&&c.close(!1)},deflate:options.deflate||null,inflate:options.inflate||null};c.reset=function(clearFail){c.version={major:tls.Version.major,minor:tls.Version.minor},c.record=null,c.session=null,c.peerCertificate=null,c.state={pending:null,current:null},c.expect=c.entity===tls.ConnectionEnd.client?SHE:CHE,c.fragmented=null,c.records=[],c.open=!1,c.handshakes=0,c.handshaking=!1,c.isConnected=!1,c.fail=!(clearFail||"undefined"==typeof clearFail),c.input.clear(),c.tlsData.clear(),c.data.clear(),c.state.current=tls.createConnectionState(c)},c.reset();var _update=function(c,record){var aligned=record.type-tls.ContentType.change_cipher_spec,handlers=ctTable[c.entity][c.expect];aligned in handlers?handlers[aligned](c,record):tls.handleUnexpected(c,record)},_readRecordHeader=function(c){var rval=0,b=c.input,len=b.length();if(len<5)rval=5-len;else{c.record={type:b.getByte(),version:{major:b.getByte(),minor:b.getByte()},length:b.getInt16(),fragment:forge.util.createBuffer(),ready:!1};var compatibleVersion=c.record.version.major===c.version.major;compatibleVersion&&c.session&&c.session.version&&(compatibleVersion=c.record.version.minor===c.version.minor),compatibleVersion||c.error(c,{message:"Incompatible TLS version.",send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.protocol_version}})}return rval},_readRecord=function(c){var rval=0,b=c.input,len=b.length();if(len<c.record.length)rval=c.record.length-len;else{c.record.fragment.putBytes(b.getBytes(c.record.length)),b.compact();var s=c.state.current.read;s.update(c,c.record)&&(null!==c.fragmented&&(c.fragmented.type===c.record.type?(c.fragmented.fragment.putBuffer(c.record.fragment),c.record=c.fragmented):c.error(c,{message:"Invalid fragmented record.",send:!0,alert:{level:tls.Alert.Level.fatal,description:tls.Alert.Description.unexpected_message}})),c.record.ready=!0)}return rval};return c.handshake=function(sessionId){if(c.entity!==tls.ConnectionEnd.client)c.error(c,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(c.handshaking)c.error(c,{message:"Handshake already in progress.",fatal:!1});else{c.fail&&!c.open&&0===c.handshakes&&(c.fail=!1),c.handshaking=!0,sessionId=sessionId||"";var session=null;sessionId.length>0&&(c.sessionCache&&(session=c.sessionCache.getSession(sessionId)),null===session&&(sessionId="")),0===sessionId.length&&c.sessionCache&&(session=c.sessionCache.getSession(),null!==session&&(sessionId=session.id)),c.session={id:sessionId,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:forge.md.md5.create(),sha1:forge.md.sha1.create()},session&&(c.version=session.version,c.session.sp=session.sp),c.session.sp.client_random=tls.createRandom().getBytes(),c.open=!0,tls.queue(c,tls.createRecord(c,{type:tls.ContentType.handshake,data:tls.createClientHello(c)})),tls.flush(c)}},c.process=function(data){var rval=0;return data&&c.input.putBytes(data),c.fail||(null!==c.record&&c.record.ready&&c.record.fragment.isEmpty()&&(c.record=null),null===c.record&&(rval=_readRecordHeader(c)),c.fail||null===c.record||c.record.ready||(rval=_readRecord(c)),!c.fail&&null!==c.record&&c.record.ready&&_update(c,c.record)),rval},c.prepare=function(data){return tls.queue(c,tls.createRecord(c,{type:tls.ContentType.application_data,data:forge.util.createBuffer(data)})),tls.flush(c)},c.prepareHeartbeatRequest=function(payload,payloadLength){return payload instanceof forge.util.ByteBuffer&&(payload=payload.bytes()),"undefined"==typeof payloadLength&&(payloadLength=payload.length),c.expectedHeartbeatPayload=payload,tls.queue(c,tls.createRecord(c,{type:tls.ContentType.heartbeat,data:tls.createHeartbeat(tls.HeartbeatMessageType.heartbeat_request,payload,payloadLength)})),tls.flush(c)},c.close=function(clearFail){if(!c.fail&&c.sessionCache&&c.session){var session={id:c.session.id,version:c.session.version,sp:c.session.sp};session.sp.keys=null,c.sessionCache.setSession(session.id,session)}c.open&&(c.open=!1,c.input.clear(),(c.isConnected||c.handshaking)&&(c.isConnected=c.handshaking=!1,tls.queue(c,tls.createAlert(c,{level:tls.Alert.Level.warning,description:tls.Alert.Description.close_notify})),tls.flush(c)),c.closed(c)),c.reset(clearFail)},c},forge.tls=forge.tls||{};for(var key in tls)"function"!=typeof tls[key]&&(forge.tls[key]=tls[key]);forge.tls.prf_tls1=prf_TLS1,forge.tls.hmac_sha1=hmac_sha1,forge.tls.createSessionCache=tls.createSessionCache,forge.tls.createConnection=tls.createConnection}var name="tls";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/tls",["require","module","./asn1","./hmac","./md","./pem","./pki","./random","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){function initConnectionState(state,c,sp){var client=c.entity===forge.tls.ConnectionEnd.client;state.read.cipherState={init:!1,cipher:forge.cipher.createDecipher("AES-CBC",client?sp.keys.server_write_key:sp.keys.client_write_key),iv:client?sp.keys.server_write_IV:sp.keys.client_write_IV},state.write.cipherState={init:!1,cipher:forge.cipher.createCipher("AES-CBC",client?sp.keys.client_write_key:sp.keys.server_write_key),iv:client?sp.keys.client_write_IV:sp.keys.server_write_IV},state.read.cipherFunction=decrypt_aes_cbc_sha1,state.write.cipherFunction=encrypt_aes_cbc_sha1,state.read.macLength=state.write.macLength=sp.mac_length,state.read.macFunction=state.write.macFunction=tls.hmac_sha1}function encrypt_aes_cbc_sha1(record,s){var rval=!1,mac=s.macFunction(s.macKey,s.sequenceNumber,record);record.fragment.putBytes(mac),s.updateSequenceNumber();var iv;iv=record.version.minor===tls.Versions.TLS_1_0.minor?s.cipherState.init?null:s.cipherState.iv:forge.random.getBytesSync(16),s.cipherState.init=!0;var cipher=s.cipherState.cipher;return cipher.start({iv:iv}),record.version.minor>=tls.Versions.TLS_1_1.minor&&cipher.output.putBytes(iv),cipher.update(record.fragment),cipher.finish(encrypt_aes_cbc_sha1_padding)&&(record.fragment=cipher.output,record.length=record.fragment.length(),rval=!0),rval}function encrypt_aes_cbc_sha1_padding(blockSize,input,decrypt){if(!decrypt){var padding=blockSize-input.length()%blockSize;input.fillWithByte(padding-1,padding)}return!0}function decrypt_aes_cbc_sha1_padding(blockSize,output,decrypt){var rval=!0;if(decrypt){for(var len=output.length(),paddingLength=output.last(),i=len-1-paddingLength;i<len-1;++i)rval=rval&&output.at(i)==paddingLength;rval&&output.truncate(paddingLength+1)}return rval}function decrypt_aes_cbc_sha1(record,s){var rval=!1;++count;var iv;iv=record.version.minor===tls.Versions.TLS_1_0.minor?s.cipherState.init?null:s.cipherState.iv:record.fragment.getBytes(16),s.cipherState.init=!0;var cipher=s.cipherState.cipher;cipher.start({iv:iv}),cipher.update(record.fragment),rval=cipher.finish(decrypt_aes_cbc_sha1_padding);for(var macLen=s.macLength,mac="",i=0;i<macLen;++i)mac+=String.fromCharCode(0);var len=cipher.output.length();len>=macLen?(record.fragment=cipher.output.getBytes(len-macLen),mac=cipher.output.getBytes(macLen)):record.fragment=cipher.output.getBytes(),record.fragment=forge.util.createBuffer(record.fragment),record.length=record.fragment.length();var mac2=s.macFunction(s.macKey,s.sequenceNumber,record);return s.updateSequenceNumber(),rval=mac2===mac&&rval}var tls=forge.tls;tls.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(sp){sp.bulk_cipher_algorithm=tls.BulkCipherAlgorithm.aes,sp.cipher_type=tls.CipherType.block,sp.enc_key_length=16,sp.block_length=16,sp.fixed_iv_length=16,sp.record_iv_length=16,sp.mac_algorithm=tls.MACAlgorithm.hmac_sha1,sp.mac_length=20,sp.mac_key_length=20},initConnectionState:initConnectionState},tls.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(sp){sp.bulk_cipher_algorithm=tls.BulkCipherAlgorithm.aes,sp.cipher_type=tls.CipherType.block,sp.enc_key_length=32,sp.block_length=16,sp.fixed_iv_length=16,sp.record_iv_length=16,sp.mac_algorithm=tls.MACAlgorithm.hmac_sha1,sp.mac_length=20,sp.mac_key_length=20},initConnectionState:initConnectionState};var count=0}var name="aesCipherSuites";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/aesCipherSuites",["require","module","./aes","./tls"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){forge.debug=forge.debug||{},forge.debug.storage={},forge.debug.get=function(cat,name){var rval;return"undefined"==typeof cat?rval=forge.debug.storage:cat in forge.debug.storage&&(rval="undefined"==typeof name?forge.debug.storage[cat]:forge.debug.storage[cat][name]),rval},forge.debug.set=function(cat,name,data){cat in forge.debug.storage||(forge.debug.storage[cat]={}),forge.debug.storage[cat][name]=data},forge.debug.clear=function(cat,name){"undefined"==typeof cat?forge.debug.storage={}:cat in forge.debug.storage&&("undefined"==typeof name?delete forge.debug.storage[cat]:delete forge.debug.storage[cat][name])}}var name="debug";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/debug",["require","module"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){function _createKDF(kdf,md,counterStart,digestLength){kdf.generate=function(x,length){for(var key=new forge.util.ByteBuffer,k=Math.ceil(length/digestLength)+counterStart,c=new forge.util.ByteBuffer,i=counterStart;i<k;++i){c.putInt32(i),md.start(),md.update(x+c.getBytes());var hash=md.digest();key.putBytes(hash.getBytes(digestLength))}return key.truncate(key.length()-length),key.getBytes()}}forge.kem=forge.kem||{};var BigInteger=forge.jsbn.BigInteger;forge.kem.rsa={},forge.kem.rsa.create=function(kdf,options){options=options||{};var prng=options.prng||forge.random,kem={};return kem.encrypt=function(publicKey,keyLength){var r,byteLength=Math.ceil(publicKey.n.bitLength()/8);do r=new BigInteger(forge.util.bytesToHex(prng.getBytesSync(byteLength)),16).mod(publicKey.n);while(r.equals(BigInteger.ZERO));r=forge.util.hexToBytes(r.toString(16));var zeros=byteLength-r.length;zeros>0&&(r=forge.util.fillString(String.fromCharCode(0),zeros)+r);var encapsulation=publicKey.encrypt(r,"NONE"),key=kdf.generate(r,keyLength);return{encapsulation:encapsulation,key:key}},kem.decrypt=function(privateKey,encapsulation,keyLength){var r=privateKey.decrypt(encapsulation,"NONE");return kdf.generate(r,keyLength)},kem},forge.kem.kdf1=function(md,digestLength){_createKDF(this,md,0,digestLength||md.digestLength)},forge.kem.kdf2=function(md,digestLength){_createKDF(this,md,1,digestLength||md.digestLength)}}var name="kem";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/kem",["require","module","./util","./random","./jsbn"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){forge.log=forge.log||{},forge.log.levels=["none","error","warning","info","debug","verbose","max"];var sLevelInfo={},sLoggers=[],sConsoleLogger=null;forge.log.LEVEL_LOCKED=2,forge.log.NO_LEVEL_CHECK=4,forge.log.INTERPOLATE=8;for(var i=0;i<forge.log.levels.length;++i){var level=forge.log.levels[i];sLevelInfo[level]={index:i,name:level.toUpperCase()}}forge.log.logMessage=function(message){for(var messageLevelIndex=sLevelInfo[message.level].index,i=0;i<sLoggers.length;++i){var logger=sLoggers[i];if(logger.flags&forge.log.NO_LEVEL_CHECK)logger.f(message);else{var loggerLevelIndex=sLevelInfo[logger.level].index;messageLevelIndex<=loggerLevelIndex&&logger.f(logger,message)}}},forge.log.prepareStandard=function(message){"standard"in message||(message.standard=sLevelInfo[message.level].name+" ["+message.category+"] "+message.message)},forge.log.prepareFull=function(message){if(!("full"in message)){var args=[message.message];args=args.concat([]||message.arguments),message.full=forge.util.format.apply(this,args)}},forge.log.prepareStandardFull=function(message){"standardFull"in message||(forge.log.prepareStandard(message),message.standardFull=message.standard)};for(var levels=["error","warning","info","debug","verbose"],i=0;i<levels.length;++i)!function(level){forge.log[level]=function(category,message){var args=Array.prototype.slice.call(arguments).slice(2),msg={timestamp:new Date,level:level,category:category,message:message,arguments:args};forge.log.logMessage(msg)}}(levels[i]);if(forge.log.makeLogger=function(logFunction){var logger={flags:0,f:logFunction};return forge.log.setLevel(logger,"none"),logger},forge.log.setLevel=function(logger,level){var rval=!1;if(logger&&!(logger.flags&forge.log.LEVEL_LOCKED))for(var i=0;i<forge.log.levels.length;++i){var aValidLevel=forge.log.levels[i];if(level==aValidLevel){logger.level=level,rval=!0;break}}return rval},forge.log.lock=function(logger,lock){"undefined"==typeof lock||lock?logger.flags|=forge.log.LEVEL_LOCKED:logger.flags&=~forge.log.LEVEL_LOCKED},forge.log.addLogger=function(logger){sLoggers.push(logger)},"undefined"!=typeof console&&"log"in console){var logger;if(console.error&&console.warn&&console.info&&console.debug){var levelHandlers={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},f=function(logger,message){forge.log.prepareStandard(message);var handler=levelHandlers[message.level],args=[message.standard];args=args.concat(message.arguments.slice()),handler.apply(console,args)};logger=forge.log.makeLogger(f)}else{var f=function(logger,message){forge.log.prepareStandardFull(message),console.log(message.standardFull)};logger=forge.log.makeLogger(f)}forge.log.setLevel(logger,"debug"),forge.log.addLogger(logger),sConsoleLogger=logger}else console={log:function(){}};if(null!==sConsoleLogger){var query=forge.util.getQueryVariables();if("console.level"in query&&forge.log.setLevel(sConsoleLogger,query["console.level"].slice(-1)[0]),"console.lock"in query){var lock=query["console.lock"].slice(-1)[0];"true"==lock&&forge.log.lock(sConsoleLogger)}}forge.log.consoleLogger=sConsoleLogger}var name="log";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/log",["require","module","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){var asn1=forge.asn1,p7=forge.pkcs7=forge.pkcs7||{};p7.messageFromPem=function(pem){var msg=forge.pem.decode(pem)[0];if("PKCS7"!==msg.type){var error=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw error.headerType=msg.type,error}if(msg.procType&&"ENCRYPTED"===msg.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var obj=asn1.fromDer(msg.body);return p7.messageFromAsn1(obj)},p7.messageToPem=function(msg,maxline){var pemObj={type:"PKCS7",body:asn1.toDer(msg.toAsn1()).getBytes()};return forge.pem.encode(pemObj,{maxline:maxline})},p7.messageFromAsn1=function(obj){var capture={},errors=[];if(!asn1.validate(obj,p7.asn1.contentInfoValidator,capture,errors)){var error=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw error.errors=errors,error}var msg,contentType=asn1.derToOid(capture.contentType);switch(contentType){case forge.pki.oids.envelopedData:msg=p7.createEnvelopedData();break;case forge.pki.oids.encryptedData:msg=p7.createEncryptedData();break;case forge.pki.oids.signedData:msg=p7.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+contentType+" is not (yet) supported.")}return msg.fromAsn1(capture.content.value[0]),msg};var _recipientInfoFromAsn1=function(obj){var capture={},errors=[];if(!asn1.validate(obj,p7.asn1.recipientInfoValidator,capture,errors)){var error=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 EnvelopedData.");throw error.errors=errors,error}return{version:capture.version.charCodeAt(0),issuer:forge.pki.RDNAttributesAsArray(capture.issuer),serialNumber:forge.util.createBuffer(capture.serial).toHex(),encryptedContent:{algorithm:asn1.derToOid(capture.encAlgorithm),parameter:capture.encParameter.value,content:capture.encKey}}},_recipientInfoToAsn1=function(obj){return asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,asn1.integerToDer(obj.version).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[forge.pki.distinguishedNameToAsn1({attributes:obj.issuer}),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,forge.util.hexToBytes(obj.serialNumber))]),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(obj.encryptedContent.algorithm).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.NULL,!1,"")]),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,obj.encryptedContent.content)])},_recipientInfosFromAsn1=function(objArr){for(var ret=[],i=0;i<objArr.length;i++)ret.push(_recipientInfoFromAsn1(objArr[i]));return ret},_recipientInfosToAsn1=function(recipientsArr){for(var ret=[],i=0;i<recipientsArr.length;i++)ret.push(_recipientInfoToAsn1(recipientsArr[i]));return ret},_encryptedContentToAsn1=function(ec){return[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(forge.pki.oids.data).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(ec.algorithm).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,ec.parameter.getBytes())]),asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,ec.content.getBytes())])]},_fromAsn1=function(msg,obj,validator){var capture={},errors=[];if(!asn1.validate(obj,validator,capture,errors)){var error=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw error.errors=error,error}var contentType=asn1.derToOid(capture.contentType);if(contentType!==forge.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(capture.encryptedContent){var content="";if(forge.util.isArray(capture.encryptedContent))for(var i=0;i<capture.encryptedContent.length;++i){if(capture.encryptedContent[i].type!==asn1.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");content+=capture.encryptedContent[i].value}else content=capture.encryptedContent;msg.encryptedContent={algorithm:asn1.derToOid(capture.encAlgorithm),parameter:forge.util.createBuffer(capture.encParameter.value),content:forge.util.createBuffer(content)}}if(capture.content){var content="";if(forge.util.isArray(capture.content))for(var i=0;i<capture.content.length;++i){if(capture.content[i].type!==asn1.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");content+=capture.content[i].value}else content=capture.content;msg.content=forge.util.createBuffer(content)}return msg.version=capture.version.charCodeAt(0),msg.rawCapture=capture,capture},_decryptContent=function(msg){if(void 0===msg.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===msg.content){var ciph;switch(msg.encryptedContent.algorithm){case forge.pki.oids["aes128-CBC"]:case forge.pki.oids["aes192-CBC"]:case forge.pki.oids["aes256-CBC"]:ciph=forge.aes.createDecryptionCipher(msg.encryptedContent.key);break;case forge.pki.oids.desCBC:case forge.pki.oids["des-EDE3-CBC"]:ciph=forge.des.createDecryptionCipher(msg.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+msg.encryptedContent.algorithm)}if(ciph.start(msg.encryptedContent.parameter),ciph.update(msg.encryptedContent.content),!ciph.finish())throw new Error("Symmetric decryption failed.");msg.content=ciph.output}};p7.createSignedData=function(){var msg=null;return msg={type:forge.pki.oids.signedData,version:1,certificates:[],crls:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(obj){_fromAsn1(msg,obj,p7.asn1.signedDataValidator),msg.certificates=[],msg.crls=[],msg.digestAlgorithmIdentifiers=[],msg.contentInfo=null,msg.signerInfos=[];for(var certs=msg.rawCapture.certificates.value,i=0;i<certs.length;++i)msg.certificates.push(forge.pki.certificateFromAsn1(certs[i]))},toAsn1:function(){if("content"in msg)throw new Error("Signing PKCS#7 content not yet implemented.");msg.contentInfo||msg.sign();for(var certs=[],i=0;i<msg.certificates.length;++i)certs.push(forge.pki.certificateToAsn1(msg.certificates[0]));var crls=[];return asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(msg.type).getBytes()),asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,asn1.integerToDer(msg.version).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SET,!0,msg.digestAlgorithmIdentifiers),msg.contentInfo,asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,certs),asn1.create(asn1.Class.CONTEXT_SPECIFIC,1,!0,crls),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SET,!0,msg.signerInfos)])])])},sign:function(signer){if("content"in msg)throw new Error("PKCS#7 signing not yet implemented.");"object"!=typeof msg.content&&(msg.contentInfo=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(forge.pki.oids.data).getBytes())]),"content"in msg&&msg.contentInfo.value.push(asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,msg.content)])))},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(cert){"string"==typeof cert&&(cert=forge.pki.certificateFromPem(cert)),msg.certificates.push(cert)},addCertificateRevokationList:function(crl){throw new Error("PKCS#7 CRL support not yet implemented.")}}},p7.createEncryptedData=function(){var msg=null;return msg={type:forge.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:forge.pki.oids["aes256-CBC"]},fromAsn1:function(obj){_fromAsn1(msg,obj,p7.asn1.encryptedDataValidator)},decrypt:function(key){void 0!==key&&(msg.encryptedContent.key=key),_decryptContent(msg)}}},p7.createEnvelopedData=function(){var msg=null;return msg={type:forge.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{
algorithm:forge.pki.oids["aes256-CBC"]},fromAsn1:function(obj){var capture=_fromAsn1(msg,obj,p7.asn1.envelopedDataValidator);msg.recipients=_recipientInfosFromAsn1(capture.recipientInfos.value)},toAsn1:function(){return asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(msg.type).getBytes()),asn1.create(asn1.Class.CONTEXT_SPECIFIC,0,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,asn1.integerToDer(msg.version).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SET,!0,_recipientInfosToAsn1(msg.recipients)),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,_encryptedContentToAsn1(msg.encryptedContent))])])])},findRecipient:function(cert){for(var sAttr=cert.issuer.attributes,i=0;i<msg.recipients.length;++i){var r=msg.recipients[i],rAttr=r.issuer;if(r.serialNumber===cert.serialNumber&&rAttr.length===sAttr.length){for(var match=!0,j=0;j<sAttr.length;++j)if(rAttr[j].type!==sAttr[j].type||rAttr[j].value!==sAttr[j].value){match=!1;break}if(match)return r}}return null},decrypt:function(recipient,privKey){if(void 0===msg.encryptedContent.key&&void 0!==recipient&&void 0!==privKey)switch(recipient.encryptedContent.algorithm){case forge.pki.oids.rsaEncryption:case forge.pki.oids.desCBC:var key=privKey.decrypt(recipient.encryptedContent.content);msg.encryptedContent.key=forge.util.createBuffer(key);break;default:throw new Error("Unsupported asymmetric cipher, OID "+recipient.encryptedContent.algorithm)}_decryptContent(msg)},addRecipient:function(cert){msg.recipients.push({version:0,issuer:cert.issuer.attributes,serialNumber:cert.serialNumber,encryptedContent:{algorithm:forge.pki.oids.rsaEncryption,key:cert.publicKey}})},encrypt:function(key,cipher){if(void 0===msg.encryptedContent.content){cipher=cipher||msg.encryptedContent.algorithm,key=key||msg.encryptedContent.key;var keyLen,ivLen,ciphFn;switch(cipher){case forge.pki.oids["aes128-CBC"]:keyLen=16,ivLen=16,ciphFn=forge.aes.createEncryptionCipher;break;case forge.pki.oids["aes192-CBC"]:keyLen=24,ivLen=16,ciphFn=forge.aes.createEncryptionCipher;break;case forge.pki.oids["aes256-CBC"]:keyLen=32,ivLen=16,ciphFn=forge.aes.createEncryptionCipher;break;case forge.pki.oids["des-EDE3-CBC"]:keyLen=24,ivLen=8,ciphFn=forge.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+cipher)}if(void 0===key)key=forge.util.createBuffer(forge.random.getBytes(keyLen));else if(key.length()!=keyLen)throw new Error("Symmetric key has wrong length; got "+key.length()+" bytes, expected "+keyLen+".");msg.encryptedContent.algorithm=cipher,msg.encryptedContent.key=key,msg.encryptedContent.parameter=forge.util.createBuffer(forge.random.getBytes(ivLen));var ciph=ciphFn(key);if(ciph.start(msg.encryptedContent.parameter.copy()),ciph.update(msg.content),!ciph.finish())throw new Error("Symmetric encryption failed.");msg.encryptedContent.content=ciph.output}for(var i=0;i<msg.recipients.length;i++){var recipient=msg.recipients[i];if(void 0===recipient.encryptedContent.content)switch(recipient.encryptedContent.algorithm){case forge.pki.oids.rsaEncryption:recipient.encryptedContent.content=recipient.encryptedContent.key.encrypt(msg.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+recipient.encryptedContent.algorithm)}}}}}}var name="pkcs7";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/pkcs7",["require","module","./aes","./asn1","./des","./oids","./pem","./pkcs7asn1","./random","./util","./x509"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){function _addBigIntegerToBuffer(buffer,val){var hexVal=val.toString(16);hexVal[0]>="8"&&(hexVal="00"+hexVal);var bytes=forge.util.hexToBytes(hexVal);buffer.putInt32(bytes.length),buffer.putBytes(bytes)}function _addStringToBuffer(buffer,val){buffer.putInt32(val.length),buffer.putString(val)}function _sha1(){for(var sha=forge.md.sha1.create(),num=arguments.length,i=0;i<num;++i)sha.update(arguments[i]);return sha.digest()}var ssh=forge.ssh=forge.ssh||{};ssh.privateKeyToPutty=function(privateKey,passphrase,comment){comment=comment||"",passphrase=passphrase||"";var algorithm="ssh-rsa",encryptionAlgorithm=""===passphrase?"none":"aes256-cbc",ppk="PuTTY-User-Key-File-2: "+algorithm+"\r\n";ppk+="Encryption: "+encryptionAlgorithm+"\r\n",ppk+="Comment: "+comment+"\r\n";var pubbuffer=forge.util.createBuffer();_addStringToBuffer(pubbuffer,algorithm),_addBigIntegerToBuffer(pubbuffer,privateKey.e),_addBigIntegerToBuffer(pubbuffer,privateKey.n);var pub=forge.util.encode64(pubbuffer.bytes(),64),length=Math.floor(pub.length/66)+1;ppk+="Public-Lines: "+length+"\r\n",ppk+=pub;var privbuffer=forge.util.createBuffer();_addBigIntegerToBuffer(privbuffer,privateKey.d),_addBigIntegerToBuffer(privbuffer,privateKey.p),_addBigIntegerToBuffer(privbuffer,privateKey.q),_addBigIntegerToBuffer(privbuffer,privateKey.qInv);var priv;if(passphrase){var encLen=privbuffer.length()+16-1;encLen-=encLen%16;var padding=_sha1(privbuffer.bytes());padding.truncate(padding.length()-encLen+privbuffer.length()),privbuffer.putBuffer(padding);var aeskey=forge.util.createBuffer();aeskey.putBuffer(_sha1("\0\0\0\0",passphrase)),aeskey.putBuffer(_sha1("\0\0\0",passphrase));var cipher=forge.aes.createEncryptionCipher(aeskey.truncate(8),"CBC");cipher.start(forge.util.createBuffer().fillWithByte(0,16)),cipher.update(privbuffer.copy()),cipher.finish();var encrypted=cipher.output;encrypted.truncate(16),priv=forge.util.encode64(encrypted.bytes(),64)}else priv=forge.util.encode64(privbuffer.bytes(),64);length=Math.floor(priv.length/66)+1,ppk+="\r\nPrivate-Lines: "+length+"\r\n",ppk+=priv;var mackey=_sha1("putty-private-key-file-mac-key",passphrase),macbuffer=forge.util.createBuffer();_addStringToBuffer(macbuffer,algorithm),_addStringToBuffer(macbuffer,encryptionAlgorithm),_addStringToBuffer(macbuffer,comment),macbuffer.putInt32(pubbuffer.length()),macbuffer.putBuffer(pubbuffer),macbuffer.putInt32(privbuffer.length()),macbuffer.putBuffer(privbuffer);var hmac=forge.hmac.create();return hmac.start("sha1",mackey),hmac.update(macbuffer.bytes()),ppk+="\r\nPrivate-MAC: "+hmac.digest().toHex()+"\r\n"},ssh.publicKeyToOpenSSH=function(key,comment){var type="ssh-rsa";comment=comment||"";var buffer=forge.util.createBuffer();return _addStringToBuffer(buffer,type),_addBigIntegerToBuffer(buffer,key.e),_addBigIntegerToBuffer(buffer,key.n),type+" "+forge.util.encode64(buffer.bytes())+" "+comment},ssh.privateKeyToOpenSSH=function(privateKey,passphrase){return passphrase?forge.pki.encryptRsaPrivateKey(privateKey,passphrase,{legacy:!0,algorithm:"aes128"}):forge.pki.privateKeyToPem(privateKey)},ssh.getPublicKeyFingerprint=function(key,options){options=options||{};var md=options.md||forge.md.md5.create(),type="ssh-rsa",buffer=forge.util.createBuffer();_addStringToBuffer(buffer,type),_addBigIntegerToBuffer(buffer,key.e),_addBigIntegerToBuffer(buffer,key.n),md.start(),md.update(buffer.getBytes());var digest=md.digest();if("hex"===options.encoding){var hex=digest.toHex();return options.delimiter?hex.match(/.{2}/g).join(options.delimiter):hex}if("binary"===options.encoding)return digest.getBytes();if(options.encoding)throw new Error('Unknown encoding "'+options.encoding+'".');return digest}}var name="ssh";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/ssh",["require","module","./aes","./hmac","./md5","./sha1","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){function initModule(forge){var cat="forge.task",sVL=0,sTasks={},sNextTaskId=0;forge.debug.set(cat,"tasks",sTasks);var sTaskQueues={};forge.debug.set(cat,"queues",sTaskQueues);var sNoTaskName="?",sMaxRecursions=30,sTimeSlice=20,READY="ready",RUNNING="running",BLOCKED="blocked",SLEEPING="sleeping",DONE="done",ERROR="error",STOP="stop",START="start",BLOCK="block",UNBLOCK="unblock",SLEEP="sleep",WAKEUP="wakeup",CANCEL="cancel",FAIL="fail",sStateTable={};sStateTable[READY]={},sStateTable[READY][STOP]=READY,sStateTable[READY][START]=RUNNING,sStateTable[READY][CANCEL]=DONE,sStateTable[READY][FAIL]=ERROR,sStateTable[RUNNING]={},sStateTable[RUNNING][STOP]=READY,sStateTable[RUNNING][START]=RUNNING,sStateTable[RUNNING][BLOCK]=BLOCKED,sStateTable[RUNNING][UNBLOCK]=RUNNING,sStateTable[RUNNING][SLEEP]=SLEEPING,sStateTable[RUNNING][WAKEUP]=RUNNING,sStateTable[RUNNING][CANCEL]=DONE,sStateTable[RUNNING][FAIL]=ERROR,sStateTable[BLOCKED]={},sStateTable[BLOCKED][STOP]=BLOCKED,sStateTable[BLOCKED][START]=BLOCKED,sStateTable[BLOCKED][BLOCK]=BLOCKED,sStateTable[BLOCKED][UNBLOCK]=BLOCKED,sStateTable[BLOCKED][SLEEP]=BLOCKED,sStateTable[BLOCKED][WAKEUP]=BLOCKED,sStateTable[BLOCKED][CANCEL]=DONE,sStateTable[BLOCKED][FAIL]=ERROR,sStateTable[SLEEPING]={},sStateTable[SLEEPING][STOP]=SLEEPING,sStateTable[SLEEPING][START]=SLEEPING,sStateTable[SLEEPING][BLOCK]=SLEEPING,sStateTable[SLEEPING][UNBLOCK]=SLEEPING,sStateTable[SLEEPING][SLEEP]=SLEEPING,sStateTable[SLEEPING][WAKEUP]=SLEEPING,sStateTable[SLEEPING][CANCEL]=DONE,sStateTable[SLEEPING][FAIL]=ERROR,sStateTable[DONE]={},sStateTable[DONE][STOP]=DONE,sStateTable[DONE][START]=DONE,sStateTable[DONE][BLOCK]=DONE,sStateTable[DONE][UNBLOCK]=DONE,sStateTable[DONE][SLEEP]=DONE,sStateTable[DONE][WAKEUP]=DONE,sStateTable[DONE][CANCEL]=DONE,sStateTable[DONE][FAIL]=ERROR,sStateTable[ERROR]={},sStateTable[ERROR][STOP]=ERROR,sStateTable[ERROR][START]=ERROR,sStateTable[ERROR][BLOCK]=ERROR,sStateTable[ERROR][UNBLOCK]=ERROR,sStateTable[ERROR][SLEEP]=ERROR,sStateTable[ERROR][WAKEUP]=ERROR,sStateTable[ERROR][CANCEL]=ERROR,sStateTable[ERROR][FAIL]=ERROR;var Task=function(options){this.id=-1,this.name=options.name||sNoTaskName,this.parent=options.parent||null,this.run=options.run,this.subtasks=[],this.error=!1,this.state=READY,this.blocks=0,this.timeoutId=null,this.swapTime=null,this.userData=null,this.id=sNextTaskId++,sTasks[this.id]=this,sVL>=1&&forge.log.verbose(cat,"[%s][%s] init",this.id,this.name,this)};Task.prototype.debug=function(msg){msg=msg||"",forge.log.debug(cat,msg,"[%s][%s] task:",this.id,this.name,this,"subtasks:",this.subtasks.length,"queue:",sTaskQueues)},Task.prototype.next=function(name,subrun){"function"==typeof name&&(subrun=name,name=this.name);var subtask=new Task({run:subrun,name:name,parent:this});return subtask.state=RUNNING,subtask.type=this.type,subtask.successCallback=this.successCallback||null,subtask.failureCallback=this.failureCallback||null,this.subtasks.push(subtask),this},Task.prototype.parallel=function(name,subrun){return forge.util.isArray(name)&&(subrun=name,name=this.name),this.next(name,function(task){var ptask=task;ptask.block(subrun.length);for(var startParallelTask=function(pname,pi){forge.task.start({type:pname,run:function(task){subrun[pi](task)},success:function(task){ptask.unblock()},failure:function(task){ptask.unblock()}})},i=0;i<subrun.length;i++){var pname=name+"__parallel-"+task.id+"-"+i,pi=i;startParallelTask(pname,pi)}})},Task.prototype.stop=function(){this.state=sStateTable[this.state][STOP]},Task.prototype.start=function(){this.error=!1,this.state=sStateTable[this.state][START],this.state===RUNNING&&(this.start=new Date,this.run(this),runNext(this,0))},Task.prototype.block=function(n){n="undefined"==typeof n?1:n,this.blocks+=n,this.blocks>0&&(this.state=sStateTable[this.state][BLOCK])},Task.prototype.unblock=function(n){return n="undefined"==typeof n?1:n,this.blocks-=n,0===this.blocks&&this.state!==DONE&&(this.state=RUNNING,runNext(this,0)),this.blocks},Task.prototype.sleep=function(n){n="undefined"==typeof n?0:n,this.state=sStateTable[this.state][SLEEP];var self=this;this.timeoutId=setTimeout(function(){self.timeoutId=null,self.state=RUNNING,runNext(self,0)},n)},Task.prototype.wait=function(cond){cond.wait(this)},Task.prototype.wakeup=function(){this.state===SLEEPING&&(cancelTimeout(this.timeoutId),this.timeoutId=null,this.state=RUNNING,runNext(this,0))},Task.prototype.cancel=function(){this.state=sStateTable[this.state][CANCEL],this.permitsNeeded=0,null!==this.timeoutId&&(cancelTimeout(this.timeoutId),this.timeoutId=null),this.subtasks=[]},Task.prototype.fail=function(next){if(this.error=!0,finish(this,!0),next)next.error=this.error,next.swapTime=this.swapTime,next.userData=this.userData,runNext(next,0);else{if(null!==this.parent){for(var parent=this.parent;null!==parent.parent;)parent.error=this.error,parent.swapTime=this.swapTime,parent.userData=this.userData,parent=parent.parent;finish(parent,!0)}this.failureCallback&&this.failureCallback(this)}};var start=function(task){task.error=!1,task.state=sStateTable[task.state][START],setTimeout(function(){task.state===RUNNING&&(task.swapTime=+new Date,task.run(task),runNext(task,0))},0)},runNext=function(task,recurse){var swap=recurse>sMaxRecursions||+new Date-task.swapTime>sTimeSlice,doNext=function(recurse){if(recurse++,task.state===RUNNING)if(swap&&(task.swapTime=+new Date),task.subtasks.length>0){var subtask=task.subtasks.shift();subtask.error=task.error,subtask.swapTime=task.swapTime,subtask.userData=task.userData,subtask.run(subtask),subtask.error||runNext(subtask,recurse)}else finish(task),task.error||null!==task.parent&&(task.parent.error=task.error,task.parent.swapTime=task.swapTime,task.parent.userData=task.userData,runNext(task.parent,recurse))};swap?setTimeout(doNext,0):doNext(recurse)},finish=function(task,suppressCallbacks){task.state=DONE,delete sTasks[task.id],sVL>=1&&forge.log.verbose(cat,"[%s][%s] finish",task.id,task.name,task),null===task.parent&&(task.type in sTaskQueues?0===sTaskQueues[task.type].length?forge.log.error(cat,"[%s][%s] task queue empty [%s]",task.id,task.name,task.type):sTaskQueues[task.type][0]!==task?forge.log.error(cat,"[%s][%s] task not first in queue [%s]",task.id,task.name,task.type):(sTaskQueues[task.type].shift(),0===sTaskQueues[task.type].length?(sVL>=1&&forge.log.verbose(cat,"[%s][%s] delete queue [%s]",task.id,task.name,task.type),delete sTaskQueues[task.type]):(sVL>=1&&forge.log.verbose(cat,"[%s][%s] queue start next [%s] remain:%s",task.id,task.name,task.type,sTaskQueues[task.type].length),sTaskQueues[task.type][0].start())):forge.log.error(cat,"[%s][%s] task queue missing [%s]",task.id,task.name,task.type),suppressCallbacks||(task.error&&task.failureCallback?task.failureCallback(task):!task.error&&task.successCallback&&task.successCallback(task)))};forge.task=forge.task||{},forge.task.start=function(options){var task=new Task({run:options.run,name:options.name||sNoTaskName});task.type=options.type,task.successCallback=options.success||null,task.failureCallback=options.failure||null,task.type in sTaskQueues?sTaskQueues[options.type].push(task):(sVL>=1&&forge.log.verbose(cat,"[%s][%s] create queue [%s]",task.id,task.name,task.type),sTaskQueues[task.type]=[task],start(task))},forge.task.cancel=function(type){type in sTaskQueues&&(sTaskQueues[type]=[sTaskQueues[type][0]])},forge.task.createCondition=function(){var cond={tasks:{}};return cond.wait=function(task){task.id in cond.tasks||(task.block(),cond.tasks[task.id]=task)},cond.notify=function(){var tmp=cond.tasks;cond.tasks={};for(var id in tmp)tmp[id].unblock()},cond}}var name="task";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),initModule(forge);var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)}).concat(initModule);if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge[name]}},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/task",["require","module","./debug","./log","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),function(){var name="forge";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return void("undefined"==typeof forge&&(forge={disableNativeCode:!1}));var nodeJS=!0;define=function(ids,factory){factory(require,module)}}var deps,defineFunc=function(require,module){module.exports=function(forge){var mods=deps.map(function(dep){return require(dep)});if(forge=forge||{},forge.defined=forge.defined||{},forge.defined[name])return forge[name];forge.defined[name]=!0;for(var i=0;i<mods.length;++i)mods[i](forge);return forge},module.exports.disableNativeCode=!1,module.exports(module.exports)},tmpDefine=define;(define=function(ids,factory){return deps="string"==typeof ids?factory.slice(2):ids.slice(2),nodeJS?(delete define,tmpDefine.apply(null,Array.prototype.slice.call(arguments,0))):(define=tmpDefine,define.apply(null,Array.prototype.slice.call(arguments,0)))})("js/forge",["require","module","./aes","./aesCipherSuites","./asn1","./cipher","./cipherModes","./debug","./des","./hmac","./kem","./log","./md","./mgf1","./pbkdf2","./pem","./pkcs7","./pkcs1","./pkcs12","./pki","./prime","./prng","./pss","./random","./rc2","./ssh","./task","./tls","./util"],function(){defineFunc.apply(null,Array.prototype.slice.call(arguments,0))})}(),require("js/forge")}),!function(t,e,i){function n(){var e=t.L;o.noConflict=function(){return t.L=e,this},t.L=o}var o={version:"1.0.1+ffcfcc1"};"object"==typeof module&&"object"==typeof module.exports?module.exports=o:"function"==typeof define&&define.amd&&define(o),"undefined"!=typeof t&&n(),o.Util={extend:function(t){var e,i,n,o;for(i=1,n=arguments.length;i<n;i++){o=arguments[i];for(e in o)t[e]=o[e]}return t},create:Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}(),bind:function(t,e){var i=Array.prototype.slice;if(t.bind)return t.bind.apply(t,i.call(arguments,1));var n=i.call(arguments,2);return function(){return t.apply(e,n.length?n.concat(i.call(arguments)):arguments)}},stamp:function(t){return t._leaflet_id=t._leaflet_id||++o.Util.lastId,t._leaflet_id},lastId:0,throttle:function(t,e,i){var n,o,s,r;return r=function(){n=!1,o&&(s.apply(i,o),o=!1)},s=function(){n?o=arguments:(t.apply(i,arguments),setTimeout(r,e),n=!0)}},wrapNum:function(t,e,i){var n=e[1],o=e[0],s=n-o;return t===n&&i?t:((t-o)%s+s)%s+o},falseFn:function(){return!1},formatNum:function(t,e){var i=Math.pow(10,e||5);return Math.round(t*i)/i},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return o.Util.trim(t).split(/\s+/)},setOptions:function(t,e){t.hasOwnProperty("options")||(t.options=t.options?o.Util.create(t.options):{});for(var i in e)t.options[i]=e[i];return t.options},getParamString:function(t,e,i){var n=[];for(var o in t)n.push(encodeURIComponent(i?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(e&&e.indexOf("?")!==-1?"&":"?")+n.join("&")},template:function(t,e){return t.replace(o.Util.templateRe,function(t,n){var o=e[n];if(o===i)throw new Error("No value provided for variable "+t);return"function"==typeof o&&(o=o(e)),o})},templateRe:/\{ *([\w_\-]+) *\}/g,isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},indexOf:function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function e(e){return t["webkit"+e]||t["moz"+e]||t["ms"+e]}function i(e){var i=+new Date,o=Math.max(0,16-(i-n));return n=i+o,t.setTimeout(e,o)}var n=0,s=t.requestAnimationFrame||e("RequestAnimationFrame")||i,r=t.cancelAnimationFrame||e("CancelAnimationFrame")||e("CancelRequestAnimationFrame")||function(e){t.clearTimeout(e)};o.Util.requestAnimFrame=function(e,n,r){return r&&s===i?void e.call(n):s.call(t,o.bind(e,n))},o.Util.cancelAnimFrame=function(e){e&&r.call(t,e)}}(),o.extend=o.Util.extend,o.bind=o.Util.bind,o.stamp=o.Util.stamp,o.setOptions=o.Util.setOptions,o.Class=function(){},o.Class.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},i=e.__super__=this.prototype,n=o.Util.create(i);n.constructor=e,e.prototype=n;for(var s in this)this.hasOwnProperty(s)&&"prototype"!==s&&(e[s]=this[s]);return t.statics&&(o.extend(e,t.statics),delete t.statics),t.includes&&(o.Util.extend.apply(null,[n].concat(t.includes)),delete t.includes),n.options&&(t.options=o.Util.extend(o.Util.create(n.options),t.options)),o.extend(n,t),n._initHooks=[],n.callInitHooks=function(){if(!this._initHooksCalled){i.callInitHooks&&i.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=n._initHooks.length;t<e;t++)n._initHooks[t].call(this)}},e},o.Class.include=function(t){return o.extend(this.prototype,t),this},o.Class.mergeOptions=function(t){return o.extend(this.prototype.options,t),this},o.Class.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i),this},o.Evented=o.Class.extend({on:function(t,e,i){if("object"==typeof t)for(var n in t)this._on(n,t[n],e);else{t=o.Util.splitWords(t);for(var s=0,r=t.length;s<r;s++)this._on(t[s],e,i)}return this},off:function(t,e,i){if(t)if("object"==typeof t)for(var n in t)this._off(n,t[n],e);else{t=o.Util.splitWords(t);for(var s=0,r=t.length;s<r;s++)this._off(t[s],e,i)}else delete this._events;return this},_on:function(t,e,n){this._events=this._events||{};var o=this._events[t];o||(o=[],this._events[t]=o),n===this&&(n=i);for(var s={fn:e,ctx:n},r=o,a=0,h=r.length;a<h;a++)if(r[a].fn===e&&r[a].ctx===n)return;r.push(s),o.count++},_off:function(t,e,n){var s,r,a;if(this._events&&(s=this._events[t])){if(!e){for(r=0,a=s.length;r<a;r++)s[r].fn=o.Util.falseFn;return void delete this._events[t]}if(n===this&&(n=i),s)for(r=0,a=s.length;r<a;r++){var h=s[r];if(h.ctx===n&&h.fn===e)return h.fn=o.Util.falseFn,this._firingCount&&(this._events[t]=s=s.slice()),void s.splice(r,1)}}},fire:function(t,e,i){if(!this.listens(t,i))return this;var n=o.Util.extend({},e,{type:t,target:this});if(this._events){var s=this._events[t];if(s){this._firingCount=this._firingCount+1||1;for(var r=0,a=s.length;r<a;r++){var h=s[r];h.fn.call(h.ctx||this,n)}this._firingCount--}}return i&&this._propagateEvent(n),this},listens:function(t,e){var i=this._events&&this._events[t];if(i&&i.length)return!0;if(e)for(var n in this._eventParents)if(this._eventParents[n].listens(t,e))return!0;return!1},once:function(t,e,i){if("object"==typeof t){for(var n in t)this.once(n,t[n],e);return this}var s=o.bind(function(){this.off(t,e,i).off(t,s,i)},this);return this.on(t,e,i).on(t,s,i)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[o.stamp(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[o.stamp(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,o.extend({layer:t.target},t),!0)}});var s=o.Evented.prototype;s.addEventListener=s.on,s.removeEventListener=s.clearAllEventListeners=s.off,s.addOneTimeEventListener=s.once,s.fireEvent=s.fire,s.hasEventListeners=s.listens,o.Mixin={Events:s},function(){var i=navigator.userAgent.toLowerCase(),n=e.documentElement,s="ActiveXObject"in t,r=i.indexOf("webkit")!==-1,a=i.indexOf("phantom")!==-1,h=i.search("android [23]")!==-1,l=i.indexOf("chrome")!==-1,u=i.indexOf("gecko")!==-1&&!r&&!t.opera&&!s,c=0===navigator.platform.indexOf("Win"),d="undefined"!=typeof orientation||i.indexOf("mobile")!==-1,_=!t.PointerEvent&&t.MSPointerEvent,m=t.PointerEvent||_,p=s&&"transition"in n.style,f="WebKitCSSMatrix"in t&&"m11"in new t.WebKitCSSMatrix&&!h,g="MozPerspective"in n.style,v="OTransition"in n.style,y=!t.L_NO_TOUCH&&(m||"ontouchstart"in t||t.DocumentTouch&&e instanceof t.DocumentTouch);o.Browser={ie:s,ielt9:s&&!e.addEventListener,edge:"msLaunchUri"in navigator&&!("documentMode"in e),webkit:r,gecko:u,android:i.indexOf("android")!==-1,android23:h,chrome:l,safari:!l&&i.indexOf("safari")!==-1,win:c,ie3d:p,webkit3d:f,gecko3d:g,opera12:v,any3d:!t.L_DISABLE_3D&&(p||f||g)&&!v&&!a,mobile:d,mobileWebkit:d&&r,mobileWebkit3d:d&&f,mobileOpera:d&&t.opera,mobileGecko:d&&u,touch:!!y,msPointer:!!_,pointer:!!m,retina:(t.devicePixelRatio||t.screen.deviceXDPI/t.screen.logicalXDPI)>1}}(),o.Point=function(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e},o.Point.prototype={clone:function(){return new o.Point(this.x,this.y)},add:function(t){return this.clone()._add(o.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(o.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new o.Point(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new o.Point(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},distanceTo:function(t){t=o.point(t);var e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return t=o.point(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=o.point(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+o.Util.formatNum(this.x)+", "+o.Util.formatNum(this.y)+")"}},o.point=function(t,e,n){return t instanceof o.Point?t:o.Util.isArray(t)?new o.Point(t[0],t[1]):t===i||null===t?t:"object"==typeof t&&"x"in t&&"y"in t?new o.Point(t.x,t.y):new o.Point(t,e,n)},o.Bounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;n<o;n++)this.extend(i[n])},o.Bounds.prototype={extend:function(t){return t=o.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new o.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new o.Point(this.min.x,this.max.y)},getTopRight:function(){return new o.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return t="number"==typeof t[0]||t instanceof o.Point?o.point(t):o.bounds(t),t instanceof o.Bounds?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=o.bounds(t);var e=this.min,i=this.max,n=t.min,s=t.max,r=s.x>=e.x&&n.x<=i.x,a=s.y>=e.y&&n.y<=i.y;return r&&a},overlaps:function(t){t=o.bounds(t);var e=this.min,i=this.max,n=t.min,s=t.max,r=s.x>e.x&&n.x<i.x,a=s.y>e.y&&n.y<i.y;return r&&a},isValid:function(){return!(!this.min||!this.max)}},o.bounds=function(t,e){return!t||t instanceof o.Bounds?t:new o.Bounds(t,e)},o.Transformation=function(t,e,i,n){this._a=t,this._b=e,this._c=i,this._d=n},o.Transformation.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new o.Point((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}},o.DomUtil={get:function(t){return"string"==typeof t?e.getElementById(t):t},getStyle:function(t,i){var n=t.style[i]||t.currentStyle&&t.currentStyle[i];if((!n||"auto"===n)&&e.defaultView){var o=e.defaultView.getComputedStyle(t,null);n=o?o[i]:null}return"auto"===n?null:n},create:function(t,i,n){var o=e.createElement(t);return o.className=i||"",n&&n.appendChild(o),o},remove:function(t){var e=t.parentNode;e&&e.removeChild(t)},empty:function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},toFront:function(t){t.parentNode.appendChild(t)},toBack:function(t){var e=t.parentNode;e.insertBefore(t,e.firstChild)},hasClass:function(t,e){if(t.classList!==i)return t.classList.contains(e);var n=o.DomUtil.getClass(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)},addClass:function(t,e){if(t.classList!==i)for(var n=o.Util.splitWords(e),s=0,r=n.length;s<r;s++)t.classList.add(n[s]);else if(!o.DomUtil.hasClass(t,e)){var a=o.DomUtil.getClass(t);o.DomUtil.setClass(t,(a?a+" ":"")+e)}},removeClass:function(t,e){t.classList!==i?t.classList.remove(e):o.DomUtil.setClass(t,o.Util.trim((" "+o.DomUtil.getClass(t)+" ").replace(" "+e+" "," ")))},setClass:function(t,e){t.className.baseVal===i?t.className=e:t.className.baseVal=e},getClass:function(t){return t.className.baseVal===i?t.className:t.className.baseVal},setOpacity:function(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&o.DomUtil._setOpacityIE(t,e)},_setOpacityIE:function(t,e){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(t){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"},testProp:function(t){for(var i=e.documentElement.style,n=0;n<t.length;n++)if(t[n]in i)return t[n];return!1},setTransform:function(t,e,i){var n=e||new o.Point(0,0);t.style[o.DomUtil.TRANSFORM]=(o.Browser.ie3d?"translate("+n.x+"px,"+n.y+"px)":"translate3d("+n.x+"px,"+n.y+"px,0)")+(i?" scale("+i+")":"")},setPosition:function(t,e){t._leaflet_pos=e,o.Browser.any3d?o.DomUtil.setTransform(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos||new o.Point(0,0)}},function(){o.DomUtil.TRANSFORM=o.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);var i=o.DomUtil.TRANSITION=o.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);if(o.DomUtil.TRANSITION_END="webkitTransition"===i||"OTransition"===i?i+"End":"transitionend","onselectstart"in e)o.DomUtil.disableTextSelection=function(){o.DomEvent.on(t,"selectstart",o.DomEvent.preventDefault)},o.DomUtil.enableTextSelection=function(){
o.DomEvent.off(t,"selectstart",o.DomEvent.preventDefault)};else{var n=o.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);o.DomUtil.disableTextSelection=function(){if(n){var t=e.documentElement.style;this._userSelect=t[n],t[n]="none"}},o.DomUtil.enableTextSelection=function(){n&&(e.documentElement.style[n]=this._userSelect,delete this._userSelect)}}o.DomUtil.disableImageDrag=function(){o.DomEvent.on(t,"dragstart",o.DomEvent.preventDefault)},o.DomUtil.enableImageDrag=function(){o.DomEvent.off(t,"dragstart",o.DomEvent.preventDefault)},o.DomUtil.preventOutline=function(e){for(;e.tabIndex===-1;)e=e.parentNode;e&&e.style&&(o.DomUtil.restoreOutline(),this._outlineElement=e,this._outlineStyle=e.style.outline,e.style.outline="none",o.DomEvent.on(t,"keydown",o.DomUtil.restoreOutline,this))},o.DomUtil.restoreOutline=function(){this._outlineElement&&(this._outlineElement.style.outline=this._outlineStyle,delete this._outlineElement,delete this._outlineStyle,o.DomEvent.off(t,"keydown",o.DomUtil.restoreOutline,this))}}(),o.LatLng=function(t,e,n){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,n!==i&&(this.alt=+n)},o.LatLng.prototype={equals:function(t,e){if(!t)return!1;t=o.latLng(t);var n=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return n<=(e===i?1e-9:e)},toString:function(t){return"LatLng("+o.Util.formatNum(this.lat,t)+", "+o.Util.formatNum(this.lng,t)+")"},distanceTo:function(t){return o.CRS.Earth.distance(this,o.latLng(t))},wrap:function(){return o.CRS.Earth.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return o.latLngBounds([this.lat-e,this.lng-i],[this.lat+e,this.lng+i])},clone:function(){return new o.LatLng(this.lat,this.lng,this.alt)}},o.latLng=function(t,e,n){return t instanceof o.LatLng?t:o.Util.isArray(t)&&"object"!=typeof t[0]?3===t.length?new o.LatLng(t[0],t[1],t[2]):2===t.length?new o.LatLng(t[0],t[1]):null:t===i||null===t?t:"object"==typeof t&&"lat"in t?new o.LatLng(t.lat,"lng"in t?t.lng:t.lon,t.alt):e===i?null:new o.LatLng(t,e,n)},o.LatLngBounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;n<o;n++)this.extend(i[n])},o.LatLngBounds.prototype={extend:function(t){var e,i,n=this._southWest,s=this._northEast;if(t instanceof o.LatLng)e=t,i=t;else{if(!(t instanceof o.LatLngBounds))return t?this.extend(o.latLng(t)||o.latLngBounds(t)):this;if(e=t._southWest,i=t._northEast,!e||!i)return this}return n||s?(n.lat=Math.min(e.lat,n.lat),n.lng=Math.min(e.lng,n.lng),s.lat=Math.max(i.lat,s.lat),s.lng=Math.max(i.lng,s.lng)):(this._southWest=new o.LatLng(e.lat,e.lng),this._northEast=new o.LatLng(i.lat,i.lng)),this},pad:function(t){var e=this._southWest,i=this._northEast,n=Math.abs(e.lat-i.lat)*t,s=Math.abs(e.lng-i.lng)*t;return new o.LatLngBounds(new o.LatLng(e.lat-n,e.lng-s),new o.LatLng(i.lat+n,i.lng+s))},getCenter:function(){return new o.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new o.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new o.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof o.LatLng?o.latLng(t):o.latLngBounds(t);var e,i,n=this._southWest,s=this._northEast;return t instanceof o.LatLngBounds?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=n.lat&&i.lat<=s.lat&&e.lng>=n.lng&&i.lng<=s.lng},intersects:function(t){t=o.latLngBounds(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),s=t.getNorthEast(),r=s.lat>=e.lat&&n.lat<=i.lat,a=s.lng>=e.lng&&n.lng<=i.lng;return r&&a},overlaps:function(t){t=o.latLngBounds(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),s=t.getNorthEast(),r=s.lat>e.lat&&n.lat<i.lat,a=s.lng>e.lng&&n.lng<i.lng;return r&&a},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t){return!!t&&(t=o.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast()))},isValid:function(){return!(!this._southWest||!this._northEast)}},o.latLngBounds=function(t,e){return t instanceof o.LatLngBounds?t:new o.LatLngBounds(t,e)},o.Projection={},o.Projection.LonLat={project:function(t){return new o.Point(t.lng,t.lat)},unproject:function(t){return new o.LatLng(t.y,t.x)},bounds:o.bounds([-180,-90],[180,90])},o.Projection.SphericalMercator={R:6378137,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),s=Math.sin(n*e);return new o.Point(this.R*t.lng*e,this.R*Math.log((1+s)/(1-s))/2)},unproject:function(t){var e=180/Math.PI;return new o.LatLng((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:function(){var t=6378137*Math.PI;return o.bounds([-t,-t],[t,t])}()},o.CRS={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,i=this.scale(t),n=this.transformation.transform(e.min,i),s=this.transformation.transform(e.max,i);return o.bounds(n,s)},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?o.Util.wrapNum(t.lng,this.wrapLng,!0):t.lng,i=this.wrapLat?o.Util.wrapNum(t.lat,this.wrapLat,!0):t.lat,n=t.alt;return o.latLng(i,e,n)}},o.CRS.Simple=o.extend({},o.CRS,{projection:o.Projection.LonLat,transformation:new o.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var i=e.lng-t.lng,n=e.lat-t.lat;return Math.sqrt(i*i+n*n)},infinite:!0}),o.CRS.Earth=o.extend({},o.CRS,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var i=Math.PI/180,n=t.lat*i,o=e.lat*i,s=Math.sin(n)*Math.sin(o)+Math.cos(n)*Math.cos(o)*Math.cos((e.lng-t.lng)*i);return this.R*Math.acos(Math.min(s,1))}}),o.CRS.EPSG3857=o.extend({},o.CRS.Earth,{code:"EPSG:3857",projection:o.Projection.SphericalMercator,transformation:function(){var t=.5/(Math.PI*o.Projection.SphericalMercator.R);return new o.Transformation(t,.5,-t,.5)}()}),o.CRS.EPSG900913=o.extend({},o.CRS.EPSG3857,{code:"EPSG:900913"}),o.CRS.EPSG4326=o.extend({},o.CRS.Earth,{code:"EPSG:4326",projection:o.Projection.LonLat,transformation:new o.Transformation(1/180,1,-1/180,.5)}),o.Map=o.Evented.extend({options:{crs:o.CRS.EPSG3857,center:i,zoom:i,minZoom:i,maxZoom:i,layers:[],maxBounds:i,renderer:i,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=o.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=o.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.zoom!==i&&(this._zoom=this._limitZoom(e.zoom)),e.center&&e.zoom!==i&&this.setView(o.latLng(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this.callInitHooks(),this._addLayers(this.options.layers)},setView:function(t,e){return e=e===i?this.getZoom():e,this._resetView(o.latLng(t),e),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(o.Browser.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(o.Browser.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,i){var n=this.getZoomScale(e),s=this.getSize().divideBy(2),r=t instanceof o.Point?t:this.latLngToContainerPoint(t),a=r.subtract(s).multiplyBy(1-1/n),h=this.containerPointToLatLng(s.add(a));return this.setView(h,e,{zoom:i})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():o.latLngBounds(t);var i=o.point(e.paddingTopLeft||e.padding||[0,0]),n=o.point(e.paddingBottomRight||e.padding||[0,0]),s=this.getBoundsZoom(t,!1,i.add(n));s="number"==typeof e.maxZoom?Math.min(e.maxZoom,s):s;var r=n.subtract(i).divideBy(2),a=this.project(t.getSouthWest(),s),h=this.project(t.getNorthEast(),s),l=this.unproject(a.add(h).divideBy(2).add(r),s);return{center:l,zoom:s}},fitBounds:function(t,e){if(t=o.latLngBounds(t),!t.isValid())throw new Error("Bounds are not valid.");var i=this._getBoundsCenterZoom(t,e);return this.setView(i.center,i.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t){return this.fire("movestart"),this._rawPanBy(o.point(t)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(t){return t=o.latLngBounds(t),t.isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(t){return this.options.minZoom=t,this._loaded&&this.getZoom()<this.options.minZoom?this.setZoom(t):this},setMaxZoom:function(t){return this.options.maxZoom=t,this._loaded&&this.getZoom()>this.options.maxZoom?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var i=this.getCenter(),n=this._limitCenter(i,this._zoom,o.latLngBounds(t));return i.equals(n)||this.panTo(n,e),this._enforcingBounds=!1,this},invalidateSize:function(t){if(!this._loaded)return this;t=o.extend({animate:!1,pan:!0},t===!0?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var i=this.getSize(),n=e.divideBy(2).round(),s=i.divideBy(2).round(),r=n.subtract(s);return r.x||r.y?(t.animate&&t.pan?this.panBy(r):(t.pan&&this._rawPanBy(r),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:i})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=i,this._containerId=i}o.DomUtil.remove(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this._loaded&&this.fire("unload");for(var t in this._layers)this._layers[t].remove();return this},createPane:function(t,e){var i="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),n=o.DomUtil.create("div",i,e||this._mapPane);return t&&(this._panes[t]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),i=this.unproject(t.getTopRight());return new o.LatLngBounds(e,i)},getMinZoom:function(){return this.options.minZoom===i?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===i?this._layersMaxZoom===i?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=o.latLngBounds(t),i=o.point(i||[0,0]);var n=this.getZoom()||0,s=this.getMinZoom(),r=this.getMaxZoom(),a=t.getNorthWest(),h=t.getSouthEast(),l=this.getSize().subtract(i),u=this.project(h,n).subtract(this.project(a,n)),c=o.Browser.any3d?this.options.zoomSnap:1,d=Math.min(l.x/u.x,l.y/u.y);return n=this.getScaleZoom(d,n),c&&(n=Math.round(n/(c/100))*(c/100),n=e?Math.ceil(n/c)*c:Math.floor(n/c)*c),Math.max(s,Math.min(r,n))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new o.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var i=this._getTopLeftPoint(t,e);return new o.Bounds(i,i.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===i?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var n=this.options.crs;return e=e===i?this._zoom:e,n.scale(t)/n.scale(e)},getScaleZoom:function(t,e){var n=this.options.crs;e=e===i?this._zoom:e;var o=n.zoom(t*n.scale(e));return isNaN(o)?1/0:o},project:function(t,e){return e=e===i?this._zoom:e,this.options.crs.latLngToPoint(o.latLng(t),e)},unproject:function(t,e){return e=e===i?this._zoom:e,this.options.crs.pointToLatLng(o.point(t),e)},layerPointToLatLng:function(t){var e=o.point(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){var e=this.project(o.latLng(t))._round();return e._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(o.latLng(t))},distance:function(t,e){return this.options.crs.distance(o.latLng(t),o.latLng(e))},containerPointToLayerPoint:function(t){return o.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return o.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(o.point(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(o.latLng(t)))},mouseEventToContainerPoint:function(t){return o.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=o.DomUtil.get(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");o.DomEvent.addListener(e,"scroll",this._onScroll,this),this._containerId=o.Util.stamp(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&o.Browser.any3d,o.DomUtil.addClass(t,"leaflet-container"+(o.Browser.touch?" leaflet-touch":"")+(o.Browser.retina?" leaflet-retina":"")+(o.Browser.ielt9?" leaflet-oldie":"")+(o.Browser.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=o.DomUtil.getStyle(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),o.DomUtil.setPosition(this._mapPane,new o.Point(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(o.DomUtil.addClass(t.markerPane,"leaflet-zoom-hide"),o.DomUtil.addClass(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e){o.DomUtil.setPosition(this._mapPane,new o.Point(0,0));var i=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var n=this._zoom!==e;this._moveStart(n)._move(t,e)._moveEnd(n),this.fire("viewreset"),i&&this.fire("load")},_moveStart:function(t){return t&&this.fire("zoomstart"),this.fire("movestart")},_move:function(t,e,n){e===i&&(e=this._zoom);var o=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),(o||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return o.Util.cancelAnimFrame(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){o.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){if(o.DomEvent){this._targets={},this._targets[o.stamp(this._container)]=this;var i=e?"off":"on";o.DomEvent[i](this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this),this.options.trackResize&&o.DomEvent[i](t,"resize",this._onResize,this),o.Browser.any3d&&this.options.transform3DLimit&&this[i]("moveend",this._onMoveEnd)}},_onResize:function(){o.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=o.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var i,n=[],s="mouseout"===e||"mouseover"===e,r=t.target||t.srcElement,a=!1;r;){if(i=this._targets[o.stamp(r)],i&&("click"===e||"preclick"===e)&&!t._simulated&&this._draggableMoved(i)){a=!0;break}if(i&&i.listens(e,!0)){if(s&&!o.DomEvent._isExternalTarget(r,t))break;if(n.push(i),s)break}if(r===this._container)break;r=r.parentNode}return n.length||a||s||!o.DomEvent._isExternalTarget(r,t)||(n=[this]),n},_handleDOMEvent:function(t){if(this._loaded&&!o.DomEvent._skipped(t)){var e="keypress"===t.type&&13===t.keyCode?"click":t.type;"mousedown"===e&&o.DomUtil.preventOutline(t.target||t.srcElement),this._fireDOMEvent(t,e)}},_fireDOMEvent:function(t,e,i){if("click"===t.type){var n=o.Util.extend({},t);n.type="preclick",this._fireDOMEvent(n,n.type,i)}if(!t._stopped&&(i=(i||[]).concat(this._findEventTargets(t,e)),i.length)){var s=i[0];"contextmenu"===e&&s.listens(e,!0)&&o.DomEvent.preventDefault(t);var r={originalEvent:t};if("keypress"!==t.type){var a=s instanceof o.Marker;r.containerPoint=a?this.latLngToContainerPoint(s.getLatLng()):this.mouseEventToContainerPoint(t),r.layerPoint=this.containerPointToLayerPoint(r.containerPoint),r.latlng=a?s.getLatLng():this.layerPointToLatLng(r.layerPoint)}for(var h=0;h<i.length;h++)if(i[h].fire(e,r,!0),r.originalEvent._stopped||i[h].options.nonBubblingEvents&&o.Util.indexOf(i[h].options.nonBubblingEvents,e)!==-1)return}},_draggableMoved:function(t){return t=t.dragging&&t.dragging.enabled()?t:this,t.dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return o.DomUtil.getPosition(this._mapPane)||new o.Point(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){var n=t&&e!==i?this._getNewPixelOrigin(t,e):this.getPixelOrigin();return n.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return this.project(t,e)._subtract(n)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var n=this.project(t,e),s=this.getSize().divideBy(2),r=new o.Bounds(n.subtract(s),n.add(s)),a=this._getBoundsOffset(r,i,e);return a.round().equals([0,0])?t:this.unproject(n.add(a),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),n=new o.Bounds(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(n,e))},_getBoundsOffset:function(t,e,i){var n=o.bounds(this.project(e.getNorthEast(),i),this.project(e.getSouthWest(),i)),s=n.min.subtract(t.min),r=n.max.subtract(t.max),a=this._rebound(s.x,-r.x),h=this._rebound(s.y,-r.y);return new o.Point(a,h)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom(),n=o.Browser.any3d?this.options.zoomSnap:1;return n&&(t=Math.round(t/n)*n),Math.max(e,Math.min(i,t))}}),o.map=function(t,e){return new o.Map(t,e)},o.Layer=o.Evented.extend({options:{pane:"overlayPane",nonBubblingEvents:[]},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[o.stamp(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[o.stamp(t)],this},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var i=this.getEvents();e.on(i,this),this.once("remove",function(){e.off(i,this)},this)}this.onAdd(e),this.getAttribution&&this._map.attributionControl&&this._map.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),e.fire("layeradd",{layer:this})}}}),o.Map.include({addLayer:function(t){var e=o.stamp(t);return this._layers[e]?this:(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var e=o.stamp(t);return this._layers[e]?(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return!!t&&o.stamp(t)in this._layers},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},_addLayers:function(t){t=t?o.Util.isArray(t)?t:[t]:[];for(var e=0,i=t.length;e<i;e++)this.addLayer(t[e])},_addZoomLimit:function(t){!isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[o.stamp(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=o.stamp(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-(1/0),n=this._getZoomSpan();for(var o in this._zoomBoundLayers){var s=this._zoomBoundLayers[o].options;t=s.minZoom===i?t:Math.min(t,s.minZoom),e=s.maxZoom===i?e:Math.max(e,s.maxZoom)}this._layersMaxZoom=e===-(1/0)?i:e,this._layersMinZoom=t===1/0?i:t,n!==this._getZoomSpan()&&this.fire("zoomlevelschange")}}),o.Projection.Mercator={R:6378137,R_MINOR:6356752.314245179,bounds:o.bounds([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,i=this.R,n=t.lat*e,s=this.R_MINOR/i,r=Math.sqrt(1-s*s),a=r*Math.sin(n),h=Math.tan(Math.PI/4-n/2)/Math.pow((1-a)/(1+a),r/2);return n=-i*Math.log(Math.max(h,1e-10)),new o.Point(t.lng*e*i,n)},unproject:function(t){for(var e,i=180/Math.PI,n=this.R,s=this.R_MINOR/n,r=Math.sqrt(1-s*s),a=Math.exp(-t.y/n),h=Math.PI/2-2*Math.atan(a),l=0,u=.1;l<15&&Math.abs(u)>1e-7;l++)e=r*Math.sin(h),e=Math.pow((1-e)/(1+e),r/2),u=Math.PI/2-2*Math.atan(a*e)-h,h+=u;return new o.LatLng(h*i,t.x*i/n)}},o.CRS.EPSG3395=o.extend({},o.CRS.Earth,{code:"EPSG:3395",projection:o.Projection.Mercator,transformation:function(){var t=.5/(Math.PI*o.Projection.Mercator.R);return new o.Transformation(t,.5,-t,.5)}()}),o.GridLayer=o.Layer.extend({options:{tileSize:256,opacity:1,updateWhenIdle:o.Browser.mobile,updateWhenZooming:!0,updateInterval:200,attribution:null,zIndex:1,bounds:null,minZoom:0,maxZoom:i,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){o.setOptions(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),o.DomUtil.remove(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=null},bringToFront:function(){return this._map&&(o.DomUtil.toFront(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(o.DomUtil.toBack(this._container),this._setAutoZIndex(Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=o.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return e.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof o.Point?t:new o.Point(t,t)},_updateZIndex:function(){this._container&&this.options.zIndex!==i&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,i=this.getPane().children,n=-t(-(1/0),1/0),o=0,s=i.length;o<s;o++)e=i[o].style.zIndex,i[o]!==this._container&&e&&(n=t(n,+e));isFinite(n)&&(this.options.zIndex=n+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!o.Browser.ielt9){o.DomUtil.setOpacity(this._container,this.options.opacity);var t=+new Date,e=!1,i=!1;for(var n in this._tiles){var s=this._tiles[n];if(s.current&&s.loaded){var r=Math.min(1,(t-s.loaded)/200);o.DomUtil.setOpacity(s.el,r),r<1?e=!0:(s.active&&(i=!0),s.active=!0)}}i&&!this._noPrune&&this._pruneTiles(),e&&(o.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=o.Util.requestAnimFrame(this._updateOpacity,this))}},_initContainer:function(){this._container||(this._container=o.DomUtil.create("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(t===i)return i;for(var n in this._levels)this._levels[n].el.children.length||n===t?this._levels[n].el.style.zIndex=e-Math.abs(t-n):(o.DomUtil.remove(this._levels[n].el),this._removeTilesAtZoom(n),delete this._levels[n]);var s=this._levels[t],r=this._map;return s||(s=this._levels[t]={},s.el=o.DomUtil.create("div","leaflet-tile-container leaflet-zoom-animated",this._container),s.el.style.zIndex=e,s.origin=r.project(r.unproject(r.getPixelOrigin()),t).round(),s.zoom=t,this._setZoomTransform(s,r.getCenter(),r.getZoom()),o.Util.falseFn(s.el.offsetWidth)),this._level=s,s},_pruneTiles:function(){if(this._map){var t,e,i=this._map.getZoom();if(i>this.options.maxZoom||i<this.options.minZoom)return void this._removeAllTiles();for(t in this._tiles)e=this._tiles[t],e.retain=e.current;for(t in this._tiles)if(e=this._tiles[t],e.current&&!e.active){var n=e.coords;this._retainParent(n.x,n.y,n.z,n.z-5)||this._retainChildren(n.x,n.y,n.z,n.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)o.DomUtil.remove(this._levels[t].el),delete this._levels[t];this._removeAllTiles(),this._tileZoom=null},_retainParent:function(t,e,i,n){var s=Math.floor(t/2),r=Math.floor(e/2),a=i-1,h=new o.Point(+s,+r);h.z=+a;var l=this._tileCoordsToKey(h),u=this._tiles[l];return u&&u.active?(u.retain=!0,!0):(u&&u.loaded&&(u.retain=!0),a>n&&this._retainParent(s,r,a,n))},_retainChildren:function(t,e,i,n){for(var s=2*t;s<2*t+2;s++)for(var r=2*e;r<2*e+2;r++){var a=new o.Point(s,r);a.z=i+1;var h=this._tileCoordsToKey(a),l=this._tiles[h];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),i+1<n&&this._retainChildren(s,r,i+1,n))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_setView:function(t,e,n,o){var s=Math.round(e);(this.options.maxZoom!==i&&s>this.options.maxZoom||this.options.minZoom!==i&&s<this.options.minZoom)&&(s=i);var r=this.options.updateWhenZooming&&s!==this._tileZoom;o&&!r||(this._tileZoom=s,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),s!==i&&this._update(t),n||this._pruneTiles(),this._noPrune=!!n),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var i in this._levels)this._setZoomTransform(this._levels[i],t,e)},_setZoomTransform:function(t,e,i){var n=this._map.getZoomScale(i,t.zoom),s=t.origin.multiplyBy(n).subtract(this._map._getNewPixelOrigin(e,i)).round();o.Browser.any3d?o.DomUtil.setTransform(t.el,s,n):o.DomUtil.setPosition(t.el,s)},_resetGrid:function(){var t=this._map,e=t.options.crs,i=this._tileSize=this.getTileSize(),n=this._tileZoom,o=this._map.getPixelWorldBounds(this._tileZoom);o&&(this._globalTileRange=this._pxBoundsToTileRange(o)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],n).x/i.x),Math.ceil(t.project([0,e.wrapLng[1]],n).x/i.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],n).y/i.x),Math.ceil(t.project([e.wrapLat[1],0],n).y/i.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,i=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),n=e.getZoomScale(i,this._tileZoom),s=e.project(t,this._tileZoom).floor(),r=e.getSize().divideBy(2*n);return new o.Bounds(s.subtract(r),s.add(r))},_update:function(t){var n=this._map;if(n){var s=n.getZoom();if(t===i&&(t=n.getCenter()),this._tileZoom!==i){var r=this._getTiledPixelBounds(t),a=this._pxBoundsToTileRange(r),h=a.getCenter(),l=[],u=this.options.keepBuffer,c=new o.Bounds(a.getBottomLeft().subtract([u,-u]),a.getTopRight().add([u,-u]));for(var d in this._tiles){var _=this._tiles[d].coords;_.z===this._tileZoom&&c.contains(o.point(_.x,_.y))||(this._tiles[d].current=!1)}if(Math.abs(s-this._tileZoom)>1)return void this._setView(t,s);for(var m=a.min.y;m<=a.max.y;m++)for(var p=a.min.x;p<=a.max.x;p++){var f=new o.Point(p,m);if(f.z=this._tileZoom,this._isValidTile(f)){var g=this._tiles[this._tileCoordsToKey(f)];g?g.current=!0:l.push(f)}}if(l.sort(function(t,e){return t.distanceTo(h)-e.distanceTo(h)}),0!==l.length){this._loading||(this._loading=!0,this.fire("loading"));var v=e.createDocumentFragment();for(p=0;p<l.length;p++)this._addTile(l[p],v);this._level.el.appendChild(v)}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var i=this._globalTileRange;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;
var n=this._tileCoordsToBounds(t);return o.latLngBounds(this.options.bounds).overlaps(n)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToBounds:function(t){var e=this._map,i=this.getTileSize(),n=t.scaleBy(i),s=n.add(i),r=e.unproject(n,t.z),a=e.unproject(s,t.z);return this.options.noWrap||(r=e.wrapLatLng(r),a=e.wrapLatLng(a)),new o.LatLngBounds(r,a)},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),i=new o.Point(+e[0],+e[1]);return i.z=+e[2],i},_removeTile:function(t){var e=this._tiles[t];e&&(o.DomUtil.remove(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){o.DomUtil.addClass(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=o.Util.falseFn,t.onmousemove=o.Util.falseFn,o.Browser.ielt9&&this.options.opacity<1&&o.DomUtil.setOpacity(t,this.options.opacity),o.Browser.android&&!o.Browser.android23&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,e){var i=this._getTilePos(t),n=this._tileCoordsToKey(t),s=this.createTile(this._wrapCoords(t),o.bind(this._tileReady,this,t));this._initTile(s),this.createTile.length<2&&o.Util.requestAnimFrame(o.bind(this._tileReady,this,t,null,s)),o.DomUtil.setPosition(s,i),this._tiles[n]={el:s,coords:t,current:!0},e.appendChild(s),this.fire("tileloadstart",{tile:s,coords:t})},_tileReady:function(t,e,i){if(this._map){e&&this.fire("tileerror",{error:e,tile:i,coords:t});var n=this._tileCoordsToKey(t);i=this._tiles[n],i&&(i.loaded=+new Date,this._map._fadeAnimated?(o.DomUtil.setOpacity(i.el,0),o.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=o.Util.requestAnimFrame(this._updateOpacity,this)):(i.active=!0,this._pruneTiles()),e||(o.DomUtil.addClass(i.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:i.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),o.Browser.ielt9||!this._map._fadeAnimated?o.Util.requestAnimFrame(this._pruneTiles,this):setTimeout(o.bind(this._pruneTiles,this),250)))}},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new o.Point(this._wrapX?o.Util.wrapNum(t.x,this._wrapX):t.x,this._wrapY?o.Util.wrapNum(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new o.Bounds(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}}),o.gridLayer=function(t){return new o.GridLayer(t)},o.TileLayer=o.GridLayer.extend({options:{minZoom:0,maxZoom:18,maxNativeZoom:null,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(t,e){this._url=t,e=o.setOptions(this,e),e.detectRetina&&o.Browser.retina&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom++):(e.zoomOffset++,e.maxZoom--),e.minZoom=Math.max(0,e.minZoom)),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),o.Browser.android||this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},createTile:function(t,i){var n=e.createElement("img");return o.DomEvent.on(n,"load",o.bind(this._tileOnLoad,this,i,n)),o.DomEvent.on(n,"error",o.bind(this._tileOnError,this,i,n)),this.options.crossOrigin&&(n.crossOrigin=""),n.alt="",n.src=this.getTileUrl(t),n},getTileUrl:function(t){var e={r:o.Browser.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var i=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=i),e["-y"]=i}return o.Util.template(this._url,o.extend(e,this.options))},_tileOnLoad:function(t,e){o.Browser.ielt9?setTimeout(o.bind(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,i){var n=this.options.errorTileUrl;n&&(e.src=n),t(i,e)},getTileSize:function(){var t=this._map,e=o.GridLayer.prototype.getTileSize.call(this),i=this._tileZoom+this.options.zoomOffset,n=this.options.maxNativeZoom;return null!==n&&i>n?e.divideBy(t.getZoomScale(n,i)).round():e},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this.options,e=this._tileZoom;return t.zoomReverse&&(e=t.maxZoom-e),e+=t.zoomOffset,null!==t.maxNativeZoom?Math.min(e,t.maxNativeZoom):e},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)this._tiles[t].coords.z!==this._tileZoom&&(e=this._tiles[t].el,e.onload=o.Util.falseFn,e.onerror=o.Util.falseFn,e.complete||(e.src=o.Util.emptyImageUrl,o.DomUtil.remove(e)))}}),o.tileLayer=function(t,e){return new o.TileLayer(t,e)},o.TileLayer.WMS=o.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var i=o.extend({},this.defaultWmsParams);for(var n in e)n in this.options||(i[n]=e[n]);e=o.setOptions(this,e),i.width=i.height=e.tileSize*(e.detectRetina&&o.Browser.retina?2:1),this.wmsParams=i},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,o.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToBounds(t),i=this._crs.project(e.getNorthWest()),n=this._crs.project(e.getSouthEast()),s=(this._wmsVersion>=1.3&&this._crs===o.CRS.EPSG4326?[n.y,i.x,i.y,n.x]:[i.x,n.y,n.x,i.y]).join(","),r=o.TileLayer.prototype.getTileUrl.call(this,t);return r+o.Util.getParamString(this.wmsParams,r,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+s},setParams:function(t,e){return o.extend(this.wmsParams,t),e||this.redraw(),this}}),o.tileLayer.wms=function(t,e){return new o.TileLayer.WMS(t,e)},o.ImageOverlay=o.Layer.extend({options:{opacity:1,alt:"",interactive:!1,attribution:null,crossOrigin:!1},initialize:function(t,e,i){this._url=t,this._bounds=o.latLngBounds(e),o.setOptions(this,i)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(o.DomUtil.addClass(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){o.DomUtil.remove(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&o.DomUtil.toFront(this._image),this},bringToBack:function(){return this._map&&o.DomUtil.toBack(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=t,this._map&&this._reset(),this},getAttribution:function(){return this.options.attribution},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._image=o.DomUtil.create("img","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""));t.onselectstart=o.Util.falseFn,t.onmousemove=o.Util.falseFn,t.onload=o.bind(this.fire,this,"load"),this.options.crossOrigin&&(t.crossOrigin=""),t.src=this._url,t.alt=this.options.alt},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),i=this._map._latLngToNewLayerPoint(this._bounds.getNorthWest(),t.zoom,t.center);o.DomUtil.setTransform(this._image,i,e)},_reset:function(){var t=this._image,e=new o.Bounds(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),i=e.getSize();o.DomUtil.setPosition(t,e.min),t.style.width=i.x+"px",t.style.height=i.y+"px"},_updateOpacity:function(){o.DomUtil.setOpacity(this._image,this.options.opacity)}}),o.imageOverlay=function(t,e,i){return new o.ImageOverlay(t,e,i)},o.Icon=o.Class.extend({initialize:function(t){o.setOptions(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n=this._createImg(i,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(n,t),n},_setIconStyles:function(t,e){var i=this.options,n=i[e+"Size"];"number"==typeof n&&(n=[n,n]);var s=o.point(n),r=o.point("shadow"===e&&i.shadowAnchor||i.iconAnchor||s&&s.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(i.className||""),r&&(t.style.marginLeft=-r.x+"px",t.style.marginTop=-r.y+"px"),s&&(t.style.width=s.x+"px",t.style.height=s.y+"px")},_createImg:function(t,i){return i=i||e.createElement("img"),i.src=t,i},_getIconUrl:function(t){return o.Browser.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}}),o.icon=function(t){return new o.Icon(t)},o.Icon.Default=o.Icon.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return o.Icon.Default.imagePath||(o.Icon.Default.imagePath=this._detectIconPath()),(this.options.imagePath||o.Icon.Default.imagePath)+o.Icon.prototype._getIconUrl.call(this,t)},_detectIconPath:function(){var t=o.DomUtil.create("div","leaflet-default-icon-path",e.body),i=o.DomUtil.getStyle(t,"background-image")||o.DomUtil.getStyle(t,"backgroundImage");return e.body.removeChild(t),0===i.indexOf("url")?i.replace(/^url\([\"\']?/,"").replace(/marker-icon\.png[\"\']?\)$/,""):""}}),o.Marker=o.Layer.extend({options:{icon:new o.Icon.Default,interactive:!0,draggable:!1,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",nonBubblingEvents:["click","dblclick","mouseover","mouseout","contextmenu"]},initialize:function(t,e){o.setOptions(this,e),this._latlng=o.latLng(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=o.latLng(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),i=t.icon.createIcon(this._icon),n=!1;i!==this._icon&&(this._icon&&this._removeIcon(),n=!0,t.title&&(i.title=t.title),t.alt&&(i.alt=t.alt)),o.DomUtil.addClass(i,e),t.keyboard&&(i.tabIndex="0"),this._icon=i,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var s=t.icon.createShadow(this._shadow),r=!1;s!==this._shadow&&(this._removeShadow(),r=!0),s&&o.DomUtil.addClass(s,e),this._shadow=s,t.opacity<1&&this._updateOpacity(),n&&this.getPane().appendChild(this._icon),this._initInteraction(),s&&r&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),o.DomUtil.remove(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&o.DomUtil.remove(this._shadow),this._shadow=null},_setPos:function(t){o.DomUtil.setPosition(this._icon,t),this._shadow&&o.DomUtil.setPosition(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(o.DomUtil.addClass(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),o.Handler.MarkerDrag)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new o.Handler.MarkerDrag(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;o.DomUtil.setOpacity(this._icon,t),this._shadow&&o.DomUtil.setOpacity(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),o.marker=function(t,e){return new o.Marker(t,e)},o.DivIcon=o.Icon.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var i=t&&"DIV"===t.tagName?t:e.createElement("div"),n=this.options;if(i.innerHTML=n.html!==!1?n.html:"",n.bgPos){var s=o.point(n.bgPos);i.style.backgroundPosition=-s.x+"px "+-s.y+"px"}return this._setIconStyles(i,"icon"),i},createShadow:function(){return null}}),o.divIcon=function(t){return new o.DivIcon(t)},o.DivOverlay=o.Layer.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(t,e){o.setOptions(this,t),this._source=e},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&o.DomUtil.setOpacity(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&o.DomUtil.setOpacity(this._container,1),this.bringToFront()},onRemove:function(t){t._fadeAnimated?(o.DomUtil.setOpacity(this._container,0),this._removeTimeout=setTimeout(o.bind(o.DomUtil.remove,o.DomUtil,this._container),200)):o.DomUtil.remove(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=o.latLng(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&o.DomUtil.toFront(this._container),this},bringToBack:function(){return this._map&&o.DomUtil.toBack(this._container),this},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=o.point(this.options.offset),i=this._getAnchor();this._zoomAnimated?o.DomUtil.setPosition(this._container,t.add(i)):e=e.add(t).add(i);var n=this._containerBottom=-e.y,s=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=n+"px",this._container.style.left=s+"px"}},_getAnchor:function(){return[0,0]}}),o.Popup=o.DivOverlay.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,className:""},openOn:function(t){return t.openPopup(this),this},onAdd:function(t){o.DivOverlay.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof o.Path||this._source.on("preclick",o.DomEvent.stopPropagation))},onRemove:function(t){o.DivOverlay.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof o.Path||this._source.off("preclick",o.DomEvent.stopPropagation))},getEvents:function(){var t=o.DivOverlay.prototype.getEvents.call(this);return("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",e=this._container=o.DomUtil.create("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated");if(this.options.closeButton){var i=this._closeButton=o.DomUtil.create("a",t+"-close-button",e);i.href="#close",i.innerHTML="&#215;",o.DomEvent.on(i,"click",this._onCloseButtonClick,this)}var n=this._wrapper=o.DomUtil.create("div",t+"-content-wrapper",e);this._contentNode=o.DomUtil.create("div",t+"-content",n),o.DomEvent.disableClickPropagation(n).disableScrollPropagation(this._contentNode).on(n,"contextmenu",o.DomEvent.stopPropagation),this._tipContainer=o.DomUtil.create("div",t+"-tip-container",e),this._tip=o.DomUtil.create("div",t+"-tip",this._tipContainer)},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var n=t.offsetHeight,s=this.options.maxHeight,r="leaflet-popup-scrolled";s&&n>s?(e.height=s+"px",o.DomUtil.addClass(t,r)):o.DomUtil.removeClass(t,r),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),i=this._getAnchor();o.DomUtil.setPosition(this._container,e.add(i))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var t=this._map,e=parseInt(o.DomUtil.getStyle(this._container,"marginBottom"),10)||0,i=this._container.offsetHeight+e,n=this._containerWidth,s=new o.Point(this._containerLeft,-i-this._containerBottom);s._add(o.DomUtil.getPosition(this._container));var r=t.layerPointToContainerPoint(s),a=o.point(this.options.autoPanPadding),h=o.point(this.options.autoPanPaddingTopLeft||a),l=o.point(this.options.autoPanPaddingBottomRight||a),u=t.getSize(),c=0,d=0;r.x+n+l.x>u.x&&(c=r.x+n-u.x+l.x),r.x-c-h.x<0&&(c=r.x-h.x),r.y+i+l.y>u.y&&(d=r.y+i-u.y+l.y),r.y-d-h.y<0&&(d=r.y-h.y),(c||d)&&t.fire("autopanstart").panBy([c,d])}},_onCloseButtonClick:function(t){this._close(),o.DomEvent.stop(t)},_getAnchor:function(){return o.point(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),o.popup=function(t,e){return new o.Popup(t,e)},o.Map.mergeOptions({closePopupOnClick:!0}),o.Map.include({openPopup:function(t,e,i){return t instanceof o.Popup||(t=new o.Popup(i).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),o.Layer.include({bindPopup:function(t,e){return t instanceof o.Popup?(o.setOptions(t,e),this._popup=t,t._source=this):(this._popup&&!e||(this._popup=new o.Popup(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t,e){if(t instanceof o.Layer||(e=t,t=this),t instanceof o.FeatureGroup)for(var i in this._layers){t=this._layers[i];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._popup&&this._map&&(this._popup._source=t,this._popup.update(),this._map.openPopup(this._popup,e)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),this},isPopupOpen:function(){return this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var e=t.layer||t.target;if(this._popup&&this._map)return o.DomEvent.stop(t),e instanceof o.Path?void this.openPopup(t.layer||t.target,t.latlng):void(this._map.hasLayer(this._popup)&&this._popup._source===e?this.closePopup():this.openPopup(e,t.latlng))},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),o.Marker.include({_getPopupAnchor:function(){return this.options.icon.options.popupAnchor||[0,0]}}),o.Tooltip=o.DivOverlay.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(t){o.DivOverlay.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(t){o.DivOverlay.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var t=o.DivOverlay.prototype.getEvents.call(this);return o.Browser.touch&&!this.options.permanent&&(t.preclick=this._close),t},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var t="leaflet-tooltip",e=t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=o.DomUtil.create("div",e)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e=this._map,i=this._container,n=e.latLngToContainerPoint(e.getCenter()),s=e.layerPointToContainerPoint(t),r=this.options.direction,a=i.offsetWidth,h=i.offsetHeight,l=o.point(this.options.offset),u=this._getAnchor();"top"===r?t=t.add(o.point(-a/2+l.x,-h+l.y+u.y)):"bottom"===r?t=t.subtract(o.point(a/2-l.x,-l.y)):"center"===r?t=t.subtract(o.point(a/2+l.x,h/2-u.y+l.y)):"right"===r||"auto"===r&&s.x<n.x?(r="right",t=t.add([l.x+u.x,u.y-h/2+l.y])):(r="left",t=t.subtract(o.point(a+u.x-l.x,h/2-u.y-l.y))),o.DomUtil.removeClass(i,"leaflet-tooltip-right"),o.DomUtil.removeClass(i,"leaflet-tooltip-left"),o.DomUtil.removeClass(i,"leaflet-tooltip-top"),o.DomUtil.removeClass(i,"leaflet-tooltip-bottom"),o.DomUtil.addClass(i,"leaflet-tooltip-"+r),o.DomUtil.setPosition(i,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&o.DomUtil.setOpacity(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return o.point(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),o.tooltip=function(t,e){return new o.Tooltip(t,e)},o.Map.include({openTooltip:function(t,e,i){return t instanceof o.Tooltip||(t=new o.Tooltip(i).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:this.addLayer(t)},closeTooltip:function(t){return t&&this.removeLayer(t),this}}),o.Layer.include({bindTooltip:function(t,e){return t instanceof o.Tooltip?(o.setOptions(t,e),this._tooltip=t,t._source=this):(this._tooltip&&!e||(this._tooltip=o.tooltip(e,this)),this._tooltip.setContent(t)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",i={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?i.add=this._openTooltip:(i.mouseover=this._openTooltip,i.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(i.mousemove=this._moveTooltip),o.Browser.touch&&(i.click=this._openTooltip)),this[e](i),this._tooltipHandlersAdded=!t}},openTooltip:function(t,e){if(t instanceof o.Layer||(e=t,t=this),t instanceof o.FeatureGroup)for(var i in this._layers){t=this._layers[i];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._tooltip&&this._map&&(this._tooltip._source=t,this._tooltip.update(),this._map.openTooltip(this._tooltip,e),this._tooltip.options.interactive&&this._tooltip._container&&(o.DomUtil.addClass(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(o.DomUtil.removeClass(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(t){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(t)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){var e=t.layer||t.target;this._tooltip&&this._map&&this.openTooltip(e,this._tooltip.options.sticky?t.latlng:i)},_moveTooltip:function(t){var e,i,n=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),i=this._map.containerPointToLayerPoint(e),n=this._map.layerPointToLatLng(i)),this._tooltip.setLatLng(n)}}),o.Marker.include({_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor||[0,0]}}),o.LayerGroup=o.Layer.extend({initialize:function(t){this._layers={};var e,i;if(t)for(e=0,i=t.length;e<i;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){for(var t in this._layers)this.removeLayer(this._layers[t]);return this},invoke:function(t){var e,i,n=Array.prototype.slice.call(arguments,1);for(e in this._layers)i=this._layers[e],i[t]&&i[t].apply(i,n);return this},onAdd:function(t){for(var e in this._layers)t.addLayer(this._layers[e])},onRemove:function(t){for(var e in this._layers)t.removeLayer(this._layers[e])},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return o.stamp(t)}}),o.layerGroup=function(t){return new o.LayerGroup(t)},o.FeatureGroup=o.LayerGroup.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),o.LayerGroup.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),o.LayerGroup.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new o.LatLngBounds;for(var e in this._layers){var i=this._layers[e];t.extend(i.getBounds?i.getBounds():i.getLatLng())}return t}}),o.featureGroup=function(t){return new o.FeatureGroup(t)},o.Renderer=o.Layer.extend({options:{padding:.1},initialize:function(t){o.setOptions(this,t),o.stamp(this)},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&o.DomUtil.addClass(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update()},onRemove:function(){o.DomUtil.remove(this._container)},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var i=this._map.getZoomScale(e,this._zoom),n=o.DomUtil.getPosition(this._container),s=this._map.getSize().multiplyBy(.5+this.options.padding),r=this._map.project(this._center,e),a=this._map.project(t,e),h=a.subtract(r),l=s.multiplyBy(-i).add(n).add(s).subtract(h);o.Browser.any3d?o.DomUtil.setTransform(this._container,l,i):o.DomUtil.setPosition(this._container,l)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom)},_update:function(){var t=this.options.padding,e=this._map.getSize(),i=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new o.Bounds(i,i.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),o.Map.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this.options.preferCanvas&&o.canvas()||o.svg()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||t===i)return!1;var e=this._paneRenderers[t];return e===i&&(e=o.SVG&&o.svg({pane:t})||o.Canvas&&o.canvas({pane:t}),this._paneRenderers[t]=e),e}}),o.Path=o.Layer.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this),this._renderer.on("update",this._update,this)},onRemove:function(){this._renderer._removePath(this),this._renderer.off("update",this._update,this)},getEvents:function(){return{zoomend:this._project,viewreset:this._reset}},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return o.setOptions(this,t),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(o.Browser.touch?10:0)}}),o.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=this._reducePoints(t,i),t=this._simplifyDP(t,i)},pointToSegmentDistance:function(t,e,i){return Math.sqrt(this._sqClosestPointOnSegment(t,e,i,!0))},closestPointOnSegment:function(t,e,i){return this._sqClosestPointOnSegment(t,e,i)},_simplifyDP:function(t,e){var n=t.length,o=typeof Uint8Array!=i+""?Uint8Array:Array,s=new o(n);s[0]=s[n-1]=1,this._simplifyDPStep(t,s,e,0,n-1);var r,a=[];for(r=0;r<n;r++)s[r]&&a.push(t[r]);return a},_simplifyDPStep:function(t,e,i,n,o){
var s,r,a,h=0;for(r=n+1;r<=o-1;r++)a=this._sqClosestPointOnSegment(t[r],t[n],t[o],!0),a>h&&(s=r,h=a);h>i&&(e[s]=1,this._simplifyDPStep(t,e,i,n,s),this._simplifyDPStep(t,e,i,s,o))},_reducePoints:function(t,e){for(var i=[t[0]],n=1,o=0,s=t.length;n<s;n++)this._sqDist(t[n],t[o])>e&&(i.push(t[n]),o=n);return o<s-1&&i.push(t[s-1]),i},clipSegment:function(t,e,i,n,o){var s,r,a,h=n?this._lastCode:this._getBitCode(t,i),l=this._getBitCode(e,i);for(this._lastCode=l;;){if(!(h|l))return[t,e];if(h&l)return!1;s=h||l,r=this._getEdgeIntersection(t,e,s,i,o),a=this._getBitCode(r,i),s===h?(t=r,h=a):(e=r,l=a)}},_getEdgeIntersection:function(t,e,i,n,s){var r,a,h=e.x-t.x,l=e.y-t.y,u=n.min,c=n.max;return 8&i?(r=t.x+h*(c.y-t.y)/l,a=c.y):4&i?(r=t.x+h*(u.y-t.y)/l,a=u.y):2&i?(r=c.x,a=t.y+l*(c.x-t.x)/h):1&i&&(r=u.x,a=t.y+l*(u.x-t.x)/h),new o.Point(r,a,s)},_getBitCode:function(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i},_sqDist:function(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n},_sqClosestPointOnSegment:function(t,e,i,n){var s,r=e.x,a=e.y,h=i.x-r,l=i.y-a,u=h*h+l*l;return u>0&&(s=((t.x-r)*h+(t.y-a)*l)/u,s>1?(r=i.x,a=i.y):s>0&&(r+=h*s,a+=l*s)),h=t.x-r,l=t.y-a,n?h*h+l*l:new o.Point(r,a)}},o.Polyline=o.Path.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){o.setOptions(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,i,n=1/0,s=null,r=o.LineUtil._sqClosestPointOnSegment,a=0,h=this._parts.length;a<h;a++)for(var l=this._parts[a],u=1,c=l.length;u<c;u++){e=l[u-1],i=l[u];var d=r(t,e,i,!0);d<n&&(n=d,s=r(t,e,i))}return s&&(s.distance=Math.sqrt(n)),s},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,i,n,o,s,r,a=this._rings[0],h=a.length;if(!h)return null;for(t=0,e=0;t<h-1;t++)e+=a[t].distanceTo(a[t+1])/2;if(0===e)return this._map.layerPointToLatLng(a[0]);for(t=0,n=0;t<h-1;t++)if(o=a[t],s=a[t+1],i=o.distanceTo(s),n+=i,n>e)return r=(n-e)/i,this._map.layerPointToLatLng([s.x-r*(s.x-o.x),s.y-r*(s.y-o.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=o.latLng(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new o.LatLngBounds,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return o.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],i=o.Polyline._flat(t),n=0,s=t.length;n<s;n++)i?(e[n]=o.latLng(t[n]),this._bounds.extend(e[n])):e[n]=this._convertLatLngs(t[n]);return e},_project:function(){var t=new o.Bounds;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t);var e=this._clickTolerance(),i=new o.Point(e,e);this._bounds.isValid()&&t.isValid()&&(t.min._subtract(i),t.max._add(i),this._pxBounds=t)},_projectLatlngs:function(t,e,i){var n,s,r=t[0]instanceof o.LatLng,a=t.length;if(r){for(s=[],n=0;n<a;n++)s[n]=this._map.latLngToLayerPoint(t[n]),i.extend(s[n]);e.push(s)}else for(n=0;n<a;n++)this._projectLatlngs(t[n],e,i)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t)){if(this.options.noClip)return void(this._parts=this._rings);var e,i,n,s,r,a,h,l=this._parts;for(e=0,n=0,s=this._rings.length;e<s;e++)for(h=this._rings[e],i=0,r=h.length;i<r-1;i++)a=o.LineUtil.clipSegment(h[i],h[i+1],t,i,!0),a&&(l[n]=l[n]||[],l[n].push(a[0]),a[1]===h[i+1]&&i!==r-2||(l[n].push(a[1]),n++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,i=0,n=t.length;i<n;i++)t[i]=o.LineUtil.simplify(t[i],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)}}),o.polyline=function(t,e){return new o.Polyline(t,e)},o.Polyline._flat=function(t){return!o.Util.isArray(t[0])||"object"!=typeof t[0][0]&&"undefined"!=typeof t[0][0]},o.PolyUtil={},o.PolyUtil.clipPolygon=function(t,e,i){var n,s,r,a,h,l,u,c,d,_=[1,4,2,8],m=o.LineUtil;for(s=0,u=t.length;s<u;s++)t[s]._code=m._getBitCode(t[s],e);for(a=0;a<4;a++){for(c=_[a],n=[],s=0,u=t.length,r=u-1;s<u;r=s++)h=t[s],l=t[r],h._code&c?l._code&c||(d=m._getEdgeIntersection(l,h,c,e,i),d._code=m._getBitCode(d,e),n.push(d)):(l._code&c&&(d=m._getEdgeIntersection(l,h,c,e,i),d._code=m._getBitCode(d,e),n.push(d)),n.push(h));t=n}return t},o.Polygon=o.Polyline.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,i,n,o,s,r,a,h,l=this._rings[0],u=l.length;if(!u)return null;for(s=r=a=0,t=0,e=u-1;t<u;e=t++)i=l[t],n=l[e],o=i.y*n.x-n.y*i.x,r+=(i.x+n.x)*o,a+=(i.y+n.y)*o,s+=3*o;return h=0===s?l[0]:[r/s,a/s],this._map.layerPointToLatLng(h)},_convertLatLngs:function(t){var e=o.Polyline.prototype._convertLatLngs.call(this,t),i=e.length;return i>=2&&e[0]instanceof o.LatLng&&e[0].equals(e[i-1])&&e.pop(),e},_setLatLngs:function(t){o.Polyline.prototype._setLatLngs.call(this,t),o.Polyline._flat(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return o.Polyline._flat(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,i=new o.Point(e,e);if(t=new o.Bounds(t.min.subtract(i),t.max.add(i)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t)){if(this.options.noClip)return void(this._parts=this._rings);for(var n,s=0,r=this._rings.length;s<r;s++)n=o.PolyUtil.clipPolygon(this._rings[s],t,!0),n.length&&this._parts.push(n)}},_updatePath:function(){this._renderer._updatePoly(this,!0)}}),o.polygon=function(t,e){return new o.Polygon(t,e)},o.Rectangle=o.Polygon.extend({initialize:function(t,e){o.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=o.latLngBounds(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),o.rectangle=function(t,e){return new o.Rectangle(t,e)},o.CircleMarker=o.Path.extend({options:{fill:!0,radius:10},initialize:function(t,e){o.setOptions(this,e),this._latlng=o.latLng(t),this._radius=this.options.radius},setLatLng:function(t){return this._latlng=o.latLng(t),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return o.Path.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,i=this._clickTolerance(),n=[t+i,e+i];this._pxBounds=new o.Bounds(this._point.subtract(n),this._point.add(n))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)}}),o.circleMarker=function(t,e){return new o.CircleMarker(t,e)},o.Circle=o.CircleMarker.extend({initialize:function(t,e,i){if("number"==typeof e&&(e=o.extend({},i,{radius:e})),o.setOptions(this,e),this._latlng=o.latLng(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new o.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:o.Path.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,i=this._map,n=i.options.crs;if(n.distance===o.CRS.Earth.distance){var s=Math.PI/180,r=this._mRadius/o.CRS.Earth.R/s,a=i.project([e+r,t]),h=i.project([e-r,t]),l=a.add(h).divideBy(2),u=i.unproject(l).lat,c=Math.acos((Math.cos(r*s)-Math.sin(e*s)*Math.sin(u*s))/(Math.cos(e*s)*Math.cos(u*s)))/s;(isNaN(c)||0===c)&&(c=r/Math.cos(Math.PI/180*e)),this._point=l.subtract(i.getPixelOrigin()),this._radius=isNaN(c)?0:Math.max(Math.round(l.x-i.project([u,t-c]).x),1),this._radiusY=Math.max(Math.round(l.y-a.y),1)}else{var d=n.unproject(n.project(this._latlng).subtract([this._mRadius,0]));this._point=i.latLngToLayerPoint(this._latlng),this._radius=this._point.x-i.latLngToLayerPoint(d).x}this._updateBounds()}}),o.circle=function(t,e,i){return new o.Circle(t,e,i)},o.SVG=o.Renderer.extend({getEvents:function(){var t=o.Renderer.prototype.getEvents.call(this);return t.zoomstart=this._onZoomStart,t},_initContainer:function(){this._container=o.SVG.create("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=o.SVG.create("g"),this._container.appendChild(this._rootGroup)},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){o.Renderer.prototype._update.call(this);var t=this._bounds,e=t.getSize(),i=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,i.setAttribute("width",e.x),i.setAttribute("height",e.y)),o.DomUtil.setPosition(i,t.min),i.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=o.SVG.create("path");t.options.className&&o.DomUtil.addClass(e,t.options.className),t.options.interactive&&o.DomUtil.addClass(e,"leaflet-interactive"),this._updateStyle(t)},_addPath:function(t){this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){o.DomUtil.remove(t._path),t.removeInteractiveTarget(t._path)},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,i=t.options;e&&(i.stroke?(e.setAttribute("stroke",i.color),e.setAttribute("stroke-opacity",i.opacity),e.setAttribute("stroke-width",i.weight),e.setAttribute("stroke-linecap",i.lineCap),e.setAttribute("stroke-linejoin",i.lineJoin),i.dashArray?e.setAttribute("stroke-dasharray",i.dashArray):e.removeAttribute("stroke-dasharray"),i.dashOffset?e.setAttribute("stroke-dashoffset",i.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),i.fill?(e.setAttribute("fill",i.fillColor||i.color),e.setAttribute("fill-opacity",i.fillOpacity),e.setAttribute("fill-rule",i.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,o.SVG.pointsToPath(t._parts,e))},_updateCircle:function(t){var e=t._point,i=t._radius,n=t._radiusY||i,o="a"+i+","+n+" 0 1,0 ",s=t._empty()?"M0 0":"M"+(e.x-i)+","+e.y+o+2*i+",0 "+o+2*-i+",0 ";this._setPath(t,s)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){o.DomUtil.toFront(t._path)},_bringToBack:function(t){o.DomUtil.toBack(t._path)}}),o.extend(o.SVG,{create:function(t){return e.createElementNS("http://www.w3.org/2000/svg",t)},pointsToPath:function(t,e){var i,n,s,r,a,h,l="";for(i=0,s=t.length;i<s;i++){for(a=t[i],n=0,r=a.length;n<r;n++)h=a[n],l+=(n?"L":"M")+h.x+" "+h.y;l+=e?o.Browser.svg?"z":"x":""}return l||"M0 0"}}),o.Browser.svg=!(!e.createElementNS||!o.SVG.create("svg").createSVGRect),o.svg=function(t){return o.Browser.svg||o.Browser.vml?new o.SVG(t):null},o.Browser.vml=!o.Browser.svg&&function(){try{var t=e.createElement("div");t.innerHTML='<v:shape adj="1"/>';var i=t.firstChild;return i.style.behavior="url(#default#VML)",i&&"object"==typeof i.adj}catch(t){return!1}}(),o.SVG.include(o.Browser.vml?{_initContainer:function(){this._container=o.DomUtil.create("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(o.Renderer.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=o.SVG.create("shape");o.DomUtil.addClass(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=o.SVG.create("path"),e.appendChild(t._path),this._updateStyle(t)},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;o.DomUtil.remove(e),t.removeInteractiveTarget(e)},_updateStyle:function(t){var e=t._stroke,i=t._fill,n=t.options,s=t._container;s.stroked=!!n.stroke,s.filled=!!n.fill,n.stroke?(e||(e=t._stroke=o.SVG.create("stroke")),s.appendChild(e),e.weight=n.weight+"px",e.color=n.color,e.opacity=n.opacity,n.dashArray?e.dashStyle=o.Util.isArray(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=n.lineCap.replace("butt","flat"),e.joinstyle=n.lineJoin):e&&(s.removeChild(e),t._stroke=null),n.fill?(i||(i=t._fill=o.SVG.create("fill")),s.appendChild(i),i.color=n.fillColor||n.color,i.opacity=n.fillOpacity):i&&(s.removeChild(i),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),i=Math.round(t._radius),n=Math.round(t._radiusY||i);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+i+","+n+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){o.DomUtil.toFront(t._container)},_bringToBack:function(t){o.DomUtil.toBack(t._container)}}:{}),o.Browser.vml&&(o.SVG.create=function(){try{return e.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return e.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return e.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}()),o.Canvas=o.Renderer.extend({onAdd:function(){o.Renderer.prototype.onAdd.call(this),this._layers=this._layers||{},this._draw()},_initContainer:function(){var t=this._container=e.createElement("canvas");o.DomEvent.on(t,"mousemove",o.Util.throttle(this._onMouseMove,32,this),this).on(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this).on(t,"mouseout",this._handleMouseOut,this),this._ctx=t.getContext("2d")},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={},o.Renderer.prototype._update.call(this);var t=this._bounds,e=this._container,i=t.getSize(),n=o.Browser.retina?2:1;o.DomUtil.setPosition(e,t.min),e.width=n*i.x,e.height=n*i.y,e.style.width=i.x+"px",e.style.height=i.y+"px",o.Browser.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_initPath:function(t){this._updateDashArray(t),this._layers[o.stamp(t)]=t},_addPath:o.Util.falseFn,_removePath:function(t){t._removed=!0,this._requestRedraw(t)},_updatePath:function(t){this._redrawBounds=t._pxBounds,this._draw(!0),t._project(),t._update(),this._draw(),this._redrawBounds=null},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(t.options.dashArray){var e,i=t.options.dashArray.split(","),n=[];for(e=0;e<i.length;e++)n.push(Number(i[e]));t.options._dashArray=n}},_requestRedraw:function(t){if(this._map){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new o.Bounds,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e])),this._redrawRequest=this._redrawRequest||o.Util.requestAnimFrame(this._redraw,this)}},_redraw:function(){this._redrawRequest=null,this._draw(!0),this._draw(),this._redrawBounds=null},_draw:function(t){this._clear=t;var e,i=this._redrawBounds;this._ctx.save(),i&&(this._ctx.beginPath(),this._ctx.rect(i.min.x,i.min.y,i.max.x-i.min.x,i.max.y-i.min.y),this._ctx.clip());for(var n in this._layers)e=this._layers[n],(!i||e._pxBounds&&e._pxBounds.intersects(i))&&e._updatePath(),t&&e._removed&&(delete e._removed,delete this._layers[n]);this._ctx.restore()},_updatePoly:function(t,e){var i,n,o,s,r=t._parts,a=r.length,h=this._ctx;if(a){for(this._drawnLayers[t._leaflet_id]=t,h.beginPath(),h.setLineDash&&h.setLineDash(t.options&&t.options._dashArray||[]),i=0;i<a;i++){for(n=0,o=r[i].length;n<o;n++)s=r[i][n],h[n?"lineTo":"moveTo"](s.x,s.y);e&&h.closePath()}this._fillStroke(h,t)}},_updateCircle:function(t){if(!t._empty()){var e=t._point,i=this._ctx,n=t._radius,o=(t._radiusY||n)/n;this._drawnLayers[t._leaflet_id]=t,1!==o&&(i.save(),i.scale(1,o)),i.beginPath(),i.arc(e.x,e.y/o,n,0,2*Math.PI,!1),1!==o&&i.restore(),this._fillStroke(i,t)}},_fillStroke:function(t,e){var i=this._clear,n=e.options;t.globalCompositeOperation=i?"destination-out":"source-over",n.fill&&(t.globalAlpha=i?1:n.fillOpacity,t.fillStyle=n.fillColor||n.color,t.fill(n.fillRule||"evenodd")),n.stroke&&0!==n.weight&&(t.globalAlpha=i?1:n.opacity,e._prevWeight=t.lineWidth=i?e._prevWeight+1:n.weight,t.strokeStyle=n.color,t.lineCap=n.lineCap,t.lineJoin=n.lineJoin,t.stroke())},_onClick:function(t){var e,i=this._map.mouseEventToLayerPoint(t),n=[];for(var s in this._layers)e=this._layers[s],e.options.interactive&&e._containsPoint(i)&&!this._map._draggableMoved(e)&&(o.DomEvent._fakeStop(t),n.push(e));n.length&&this._fireEvent(n,t)},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseOut(t,e),this._handleMouseHover(t,e)}},_handleMouseOut:function(t,e){var i=this._hoveredLayer;!i||"mouseout"!==t.type&&i._containsPoint(e)||(o.DomUtil.removeClass(this._container,"leaflet-interactive"),this._fireEvent([i],t,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(t,e){var i,n;for(i in this._drawnLayers)n=this._drawnLayers[i],n.options.interactive&&n._containsPoint(e)&&(o.DomUtil.addClass(this._container,"leaflet-interactive"),this._fireEvent([n],t,"mouseover"),this._hoveredLayer=n);this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t)},_fireEvent:function(t,e,i){this._map._fireDOMEvent(e,i||e.type,t)},_bringToFront:o.Util.falseFn,_bringToBack:o.Util.falseFn}),o.Browser.canvas=function(){return!!e.createElement("canvas").getContext}(),o.canvas=function(t){return o.Browser.canvas?new o.Canvas(t):null},o.Polyline.prototype._containsPoint=function(t,e){var i,n,s,r,a,h,l=this._clickTolerance();if(!this._pxBounds.contains(t))return!1;for(i=0,r=this._parts.length;i<r;i++)for(h=this._parts[i],n=0,a=h.length,s=a-1;n<a;s=n++)if((e||0!==n)&&o.LineUtil.pointToSegmentDistance(t,h[s],h[n])<=l)return!0;return!1},o.Polygon.prototype._containsPoint=function(t){var e,i,n,s,r,a,h,l,u=!1;if(!this._pxBounds.contains(t))return!1;for(s=0,h=this._parts.length;s<h;s++)for(e=this._parts[s],r=0,l=e.length,a=l-1;r<l;a=r++)i=e[r],n=e[a],i.y>t.y!=n.y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(u=!u);return u||o.Polyline.prototype._containsPoint.call(this,t,!0)},o.CircleMarker.prototype._containsPoint=function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()},o.GeoJSON=o.FeatureGroup.extend({initialize:function(t,e){o.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,n,s=o.Util.isArray(t)?t:t.features;if(s){for(e=0,i=s.length;e<i;e++)n=s[e],(n.geometries||n.geometry||n.features||n.coordinates)&&this.addData(n);return this}var r=this.options;if(r.filter&&!r.filter(t))return this;var a=o.GeoJSON.geometryToLayer(t,r);return a?(a.feature=o.GeoJSON.asFeature(t),a.defaultOptions=a.options,this.resetStyle(a),r.onEachFeature&&r.onEachFeature(t,a),this.addLayer(a)):this},resetStyle:function(t){return t.options=o.Util.extend({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this},setStyle:function(t){return this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),o.extend(o.GeoJSON,{geometryToLayer:function(t,e){var i,n,s,r,a="Feature"===t.type?t.geometry:t,h=a?a.coordinates:null,l=[],u=e&&e.pointToLayer,c=e&&e.coordsToLatLng||this.coordsToLatLng;if(!h&&!a)return null;switch(a.type){case"Point":return i=c(h),u?u(t,i):new o.Marker(i);case"MultiPoint":for(s=0,r=h.length;s<r;s++)i=c(h[s]),l.push(u?u(t,i):new o.Marker(i));return new o.FeatureGroup(l);case"LineString":case"MultiLineString":return n=this.coordsToLatLngs(h,"LineString"===a.type?0:1,c),new o.Polyline(n,e);case"Polygon":case"MultiPolygon":return n=this.coordsToLatLngs(h,"Polygon"===a.type?1:2,c),new o.Polygon(n,e);case"GeometryCollection":for(s=0,r=a.geometries.length;s<r;s++){var d=this.geometryToLayer({geometry:a.geometries[s],type:"Feature",properties:t.properties},e);d&&l.push(d)}return new o.FeatureGroup(l);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t){return new o.LatLng(t[1],t[0],t[2])},coordsToLatLngs:function(t,e,i){for(var n,o=[],s=0,r=t.length;s<r;s++)n=e?this.coordsToLatLngs(t[s],e-1,i):(i||this.coordsToLatLng)(t[s]),o.push(n);return o},latLngToCoords:function(t){return t.alt!==i?[t.lng,t.lat,t.alt]:[t.lng,t.lat]},latLngsToCoords:function(t,e,i){for(var n=[],s=0,r=t.length;s<r;s++)n.push(e?o.GeoJSON.latLngsToCoords(t[s],e-1,i):o.GeoJSON.latLngToCoords(t[s]));return!e&&i&&n.push(n[0]),n},getFeature:function(t,e){return t.feature?o.extend({},t.feature,{geometry:e}):o.GeoJSON.asFeature(e)},asFeature:function(t){return"Feature"===t.type?t:{type:"Feature",properties:{},geometry:t}}});var r={toGeoJSON:function(){return o.GeoJSON.getFeature(this,{type:"Point",coordinates:o.GeoJSON.latLngToCoords(this.getLatLng())})}};o.Marker.include(r),o.Circle.include(r),o.CircleMarker.include(r),o.Polyline.prototype.toGeoJSON=function(){var t=!o.Polyline._flat(this._latlngs),e=o.GeoJSON.latLngsToCoords(this._latlngs,t?1:0);return o.GeoJSON.getFeature(this,{type:(t?"Multi":"")+"LineString",coordinates:e})},o.Polygon.prototype.toGeoJSON=function(){var t=!o.Polyline._flat(this._latlngs),e=t&&!o.Polyline._flat(this._latlngs[0]),i=o.GeoJSON.latLngsToCoords(this._latlngs,e?2:t?1:0,!0);return t||(i=[i]),o.GeoJSON.getFeature(this,{type:(e?"Multi":"")+"Polygon",coordinates:i})},o.LayerGroup.include({toMultiPoint:function(){var t=[];return this.eachLayer(function(e){t.push(e.toGeoJSON().geometry.coordinates)}),o.GeoJSON.getFeature(this,{type:"MultiPoint",coordinates:t})},toGeoJSON:function(){var t=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===t)return this.toMultiPoint();var e="GeometryCollection"===t,i=[];return this.eachLayer(function(t){if(t.toGeoJSON){var n=t.toGeoJSON();i.push(e?n.geometry:o.GeoJSON.asFeature(n))}}),e?o.GeoJSON.getFeature(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}}),o.geoJSON=function(t,e){return new o.GeoJSON(t,e)},o.geoJson=o.geoJSON;var a="_leaflet_events";o.DomEvent={on:function(t,e,i,n){if("object"==typeof e)for(var s in e)this._on(t,s,e[s],i);else{e=o.Util.splitWords(e);for(var r=0,a=e.length;r<a;r++)this._on(t,e[r],i,n)}return this},off:function(t,e,i,n){if("object"==typeof e)for(var s in e)this._off(t,s,e[s],i);else{e=o.Util.splitWords(e);for(var r=0,a=e.length;r<a;r++)this._off(t,e[r],i,n)}return this},_on:function(e,i,n,s){var r=i+o.stamp(n)+(s?"_"+o.stamp(s):"");if(e[a]&&e[a][r])return this;var h=function(i){return n.call(s||e,i||t.event)},l=h;return o.Browser.pointer&&0===i.indexOf("touch")?this.addPointerListener(e,i,h,r):o.Browser.touch&&"dblclick"===i&&this.addDoubleTapListener?this.addDoubleTapListener(e,h,r):"addEventListener"in e?"mousewheel"===i?e.addEventListener("onwheel"in e?"wheel":"mousewheel",h,!1):"mouseenter"===i||"mouseleave"===i?(h=function(i){i=i||t.event,o.DomEvent._isExternalTarget(e,i)&&l(i)},e.addEventListener("mouseenter"===i?"mouseover":"mouseout",h,!1)):("click"===i&&o.Browser.android&&(h=function(t){return o.DomEvent._filterClick(t,l)}),e.addEventListener(i,h,!1)):"attachEvent"in e&&e.attachEvent("on"+i,h),e[a]=e[a]||{},e[a][r]=h,this},_off:function(t,e,i,n){var s=e+o.stamp(i)+(n?"_"+o.stamp(n):""),r=t[a]&&t[a][s];return r?(o.Browser.pointer&&0===e.indexOf("touch")?this.removePointerListener(t,e,s):o.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,s):"removeEventListener"in t?"mousewheel"===e?t.removeEventListener("onwheel"in t?"wheel":"mousewheel",r,!1):t.removeEventListener("mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,r,!1):"detachEvent"in t&&t.detachEvent("on"+e,r),t[a][s]=null,this):this},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,o.DomEvent._skipped(t),this},disableScrollPropagation:function(t){return o.DomEvent.on(t,"mousewheel",o.DomEvent.stopPropagation)},disableClickPropagation:function(t){var e=o.DomEvent.stopPropagation;return o.DomEvent.on(t,o.Draggable.START.join(" "),e),o.DomEvent.on(t,{click:o.DomEvent._fakeStop,dblclick:e})},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return o.DomEvent.preventDefault(t).stopPropagation(t)},getMousePosition:function(t,e){if(!e)return new o.Point(t.clientX,t.clientY);var i=e.getBoundingClientRect();return new o.Point(t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop)},_wheelPxFactor:o.Browser.win&&o.Browser.chrome?2:o.Browser.gecko?t.devicePixelRatio:1,getWheelDelta:function(t){return o.Browser.edge?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/o.DomEvent._wheelPxFactor:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0},_skipEvents:{},_fakeStop:function(t){o.DomEvent._skipEvents[t.type]=!0},_skipped:function(t){var e=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,e},_isExternalTarget:function(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(t){return!1}return i!==t},_filterClick:function(t,e){var i=t.timeStamp||t.originalEvent&&t.originalEvent.timeStamp,n=o.DomEvent._lastClick&&i-o.DomEvent._lastClick;return n&&n>100&&n<500||t.target._simulatedClick&&!t._simulated?void o.DomEvent.stop(t):(o.DomEvent._lastClick=i,void e(t))}},o.DomEvent.addListener=o.DomEvent.on,o.DomEvent.removeListener=o.DomEvent.off,o.Draggable=o.Evented.extend({options:{clickTolerance:3},statics:{START:o.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,e,i){this._element=t,this._dragStartTarget=e||t,this._preventOutline=i},enable:function(){this._enabled||(o.DomEvent.on(this._dragStartTarget,o.Draggable.START.join(" "),this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(o.DomEvent.off(this._dragStartTarget,o.Draggable.START.join(" "),this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(!t._simulated&&this._enabled&&(this._moved=!1,!o.DomUtil.hasClass(this._element,"leaflet-zoom-anim")&&!(o.Draggable._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches)&&this._enabled&&(o.Draggable._dragging=!0,this._preventOutline&&o.DomUtil.preventOutline(this._element),o.DomUtil.disableImageDrag(),o.DomUtil.disableTextSelection(),!this._moving))){this.fire("down");var i=t.touches?t.touches[0]:t;this._startPoint=new o.Point(i.clientX,i.clientY),o.DomEvent.on(e,o.Draggable.MOVE[t.type],this._onMove,this).on(e,o.Draggable.END[t.type],this._onUp,this)}},_onMove:function(i){if(!i._simulated&&this._enabled){if(i.touches&&i.touches.length>1)return void(this._moved=!0);var n=i.touches&&1===i.touches.length?i.touches[0]:i,s=new o.Point(n.clientX,n.clientY),r=s.subtract(this._startPoint);(r.x||r.y)&&(Math.abs(r.x)+Math.abs(r.y)<this.options.clickTolerance||(o.DomEvent.preventDefault(i),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=o.DomUtil.getPosition(this._element).subtract(r),o.DomUtil.addClass(e.body,"leaflet-dragging"),this._lastTarget=i.target||i.srcElement,t.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),o.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(r),this._moving=!0,o.Util.cancelAnimFrame(this._animRequest),this._lastEvent=i,this._animRequest=o.Util.requestAnimFrame(this._updatePosition,this,!0)))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),o.DomUtil.setPosition(this._element,this._newPos),this.fire("drag",t)},_onUp:function(t){if(!t._simulated&&this._enabled){o.DomUtil.removeClass(e.body,"leaflet-dragging"),this._lastTarget&&(o.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var i in o.Draggable.MOVE)o.DomEvent.off(e,o.Draggable.MOVE[i],this._onMove,this).off(e,o.Draggable.END[i],this._onUp,this);o.DomUtil.enableImageDrag(),o.DomUtil.enableTextSelection(),this._moved&&this._moving&&(o.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,o.Draggable._dragging=!1}}}),o.Handler=o.Class.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}}),o.Map.mergeOptions({dragging:!0,inertia:!o.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0}),o.Map.Drag=o.Handler.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new o.Draggable(t._mapPane,t._container),this._draggable.on({down:this._onDown,dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}o.DomUtil.addClass(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){o.DomUtil.removeClass(this._map._container,"leaflet-grab"),o.DomUtil.removeClass(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDown:function(){this._map._stop()},_onDragStart:function(){var t=this._map;if(this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=o.latLngBounds(this._map.options.maxBounds);this._offsetLimit=o.bounds(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,i=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(i),this._times.push(e),e-this._times[0]>50&&(this._positions.shift(),this._times.shift())}this._map.fire("move",t).fire("drag",t)},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,o=(n-e+i)%t+e-i,s=(n+e+i)%t-e-i,r=Math.abs(o+i)<Math.abs(s+i)?o:s;
this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=r},_onDragEnd:function(t){var e=this._map,i=e.options,n=!i.inertia||this._times.length<2;if(e.fire("dragend",t),n)e.fire("moveend");else{var s=this._lastPos.subtract(this._positions[0]),r=(this._lastTime-this._times[0])/1e3,a=i.easeLinearity,h=s.multiplyBy(a/r),l=h.distanceTo([0,0]),u=Math.min(i.inertiaMaxSpeed,l),c=h.multiplyBy(u/l),d=u/(i.inertiaDeceleration*a),_=c.multiplyBy(-d/2).round();_.x||_.y?(_=e._limitOffset(_,e.options.maxBounds),o.Util.requestAnimFrame(function(){e.panBy(_,{duration:d,easeLinearity:a,noMoveStart:!0,animate:!0})})):e.fire("moveend")}}}),o.Map.addInitHook("addHandler","dragging",o.Map.Drag),o.Map.mergeOptions({doubleClickZoom:!0}),o.Map.DoubleClickZoom=o.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom(),n=e.options.zoomDelta,o=t.originalEvent.shiftKey?i-n:i+n;"center"===e.options.doubleClickZoom?e.setZoom(o):e.setZoomAround(t.containerPoint,o)}}),o.Map.addInitHook("addHandler","doubleClickZoom",o.Map.DoubleClickZoom),o.Map.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60}),o.Map.ScrollWheelZoom=o.Handler.extend({addHooks:function(){o.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){o.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=o.DomEvent.getWheelDelta(t),i=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var n=Math.max(i-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o.bind(this._performZoom,this),n),o.DomEvent.stop(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),i=this._map.options.zoomSnap||0;t._stop();var n=this._delta/(4*this._map.options.wheelPxPerZoomLevel),o=4*Math.log(2/(1+Math.exp(-Math.abs(n))))/Math.LN2,s=i?Math.ceil(o/i)*i:o,r=t._limitZoom(e+(this._delta>0?s:-s))-e;this._delta=0,this._startTime=null,r&&("center"===t.options.scrollWheelZoom?t.setZoom(e+r):t.setZoomAround(this._lastMousePos,e+r))}}),o.Map.addInitHook("addHandler","scrollWheelZoom",o.Map.ScrollWheelZoom),o.extend(o.DomEvent,{_touchstart:o.Browser.msPointer?"MSPointerDown":o.Browser.pointer?"pointerdown":"touchstart",_touchend:o.Browser.msPointer?"MSPointerUp":o.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(t,e,i){function n(t){var e;if(e=o.Browser.pointer?o.DomEvent._pointersCount:t.touches.length,!(e>1)){var i=Date.now(),n=i-(r||i);a=t.touches?t.touches[0]:t,h=n>0&&n<=l,r=i}}function s(){if(h&&!a.cancelBubble){if(o.Browser.pointer){var t,i,n={};for(i in a)t=a[i],n[i]=t&&t.bind?t.bind(a):t;a=n}a.type="dblclick",e(a),r=null}}var r,a,h=!1,l=250,u="_leaflet_",c=this._touchstart,d=this._touchend;return t[u+c+i]=n,t[u+d+i]=s,t[u+"dblclick"+i]=e,t.addEventListener(c,n,!1),t.addEventListener(d,s,!1),o.Browser.edge||t.addEventListener("dblclick",e,!1),this},removeDoubleTapListener:function(t,e){var i="_leaflet_",n=t[i+this._touchstart+e],s=t[i+this._touchend+e],r=t[i+"dblclick"+e];return t.removeEventListener(this._touchstart,n,!1),t.removeEventListener(this._touchend,s,!1),o.Browser.edge||t.removeEventListener("dblclick",r,!1),this}}),o.extend(o.DomEvent,{POINTER_DOWN:o.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:o.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:o.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:o.Browser.msPointer?"MSPointerCancel":"pointercancel",TAG_WHITE_LIST:["INPUT","SELECT","OPTION"],_pointers:{},_pointersCount:0,addPointerListener:function(t,e,i,n){return"touchstart"===e?this._addPointerStart(t,i,n):"touchmove"===e?this._addPointerMove(t,i,n):"touchend"===e&&this._addPointerEnd(t,i,n),this},removePointerListener:function(t,e,i){var n=t["_leaflet_"+e+i];return"touchstart"===e?t.removeEventListener(this.POINTER_DOWN,n,!1):"touchmove"===e?t.removeEventListener(this.POINTER_MOVE,n,!1):"touchend"===e&&(t.removeEventListener(this.POINTER_UP,n,!1),t.removeEventListener(this.POINTER_CANCEL,n,!1)),this},_addPointerStart:function(t,i,n){var s=o.bind(function(t){if("mouse"!==t.pointerType&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE){if(!(this.TAG_WHITE_LIST.indexOf(t.target.tagName)<0))return;o.DomEvent.preventDefault(t)}this._handlePointer(t,i)},this);if(t["_leaflet_touchstart"+n]=s,t.addEventListener(this.POINTER_DOWN,s,!1),!this._pointerDocListener){var r=o.bind(this._globalPointerUp,this);e.documentElement.addEventListener(this.POINTER_DOWN,o.bind(this._globalPointerDown,this),!0),e.documentElement.addEventListener(this.POINTER_MOVE,o.bind(this._globalPointerMove,this),!0),e.documentElement.addEventListener(this.POINTER_UP,r,!0),e.documentElement.addEventListener(this.POINTER_CANCEL,r,!0),this._pointerDocListener=!0}},_globalPointerDown:function(t){this._pointers[t.pointerId]=t,this._pointersCount++},_globalPointerMove:function(t){this._pointers[t.pointerId]&&(this._pointers[t.pointerId]=t)},_globalPointerUp:function(t){delete this._pointers[t.pointerId],this._pointersCount--},_handlePointer:function(t,e){t.touches=[];for(var i in this._pointers)t.touches.push(this._pointers[i]);t.changedTouches=[t],e(t)},_addPointerMove:function(t,e,i){var n=o.bind(function(t){(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons)&&this._handlePointer(t,e)},this);t["_leaflet_touchmove"+i]=n,t.addEventListener(this.POINTER_MOVE,n,!1)},_addPointerEnd:function(t,e,i){var n=o.bind(function(t){this._handlePointer(t,e)},this);t["_leaflet_touchend"+i]=n,t.addEventListener(this.POINTER_UP,n,!1),t.addEventListener(this.POINTER_CANCEL,n,!1)}}),o.Map.mergeOptions({touchZoom:o.Browser.touch&&!o.Browser.android23,bounceAtZoomLimits:!0}),o.Map.TouchZoom=o.Handler.extend({addHooks:function(){o.DomUtil.addClass(this._map._container,"leaflet-touch-zoom"),o.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){o.DomUtil.removeClass(this._map._container,"leaflet-touch-zoom"),o.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var i=this._map;if(t.touches&&2===t.touches.length&&!i._animatingZoom&&!this._zooming){var n=i.mouseEventToContainerPoint(t.touches[0]),s=i.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=i.getSize()._divideBy(2),this._startLatLng=i.containerPointToLatLng(this._centerPoint),"center"!==i.options.touchZoom&&(this._pinchStartLatLng=i.containerPointToLatLng(n.add(s)._divideBy(2))),this._startDist=n.distanceTo(s),this._startZoom=i.getZoom(),this._moved=!1,this._zooming=!0,i._stop(),o.DomEvent.on(e,"touchmove",this._onTouchMove,this).on(e,"touchend",this._onTouchEnd,this),o.DomEvent.preventDefault(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,i=e.mouseEventToContainerPoint(t.touches[0]),n=e.mouseEventToContainerPoint(t.touches[1]),s=i.distanceTo(n)/this._startDist;if(this._zoom=e.getScaleZoom(s,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&s<1||this._zoom>e.getMaxZoom()&&s>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===s)return}else{var r=i._add(n)._divideBy(2)._subtract(this._centerPoint);if(1===s&&0===r.x&&0===r.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(r),this._zoom)}this._moved||(e._moveStart(!0),this._moved=!0),o.Util.cancelAnimFrame(this._animRequest);var a=o.bind(e._move,e,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=o.Util.requestAnimFrame(a,this,!0),o.DomEvent.preventDefault(t)}},_onTouchEnd:function(){return this._moved&&this._zooming?(this._zooming=!1,o.Util.cancelAnimFrame(this._animRequest),o.DomEvent.off(e,"touchmove",this._onTouchMove).off(e,"touchend",this._onTouchEnd),void(this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom)))):void(this._zooming=!1)}}),o.Map.addInitHook("addHandler","touchZoom",o.Map.TouchZoom),o.Map.mergeOptions({tap:!0,tapTolerance:15}),o.Map.Tap=o.Handler.extend({addHooks:function(){o.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){o.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(o.DomEvent.preventDefault(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var i=t.touches[0],n=i.target;this._startPos=this._newPos=new o.Point(i.clientX,i.clientY),n.tagName&&"a"===n.tagName.toLowerCase()&&o.DomUtil.addClass(n,"leaflet-active"),this._holdTimeout=setTimeout(o.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",i))},this),1e3),this._simulateEvent("mousedown",i),o.DomEvent.on(e,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),o.DomEvent.off(e,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var i=t.changedTouches[0],n=i.target;n&&n.tagName&&"a"===n.tagName.toLowerCase()&&o.DomUtil.removeClass(n,"leaflet-active"),this._simulateEvent("mouseup",i),this._isTapValid()&&this._simulateEvent("click",i)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new o.Point(e.clientX,e.clientY),this._simulateEvent("mousemove",e)},_simulateEvent:function(i,n){var o=e.createEvent("MouseEvents");o._simulated=!0,n.target._simulatedClick=!0,o.initMouseEvent(i,!0,!0,t,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),n.target.dispatchEvent(o)}}),o.Browser.touch&&!o.Browser.pointer&&o.Map.addInitHook("addHandler","tap",o.Map.Tap),o.Map.mergeOptions({boxZoom:!0}),o.Map.BoxZoom=o.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane},addHooks:function(){o.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){o.DomEvent.off(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_resetState:function(){this._moved=!1},_onMouseDown:function(t){return!(!t.shiftKey||1!==t.which&&1!==t.button)&&(this._resetState(),o.DomUtil.disableTextSelection(),o.DomUtil.disableImageDrag(),this._startPoint=this._map.mouseEventToContainerPoint(t),void o.DomEvent.on(e,{contextmenu:o.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this))},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=o.DomUtil.create("div","leaflet-zoom-box",this._container),o.DomUtil.addClass(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new o.Bounds(this._point,this._startPoint),i=e.getSize();o.DomUtil.setPosition(this._box,e.min),this._box.style.width=i.x+"px",this._box.style.height=i.y+"px"},_finish:function(){this._moved&&(o.DomUtil.remove(this._box),o.DomUtil.removeClass(this._container,"leaflet-crosshair")),o.DomUtil.enableTextSelection(),o.DomUtil.enableImageDrag(),o.DomEvent.off(e,{contextmenu:o.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){setTimeout(o.bind(this._resetState,this),0);var e=new o.LatLngBounds(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),o.Map.addInitHook("addHandler","boxZoom",o.Map.BoxZoom),o.Map.mergeOptions({keyboard:!0,keyboardPanDelta:80}),o.Map.Keyboard=o.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),o.DomEvent.on(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),o.DomEvent.off(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var i=e.body,n=e.documentElement,o=i.scrollTop||n.scrollTop,s=i.scrollLeft||n.scrollLeft;this._map._container.focus(),t.scrollTo(s,o)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,i,n=this._panKeys={},o=this.keyCodes;for(e=0,i=o.left.length;e<i;e++)n[o.left[e]]=[-1*t,0];for(e=0,i=o.right.length;e<i;e++)n[o.right[e]]=[t,0];for(e=0,i=o.down.length;e<i;e++)n[o.down[e]]=[0,t];for(e=0,i=o.up.length;e<i;e++)n[o.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,i,n=this._zoomKeys={},o=this.keyCodes;for(e=0,i=o.zoomIn.length;e<i;e++)n[o.zoomIn[e]]=t;for(e=0,i=o.zoomOut.length;e<i;e++)n[o.zoomOut[e]]=-t},_addHooks:function(){o.DomEvent.on(e,"keydown",this._onKeyDown,this)},_removeHooks:function(){o.DomEvent.off(e,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,i=t.keyCode,n=this._map;if(i in this._panKeys){if(n._panAnim&&n._panAnim._inProgress)return;e=this._panKeys[i],t.shiftKey&&(e=o.point(e).multiplyBy(3)),n.panBy(e),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds)}else if(i in this._zoomKeys)n.setZoom(n.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[i]);else{if(27!==i)return;n.closePopup()}o.DomEvent.stop(t)}}}),o.Map.addInitHook("addHandler","keyboard",o.Map.Keyboard),o.Handler.MarkerDrag=o.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new o.Draggable(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),o.DomUtil.addClass(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&o.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(t){var e=this._marker,i=e._shadow,n=o.DomUtil.getPosition(e._icon),s=e._map.layerPointToLatLng(n);i&&o.DomUtil.setPosition(i,n),e._latlng=s,t.latlng=s,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),o.Control=o.Class.extend({options:{position:"topright"},initialize:function(t){o.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),n=t._controlCorners[i];return o.DomUtil.addClass(e,"leaflet-control"),i.indexOf("bottom")!==-1?n.insertBefore(e,n.firstChild):n.appendChild(e),this},remove:function(){return this._map?(o.DomUtil.remove(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),o.control=function(t){return new o.Control(t)},o.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){function t(t,s){var r=i+t+" "+i+s;e[t+s]=o.DomUtil.create("div",r,n)}var e=this._controlCorners={},i="leaflet-",n=this._controlContainer=o.DomUtil.create("div",i+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){o.DomUtil.remove(this._controlContainer)}}),o.Control.Zoom=o.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=o.DomUtil.create("div",e+" leaflet-bar"),n=this.options;return this._zoomInButton=this._createButton(n.zoomInText,n.zoomInTitle,e+"-in",i,this._zoomIn),this._zoomOutButton=this._createButton(n.zoomOutText,n.zoomOutTitle,e+"-out",i,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,i,n,s){var r=o.DomUtil.create("a",i,n);return r.innerHTML=t,r.href="#",r.title=e,o.DomEvent.on(r,"mousedown dblclick",o.DomEvent.stopPropagation).on(r,"click",o.DomEvent.stop).on(r,"click",s,this).on(r,"click",this._refocusOnMap,this),r},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";o.DomUtil.removeClass(this._zoomInButton,e),o.DomUtil.removeClass(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMinZoom())&&o.DomUtil.addClass(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMaxZoom())&&o.DomUtil.addClass(this._zoomInButton,e)}}),o.Map.mergeOptions({zoomControl:!0}),o.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new o.Control.Zoom,this.addControl(this.zoomControl))}),o.control.zoom=function(t){return new o.Control.Zoom(t)},o.Control.Attribution=o.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){o.setOptions(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=o.DomUtil.create("div","leaflet-control-attribution"),o.DomEvent&&o.DomEvent.disableClickPropagation(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(" | ")}}}),o.Map.mergeOptions({attributionControl:!0}),o.Map.addInitHook(function(){this.options.attributionControl&&(new o.Control.Attribution).addTo(this)}),o.control.attribution=function(t){return new o.Control.Attribution(t)},o.Control.Scale=o.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",i=o.DomUtil.create("div",e),n=this.options;return this._addScales(n,e+"-line",i),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=o.DomUtil.create("div",e,i)),t.imperial&&(this._iScale=o.DomUtil.create("div",e,i))},_update:function(){var t=this._map,e=t.getSize().y/2,i=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(i)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),i=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,i,e/t)},_updateImperial:function(t){var e,i,n,o=3.2808399*t;o>5280?(e=o/5280,i=this._getRoundNum(e),this._updateScale(this._iScale,i+" mi",i/e)):(n=this._getRoundNum(o),this._updateScale(this._iScale,n+" ft",n/o))},_updateScale:function(t,e,i){t.style.width=Math.round(this.options.maxWidth*i)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1,e*i}}),o.control.scale=function(t){return new o.Control.Scale(t)},o.Control.Layers=o.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1},initialize:function(t,e,i){o.setOptions(this,i),this._layers=[],this._lastZIndex=0,this._handlingClick=!1;for(var n in t)this._addLayer(t[n],n);for(n in e)this._addLayer(e[n],n,!0)},onAdd:function(t){return this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this),this._container},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(o.stamp(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){o.DomUtil.addClass(this._container,"leaflet-control-layers-expanded"),this._form.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._form.clientHeight?(o.DomUtil.addClass(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=t+"px"):o.DomUtil.removeClass(this._form,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return o.DomUtil.removeClass(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=o.DomUtil.create("div",t);e.setAttribute("aria-haspopup",!0),o.DomEvent.disableClickPropagation(e),o.Browser.touch||o.DomEvent.disableScrollPropagation(e);var i=this._form=o.DomUtil.create("form",t+"-list");if(this.options.collapsed){o.Browser.android||o.DomEvent.on(e,{mouseenter:this.expand,mouseleave:this.collapse},this);var n=this._layersLink=o.DomUtil.create("a",t+"-toggle",e);n.href="#",n.title="Layers",o.Browser.touch?o.DomEvent.on(n,"click",o.DomEvent.stop).on(n,"click",this.expand,this):o.DomEvent.on(n,"focus",this.expand,this),o.DomEvent.on(i,"click",function(){setTimeout(o.bind(this._onInputClick,this),0)},this),this._map.on("click",this.collapse,this)}else this.expand();this._baseLayersList=o.DomUtil.create("div",t+"-base",i),this._separator=o.DomUtil.create("div",t+"-separator",i),this._overlaysList=o.DomUtil.create("div",t+"-overlays",i),e.appendChild(i)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&o.stamp(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,i){t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:i}),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(!this._container)return this;o.DomUtil.empty(this._baseLayersList),o.DomUtil.empty(this._overlaysList);var t,e,i,n,s=0;for(i=0;i<this._layers.length;i++)n=this._layers[i],this._addItem(n),e=e||n.overlay,t=t||!n.overlay,s+=n.overlay?0:1;return this.options.hideSingleBase&&(t=t&&s>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(o.stamp(t.target)),i=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;i&&this._map.fire(i,e)},_createRadioElement:function(t,i){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(i?' checked="checked"':"")+"/>",o=e.createElement("div");return o.innerHTML=n,o.firstChild},_addItem:function(t){var i,n=e.createElement("label"),s=this._map.hasLayer(t.layer);t.overlay?(i=e.createElement("input"),i.type="checkbox",i.className="leaflet-control-layers-selector",i.defaultChecked=s):i=this._createRadioElement("leaflet-base-layers",s),i.layerId=o.stamp(t.layer),o.DomEvent.on(i,"click",this._onInputClick,this);var r=e.createElement("span");r.innerHTML=" "+t.name;var a=e.createElement("div");n.appendChild(a),a.appendChild(i),a.appendChild(r);var h=t.overlay?this._overlaysList:this._baseLayersList;return h.appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){var t,e,i,n=this._form.getElementsByTagName("input"),o=[],s=[];this._handlingClick=!0;for(var r=n.length-1;r>=0;r--)t=n[r],e=this._getLayer(t.layerId).layer,i=this._map.hasLayer(e),t.checked&&!i?o.push(e):!t.checked&&i&&s.push(e);for(r=0;r<s.length;r++)this._map.removeLayer(s[r]);for(r=0;r<o.length;r++)this._map.addLayer(o[r]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,e,n=this._form.getElementsByTagName("input"),o=this._map.getZoom(),s=n.length-1;s>=0;s--)t=n[s],e=this._getLayer(t.layerId).layer,t.disabled=e.options.minZoom!==i&&o<e.options.minZoom||e.options.maxZoom!==i&&o>e.options.maxZoom},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),o.control.layers=function(t,e,i){return new o.Control.Layers(t,e,i)},o.PosAnimation=o.Evented.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=o.DomUtil.getPosition(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=o.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,i=1e3*this._duration;e<i?this._runFrame(this._easeOut(e/i),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var i=this._startPos.add(this._offset.multiplyBy(t));e&&i._round(),o.DomUtil.setPosition(this._el,i),this.fire("step")},_complete:function(){o.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),o.Map.include({setView:function(t,e,n){if(e=e===i?this._zoom:this._limitZoom(e),t=this._limitCenter(o.latLng(t),e,this.options.maxBounds),n=n||{},this._stop(),this._loaded&&!n.reset&&n!==!0){n.animate!==i&&(n.zoom=o.extend({animate:n.animate},n.zoom),n.pan=o.extend({animate:n.animate,duration:n.duration},n.pan));var s=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,n.zoom):this._tryAnimatedPan(t,n.pan);if(s)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e),this},panBy:function(t,e){if(t=o.point(t).round(),e=e||{},!t.x&&!t.y)return this.fire("moveend");if(e.animate!==!0&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new o.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),e.animate!==!1){o.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){o.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._floor();return!((e&&e.animate)!==!0&&!this.getSize().contains(i)||(this.panBy(i,e),0))}}),o.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4});var h=o.DomUtil.TRANSITION&&o.Browser.any3d&&!o.Browser.mobileOpera;h&&o.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),o.DomEvent.on(this._proxy,o.DomUtil.TRANSITION_END,this._catchTransitionEnd,this))}),o.Map.include(h?{_createAnimProxy:function(){var t=this._proxy=o.DomUtil.create("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(e){var i=o.DomUtil.TRANSFORM,n=t.style[i];o.DomUtil.setTransform(t,this.project(e.center,e.zoom),this.getZoomScale(e.zoom,1)),n===t.style[i]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",function(){var e=this.getCenter(),i=this.getZoom();o.DomUtil.setTransform(t,this.project(e,i),this.getZoomScale(i,1))},this)},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||i.animate===!1||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(e),s=this._getCenterOffset(t)._divideBy(1-1/n);return!(i.animate!==!0&&!this.getSize().contains(s)||(o.Util.requestAnimFrame(function(){this._moveStart(!0)._animateZoom(t,e,!0)},this),0))},_animateZoom:function(t,e,i,n){i&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,o.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:n}),setTimeout(o.bind(this._onZoomTransitionEnd,this),250)},_onZoomTransitionEnd:function(){this._animatingZoom&&(o.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),o.Util.requestAnimFrame(function(){this._moveEnd(!0)},this))}}:{}),o.Map.include({flyTo:function(t,e,n){function s(t){var e=t?-1:1,i=t?v:g,n=v*v-g*g+e*L*L*y*y,o=2*i*L*y,s=n/o,r=Math.sqrt(s*s+1)-s,a=r<1e-9?-18:Math.log(r);return a}function r(t){return(Math.exp(t)-Math.exp(-t))/2}function a(t){return(Math.exp(t)+Math.exp(-t))/2}function h(t){return r(t)/a(t)}function l(t){return g*(a(x)/a(x+P*t))}function u(t){return g*(a(x)*h(x+P*t)-r(x))/L}function c(t){return 1-Math.pow(1-t,1.5)}function d(){var i=(Date.now()-b)/T,n=c(i)*w;i<=1?(this._flyToFrame=o.Util.requestAnimFrame(d,this),this._move(this.unproject(_.add(m.subtract(_).multiplyBy(u(n)/y)),f),this.getScaleZoom(g/l(n),f),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}if(n=n||{},n.animate===!1||!o.Browser.any3d)return this.setView(t,e,n);this._stop();var _=this.project(this.getCenter()),m=this.project(t),p=this.getSize(),f=this._zoom;t=o.latLng(t),e=e===i?f:e;var g=Math.max(p.x,p.y),v=g*this.getZoomScale(f,e),y=m.distanceTo(_)||1,P=1.42,L=P*P,x=s(0),b=Date.now(),w=(s(1)-x)/P,T=n.duration?1e3*n.duration:1e3*w*.8;return this._moveStart(!0),d.call(this),this},flyToBounds:function(t,e){var i=this._getBoundsCenterZoom(t,e);return this.flyTo(i.center,i.zoom,e)}}),o.Map.include({_defaultLocateOptions:{timeout:1e4,watch:!1},locate:function(t){if(t=this._locateOptions=o.extend({},this._defaultLocateOptions,t),
!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=o.bind(this._handleGeolocationResponse,this),i=o.bind(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,i,t):navigator.geolocation.getCurrentPosition(e,i,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(t){var e=t.coords.latitude,i=t.coords.longitude,n=new o.LatLng(e,i),s=n.toBounds(t.coords.accuracy),r=this._locateOptions;if(r.setView){var a=this.getBoundsZoom(s);this.setView(n,r.maxZoom?Math.min(a,r.maxZoom):a)}var h={latlng:n,bounds:s,timestamp:t.timestamp};for(var l in t.coords)"number"==typeof t.coords[l]&&(h[l]=t.coords[l]);this.fire("locationfound",h)}})}(window,document);
//# sourceMappingURL=sourcemap.map